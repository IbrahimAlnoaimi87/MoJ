/*!
 SourceCode.Forms.Controls.Web.ControlPack.Worklist.Resources.JS.Worklist.js (Embedded resource)
*/
(function(n){var t;SourceCode.Forms.Controls.Worklist=t=n.extend({},SourceCode.Forms.Controls.Web.ControlPack.ControlPackBase,{FormEdit:function(){n(".SourceCode-Forms-Controls-Web-ControlPack-Worklist").worklist()},getDisplay:function(t,q){var r={display:q,icon:""};switch(t){case"ColumnLayoutConfiguration":q==="Simple"?(r.display=q,r.icon="ColumnLayoutConfigurationViewTypeSimple"):(r.display=q,r.icon="ColumnLayoutConfigurationViewTypeGrid");break;case"FilterGrouping":q==="(Default)"?(r.display=q,r.icon=""):(r.display=q,r.icon="");break;case"ActionMenuItemData":for(var e=q.split(","),f=["release","sleep","redirect","share","viewWorkflow"],u=0;u<f.length;u++)if(n.inArray(f[u],e)===-1)return r.display="(Custom)",r.icon="",r;r.display="(Default)";r.icon=""}return r},setRules:function(n){if(n.eventType==="changecontrol"){var q=n.designerDefinition.selectSingleNode("//Views/View/Controls/Control[@ID='"+n.controlId+"']/Properties"),r=q.selectSingleNode("Property[Name='Text']");checkExists(r)&&q.removeChild(r);var t=n.designerDefinition.createElement("Property"),u=n.designerDefinition.createElement("Name"),f=n.designerDefinition.createElement("Value"),e=n.designerDefinition.createElement("DisplayValue"),o=n.designerDefinition.createCDATASection(""),s=n.designerDefinition.createCDATASection("Text");f.appendChild(o);e.appendChild(o);u.appendChild(s);t.appendChild(e);t.appendChild(f);t.appendChild(u);q.appendChild(t)}EventUtil.manageControlEvent(n)},setStyles:function(n,t){n[0].style.height="auto";var s=n.find(".SFC").worklist(),q=s.worklist("designerSetStyle",n,t),f={};jQuery.extend(f,{border:q,background:q,margin:q,padding:q,font:q});StyleHelper.setStyles(f,t);var e=q[0].style,h=q.find(".nav")[0].style;q[0].style.boxSizing="border-box";h.fontWeight="bold";for(var u=q.find(".WorklistItemGridCell"),r=0;r<u.length;r++)u[r].style.color=e.color,u[r].style.fontSize=e.fontSize;var c=q.find(".headerTxt")[0].style;c.display="inline-block";var o=q.find(".nav")[0].style;o.width="100%";o.boxSizing="border-box"},setView:function(n,t){var q=n.find(".SFC").worklist();q.worklist("setView",t)},setTitle:function(n,t){var q=n.find(".SFC").worklist();q.worklist("setTitle",t)},setHeight:function(t,q){n("#"+t.attr("id")).find(".SFC").worklist();var r=t.find(".SFC");r.worklist("setHeight",q)},setTableBodyHeight:function(n,t,q){var r;if(q)r=parseInt(t.replace(/px/,""));else{var u=JSON.parse(n.find(".SFC").attr("data-options"));r=parseInt(u.Height.replace(/px/,""))}var f=r-25+"px";this.element.find(".WorkListGridTableBody")[0].style.height=f},setWatermarkText:function(){},setIsVisible:function(n,t){var q=["true","yes","1"].contains(t);SourceCode.Forms.Controls.Base.ControlType.setVisible(n,q)},setRows:function(n,t){var q=n.find(".SFC").worklist();q.worklist("setRows",t)},setHyperLinkData:function(n,t){var q=n.find(".SFC").worklist();q.worklist("setHyperLinkData",t)},validate:function(){},showSearch:function(n,t){var q=n.find(".SFC").worklist();q.worklist("showSearch",t)},showFilter:function(n,t){var q=n.find(".SFC").worklist();q.worklist("showFilter",t)},filterBehavior:function(n,t){var q=n.find(".SFC").worklist();q.worklist("filterBehavior",t)},showToolBar:function(n,t){var q=n.find(".SFC").worklist();q.worklist("showToolBar",t)},enableSearch:function(n,t){var q=n.find(".SFC").worklist();q.worklist("enableSearch",t)},showOOF:function(n,t){var q=n.find(".SFC").worklist();q.worklist("showOOF",t)},turnOffFilterIcon:function(t){var q=n("#"+t);q.worklist("turnOffFilterIcon")},constructFilter:function(t,q){var r=n("#"+q);r.worklist("setupObjectFilter",t)},execute:function(t){var y=t.methodName,e=n("#"+t.CurrentControlID);switch(y){case"RefreshControl":e.find(".RefreshInput").trigger("click");break;case"ReleaseInstance":var s=t.methodParameters.serialnumber,q=e.data("sfc-worklist");n(q.element).worklist("releaseTask",s,q);break;case"RedirectInstance":var s=t.methodParameters.serialnumber,p=t.methodParameters.username||t.methodParameters.usernames,q=e.data("sfc-worklist");u(q,t.CurrentControlID,s,p);break;case"SleepInstance":for(var s=t.methodParameters.serialnumber,w=t.methodParameters.sleepduration,q=e.data("sfc-worklist"),b=SourceCode.Forms.Settings.User.FQN.toLowerCase(),l,f=0;f<q.GlobalArrayOfWorklistItems.length;f++)if(s===q.GlobalArrayOfWorklistItems[f].SerialNumber){l=q.GlobalArrayOfWorklistItems[f].OriginalDestination;break}var k=SCCultureHelper.Current()._convertUTCDateToObj(w).format("yyyy-MM-ddThh:mm:sszzz");r(q,t.CurrentControlID,s,k,l,b);break;case"ShareInstance":for(var o=t.methodParameters.serialnumber,a=t.methodParameters.usernames.replace(/ /g,"").split(";"),q=e.data("sfc-worklist"),h=a.length;h>0;)h--,q.delegateTask(o,a[h],q);break;case"ExecuteInstanceAction":for(var o=t.methodParameters.serialnumber,c=t.methodParameters.actionname,d="/K2Services/rest.svc/Worklist/Items("+o+")/Actions("+encodeURIComponent(c)+")/Execute",q=e.data("sfc-worklist"),v,f=0;f<q.GlobalArrayOfWorklistItems.length;f++)if(o===q.GlobalArrayOfWorklistItems[f].SerialNumber){v=q.GlobalArrayOfWorklistItems[f].OriginalDestination;break}n.ajax({url:applicationRoot+"Worklist.sdk",dataType:"text",type:"POST",data:{call:"execute",serial:o,action:c,sharedUser:v,managedUser:""},beforeSend:function(n){SourceCode.Forms.XSRFHelper.setAntiXSRFHeader(n)},success:function(r){if(r.length!==0){var f=n.parseXML(r),s=q.xmlToJson(f);SourceCode.Forms.ExceptionHandler.isException(r)&&q.handleConnectionErrorForTask(d)}else{var u=e.find(".RefreshInput");u.removeClass("RefreshInputLoading");u.removeClass("RefreshInputError");u.removeClass("RefreshInputGray");q.RemoveWorklistItem(o);raiseEvent(t.CurrentControlID,"Control","Actioned")}},error:function(){q.handleConnectionErrorPushItemToActionQueue([o],c)}})}},bindUserPickerEvents:function(t,q){var f=this,e=q.find(".editableUserLookupIconWrapper");e.off("click").on("click",function(){initializeAddUserPickerRuntime(t,f.updateUsersField)});if(SourceCode.Forms.Browser.msie&&document.documentMode===8&&window.getSelection==undefined)var o=setInterval(function(){rangy.initialized&&(document.getSelection=rangy.getSelection,clearTimeout(o))},10);var u=q.find(".editableUserLookupTextbox");u.on("click",function(t){var q=document.getSelection().anchorNode;n(q).hasClass("editableUserLookupTextbox")||q.nodeValue.trim()===""?u.find(".selected").length>0&&u.find(".selected").removeClass("selected"):q.parentNode.nodeName==="SPAN"&&q.parentNode.className==="resolved"?(u.find(".OOFUserLookupUsername").removeClass("selected"),n(q.parentNode.parentNode).addClass("selected")):q.parentNode.nodeName==="SPAN"&&q.parentNode.className==="unresolved"&&f._unresolvedElementClick(n(this),t)});u.on("focus",function(){var n=q.find(".editableUserLookupTextbox");q.addClass("editableUserLookupFocused");f._validatePicker(n)}).on("focusout",function(t){q.removeClass("editableUserLookupFocused");setTimeout(function(){f._checkUnresolved(n(t.target))&&f.doSearchOperation(t)},500)}).on("mouseout",function(){n("#OOF_Tooltip").hide()});var s="";u.on("keydown.picker",this._editorKeyDown.bind(this));var r=t.name==="OOF"?t.users:t.exception.users;u.off("blur").on("blur",function(){var o=n(this),e=o.find(".OOFUserLookupUsername");if(e.length===0)for(var t=0;t<r.length;t++)typeof r[t].id=="undefined"?r.splice(t,1):r[t].deleted=!0;else{e.removeClass("selected");var q=[];n.each(e,function(){q.push({name:n(this).data().name,destinationType:"User",deleted:!1,friendlyName:n(this).data().friendly})});for(var t=0;t<r.length;t++){for(var f=!1,u=0;u<q.length;u++)if(r[t].name===q[u].name){f=!0;break}f===!1&&(typeof r[t].id=="undefined"?r.splice(t,1):r[t].deleted=!0)}for(var t=0;t<q.length;t++){for(var f=!1,u=0;u<r.length;u++)if(q[t].name===r[u].name){f=!0;break}f===!1&&r.push({name:q[t].name,destinationType:"User",deleted:!1,friendlyName:q[t].friendlyName})}}});var h=q.find(".editableUserLookupRemoveIconWrapper");h.off("click").on("click",function(){u.empty().attr("tabindex",-1);r.length=0;f._validatePicker(u)})},_editorKeyDown:function(t){var k=t.keyCode,e=8,s=46;if(window.navigator.userAgent.indexOf("MSIE ")>-1)var q=rangy.getNativeSelection();else var q=rangy.getSelection();var r=!1,v=n(q.anchorNode),h=v.closest(".entity"),o=n(t.target),d=o.clone();switch(t.which){case e:case s:if(o.find("br").remove(),q.anchorNode===null)break;if(q.anchorNode.nodeType===3||q.anchorNode.nodeType===1){var c=t.which===e||t.which===s?0:this._lengthOf(q.anchorNode.nodeValue)-1;if(h.length>0&&q.anchorOffset!==c&&(!SourceCode.Forms.Browser.msie||SourceCode.Forms.Browser.version!=8||t.which===s&&q.anchorOffset!==1||t.which===e&&q.anchorOffset!==0))h.remove(),r=!0;else if(v.hasClass("editable-area")){var u=t.which===e||t.which===s?q.anchorOffset-1:q.anchorOffset+1,l=v.contents();if(u>=0&&u<l.length){var y=n(l[u]);y.hasClass("spacer")&&(u=SourceCode.Forms.Browser.webkit?u-2:u-1,y=n(l[u]));n(l[u]).remove()}r=!0}else{for(var f=q.anchorNode;checkExists(f.parentNode)&&!n(f.parentNode).hasClass("editable-area");)f=f.parentNode;var g=n(f),b=f.innerHTML,p=t.which===e?f.previousSibling:f.nextSibling;if(checkExists(p)){t.which===e&&b==="&nbsp;"&&c++;var a=jQuery(p);a.hasClass("entity")&&q.anchorOffset===c?(a.remove(),r=!0):(h=a.closest(".entity"),q.anchorOffset===c&&h.length>0&&(a.remove(),SourceCode.Forms.Browser.msie&&SourceCode.Forms.Browser.version>8&&(r=!0)))}}if(r&&o.find(".spacer").text().removeNBSpace().trim().length===0){this.formatPickerEntities(o);var w=this;t.which===e&&(SourceCode.Forms.Browser.msie?setTimeout(function(){var t=n("#addOOFException").find(".editableUserLookupTextbox");w.formatPickerEntities(t);w._moveCursorToEnd(n(t))},0):this._moveCursorToEnd(o))}}case 9:this._checkUnresolved(o)&&t.keyCode===9&&(this.doSearchOperation(t),r=!0);break;case 13:case 16:case 75:(t.which===13||(t.which===16||t.which===75)&&t.ctrlKey)&&(r=!0,this.doSearchOperation(t))}return this._validatePicker(o),r&&(t.preventDefault(),t.stopPropagation()),!r},_lengthOf:function(n){return checkExists(n)?n.length:0},_checkUnresolved:function(t){for(var r=!1,f=t.contents(),u=0;u<f.length&&!r;u++){var e=n(f[u]);if(!e.hasClass("entity")){var q=e.text().trim();q.length>0&&(q=q.removeNBSpace().trim(),q.length>0&&(r=!0))}}return r},_moveCursorToEnd:function(t){this._isMovingCursor=!0;var u=t;try{if(t.find(".OOFUserLookupUsername").length!==0||SourceCode.Forms.Browser.webkit){t.trigger("focus");var q=rangy.getSelection(),r;if(r=q.rangeCount<=0?rangy.createRange():q.getRangeAt(0),SourceCode.Forms.Browser.webkit||SourceCode.Forms.Browser.msie){if(SourceCode.Forms.Browser.webkit){var f=r.startOffset,c=r.endOffset;if(n(u[0]).children().last().after('<span class="spacer">&nbsp<\/span>'),checkExistsNotEmpty(f)&&checkExistsNotEmpty(f)&&f===c)t.trigger("focus"),r.setStart(u[0],u.children().length),q.removeAllRanges(!0),q.addRange(r),t.trigger("focus");else{t.trigger("focus");var o=window.getSelection();o.removeAllRanges();o.addRange(r);t.trigger("focus")}}else if(SourceCode.Forms.Browser.msie){t.trigger("focus");var e=u.children().length;if(document.documentMode==8&&(e=e+1),r.setStart(u[0],e),r.collapse(!0),q.removeAllRanges(),checkExists(q.docSelection)&&checkExists(q.docSelection.type)&&q.docSelection.type!=="None"){var l=q.docSelection.createRange();if(l.length>0){var s=t[0],h=s.ownerDocument;checkExists(h)||s.document;var a=h.body.createTextRange();a.select();q.docSelection.empty()}}q.addRange(r);t.trigger("focus")}}else q.removeAllRanges(),r.setStart(u[0],u.children().length),r.collapse(),q.addRange(r)}else t.find(".spacer").remove(),t.trigger("focus");return this._validatePicker(t),!1}catch(v){SFLog({type:1,source:"moveCursorToEnd",category:"Picker Events",message:"There was an issue moving the cursor location in the picker"})}finally{SourceCode.Forms.Browser.msie?setTimeout(function(){this._isMovingCursor=!1}.bind(this),150):this._isMovingCursor=!1}},doSearchOperation:function(t){var r=this,o=n(t.target.parentNode),u=o.find(".editableUserLookupTextbox"),q=u.html();q.indexOf("&nbsp;")>-1&&(q=q.replace(/&nbsp;/g," "));u.attr("contenteditable",!1);var f=this.resolveFilter(u);if(f=f.trim(),f.length===0){popupManager.showWarning(ControlResources.SourceCode.Forms.Controls.Web.ControlPack.Properties.PickerCollection.EmptyUserSearchWarning);u.attr("contenteditable",!0);return}var h="Begins With",s="",c=function(t,f,e){n.ajax({type:"POST",url:applicationRoot+"PickerCollectionGetUserList.sdk",dataType:"text",data:{textFilter:t,filterToken:f,label:e},cache:!1,beforeSend:function(n){SourceCode.Forms.XSRFHelper.setAntiXSRFHeader(n)},success:function(f){var c=o.closest(".popup");if(c.length!==0&&c[0].style.display!=="none"){n("#picker-collection-add-user-operation-box-body").find(".picker-collection-grid-row").remove();n("#picker-collection-add-user-operation-box-header").find("span").text(ControlResources.SourceCode.Forms.Controls.Web.ControlPack.Properties.PickerCollection.SearchResult);for(var e=JSON.parse(f).slice(0,10),s=0;s<e.length;s++)e[s].FQN.toLowerCase()===SourceCode.Forms.Settings.User.FQN.toLowerCase()&&e.splice(s,1);var h=o.find(".editableUserLookupTextbox");if(e.length===1){for(var l="",s=0;s<e.length;s++)e[s].friendlyName=e[s].DisplayName,l+="<span class='OOFUserLookupUsername entity' contenteditable='false' data-name='{0}' data-friendly='{1}' title='{0}'><span class='resolved'>{1}<\/span>;<\/span><span class='spacer'>&nbsp;<\/span>".format(e[s].FQN.htmlEncode(),e[s].DisplayName.htmlEncode());q.lastIndexOf(";")<0?q="":(n(q).last().html()!==" "||q.length>q.lastIndexOf("<\/span>"))&&(q=q.substring(0,q.lastIndexOf('<span class="spacer">')));h.contents().last().remove();h.append(l);r.formatPickerEntities(u);r._moveCursorToEnd(h);n(".worklistUserLookupTextbox").trigger("focus")}else{outer=r._createElement("unresolved",t,e,r);outer.on("click",r._unresolvedElementClick.bind(r));h.contents().last().remove();h.append(outer);r.formatPickerEntities(u);r._moveCursorToEnd(h);n(".worklistUserLookupTextbox").trigger("focus");r._validatePicker(u);var a=n("#OOF_Tooltip");UtilitiesHelper.setToolTipPosition(a,u);a.show()}}},complete:function(){},error:function(){popupManager.showWarning("PickerCollectionGetUserList.sdk failed. Unable to connect to server")}})},e=n("#picker-collection-add-user-advanced-search-label-select-field").val();checkExists(e)?c(f,h,e):n.ajax({type:"GET",url:applicationRoot+"PickerCollectionGetUserLabel.sdk",dataType:"json",cache:!1,beforeSend:function(n){SourceCode.Forms.XSRFHelper.setAntiXSRFHeader(n)},success:function(n){var t=JSON.stringify(n);securityLabels=n;s=securityLabels.pop();localStorage.setItem("picker-collection-security-label",t)},complete:function(){e=s.Default;c(f,h,e)},error:function(){var n=localStorage.getItem("picker-collection-security-label");n===null?securityLabels=JSON.parse('[{"Name":"K2"},{"Name":"SHAREPOINT"},{"Name":"SP"}]'):(securityLabels=JSON.parse(n),s.Default="K2")}});u.attr("contenteditable",!0)},resolveFilter:function(t){for(var f=t.contents(),r="",u=0;u<f.length;u++){var e=n(f[u]);if(!e.hasClass("entity")){var q=e.text().trim();if(r=q,q.length>0){if(1)for(var o=q.split(";"),s=o.length;s--;)var h=o[s].removeNBSpace().trim();else q=q.removeNBSpace().trim(),r=q;if(!this._allowMultipleSelections)break}}}return r},_validatePicker:function(n){var t={CurrentControlId:"OOF",Error:!1,IsRequired:!1,Pattern:"Unresolved elements found."};n.find(".unresolved").length>0&&(t.Error=!0);UtilitiesHelper.showValidationMessage(n,t)},_unresolvedElementClick:function(t){var q=n(t.target.parentNode);q.hasClass("entity")||(q=q.find(".entity").last());q.find(".unresolved").length===0&&(q=n(t.target.parentNode));var u=q.find(".unresolved").parent().data("picker");this._clearMenu();this._searchLimit>0&&this._searchLimit<this._resolveSearchLimit&&(this._resolveSearchLimit=this._searchLimit);for(var s=this._resolveSearchLimit,r=null,f=0;f<u.length;f++){if(s===0)break;r=u[f];var l=r.FQN,a=r.DisplayName===""?r.Name:r.DisplayName;var v={text:a,description:l},e=this._contextMenu.addItem(v);s--;e.element.data("picker",r);e.element.data("target",q);e.element.on("click",this._contextMenuItemClick.bind(this))}var y=q.parent();u.length===0&&this._contextMenu.addItem({text:ControlResources.SourceCode.Forms.Controls.Web.ControlPack.Properties.PickerCollection.NoMatch,decription:ControlResources.SourceCode.Forms.Controls.Web.ControlPack.Properties.PickerCollection.NoMatch});this._contextMenu.addSeperator();r=this._contextMenu.addItem({text:ControlResources.SourceCode.Forms.Controls.Web.ControlPack.Properties.PickerCollection.Remove,decription:ControlResources.SourceCode.Forms.Controls.Web.ControlPack.Properties.PickerCollection.Remove,icon:"picker-delete"});r.element.data("target",q);r.element.on("click",this._contextMenuRemoveClick.bind(this));var h=this._contextMenu.addItem({text:ControlResources.SourceCode.Forms.Controls.Web.ControlPack.Properties.PickerCollection.Search,decription:ControlResources.SourceCode.Forms.Controls.Web.ControlPack.Properties.PickerCollection.Search,icon:"picker-search"});h.element.data("target",q);h.element.on("click",this._contextMenuSearchClick.bind(this));var o=q.offset(),c=y.find(".input-control").outerHeight();this._contextMenu.showContextMenuAt({event:t,x:o.left,y:!c?o.top:o.top+c})},_clearMenu:function(){checkExists(this._contextMenu)?this._contextMenu.hideContextMenu():this._contextMenu=new ContextMenu({id:OOF.ID+"_PickerMenu",dropshadow:!1,isRuntime:!0,cssClass:"control-popup id-picker-menu"});n.each(this._contextMenu.items,function(){this.element.remove()});this._contextMenu.items=[]},_contextMenuSearchClick:function(t){var q=n(t.target).closest("li"),r=q.data("target"),u=r.parent();u.hasClass("OOFDelegatedUserLookupTextbox")?initializeAddUserPickerRuntime(SourceCode.Forms.Controls.PickerCollection.OOFConfig,this.updateUsersField):initializeAddUserPickerRuntime(SourceCode.Forms.Controls.PickerCollection.OOFExcep,this.updateUsersField)},_contextMenuRemoveClick:function(t){var u=n(t.target).closest("li"),q=u.data("target"),r=q.parent();q.remove();this.formatPickerEntities(r);this._moveCursorToEnd(r)},_contextMenuItemClick:function(t){var r=n(t.target).closest("li"),q=r.data("picker"),u=r.data("target"),f=u.parent(),e="";e=q.DisplayName===""?this._createElement("resolved",q.Name,q,this):this._createElement("resolved",q.DisplayName,q,this);u.replaceWith(e);this.formatPickerEntities(f);this._moveCursorToEnd(f)},_createElement:function(t,q,r){var u=n("<span contenteditable='false' class='entity'><\/span>"),f="";f=r.DisplayName===""?r.Name:r.DisplayName;u.text(";");var e=n("<span class='"+t+"'><\/span>");return e.text(q),u.prepend(e),u.data("picker",r),t==="resolved"&&(u="<span class='OOFUserLookupUsername entity' contenteditable='false' data-name='{0}' data-friendly='{1}' title='{0}'><span class='resolved'>{1}<\/span>;<\/span><span class='spacer'>&nbsp;<\/span>".format(r.FQN.htmlEncode(),f.htmlEncode())),u},formatPickerEntities:function(t){checkExists(t)||(t=this._editor);t.contents().remove(".spacer");t.contents(".entity").before(n('<span class="spacer">&nbsp<\/span>'));t.contents(".entity").last().after('<span class="spacer">&nbsp<\/span>')},updateUsersField:function(t,q){var s=t.length;if(s!==0){var u,e;q.name==="OOF"?(u=q.users,e=n("#OOFGrid")):(u=q.exception.users,e=n("#OOFExceptionContext"));for(var r=0;r<s;r++){for(var h=!1,o=0;o<u.length;o++)if(t[r].FQN===u[o].name){h=!0;break}h===!1?u.push({name:t[r].FQN,destinationType:"User",deleted:!1,friendlyName:t[r].DisplayName}):u[r].deleted===!0&&u.push({name:t[r].FQN,destinationType:"User",deleted:!1,friendlyName:t[r].DisplayName})}var c="",f=e.find(".editableUserLookupTextbox"),l=f.find(".unresolved").parent();f.contents().last().remove();for(var r=0;r<t.length;r++)c=n("<span class='OOFUserLookupUsername entity' contenteditable='false' data-name='{0}' data-friendly='{1}' title='{0}'><span class='resolved'>{1}<\/span>;<\/span><span class='spacer'>&nbsp;<\/span>".format(t[r].FQN.htmlEncode(),t[r].DisplayName.htmlEncode())),f.append(c);SourceCode.Forms.Controls.Worklist.formatPickerEntities(f);SourceCode.Forms.Controls.Worklist._moveCursorToEnd(f)}}});n.widget("sfc.worklist",n.sfc.baseWidget,{gettingWorkItems:!1,searchVal:"",options:{text:"",Width:"100%",Height:"auto",isVisible:!0,Enabled:!0,UsesFilter:!0,DisplayRowValue:10,IsShortView:!0,showToolBar:!0,showFilter:!0,showOOF:!0,RefreshInterval:"300",showSearch:!1,FilterFromRuntime:!1,FilterObject:[],FilterGroupingString:'[{"field":"WorklistItemStatus","compareOperator":"NotEqual","initialValue":"Sleep","converted":"3","value":"3","logicOperator":"AndBracket","type":"filter","valueType":"Integer"},{"type":"sort","sortfield":"eventStartDate","order":"Descending"}]',viewflowlink:"none",viewType:"Grid",Rows:20,designtime:!1,Priority:"",EventName:"",EventMetaData:"",ProcessDescription:"",ProcessMetadata:"",ActivityStartDate:"",OriginalDestination:"",ActivityExpectedDuration:"",ActivityInstanceOverdue:"",EventDescription:"",processFolder:"",ProcessStartDate:"",ProcessStatus:"",EventPriority:"",Data:"",EventStartDate:"",ProcessID:"",ProcessExpectedDuration:"",activityMetadata:"",ActivityInstancePriority:"",serialNumber:"",EventExpectedDuration:"",ProcessFullName:"",ProcessGUID:"",ActivityDescription:"",Folio:"",ProcessName:"",ActivityName:"",activityDisplayName:"",Status:"",DueDate:"",SelectedAction:"",VisibleColumns:"",ActionMenuItemData:"",columnLayoutConfigurationValueHolder:'[{ "key": "ActivityName", "value": "'+ControlResources.SourceCode.Forms.Controls.Web.ControlPack.Properties.PickerCollection.ActivityName+'"}, { "key": "Folio", "value": "'+ControlResources.SourceCode.Forms.Controls.Web.ControlPack.Properties.PickerCollection.Folio+'" }, { "key": "EventStartDate", "value": "'+ControlResources.SourceCode.Forms.Controls.Web.ControlPack.Properties.PickerCollection.EventStartDate+'" }, { "key": "ProcessName", "value": "'+ControlResources.SourceCode.Forms.Controls.Web.ControlPack.Properties.PickerCollection.ProcessName+'" }]',isPickerOpen:!1,numberOfColumns:"",WatermarkText:null,showSearchWaterMark:!1,previous:{},style:SourceCode.Forms.Controls.Base.emptyStylesNode,enableSearch:!0,globalViewModel:[],searchMore:"Search More",numberOfRowsDisplayed:0,WorklistState:[],ColumnOrder:null,JSONworkitemsOnDisplay:"",showRelease:!0,showSleep:!0,showRedirect:!0,showShare:!0,FileVersion:"",sharedUsers:"",OOFSettings:{},openStatusTimer:{},OpenStatusCounter:{},filterbehavior:"global",showToolBar:!0,OOFUsersInfo:{},isRTL:!1,folioWatermark:!1,folioWatermarkFormat:"[ProcessName] - [ProcessID]"},turnOffFilterIcon:function(){var n=this.element.find(".FilterInput");n.addClass("FilterInputOff")},registerColumnResizable:function(){var t=this,e,o,c,q,f,r=document.documentElement.getAttribute("dir")=="rtl",s,u=75;this.element.find(".worklist-grid-column-divider").on("mousedown",function(h){n(h.target).addClass("mousedown");var l=n(this),a=n(".WorklistItemSectionCell",t.element),v=l.closest(".worklist-grid-column-header-cell"),y=r?a.offset().left:v.offset().left+u,p=r?l.offset().left-u+v.outerWidth():a.outerWidth(),w=max_Y=0;s=[y,w,p,max_Y];n(this).draggable({axis:"x",helper:"clone",appendTo:"body",zIndex:1e3,containment:s,isValidColumn:!0,start:function(u,s){this.isValidColumn=!0;var y=t.element.find(".WorkListItemTableHeader").height(),p=s.offset.top-1;s.helper.css({top:p,height:y});e=n(u.target);var l=t.element.find(".WorkListItemTableHeader");f=l.find(".worklist-grid-view-visible-column");n(u.target).addClass("dragged");for(var a=t.element.find(".WorkListItemTableHeader").find(".worklist-grid-column-header-cell").find(".worklist-grid-column-divider"),h=0;h<a.length;h++)if(n(a[h]).hasClass("dragged")){q=h-1;break}if(n(u.target).removeClass("dragged"),!checkExists(f[q+1])&&!r||!checkExists(f[q])&&r){this.isValidColumn=!1;return}var v=l.find(".worklist-grid-column-header");o=v.eq(q).width();c=v.eq(q+1).width()},drag:function(){},stop:function(f,s){if(this.isValidColumn){e=n(f.target);var l=parseInt(s.originalPosition.left),a=parseInt(s.offset.left),c=l-a;r&&(c=c*-1);var h=o-c;h=h<u?u:h;t.SetVisibleColumnWidth(q,h+"px");t.AdjustVisibleColumnWidth()}}})});this.element.find(".worklist-grid-column-divider").trigger("mousedown");var l=n(".WorklistItemSectionCell .WorkListItemTableHeader",t.element),h=n(".worklist-grid-column-header",t.element);h.on("dblclick",".worklist-grid-column-divider",function(q){q.preventDefault();var u=h,r={};r.element=n(this).closest("th");r.index=n(r.element).index();r.width=n(r.element).outerWidth();r.parentWidth=n(t.element).width();r.childrends=n(".worklist-grid-column-header-cell",r.element);r.childrends=r.childrends.add(n(".WorklistItemSectionDiv tr td:nth-child("+(r.index+1)+")",t.element));r.maxWidth=0;r.childrends.each(function(){var q=n("span",this).outerWidth(),t=n(n("span",this).clone());t.css({display:"hidded"});t.appendTo("body");q=t.outerWidth();t.remove();r.maxWidth=q>r.maxWidth?q:r.maxWidth});var f=r.maxWidth+40,e=u.index(r.element);t.SetVisibleColumnWidth(e,f+"px");t._adjustVisibleColumnWidth()})},SetVisibleColumnWidth:function(t,q){var r=this.element,u=n(n(".WorkListItemTableHeader > colgroup > col.worklist-grid-view-visible-column",r)[t]),f=n(n(".WorkListItemTable > colgroup > col.worklist-grid-view-visible-column",r)[t]);u.css("width",q);f.css("width",q);this.gridheader[t]=q},_validColumnWidthThreshold:function(n){var t=30;return n<t?t:n},_destroy:function(){var n=this;if(checkExists(n.intervalCount)){for(var t=0;t<n.intervalCount.length;t++)clearInterval(n.intervalCount[t]);n.intervalCount=undefined}},_adjustVisibleColumnWidth:function(){var r=this,t=n(".WorklistItemSectionCell",r.element),c=t.outerWidth(),k=n(".WorkListItemTableHeader",t),d=n(".WorkListItemTableHeader th:visible",t),q=n(".WorkListItemTableHeader > colgroup > col.worklist-grid-view-visible-column",t);if(q.length!==0){var l=n.grep(q,function(n){return n.style.width.toString().contains("px")}),a=n.grep(q,function(n){return n.style.width.toString().contains("%")}),o=n.grep(q,function(n){return n.style.width==="auto"||n.style.width===""}),u=0,v=n(".WorkListItemTableHeader > colgroup > col.worklist-grid-view-system-column",t),f=0;v.each(function(){f+=parseInt(this.style.width)});n(l).each(function(){u+=parseInt(this.style.width)});var s=c-f;n(a).each(function(){var n=Math.floor(s*(parseInt(this.style.width)/100));u+=n;r.SetVisibleColumnWidth(q.index(this),n+"px")});var e=s-u,h=r._validColumnWidthThreshold(Math.floor(e/o.length));n(o).each(function(){r.SetVisibleColumnWidth(q.index(this),h+"px");u+=h});var y=SourceCode.Forms.Browser.msie&&SourceCode.Forms.Browser.version==="9.0"?1:0;if(e=t.outerWidth()-(u+f)-y,e>0){var p=q.last(),w=this._validColumnWidthThreshold(parseInt(n(p).get(0).style.width)+e),b=q.length-1;r.SetVisibleColumnWidth(b,w+"px")}(SourceCode.Forms.Browser.msie||r._browser.msedge)&&n(".WorkListItemTable td",t).length<1?n(".WorkListItemTable",t).css("min-width",u+f+"px"):n(".WorkListItemTable",t).css("min-width","");r._restoreTableScrollPosition()}},_browser:function(){var n=SourceCode.Forms.Browser,t=window.navigator.userAgent,q=t.indexOf("Edge/");return q>0&&(n.msedge=!0,n.version=parseInt(t.substring(q+5,t.indexOf(".",q)),10)),n}(),_applyTableScrollSync:function(){var q=this,r=q.element,h=document.documentElement.getAttribute("dir").toUpperCase()==="RTL";if(this.options.viewType!=="Simple"&&r.is(":visible")&&typeof q.tableScrollPosition=="undefined"){var o=n(".stylewrapper",r).get(0);o.style.overflow="visible";var t=n(".WorklistItemSectionCell",r).get(0);n(".WorkListGridTableBody",t).css("overflow","auto");var f=n(".WorkListItemTableHeader",t).offset().left,e=n(".WorkListItemTableHeader",t).offset().top,s=function(){var q={top:n(".WorkListItemTable",t).offset().top,left:n(".WorkListItemTable",t).offset().left};n(".WorkListItemTableHeader",t).offset({left:q.left})};q.tableScrollPosition={top:e,left:f,originalLeft:f,originalTop:e};var u=n(".WorkListGridTableBody",t).scrollLeft();n(".WorkListGridTableBody",t).on("scroll",function(){typeof u!="undefined"&&(n(this).scrollLeft(u),u=undefined);s();q.tableScrollPosition={top:this.scrollTop,left:this.scrollLeft}})}},_restoreTableScrollPosition:function(){var q=this;if(typeof q.tableScrollPosition!="undefined"){var t=n(".WorkListGridTableBody",q.element);if(n(".WorkListGridTableBody table",q.element).outerWidth()<=n(".WorkListGridTableBody table",q.element).parent().outerWidth())t.trigger("scroll");else if(SourceCode.Forms.Browser.msie&&SourceCode.Forms.Browser.version==="9.0"){if(t.scrollLeft()===0&&t[0].scrollWidth-t.outerWidth()>0)t.scrollLeft(t.scrollLeft()-1),t.scrollLeft(q.tableScrollPosition.left);else{var u=n(".WorkListGridTableBody table",q.element).offset().left;n(".WorkListItemTableHeader",q.element).offset({left:u})}t.scrollTop(q.tableScrollPosition.top);t.trigger("scroll")}else t.scrollLeft(q.tableScrollPosition.left),t.scrollTop(q.tableScrollPosition.top);if((SourceCode.Forms.Browser.msie||q._browser.msedge)&&parseInt(SourceCode.Forms.Browser.version)>=9&&n(".WorklistItemSectionDiv",q.element).is(":empty")){var r=n(".WorkListItemTableHeader",q.element).width();r>t.outerWidth()?n(".WorkListItemTable",q.element).css("min-width",r+"px"):t.css("min-height","");t.css("overflow-y","hidden")}else n(".WorkListItemTable",q.element).css("min-width",""),t.css("min-height",""),t.css("overflow-y","")}},AdjustVisibleColumnWidth:function(){if(this.options.viewType!=="Simple"){var t=this;if(n(t.element).is(":visible")){var q=n("body").get(0).style["overflow-y"];n("body").css("overflow-y","scroll");this._adjustVisibleColumnWidth();n("body").css("overflow-y",q);this._applyTableScrollSync();SourceCode.Forms.Layout.isRuntime()||SourceCode.Forms.Designers.Common.triggerEventFromControlElement("ControlSizeChanged",this.element)}else t.onVisibilityChanged()}},onVisibilityChanged:function(){var q=0,t=this;if(SourceCode.Forms.Browser.msie&&SourceCode.Forms.Browser.version==="9.0"){var r=function(){var r=setInterval(function(){n(t.element).is(":visible")&&q<1&&(q+=1,clearInterval(r),t.AdjustVisibleColumnWidth(),t._applyTableScrollSync())},100);t.intervalCount=t.intervalCount||[];t.intervalCount.push(r)};r()}else t._resizeListener("add",n(t.element),function(){t.options.isVisible&&q<1&&(t.AdjustVisibleColumnWidth(),t._applyTableScrollSync());t._resizeListener("remove",n(t.element),null);q+=1})},worklistTableBody:null,_create:function(){var t=this;checkExists(this.worklistID)||(this.worklistID=this.element.parent().attr("id")+"_");SourceCode.Forms.Browser.msie?this.element.addClass("ie"):SourceCode.Forms.Browser.mozilla&&(document.documentMode===11?this.element.addClass("ie"):this.element.addClass("moz"));this.options.viewType==="Grid"?this.element.addClass("grid-layout"):this.element.addClass("simple-layout");n("#"+this.worklistID+"SearchInputBox").val("");this.element.hasClass("designtime")||this.element.hasClass("preview")?(this.options.designtime=!0,this.DesignTimeRender()):this.options.isRTL=document.documentElement.getAttribute("dir")==="rtl";this.worklistTableBody=n("#"+this.worklistID+"WorkListGridTableBody");this.element.find(".RuntimeWorklistMain").removeClass("RuntimeWorklistMain");this.element.find(".worklistTemp").remove();this.options.designtime?this._applyActionMenuItemDataBackwardCompatible():this._applyActionMenuItemDataBackwardCompatibleRuntime();var q=[];if(typeof this.options.ActionMenuItemData!="undefined"&&(q=this.options.ActionMenuItemData.split(","),this.options.showRelease=n.inArray("release",q)>-1?!0:!1,this.options.showRedirect=n.inArray("redirect",q)>-1?!0:!1,this.options.showShare=n.inArray("share",q)>-1?!0:!1,this.options.showSleep=n.inArray("sleep",q)>-1?!0:!1,this.options.showViewWorkflow=n.inArray("viewWorkflow",q)>-1?!0:!1),this.GetColumns(),this.options.designtime)this.hideProperties();else{if(this.LoadWorklistSettings(),this.getWorklistFromLocalStorage(),this.checkVisibility(),this.options.viewType==="Simple")this.LoadSimpleLayout();else if(this.options.viewType==="Grid"){var r=JSON.parse(this.options.columnLayoutConfigurationValueHolder);this.numberOfColumns=r.length;this.LoadGridLayout();this.makeAllSortable();this.registerColumnResizable()}SettingsUtil.getSetting("wlFilterConfig_{0}".format(t.element.attr("id")),function(q){var f=!1;if(SourceCode.Forms.ExceptionHandler.handleException(q)&&(f=!0),checkExists(q.status)&&q.status==404&&(f=!0),!f&&t.options.filterbehavior!=="userDisabled"){var e=q.documentElement;typeof e!="undefined"&&e.getAttribute("count")===null&&(t.FilterObject=e.text)}if(t.getWorklistFromServer(),t.BindToolBarEvents(),t._startIntervalRefresh(),t.options.Height!=="auto"){var u=parseInt(t.element.find(".stylewrapper").css("border"));(isNaN(u)||u==="")&&(u=0);t.options.Height=parseInt(t.options.Height)-u*2+"px"}var r=t.element.find(".checkboxheader");SourceCode.Forms.Browser.msie?(setTimeout(function(){t.setHeightRuntime()},100),t.element.find(".AllWorklistCheckBoxes").addClass("ie"),r.addClass("ie-header"),n("#"+t.worklistID+"SelectAllSimple").removeClass("ie").addClass("ieSimple"),r.addClass("ie")):setTimeout(function(){t.setHeightRuntime();t.element.find(".RuntimeWorklistMain").removeClass("RuntimeWorklistMain")},0);SourceCode.Forms.Browser.mozilla&&(navigator.userAgent.match(/Trident/)?r.addClass("ie"):r.addClass("moz"));SourceCode.Forms.Browser.webkit&&(r.addClass("chrome-header"),r.addClass("webkit"))})}n(document).on("panelexpand",".panel",function(){t.options.designtime?t.DesignTimeRender():(t.setHeightRuntime(),t.GetOOFStatus())});this.element.append("<div class='force-refresh-error-cache'><\/div>");this.base._create.apply(this,arguments);this.setStyles()},_applyActionMenuItemDataBackwardCompatibleRuntime:function(){var t=JSON.parse(this.element[0].getAttribute("data-options")),u=!0;if(typeof t.ActionMenuItemData!="undefined")for(var e=t.ActionMenuItemData.split(","),f=["release","sleep","redirect","share","viewWorkflow"],r=0;r<f.length;r++)if(n.inArray(f[r],e)===-1){u=!1;break}if(u){var q=[];(typeof t.showRelease=="undefined"||t.showRelease===!0)&&q.push("release");(typeof t.showSleep=="undefined"||t.showSleep===!0)&&q.push("sleep");(typeof t.showRedirect=="undefined"||t.showRedirect===!0)&&q.push("redirect");(typeof t.showShare=="undefined"||t.showShare===!0)&&q.push("share");q.push("viewWorkflow");this.options.ActionMenuItemData=q.join(",")}},_applyActionMenuItemDataBackwardCompatible:function(){var c=n("#FormDesigner").length>0;if(!this.element.hasClass("viewOnForm")){var e=this.element[0].getAttribute("Name");if(c){if(typeof e=="undefined")return;try{for(var l=parseXML(SourceCode.Forms.Designers.Form._getControls()).selectSingleNode("Items/Item[@Name='"+e+"']"),a=l.getAttribute("Guid"),o=SourceCode.Forms.Designers.Form.definitionXml,p=n(o),s=o.selectSingleNode("SourceCode.Forms/Forms/Form/Controls/Control[@ID='"+a+"']"),u=s.selectNodes("Properties/Property/Name"),t=[],q=0;q<u.length;q++)t.push(n(u).eq(q).text());var f=!1;if(n.inArray("ActionMenuItemLookup",t)>-1&&(f=!0),!f){var r=s.selectSingleNode("Properties"),h=this._obtainOldActionMenuProperty(r,t);this._replaceActionMenuProperty(h,t,r)}}catch(w){return}}else try{for(var v=SourceCode.Forms.Designers.View.ViewDesigner,y=v.View.viewDefinitionXML.selectSingleNode("//Controls/Control[Name/text()='"+e+"']"),r=y.selectSingleNode("Properties"),u=r.selectNodes("Property/Name"),t=[],q=0;q<u.length;q++)t.push(u[q].text());var f=!1;if(n.inArray("ActionMenuItemLookup",t)>-1&&(f=!0),!f){var h=this._obtainOldActionMenuProperty(r,t);this._replaceActionMenuProperty(h,t,r)}}catch(w){return}}},_replaceActionMenuProperty:function(t,q,r){var u="viewWorkflow,";for(var f in t)t[f]===!0&&(u+=this._actionMenuNameConverter(f)+",");u=u.substring(0,u.length-1);var e=n.inArray("ActionMenuItemData",q),s=r.selectNodes("Value")[e],o="<Property><Name>ActionMenuItemData<\/Name><Value>"+u+"<\/Value><DisplayValue><\/DisplayValue><\/Property>";n(r).find("Property").eq(e).remove();n(n.parseXML(o)).find("Property").appendTo(r)},_obtainOldActionMenuProperty:function(t,q){for(var u=["ShowSleep","ShowRedirect","ShowRelease","ShowShare"],f={},r=0;r<u.length;r++){var e=n.inArray(u[r],q);if(e>-1){var o=t.selectNodes("Property")[e];f[u[r]]=n(o.selectSingleNode("Value")).text()==="false"?!1:!0}else f[u[r]]=!0}return f},_actionMenuNameConverter:function(n){switch(n){case"ShowSleep":return"sleep";case"ShowRedirect":return"redirect";case"ShowRelease":return"release";case"ShowShare":return"share"}},LoadWorklistSettings:function(){var n=this;this.worklistID=this.element.attr("id")+"_";this.GlobalArrayOfWorklistItems=[];this.ROWS=0;this.WorklistDisplayNumber=parseInt(this.options.Rows);this.WorklistStartNumber=0;this.IsControlKeyPressed=!1;this.prevEvent=null;this.MatchSearchType="Contains";this.GlobalURL="";this.Filter=!1;this.showCheckBox=!1;this.FilterObject=this.options.FilterGroupingString;this.WorkListObject={};this.ActionsQueue=[];this.WorkListObject.FilterObject=this.FilterObject;this.colHeaders=[];this.GetPriorityLevel=["High","Medium","Low","Undefined"];this.CacheRows=[];this.updateFilter();this.showReleased=this.base._booleanConverter(this.options.showRelease);this.searchWorklist=!1},resetOOFUserInfoCache:function(){for(user in this.options.OOFUsersInfo)this.options.OOFUsersInfo[user].index=[]},updateOOFCache:function(n,t){if(checkExists(this.options.OOFUsersInfo[n]))this.options.OOFUsersInfo[n].index.push(t);else{var q=[];q.push(t);this.options.OOFUsersInfo[n]={name:n,index:q,isInOffice:!1}}},updateOOFStatusForEachItem:function(n){var t=this.options.OOFUsersInfo[n];if(checkExists(t))for(var q=0,r=t.index.length;q<r;q++){var u=t.index[q];this.GlobalArrayOfWorklistItems[u].OrigDestIsInOffice=t.status}},getOOFStatusForEachItem:function(){var t=this,q=(new Date).getTime();for(user in this.options.OOFUsersInfo)if(this.options.OOFUsersInfo[user].index.length!==0){if(checkExists(this.options.OOFUsersInfo[user].createdTime)&&q<this.options.OOFUsersInfo[user].createdTime+5e3){t.updateOOFStatusForEachItem(user);continue}var r={call:"GetOOF",user:t.options.OOFUsersInfo[user].name};n.ajax({url:"Worklist.sdk",type:"POST",data:r,dataType:"JSON",cache:!1,async:!0,beforeSend:function(n){SourceCode.Forms.XSRFHelper.setAntiXSRFHeader(n)},success:function(n){t.options.OOFUsersInfo[user].isInOffice=n.Status;var q=(new Date).getTime();t.options.OOFUsersInfo[user].createdTime=q;t.updateOOFStatusForEachItem(user);t.options.OOFSettings=n},error:function(){},complete:function(){}})}},GetOOFStatus:function(){var t=this;n.ajax({url:"Worklist.sdk",type:"POST",data:{call:"GetOOF"},dataType:"JSON",cache:!1,async:!0,beforeSend:function(n){SourceCode.Forms.XSRFHelper.setAntiXSRFHeader(n)},success:function(n){t.options.OOFSettings=n},error:function(){},complete:function(){t.ShowOOFStatus()}})},closeOOFDialog:function(){n(".oof-delegated-user-list-container").remove();popupManager.closeLast()},ShowOOFStatus:function(){this.base._booleanConverter(this.options.OOFSettings.Status)?this.element.removeClass("out-of-office"):(this.element.addClass("out-of-office"),document.documentMode===8&&this.element.find(".OOF").css("width","94%"))},setHeightRuntime:function(){this.worklistTableBody=n("#"+this.worklistID+"WorkListGridTableBody");this.options.Height.length<=0&&(this.options.Height="auto");var t;if(this.options.Height!=="auto"){this.element.addClass("height-static");this.base._booleanConverter(this.options.showSearch)&&this.element.find(".SearchInput").hasClass("SearchInputOff")&&this.element.addClass("search-section-active");this.options.Height=SourceCode.Forms.Controls.Web.ControlPack.Utils.UnitHelper(this.options.Height,"250px",!1);var h=parseInt(this.options.Height),r=h-(this.element.find(".nav").height()+this.element.find(".WorkListGridHeader").height());SourceCode.Forms.Browser.msie&&window.top!==window.self&&(r=r-Math.round(this.element.find(".LoadMoreHyperlink").height()/2));var s=this.element.find(".SelectAllSimpleSectionRow"),u=this.element.find(".searchBar"),q=0;if(u.is(":visible")&&(q=SourceCode.Forms.Browser.msie?u.css("border-top-width").replace("px","")*2:parseInt(u.css("border-top-width")),(isNaN(q)||q==="")&&(q=0),r-=parseInt(u.height())+q),this.options.viewType==="Simple"&&s.is(":visible")){var f=parseInt(s.css("border-top-width"));(isNaN(f)||f==="")&&(f=0);r-=parseInt(s.height())+f}var c=0,e=parseInt(Math.ceil(parseFloat(this.element.find(".SourceCodeFormsControlsWorklist").css("border-top-width")))),o=parseInt(Math.ceil(parseFloat(this.worklistTableBody.css("border-top-width"))));(isNaN(e)||e==="")&&(e=0);(isNaN(o)||o==="")&&(o=0);c=e*2+o;t=n("#"+this.worklistID+"SourceCodeFormsControlsWorklist")[0].style;t.height=this.options.Height}else this.element.removeClass("height-static"),this.base._booleanConverter(this.options.showSearch)&&this.element.removeClass("search-section-active"),t=this.element.find(".SourceCodeFormsControlsWorklist")[0].style,t.height=this.options.Height,t=this.worklistTableBody[0].style,t.height=this.options.Height},applyChanges:function(){if(this.options.ActionMenuItemData!==this.options.previous.ActionMenuItemData){var t=this.options.ActionMenuItemData.split(",");this.options.showRelease=n.inArray("release",t)>-1?!0:!1;this.options.showRedirect=n.inArray("redirect",t)>-1?!0:!1;this.options.showShare=n.inArray("share",t)>-1?!0:!1;this.options.showSleep=n.inArray("sleep",t)>-1?!0:!1;this.options.showViewWorkflow=n.inArray("viewWorkflow",t)>-1?!0:!1}if(this.options.text!==this.options.previous.text&&this.element.find(".headerTxt").text(this.options.text),this.options.WatermarkText!==this.options.previous.WatermarkText&&this.element.find(".WatermarkText").text(this.options.WatermarkText),this.options.showToolBar!==this.options.previous.showToolBar&&(this.base._booleanConverter(this.options.showToolBar)?this.isShowToolBar(!0):this.isShowToolBar(!1)),this.options.showFilter!==this.options.previous.showFilter&&(this.base._booleanConverter(this.options.showFilter)?this.element.find(".FilterInput").show():this.element.find(".FilterInput ").hide()),this.options.showOOF!==this.options.previous.showOOF&&(this.base._booleanConverter(this.options.showOOF)?this.element.find(".OOFInput").show():this.element.find(".OOFInput ").hide()),this.options.showSearch!==this.options.previous.showSearch&&(this.base._booleanConverter(this.options.showSearch)&&this.base._booleanConverter(this.options.enableSearch)?(this.element.find(".searchBar")[0].style.display="table",n("#"+this.worklistID+"searchInput").addClass("SearchInputOff").removeClass("OptionSelectBorderOff"),this.element.addClass("search-section-active")):(this.element.find(".searchBar").hide(),n("#"+this.worklistID+"searchInput").removeClass("SearchInputOff").addClass("OptionSelectBorderOff"),this.element.removeClass("search-section-active"))),this.options.Width!==this.options.previous.Width){var o=this.element[0].style;o.width=this.options.Width.indexOf("px")>=0||this.options.Width.indexOf("%")>=0?this.options.Width:this.options.Width+"px";this.StyleGridHeaders()}if(this.options.Height!==this.options.previous.Height&&this.setHeightRuntime(),this.options.Rows!==this.options.previous.Rows){var r=this,u=this.element.find(".WorklistItemGridRow"),f=parseInt(this.options.previous.Rows),e=parseInt(this.options.Rows);if(f>e)for(var q=this.options.Rows;q<u.length;q++)n(u[q]).fadeOut("slow",function(){n(this).remove();r.LoadMoreUpdate()});else{var s=e-f;this.AddRows(s,!0);r.LoadMoreUpdate()}}this.options.isVisible!==this.options.previous.isVisible&&this.checkVisibility();this.options.RefreshInterval!==this.options.previous.RefreshInterval&&(clearInterval(this.interval),this._startIntervalRefresh());this.options.enableSearch!==this.options.previous.enableSearch&&(this.options.previous.enableSearch=this.options.enableSearch,this.base._booleanConverter(this.options.enableSearch)?(this.element.find(".SearchInput").show(),this.base._booleanConverter(this.options.showSearch)&&(this.options.previous.showSearch=!1,this.applyChanges())):(this.element.find(".SearchInput").hide(),this.element.find(".searchBar").hide()));this.options.style!==this.options.previous.style&&this.setStyles();this.base.applyChanges.apply(this,arguments)},_optionNameTransformer:function(n){n=n.toLowerCase();switch(n){case"actionmenuitemdata":n="ActionMenuItemData";break;case"text":n="text";break;case"width":n="Width";break;case"height":n="Height";break;case"visible":n="Visible";break;case"enabled":n="Enabled";break;case"usesfilter":n="UsesFilter";break;case"displayrowvalue":n="DisplayRowValue";break;case"isshortview":n="IsShortView";break;case"showtoolbar":n="showToolBar";break;case"showfilter":n="showFilter";break;case"refreshinterval":n="RefreshInterval";break;case"showsearch":n="showSearch";break;case"showoof":n="showOOF";break;case"filterfromruntime":n="FilterFromRuntime";break;case"filterobject":n="FilterObject";break;case"filtergroupingstring":n="FilterGroupingString";break;case"viewflowlink":n="viewflowlink";break;case"viewtype":n="viewType";break;case"rows":n="Rows";break;case"designtime":n="designtime";break;case"priority":n="Priority";break;case"eventname":n="EventName";break;case"eventmetadata":n="EventMetaData";break;case"processdescription":n="ProcessDescription";break;case"processmetadata":n="ProcessMetadata";break;case"activitystartdate":n="ActivityStartDate";break;case"originaldestination":n="OriginalDestination";break;case"activityexpectedduration":n="ActivityExpectedDuration";break;case"activityinstanceoverdue":n="ActivityInstanceOverdue";break;case"eventdescription":n="EventDescription";break;case"processstartdate":n="ProcessStartDate";break;case"processstatus":n="ProcessStatus";break;case"eventpriority":n="EventPriority";break;case"data":n="Data";break;case"eventstartdate":n="EventStartDate";break;case"processid":n="ProcessID";break;case"processexpectedduration":n="ProcessExpectedDuration";break;case"processfolder":n="processFolder";break;case"activitymetadata":n="activityMetadata";break;case"activityinstancepriority":n="ActivityInstancePriority";break;case"serialnumber":n="serialNumber";break;case"eventexpectedduration":n="EventExpectedDuration";break;case"processfullname":n="ProcessFullName";break;case"processguid":n="ProcessGUID";break;case"activitydescription":n="ActivityDescription";break;case"folio":n="Folio";break;case"processname":n="ProcessName";break;case"activityname":n="ActivityName";break;case"activityname":n="ActivityName";break;case"activitydisplayname":n="activityDisplayName";break;case"status":n="Status";break;case"selectedaction":n="SelectedAction";break;case"visiblecolumns":n="VisibleColumns";break;case"columnlayoutconfigurationvalueholder":n="columnLayoutConfigurationValueHolder";break;case"ispickeropen":n="isPickerOpen";break;case"numberofcolumns":n="numberOfColumns";break;case"watermarktext":n="WatermarkText";break;case"showsearchwatermark":n="showSearchWaterMark";break;case"previous":n="previous";break;case"style":n="style";break;case"hosturl":n="hostURL";break;case"isvisible":n="isVisible";break;case"enablesearch":n="enableSearch";break;case"globalviewmodel":n="globalViewModel";break;case"searchmore":n="searchMore";break;case"workliststate":n="WorklistState";break;case"showrelease":n="showRelease";break;case"showsleep":n="showSleep";break;case"showredirect":n="showRedirect";break;case"showshare":n="showShare";break;case"fileversion":n="FileVersion";break;case"sharedusers":n="SharedUsers";break;case"viewflowurl":n="ViewFlowURL";break;case"foliowatermark":n="folioWatermark";break;case"foliowatermarkformat":n="folioWatermarkFormat";break;default:n=this.base._optionNameTransformer(n)}return n},constructFilterXml:function(n){for(var q='<Criteria xmlns="http://schemas.k2.com/worklist/d1">',r,u,f,e=0;e<n.length;e++){r=u=f="";var t=n[e];if(t.compareOperator==="Equals"&&(t.compareOperator="Equal"),t.type==="filter")t.valueType==="Date"&&(r=' DateType="{0}"'.format(t.dateType),t.dateType==="relative"&&(u=' StartDate="{0}"'.format(t.startDate),f=' EndDate="{0}"'.format(t.endDate))),q+='<Filter Field="{0}"{5}{6}{7} Comparison="{1}" ValueType="{4}" Logical="{3}">{2}<\/Filter>'.format(t.field,t.compareOperator,t.value,checkExists(t.logicOperator)?t.logicOperator:t.logicalOperator,checkExists(t.valueType)?t.valueType:t.dataType,r,u,f);else if(t.type==="sort"){var o=SourceCode.Forms.Controls.PickerCollection.FilterConfig.ColumnKeyMapper.findByKey(t.sortfield);typeof o!="undefined"&&(q+='<Sort Field="{0}" Order="{1}" />'.format(o,t.order))}}return q+"<\/Criteria>"},setupObjectFilter:function(n){this.FilterObject=JSON.stringify(n);var t=this.constructFilterXml(n);this.options.FilterGroupingString=t;this.options.FilterFromRuntime=!0;this.getWorklistFromServer()},sortFromFilter:function(){for(var t=JSON.parse(this.FilterObject),q=[],n=0;n<t.length;n++)t[n].type=="sort"&&q.push(t[n]);q.length>0&&(this.options.globalViewModel.multiSort(q),this.options.globalViewModel.updateWorklistItems())},createNameSpace:function(){var n=viewControllerDefinition},updateFilter:function(){this.options.FilterGroupingString!="none";var t=JSON.parse(this.options.FilterGroupingString);this.options.FilterGroupingString='<Criteria xmlns="http://schemas.k2.com/worklist/d1">';for(var n=0;n<t.length;n++)t[n].compareoperator=="Equals"&&(t[n].compareoperator="Equal"),t[n].type=="filter"&&(this.options.FilterGroupingString+='<Filter Field="{0}" Comparison="{1}" ValueType="{4}" Logical="{3}">{2}<\/Filter>'.format(t[n].field,t[n].compareOperator,t[n].value,t[n].logicOperator,t[n].valueType));this.options.FilterGroupingString+="<\/Criteria>";this.Filter=!0},hideProperties:function(){var q=this.element;function t(){var t=n(".propertyGridPropertyItem.selectedaction-property");t.length>0&&(t.parent().parent().remove(),clearInterval(r))}n(q).parent().on("click",function(){var n=setInterval(function(){t()},50)});var r=setInterval(function(){t()},50)},designerSetStyle:function(t){var h=this.element.find(".stylewrapper"),u=ControlResources.SourceCode.Forms.Controls.Web.ControlPack.Properties.Worklist.labelLoadMore;if(t.attr("id")==="StyleBuilderPreviewPanelContent"){this.element[0].style.height="inherit";for(var r=this.element.find(".WorklistItemGridRow"),q=2;q<r.length;q++){var f=n(r[q]);f.remove()}this.element.find(".SearchSectionMainTable").remove();this.element.addClass("unselectable");this.element.removeClass("disabled").addClass("readonly");this.element.find(".LoadMoreHyperlink").html(u.replace("{0}","2"))}else if(t.hasClass("condtional-format-preview")){this.element[0].style.height="inherit";for(var r=this.element.find(".WorklistItemGridRow"),q=2;q<r.length;q++){var f=n(r[q]);f.remove()}for(var e=this.element.find(".WorklistItemIcons"),q=0;q<e.length;q++)e[q].style.width="26px";this.element.find(".SearchSectionMainTable").remove();this.element.find(".nav")[0].style.backgroundColor="transparent";for(var o=this.element.find(".WorklistItemSectionDiv"),q=0;q<o.length;q++)o[q].style.overflow="hidden";for(var s=n("#conditionalFormattingGrid").find(".SimpleLayoutCell").find(".wlsimple"),q=0;q<s.length;q++)s[q].style.width="100%";this.element.addClass("unselectable");this.element.removeClass("disabled").addClass("readonly");this.element.find(".LoadMoreHyperlink").html(u.replace("{0}","2"))}return h},escapeSpecialCharSearch:function(n){return n.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")},ClearSearchAndRerenderGrid:function(){n("#"+this.worklistID+"SearchInputBox").val("");this.searchVal="";this.element.find(".selectedSearchText").contents().unwrap();this.options.WorklistState=[];this.element.find(".WorklistItemSectionDiv").html("");this.AddRows(this.WorklistDisplayNumber,!1);this.StyleGrid();this.element.find("#smartFormCheckBox_selectAll").find(".input-control.checkbox").removeClass("checked");this.LoadMoreUpdate();this.BindGridEvents();this.searchWorklist=!1;n("#"+this.worklistID+"searchMore").remove();this.options.showSearchWaterMark=!1;this.HandleWaterMark()},findMatch:function(n,t){var q=this.escapeSpecialCharSearch(t);switch(this.MatchSearchType){case"Begins With":if(n.match("^"+q))return!0;break;case"Contains":if(n.match(q))return!0;break;case"Ends With":if(n.match(q+"$"))return!0;break;case"Equals":if(n===t)return!0;break;case"Not Equals":if(n===t)return!0;break;default:return!1}return!1},registerSearchString:function(){this.searchVal=n("#"+this.worklistID+"SearchInputBox").val().toLowerCase()},searchGrid:function(){var t=this;this.gettingWorkItems===!1&&(t.searchVal=n("#"+this.worklistID+"SearchInputBox").val().toLowerCase(),t.element.find(".WorklistItemSectionDiv").hide(),t.getWorklistFromServer(t._postSearchCallback.bind(t)))},_postSearchCallback:function(t){var q=this;if(q.searchVal.length===0){n("#"+q.worklistID+"SearchClear").trigger("click");q.element.find(".WorklistItemSectionDiv").show();return}var r=q.element.find(".WorklistItemGridRow");r.fadeOut();r.promise().done(function(){var u=[],e,c,l="",f=!1,o=0;q.searchWorklist=!0;q.element.find(".LoadMoreHyperlink").hide();q.element.find(".selectedSearchText").contents().unwrap();for(var s=0;s<r.length;s++){u=r.eq(s);e=u.find("span");f=!1;for(var h=0;h<e.length;h++)if(c=e.eq(h),l=c.text().trim().toLowerCase(),f=q.findMatch(l,q.searchVal),f)break;q.MatchSearchType==="Not Equals"?f?u.remove():(o++,q.HighlightRow(u),u.fadeIn()):f?(o++,q.HighlightRow(u),u.fadeIn()):u.remove()}u.length===0?a():u.promise().done(function(){o===0?a():(q.StyleGrid(),q.BindGridEvents());checkExists(t)&&t()});function a(){q.options.showSearchWaterMark=!0;n("#"+q.worklistID+"watermark").hide();n("#"+q.worklistID+"searchWatermark").fadeIn();q.element.find("#smartFormCheckBox_selectAll").find(".input-control.checkbox").removeClass("checked")}q.element.find(".WorklistItemSectionDiv").show();q.searchMore()});q.CheckAllSelectCheckbox()},searchMore:function(){for(var t=this,h=this.element.find(".WorklistItemGridRow"),f,l=n("#"+this.worklistID+"SearchInputBox").val().toLowerCase(),r=!1,e,q,c=!1,u=0;u<this.GlobalArrayOfWorklistItems.length;u++){f=!1;for(var o=0;o<h.length;o++)if(this.GlobalArrayOfWorklistItems[u].SerialNumber===h.eq(o).data().serial){f=!0;break}if(f===!1){for(var s=0;s<this.VisibleColumns.length;s++)if(e=this.VisibleColumns[s].colKey,q=this.GlobalArrayOfWorklistItems[u][e],e==="EventStartDate"&&(q=t.DateFormatter(q)),q=q.toLowerCase(),r=t.findMatch(q,ControlPackBase.escapeSpecialChar(l)),r)break;if(t.MatchSearchType==="Not Equals"){if(!r){t.displaySearchMoreLink();c=!0;break}}else if(r){t.displaySearchMoreLink();break}}}t.MatchSearchType==="Not Equals"?c===!1&&(this.element.find(".loadmore").hide(),n("#"+this.worklistID+"searchMore").remove()):r===!1&&(this.element.find(".loadmore").hide(),n("#"+this.worklistID+"searchMore").remove())},displaySearchMoreLink:function(){var t=this;if(n("#"+this.worklistID+"searchMore").length===0){this.element.find(".loadmore").show();var q=this.worklistID+"searchMore";this.element.find(".loadmore").append("<a id='{0}' class='worklist-search-more' href='javascript:void(0);'>{1}<\/a>".format(q,ControlResources.SourceCode.Forms.Controls.Web.ControlPack.Properties.Worklist.SearchMore));n("#"+this.worklistID+"searchMore").off("click").on("click",function(){t.element.find(".loadmore").hide();n("#"+t.worklistID+"searchMore").remove();t.LoadMoreAndHighlightSearch();t.CheckAllSelectCheckbox()});n("#"+this.worklistID+"searchMore").on("keydown",function(q){if(q.keyCode===13){q.preventDefault();n("#"+t.worklistID+"searchMore").trigger("click");var r=this.element.find(".WorklistItemGridRow");t.element.find(".WorklistItemGridRow:visible").eq(r.length+1).trigger("focus")}})}},LoadMoreAndHighlightSearch:function(t){var q=this,c=this.element.find(".WorklistItemGridRow:visible"),e,l=n("#"+this.worklistID+"SearchInputBox").val().toLowerCase(),f=!1,o,r;typeof t=="undefined"&&(t=!1);n("#"+q.worklistID+"searchWatermark").hide();n("#"+q.worklistID+"watermark").hide();q.options.showSearchWaterMark=!1;for(var u=0;u<this.GlobalArrayOfWorklistItems.length;u++){e=!1;for(var s=0;s<c.length;s++)if(this.GlobalArrayOfWorklistItems[u].SerialNumber===c.eq(s).data().serial){e=!0;break}if(e===!1){for(var h=0;h<this.VisibleColumns.length;h++)if(o=this.VisibleColumns[h].colKey,r=this.GlobalArrayOfWorklistItems[u][o],o==="EventStartDate"&&(r=q.DateFormatter(r)),r=r.toLowerCase(),f=q.findMatch(r,ControlPackBase.escapeSpecialChar(l)),f)break;if(q.MatchSearchType==="Not Equals"){if(!f&&(q.GetArrayElementAndAppendRow(u),q.HighlightRow(q.element.find(".WorklistItemGridRow").last()),t))break}else if(f&&(q.GetArrayElementAndAppendRow(u),q.HighlightRow(q.element.find(".WorklistItemGridRow").last()),t))break}}this.ZebraStripeRows();this.BindGridEvents()},searchBeginsWith:function(n,t){var q=n.innerText.trim(),f="",r=0,s=t.length,e=q.toUpperCase(),o=t.toUpperCase();if(e.startsWith(o)){var u=e.indexOf(o,r),h=q.substring(u,t.length+u);return f+=ControlPackBase.escapeSpecialChar(q.substring(r,u)),f+="<span class='selectedSearchText'>{0}<\/span>".format(ControlPackBase.escapeSpecialChar(h)),r=u+s,f+ControlPackBase.escapeSpecialChar(q.substring(r))}return ControlPackBase.escapeSpecialChar(q)},searchContains:function(n,t){for(var r=n.innerText.trim(),u="",f=0,e=t.length,o=r.toUpperCase(),s=t.toUpperCase();;){var q=o.indexOf(s,f);if(q===-1){u+=ControlPackBase.escapeSpecialChar(r.substring(f));break}var h=r.substring(q,t.length+q);u+=ControlPackBase.escapeSpecialChar(r.substring(f,q));u+="<span class='selectedSearchText'>{0}<\/span>".format(ControlPackBase.escapeSpecialChar(h));f=q+e}return u},searchEndsWith:function(n,t){var q=n.innerText.trim(),u="",f=q.toUpperCase(),e=t.toUpperCase();if(f.endsWith(e)){var r=f.lastIndexOf(e),o=q.substring(r,t.length+r);return u+=ControlPackBase.escapeSpecialChar(q.substring(0,r)),u+"<span class='selectedSearchText'>{0}<\/span>".format(ControlPackBase.escapeSpecialChar(o))}return ControlPackBase.escapeSpecialChar(q)},searchEquals:function(n,t){var q=n.innerText.trim(),u="",f=0,h=t.length,e=q.toUpperCase(),o=t.toUpperCase();if(e==o){var r=e.indexOf(o,f),s=q.substring(r,t.length+r);return u+=ControlPackBase.escapeSpecialChar(q.substring(f,r)),u+"<span class='selectedSearchText'>{0}<\/span>".format(ControlPackBase.escapeSpecialChar(s))}return ControlPackBase.escapeSpecialChar(q)},searchNotEquals:function(n,t){var q=n.innerText.trim(),r=t.length,u=q.toUpperCase(),f=t.toUpperCase();return ControlPackBase.escapeSpecialChar(q)},HighlightRow:function(n){for(var t=this,f=n.find("span"),u=0,e=f.length;u<e;u++){var q=f[u],r="";switch(this.MatchSearchType){case"Begins With":r=t.searchBeginsWith(q,t.searchVal);break;case"Contains":r=t.searchContains(q,t.searchVal);break;case"Ends With":r=t.searchEndsWith(q,t.searchVal);break;case"Equals":r=t.searchEquals(q,t.searchVal);break;case"Not Equals":r=t.searchNotEquals(q,t.searchVal)}q.innerHTML=r}},xmlToJson:function(n){var t={};switch(n.nodeType){case 1:if(n.attributes.length>0){t["@attributes"]={};for(var r=0;r<n.attributes.length;r++){var f=n.attributes.item(r);t["@attributes"][f.nodeName]=this.escapeSpecialChar(f.nodeValue)}}break;case 3:t=this.escapeSpecialChar(n.nodeValue)}if(n.hasChildNodes())for(var r=0;r<n.childNodes.length;r++){var u=n.childNodes.item(r),q=u.nodeName;if(typeof t[q]=="undefined")t[q]=this.xmlToJson(u);else{if(typeof t[q].length=="undefined"){var e=t[q];t[q]=[];t[q].push(e)}try{t[q].push(this.xmlToJson(u))}catch(o){}}}return t},formatAMPM:function(n){var t=n.getHours(),q=n.getMinutes(),r=t>=12?"PM":"AM";t=t%12;t=t?t:12;q=q<10?"0"+q:q;return t+":"+q+" "+r},getWorklistFromLocalStorage:function(){this.CheckLocalStorageVersions();this.GlobalArrayOfWorklistItems=[];var n=JSON.parse(localStorage.getItem(this.element.attr("id")));if(n)for(var r=n.WorklistItems.length,q,t=0;t<r;t++)q=n.WorklistItems[t],this.GlobalArrayOfWorklistItems.push(q)},CheckLocalStorageVersions:function(){this.options.FileVersion!==localStorage.getItem("Worklist FileVersion")&&(localStorage.clear(),localStorage.setItem("Worklist FileVersion",this.options.FileVersion))},handleRefreshError:function(t){var f=this,q=this.element.attr("id"),r=n("#"+q+"_refreshInput"),u=n("#"+q+"_RefreshErrorTooltip");u.remove();r.removeClass("RefreshInputLoading").addClass("RefreshInputError");r.prop("title","");n("body").append("                 <div id={0}_RefreshErrorTooltip class='RefreshErrorTooltip tooltip validation pointer-up'>                     <span>{1}<\/span>                     <div class='tooltip-pointer' style='left: 50%;'>                         <div class='tooltip-pointer-inner'><\/div>                     <\/div>                 <\/div>".format(this.element.attr("id"),t));r.off("mouseenter mouseleave").on("mouseenter",function(n){f._errorTooltipHoverStateHandler(q,n.target)}).on("mouseleave",function(){var t=n("#"+q+"_RefreshErrorTooltip");t[0].style.display="none"});r.off("click").on("click",function(t){u=n("#"+q+"_RefreshErrorTooltip");var o=n(window).width(),r=n(t.target).offset(),e=u[0].style;if(e.display="inline",e.top=parseInt(r.top+30)+"px",o<r.left+100){var s=u.find(".tooltip-pointer")[0].style;s.marginLeft="60px";e.left=parseInt(r.left-150)+"px"}else{var h=u.width()/2;e.top=parseInt(r.top+30)+"px";e.left=parseInt(r.left-h)+"px"}f.element.find(".OOFInput").addClass("hidden")});r.trigger("click")},_errorTooltipHoverStateHandler:function(n,t){var q=jQuery("#{0}_RefreshErrorTooltip".format(n));q[0].style.display="inline";var f=jQuery(window).width(),r=jQuery(t).offset(),u=q[0].offsetWidth/2;if(q[0].style.top="{0}px".format(r.top+t.offsetHeight+14),f<r.left+u){q[0].style.right="5px";var e=q.find(".tooltip-pointer")[0],o=jQuery(q).offset(),s=r.left-o.left-u+t.offsetWidth/4;e.style.marginLeft="{0}px".format(s)}else{var h=r.left+t.offsetWidth/2-u;q[0].style.left="{0}px".format(h)}},handleRefreshErrorStack:function(t){var f=this,q=this.element.attr("id"),u=n("#"+q+"_refreshInput"),r=n("#"+q+"_RefreshErrorTooltip");r.remove();u.removeClass("RefreshInputLoading").addClass("RefreshInputError");u.prop("title","");n("body").append("                 <div id={0}_RefreshErrorTooltip class='RefreshErrorTooltip tooltip validation pointer-up'>                     <span>{1}<\/span>                     <a href='javascript:void(0)' class='viewDetailsWorklistError'>{2}<\/a>                    <div class='tooltip-pointer' style='left: 50%;'>                         <div class='tooltip-pointer-inner'><\/div>                     <\/div>                 ".format(this.element.attr("id"),t,ControlResources.SourceCode.Forms.Controls.Web.ControlPack.Properties.PickerCollection.ViewDetails));u.off("mouseenter mouseleave").on("mouseenter",function(n){f._errorTooltipHoverStateHandler(q,n.target)}).on("mouseleave",function(){var t=n("#"+q+"_RefreshErrorTooltip");t.find(".viewDetailsWorklistError").off("click").on("click",function(){var q=n(f.options.ErrorData);SourceCode.Forms.ExceptionHandler.handleException(q[0].cloneNode(!0));t[0].style.display="none"})});u.off("click").on("click",function(t){r=n("#"+q+"_RefreshErrorTooltip");var o=n(window).width(),u=n(t.target).offset(),e=r[0].style;if(e.display="inline",e.top=parseInt(u.top+30)+"px",o<u.left+100){var s=r.find(".tooltip-pointer")[0].style;s.marginLeft="60px";e.left=parseInt(u.left-150)+"px"}else{var h=r.width()/2;e.top=parseInt(u.top+30)+"px";e.left=parseInt(u.left-h)+"px"}f.element.find(".OOFInput").addClass("hidden")});u.trigger("click");var r=n("#"+q+"_RefreshErrorTooltip");r.on("mouseleave",function(){this.style.display="none"})},getWorklistFromServer:function(t){this.gettingWorkItems=!0;var o=(new Date).getTime(),l=JSON.parse(this.FilterObject),v=this.options.hostURL,s=this.options.hostURL+"/K2Services/rest.svc/Worklist/Items",q=this,h=1e3;this.GlobalURL=s;this.options.FilterGroupingString=this.constructFilterXml(l);this.options.FilterGroupingString!="none"&&(s=this.options.hostURL+"/K2Services/rest.svc/Worklist/Items?filterXml="+this.options.FilterGroupingString);var e=this.element.attr("id"),y=localStorage.getItem(e),r=JSON.parse(localStorage.getItem(e+"_actionsQueue"));if(r!==null)for(var f=r.slice(0),c=0,a=r.length-1;;){if(c>a)break;var u=r.pop();n.ajax({url:applicationRoot+"Worklist.sdk",type:"POST",data:{call:u.Url,mode:"text"},dataType:"text",async:"true",beforeSend:function(n){SourceCode.Forms.XSRFHelper.setAntiXSRFHeader(n)},success:function(f){if(f.length!==0){var e=n.parseXML(f),o=q.xmlToJson(e);SourceCode.Forms.ExceptionHandler.isException(f)&&(r.push(u),q.RemoveWorklistItem(u.ID))}typeof t=="function"&&t()},error:function(){r.push(u);q.RemoveWorklistItem(u.ID)},complete:function(){localStorage.setItem(e+"_actionsQueue",JSON.stringify(r))}});c++}n.ajax({url:applicationRoot+"Worklist.sdk",type:"POST",data:{call:"OOF",filter:this.options.FilterGroupingString},dataType:"XML",cache:!1,async:!0,beforeSend:function(t){q.element.showBusyModal(!0,!1,!0);var r=q.element.data("modalizerId")+"_modalizer";n("#"+r).insertBefore(".popupManager");SourceCode.Forms.XSRFHelper.setAntiXSRFHeader(t)},success:function(t){q.GlobalArrayOfWorklistItems=[];q.JSONworkitemsOnDisplay="";var u=q.element.find(".RefreshInput"),v=(new Date).getTime(),e=h-(v-o);if(e>0?setTimeout(function(){u.removeClass("RefreshInputLoading")},e):u.removeClass("RefreshInputLoading"),u.removeClass("RefreshInputError"),u.removeClass("RefreshInputGray"),u.attr("title",ControlResources.SourceCode.Forms.Controls.Web.ControlPack.Properties.Worklist.RefreshTooltip),q.element.find(".smartform-checkbox_selectall").find(".input-control.checkbox").removeClass("checked"),SourceCode.Forms.Browser.mozilla)var r=q.toJson(t);else var r=q.xmlToJson(t);if(SourceCode.Forms.ExceptionHandler.isException(t)){q.options.ErrorData=t;q.handleRefreshErrorStack(ControlResources.SourceCode.Forms.Controls.Web.ControlPack.Properties.PickerCollection.AjaxRequestFailed,q.options.ErrorData);return}var s=q.element.attr("id"),y=n("#"+s+"_refreshInput");y.off("mouseenter mouseleave click");var c=n("#"+s+"_RefreshErrorTooltip");c.length!==0&&(c[0].style.display="none");q.base._booleanConverter(q.options.showOOF)&&q.element.find(".OOFInput").removeClass("hidden");q.BindRefreshClick();var p=JSON.stringify(r);if(typeof r.WorklistItemCollection.WorklistItem!="undefined"){if(!Array.isArray(r.WorklistItemCollection.WorklistItem)){var l=[];l.push(r.WorklistItemCollection.WorklistItem);r.WorklistItemCollection.WorklistItem=l}q.populateArray(r.WorklistItemCollection.WorklistItem)}q.WorkListObject.WorklistItems=q.GlobalArrayOfWorklistItems;q.localStorageHandler.addItem(q.element[0].id,q.WorkListObject,q);try{q.sortFromFilter()}catch(w){}q.options.WorklistState=[];for(var a=q.element.find(".SelectedDivBackground"),f=0;f<a.length;f++)q.options.WorklistState.push(n(a[f]).attr("id"));q.BuildTableBody();raiseEvent(q.element.attr("id"),"Control","Refreshed")},error:function(n){n.status===302||n.status===401||n.status===403?(q.options.ErrorData=parseXML("<Exception><DisplayMessage>Status Code - [{0}]<\/DisplayMessage><\/Exception>".format(n.status)),q.handleRefreshErrorStack(ControlResources.SourceCode.Forms.Controls.Web.ControlPack.Properties.Worklist.NotAuthorized)):(q.options.ErrorData=parseXML("<Exception><DisplayMessage>Status Code - [{0}]<\/DisplayMessage><\/Exception>".format(n.status)),q.handleRefreshErrorStack(ControlResources.SourceCode.Forms.Controls.Web.ControlPack.Properties.Worklist.UnableToRetrieve),q.getWorklistFromLocalStorage())},complete:function(){q.gettingWorkItems=!1;q.element.showBusyModal(!1,!1,!0);var u=n("#"+q.worklistID+"refreshInput"),s=(new Date).getTime(),e=h-(s-o);if(e>0?setTimeout(function(){u.removeClass("RefreshInputLoading")},e):u.removeClass("RefreshInputLoading"),typeof f!="undefined"&&f!==null)for(var r=0;r<f.length;r++)q.RemoveWorklistItem(f[r].ID);q.GetOOFStatus();q._clearOpenInterval();q.CheckAllSelectCheckbox();typeof t=="function"&&t()}})},toJson:function(n){var r=this,t={};if(n.nodeType==1){if(n.attributes.length>0){t["@attributes"]={};for(var u=0;u<n.attributes.length;u++){var o=n.attributes.item(u);t["@attributes"][o.nodeName]=r.escapeSpecialChar(o.value)}}}else n.nodeType==3&&(t=r.escapeSpecialChar(n.nodeValue));if(n.hasChildNodes())for(var f=0;f<n.childNodes.length;f++){var e=n.childNodes.item(f),q=e.nodeName;if(typeof t[q]=="undefined")t[q]=r.toJson(e);else{if(typeof t[q].push=="undefined"){var s=t[q];t[q]=[];t[q].push(s)}t[q].push(r.toJson(e))}}return t},escapeSpecialChar:function(n){return n.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},populateArray:function(t){this.GlobalArrayOfWorklistItems=[];var pq=JSON.parse(this.FilterObject),qq=this.options.hostURL,dt=qq.split("/"),rq=dt[0]+"//"+dt[2]+"/K2Services/rest.svc/Worklist/Items",uq=this;this.GlobalURL=rq;this.resetOOFUserInfoCache();for(var gt=t.length,y=0;y<gt;y++){var q=t[y],r=q.ActivityInstanceDestination[0],f=q.ActivityInstanceDestination[1],b=q.ProcessInstance["@attributes"].Priority,e=q["@attributes"].AllocatedUser,k=q.ProcessInstance["@attributes"].Folio,p=q.Data["#text"]?n("<div><\/div>").html(q.Data["#text"]).text():"",d=q["@attributes"].SerialNumber,g=q["@attributes"].Status,fq=q["@attributes"].DueDate,nt=f["@attributes"].Name,tt=f.Metadata["#text"]?f.Metadata["#text"]:"",qt=f["@attributes"].StartDate,rt=f.Description["#text"],ut=f["@attributes"].Priority,ft=f["@attributes"].ExpectedDuration,w=r["@attributes"].StartDate,a=r["@attributes"].ExpectedDuration,v=q["@attributes"].Status,et=r["@attributes"].DisplayName,eq=r["@attributes"].Name,ot=r.Metadata["#text"]?r.Metadata["#text"]:"",st=r["@attributes"].Priority,ht=r.Description["#text"]?r.Description["#text"]:"",ct=q.ProcessInstance["@attributes"].Folder,lt=q.ProcessInstance["@attributes"].StartDate,at=q.ProcessInstance["@attributes"].Status,vt=q.ProcessInstance.Description["#text"],yt=q.ProcessInstance.Metadata["#text"]?q.ProcessInstance.Metadata["#text"]:"",pt=q.ProcessInstance["@attributes"].Name,oq=q.ProcessInstance["@attributes"].ID,wt=q.ProcessInstance["@attributes"].ExpectedDuration,bt=q.ProcessInstance["@attributes"].FullName,kt=q.ProcessInstance["@attributes"].Guid,sq=q.ProcessInstance.ViewFlow["#text"],o="";SourceCode.Forms.Settings.User.FQN.toLowerCase()!==e.toLowerCase()&&(p+="&SharedUser="+e);var nq=!0;if(q.Action)if(typeof q.Action.length=="undefined"&&(nq=this.base._booleanConverter(q.Action["@attributes"].Batchable)),q.Action.length>0)for(var tq=0,u=0;u<q.Action.length;u++)this.base._booleanConverter(q.Action[u]["@attributes"].Batchable)!==!1&&(tq!=0?o=o+"|"+q.Action[u]["@attributes"].Name:o+=q.Action[u]["@attributes"].Name,tq++);else o=q.Action["@attributes"].Name;else o="";if(nq===!1&&(o=""),gt>0){var s="";if(q.DelagateItem)if(q.DelagateItem.length>0){for(var u=0;u<q.DelagateItem.length;u++)s+=q.DelagateItem[u]["@attributes"].Name+";";s=s.substring(0,s.length-1)}else s=q.DelagateItem["@attributes"].Name;else s=""}var h=new Date,hq=h.getUTCFullYear()+"-"+(h.getUTCMonth()+1)+"-"+h.getUTCDate()+"T"+h.getUTCHours()+":"+h.getUTCMinutes()+":"+h.getUTCSeconds()+"Z",c=hq.split(/[-T:\.Z]/i),cq=new Date(Date.UTC(c[0],c[1]-1,c[2],c[3],c[4],c[5])),l=w.split(/[-T:\.Z]/i),lq=new Date(Date.UTC(l[0],l[1]-1,l[2],l[3],l[4],l[5]));if(parseInt(a)===0)v=!1;else{var aq=(cq.getTime()-lq.getTime())/1e3;v=aq>parseInt(a)?!0:!1}var vq={Checkbox:null,Priority:b,EventName:nt,EventMetaData:tt,ProcessDescription:vt,ProcessMetadata:yt,ActivityStartDate:w,OriginalDestination:e,ActivityInstanceOverdue:v,Folio:k,EventDescription:rt,ProcessFolder:ct,ProcessStartDate:lt,ProcessStatus:at,ActivityExpectedDuration:a,EventPriority:ut,Data:p,EventStartDate:qt,ProcessName:pt,ProcessID:oq,ProcessExpectedDuration:wt,ActivityName:et,ActivitySystemName:eq,ActivityMetadata:ot,ActivityInstancePriority:st,SerialNumber:d,EventExpectedDuration:ft,ProcessFullName:bt,ProcessGUID:kt,ActivityDescription:ht,Status:g,DueDate:fq,Action:o,IsSelected:!1,IsVisible:!0,ViewFlow:sq,FirstKeywords:": "+b+",folio: "+k+",activity name: "+et+",status: "+g,SecondaryKeywords:"process name: "+pt+",process full name: "+bt+",event name: "+nt+",event start date: "+qt+",original destination: "+e,ThirdKeywords:"event meta data: "+tt+",process description: "+vt+",process meta data: "+yt+",activity start date: "+w+",activity instance overdue: "+v+",event description: "+rt+",process folder: "+ct+",process start date: "+lt+",process status: "+at+",activity expected duration: "+a+",event priority: "+ut+",data: "+p+",process expected duration: "+wt+",activity meta data: "+ot+",activity instance priority: "+st+",serial number: "+d+",event expected duration: "+ft+",process guid: "+kt+",activity description: "+ht+",",TotalKeywords:"priority: "+b+",folio: "+k+",activity name: "+et+",status: "+g+"process name: "+pt+",process full name: "+bt+",event name: "+nt+",event start date: "+qt+",original destination: "+e+"event meta data: "+tt+",process description: "+vt+",process meta data: "+yt+",activity start date: "+w+",activity instance overdue: "+v+",event description: "+rt+",process folder: "+ct+",process start date: "+lt+",process status: "+at+",activity expected duration: "+a+",event priority: "+ut+",data: "+p+",process expected duration: "+wt+",activity meta data: "+ot+",activity instance priority: "+st+",serial number: "+d+",event expected duration: "+ft+",process guid: "+kt+",activity description: "+ht+","};if(uq.GlobalArrayOfWorklistItems.push(vq),SourceCode.Forms.Settings.User.FQN.toLowerCase()!==e.toLowerCase()){var yq=e.toUpperCase();this.updateOOFCache(yq,y)}}this.getOOFStatusForEachItem()},getSelectedWorkItemNumber:function(){var n=this.element.find(".SelectedDivBackground"),q=this.element.find(".ShowMenu");q.hasClass("SelectedDivBackground")||(n=q);for(var r=[],t=0;t<n.length;t++)r.push(n[t].getAttribute("data-serial"));return r},GetPicker:function(t,q){var e=this,r=n("#"+q),o={type:t,controlId:q},f=!1,u=null;switch(t){case"filterconfig":u="PickerCollectionFilterPicker.sdk";break;case"shareConfig":u="PickerCollectionSharePicker.sdk";break;case"redirectConfig":u="PickerCollectionRedirectPicker.sdk";break;case"sleepConfig":u="PickerCollectionSleepPicker.sdk";break;case"oofConfig":u="PickerCollectionOOFPicker.sdk"}return n.ajax({url:applicationRoot+u,dataType:"text",data:o,async:!1,type:"POST",beforeSend:function(n){r.wrap('<div class="ajaxLoader" style="width:'+r.width()+';"><\/div>');var t=r[0].style;t.opacity=.3;SourceCode.Forms.XSRFHelper.setAntiXSRFHeader(n)},success:function(t){n(document.body).append(n(t).hide());var q=r[0].style;q.opacity=1;r.unwrap("div.ajaxLoader");f=!0},error:function(){popupManager.showWarning("Unable to connect to server");var n=r[0].style;n.opacity=1;r.unwrap("div.ajaxLoader");f=!1},complete:function(){e._restoreTableScrollPosition()}}),f},hide_menu:function(t,q){var r=this;typeof t!="undefined"&&(r=t);var u=function(){n("[id$='_actionMenuPopup']").length<1&&n(".ShowMenu",r.element).removeClass("ShowMenu")};if(typeof q!="undefined")q.fadeOut("slow",function(){n(this).remove();u()}),this.element.find(".tempFocus").trigger("focus");else if(typeof r.element!="undefined"){var e=r.element.attr("id")+"_actionMenuPopup",f=n("#"+e);f.length>0&&f.fadeOut("slow",function(){n(this).remove();u()});r.element.find(".tempFocus").trigger("focus")}},_setIntervalWithContext:function(n,t,q){return setInterval(function(){n.call(q)},t)},_startIntervalRefresh:function(){if(parseInt(this.options.RefreshInterval)!==0){var t=this;t.interval=t._setIntervalWithContext(function(){n("#"+t.worklistID+"refreshInput").addClass("RefreshInputLoading");t.getWorklistFromServer()},parseInt(t.options.RefreshInterval)*1e3,t)}},_clearOpenInterval:function(n){var q=this,r=jQuery.isEmptyObject(this.options.openStatusTimer);if(r)return!1;if(n===null||typeof n=="undefined"){for(var t in this.options.openStatusTimer)this.options.openStatusTimer.hasOwnProperty(t)&&clearInterval(q.options.openStatusTimer[t]);this.options.OpenStatusCounter={}}else clearInterval(this.options.openStatusTimer[n]),this.options.OpenStatusCounter[n]=0},LoadMoreUpdate:function(){var q=this.element.find(".WorklistItemGridRow").length,n=this.GlobalArrayOfWorklistItems.length;if(q<n){var t=0;this.element.find(".LastRowCell").height("10px");t=n-q;t=t>=this.options.Rows?this.options.Rows:n%q;this.element.find(".loadmore").show();this.element.find(".LoadMoreHyperlink").html(ControlResources.SourceCode.Forms.Controls.Web.ControlPack.Properties.Worklist.labelLoadMore.replace("{0}",t));this.element.find(".LoadMoreHyperlink").show()}else this.element.find(".loadmore").hide(),n>this.options.Rows&&this.element.find(".WorklistItemGridRow").last().trigger("focus")},SelectAllClick:function(){this.element.hasClass("worklist-all-checkbox-selected")?this.DeselectAll():this.SelectAll()},handleConnectionErrorPushItemToActionQueue:function(n,t){var e=this.element.attr("id")+"_actionsQueue",q=JSON.parse(localStorage.getItem(e));q===null&&(q=[]);for(var u=0;u<n.length;u++){var f=n[u],o="Worklist.sdk?method=get&serial="+f+"&action="+t,r={};r.Url=o;r.ID=f;r.worklistArray=f.split("__");q.push(r)}localStorage.setItem(e,JSON.stringify(q))},prepareUrlToNavigate:function(n){return n!=null&&SourceCode.Forms.Browser.msie&&(n=n.replace(/&/g,"&amp;")),n},displayActionMenu:function(t){var q=this,ft="SelectedDivBackground",k=!1;typeof t!="undefined"&&(ft="ShowMenu");var f=this.element.find("."+ft),y=this.element.attr("id")+"_actionMenuPopup",r=n("#"+y);r.length>0&&r.remove();n("body").append('                 <div tabIndex="0" id={0} class="worklist-action-popup">                     <div class="worklist-action-menu-container">                    <\/div>                 <\/div>'.format(y));r=n("#"+y);var s=r.find(".worklist-action-menu-container"),p=f.length,et=q.GlobalArrayOfWorklistItems.length,h=!0;if(p>1){for(var c=[],d=!0,g=!0,nt="",ot=[],u=0;u<p;u++){var e=f[u].getAttribute("data-serial");if(c.push(e),d&&(d=this.checkReleasable(n(f[u]))),g){var st=f[u].getAttribute("data-actions");nt.length>0&&st!==nt&&(g=!1);nt=st}for(var l=0;l<et;l++)if(e===q.GlobalArrayOfWorklistItems[l].SerialNumber){ot.push(q.GlobalArrayOfWorklistItems[l].OriginalDestination);h&&checkExists(q.GlobalArrayOfWorklistItems[l].OrigDestIsInOffice)&&(h=q.GlobalArrayOfWorklistItems[l].OrigDestIsInOffice);break}}if(g){var a=f[0].getAttribute("data-actions").split("|");if(a[0].length>0)for(var u=0;u<a.length;u++){var v=a[u];s.append('<div tabIndex="0" class="worklist-action-menu-right-cell worklist-action-link" title="{1}" style="overflow:hidden" data-action={0}>                                     <span class="worklist-action-text">{1}<\/span>                                 <\/div>'.format(encodeURIComponent(v),v))}}else{var pt=this.base._booleanConverter(this.options.showRelease),wt=this.base._booleanConverter(this.options.showSleep),bt=this.base._booleanConverter(this.options.showRedirect),kt=this.base._booleanConverter(this.options.showShare);pt||wt||bt||kt||s.append('<div class="worklist-action-menu-right-cell worklist-action-menu-right-cell-no-hover">                                     <span class="No-Item">{0}<\/span>                                 <\/div>'.format(ControlResources.SourceCode.Forms.Controls.Web.ControlPack.Properties.PickerCollection.NoActions))}this.RenderActionMenuBottomRow(d,k);var tt=r.find(".worklist-action-icon-share");tt.addClass("disabled");var qt=r.find(".worklist-action-icon-redirect");qt.addClass("disabled");h=!1;r.find(".worklist-action-link").on("click",function(){var r=q.options.hostURL+"/K2Services/rest.svc/Worklist/Items",t=this.getAttribute("data-action");n.ajax({url:applicationRoot+"Worklist.sdk",type:"POST",dataType:"XML",data:{call:"GetWorklist"},cache:!1,async:!0,beforeSend:function(n){SourceCode.Forms.XSRFHelper.setAntiXSRFHeader(n)},success:function(r){var u=q.element.find(".RefreshInput");u.removeClass("RefreshInputLoading");u.removeClass("RefreshInputError");u.removeClass("RefreshInputGray");var h=q.xmlToJson(r);if(SourceCode.Forms.ExceptionHandler.isException(r))q.options.ErrorData=r,q.handleRefreshErrorStack(ControlResources.SourceCode.Forms.Controls.Web.ControlPack.Properties.PickerCollection.WorklistErrorOccured,q.options.ErrorData),q.handleConnectionErrorPushItemToActionQueue(c,t);else{var s=q.element.attr("id");u.addClass("RefreshInputLoading");u.attr("title",ControlResources.SourceCode.Forms.Controls.Web.ControlPack.Properties.Worklist.RefreshTooltipActioningItems);u.off("mouseenter mouseleave");var e=n("#"+s+"_RefreshErrorTooltip");e.length!==0&&(e[0].style.display="none");for(var o=0,f=0;f<p;f++)n.ajax({url:applicationRoot+"Worklist.sdk",type:"POST",data:{call:"execute",serial:c[f],action:t,sharedUser:ot[f],managedUser:""},beforeSend:function(n){SourceCode.Forms.XSRFHelper.setAntiXSRFHeader(n)},success:function(){o++;o===p&&(u.attr("title",ControlResources.SourceCode.Forms.Controls.Web.ControlPack.Properties.Worklist.RefreshTooltipRefreshing),n("#"+q.worklistID+"refreshInput").trigger("click"))}}),q.RemoveWorklistItem(c[f])}},error:function(){q.handleConnectionErrorPushItemToActionQueue(c,t);for(var n=0;n<numberOfItems;n++)q.RemoveWorklistItem(c[n])}});q.options.SelectedAction=n(this).find(".worklist-action-text").text();raiseEvent(q.element.attr("id"),"Control","Actioned");q.hide_menu()})}else{f=f.closest(".WorklistItemGridRow");var e=f.attr("data-serial");this.options.Status!=="Allocated"&&s.append('<div tabIndex="0" class="worklist-action-menu-right-cell worklist-action-open-form enhanced-color">                             <span class="worklist-action-icon-open-form"><\/span>                             <span class="worklist-action-text">{0}<\/span>                         <\/div>'.format(ControlResources.SourceCode.Forms.Controls.Web.ControlPack.Properties.PickerCollection.ActionMenuItemOpenForm));var a=f.attr("data-actions").split("|");if(a[0].length>0)for(var u=0;u<a.length;u++){var v=a[u],dt=q.GlobalURL+"("+e+")/Actions("+encodeURIComponent(v)+")/Execute";s.append("<div tabIndex='0' class='worklist-action-menu-right-cell worklist-action-link' data-serial={0} data-url={1} data-action={2}>                                 <div class='customActions'>                                     <span title='{3}'class='worklist-action-text'>{3}<\/span>                                 <\/div>                             <\/div>".format(e,dt,encodeURIComponent(v),v))}this.options.showViewWorkflow&&s.append('<div tabIndex="0" class="worklist-action-menu-right-cell worklist-action-view-flow enhanced-color">                             <span class="worklist-action-text">{0}<\/span>                             <span class="worklist-action-icon-view-flow"><\/span>                         <\/div>'.format(ControlResources.SourceCode.Forms.Controls.Web.ControlPack.Properties.PickerCollection.ActionMenuItemViewWorkflow));k=this.options.Status==="Sleep"?!0:!1;this.RenderActionMenuBottomRow(this.checkReleasable(f),k);for(var rt=r.find(".worklist-action-open-form"),gt=r.find(".worklist-action-view-flow"),ht="",u=0;u<et;u++)if(q.GlobalArrayOfWorklistItems[u].SerialNumber===e){rt.attr("data-url",this.GlobalArrayOfWorklistItems[u].Data);rt.attr("data-serial",this.GlobalArrayOfWorklistItems[u].SerialNumber);rt.attr("data-action",this.GlobalArrayOfWorklistItems[u].Action);gt.attr("data-url",this.GlobalArrayOfWorklistItems[u].ViewFlow);ht=q.GlobalArrayOfWorklistItems[u].OriginalDestination;checkExists(q.GlobalArrayOfWorklistItems[u].OrigDestIsInOffice)&&q.GlobalArrayOfWorklistItems[u].OrigDestIsInOffice===!1&&(h=!1);break}var tt=r.find(".worklist-action-icon-share");if(h)n(tt).on("click",function(n){if(q.hide_menu(),!q.options.isPickerOpen){n.preventDefault();var t=q.element.find(".ShowMenu");typeof t[0]=="undefined"&&(t=q.element.find(".SelectedDivBackground"),typeof t[0]=="undefined"&&(t=q.element.find(".tempFocus")));var r=q.GetPicker("shareConfig",q.element.attr("id"));r&&initializeSharePickerRuntime(q,e,q.worklistID,q.delegateTask)}});else tt.addClass("disabled");r.find(".worklist-action-link").on("click",function(){var r=this.getAttribute("data-url"),t=this.getAttribute("data-action");q.RemoveWorklistItem(e);n.ajax({url:applicationRoot+"Worklist.sdk",dataType:"text",type:"POST",data:{call:"execute",serial:e,action:t,sharedUser:ht,managedUser:""},beforeSend:function(n){SourceCode.Forms.XSRFHelper.setAntiXSRFHeader(n)},success:function(n){q._validateResponse(n);var r=q.element.find(".RefreshInput");r.removeClass("RefreshInputLoading");r.removeClass("RefreshInputError");r.removeClass("RefreshInputGray");SourceCode.Forms.Runtime.MobileBridge.sendToMobileDevice({methodName:"taskActioned",serialNumber:e,actionName:t})},error:function(){q.handleConnectionErrorPushItemToActionQueue([e],t)}});q.options.SelectedAction=n(this).find(".worklist-action-text").text();raiseEvent(q.element.attr("id"),"Control","Actioned");q.hide_menu()});r.find(".worklist-action-open-form").off("click").on("click",function(){q.hide_menu();var t=this.getAttribute("data-serial"),r=this.getAttribute("data-action");q.options.openStatusTimer.hasOwnProperty(t)||(q.options.OpenStatusCounter[t]=0,q.options.openStatusTimer[t]=setInterval(function(){q.options.OpenStatusCounter[t]<10?(n.ajax({url:applicationRoot+"WorklistItemStatus",type:"POST",data:{serial:t},dataType:"json",async:!0,beforeSend:function(n){SourceCode.Forms.XSRFHelper.setAntiXSRFHeader(n)},success:function(n){n===1&&q.getWorklistFromServer()},error:function(){q.handleConnectionErrorPushItemToActionQueue([e],r)}}),q.options.OpenStatusCounter[t]++):q._clearOpenInterval(t)},2e3));window.open(q.prepareUrlToNavigate(this.getAttribute("data-url")),"_blank")});r.find(".worklist-action-view-flow").off("click").on("click",function(){q.hide_menu();window.open(q.prepareUrlToNavigate(this.getAttribute("data-url")),"_blank")})}var nq=s.find(".worklist-action-menu-right-cell").length*33;r[0].style.height=nq+"px";var tq=n(window).width(),ct=n(window).height(),lt=160,at=this.element.find(".ShowMenu").find(".SelectArrowImageDiv"),ut=at.offset().left,w=at.offset().top;tq-lt<ut&&(ut-=lt);var vt=parseInt(r[0].style.height.replace(/px/,"")),yt=n(window).scrollTop();if(w+vt>ct+yt){var qq=vt-ct+w-yt;w-=qq+10}r[0].style.left=ut+"px";r[0].style.top=w+"px";r.trigger("focus");var rq=r.find(".worklist-action-icon-release"),uq=r.find(".worklist-action-icon-sleep"),qt=r.find(".worklist-action-icon-redirect");n(rq).off("click").on("click",function(){if(!n(this).hasClass("disabled")){q.hide_menu();for(var r=q.getSelectedWorkItemNumber(),t=0;t<r.length;t++)q.releaseTask(r[t],q)}});n(uq).off("click").on("click",function(){if(!n(this).hasClass("disabled")&&(q.hide_menu(),!q.options.isPickerOpen)){var t=q.GetPicker("sleepConfig",q.element.attr("id"));if(t){var r=q.getSelectedWorkItemNumber();initializeSleepPickerRuntime(q,r,q.worklistID,q.sleepTask)}}});if(h)n(qt).on("click",function(){if(q.hide_menu(),!q.options.isPickerOpen){var n=q.GetPicker("redirectConfig",q.element.attr("id"));if(n){var t=q.getSelectedWorkItemNumber();initializeRedirectPickerRuntime(q,t,q.worklistID,q.redirectTask)}}});else qt.addClass("disabled");r=n("#"+y);var b=1e3,o=setTimeout(function(){q.hide_menu(q,r)},b);clearTimeout(o);r.off("mouseenter mouseleave").on("mouseenter",function(){clearTimeout(o)}).on("mouseleave",function(){o=setTimeout(function(){q.hide_menu(q,r)},b)});f.find(".WorklistTableSelectGridArrow").off("mouseenter mouseleave").on("mouseenter",function(){clearTimeout(o)}).on("mouseleave",function(){o=setTimeout(function(){q.hide_menu(q,r)},b)});f.find(".shadedCol").off("mouseenter mouseleave").on("mouseenter",function(){clearTimeout(o)}).on("mouseleave",function(){o=setTimeout(function(){q.hide_menu(q,r)},b)});r.on("keydown",function(t){var u=n(":focus");switch(t.keyCode){case 27:q.hide_menu(q,r);break;case 13:case 32:t.preventDefault();!1===u.hasClass("worklist-action-popup")&&u.trigger("click");break;case 37:case 38:if(t.preventDefault(),u.hasClass("worklist-action-icon")){var f=u.prev();f.hasClass("disabled")||f.length===0?u.parent().prev().trigger("focus"):f.trigger("focus")}else u.hasClass("worklist-action-menu-right-cell")&&u.prev().trigger("focus");break;case 39:case 40:if(t.preventDefault(),u.hasClass("worklist-action-popup"))u.find('[tabIndex="0"]')[0].focus();else if(u.hasClass("worklist-action-menu-right-cell"))u.next().trigger("focus"),u=n(":focus"),u.attr("tabIndex")!==0&&u.find('[tabIndex="0"]').length>0&&u.find('[tabIndex="0"]')[0].focus();else if(u.hasClass("worklist-action-icon")){var e=u.next();e.hasClass("disabled")||e.trigger("focus")}}})},handleConnectionErrorForTask:function(n){var q=this.element.attr("id")+"_actionsQueue",t=JSON.parse(localStorage.getItem(q));t===null&&(t=[]);var r={};r.Url=this.options.hostURL+n;t.push(r);localStorage.setItem(q,JSON.stringify(t))},removeRowSelectedState:function(){var n=this.element.find(".SelectedDivBackground");n.find(".input-control.checkbox").removeClass("checked");n.removeClass("SelectedDivBackground")},RenderActionMenuBottomRow:function(t,q){var e=this.base._booleanConverter(this.options.showRelease),o=this.base._booleanConverter(this.options.showSleep),s=this.base._booleanConverter(this.options.showRedirect),h=this.base._booleanConverter(this.options.showShare);if(e||o||s||h){var c=n("#"+this.element.attr("id")+"_actionMenuPopup").find(".worklist-action-menu-container"),r='<div tabIndex="-1" class="worklist-action-menu-right-cell last">';if(e){var u="",f='tabIndex="0"';t===!1&&(u="disabled",f='tabIndex="-1"');r+="<span "+f+' class="worklist-action-icon-release worklist-action-icon '+u+'" title="'+ControlResources.SourceCode.Forms.Controls.Web.ControlPack.Properties.PickerCollection.Release+'"><\/span>'}if(o){var u="",f='tabIndex="0"';q&&(u="disabled",f='tabIndex="-1"');r+="<span "+f+' class="worklist-action-icon-sleep worklist-action-icon '+u+'" title="'+ControlResources.SourceCode.Forms.Controls.Web.ControlPack.Properties.PickerCollection.Sleep+'"><\/span>'}s&&(r+='<span tabIndex="0" class="worklist-action-icon-redirect worklist-action-icon" title="'+ControlResources.SourceCode.Forms.Controls.Web.ControlPack.Properties.PickerCollection.Redirect+'"><\/span>');h&&(r+='<span tabIndex="0" class="worklist-action-icon-share worklist-action-icon" title="'+ControlResources.SourceCode.Forms.Controls.Web.ControlPack.Properties.PickerCollection.Share+'"><\/span>');r+="<\/div>";c.append(r)}},releaseTask:function(t,q){for(var r=this,o=q.element.attr("id"),s=SourceCode.Forms.Settings.User.FQN.toLowerCase(),f,u=0;u<q.GlobalArrayOfWorklistItems.length;u++)if(t===q.GlobalArrayOfWorklistItems[u].SerialNumber){f=q.GlobalArrayOfWorklistItems[u].OriginalDestination;break}var e="/K2Services/rest.svc/Worklist/Items("+t+")/Actions/Release";n.ajax({type:"POST",dataType:"text",url:applicationRoot+"Worklist.sdk",data:{call:"release",serial:t,sharedUser:f,managedUser:s},beforeSend:function(n){SourceCode.Forms.XSRFHelper.setAntiXSRFHeader(n)},success:function(t){if(t.length!==0){var q=n.parseXML(t),u=r.xmlToJson(q);SourceCode.Forms.ExceptionHandler.isException(t)&&r.handleConnectionErrorForTask(e)}else r.getWorklistFromServer(),raiseEvent(o,"Control","Released")},error:function(){r.handleConnectionErrorForTask(e)}})},delegateTask:function(t,q,r){var f=r.element.attr("id"),u="/K2Services/rest.svc/Worklist/Items("+t+")/Actions/Delegate?destination="+q;n.ajax({type:"POST",dataType:"text",data:{call:"delegate",serial:t,user:q},url:applicationRoot+"Worklist.sdk",beforeSend:function(n){SourceCode.Forms.XSRFHelper.setAntiXSRFHeader(n)},success:function(t){if(r._validateResponse(t),t.length!==0){var q=n.parseXML(t),e=r.xmlToJson(q);SourceCode.Forms.ExceptionHandler.isException(t)&&r.handleConnectionErrorForTask(u)}else r.getWorklistFromServer(),raiseEvent(f,"Control","Shared")},error:function(){r.handleConnectionErrorForTask(u)}})},redirectTask:function(t,q,r){var u=this.controlId,f="/K2Services/rest.svc/Worklist/Items("+t+")/Actions/Redirect?destination="+q;n.ajax({type:"POST",dataType:"text",data:{call:"redirect",serial:t,user:q},url:applicationRoot+"Worklist.sdk",beforeSend:function(n){SourceCode.Forms.XSRFHelper.setAntiXSRFHeader(n)},success:function(q){if(r._validateResponse(q),q.length!==0){var e=n.parseXML(q),o=r.xmlToJson(e);SourceCode.Forms.ExceptionHandler.isException(q)&&r.handleConnectionErrorForTask(f)}else r._clearOpenInterval(),r.RemoveWorklistItem(t),raiseEvent(u,"Control","Redirected")}})},sleepTask:function(t,q,r){for(var o=SourceCode.Forms.Settings.User.FQN.toLowerCase(),f,u=0;u<r.GlobalArrayOfWorklistItems.length;u++)if(t===r.GlobalArrayOfWorklistItems[u].SerialNumber){f=r.GlobalArrayOfWorklistItems[u].OriginalDestination;break}var s=this.controlId,e="/K2Services/rest.svc/Worklist/Items("+t+")/Actions/Sleep?duration="+q;n.ajax({type:"POST",dataType:"text",data:{call:"sleep",duration:q,serial:t,sharedUser:f,managedUser:o},url:applicationRoot+"Worklist.sdk",beforeSend:function(n){SourceCode.Forms.XSRFHelper.setAntiXSRFHeader(n)},success:function(t){if(r._validateResponse(t),t.length!==0){var q=n.parseXML(t),u=r.xmlToJson(q);SourceCode.Forms.ExceptionHandler.isException(t)&&r.handleConnectionErrorForTask(e)}else r.getWorklistFromServer(),raiseEvent(s,"Control","Sleeping")},error:function(){r.handleConnectionErrorForTask(e)}})},SelectAll:function(){this.element.find(".WorklistItemGridRow").addClass("SelectedDivBackground");this.element.find(".input-control.checkbox").addClass("checked");for(var q=this.element.find(".SelectedDivBackground"),t=0;t<q.length;t++){var r=n(q[t]).attr("id");this.options.WorklistState[r]=r}this.element.addClass("worklist-all-checkbox-selected")},DeselectAll:function(){n("#"+this.worklistID+"selectAll").prop("checked",!1);this.element.find(".input-control.checkbox").removeClass("checked");this.element.find(".WorklistItemGridRow:visible").removeClass("SelectedDivBackground");this.options.WorklistState=[];this.element.removeClass("worklist-all-checkbox-selected")},CheckFilterCommand:function(n){for(var c=n.split(";"),t=!1,q=[],r=0;r<self.globalViewModel.items().length;r++){q=[];for(var e=0;e<c.length;e++){var o=c[e].split(","),l=o[0],f=o[1],u=o[2];switch(l){case"Activity Name":switch(f){case"Begins With":self.globalViewModel.items()[r].ActivityName().match("^"+u)?(t=!0,q.push(t)):(t=!1,q.push(t));break;case"Contains":self.globalViewModel.items()[r].ActivityName().indexOf(u)!=-1?(t=!0,q.push(t)):(t=!1,q.push(t));break;case"Ends With":self.globalViewModel.items()[r].ActivityName().match(u+"$")?(t=!0,q.push(t)):(t=!1,q.push(t));break;case"Equals":self.globalViewModel.items()[r].ActivityName()==u?(t=!0,q.push(t)):(t=!1,q.push(t));break;case"Not Equals":self.globalViewModel.items()[r].ActivityName()!=u?(t=!0,q.push(t)):(t=!1,q.push(t))}break;case"Activity Start Date":switch(f){case"Begins With":self.globalViewModel.items()[r].ActivityStartDate().match("^"+u)?(t=!0,q.push(t)):(t=!1,q.push(t));break;case"Contains":self.globalViewModel.items()[r].ActivityStartDate().indexOf(u)!=-1?(t=!0,q.push(t)):(t=!1,q.push(t));break;case"Ends With":self.globalViewModel.items()[r].ActivityStartDate().match(u+"$")?(t=!0,q.push(t)):(t=!1,q.push(t));break;case"Equals":self.globalViewModel.items()[r].ActivityStartDate()==u?(t=!0,q.push(t)):(t=!1,q.push(t));break;case"Not Equals":self.globalViewModel.items()[r].ActivityStartDate()!=u?(t=!0,q.push(t)):(t=!1,q.push(t))}break;case"Folio":switch(f){case"Begins With":self.globalViewModel.items()[r].Folio().match("^"+u)?(t=!0,q.push(t)):(t=!1,q.push(t));break;case"Contains":self.globalViewModel.items()[r].Folio().indexOf(u)!=-1?(t=!0,q.push(t)):(t=!1,q.push(t));break;case"Ends With":self.globalViewModel.items()[r].Folio().match(u+"$")?(t=!0,q.push(t)):(t=!1,q.push(t));break;case"Equals":self.globalViewModel.items()[r].Folio()==u?(t=!0,q.push(t)):(t=!1,q.push(t));break;case"Not Equals":self.globalViewModel.items()[r].Folio()!=u?(t=!0,q.push(t)):(t=!1,q.push(t))}break;case"Workflow Name":switch(f){case"Begins With":self.globalViewModel.items()[r].ProcessName().match("^"+u)?(t=!0,q.push(t)):(t=!1,q.push(t));break;case"Contains":self.globalViewModel.items()[r].ProcessName().indexOf(u)!=-1?(t=!0,q.push(t)):(t=!1,q.push(t));break;case"Ends With":self.globalViewModel.items()[r].ProcessName().match(u+"$")?(t=!0,q.push(t)):(t=!1,q.push(t));break;case"Equals":self.globalViewModel.items()[r].ProcessName()==u?(t=!0,q.push(t)):(t=!1,q.push(t));break;case"Not Equals":self.globalViewModel.items()[r].ProcessName()!=u?(t=!0,q.push(t)):(t=!1,q.push(t))}}}for(var s=!0,h=0;h<q.length;h++)s=s&&q[h];s&&self.globalViewModel.items()[r].isActive(!0)}},OpenItem:function(){var n=this;setTimeout(function(){n.getWorklistFromServer()},5e3)},LoadSimpleLayout:function(){var t=this;t.element.find(".SelectAllSimpleSectionRow").hide();this.element.find(".CheckboxInput").on("click",function(){if(n(this).toggleClass("CheckboxInputOff"),n(this).toggleClass("OptionSelectBorderOff"),n(this).hasClass("OptionSelectBorderOff")){t.element.removeClass("worklist-multiselect-mode");try{t.DeselectAll();t.prevEvent=null}catch(r){}n("#"+t.worklistID+"gridChxBox").hide();t.element.find(".SelectAllSimpleSectionRow").hide();t.options.showToolBar||(t.element.find(".WorklistTableCheckbox.GridCheckbox").hide(),t.element.find(".SelectAllTD").hide());t.element.find(".WorklistTableCheckbox").hide();n("#"+t.worklistID+"SelectAllSimple").prop("checked",!1)}else if(t.element.addClass("worklist-multiselect-mode"),n("#"+t.worklistID+"gridChxBox").show(),t.element.find(".WorklistTableCheckbox").show(),t.element.find(".SelectAllSimpleSectionRow").show(),t.options.showToolBar){n("#"+t.worklistID+"gridChxBox").show();t.element.find(".WorklistTableCheckbox").show();t.element.find(".SelectAllSimpleSectionRow").show();var q=t.element.find(".WorklistItemGridRow.SelectedDivBackground");q.find(".input-control.checkbox").addClass("checked");t.CheckAllSelectCheckbox()}t.setHeightRuntime()});n("#"+this.worklistID+"SelectAllSimple").on("click",function(){t.SelectAllClick()});this.element.find(".SearchInput").on("click",function(){if(n(this).toggleClass("OptionSelectBorderOff"),n(this).hasClass("OptionSelectBorderOff")){t.element.removeClass("search-section-active");var q=n("#"+t.worklistID+"SearchInputBox").val();q!==""&&n("#"+t.worklistID+"SearchClear").trigger("click");t.element.find(".searchBar").hide();n(this).removeClass("SearchInputOff")}else t.element.addClass("search-section-active"),n(this).addClass("SearchInputOff"),t.element.find(".searchBar")[0].style.display="table",n("#"+t.worklistID+"SearchInputBox").trigger("focus");t.setHeightRuntime()});SourceCode.Forms.Browser.msie&&this.element.find(".AllWorklistCheckBoxes ").parent().addClass("SelectAllIE")},LoadGridLayout:function(){var t=this,q=n("#"+t.worklistID+"selectAll");q.on("click",function(){t.SelectAllClick()});n("#"+t.worklistID+"gridChxBox").on("keydown",function(n){switch(n.keyCode){case 13:case 32:q.prop("checked",!q.prop("checked"));t.SelectAllClick()}});this.element.find(".SearchInput").on("click",function(){if(n(this).toggleClass("OptionSelectBorderOff"),n(this).hasClass("OptionSelectBorderOff")){t.element.removeClass("search-section-active");var q=n("#"+t.worklistID+"SearchInputBox").val();q!==""&&n("#"+t.worklistID+"SearchClear").trigger("click");t.element.find(".searchBar").hide();n(this).removeClass("SearchInputOff")}else t.element.addClass("search-section-active"),n(this).addClass("SearchInputOff"),document.dir==="rtl"&&(t.element.find(".searchBar").children()[0].style.float="left"),t.element.find(".searchBar")[0].style.display="table",n("#"+t.worklistID+"SearchInputBox").trigger("focus");t.setHeightRuntime()});var r=function(){if((SourceCode.Forms.Browser.msie||t._browser.msedge)&&parseInt(SourceCode.Forms.Browser.version)>=9&&n(".WorklistItemSectionDiv",t.element).is(":empty")){var q=n(".WorkListItemTableHeader",t.element).width();n(".WorkListItemTable",t.element).css("min-width",q+"px")}};this.element.find(".CheckboxInput").on("click",function(){var f=32;if(n(this).toggleClass("CheckboxInputOff"),n(this).toggleClass("OptionSelectBorderOff"),n(this).hasClass("OptionSelectBorderOff")){t.element.removeClass("worklist-multiselect-mode");n("#"+t.worklistID+"gridChxBox").hide();t.element.find(".BlankCheckBox").hide();t.StyleGridHeaders();try{t.DeselectAll();t.prevEvent=null}catch(l){}t.element.find(".WorklistTableCheckbox").hide();var q=t.element.find(".WorkListItemTableHeader .worklist-grid-view-visible-column"),u=q.length-1,e=t.element.find(".WorkListItemTableHeader").outerWidth()>t.element.find(".WorklistItemSectionCell").outerWidth();if(e){var o=t.element.find(".WorklistItemSectionCell").outerWidth()===n(".WorklistItemSectionCell",t.element)[0].scrollWidth;t.SetVisibleColumnWidth(u,parseInt(q[u].style.width)+f+"px");r();o&&n(".WorkListGridTableBody",t.element).scrollLeft(n(".WorkListGridTableBody",t.element).scrollLeft()+f)}}else{t.element.addClass("worklist-multiselect-mode");var s=t.element.find(".WorklistItemSectionCell").outerWidth()===n(".WorklistItemSectionCell",t.element)[0].scrollWidth;if(t.options.showToolBar){n("#"+t.worklistID+"gridChxBox").show();t.element.find(".BlankCheckBox").show();t.StyleGridHeaders();t.element.find(".WorklistTableCheckbox").show();var h=t.element.find(".WorklistItemGridRow.SelectedDivBackground");h.find(".input-control.checkbox").addClass("checked");t.CheckAllSelectCheckbox();var q=t.element.find(".WorkListItemTableHeader .worklist-grid-view-visible-column"),u=q.length-1;if(t.SetVisibleColumnWidth(u,parseInt(q[u].style.width)-f+"px"),r(),n(".WorkListItemTableHeader",t.element).offset({left:n(".WorkListItemTable",t.element).offset().left}),(SourceCode.Forms.Browser.msie||t._browser.msedge)&&s){var c=n(".WorkListGridTableBody",t.element).scrollLeft()+(n(".WorklistItemSectionCell",t.element)[0].scrollWidth-t.element.find(".WorklistItemSectionCell").outerWidth());n(".WorkListGridTableBody",t.element).scrollLeft(c)}}}(!SourceCode.Forms.Browser.chrome||t._browser.msedge)&&t.CheckForScrollBar()});n("#"+t.worklistID+"gridChxBox").hide()},ZebraStripeRows:function(){var n=this.element.find(".WorkListItemTable");this.options.viewType=="Grid"&&(n.find(".worklist-grid-even").removeClass("worklist-grid-even"),n.find(".worklist-grid-odd").removeClass("worklist-grid-odd"),n.find("tr").even().addClass("worklist-grid-even"),n.find("tr").odd().addClass("worklist-grid-odd"))},HandleWaterMark:function(){var t=!1;this.GlobalArrayOfWorklistItems.length>0&&(t=!0);t?(n("#"+this.worklistID+"watermark").hide(),n("#"+this.worklistID+"searchWatermark").hide(),this.options.showSearchWaterMark=!1):(this.element.find("div.loadmore").hide(),this.options.showSearchWaterMark?(n("#"+this.worklistID+"watermark").hide(),n("#"+this.worklistID+"searchWatermark").fadeIn("700")):(n("#"+this.worklistID+"searchWatermark").hide(),n("#"+this.worklistID+"watermark").fadeIn("700")))},StyleGridHeaders:function(t){var c=this.isDesignerRenderOnce||0,r=this,e=typeof t=="undefined"?!1:t.isResize||!1,l=n(r.element).parent("#StyleBuilderPreviewPanelContent").length>0,a=n(r.element).parent(".condtional-format-preview").length>0,v=typeof r.gridheader=="undefined";if(r.options.viewType=="Grid"){if(c>0&&!e||l||a)return;if(v||e){var y=r.element.attr("id"),u=[],s=0,h=53;this.gridheader=[];var p=parseInt(this.element.find(".nav").outerWidth());this.element.find(".worklist-grid-column-system-header-selection-checkbox").is(":hidden")||(s=32,u.push("<col class='worklist-grid-view-system-column' style=\"width:"+s+'px" />'));u.push("<col class='worklist-grid-view-system-column' style=\"width:32px\" />");for(var o=JSON.parse(r.options.columnLayoutConfigurationValueHolder),f=0;f<o.length;f++){var q=o[f].width;isNaN(parseInt(o[f].width))?q="auto":q.contains("px")||q.contains("%")||(q=q+"px");u.push("<col class='worklist-grid-view-visible-column' style='width:{0}' />".format(q));this.gridheader.push(q)}u.push("<col class='worklist-grid-view-system-column' style=\"width:"+h+'px" />');this.gridheader.push(h);this.element.find("colgroup").html(u.join(""));this.CheckForScrollBar()}else this.StyleGridHeaderFromMemory();return this.AdjustVisibleColumnWidth(),e}},StyleGridHeaderFromMemory:function(){var f=this.element.attr("id"),n=[],q=0,r=parseInt(this.element.find(".nav").outerWidth());this.element.find(".worklist-grid-column-system-header-selection-checkbox").is(":hidden")||(q=32,n.push("<col class='worklist-grid-view-system-column' style=\"width:"+q+'px" />'));var u=r/this.numberOfColumns;colWidthPercent=parseInt(u/r*100);n.push("<col class='worklist-grid-view-system-column' style=\"width:32px\" />");for(var t=0;t<this.gridheader.length-1;t++)n.push("<col class='worklist-grid-view-visible-column' style='width:{0}' />".format(this.gridheader[t]));n.push("<col class='worklist-grid-view-system-column' style=\"width:"+this.gridheader[this.gridheader.length-1]+'px" />');this.element.find("colgroup").html(n.join(""));this.CheckForScrollBar()},_preventResizeLoop:function(n,t){var q,t=t||100,r=0;return function(){if(r++<1){var u=this,f=arguments;n.apply(u,Array.prototype.slice.call(f));clearTimeout(q);q=setTimeout(function(){r=0},t)}}},_resizeListener:function(n,t,q){var u=document.attachEvent,l=!1;if(!u){var p=function(){var n=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||function(n){return window.setTimeout(n,20)};return function(t){return n(t)}}(),w=function(){var n=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.clearTimeout;return function(t){return n(t)}}();function resetTriggers(n){if(n.__resizeTriggers__){var r=n.__resizeTriggers__,t=r.firstElementChild,q=r.lastElementChild,u=t.firstElementChild;q.scrollLeft=q.scrollWidth;q.scrollTop=q.scrollHeight;u.style.width=t.offsetWidth+1+"px";u.style.height=t.offsetHeight+1+"px";t.scrollLeft=t.scrollWidth;t.scrollTop=t.scrollHeight}}function b(n){return n.offsetWidth!=n.__resizeLast__.width||n.offsetHeight!=n.__resizeLast__.height}function scrollListener(n){var t=this;resetTriggers(this);this.__resizeRAF__&&w(this.__resizeRAF__);this.__resizeRAF__=p(function(){b(t)&&(t.__resizeLast__.width=t.offsetWidth,t.__resizeLast__.height=t.offsetHeight,t.__resizeListeners__.forEach(function(q){q.call(t,n)}))})}var f=!1,k="animation",e="",o="animationstart",s="Webkit Moz O ms".split(" "),d="webkitAnimationStart animationstart oAnimationStart MSAnimationStart".split(" "),h="",a=document.createElement("fakeelement");if(a.style.animationName!==undefined&&(f=!0),f===!1)for(var r=0;r<s.length;r++)if(a.style[s[r]+"AnimationName"]!==undefined){h=s[r];k=h+"Animation";e="-"+h.toLowerCase()+"-";o=d[r];f=!0;break}var c="resizeanim",v="@"+e+"keyframes "+c+" { from { opacity: 0; } to { opacity: 0; } } ",y=e+"animation: 1ms "+c+"; "}function g(){if(!l){var t=(v?v:"")+".resize-triggers { "+(y?y:"")+'visibility: hidden; opacity: 0; } .resize-triggers, .resize-triggers > div, .contract-trigger:before { content: " "; display: block; position: absolute; top: 0; left: 0; height: 100%; width: 100%; overflow: hidden; } .resize-triggers > div { background: #eee; overflow: auto; } .contract-trigger:before { width: 200%; height: 200%; }',q=document.head||document.getElementsByTagName("head")[0],n=document.createElement("style");n.type="text/css";n.styleSheet?n.styleSheet.cssText=t:n.appendChild(document.createTextNode(t));q.appendChild(n);l=!0}}addResizeListener=function(n,t){u?n.attachEvent("onresize",t):(n.__resizeTriggers__||(getComputedStyle(n).position=="static"&&(n.style.position="relative"),g(),n.__resizeLast__={},n.__resizeListeners__=[],(n.__resizeTriggers__=document.createElement("div")).className="resize-triggers",n.__resizeTriggers__.innerHTML='<div class="expand-trigger"><div><\/div><\/div><div class="contract-trigger"><\/div>',n.appendChild(n.__resizeTriggers__),resetTriggers(n),n.addEventListener("scroll",scrollListener,!0),o&&n.__resizeTriggers__.addEventListener(o,function(t){t.animationName==c&&resetTriggers(n)})),n.__resizeListeners__.push(t))};removeResizeListener=function(n,t){u?n.detachEvent("onresize",t):(n.__resizeListeners__.splice(n.__resizeListeners__.indexOf(t),1),n.__resizeListeners__.length||(n.removeEventListener("scroll",scrollListener),n.__resizeTriggers__=!n.removeChild(n.__resizeTriggers__)))};switch(n.toLowerCase()){case"add":return t.each(function(){addResizeListener(this,q)});case"remove":return t.each(function(){removeResizeListener(this,q)})}},_getObserverTableWidth:function(){var q=this,u=q.element,t=n(".WorkListGridTableBody .js-width-observer",u);if(t.length<1){t=n('<div class="js-width-observer"><\/div>');t.css({position:"absolute",zIndex:"-100000",top:0,bottom:"0",width:"100%",height:"100%"});var r=n("body").outerWidth()<1;this._resizeListener("add",t,function(){t.show();q.CheckForScrollBar();q._restoreTableScrollPosition();q.options.designtime||(r?(q.StyleGridHeaders({isResize:!0}),r=!1):q._adjustVisibleColumnWidth());t.hide()});t.appendTo(n(".WorkListGridTableBody",q.element))}return t},_getVerticalScrollSize:function(){var u=this,q=0,t=u._getObserverTableWidth(),r=function(){q=t.parent().outerWidth()-t.outerWidth()};r();var f=n(".WorkListItemTable .worklist-grid-view-system-column",t.parent()).last().get(0);return typeof f!="undefined"&&r(),q},CheckForScrollBar:function(){if(this.options.viewType!=="Simple"){var n=53-this._getVerticalScrollSize();this.element.find(".table-body-colgroup").find("col").last().replaceWith("<col class='worklist-grid-view-system-column' style=\"width: "+n+'px" />')}},StyleGrid:function(n){this.StyleGridHeaders(n);this.ZebraStripeRows()},checkDateFormatForRtl:function(n){return n.test(/[0-9]{1,2}\/[0-9]{1,2}\/[0-9]{4}|[0-9]{1,2}:[0-9]{2} [(A|P)]M/)?"worklist-column-date-field":""},DateFormatter:function(n){var t=Date.parse(n),q;if(this._isDateToday(t))q=this.formatAMPM(t);else if(this._isDateYesterday(t))q=ControlResources.SourceCode.Forms.Controls.Web.ControlPack.Properties.Worklist.Yesterday;else if(this._isDateThisWeek(t)){var r=[ControlResources.SourceCode.Forms.Controls.Web.ControlPack.Properties.Worklist.Sunday,ControlResources.SourceCode.Forms.Controls.Web.ControlPack.Properties.Worklist.Monday,ControlResources.SourceCode.Forms.Controls.Web.ControlPack.Properties.Worklist.Tuesday,ControlResources.SourceCode.Forms.Controls.Web.ControlPack.Properties.Worklist.Wednesday,ControlResources.SourceCode.Forms.Controls.Web.ControlPack.Properties.Worklist.Thursday,ControlResources.SourceCode.Forms.Controls.Web.ControlPack.Properties.Worklist.Friday,ControlResources.SourceCode.Forms.Controls.Web.ControlPack.Properties.Worklist.Saturday];q=r[t.getDay()]}else{if(t.getFullYear()===9999)return"";q=this.getLocale(t)}return q},_isDateToday:function(n){return n.sameDateAs(new Date)?!0:!1},_isDateYesterday:function(n){var u=new Date,t=new Date;t.setDate(t.getDate()-1);t.setHours(0,0,0,0);var q=new Date;q.setDate(q.getDate()-1);q.setHours(23,59,59,999);var r=n.getTime();return r>t.getTime()&&r<=q.getTime()?!0:!1},_isDateThisWeek:function(n){var r=new Date,u=r.getDate()-r.getDay(),f=u+6,t=new Date;t.setDate(u);t.setHours(0,0,0,0);var q=new Date;return q.setDate(f),q.setHours(23,59,59,999),t<n&&n<q?!0:!1},processNumbersAndText:function(n){return/^\d+$/.test(n)?parseInt(n):n.toLowerCase()},prepForSorting:function(t){var u=function(n){var r="",s="Invalid Date";if(q.match(/^(\d{4}\-\d\d\-\d\d([tT][\d:\.]*)?)([zZ]|([+\-])(\d\d):?(\d\d))?$/)!==null)try{var t=new Date(n+"");if(t.toString()!=="Invalid Date"){var h=t.getFullYear().toString(),u=(t.getMonth()+1).toString();u=u[1]?u:"0"+u;var f=t.getDate().toString();f=f[1]?f:"0"+f;var e=t.getHours().toString();e=e[1]?e:"0"+e;var o=t.getMinutes().toString();o=o[1]?o:"0"+o;r=h+""+u+""+f+""+e+""+o}else r=s}catch(c){r=s}else r=isNaN(n)?n:s;return r},f=function(t,q){var r="",f=t.parentNode.getAttribute("data-serial"),e=n(".WorkListGridHeader tr > th").eq(t.cellIndex).attr("data-key"),o=n.grep(q,function(n){return n.SerialNumber==f});if(n(t).hasClass("WorklistItemIcons")){var u=function(n,t){return t.getElementsByClassName(n).length>0?t.getElementsByClassName(n)[0].getAttribute("title"):""};r=u("OverdueImageDiv",t)+u("PriorityImageDiv",t)}else r=o[0][e]+""||"";return r},q=f(t,this.GlobalArrayOfWorklistItems),r=u(q);return r!=="Invalid Date"?r:this.processNumbersAndText(q)},sortTable:function(t,q,r){var y=this,p=t.tBodies[0],f=Array.prototype.slice.call(p.rows,0),u;r=-(+r||-1);var k=this.element.find(".WorkListGridHeader").find("th"),s=n(k[q]);if(!s.hasClass("GridSelectAllCheckboxCell")&&!s.hasClass("no-sort")){typeof f[0]!="undefined"&&[].push(y.prepForSorting(f[0].cells[q]));switch(r){case 1:this.element.find(".column-arow").remove();s[0].style.position="relative";s.prepend("<div class='column-arow' style='position: relative; height: 100%; width: 100%;'><span class='column-arrow-asc'><\/span><\/div>");for(var e=[],o=[],h=f.length,u=0;u<h;u++){var w=f[u],b=f[u].cells[q],c=y.prepForSorting(b),l={row:w,value:c};isNaN(c)?e.push(l):o.push(l)}o.sort(function(n,t){return n.value-t.value});e.sort(function(n,t){var q=n.value.toLowerCase().localeCompare(t.value.toLowerCase());return q===0?n.value.localeCompare(t):q});n(f).detach();for(var a=n(p),h=o.length,u=0;u<h;u++){var v=o[u].row;a.append(v)}for(var h=e.length,u=0;u<h;u++){var v=e[u].row;a.append(v)}break;case-1:this.element.find(".column-arow").remove();s[0].style.position="relative";s.prepend("<div class='column-arow' style='position: relative; height: 100%; width: 100%;'><span class='column-arrow-desc'><\/span><\/div>");for(var e=[],o=[],h=f.length,u=0;u<h;u++){var w=f[u],b=f[u].cells[q],c=y.prepForSorting(b),l={row:w,value:c};isNaN(c)?e.push(l):o.push(l)}o.sort(function(n,t){return t.value-n.value});e.sort(function(n,t){var q=t.value.toLowerCase().localeCompare(n.value.toLowerCase());return q===0?t.value.localeCompare(n):q});n(f).detach();for(var a=n(p),h=e.length,u=0;u<h;u++){var v=e[u].row;a.append(v)}for(var h=o.length,u=0;u<h;u++){var v=o[u].row;a.append(v)}}this.ZebraStripeRows()}},makeSortable:function(t){var r=t.tHead,r=this.element.find(".WorkListGridHeader")[0],u;r&&(r=r.rows[0])&&(r=r.cells);var f=this;if(r)for(u=r.length-1;--u>=0;)(function(u){var e=1;try{var o=n(".worklist-grid-column-divider",r[u])[0];typeof o!="undefined"&&o.addEventListener("click",function(n){n.stopPropagation()});r[u].addEventListener("click",function(){f.sortTable(t,u,e=1-e);f.options.ColumnOrder=new q(t,u,e)})}catch(s){}})(u)},makeAllSortable:function(){var n=document.getElementById(this.worklistID+"WorkListItemTable"),t=n.length;this.makeSortable(n)},getLocale:function(n){var r={formatXmlString:"<Format>d<\/Format>",value:SCCultureHelper.Current()._convertDateObjToUTCString(n),formattingError:!1},t=SCCultureHelper.Current().applyFormatToControlValue(r),q=t.length,u=t.substring(q-1,q)==="y";return u&&(t=t.substring(0,q-1)),t},dateToLocale:function(n){var t=Date.parse(n);return this.getLocale(t)},GetOrderState:function(){this.options.ColumnOrder!==null&&this.sortTable(this.options.ColumnOrder.table,this.options.ColumnOrder.column,this.options.ColumnOrder.dir)},BuildTableBody:function(){var e=this,t=0,o=this.element.parent().attr("id")+"_";this.ROWS=0;t=this.options.Rows;var q=0;q=this.element.find(".WorklistItemGridRow:visible").length;t=t>q?t:q;this.WorklistDisplayNumber=0;this.element.find(".WorklistItemSectionDiv").html("");this.AddRows(t,!1);this.StyleGrid();this.LoadMoreUpdate();this.BindGridEvents();this.HandleWaterMark();n("#"+this.worklistID+"SearchInputBox").val()!=""&&this.searchGrid();for(var r in this.options.WorklistState)if(this.options.WorklistState.hasOwnProperty(r))try{var f=document.getElementById(this.options.WorklistState[r]),u=n(f);u.closest(".WorklistItemGridRow").addClass("SelectedDivBackground");u.find(".input-control.checkbox").addClass("checked")}catch(s){}this.options.viewType=="Grid"&&this.GetOrderState();this.isSelectAll()},AddRows:function(t,q){var f=this,o=this.element.find(".WorklistItemGridRow").length,e=[];t=typeof t!="undefined"?t:parseInt(this.options.Rows);this.WorklistDisplayNumber=o+t;for(var r=o;r<this.WorklistDisplayNumber;r++)typeof this.GlobalArrayOfWorklistItems[r]!="undefined"&&(this.options.viewType==="Simple"?e.push(this.GenerateSimpleRow(r)):e.push(this.GenerateGridRow(r)),this.ROWS++);this.CacheRows=e.join("");var u=n(this.CacheRows);u.find(".input-control.checkbox").checkbox();q&&!SourceCode.Forms.Browser.mozilla?(u.hide(),this.element.find(".WorklistItemSectionDiv").append(u),this.ZebraStripeRows(),u.fadeIn("slow",function(){f.CheckForScrollBar()})):(this.element.find(".WorklistItemSectionDiv").append(u),f.CheckForScrollBar(),f.ZebraStripeRows())},GetArrayElementAndAppendRow:function(t){var q,r=this;q=this.options.viewType==="Simple"?n(this.GenerateSimpleRow(t)):n(this.GenerateGridRow(t));q.find(".input-control.checkbox").checkbox();SourceCode.Forms.Browser.mozilla?(this.element.find(".WorklistItemSectionDiv").append(q),r.HandleWaterMark()):(q.hide(),this.element.find(".WorklistItemSectionDiv").append(q),q.fadeIn("slow",function(){}))},GetWorkItemStatus:function(n){var q=n.Status,t="";switch(q){case"Available":t="OverdueImageDiv";break;case"Open":case"Sleep":case"Allocated":t="OverdueImageDiv OverdueImageDivOpen"}return t},GetWorkItemPriority:function(n){switch(n){case"High":priority="PriorityImageDiv";break;case"Medium":case"Low":case"Undefined":default:priority="PriorityImageDiv PriorityImageDivNotHigh"}return priority},checkReleasable:function(n){if(this.base._booleanConverter(this.options.showRelease)){var q=n.find(".OverdueImageDiv").attr("title"),t=!1;switch(q){case"Open":case"Sleep":t=!0;break;case"Available":t=!1}return t}},decypherFolioWatermark:function(n,t){for(var o=new RegExp(/\[([A-Za-z0-9]+)\]/,"g"),u,q=[];u=o.exec(n);)q.push(u[1]);for(var s=q.length,r=0;r<s;r++){var f=q[r],h=new RegExp("[["+f+"]+]"),e=t[f];checkExists(e)&&(n=n.replace(h,e))}return n},GenerateGridRow:function(t){var q=this,r=!1,u=this.GetPriorityLevel[this.GlobalArrayOfWorklistItems[t].Priority];r=this.element.find(".CheckboxInput").hasClass("CheckboxInputOff")?"":"display: none;";this.options.showToolBar||(r="display:none");this.GlobalArrayOfWorklistItems[t].Status;var f=n(".style-aware-checkbox-svg > svg, .input-control.checkbox > svg"),e=f.length>0?f[0].outerHTML:"";function o(n){for(var e=[],o=q.GlobalArrayOfWorklistItems[n],r=0;r<q.VisibleColumns.length;r++){var s=q.VisibleColumns[r].colKey,u="",t="";t=o[q.VisibleColumns[r].colKey];typeof t=="undefined"&&(t="");var f=t;if(u=r==0?"WorklistItemFirstCell WorklistItemGridCell":"WorklistItemGridCell",s.indexOf("Date")!==-1&&t!==""&&typeof t!="undefined"){var h=new Date(t);if(f=h.getFullYear()===9999?"":q.getLocale(h),t=q.DateFormatter(t),q.options.isRTL){var c=q.checkDateFormatForRtl(t);u="{0} {1}".format(u,c)}}if(q.options.folioWatermark&&s.toUpperCase()==="FOLIO"&&t===""){var l=q.decypherFolioWatermark(q.options.folioWatermarkFormat,o);t=l;u+=" watermark"}f=f.toString().replace(/"/g,"&quot;").replace(/'/g,"&#39;");t=t.toString().replace(/"/g,"&quot;").replace(/'/g,"&#39;");var a="<td unselectable='on' title='{0}' class='{1}'><span class='text-underline'>{2}<\/span><\/td>".format(f,u,t);e.push(a)}return e.join("")}return'<tr id="'+this.element.attr("id")+"_"+this.GlobalArrayOfWorklistItems[t].SerialNumber+'" class="WorklistItemGridRow" data-actions="'+this.GlobalArrayOfWorklistItems[t].Action+'" data-serial="'+this.GlobalArrayOfWorklistItems[t].SerialNumber+'" style="display: table-row;"  tabIndex="0"><td class="WorklistTableCheckbox GridCheckbox" style="'+r+"\" unselectable='on'><div class='checkbox-outer-panel smartform-checkbox'><label class='input-control checkbox style-aware' data-defaultvalue='false'><input type=\"checkbox\" class='WorklistItemCheckbox AllWorklistCheckBoxes' value='' tabindex='-1'/><span class='input-control-img'><\/span>"+e+'<\/label><\/div><\/td><td class="WorklistItemIcons" style="white-space:nowrap;" unselectable=\'on\'><div class="'+this.GetWorkItemStatus(this.GlobalArrayOfWorklistItems[t])+'" title="'+this.GlobalArrayOfWorklistItems[t].Status+'"><\/div><div class="'+this.GetWorkItemPriority(u)+'" title="'+u+'"><\/div><\/td>'+o(t)+'<td class="WorklistTableSelectGridArrow" style="padding-top: 0px" unselectable=\'on\' title="'+ControlResources.SourceCode.Forms.Controls.Web.ControlPack.Properties.PickerCollection.ActionMenuPopup+'"><div class="SelectArrowImageDiv"><\/div><\/td><\/tr>'},GenerateSimpleRow:function(t){var q=this,u=!1,o=this.GetPriorityLevel[this.GlobalArrayOfWorklistItems[t].Priority];u=this.element.find(".CheckboxInput").hasClass("CheckboxInputOff")?"":"display: none;";this.options.showToolBar||(u="display:none");var s=typeof this.GlobalArrayOfWorklistItems[t].SerialNumber=="undefined"?"":this.GlobalArrayOfWorklistItems[t].SerialNumber,f="",e="",r="",h="",c="";typeof this.GlobalArrayOfWorklistItems[t].ActivityName!="undefined"&&(f=this.GlobalArrayOfWorklistItems[t].ActivityName);typeof this.GlobalArrayOfWorklistItems[t].EventStartDate!="undefined"&&(e=this.GlobalArrayOfWorklistItems[t].EventStartDate);typeof this.GlobalArrayOfWorklistItems[t].Folio!="undefined"&&(r=this.GlobalArrayOfWorklistItems[t].Folio,q.options.folioWatermark&&r.length===0&&(r=q.decypherFolioWatermark(q.options.folioWatermarkFormat,this.GlobalArrayOfWorklistItems[t]),h=" watermark"));typeof this.GlobalArrayOfWorklistItems[t].ProcessName!="undefined"&&(c=this.GlobalArrayOfWorklistItems[t].ProcessName);var l="Activity Name: "+f,a="Task Start Date: "+q.dateToLocale(e),v="Folio: "+r,y="Workflow Name: "+c;this.GlobalArrayOfWorklistItems[t].ActivityName.trim()||(l="Activity Name");this.GlobalArrayOfWorklistItems[t].EventStartDate.trim()||(a="Task Start Date");this.GlobalArrayOfWorklistItems[t].Folio.trim()||(v="Folio");this.GlobalArrayOfWorklistItems[t].ProcessName.trim()||(y="Workflow Name:");var p=n(".style-aware-checkbox-svg > svg, .input-control.checkbox > svg")[0].outerHTML||"<!-- Missing Template -->";return'<tr id="'+this.element.attr("id")+"_"+s+'" class="WorklistItemGridRow" data-actions="'+this.GlobalArrayOfWorklistItems[t].Action+'" data-serial="'+s+'" style="display: table-row;" tabIndex="0">             <td class="WorklistTableCheckbox" style="'+u+'">                     <div class="checkbox-outer-panel smartform-checkbox"> <label class="input-control checkbox style-aware" data-defaultvalue = "false"><input type="checkbox" class="WorklistItemCheckbox AllWorklistCheckBoxes" value tabindex="0"/><span class="input-control-img"><\/span>'+p+'<\/label><\/div><\/td>             <td class="SimpleLayoutCell wlsimple" style="white-space:nowrap;" unselectable="on">             <table class="WorkListItemTableSimple" style="white-space: nowrap; table-layout: fixed; text-decoration: inherit; margin-left: 4px">                 <tbody>                     <tr class="WorkListItemTableRowOne">                         <td class="WorklistTableOverdue" style="white-space:nowrap;width: 13px" unselectable="on">                             <div title="'+this.GlobalArrayOfWorklistItems[t].Status+'" class="'+this.GetWorkItemStatus(this.GlobalArrayOfWorklistItems[t])+'" style="display: block;"><\/div>                         <\/td>                         <td title="'+l+'" class="WorklistTableEventName" style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis; display: table-cell;" unselectable="on">                             <span class="text-underline"> '+f+' <\/span>                         <\/td>                         <td style="width:5px;" unselectable="on">                             <div style="display:table-cell;width:5px;"><\/div>                         <\/td>                         <td title="'+a+'" class="WorklistTableEventDate shadedCol worklist-column-date-field" style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis; display: table-cell;" unselectable="on"><span class="text-underline"> '+q.DateFormatter(e)+'<\/span><\/td>                     <\/tr>                     <tr class="WorkListItemTableRowTwo">                         <td class="WorklistTablePriority" style="white-space:nowrap;" unselectable="on">                             <div class="'+this.GetWorkItemPriority(o)+'" style="display: block;" title="'+o+'"><\/div>                         <\/td>                         <td title="'+v+'" class="WorklistTableFolio '+h+'" style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis; display: table-cell;" unselectable="on">                             <span class="text-underline">'+r+'<\/span>                         <\/td>                         <td style="width:5px;" unselectable="on">                             <div style="display:table-cell;width:5px;"><\/div>                         <\/td>                         <td  title="'+y+'"  class="WorklistTableWorkflowName shadedCol" style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis; display: table-cell;" unselectable="on">                             <span class="text-underline">'+this.GlobalArrayOfWorklistItems[t].ProcessName+'<\/span>                         <\/td>                     <\/tr>                 <\/tbody>             <\/table>         <\/div>     <\/td>     <td class="WorklistTableSelectGridArrow SimpleArrow" style="padding-top: 0px" title="'+ControlResources.SourceCode.Forms.Controls.Web.ControlPack.Properties.PickerCollection.ActionMenuPopup+'">         <div class="SelectArrowImageDiv"><\/div>         <\/td>     <\/tr> '},BindRefreshClick:function(){var t=this;n("#"+t.worklistID+"refreshInput").on("click",function(){if(this.getAttribute("title")===ControlResources.SourceCode.Forms.Controls.Web.ControlPack.Properties.Worklist.RefreshTooltipActioningItems)return!1;if(n(this).addClass("RefreshInputLoading"),n(this).attr("title",ControlResources.SourceCode.Forms.Controls.Web.ControlPack.Properties.Worklist.RefreshTooltipRefreshing),t.getWorklistFromServer(),parseInt(t.options.RefreshInterval)!==0){var q=n.timer(function(){n("#"+t.worklistID+"refreshInput").removeClass("RefreshInputLoading");this.stop()});q.set({time:parseInt(t.options.RefreshInterval)*1e3,autostart:!0})}typeof t.GlobalArrayOfWorklistItems[0]!="undefined"&&t.populateData(t.GlobalArrayOfWorklistItems[0]);t.ZebraStripeRows()})},BindToolBarEvents:function(){var t=this;this.element.on("keydown","th",function(t){(t.keyCode===13||t.keyCode===32)&&(n(this).trigger("click"),t.preventDefault())});this.element.on("keydown",".WorklistItemGridRow",function(q){switch(q.keyCode){case 13:n(this).addClass("tempFocus");t.ClickGridRow(n(this).find(".WorklistTableSelectGridArrow"),q);break;case 32:q.preventDefault();t.ClickGridRow(n(this),q);break;case 37:case 38:q.preventDefault();n(this).prev().trigger("focus");break;case 39:case 40:q.preventDefault();n(this).next().trigger("focus");break;case 65:if(q.ctrlKey===!0){q.preventDefault();t.element.find(".WorklistItemGridRow").addClass("SelectedDivBackground");var r=t.element.find(".CheckboxInput");r.hasClass("OptionSelectBorderOff")&&r.trigger("click");t.SelectAll()}}});n("#"+this.worklistID+"TurnOFF").on("click",function(){var q={};q.OOFSettings={};q.OOFSettings.status=!0;q.OOFSettings.startDate="";q.OOFSettings.endDate="";q.OOFSettings.workType=[];q.OOFSettings.delegatedUser=[];q.OOFException=[];n.ajax({url:applicationRoot+"OOF.sdk",type:"POST",data:JSON.stringify(q),dataType:"json",async:"true",beforeSend:function(n){SourceCode.Forms.XSRFHelper.setAntiXSRFHeader(n)},success:function(){t.element.removeClass("out-of-office")},error:function(){},complete:function(){t.GetOOFStatus()}})});this.element.on("keydown",".LoadMoreHyperlink",function(t){t.keyCode===32&&(n(this).trigger("click"),t.preventDefault())});this.element.on("focusin",".WorklistItemGridRow",function(){n(this).removeClass("tempFocus")});n("#"+this.worklistID+"MatchTypeDrop").on("change",function(){t.MatchSearchType=n(this).val()});n("#"+this.worklistID+"OOFInput").on("click",function(){var n=t.GetPicker("oofConfig",t.element.attr("id"));n&&initializeOOF(t,t.GetOOFStatus)});t.BindRefreshClick();t.element.find(".FilterInput").on("click",function(){n(this).toggleClass("FilterInputOff");n(this).toggleClass("OptionSelectBorderOff");var q=t.GetPicker("filterconfig",t.element.attr("id"));q&&initializeFilterRuntime(t,t.FilterObject,SourceCode.Forms.Controls.Worklist.constructFilter)});n("#"+this.worklistID+"SearchClear").on("click",function(){t.ClearSearchAndRerenderGrid();t.CheckAllSelectCheckbox()});this.element.find(".SearchBoxTD").on("keydown",function(n){n.keyCode===13&&(t.ClearSearchAndRerenderGrid(),t.CheckAllSelectCheckbox())});if(this.base._booleanConverter(this.options.showToolBar)||this.isShowToolBar(!1),this.base._booleanConverter(this.options.showSearch)||(n("#"+t.element.attr("id")).find(".SearchSectionRow").hide(),n("#"+t.worklistID+"searchInput").addClass("OptionSelectBorderOff")),this.base._booleanConverter(this.options.showFilter)||this.element.find(".FilterInput ").hide(),this.base._booleanConverter(this.options.showOOF)||this.element.find(".OOFInput ").hide(),!this.base._booleanConverter(this.options.enableSearch)){this.element.find(".SearchInput").addClass("OptionSelectBorderOff").hide();var q=n("#"+this.worklistID+"SearchInputBox").val();q!==""&&n("#"+this.worklistID+"SearchClear").trigger("click");this.element.find(".nav").addClass("searchAreaHidden").removeClass("searchAreaExpanded")}n("#"+this.worklistID+"SearchInputBox").on("keydown",function(q){q.keyCode===13?n("#"+t.worklistID+"SearchActionButton").trigger("click"):q.keyCode===27&&n("#"+t.worklistID+"SearchClear").trigger("click")});n("#"+this.worklistID+"SearchActionButton").on("click",function(){t.registerSearchString();t.searchGrid();t._clearOpenInterval()});this.element.find(".worklist-execute-search-icon").on("keydown",function(q){q.keyCode===n.ui.keyCode.ENTER&&(t.registerSearchString(),t.searchGrid(),t._clearOpenInterval())});this.element.find(".input-control").on("focus",function(){n(this).closest("tbody").addClass("active")});this.element.find(".input-control").on("focusout",function(){n(this).closest("tbody").removeClass("active")});n("#"+this.worklistID+"SearchSelect").on("click",function(){n("#"+t.worklistID+"SearchSelect").hasClass("SearchSelectExpanded")?(t.element.removeClass("search-options-expanded"),n("#"+t.worklistID+"SearchSelect").removeClass("SearchSelectExpanded"),n("#"+t.worklistID+"SearchSelect").addClass("SearchSelect"),n("#"+t.worklistID+"SearchSelect").attr("title",ControlResources.SourceCode.Forms.Controls.Web.ControlPack.Properties.PickerCollection.ExpandSearchCriteria),n("#"+t.worklistID+"MatchSelectSearchType").val("Begins With"),t.element.find(".matchRow").hide()):(t.element.addClass("search-options-expanded"),n("#"+t.worklistID+"SearchSelect").removeClass("SearchSelect"),n("#"+t.worklistID+"SearchSelect").addClass("SearchSelectExpanded"),n("#"+t.worklistID+"SearchSelect").attr("title",ControlResources.SourceCode.Forms.Controls.Web.ControlPack.Properties.PickerCollection.CollapseSearchCriteria),t.element.find(".matchRow").show());t.setHeightRuntime()});n("#"+this.worklistID+"Worklist_openTaskItemLink").off("click").on("click",function(){t.hide_menu();t.OpenItem()});n("#"+this.worklistID+"Worklist_viewFlowTaskItemLink").off("click").on("click",function(){t.hide_menu()});n("#"+this.worklistID+"MatchSelectSearchType").on("change",function(){t.MatchSearchType=n("#"+t.worklistID+"MatchSelectSearchType").val()});n(this.element).find("select").dropdown()},BindCheckBoxEvent:function(){var t=this;this.element.find(".smartform-checkbox").off("click").on("click",".input-control.checkbox",function(q){return t.ClickGridRow(n(this),q),!1})},BindGridEvents:function(){var t=this,f=this.element.find(".WorklistItemGridRow"),u=this.element.find(".WorklistTableSelectGridArrow"),e=this.element.find(".shadedCol");this.BindCheckBoxEvent();for(var q=0;q<u.length;q++){n(u[q]).off("click").on("click",function(q){q.stopPropagation();t.ClickGridRow(n(this),q)});n(u[q]).off("dblclick").on("dblclick",function(n){n.stopPropagation()})}var r,o,s;r=0;s=200;o=null;for(var q=0;q<f.length;q++)n(f[q]).off("click").on("click",function(q){var u=q.target;r++;o=setTimeout(function(){switch(r){case 1:q.stopPropagation();n(u).trigger("focus");t.ClickGridRow(n(u),q);raiseEvent(t.element.attr("id"),"Control","Clicked");break;case 2:q.stopPropagation();n(u).trigger("focus");t.DoubleClickPopulateData(n(u),q);raiseEvent(t.element.attr("id"),"Control","Double-Clicked")}r=0},s)});for(var q=0;q<e.length;q++)n(e[q]).off("click").on("click",function(q){q.stopPropagation();t.ClickGridRow(n(this),q)});this.element.find(".LoadMoreHyperlink").off("click").on("click",function(){var n=0,q=t.element.find(".WorklistItemGridRow").length;q<t.GlobalArrayOfWorklistItems.length?(n=t.GlobalArrayOfWorklistItems.length-q,n=n>=t.options.Rows?t.options.Rows:t.GlobalArrayOfWorklistItems.length%q):t.element.find(".loadmore").hide();t.AddRows(parseInt(n),!0);t.isSelectAll();t.LoadMoreUpdate();t.BindGridEvents();t.HandleWaterMark();t._clearOpenInterval();t.CheckAllSelectCheckbox()})},isSelectAll:function(){var t=this.element.find(".WorklistItemGridRow").length,q=this.element.find(".input-control.checkbox.checked").length;t===q&&t!==0?(n("#"+this.worklistID+"selectAll").prop("checked",!0),n("#"+this.worklistID+"SelectAllSimple").prop("checked",!0)):(n("#"+this.worklistID+"selectAll").prop("checked",!1),n("#"+this.worklistID+"SelectAllSimple").prop("checked",!1))},populateData:function(n){this.options.Priority=n.Priority;this.options.EventName=n.EventName;this.options.EventMetaData=n.EventMetaData;this.options.ProcessDescription=n.ProcessDescription;this.options.ProcessMetadata=n.ProcessMetadata;this.options.ActivityStartDate=n.ActivityStartDate;this.options.OriginalDestination=n.OriginalDestination;this.options.ActivityExpectedDuration=n.ActivityExpectedDuration;this.options.ActivityInstanceOverdue=n.ActivityInstanceOverdue;this.options.EventDescription=n.EventDescription==" "?"":n.EventDescription;this.options.processFolder=n.ProcessFolder;this.options.ProcessStartDate=n.ProcessStartDate;this.options.ProcessStatus=n.ProcessStatus;this.options.EventPriority=n.EventPriority;this.options.Data=n.Data;this.options.EventStartDate=n.EventStartDate;this.options.ProcessID=n.ProcessID;this.options.ProcessExpectedDuration=n.ProcessExpectedDuration;this.options.activityMetadata=n.ActivityMetadata;this.options.ActivityInstancePriority=n.ActivityInstancePriority;this.options.serialNumber=n.SerialNumber;this.options.EventExpectedDuration=n.EventExpectedDuration;this.options.ProcessFullName=n.ProcessFullName;this.options.ProcessGUID=n.ProcessGUID;this.options.ActivityDescription=n.ActivityDescription;this.options.Folio=n.Folio;this.options.ProcessName=n.ProcessName;this.options.ActivityName=n.ActivitySystemName;this.options.activityDisplayName=n.ActivityName;this.options.Status=n.Status;this.options.DueDate=n.DueDate;this.options.ViewFlowURL=n.ViewFlow},CheckAllSelectCheckbox:function(){var n=this.element.find(".WorklistItemGridRow"),t=this.element.find(".SelectedDivBackground");n.length>0&&n.length===t.length?this.options.viewType==="Grid"?(this.element.find(".GridSelectAllCheckboxCell").find(".input-control.checkbox").addClass("checked"),this.element.addClass("worklist-all-checkbox-selected")):(this.element.find(".smartform-checkbox_selectall").find(".input-control.checkbox").addClass("checked"),this.element.addClass("worklist-all-checkbox-selected")):this.options.viewType==="Grid"?(this.element.find(".GridSelectAllCheckboxCell").find(".input-control.checkbox").removeClass("checked"),this.element.removeClass("worklist-all-checkbox-selected")):(this.element.find(".smartform-checkbox_selectall").find(".input-control.checkbox").removeClass("checked"),this.element.removeClass("worklist-all-checkbox-selected"))},DoubleClickPopulateData:function(n){for(var t=this,r=n.closest(".WorklistItemGridRow").attr("data-serial"),q=0;q<t.GlobalArrayOfWorklistItems.length;q++)if(t.GlobalArrayOfWorklistItems[q].SerialNumber===r){t.populateData(t.GlobalArrayOfWorklistItems[q]);break}},ClickGridRow:function(t,q){var r=this,c=this.element.find(".CheckboxInput"),v=t.closest(".WorklistItemGridRow").attr("data-serial"),l=this.element.hasClass("worklist-multiselect-mode");SourceCode.Forms.Browser.msie&&r._restoreTableScrollPosition();r.hide_menu();this.element.find(".ShowMenu").removeClass("ShowMenu");for(var f=0;f<r.GlobalArrayOfWorklistItems.length;f++)if(r.GlobalArrayOfWorklistItems[f].SerialNumber===v){r.populateData(r.GlobalArrayOfWorklistItems[f]);break}if(q.shiftKey!=!0&&t.closest(".WorklistItemGridRow").hasClass("SelectedDivBackground")){var u=t.closest(".WorklistItemGridRow");t.is(".WorklistTableSelectGridArrow")||t.is("div.SelectArrowImageDiv")||t.hasClass("shadedCol")?(u.addClass("ShowMenu"),r.displayActionMenu()):(u.removeClass("SelectedDivBackground"),u.find(".input-control.checkbox").removeClass("checked"),r.element.find(".smartform-checkbox_selectall").find(".input-control.checkbox").removeClass("checked"))}else{if(t.is(".WorklistTableSelectGridArrow")||t.is("div.SelectArrowImageDiv")||t.hasClass("shadedCol")){var u=t.closest(".WorklistItemGridRow");u.addClass("ShowMenu");r.prevEvent=u;r.displayActionMenu(t);return}if(q.shiftKey===!0){var e=null,o=null;if(r.prevEvent===null)e=o=t.closest(".WorklistItemGridRow").attr("id");else{var y=r.prevEvent;e=y.closest(".WorklistItemGridRow").attr("id")}r.prevEvent=t;o=t.closest(".WorklistItemGridRow").attr("id");var s=!1,h=!1;if(n("#"+r.element.attr("id")+" .WorklistItemSectionDiv").children().each(function(){var t=n(this).attr("id");s&&h||(t==e&&(h=!0),t==o&&(n(this).hasClass("SelectedDivBackground")||(n(this).addClass("SelectedDivBackground"),n(this).find(".input-control.checkbox").addClass("checked")),s=!0),s&&!h&&(n(this).hasClass("SelectedDivBackground")||(n(this).addClass("SelectedDivBackground"),n(this).find(".input-control.checkbox").addClass("checked"))),!s&&h&&(n(this).hasClass("SelectedDivBackground")||(n(this).addClass("SelectedDivBackground"),n(this).find(".input-control.checkbox").addClass("checked"))))}),e!==o){c=r.element.find(".CheckboxInput");var a=r.element.find(".SelectedDivBackground");a.length>0&&l===!1&&c.trigger("click")}}else if(q.ctrlKey===!0){r.prevEvent=t;var u=t.closest(".WorklistItemGridRow");u.hasClass("SelectedDivBackground")||t.is(".WorklistTableSelectGridArrow")||t.is("div.SelectArrowImageDiv")||t.hasClass("shadedCol")||(u.addClass("SelectedDivBackground"),u.find(".input-control.checkbox").addClass("checked"));var a=r.element.find(".SelectedDivBackground");a.length>1&&l===!1&&c.trigger("click");r.CheckAllSelectCheckbox()}else{var l=r.element.hasClass("worklist-multiselect-mode");r.prevEvent=t;t=t.closest(".WorklistItemGridRow");t.hasClass("ShowMenu")||(l?t.hasClass("SelectedDivBackground")?(t.removeClass("SelectedDivBackground"),t.find(".input-control.checkbox").removeClass("checked")):(t.addClass("SelectedDivBackground"),t.find(".input-control.checkbox").addClass("checked")):(r.element.find(".SelectedDivBackground").removeClass("SelectedDivBackground"),t.hasClass("SelectedDivBackground")?t.removeClass("SelectedDivBackground"):t.addClass("SelectedDivBackground")))}}r.isSelectAll();r.CheckAllSelectCheckbox()},RemoveWorklistItem:function(t){var q=this;n("#"+this.element.attr("id")+"_"+t).fadeOut("slow",function(){n(this).attr("tabIndex",-1);for(var t=0;t<q.GlobalArrayOfWorklistItems.length;t++)if(q.GlobalArrayOfWorklistItems[t].SerialNumber===n(this).attr("data-serial")){q.GlobalArrayOfWorklistItems.splice(t,1);break}n(this).remove();q.StyleGrid();q.HandleWaterMark();q.isSelectAll()});this.ROWS--;this.CacheRows=this.element.find(".WorklistItemGridRow:visible");var r=this.CacheRows.length;r<this.GlobalArrayOfWorklistItems.length&&(this.searchWorklist===!0?this.LoadMoreAndHighlightSearch(!0):(this.AddRows(1,!0),this.LoadMoreUpdate(),this.BindGridEvents()),this.CheckForScrollBar())},setStyles:function(){this.options.Height.split("px")[1]===""&&(this.element[0].style.height=this.options.Height);var n=this.element.find(".stylewrapper"),u={border:n,background:n,margin:n,font:n,padding:n};StyleHelper.setStyles(u,this.options.style);for(var q=n[0].style,f=this.element.find(".nav")[0].style,r=this.element.find(".WorklistItemGridCell"),t=0;t<r.length;t++)r[t].style.color=q.color,r[t].style.fontSize=q.fontSize;q.boxSizing="border-box";this.element.width(this.options.width);n.css("-moz-box-sizing","border-box");n.css("-webkit-box-sizing","border-box");n.css("width","auto")},IsValidTime:/^(0?[1-9]|1[012])(:[0-5]\d) [APap][mM]$/,DesignTimeRender:function(){if(this.options.designtime=this.element.hasClass("designtime")||this.element.hasClass("preview")?!0:!1,this.hideProperties(),this.element.find(".headerTxt").text(this.options.text),this.options.viewType==="Simple")this.SimpleView();else if(this.options.viewType==="Grid"){var t=this;t.isDesignerRenderOnce=t.isDesignerRenderOnce||0;t.isDesignerRenderOnce<1&&(t.GridView(),t.isDesignerRenderOnce+=1)}this.setHeight(this.options.Height);this.base._booleanConverter(this.options.showSearch)?(n(this.element.find(".searchBar")[0]).css("display","inline-block"),this.element.find(".SelectAllMainTable").hide(),this.element.find(".SearchInput").addClass("SearchInputOff").removeClass("OptionSelectBorderOff"),this.element.addClass("search-section-active")):(this.element.find(".searchBar").hide(),this.element.find(".SearchInput").removeClass("SearchInputOff").addClass("OptionSelectBorderOff"),n("#"+this.worklistID+"searchInput"),this.element.removeClass("search-section-active"));this.base._booleanConverter(this.options.enableSearch)?this.element.find(".SearchInput").show():(this.element.find(".SearchInput").hide(),this.element.find(".searchBar").hide());this.base._booleanConverter(this.options.showFilter)?this.element.find(".FilterInput").show():this.element.find(".FilterInput").hide();this.base._booleanConverter(this.options.showOOF)?this.element.find(".OOFInput").show():this.element.find(".OOFInput").hide();this.base._booleanConverter(this.options.showSearch)&&this.base._booleanConverter(this.options.enableSearch)?n(this.element.find(".searchBar")[0]).css("display","table"):this.element.find(".searchBar").hide();var u=this.base._booleanConverter(this.options.showToolBar);u?this.isShowToolBar(!0):this.isShowToolBar(!1);var q=this.element.find(".searchBar").find("table"),r=this.element.find(".SourceCodeFormsControlsWorklist");q.length>0&&(q[0].style.tableLayout="auto");r>0&&(r[0].style.visibility="visible")},isShowToolBar:function(n){n?(this.options.showToolBar=!0,this.element.find(".hide-toolbars").removeClass("hide-toolbars")):(this.options.showToolBar=!1,this.element.find(".nav").find("input:not(:last-child)").addClass("hide-toolbars"),this.base._booleanConverter(this.options.showFilter)?this.element.find(".FilterInput").show():this.element.find(".FilterInput").hide(),this.base._booleanConverter(this.options.showOOF)?this.element.find(".OOFInput").show():this.element.find(".OOFInput").hide(),this.base._booleanConverter(this.options.enableSearch)?this.element.find(".SearchInput").show():(this.element.find(".SearchInput").hide(),this.element.find(".searchBar").hide()),this.base._booleanConverter(this.options.showSearch)&&this.base._booleanConverter(this.options.enableSearch)?this.element.find(".searchBar")[0].style.display="table":this.element.find(".searchBar").hide())},setHeight:function(t){var q=this;setTimeout(function(){q.options.Height=t;q.options.Height.length<=0&&(q.options.Height="auto");var r;if(q.options.Height!=="auto"){q.element.addClass("height-static");q.options.Height=SourceCode.Forms.Controls.Web.ControlPack.Utils.UnitHelper(q.options.Height,"auto",!1);var a=parseInt(q.options.Height),h=a-(q.element.find(".nav").height()+q.element.find(".WorkListGridHeader").height());q.worklistTableBody.length>0&&(r=q.worklistTableBody[0].style);var c=q.element.find(".SelectAllSimpleSectionRow"),f=q.element.find(".searchBar"),u=0;if(f.is(":visible")&&(u=SourceCode.Forms.Browser.msie?f.css("border-top-width").replace("px","")*2:parseInt(f.css("border-top-width")),(isNaN(u)||u==="")&&(u=0),h-=parseInt(f.height())+u),q.options.viewType==="Simple"&&c.is(":visible")){var e=parseInt(c.css("border-top-width"));(isNaN(e)||e==="")&&(e=0);h-=parseInt(c.height())+e}var l=0,o=parseInt(Math.ceil(parseFloat(q.element.find(".SourceCodeFormsControlsWorklist").css("border-top-width")))),s=parseInt(Math.ceil(parseFloat(q.worklistTableBody.css("border-top-width"))));(isNaN(o)||o==="")&&(o=0);(isNaN(s)||s==="")&&(s=0);l=o*2+s;r&&(r.height=SourceCode.Forms.Browser.msie&&SourceCode.Forms.Browser.version==="9.0"?"auto":h-l+"px",q.element.find(".SourceCodeFormsControlsWorklist").length>0&&(r=q.element.find(".SourceCodeFormsControlsWorklist")[0].style,r.height=q.options.Height,n(".WorkListGridTableBody",q.element).height("auto")))}else q.element.removeClass("height-static"),q.element.find(".SourceCodeFormsControlsWorklist").length>0&&(r=q.element.find(".SourceCodeFormsControlsWorklist")[0].style,r.height=q.options.Height),q.worklistTableBody.length>0&&(r=q.worklistTableBody[0].style,r.height=q.options.Height);SourceCode.Forms.Designers.Common.Context.refreshLayout();q.CheckForScrollBarDT()},0)},CheckForScrollBarDT:function(){this.CheckForScrollBar()},setView:function(n){this.options.viewType=n;this.DesignTimeRender()},setRows:function(n){this.isDesignerRenderOnce=0;this.options.Rows=n;this.DesignTimeRender()},setHyperLinkData:function(n){this.options.hyperLinkData=this.base._booleanConverter(n);this.DesignTimeRender()},GetColumns:function(){this.VisibleColumns=[];var t="";this.options.columnLayoutConfigurationValueHolder&&(t=JSON.parse(this.options.columnLayoutConfigurationValueHolder));this.numberOfColumns=t.length;function q(n,t){this.colKey=n;this.colValue=t}if(this.options.viewType=="Simple"){var n=new q("ActivityName",'"'+ControlResources.SourceCode.Forms.Controls.Web.ControlPack.Properties.PickerCollection.ActivityName+'"');this.VisibleColumns.push(n);n=new q("EventStartDate",'"'+ControlResources.SourceCode.Forms.Controls.Web.ControlPack.Properties.PickerCollection.EventStartDate+'"');this.VisibleColumns.push(n);n=new q("Folio",'"'+ControlResources.SourceCode.Forms.Controls.Web.ControlPack.Properties.PickerCollection.Folio+'"');this.VisibleColumns.push(n);n=new q("ProcessName",'"'+ControlResources.SourceCode.Forms.Controls.Web.ControlPack.Properties.PickerCollection.ProcessName+'"');this.VisibleColumns.push(n)}else if(this.options.viewType=="Grid")for(var r=0;r<t.length;r++){var n=new q(this.ColumnKeyMapper.findByKey(t[r].key),t[r].value);this.VisibleColumns.push(n)}},ColumnKeyMapper:{xmlKeys:{priority:"Priority",eventname:"EventName",eventmetadata:"EventMetaData",processdescription:"ProcessDescription",processmetadata:"ProcessMetadata",activitystartdate:"ActivityStartDate",originaldestination:"OriginalDestination",activityinstanceoverdue:"ActivityInstanceOverdue",folio:"Folio",ProcessFolio:"Folio",eventdescription:"EventDescription",processfolder:"ProcessFolder",processstartdate:"ProcessStartDate",processstatus:"ProcessStatus",activityexpectedduration:"ActivityExpectedDuration",eventpriority:"EventPriority",data:"Data",eventstartdate:"EventStartDate",processname:"ProcessName",processid:"ProcessID",processexpectedduration:"ProcessExpectedDuration",activityname:"ActivityName",activitymetadata:"ActivityMetadata",activityinstancepriority:"ActivityInstancePriority",serialnumber:"SerialNumber",eventexpectedduration:"EventExpectedDuration",processfullname:"ProcessFullName",processguid:"ProcessGUID",activitydescription:"ActivityDescription",status:"Status",duedate:"DueDate",action:"Action",worklistitemstatus:"Status"},findByKey:function(n){if(typeof n!="undefined")return n=n.toLowerCase(),this.xmlKeys[n]},findByValue:function(n){for(var t in this.xmlKeys)if(this.xmlKeys[t]===n)return t}},showSearch:function(n){this.options.showSearch=n;this.DesignTimeRender();this.setHeight(this.options.Height)},showFilter:function(n){this.options.showFilter=n;this.DesignTimeRender()},showToolBar:function(n){this.options.showToolBar=n;this.DesignTimeRender()},enableSearch:function(n){this.options.enableSearch=this.base._booleanConverter(n);this.DesignTimeRender()},showOOF:function(n){this.options.showOOF=n;this.DesignTimeRender()},SimpleView:function(){var n=this,t=['<tr class="WorklistItemGridRow" data-bind="attr: {id: listID, \'data-actions\': actions, \'data-serial\': serialNumber}, fadeVisible: isActive, click: $parent.clickWorklistItem,  dblclick: $parent.dblClickWorklistItem  " id="00000000-0000-0000-0000-000000000000_bed499fe-dfd9-35a1-96d0-877505505917__20452_15" data-actions="Approved,Declined,test" data-serial="20452_15">','<td class="WorklistTableCheckbox" data-bind="visible: display" style="display: none;"><input type="checkbox" class="WorklistItemCheckbox AllWorklistCheckBoxes" style="pointer-events:none;" data-bind="attr: {checked: rowChecked}"/><\/td>','<td class="SimpleLayoutCell wlsimple" unselectable="on">','<div id="" class="WorklistItemSectionDiv" style="background:white">','<table class="WorkListItemTableSimple" style="white-space: nowrap; table-layout: fixed; background: #fff; text-decoration: inherit;">',"<tbody>",'<tr class="WorkListItemTableRowOne">','<td class="WorklistTableOverdue" style="white-space:nowrap;width: 13px">','<div class="OverdueImageDiv" title="Available" style="display: block;"><\/div>',"<\/td>",'<td class="WorklistTableEventName" data-bind="fadeText: activityName" style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis; display: table-cell;">Activity Name<\/td>','<td style="width:5px;">','<div style="display:table-cell;width:5px;"><\/div>',"<\/td>",'<td class="WorklistTableEventDate shadedCol" data-bind="fadeText:  eventStartDate" style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis; display: table-cell;">Task Start Date<\/td>',"<\/tr>",'<tr class="WorkListItemTableRowTwo">','<td class="WorklistTablePriority" style="white-space:nowrap;">','<div class="PriorityImageDiv" title="High" style="display: block;"><\/div>',"<\/td>",'<td class="WorklistTableFolio" data-bind="fadeText:  folio" style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis; display: table-cell;">Folio<\/td>','<td style="width:5px;">','<div style="display:table-cell;width:5px;"><\/div>',"<\/td>",'<td class="WorklistTableWorkflowName shadedCol" data-bind="fadeText:processName" style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis; display: table-cell;">Workflow Name<\/td>',"<\/tr>","<\/tbody>","<\/table>","<\/div>","<\/td>",'<td class="WorklistTableSelectGridArrow SimpleArrow" style="padding-top: 0px">','<div class="SelectArrowImageDiv "><\/div>',"<\/td>","<\/tr>"],q=['<div id="'+this.element.parent().attr("ID")+'_WorkListGridTableBody" style="overflow-y:auto;overflow-x: hidden;display: block !important;height: auto; text-align: left; background:#fff">','<table class="WorkListItemTable" style="white-space: nowrap; ">',"<colgroup><\/colgroup>",'<tbody class="WorklistItemSectionDiv" data-bind="event: {scroll: scroll}, foreach: items ">','<tr class="WorklistItemGridRow" data-bind="attr: {id: listID, \'data-actions\': actions, \'data-serial\': serialNumber}, fadeVisible: isActive, click: $parent.clickWorklistItem,  dblclick: $parent.dblClickWorklistItem  " id="00000000-0000-0000-0000-000000000000_bed499fe-dfd9-35a1-96d0-877505505917__20451_15" data-actions="Approved,Declined,test" data-serial="20451_15">','<td class="WorklistTableCheckbox" data-bind="visible: display" style="display: none;"><input type="checkbox" class="WorklistItemCheckbox" style="pointer-events:none;" data-bind="attr: {checked: rowChecked}"/><\/td>','<td class="SimpleLayoutCell wlsimple">','<div id="00000000-0000-0000-0000-000000000000_bed499fe-dfd9-35a1-96d0-877505505917SourceCodeFormsControlsWorklist" class="WorklistItemSectionDiv">','<table class="WorkListItemTableSimple" style="white-space: nowrap; table-layout: fixed; margin-left:4px">',"<tbody>",r(),"<\/tbody>","<\/table>","<\/div>",'<div class="loadmore" style="height: 10px; text-align: center; font-size: 11px; padding: 5px; display: block; background: #fff"><a href="javascript:void(0);" class="LoadMoreHyperlink">'+ControlResources.SourceCode.Forms.Controls.Web.ControlPack.Properties.Worklist.labelLoadMore.replace("{0}",this.options.Rows)+"<\/a><\/div>"];function r(){for(var q=[],r=0;r<n.options.Rows;r++)q.push(t.join(""));return q.join("")}n.element.find(".WorklistItemSectionCell").html(q.join(""))},GridView:function(){this.GetColumns();for(var t=this,r=this.element.parent().attr("id")+"_",e=[],u=[],q=0;q<this.VisibleColumns.length;q++){var s="                     <th class='worklist-grid-column-header' unselectable='on' data-order='none' data-key={0}>                         <div class='worklist-grid-column-header-cell'>                                 <span class='worklist-grid-column-header-cell-text'>{1}<\/span>                                 <div class='worklist-grid-column-divider'><\/div>                             <\/div>                     <\/th>".format(this.VisibleColumns[q].colKey,this.VisibleColumns[q].colValue);e.push(s);q==0?u.push("<td class=\"WorklistItemFirstCell WorklistItemGridCell\" unselectable='on'>"+this.VisibleColumns[q].colValue+"<\/td>"):u.push("<td class=\"WorklistItemGridCell\" unselectable='on'>"+this.VisibleColumns[q].colValue+"<\/td>")}function h(){return e.join("")}function c(){return u.join("")}function l(){for(var q=[],n=0;n<t.options.Rows;n++){var r=n%2==0?"worklist-grid-even":"worklist-grid-odd",u=['<tr class="WorklistItemGridRow '+r+'" data-bind="attr: {id: listID, \'data-actions\': actions, \'data-serial\': serialNumber}, fadeVisible: isActive, click: $parent.clickWorklistItem,  dblclick: $parent.dblClickWorklistItem " id="wlID_9407_9" data-actions="Approve,Decline" data-serial="9407_9" style="display: table-row;">','<td class="WorklistTableCheckbox" data-bind="visible: display" style="display: none;"><input type="checkbox" class="WorklistItemCheckbox" style="pointer-events:none;" data-bind="attr: {checked: rowChecked}" unselectable=\'on\'/><\/td>','<td class="WorklistItemIcons" style="white-space:nowrap;" unselectable=\'on\'>','<div data-bind="fadeVisible: status, attr: { title: status }" class="OverdueImageDiv" title="Available" style=""><\/div>','<div data-bind="fadeVisible: priority, attr: { title: priority }" class="PriorityImageDiv" title="High" style=""><\/div>',"<\/td>",c(),'<td class="WorklistTableSelectGridArrow" style="padding-top: 0px" unselectable=\'on\'>','<div class="SelectArrowImageDiv"><\/div>',"<\/td>","<\/tr>"];q.push(u.join(""))}return q.join("")}var a=['<div class="WorklistItemSectionCell">','<table class="WorkListItemTableHeader" style="white-space: nowrap; table-layout:fixed">','<colgroup class="table-header-colgroup">',"<\/colgroup>",'<thead class="WorkListGridHeader">','<th id="'+r+'gridChxBox" class=\'worklist-grid-column-system-header worklist-grid-column-system-header-selection-checkbox\' style="padding-left: 5px; display: none;">','<input type="checkbox" id="wlIDselectAll"/>',"<\/th>","<th class='worklist-empty-grid-header'><div class='worklist-grid-column-header-cell'><span class='worklist-grid-column-header-cell-text'><\/span><\/div><\/th>",h(),"<th class='WorklistGridHeaderLast worklist-grid-column-system-header'><div class='worklist-grid-column-header-cell'><span class='worklist-grid-column-header-cell-text'> <\/span><div class='worklist-grid-column-divider'><\/div><\/div><\/th>","<\/thead>","<\/table>",'<div id="'+r+"WorkListGridTableBody\" class='WorkListGridTableBody' style=\"overflow-y:auto;display: block !important; height: "+this.options.Height+"\" unselectable='on'>",'<table class="WorkListItemTable" style="white-space: nowrap; ">','<colgroup class="table-body-colgroup"><\/colgroup>','<tbody class="WorklistItemSectionDiv" data-bind="event: {scroll: scroll}, foreach: items ">',l(),'<tr class="LastRowCell" style="height: 10px;">','<td class="BlankCheckBox" style="display:none" unselectable=\'on\'><\/td>','<td class="LastRowWhiteSpace" colspan="'+(this.VisibleColumns.length+1)+'" style="vertical-align: bottom;text-align: center;height: 0px" unselectable=\'on\'>','<div class="loadmore" style="text-align: center; font-size: 11px; padding: 5px; display: block;" unselectable=\'on\'>','<a href="javascript:void(0);" click="this.LoadMoreClick" class="LoadMoreHyperlink" unselectable=\'on\'>'+ControlResources.SourceCode.Forms.Controls.Web.ControlPack.Properties.Worklist.labelLoadMore.replace("{0}",this.options.Rows)+"<\/a><\/div>","<\/td>","<td class=\"LastRowSelectGridArrow\" unselectable='on'> <\/td>","<\/tr>","<\/tbody>","<\/table>","<\/div>","<\/div>"];t.element.find(".WorklistItemSectionCell").replaceWith(a.join(""));t.element.find(".loadmore").show();t.element.find("#"+r+"SourceCodeFormsControlsWorklist").height(this.options.Height);t.element.find(".WorklistItemSectionRow").height(this.options.Height);t.element.find(".WorklistMainTablex").width(this.options.Width);t.element.find(".loadmore").show();t._resizeListener("add",n(t.element),t._preventResizeLoop(function(){t.StyleGridHeaders({isResize:!0});t.element.find(".stylewrapper").css("overflow","hidden")},1e3));var o=n(t.element).closest(".form-control"),v=o.length>0;if(v&&o.attr("id")!=="StyleBuilderPreviewPanelContent"){var f=n(t.element).closest("td")[0];t.previousParentTdWidth=f.style.width;setInterval(function(){f.style.width!=t.previousParentTdWidth&&(t.StyleGridHeaders({isResize:!0}),t.previousParentTdWidth=f.style.width)},250)}t.StyleGridHeaders()},setTitle:function(n){this.options.text=n;this.element.find(".headerTxt").text(n)},setVisibility:function(n){this.options.isVisible=this.base._booleanConverter(n);this.checkVisibility()},checkVisibility:function(){this.options.isVisible=this.base._booleanConverter(this.options.isVisible);this.options.isVisible?(this.element.removeClass("hidden"),n(".RefreshInput",this.element).trigger("click")):this.element.addClass("hidden")},StyleGridHeadersDT:function(){if(this.element.find(".stylewrapper").attr("style").search("color:")==-1){var e=this.element.find(".stylewrapper")[0].style;e.color="black"}var o=this.element.find(".WorkListItemTableHeader"),e=o.find("th")[0].style;e.width="";var f=0,r=0,h=this.element.find(".WorkListItemTable"),c=this.element.find(".WorkListGridHeader"),t=c.find("th"),q="",s=0;q=h.find("tr:visible td");s=t.length+1;typeof this.colHeaders=="undefined"&&(this.colHeaders=new Array(t.length+1));n("#"+this.worklistID+"gridChxBox").is(":hidden")||(r=parseInt(n(t[0]).css("padding-left").replace("px",""))+parseInt(n(t[0]).css("padding-right").replace("px",""))+parseInt(n(t[0]).css("border-left-width").replace("px",""))+parseInt(n(t[0]).css("border-right-width").replace("px","")),n(n(t[0])).width(n(q[0]).outerWidth()-r+"px"),f+=n(q[0]).outerWidth());f=0;r=parseInt(n(t[1]).css("padding-left").replace("px",""))+parseInt(n(t[1]).css("padding-right").replace("px",""))+parseInt(n(t[1]).css("border-left-width").replace("px",""))+parseInt(n(t[1]).css("border-right-width").replace("px",""));f+=n(q[1]).outerWidth()+n(q[2]).outerWidth();n(n(t[1])).width(n(q[1]).outerWidth()+n(q[2]).outerWidth()-r+"px");for(var u=2;u<s-2;u++)f+=n(n(q[u+1])).outerWidth(),r=parseInt(n(t[u]).css("padding-left").replace("px",""))+parseInt(n(t[u]).css("padding-right").replace("px",""))+parseInt(n(t[u]).css("border-left-width").replace("px","")),n(n(t[u])).width(n(n(q[u+1])).outerWidth()-r+"px");var l=this.element.find(".nav").outerWidth()-f;r=parseInt(n(t[t.length-1]).css("padding-left").replace("px",""))+parseInt(n(t[t.length-1]).css("padding-right").replace("px",""))+parseInt(n(t[t.length-1]).css("border-left-width").replace("px",""))+parseInt(n(t[t.length-1]).css("border-right-width").replace("px",""));n(t[t.length-1]).width(l-r+"px");o.find("colgroup").remove()},destroy:function(){this.element.off("keydown",".WorklistItemGridRow");this.element.off("focusin",".WorklistItemGridRow");this.element.children().remove();n.Widget.prototype.destroy.apply(this,arguments)},localStorageHandler:{CAP:100,addItem:function(n,t,q){for(var f={WorklistItems:[],FilterObject:q.FilterObject},e=t.WorklistItems,r=0,o=e.length;r<o;r++){if(r>=this.CAP)break;f.WorklistItems.push(e[r])}if(q.options.FilterFromRuntime)t.FilterObject=q.FilterObject;else try{localStorage.setItem(n,JSON.stringify(f))}catch(u){SourceCode.Forms.Browser.webkit||SourceCode.Forms.Browser.msie?u.code===u.QUOTA_EXCEEDED_ERR:SourceCode.Forms.Browser.mozilla&&u.code===1014}}},_validateResponse:function(t){var u=this;if(t.length>0){var r=parseXML(t),f=r.selectSingleNode("Exception");if(f!==null){var q=r.selectSingleNode("Exception/Message").text;return q.indexOf("24411")===0&&(q=ControlResources.SourceCode.Forms.Controls.Web.ControlPack.Properties.Worklist.ErrorItemInvalidOrNoLongerPresent),popupManager.showError({message:q}),n("#"+u.worklistID+"refreshInput").trigger("click"),!1}}return!0}});n.sfc.worklist.prototype.base=n.sfc.baseWidget.prototype;typeof ControlUtil!="undefined"&&(ControlUtil.clearActionMenuItemProperty=function(t,q,r,u){for(var h="'ActionMenuItemData' or Name='ActionMenuItem'",o=parseXML(t),e=o.selectNodes("//Property[Name="+h+"]"),l=o.documentElement.selectSingleNode("Control/Properties"),f=0,c=e.length;f<c;f++)if(e[f]!==undefined){var s=n(e[f].selectSingleNode("Name")).text();s==="ActionMenuItem"?(n(e[f].selectSingleNode("Value")).text("(Default)"),n(e[f].selectSingleNode("DisplayValue")).text("(Default)")):s==="ActionMenuItemData"&&n(e[f].selectSingleNode("Value")).text("release,sleep,redirect,share,viewWorkflow")}u(1,o)});n(document).ready(function(){jQuery(".SFC.SourceCode-Forms-Controls-Web-ControlPack-Worklist").each(function(n,t){jQuery(t).worklist();jQuery(".input-control.checkbox").checkbox()});n.timer=function(t,q,r){return this.set=function(func,time,autostart){if(this.init=!0,typeof func=="object"){var paramList=["autostart","time"];for(var arg in paramList)func[paramList[arg]]!=undefined&&eval(paramList[arg]+" = func[paramList[arg]]");func=func.action}return typeof func=="function"&&(this.action=func),isNaN(time)||(this.intervalTime=time),autostart&&!this.isActive&&(this.isActive=!0,this.setTimer()),this},this.once=function(n){var t=this;return isNaN(n)&&(n=0),window.setTimeout(function(){t.action()},n),this},this.play=function(n){return this.isActive||(n?this.setTimer():this.setTimer(this.remaining),this.isActive=!0),this},this.pause=function(){return this.isActive&&(this.isActive=!1,this.remaining-=new Date-this.last,this.clearTimer()),this},this.stop=function(){return this.isActive=!1,this.remaining=this.intervalTime,this.clearTimer(),this},this.toggle=function(n){return this.isActive?this.pause():n?this.play(!0):this.play(),this},this.reset=function(){return this.isActive=!1,this.play(!0),this},this.clearTimer=function(){window.clearTimeout(this.timeoutObject)},this.setTimer=function(n){var t=this;typeof this.action=="function"&&(isNaN(n)&&(n=this.intervalTime),this.remaining=n,this.last=new Date,this.clearTimer(),this.timeoutObject=window.setTimeout(function(){t.go()},n))},this.go=function(){this.isActive&&(this.action(),this.setTimer())},this.init?new n.timer(t,q,r):(this.set(t,q,r),this)};typeof ControlResources.SourceCode.Forms.Controls.Web.ControlPack!="undefined"&&typeof Resources.ControlProperties!="undefined"&&(Resources.ControlProperties.InvalidInput=ControlResources.SourceCode.Forms.Controls.Web.ControlPack.Properties.Worklist.InvalidInput,Resources.ControlProperties.InvalidRow=ControlResources.SourceCode.Forms.Controls.Web.ControlPack.Properties.Worklist.InvalidRow,Resources.ControlProperties.InvalidRefresh=ControlResources.SourceCode.Forms.Controls.Web.ControlPack.Properties.Worklist.InvalidRefresh)});function q(n,t,q){this.table=n;this.column=t;this.dir=q}function r(t,q,r,u,f,e){var o="/K2Services/rest.svc/Worklist/Items("+r+")/Actions/Sleep?duration="+u;n.ajax({type:"POST",dataType:"text",data:{call:"sleep",duration:u,serial:r,sharedUser:f,managedUser:e},url:applicationRoot+"Worklist.sdk",beforeSend:function(n){SourceCode.Forms.XSRFHelper.setAntiXSRFHeader(n)},success:function(u){if(u.length!==0){var f=n.parseXML(u),e=t.xmlToJson(f);SourceCode.Forms.ExceptionHandler.isException(u)&&t.handleConnectionErrorForTask(o)}else t.RemoveWorklistItem(r),raiseEvent(q,"Control","Sleeping")},error:function(){t.handleConnectionErrorForTask(o)}})}function u(t,q,r,u){var f="/K2Services/rest.svc/Worklist/Items("+r+")/Actions/Redirect?destination="+u;n.ajax({type:"POST",dataType:"text",data:{call:"redirect",serial:r,user:u},url:applicationRoot+"Worklist.sdk",beforeSend:function(n){SourceCode.Forms.XSRFHelper.setAntiXSRFHeader(n)},success:function(u){if(t._validateResponse(u),u.length!==0){var e=n.parseXML(u),o=t.xmlToJson(e);SourceCode.Forms.ExceptionHandler.isException(u)&&t.handleConnectionErrorForTask(f)}else t.RemoveWorklistItem(r),raiseEvent(q,"Control","Redirected")}})}Date.prototype.getWeek=function(){var n=new Date(this.getFullYear(),0,1);return Math.ceil(((this-n)/864e5+n.getDay()+1)/7)};Date.prototype.sameDateAs=function(n){return this.getFullYear()==n.getFullYear()&&this.getMonth()==n.getMonth()&&this.getDate()==n.getDate()}})(jQuery);
/*!
 SourceCode.Forms.Controls.Web.ControlPack.PickerCollection.Resources.JS.PickerCollectionFilterConfig.js (Embedded resource)
*/
function initializeFilterPicker(n,t,q,r,u,f,e){SourceCode.Forms.Controls.PickerCollection.FilterConfig.initialize(n,t,q,r,u,f,e)}function initializeFilterRuntime(n,t,q){SourceCode.Forms.Controls.PickerCollection.FilterConfig.initializeRuntime(n,t,q)}(function(n){(typeof SourceCode=="undefined"||SourceCode===null)&&(SourceCode={});(typeof SourceCode.Forms=="undefined"||SourceCode.Forms===null)&&(SourceCode.Forms={});(typeof SourceCode.Forms.Controls=="undefined"||SourceCode.Forms.Controls===null)&&(SourceCode.Forms.Controls={});(typeof SourceCode.Forms.Controls.PickerCollection=="undefined"||SourceCode.Forms.Controls.PickerCollection===null)&&(SourceCode.Forms.Controls.PickerCollection={});var t,q=234,r=165;SourceCode.Forms.Controls.PickerCollection.FilterConfig=FilterPicker={propertyXml:null,callback:null,visibleColumns:null,stringXML:null,filterObject:null,designTime:!1,disableAll:!1,initialize:function(q,r,u,f,e){var p=this;this.propertyXml=parseXML(q);this.callback=e;FilterPicker.designTime=!0;popupManager.showPopup({id:"FilterConfig_secondPageOutside",buttons:[{type:"help",click:function(){HelpHelper.runHelp(5002)}},{text:ControlResources.SourceCode.Forms.Controls.Web.ControlPack.Properties.PickerCollection.OK,click:this.applyFilter.bind(this,!1)},{id:"UsersConfig_Cancel",text:ControlResources.SourceCode.Forms.Controls.Web.ControlPack.Properties.PickerCollection.Cancel,click:this.FilterCancelClick.bind(this)}],headerText:n("#FilterConfig_secondPage").attr("MainHeaderFilterConfig"),draggable:!0,content:n("#FilterConfig_secondPage"),width:800,height:335,onClose:function(){this.FilterConfigClose(e)}.bind(this)});n("#FilterConfig_propertiesXml").val(q||(q="<Controls><Control/><\/Controls>"));var h=parseXML(q).selectSingleNode('Controls/Control/Properties/Property[Name="FilterGroupingString"]/Value');n("#FilterConfig_secondPageInternal").addClass("designTimeOnly");this.setVisibleColumn();var o=null,s=null;if(h!==null){var a=h.text;this.filterObject=JSON.parse(a);o=this.constructFilterGrid();s=this.constructSortGrid();var c=o.grid("fetch","rows"),l=s.grid("fetch","rows");this.createFilterGrid(c);this.createSortGrid(l)}else{var v="#"+parseXML(q).selectSingleNode("Controls/Control").getAttribute("ID")+" .SourceCode-Forms-Controls-Web-ControlPack-Worklist",y=n(v).worklist("option").FilterGroupingString;this.filterObject=JSON.parse(y);o=this.constructFilterGrid();s=this.constructSortGrid();var c=o.grid("fetch","rows"),l=s.grid("fetch","rows");this.createFilterGrid(c);this.createSortGrid(l)}this.bindButtons();n("#FilterConfig_secondPage").find("#groupbyBox").dropdown();this.configureUI();checkExists(t)||(t=new Calendar(!1))},sort:function(n){for(var q=[],t=0;t<n.length;t++)q.push(n[t].value);q.sort();for(var e=[],t=0;t<q.length;t++)for(var r=0;r<n.length;r++){var u=n[r];if(q[t]===u.value){var f={};f.key=u.key;f.value=u.value;e.push(f);break}}return e},setVisibleColumn:function(){var n=this.propertyXml.selectSingleNode('Controls/Control/Properties/Property[Name="ColumnLayoutConfigurationValueHolder"]/Value');if(n===null){n={};var t=ControlResources.SourceCode.Forms.Controls.Web.ControlPack.Properties.PickerCollection.ActivityName,q=ControlResources.SourceCode.Forms.Controls.Web.ControlPack.Properties.PickerCollection.Folio,r=ControlResources.SourceCode.Forms.Controls.Web.ControlPack.Properties.PickerCollection.EventStartDate,u=ControlResources.SourceCode.Forms.Controls.Web.ControlPack.Properties.PickerCollection.ProcessName;n.text='[{"key":"activityName","value":"'+t+'"},{"key":"folio","value":"'+q+'"},{"key":"EventStartDate","value":"'+r+'"},{"key":"ProcessName","value":"'+u+'"}]'}this.visibleColumns=this.sort(JSON.parse(n.text))},setVisibleColumnRuntime:function(){var n=this.widget.options.columnLayoutConfigurationValueHolder;if(n.length===0){var t=ControlResources.SourceCode.Forms.Controls.Web.ControlPack.Properties.PickerCollection.ActivityName,q=ControlResources.SourceCode.Forms.Controls.Web.ControlPack.Properties.PickerCollection.Folio,r=ControlResources.SourceCode.Forms.Controls.Web.ControlPack.Properties.PickerCollection.EventStartDate,u=ControlResources.SourceCode.Forms.Controls.Web.ControlPack.Properties.PickerCollection.ProcessName;visibleColumnXml.text='[{"key":"activityName","value":"'+t+'"},{"key":"folio","value":"'+q+'"},{"key":"EventStartDate","value":"'+r+'"},{"key":"ProcessName","value":"'+u+'"}]'}this.visibleColumns=this.sort(JSON.parse(n))},setSortFieldDropdown:function(t){t=n(t);var u=t.find("#filter-picker-sort-field");u.find("option").remove();for(var q=0;q<this.visibleColumns.length;q++){var r=this.visibleColumns[q];u.append('<option label="'+r.value+'" value="'+this.ColumnKeyMapper.findByKey(r.key)+'">'+r.value+"<\/option>")}var f=t.find("#filter-picker-sort-field");f.find("option")[0].selected=!0;f.dropdown("refresh")},addFirstRowLogicalOperatorDropdown:function(t){t=n(t);t.find("option").remove();t.prepend('<option label="Blank" value="Blank"><\/option>');t.dropdown("disable");t.dropdown("refresh")},addColumnEvent:function(t){var q=this;t.find("#filter-picker-field").off("change").on("change",function(){var f=n("#filter-picker-grid-filter").find("tr.selected"),r=n(t).find("#filter-picker-compare-operator");r.children().remove();var u=n(this).val();q.FilterColumnItems.registerColumn(u,t)})},createSortGrid:function(t){for(var e=[],q=0;q<this.filterObject.length;q++){var o=this.filterObject[q];o.type==="sort"&&e.push(o)}for(var q=0;q<t.length;q++){var u=n(t[q]);this.setSortFieldDropdown(u);for(var s=u.find("#filter-picker-sort-field").find("option"),h=u.find("#filter-picker-sort-order").find("option"),c=e[q].order,r=0;r<h.length;r++){var f=h[r];f.value===c&&(f.selected=!0)}for(var l=e[q].sortfield,r=0;r<s.length;r++){var f=s[r];f.value===this.ColumnKeyMapper.findByKey(l)&&(f.selected=!0)}this.disableAll&&u.find(".grid-content-cell-wrapper select").dropdown("disable");u.find(".grid-content-cell-wrapper").find("select").dropdown("refresh")}},createFilterGrid:function(t){for(var o=this,s=t.length-1,f=0;f<t.length;f++){var r=n(t[f]),e=r.find("#filter-picker-logical-operator"),q=this.filterObject[f];if(f===0?this.addFirstRowLogicalOperatorDropdown(e):(e.val(q.logicOperator),this.disableAll&&e.dropdown("disable"),e.dropdown("refresh")),q.valueType==="Date"){this.FilterColumnItems.registerColumn(q.field,r);var u=r.find("#filter-picker-value");u.attr("filter-config-date-type",q.dateType);u.attr("filter-config-display-value",q.value);u.attr("filter-config-type",q.valueType);u.attr("filter-config-value",q.value);u.val(q.displayValue);q.dateType==="specific"&&u.data("calendarDate",q.value)}else{this.FilterColumnItems.registerColumn(q.field,r);var u=r.find("#filter-picker-value");u.val(q.value)}r.find("#filter-picker-field").val(q.field);r.find("#filter-picker-compare-operator").val(q.compareOperator);this.disableAll&&r.find(".grid-content-cell-wrapper select").dropdown("disable");r.find(".grid-content-cell-wrapper select").dropdown("refresh");this.addColumnEvent(r)}},configureUI:function(){n("#FilterConfig_FilterPanel").show();n("#FilterConfig_ColumnPanel").hide();n("#tabColumn").removeClass("selected");n("#tabFilter").removeClass("selected");n("#tabFilter").addClass("selected");n("#filter-picker-grid-filter").find(".grid-column-header-divider").removeClass("ui-draggable");n("#FilterConfig_ColumnPanel").find(".grid-column-header-divider").removeClass("ui-draggable");n("#filter-picker-grid-filter").find(".grid-column-header-divider:last").remove();n("#FilterConfig_ColumnPanel").find(".grid-column-header-divider:last").remove()},initializeRuntime:function(q,r,u){var l=this;this.widget=q;this.callback=u;var f=800,e=335;(n(window).height()<e||n(window).width()<f)&&(e=n(window).height()*.8,f=n(window).width()*.8);checkExists(this.widget.options.filterbehavior)&&this.widget.options.filterbehavior==="userDisabled"&&(this.disableAll=!0);popupManager.showPopup({id:"FilterConfig_secondPageOutside",buttons:[{type:"help",click:function(){HelpHelper.runHelp(5002)}},{text:ControlResources.SourceCode.Forms.Controls.Web.ControlPack.Properties.PickerCollection.OK,click:this.applyFilter.bind(this,!0)},{id:"UsersConfig_Cancel",text:ControlResources.SourceCode.Forms.Controls.Web.ControlPack.Properties.PickerCollection.Cancel,click:this.FilterCancelClick.bind(this)}],headerText:jQuery("#FilterConfig_secondPage").attr("MainHeaderFilterConfig"),draggable:!0,content:jQuery("#FilterConfig_secondPage"),width:f,height:e,onClose:function(){this.FilterConfigClose(u)}.bind(this)});n("#FilterConfig_secondPageOutside").find(".popup-header-text").addClass("filterPickerHeader");n("#FilterConfig_secondPageOutside").find(".popup-header").addClass("filterPickerHeaderBody");n("#FilterConfig_secondPageOutside").find(".close").addClass("filterPickerClose");n("#FilterConfig_secondPageOutside").find(".popup-body").addClass("filterPickerMainBody");this.setVisibleColumnRuntime();this.filterObject=JSON.parse(r);var o=this.constructFilterGrid(),s=this.constructSortGrid(),h=o.grid("fetch","rows"),c=s.grid("fetch","rows");this.createFilterGrid(h);this.createSortGrid(c);this.disableAll&&(n("#btnAddFilter").addClass("disabled"),n("#btnRemoveFilter").addClass("disabled").attr("tabIndex",-1),n("#btnAddSort").addClass("disabled"),n("#btnRemoveSort").addClass("disabled").attr("tabIndex",-1));this.bindButtons();n("#FilterConfig_secondPage").find("#groupbyBox").dropdown();this.configureUI();checkExists(t)||(t=new Calendar(!1))},constructFilterGrid:function(){var r=this,t=n("#filter-picker-grid-filter"),u={rowselect:function(){r.disableAll||(n("#FilterConfig_secondPage .delete").removeClass("disabled"),n("#btnRemoveFilter").attr("tabIndex",0))}};t.grid(u);for(var q=0;q<this.filterObject.length;q++)this.filterObject[q].type==="filter"&&t.grid("add","edit-template");return t},constructSortGrid:function(){var r=this,t=n("#filter-picker-grid-sort"),u={rowselect:function(){r.disableAll||(n("#FilterConfig_secondPage .delete").removeClass("disabled"),n("#btnRemoveSort").attr("tabIndex",0))}};t.grid(u);for(var q=0;q<this.filterObject.length;q++)this.filterObject[q].type==="sort"&&t.grid("add","edit-template");return t},applyFilter:function(q){var a=this;q&&(this.widget.options.filterConfigGridData=null);for(var v=n("#filter-picker-grid-filter").grid("fetch","rows"),f=[],e=0;e<v.length;e++){var o=n(v[e]),u=o.find("#filter-picker-value");if(u.attr("data-type")==="Date"&&u.val().trim().length===0){popupManager.showWarning(ControlResources.SourceCode.Forms.Controls.Web.ControlPack.Properties.PickerCollection.DateValueNotSpecified);return}var r={};if(r.type="filter",r.field=o.find("#filter-picker-field")[0].value,r.compareOperator=o.find("#filter-picker-compare-operator")[0].value,r.value=r.displayValue=u[0].value,r.logicOperator=e===0?"AndBracket":o.find("#filter-picker-logical-operator")[0].value,u.attr("data-type")==="Date")if(r.valueType="Date",u.attr("filter-config-date-type")==="relative"){r.dateType="relative";r.value=u[0].getAttribute("filter-config-value");var y=SourceCode.Forms.Controls.Common.DateRange.ParseToken(r.value),p={formatXmlString:"<Format Culture='en-US' Type='Date'>yyyy-MM-dd<\/Format>",value:y.StartDate,formattingError:!1};r.startDate=SCCultureHelper.Current().applyFormatToControlValue(p);var b={formatXmlString:"<Format Culture='en-US' Type='Date'>yyyy-MM-dd<\/Format>",value:y.EndDate,formattingError:!1};r.endDate=SCCultureHelper.Current().applyFormatToControlValue(b)}else{r.dateType="specific";var k=t.getCurrentDate(u),w=SCCultureHelper.Current()._convertUTCDateToObj(k);if(q)r.value=w.format("yyyy-MM-dd");else{var p={formatXmlString:"<Format Culture='en-US' Type='Date'>yyyy-MM-dd<\/Format>",value:w,formattingError:!1};r.value=SCCultureHelper.Current().applyFormatToControlValue(p)}}else r.valueType=u.attr("data-type")==="Integer"?"Integer":"String";f.push(r)}for(var d=n("#filter-picker-grid-sort"),c=d.grid("fetch","rows"),s=0;s<c.length;s++){field=this.ColumnKeyMapper.findByValue(n(c[s]).find("#filter-picker-sort-field")[0].value);order=n(c[s]).find("#filter-picker-sort-order")[0].value;var h={};h.sortfield=field;h.order=order;h.type="sort";f.push(h)}if(q===!1){this.stringXML=JSON.stringify(f);var l=parseXML(document.getElementById("FilterConfig_propertiesXml").value);this.saveXmlValues("FilterGrouping",l);this.saveXmlValues("FilterGroupingString",l);this.callback(1,l.xml)}else a.disableAll||SettingsUtil.setSetting("wlFilterConfig_{0}".format(a.widget.element.attr("id")),JSON.stringify(f)),this.callback(f,this.widget.element.prop("id"));n("#FilterConfig_secondPage").remove();popupManager.closeLast()},dateCancelClick:function(){popupManager.closeLast({cancelOnClose:!0})},dateConfigClose:function(){setTimeout(function(){popupManager.closeLast({cancelOnClose:!0});n("#UsersConfig_Cancel").trigger("focus")},50)},FilterCancelClick:function(){n("#FilterConfig_secondPage").remove();n("#FilterConfig_propertiesXml").remove();popupManager.closeLast({cancelOnClose:!0})},FilterConfigClose:function(){if(FilterPicker.designTime===!1){var t=this.widget.element.prop("id");SourceCode.Forms.Controls.Worklist.turnOffFilterIcon(t)}n("#FilterConfig_secondPage").remove();popupManager.closeLast({cancelOnClose:!0})},bindButtons:function(){var t=this;this.disableAll||(n("#btnAddFilter").on("click",function(){var u=n("#filter-picker-grid-filter");u.grid("add","edit-template");var r=u.grid("fetch","rows");if(r.length===1){var f=n(r[0]).find("#filter-picker-logical-operator");t.addFirstRowLogicalOperatorDropdown(f)}var q=n(r[r.length-1]);q.find("select").dropdown();q.find("input").textbox();var e=q.find("#filter-picker-field").val();t.FilterColumnItems.registerColumn(e,q);n(this).trigger("blur");q.find("#filter-picker-field").off("change").on("change",function(){var q=n("#filter-picker-grid-filter").find("tr.selected"),r=n(this).val();t.FilterColumnItems.registerColumn(r,q)});t.addColumnEvent(q)}).addClass("style-aware").find(".button-text").before('<svg width="16" height="16"><use xlink:href="#svg-icon-add" /><\/svg>'),n("#btnRemoveFilter").on("click",function(){var q=n("#filter-picker-grid-filter");t.autoSelectAfterRemoveRow(q,this);var r=q.grid("fetch","rows"),u=n(r[0]),f=u.find("#filter-picker-logical-operator");t.addFirstRowLogicalOperatorDropdown(f)}).addClass("style-aware").find(".button-text").before('<svg width="16" height="16"><use xlink:href="#svg-icon-delete" /><\/svg>'),n("#btnAddSort").on("click",function(){var q=n("#filter-picker-grid-sort");q.grid("add","edit-template");var r=q.grid("fetch","rows"),u=r[r.length-1];t.setSortFieldDropdown(u);n(this).trigger("blur")}).addClass("style-aware").find(".button-text").before('<svg width="16" height="16"><use xlink:href="#svg-icon-add" /><\/svg>'),n("#btnRemoveSort").on("click",function(){var q=n("#filter-picker-grid-sort");t.autoSelectAfterRemoveRow(q,this)}).addClass("style-aware").find(".button-text").before('<svg width="16" height="16"><use xlink:href="#svg-icon-delete" /><\/svg>'));n("#tabFilter").on("click",function(){n("#FilterConfig_FilterPanel").show();n("#FilterConfig_ColumnPanel").hide();n("#tabColumn").removeClass("selected");n("#tabFilter").removeClass("selected");n("#tabFilter").addClass("selected");n("#FilterConfig_FilterPanel .grid").grid("synccolumns");var t=n("#btnRemoveFilter"),q=n("#filter-picker-grid-filter").find(".grid-content-table"),r=q.find(".empty-grid");r.length>0||!q.find("tr").hasClass("selected")?(t.addClass("disabled"),t.attr("tabIndex",-1)):this.disableAll?(t.addClass("disabled"),t.attr("tabIndex",-1)):(t.removeClass("disabled"),t.attr("tabIndex",0))});n("#tabColumn").on("click",function(){n("#FilterConfig_FilterPanel").hide();n("#FilterConfig_ColumnPanel").show();n("#tabColumn").removeClass("selected");n("#tabFilter").removeClass("selected");n("#tabColumn").addClass("selected");n("#FilterConfig_ColumnPanel .grid").grid("synccolumns");var t=n("#btnRemoveSort"),q=n("#filter-picker-grid-sort").find(".grid-content-table"),r=q.find(".empty-grid");r.length>0||!q.find("tr").hasClass("selected")?(t.addClass("disabled"),t.attr("tabIndex",-1)):this.disableAll?(t.addClass("disabled"),t.attr("tabIndex",-1)):(t.removeClass("disabled"),t.attr("tabIndex",0))})},checkDisableClearButton:function(n,t){var q=n.grid("fetch","rows");q.length<1?t.addClass("disabled"):t.removeClass("disabled")},autoSelectAfterRemoveRow:function(t,q){var r=t.find(".selected").index();t.grid("remove","selected-rows");var u=t.grid("fetch","rows");if(u.length===0)n(q).addClass("disabled");else{var f=r===0?0:r===u.length?u.length-1:r;var e=n(t.find(".grid-content-table tr")[f]);e.addClass("selected")}},saveXmlValues:function(n,t){if(n!=="ControlName"){var q=t.selectSingleNode('/Controls/Control/Properties/Property[Name = "'+n+'"]'),f=t.selectSingleNode("/Controls/Control/Properties");if(f||(f=t.createElement("Properties"),t.selectSingleNode("/Controls/Control").appendChild(f)),q)for(var e=q.childNodes.length-1;e>=0;e--)q.childNodes[e].nodeName!="Name"&&q.removeChild(q.childNodes[e]);if(!q){q=t.createElement("Property");var o=t.createElement("Name");o.appendChild(t.createCDATASection(n));q.appendChild(o);f.appendChild(q)}var u=null,r=null,s=null;if(n==="Users"){var h="";usersDisplay!=="(All)"&&usersDisplay.substring(0,1)===";"&&(usersDisplay=usersDisplay.substring(1,usersDisplay.length));u=usersDisplay;r=usersDisplay}if(n==="FilterGroupingString"&&(u=this.stringXML,r=this.stringXML),n==="FilterGrouping"){var a=this.visibleColumns[0].key,v='{"sortfield":"'+a+'","order":"Descending","type":"sort"}',y='[{"field":"WorklistItemStatus","compareOperator":"NotEqual","initialValue":"Sleep","converted":"3","value":"3","logicOperator":"AndBracket","type":"filter","dataType":"Integer"},'+v+"]";y.toLowerCase()===this.stringXML.toLowerCase()?(u="(Default)",r="(Default)"):(u="(Custom)",r="(Custom)")}if(r){var h=t.createElement("DisplayValue");h.appendChild(t.createCDATASection(u));q.appendChild(h);var c=t.createElement("Value");if(c.appendChild(t.createCDATASection(r)),q.appendChild(c),s!==null){var l=t.createElement("Guid");l.appendChild(t.createCDATASection(s));q.appendChild(l)}}else t.selectSingleNode("/Controls/Control/Properties").removeChild(q)}},setXMLProperty:function(n,t,q,r){var u=n.selectSingleNode("/Controls/Control/Properties/Property[Name[text()='"+t+"']]"),f=n.selectSingleNode("/Controls/Control/Properties/Property[Name[text()='"+t+"']]/Value"),e=n.selectSingleNode("/Controls/Control/Properties/Property[Name[text()='"+t+"']]/DisplayValue");if(checkExists(u)){checkExists(f)&&u.removeChild(f);checkExists(e)&&u.removeChild(e);var o=n.createElement("Value"),s=n.createElement("DisplayValue");o.appendChild(n.createCDATASection(q));s.appendChild(n.createCDATASection(r));u.appendChild(o);u.appendChild(s)}},ColumnKeyMapper:{xmlKeys:{activitydescription:"ActivityDescription",activityexpectedduration:"ActivityExpectedDuration",activityinstanceoverdue:"ActivityExpectedDuration",activitymetadata:"ActivityMetaData",activityname:"ActivityName",activitydisplayname:"ActivityDisplayName",activitystartdate:"ActivityStartDate",data:"ActivityData",duedate:"DueDate",eventdescription:"EventDescription",eventexpectedduration:"EventExpectedDuration",eventmetadata:"EventMetaData",eventname:"EventName",eventstartdate:"EventStartDate",folio:"ProcessFolio",priority:"ProcessPriority",processdescription:"ProcessDescription",processexpectedduration:"ProcessExpectedDuration",processfolder:"ProcessFolder",processfullname:"ProcessFullName",processmetadata:"ProcessMetaData",processname:"ProcessName",processstartdate:"ProcessStartDate",processstatus:"ProcessStatus",serialnumber:"SerialNumber",status:"WorklistItemStatus"},findByKey:function(n){if(typeof n!="undefined")return n=n.toLowerCase(),this.xmlKeys[n]},findByValue:function(n){for(var t in this.xmlKeys)if(this.xmlKeys[t]===n)return t}},FilterColumnItems:{registerColumn:function(n,t){switch(n){case"ActivityName":case"ActivityDisplayName":case"ActivityDescription":case"ActivityData":case"ActivityMetaData":case"EventDescription":case"EventMetaData":case"EventName":case"ProcessData":case"ProcessDescription":case"ProcessFolder":case"ProcessFolio":case"ProcessFullName":case"ProcessID":case"ProcessMetaData":case"ProcessName":case"SerialNumber":FilterPicker.FilterColumnItems.createValueTextbox(t);FilterPicker.FilterColumnItems.createOperatorContains(t);break;case"ActivityExpectedDuration":case"ActivityStartDate":case"EventExpectedDuration":case"EventStartDate":case"ProcessExpectedDuration":case"ProcessStartDate":case"DueDate":FilterPicker.FilterColumnItems.createValueDate(t);FilterPicker.FilterColumnItems.createOperatorDate(t);break;case"ActivityPriority":case"EventPriority":case"ProcessPriority":FilterPicker.FilterColumnItems.createOperatorEqualOrNot(t);FilterPicker.FilterColumnItems.createValuePriority(t);break;case"ProcessStatus":FilterPicker.FilterColumnItems.createOperatorEqualOrNot(t);FilterPicker.FilterColumnItems.createValueStatusActiveness(t);break;case"WorklistItemOwner":FilterPicker.FilterColumnItems.createOperatorEqualOrNot(t);FilterPicker.FilterColumnItems.createValueOwner(t);break;case"WorklistItemStatus":FilterPicker.FilterColumnItems.createOperatorEqualOrNot(t);FilterPicker.FilterColumnItems.createValueStatusAvailability(t)}},createOperatorContains:function(n){var q=n.find("#filter-picker-compare-operator");q.children().remove();var t={};t.Like=ControlResources.SourceCode.Forms.Controls.Web.ControlPack.Properties.PickerCollection.Contains;t.Equal=ControlResources.SourceCode.Forms.Controls.Web.ControlPack.Properties.PickerCollection.Equal;t.NotLike=ControlResources.SourceCode.Forms.Controls.Web.ControlPack.Properties.PickerCollection.NotContains;t.NotEqual=ControlResources.SourceCode.Forms.Controls.Web.ControlPack.Properties.PickerCollection.NotEquals;for(var u in t){var r=document.createElement("option");r.value=u.toString();r.innerHTML=t[u];q.append(r)}q.dropdown("refresh")},createOperatorEqualOrNot:function(n){var t=n.find("#filter-picker-compare-operator");t.children().remove();var q=document.createElement("option"),r=document.createElement("option");q.value="Equal";q.innerHTML=ControlResources.SourceCode.Forms.Controls.Web.ControlPack.Properties.PickerCollection.Equal;r.value="NotEqual";r.innerHTML=ControlResources.SourceCode.Forms.Controls.Web.ControlPack.Properties.PickerCollection.NotEquals;t.append(q);t.append(r);t.dropdown("refresh")},createOperatorDate:function(n){var q=n.find("#filter-picker-compare-operator");q.children().remove();var t={};t.Equal=ControlResources.SourceCode.Forms.Controls.Web.ControlPack.Properties.PickerCollection.Equal;t.NotEqual=ControlResources.SourceCode.Forms.Controls.Web.ControlPack.Properties.PickerCollection.NotEquals;t.Greater=ControlResources.SourceCode.Forms.Controls.Web.ControlPack.Properties.PickerCollection.Greater;t.GreaterOrEqual=ControlResources.SourceCode.Forms.Controls.Web.ControlPack.Properties.PickerCollection.Greater+" "+ControlResources.SourceCode.Forms.Controls.Web.ControlPack.Properties.PickerCollection.Or+" "+ControlResources.SourceCode.Forms.Controls.Web.ControlPack.Properties.PickerCollection.Equal;t.Less=ControlResources.SourceCode.Forms.Controls.Web.ControlPack.Properties.PickerCollection.Smaller;t.LessOrEqual=ControlResources.SourceCode.Forms.Controls.Web.ControlPack.Properties.PickerCollection.Smaller+" "+ControlResources.SourceCode.Forms.Controls.Web.ControlPack.Properties.PickerCollection.Or+" "+ControlResources.SourceCode.Forms.Controls.Web.ControlPack.Properties.PickerCollection.Equal;for(var u in t){var r=document.createElement("option");r.value=u.toString();r.innerHTML=t[u];q.append(r)}q.dropdown("refresh")},createValueDate:function(n){var r=this,t=n.find("#filter-picker-value"),q=t.closest(".grid-content-cell-wrapper");q.children().remove();q.html(SCTextbox.html({id:"filter-picker-value"})).find("input").textbox().addClass("datepicker");var u=new Calendar;q.append(u.element.addClass("datepicker"));t=n.find("#filter-picker-value");t.attr("data-type","Date");FilterPicker.designTime&&t.parent().attr("id","design-time-date-fix");t.prop("readonly",!0);t.parent().parent().parent().find(".input-control-m-r").append("<span class='worklist-filter-date-picker-calender-icon icon-date ico'><\/span>");t.parent().parent().parent().off("click").on("click",function(){r.displayDatePicker(t)})},createValueTextbox:function(t){var u=t.find("#filter-picker-value"),q=u.closest(".grid-content-cell-wrapper");q.children().remove();var r=n(document.createElement("input"));r.attr("id","filter-picker-value");r.attr("type","text");q.html(SCTextbox.html({id:"filter-picker-value"})).find("input").textbox()},createValuePriority:function(t){var o=t.find("#filter-picker-value"),e=o.closest(".grid-content-cell-wrapper");e.children().remove();var q=n(document.createElement("select"));q.attr("data-type","Integer");q.attr("id","filter-picker-value");var r=document.createElement("option"),u=document.createElement("option"),f=document.createElement("option");r.value="0";r.innerHTML=ControlResources.SourceCode.Forms.Controls.Web.ControlPack.Properties.PickerCollection.High;u.value="1";u.innerHTML=ControlResources.SourceCode.Forms.Controls.Web.ControlPack.Properties.PickerCollection.Medium;f.value="2";f.innerHTML=ControlResources.SourceCode.Forms.Controls.Web.ControlPack.Properties.PickerCollection.Low;q.append(r);q.append(u);q.append(f);e.append(q);q.dropdown()},createValueStatusActiveness:function(t){var s=t.find("#filter-picker-value"),o=s.closest(".grid-content-cell-wrapper");o.children().remove();var q=n(document.createElement("select"));q.attr("data-type","Integer");q.attr("id","filter-picker-value");var r=document.createElement("option"),u=document.createElement("option"),f=document.createElement("option"),e=document.createElement("option");r.value="2";r.innerHTML=ControlResources.SourceCode.Forms.Controls.Web.ControlPack.Properties.PickerCollection.Active;u.value="0";u.innerHTML=ControlResources.SourceCode.Forms.Controls.Web.ControlPack.Properties.PickerCollection.Error;f.value="1";f.innerHTML=ControlResources.SourceCode.Forms.Controls.Web.ControlPack.Properties.PickerCollection.Running;e.value="4";e.innerHTML=ControlResources.SourceCode.Forms.Controls.Web.ControlPack.Properties.PickerCollection.Stopped;q.append(r);q.append(u);q.append(f);q.append(e);o.append(q);q.dropdown()},createValueStatusAvailability:function(t){var s=t.find("#filter-picker-value"),o=s.closest(".grid-content-cell-wrapper");o.children().remove();var q=n(document.createElement("select"));q.attr("id","filter-picker-value");q.attr("data-type","Integer");var r=document.createElement("option"),u=document.createElement("option"),f=document.createElement("option"),e=document.createElement("option");r.value="0";r.innerHTML=ControlResources.SourceCode.Forms.Controls.Web.ControlPack.Properties.PickerCollection.Available;u.value="1";u.innerHTML=ControlResources.SourceCode.Forms.Controls.Web.ControlPack.Properties.PickerCollection.Open;f.value="2";f.innerHTML=ControlResources.SourceCode.Forms.Controls.Web.ControlPack.Properties.PickerCollection.Allocated;e.value="3";e.innerHTML=ControlResources.SourceCode.Forms.Controls.Web.ControlPack.Properties.PickerCollection.Sleep;q.append(r);q.append(u);q.append(f);q.append(e);o.append(q);q.dropdown()},createValueOwner:function(t){var e=t.find("#filter-picker-value"),f=e.closest(".grid-content-cell-wrapper");f.children().remove();var q=n(document.createElement("select"));q.attr("id","filter-picker-value");q.attr("data-type","String");var r=document.createElement("option"),u=document.createElement("option");r.value="Me";r.innerHTML="Me";u.value="Other";u.innerHTML="Other";q.append(r);q.append(u);f.append(q);q.dropdown()},displayDatePicker:function(u){var s=u.attr("id"),f=u,e="",o;o=SourceCode.Forms.Layout.isRuntime()?r:q;n.ajax({type:"POST",url:applicationRoot+"PickerCollectionDateRangePicker.sdk",dataType:"text",async:!1,data:{controlId:s},cache:!1,success:function(q){e=q;popupManager.showPopup({id:"worklist-control-filter-date-range",buttons:[{type:"help",click:function(){HelpHelper.runHelp(7064)}},{text:ControlResources.SourceCode.Forms.Controls.Web.ControlPack.Properties.PickerCollection.OK,click:function(){if(n("#date-range-picker-specific-date-radio").parent().hasClass("checked")){if(t&&!u.data().isValidDate){n("#filter-picker-value_TextBox").closest(".calendar-control").addClass("invalid");popupManager.showWarning(ControlResources.SourceCode.Forms.Controls.Web.ControlPack.Properties.PickerCollection.InvalidDate);return}f.data("calendarDate",u.data("calendarDate"));f.attr("filter-config-date-type","specific");f.attr("filter-config-type","Date");f.attr("filter-config-value",u.val());f.attr("filter-config-display-value",u.val());f.val(u.val())}else f.attr("filter-config-date-type","relative"),f.attr("filter-config-type","Date"),f.attr("filter-config-value",n("#date-range-picker-relative-date-dropdown").val()),f.attr("filter-config-display-value",n("#date-range-picker-relative-date-dropdown .selected").text()),f.val(n("#date-range-picker-relative-date-dropdown .selected").text());popupManager.closeLast({cancelOnClose:!0});n("#FilterConfig_secondPageOutside").find(".button").eq(1).trigger("focus")}},{id:"UsersConfig_Cancel",text:ControlResources.SourceCode.Forms.Controls.Web.ControlPack.Properties.PickerCollection.Cancel,click:FilterPicker.dateConfigClose.bind(this)}],draggable:!0,content:e,width:300,headerText:ControlResources.SourceCode.Forms.Controls.Web.ControlPack.Properties.PickerCollection.ChooseDate,height:o,onClose:function(){FilterPicker.dateConfigClose.bind(this)}});var y=n("#worklist-control-filter-date-range"),u=n("#filter-picker-value_TextBox"),r=n(".date-range-picker-container"),s=y.find("select");if(f.attr("filter-config-date-type")==="specific")u.val(f.attr("filter-config-value")),u.data("calendarDate",f.data("calendarDate")),u.data("isValidDate",!0),s.dropdown(),s.dropdown("disable");else if(f.attr("filter-config-date-type")==="relative"){n("#date-range-picker-specific-date-radio").parent().removeClass("checked");var p=r.find("#filter-picker-value_TextBox");p.prop("disabled",!0);r.find(".calendar-control").addClass("disabled");p.prop("readonly",!0);r.find(".date").off();n("#date-range-picker-relative-date-radio").parent().addClass("checked");var w=n("#date-range-picker-relative-date-dropdown"),h=n("#date-range-picker-relative-date-dropdown").find("option");h.removeClass("selected");for(var a=0;a<h.length;a++)if(n(h[a]).val().trim()===f.attr("filter-config-value")){n(h[a]).addClass("selected");break}w.val(f.attr("filter-config-value"));w.dropdown().dropdown("refresh");s.dropdown()}else s.dropdown(),s.dropdown("disable");var h={firstDayOfWeek:"7",minInterval:"1",secInterval:"1",timeFormat:"hh:mm:ss",type:"datePicker"},c=n("#filter-picker-value_Image");u.data("format","<Format>d<\/Format>");t.addCalendarUpdateObject(u,c,h);var l=t.getCurrentDate(r),b={formatXmlString:"<Format>YYYY/MM/dd<\/Format>",value:l};if(f.val())n(".input-control-watermark").remove();else n(".input-control-watermark").off("click").on("click",function(){n(".input-control-watermark").remove();u.trigger("focus")});u.on("focus",function(){n(".input-control-watermark").remove()});if(navigator.userAgent.contains("Firefox")){var v=r.find(".overlay");v.length===0&&(v=n('<div class="overlay"> <\/div>'),v.appendTo(r.find("div.input-control-body.styling-left")))}r.find("div.input-control-body.styling-left").on("click",function(){var n=r,f=n.find("label.input-control.radio"),e=f.eq(0);n.find("span.input-control-img").eq(0).removeClass("hovered");e.find("input:radio").prop("checked",!0);e.addClass("checked");f.eq(1).removeClass("checked");var q=n.find("#filter-picker-value_TextBox");s.dropdown();s.dropdown("disable");q.prop("disabled",!1);n.find(".calendar-control").removeClass("disabled");q.prop("readonly",!1);t.addCalendarUpdateObject(u,c,h);l=t.getCurrentDate(r);var o={formatXmlString:"<Format>YYYY/MM/dd<\/Format>",value:l};q.trigger("focus")});r.find("div.input-control.select-box.lookup-box.calendar-control.datepicker-right").eq(0).off("mouseenter").on("mouseenter",function(){r.find("label.input-control.radio").eq(0).hasClass("checked")||r.find("span.input-control-img").eq(0).addClass("hovered")});r.find("div.input-control.select-box.lookup-box.calendar-control.datepicker-right").eq(0).off("mouseleave").on("mouseleave",function(){r.find("span.input-control-img").eq(0).removeClass("hovered")});r.find("div.input-control.select-box.dropdown-box.selected").eq(0).off("mouseenter").on("mouseenter",function(){r.find("label.input-control.radio").eq(1).hasClass("checked")||r.find("span.input-control-img").eq(1).addClass("hovered")});r.find("div.input-control.select-box.dropdown-box.selected").eq(0).off("click").on("click",function(){var n=r,t=n.find("#filter-picker-value_TextBox"),q=n.find("label.input-control.radio"),u=q.eq(1);r.find("span.input-control-img").eq(1).removeClass("hovered");q.eq(0).removeClass("checked");u.find("input:radio").prop("checked",!0);u.addClass("checked");t.prop("disabled",!0);n.find(".calendar-control").addClass("disabled");t.prop("readonly",!0);c.off("click");s.dropdown();s.dropdown("enable")});r.find("div.input-control.select-box.dropdown-box").eq(0).off("mouseleave").on("mouseleave",function(){r.find("span.input-control-img").eq(1).removeClass("hovered")});r.on("change","input:radio",function(){var q=r,n=q.find("#filter-picker-value_TextBox");if(this.value==="specificDate"){s.dropdown();s.dropdown("disable");n.prop("disabled",!1);q.find(".calendar-control").removeClass("disabled");n.prop("readonly",!1);t.addCalendarUpdateObject(u,c,h);l=t.getCurrentDate(r);var f={formatXmlString:"<Format>YYYY/MM/dd<\/Format>",value:l}}else this.value==="relativeDate"&&(n.prop("disabled",!0),q.find(".calendar-control").addClass("disabled"),n.prop("readonly",!0),c.off("click"),s.dropdown(),s.dropdown("enable"))});y.on("change","#filter-picker-value_TextBox",function(){t&&!u.data().isValidDate?n("#filter-picker-value_TextBox").closest(".calendar-control").addClass("invalid"):n("#filter-picker-value_TextBox").closest(".calendar-control").removeClass("invalid")});c.on("calendarChanged",function(){n("#filter-picker-value_TextBox").closest(".calendar-control").removeClass("invalid")})},error:function(){},complete:function(){}});n("#worklist-control-filter-date-range").find("input:radio").radiobutton();n("#date-range-picker-relative-date-radio").parent().hasClass("checked")&&n("#date-range-picker-relative-date-radio").trigger("change")},addDatePickerHandler:function(n){var t=this,q=n.attr("id");n.off("focus").on("focus",function(){t.displayDatePicker(n)})}}};typeof ControlUtil!="undefined"&&(ControlUtil.clearFilterProperty=function(n,t,q,r){var u=parseXML(n),e=u.selectSingleNode('Controls/Control/Properties/Property[Name="ColumnLayoutConfigurationValueHolder"]/Value'),f='[{"field":"WorklistItemStatus","compareOperator":"NotEqual","initialValue":"Sleep","converted":"3","value":"3","logicOperator":"AndBracket","type":"filter","dataType":"Integer"},{"type":"sort","sortfield":"eventStartDate","order":"Descending"}]';SourceCode.Forms.Controls.PickerCollection.FilterConfig.setXMLProperty(u,"FilterGroupingString",f,f);SourceCode.Forms.Controls.PickerCollection.FilterConfig.setXMLProperty(u,"FilterGrouping","(Default)","(Default)");r(1,u)})})(jQuery);
/*!
 SourceCode.Forms.Controls.Web.ControlPack.PickerCollection.Resources.JS.PickerCollectionRedirectConfig.js (Embedded resource)
*/
function initializeRedirectPickerRuntime(n,t,q,r){SourceCode.Forms.Controls.PickerCollection.RedirectConfig.initializeRuntime(n,t,q,r)}(function(n){(typeof SourceCode=="undefined"||SourceCode===null)&&(SourceCode={});(typeof SourceCode.Forms=="undefined"||SourceCode.Forms===null)&&(SourceCode.Forms={});(typeof SourceCode.Forms.Controls=="undefined"||SourceCode.Forms.Controls===null)&&(SourceCode.Forms.Controls={});(typeof SourceCode.Forms.Controls.PickerCollection=="undefined"||SourceCode.Forms.Controls.PickerCollection===null)&&(SourceCode.Forms.Controls.PickerCollection={});SourceCode.Forms.Controls.PickerCollection.RedirectConfig={callback:null,controlId:null,widget:null,serialNumber:null,worklistId:null,localAddedUserCache:null,initializeRuntime:function(t,q,r,u){this.widget=t;this.serialNumber=q;this.callback=u;this.controlId=t.element.prop("id");this.worklistId=r;var f=this;f.widget.options.isPickerOpen=!0;var o=null,s;n.ajax({type:"GET",url:applicationRoot+"PickerCollectionGetUserLabel.sdk",dataType:"json",async:!1,cache:!1,success:function(n){var t=JSON.stringify(n);o=n;s=o.pop();localStorage.setItem("picker-collection-security-label",t)},error:function(){var n=localStorage.getItem("picker-collection-security-label");n===null?o=JSON.parse('[{"Name":"K2"},{"Name":"SHAREPOINT"},{"Name":"SP"}]'):(o=JSON.parse(n),s="k2")}});popupManager.showPopup({id:"picker-collection-add-user-popup-root",buttons:[{id:"picker-collection-popup-help-button-redirect",type:"help",click:function(){HelpHelper.runHelp(5001)}},{id:"picker-collection-add-user-popup-ok-button",text:ControlResources.SourceCode.Forms.Controls.Web.ControlPack.Properties.PickerCollection.OK,click:f.redirectWorklist.bind(f)},{id:"picker-collection-add-user-popup-cancel-button",text:ControlResources.SourceCode.Forms.Controls.Web.ControlPack.Properties.PickerCollection.Cancel,click:f.closeBtn.bind(f)}],headerText:ControlResources.SourceCode.Forms.Controls.Web.ControlPack.Properties.PickerCollection.Redirect,draggable:!0,content:n("#picker-collection-add-user-container"),width:500,height:300,onClose:f.cancelOperation.bind(f)});this.initializeUserInterface(o,s.Default);this.addEventHandlers();var e=n("#picker-collection-add-user-popup-root");if(SourceCode.Forms.Browser.msie?(e.addClass("ie"),document.documentMode===9&&e.addClass("ie9"),document.documentMode===10&&e.addClass("ie10")):SourceCode.Forms.Browser.mozilla&&(document.documentMode===11?e.addClass("ie"):e.addClass("moz")),e.find(".worklistUserLookupTextbox").trigger("focus"),SourceCode.Forms.Browser.msie&&SourceCode.Forms.Browser.version<=9){var h=n("#picker-collection-add-user-popup-root"),c=h[0].style.display;h[0].style.display="none";setTimeout(function(){h[0].style.display=c},0)}},initializeUserInterface:function(t,q){var s=this,h=n("#picker-collection-add-user-container");h.find(".worklistAddUserPickerUserLookup").find("input.input-control").attr("id","picker-collection-add-user-search-text-field");n("#worklistAddUserPickerUserLookup").find("span").last().remove();var f=localStorage.getItem("picker-collection-recently-added-users");if(f!==null){for(var e=JSON.parse(f),u="",r=0;r<e.length;r++)r!==0&&(u+=","),u+=e[r].FQN;var c={delegates:u};n.ajax({url:applicationRoot+"PickerCollectionDelegatedUserList.sdk",type:"POST",dataType:"JSON",data:c,async:!1,success:function(n){s._populateGridRow(n);localStorage.setItem("picker-collection-recently-added-users",JSON.stringify(n))}})}n("#picker-collection-add-user-advanced-search-label-select-field").append("<option value='"+q+"'>"+q+"<\/option>");for(var r=0;r<t.length;r++){var o=t[r].Name;n("#picker-collection-add-user-advanced-search-label-select-field").append("<option value='"+o+"'>"+o+"<\/option>")}q==="AAD"&&n("#picker-collection-add-user-advanced-search-select-field").html("<option value='Begins With'>Begins With<\/option>");n("#picker-collection-add-user-advanced-search-select-field").dropdown();n("#picker-collection-add-user-advanced-search-label-select-field").on("change",function(){n("#picker-collection-add-user-advanced-search-label-select-field option:selected").text()==="AAD"?n("#picker-collection-add-user-advanced-search-select-field").html("<option value='Begins With'>Begins With<\/option>"):n("#picker-collection-add-user-advanced-search-select-field").html("<option value='Begins With'>Begins With<\/option><option value='Contains'>Contains<\/option><option value='Ends With'>Ends With<\/option><option value='Equals'>Equals<\/option>");n("#picker-collection-add-user-advanced-search-select-field").dropdown().dropdown("refresh")});n("#picker-collection-add-user-advanced-search-select-field").dropdown();n("#picker-collection-add-user-advanced-search-label-select-field").dropdown();n(".popupManager .scroll-wrapper").css({"overflow-y":"hidden"})},_populateGridRow:function(t){n("#picker-collection-add-user-operation-box-body .picker-collection-grid-row").remove();var q=n("#picker-collection-add-user-operation-box-body");n.each(t,function(n,t){var r=n%2==0?"even":"";checkExists(t)&&q.append("<div class='picker-collection-grid-row "+r+"'> \t\t\t\t\t\t<div class='picker-collection-grid-row-user-image'><\/div> \t\t\t\t\t\t<div class='picker-collection-grid-row-user-display-name' title=\""+t.DisplayName.htmlEncode()+'">'+t.DisplayName.htmlEncode()+"<\/div> \t\t\t\t\t\t<div class='picker-collection-grid-row-user-email' title=\""+t.Email.htmlEncode()+'">'+t.Email.htmlEncode()+"<\/div> \t\t\t\t\t\t<div class='picker-collection-grid-row-user-id'>"+t.ObjectSID.htmlEncode()+"<\/div> \t\t\t\t\t\t<div class='picker-collection-grid-row-user-FQN'>"+t.FQN.htmlEncode()+"<\/div> \t\t\t\t\t<\/div>")});q.find(".picker-collection-grid-row").eq(0).addClass("selected");q.find(".picker-collection-grid-row").length===0&&n("#picker-collection-add-user-operation-box-body").append('<div class="picker-collection-grid-row search-not-found">'+ControlResources.SourceCode.Forms.Controls.Web.ControlPack.Properties.PickerCollection.NoSearchResults+"<\/div>");var r=this;n(".picker-collection-grid-row").off("click").on("click",function(t){r.AddUserRowClick(n(this),t)})},AddUserRowClick:function(t,q){if(!(q.ctrlKey||q.shiftKey)){n("#picker-collection-add-user-operation-box-body").find(".selected").removeClass("selected");t.toggleClass("selected");this.PrevSelection=t;return}q.ctrlKey===!0&&(t.toggleClass("selected"),this.PrevSelection=t);function o(t,q,r){q++;for(var u=t;u<q;u++)n(r[u]).addClass("selected")}if(q.shiftKey===!0){if(typeof this.PrevSelection=="undefined"){this.PrevSelection=t;return}n("#picker-collection-add-user-operation-box-body").find(".selected").removeClass("selected");for(var u=n("#picker-collection-add-user-operation-box-body").find(".picker-collection-grid-row"),f=0,e=0,r=0;r<u.length;r++)n(u[r]).is(t)&&(f=r),n(u[r]).is(this.PrevSelection)&&(e=r);f>e?o(e,f,u):o(f,e,u)}},doSearchOperation:function(){var t=this,u=n("#picker-collection-add-user-container"),r=u.find(".worklistUserLookupTextbox").val().trim();if(r.length===0){popupManager.showWarning(ControlResources.SourceCode.Forms.Controls.Web.ControlPack.Properties.PickerCollection.EmptyUserSearchWarning);return}var f=n("#picker-collection-add-user-advanced-search-select-field").val(),q=n("#picker-collection-add-user-advanced-search-label-select-field").val();checkExists(q)||(q="K2");n.ajax({type:"POST",url:applicationRoot+"PickerCollectionGetUserList.sdk",dataType:"text",data:{textFilter:r,filterToken:f,label:q},cache:!1,beforeSend:function(q){t.showAjaxLoader(n("#picker-collection-add-user-popup-root"));SourceCode.Forms.XSRFHelper.setAntiXSRFHeader(q)},success:function(q){for(var r=JSON.parse(q),f=SourceCode.Forms.Settings.User.FQN.toLowerCase(),u=0,e=r.length;u<e;u++)checkExists(r[u])&&r[u].FQN.toLowerCase()===f&&r.splice(u,1);n("#picker-collection-add-user-operation-box-body").find(".picker-collection-grid-row").remove();n("#picker-collection-add-user-operation-box-header").find("span").text(ControlResources.SourceCode.Forms.Controls.Web.ControlPack.Properties.PickerCollection.SearchResult);t._populateGridRow(r);t.hightlightText()},complete:function(){t.removeAjaxLoader(n("#picker-collection-add-user-popup-root"))},error:function(){popupManager.showWarning("PickerCollectionGetUserList.sdk failed. Unable to connect to server")}})},hightlightText:function(){var q=n("#picker-collection-add-user-container"),t="";if(q.length>0){if(t=q.find(".worklistUserLookupTextbox").val(),!t.trim())return}else return;var r=n("#picker-collection-add-user-operation-box-body .picker-collection-grid-row");n.each(r,function(q,r){var c=n(r).find(".picker-collection-grid-row-user-display-name"),e=c.text();if(e!==""){for(var f=e,o="",s=0;s<e.length;){var u=f.toLowerCase().indexOf(t.toLowerCase());if(u>-1){var h=t.length,l=f.substring(u,u+h);u>0&&(o+=f.substring(0,u));o+="<span class='picker-collection-search-text-highlight'>"+l+"<\/span>";f=f.substring(u+h,e.length);s=u+h}else o+=f,s=e}c.html(o)}})},addEventHandlers:function(){var r=this,t=n("#picker-collection-add-user-container"),u=t.find(".worklistUserLookupTextbox"),f=t.find(".worklistUserLookupIconWrapper"),e=t.find(".worklistUserLookupClearIconWrapper");n(".picker-collection-add-user-search-option-expander-down, .picker-collection-add-user-search-option-expander-up").on("click",function(){var q=n(this);return q.toggleClass("picker-collection-add-user-search-option-expander-up picker-collection-add-user-search-option-expander-down"),q.hasClass("picker-collection-add-user-search-option-expander-down")?(n(".picker-collection-add-user-search-option-expander-down").attr("title",ControlResources.SourceCode.Forms.Controls.Web.ControlPack.Properties.PickerCollection.ExpandSearchCriteria),t.addClass("collapsed")):(n(".picker-collection-add-user-search-option-expander-up").attr("title",ControlResources.SourceCode.Forms.Controls.Web.ControlPack.Properties.PickerCollection.CollapseSearchCriteria),t.removeClass("collapsed")),!1});u.on("keypress",function(n){var t=n.KeyCode?n.keyCode:n.which;t=="13"&&r.doSearchOperation()});f.off("click").on("click",function(){r.doSearchOperation()});e.off("click").on("click",function(){u.val("");n("#picker-collection-add-user-operation-box-header").find("span").text(ControlResources.SourceCode.Forms.Controls.Web.ControlPack.Properties.PickerCollection.Recent);n("#picker-collection-add-user-operation-box-body").find(".picker-collection-grid-row").remove();var t=localStorage.getItem("picker-collection-recently-added-users");if(t!==null){var q=JSON.parse(t);r._populateGridRow(q)}});var q=t.find(".userLookupRow");u.off("mouseenter").on("mouseenter",function(){q.addClass("highlight_hover")}).off("focus").on("focus",function(){q.addClass("highlight_focus")}).off("mouseleave").on("mouseleave",function(){q.removeClass("highlight_hover")}).off("blur").on("blur",function(){q.removeClass("highlight_focus")})},redirectWorklist:function(){for(var t=n("#picker-collection-add-user-operation-box-body").find(".picker-collection-grid-row.selected"),q=0;q<t.length;q++)for(var u=n(t[q]),f=u.find(".picker-collection-grid-row-user-FQN").text(),r=0;r<this.serialNumber.length;r++)this.callback(this.serialNumber[r],f,this.widget);var e=n("#picker-collection-add-user-operation-box-body"),t=e.find(".picker-collection-grid-row.selected");t.length!=0&&this.updateRecentUserCache(t);n("#picker-collection-add-user-container").remove();popupManager.closeLast({cancelOnClose:!0});this.widget.options.isPickerOpen=!1},updateRecentUserCache:function(t){var e=localStorage.getItem("picker-collection-recently-added-users"),r=null,o=5;if(e!==null){r=JSON.parse(e);for(var q=0;q<t.length;q++){for(var s=n(t[q]).find(".picker-collection-grid-row-user-display-name").text(),h=n(t[q]).find(".picker-collection-grid-row-user-email").text(),c=n(t[q]).find(".picker-collection-grid-row-user-id").text(),u=n(t[q]).find(".picker-collection-grid-row-user-FQN").text(),f=!1,q=0;q<r.length;q++)u===r[q].FQN&&(f=!0);if(f){f=!1;continue}r.unshift({DisplayName:s,Email:h,ObjectSID:c,FQN:u});r.length>=o&&r.pop()}}else{r=[];for(var q=0;q<t.length;q++){if(q===o)break;var s=n(t[q]).find(".picker-collection-grid-row-user-display-name").text(),h=n(t[q]).find(".picker-collection-grid-row-user-email").text(),c=n(t[q]).find(".picker-collection-grid-row-user-id").text(),u=n(t[q]).find(".picker-collection-grid-row-user-FQN").text();r.push({DisplayName:s,Email:h,ObjectSID:c,FQN:u})}}localStorage.setItem("picker-collection-recently-added-users",JSON.stringify(r))},showAjaxLoader:function(n){n.append("<div class='ajaxLoader'><\/div>");n.find(".ajaxLoader").css({height:n.height()+"px",width:n.width()+"px",position:"absolute"})},removeAjaxLoader:function(n){n.find(".ajaxLoader").remove()},cancelOperation:function(){n("#picker-collection-add-user-container").remove();this.widget.options.isPickerOpen=!1},closeBtn:function(){n("#picker-collection-add-user-container").remove();popupManager.closeLast();this.widget.options.isPickerOpen=!1}}})(jQuery);
/*!
 SourceCode.Forms.Controls.Web.ControlPack.PickerCollection.Resources.JS.PickerCollectionAddUserConfig.js (Embedded resource)
*/
function initializeAddUserPickerRuntime(n,t){SourceCode.Forms.Controls.PickerCollection.AddUserConfig.initializeRuntime(n,t)}(function(n){(typeof SourceCode=="undefined"||SourceCode===null)&&(SourceCode={});(typeof SourceCode.Forms=="undefined"||SourceCode.Forms===null)&&(SourceCode.Forms={});(typeof SourceCode.Forms.Controls=="undefined"||SourceCode.Forms.Controls===null)&&(SourceCode.Forms.Controls={});(typeof SourceCode.Forms.Controls.PickerCollection=="undefined"||SourceCode.Forms.Controls.PickerCollection===null)&&(SourceCode.Forms.Controls.PickerCollection={});SourceCode.Forms.Controls.PickerCollection.AddUserConfig={stringXML:null,parentPicker:null,callback:null,controlId:null,widget:null,serialNumber:null,initializeRuntime:function(t,q){this.parentPicker=t;this.widget=t.widget;this.callback=q;this.controlId=this.widget.element.prop("id");this.serialNumber="";checkExists(t.serialNumber)&&(this.serialNumber=t.serialNumber);var r=this,u=null,f;n.ajax({type:"GET",url:applicationRoot+"PickerCollectionGetUserLabel.sdk",dataType:"json",async:!1,cache:!1,success:function(n){var t=JSON.stringify(n);u=n;f=u.pop();localStorage.setItem("picker-collection-security-label",t)},error:function(){var n=localStorage.getItem("picker-collection-security-label");n===null?u=JSON.parse('[{"Name":"K2"},{"Name":"SHAREPOINT"},{"Name":"SP"}]'):(u=JSON.parse(n),f.Default="k2")}});n.ajax({type:"POST",url:applicationRoot+"PickerCollectionAddUserPicker.sdk",dataType:"text",async:!1,data:{controlId:r.controlId},cache:!1,beforeSend:function(t){r.showAjaxLoader(n("#picker-collection-add-user-popup-root"));SourceCode.Forms.XSRFHelper.setAntiXSRFHeader(t)},success:function(t){popupManager.showPopup({id:"picker-collection-add-user-popup-root",buttons:[{id:"picker-collection-popup-help-button-add-user",type:"help",click:function(){HelpHelper.runHelp(5001)}},{id:"picker-collection-add-user-popup-ok-button",text:ControlResources.SourceCode.Forms.Controls.Web.ControlPack.Properties.PickerCollection.OK,click:r.addSelectedUsers.bind(r)},{id:"picker-collection-add-user-popup-cancel-button",text:ControlResources.SourceCode.Forms.Controls.Web.ControlPack.Properties.PickerCollection.Cancel,click:r.closeBtn.bind(r)}],headerText:ControlResources.SourceCode.Forms.Controls.Web.ControlPack.Properties.PickerCollection.AddUserPickerTitle,draggable:!0,content:t,width:500,height:300,onClose:r.cancelOperation.bind(r)});var q=n("#picker-collection-add-user-popup-root");SourceCode.Forms.Browser.msie?(q.addClass("ie"),document.documentMode===9&&q.addClass("ie9"),document.documentMode===10&&q.addClass("ie10")):SourceCode.Forms.Browser.mozilla&&(document.documentMode===11?q.addClass("ie"):q.addClass("moz"));r.initializeUserInterface(u,f.Default);r.addEventHandlers();q.find(".worklistUserLookupTextbox").trigger("focus")},complete:function(){r.removeAjaxLoader(n("#picker-collection-add-user-popup-root"))},error:function(){}})},initializeUserInterface:function(t,q){var e=localStorage.getItem("picker-collection-recently-added-users");if(e!==null){for(var o=JSON.parse(e),u="",r=0;r<o.length;r++)r!==0&&(u+=","),u+=o[r].FQN;var s={delegates:u};n.ajax({url:applicationRoot+"PickerCollectionDelegatedUserList.sdk",type:"POST",dataType:"JSON",data:s,async:!1,success:function(n){SourceCode.Forms.Controls.PickerCollection.AddUserConfig._populateGridRow(n);localStorage.setItem("picker-collection-recently-added-users",JSON.stringify(n))}})}n("#picker-collection-add-user-advanced-search-label-select-field").append("<option value='"+q+"'>"+q+"<\/option>");for(var r=0;r<t.length;r++){var f=t[r].Name;f!==q&&n("#picker-collection-add-user-advanced-search-label-select-field").append("<option value='"+f+"'>"+f+"<\/option>")}q==="AAD"&&n("#picker-collection-add-user-advanced-search-select-field").html("<option value='Begins With'>Begins With<\/option>");n("#picker-collection-add-user-advanced-search-select-field").dropdown();n("#picker-collection-add-user-advanced-search-label-select-field").on("change",function(){n("#picker-collection-add-user-advanced-search-label-select-field option:selected").text()==="AAD"?n("#picker-collection-add-user-advanced-search-select-field").html("<option value='Begins With'>Begins With<\/option>"):n("#picker-collection-add-user-advanced-search-select-field").html("<option value='Begins With'>Begins With<\/option><option value='Contains'>Contains<\/option><option value='Ends With'>Ends With<\/option><option value='Equals'>Equals<\/option>");n("#picker-collection-add-user-advanced-search-select-field").dropdown().dropdown("refresh")});n("#picker-collection-add-user-advanced-search-select-field").dropdown();n("#picker-collection-add-user-advanced-search-label-select-field").dropdown();n(".popupManager .scroll-wrapper").css({"overflow-y":"hidden"})},addEventHandlers:function(){var u=this,t=n("#picker-collection-add-user-container"),r=t.find(".worklistUserLookupTextbox"),f=t.find(".worklistUserLookupIconWrapper"),e=t.find(".worklistUserLookupClearIconWrapper");n(".picker-collection-add-user-search-option-expander-down, .picker-collection-add-user-search-option-expander-up").on("click",function(){var q=n(this);return q.toggleClass("picker-collection-add-user-search-option-expander-up picker-collection-add-user-search-option-expander-down"),n("#picker-collection-add-user-advanced-search-select-field").dropdown().dropdown("hidedropdown"),n("#picker-collection-add-user-advanced-search-label-select-field").dropdown().dropdown("hidedropdown"),q.hasClass("picker-collection-add-user-search-option-expander-down")?(n(".picker-collection-add-user-search-option-expander-down").attr("title",ControlResources.SourceCode.Forms.Controls.Web.ControlPack.Properties.PickerCollection.ExpandSearchCriteria),t.addClass("collapsed")):(n(".picker-collection-add-user-search-option-expander-up").attr("title",ControlResources.SourceCode.Forms.Controls.Web.ControlPack.Properties.PickerCollection.CollapseSearchCriteria),t.removeClass("collapsed")),!1});r.on("keypress",function(n){var t=n.KeyCode?n.keyCode:n.which;t=="13"&&SourceCode.Forms.Controls.PickerCollection.AddUserConfig.doSearchOperation()});f.off("click").on("click",function(){SourceCode.Forms.Controls.PickerCollection.AddUserConfig.doSearchOperation()});e.off("click").on("click",function(){r.val("");n("#picker-collection-add-user-operation-box-header").find("span").text(ControlResources.SourceCode.Forms.Controls.Web.ControlPack.Properties.PickerCollection.Recent);n("#picker-collection-add-user-operation-box-body").find(".picker-collection-grid-row").remove();var t=localStorage.getItem("picker-collection-recently-added-users");if(t!==null){var q=JSON.parse(t);u._populateGridRow(q)}});var q=t.find(".userLookupRow");r.off("mouseenter").on("mouseenter",function(){q.addClass("highlight_hover")}).off("focus").on("focus",function(){q.addClass("highlight_focus")}).off("mouseleave").on("mouseleave",function(){q.removeClass("highlight_hover")}).off("blur").on("blur",function(){q.removeClass("highlight_focus")})},_populateGridRow:function(t){var r=this;n("#picker-collection-add-user-operation-box-body .picker-collection-grid-row").remove();var q=n("#picker-collection-add-user-operation-box-body");n.each(t,function(n,t){var r=n%2==0?"even":"";q.append("<div class='picker-collection-grid-row "+r+"'>                         <div class='picker-collection-grid-row-user-image'><\/div>                         <div class='picker-collection-grid-row-user-display-name' title=\""+t.DisplayName.htmlEncode()+'">'+t.DisplayName.htmlEncode()+"<\/div>                         <div class='picker-collection-grid-row-user-email' title=\""+t.Email.htmlEncode()+'">'+t.Email.htmlEncode()+"<\/div>                         <div class='picker-collection-grid-row-user-id'>"+t.ObjectSID.htmlEncode()+"<\/div>                         <div class='picker-collection-grid-row-user-FQN'>"+t.FQN.htmlEncode()+"<\/div>                     <\/div>")});q.find(".picker-collection-grid-row").eq(0).addClass("selected");q.find(".picker-collection-grid-row").length===0&&n("#picker-collection-add-user-operation-box-body").append('<div class="picker-collection-grid-row search-not-found">'+ControlResources.SourceCode.Forms.Controls.Web.ControlPack.Properties.PickerCollection.NoSearchResults+"<\/div>");n(".picker-collection-grid-row").off("click").on("click",function(t){r.AddUserRowClick(n(this),t)})},AddUserRowClick:function(t,q){if(!(q.ctrlKey||q.shiftKey)){n("#picker-collection-add-user-operation-box-body").find(".selected").removeClass("selected");t.toggleClass("selected");this.PrevSelection=t;return}q.ctrlKey===!0&&(t.toggleClass("selected"),this.PrevSelection=t);function o(t,q,r){q++;for(var u=t;u<q;u++)n(r[u]).addClass("selected")}if(q.shiftKey===!0){if(typeof this.PrevSelection=="undefined"){this.PrevSelection=t;return}n("#picker-collection-add-user-operation-box-body").find(".selected").removeClass("selected");for(var u=n("#picker-collection-add-user-operation-box-body").find(".picker-collection-grid-row"),f=0,e=0,r=0;r<u.length;r++)n(u[r]).is(t)&&(f=r),n(u[r]).is(this.PrevSelection)&&(e=r);f>e?o(e,f,u):o(f,e,u)}},doSearchOperation:function(){var t=this,u=n("#picker-collection-add-user-container"),r=u.find(".worklistUserLookupTextbox").val().trim();if(r.length===0){popupManager.showWarning(ControlResources.SourceCode.Forms.Controls.Web.ControlPack.Properties.PickerCollection.EmptyUserSearchWarning);return}var f=n("#picker-collection-add-user-advanced-search-select-field").val(),q=n("#picker-collection-add-user-advanced-search-label-select-field").val();checkExists(q)||(q="K2");n.ajax({type:"POST",url:applicationRoot+"PickerCollectionGetUserList.sdk",dataType:"text",data:{textFilter:r,filterToken:f,label:q},cache:!1,beforeSend:function(q){t.showAjaxLoader(n("#picker-collection-add-user-popup-root"));SourceCode.Forms.XSRFHelper.setAntiXSRFHeader(q)},success:function(q){n("#picker-collection-add-user-operation-box-body").find(".picker-collection-grid-row").remove();n("#picker-collection-add-user-operation-box-header").find("span").text(ControlResources.SourceCode.Forms.Controls.Web.ControlPack.Properties.PickerCollection.SearchResult);for(var r=JSON.parse(q),u=0;u<r.length;u++)r[u].FQN.toLowerCase()===SourceCode.Forms.Settings.User.FQN.toLowerCase()&&r.splice(u,1);t._populateGridRow(r);t.hightlightText()},complete:function(){t.removeAjaxLoader(n("#picker-collection-add-user-popup-root"))},error:function(){popupManager.showWarning("PickerCollectionGetUserList.sdk failed. Unable to connect to server")}})},hightlightText:function(){var q=n("#picker-collection-add-user-container"),t="";if(q.length>0){if(t=q.find(".worklistUserLookupTextbox").val(),!t.trim())return;t=t.htmlEncode()}else return;var r=n("#picker-collection-add-user-operation-box-body .picker-collection-grid-row");n.each(r,function(q,r){var c=n(r).find(".picker-collection-grid-row-user-display-name"),e=c.text().htmlEncode();if(e!==""){for(var f=e,o="",s=0;s<e.length;){var u=f.toLowerCase().indexOf(t.toLowerCase());if(u>-1){var h=t.length,l=f.substring(u,u+h);u>0&&(o+=f.substring(0,u));o+="<span class='picker-collection-search-text-highlight'>"+l+"<\/span>";f=f.substring(u+h,e.length);s=u+h}else o+=f,s=e}c.html(o)}})},updateRecentUserCache:function(t){var c=localStorage.getItem("picker-collection-recently-added-users"),r=null,l=5;if(c!==null){r=JSON.parse(c);for(var q=0;q<t.length;q++){for(var f=n(t[q]).find(".picker-collection-grid-row-user-display-name").text(),e=n(t[q]).find(".picker-collection-grid-row-user-email").text(),o=n(t[q]).find(".picker-collection-grid-row-user-id").text(),u=n(t[q]).find(".picker-collection-grid-row-user-FQN").text(),s=!1,h=0;h<r.length;h++)u===r[h].FQN&&(s=!0);if(s){s=!1;continue}r.length>=l?(r.unshift({DisplayName:f,Email:e,ObjectSID:o,FQN:u}),r.pop()):r.unshift({DisplayName:f,Email:e,ObjectSID:o,FQN:u})}}else{r=[];for(var q=0;q<t.length;q++){if(q===l)break;var f=n(t[q]).find(".picker-collection-grid-row-user-display-name").text(),e=n(t[q]).find(".picker-collection-grid-row-user-email").text(),o=n(t[q]).find(".picker-collection-grid-row-user-id").text(),u=n(t[q]).find(".picker-collection-grid-row-user-FQN").text();r.push({DisplayName:f,Email:e,ObjectSID:o,FQN:u})}}localStorage.setItem("picker-collection-recently-added-users",JSON.stringify(r))},addSelectedUsers:function(){var u=n("#picker-collection-add-user-operation-box-body"),t=u.find(".picker-collection-grid-row.selected");if(t.length===0){popupManager.showWarning(ControlResources.SourceCode.Forms.Controls.Web.ControlPack.Properties.PickerCollection.NoUserSelected);return}this.updateRecentUserCache(t);for(var r=[],q=0;q<t.length;q++){var f=n(t[q]).find(".picker-collection-grid-row-user-display-name").text(),e=n(t[q]).find(".picker-collection-grid-row-user-email").text(),o=n(t[q]).find(".picker-collection-grid-row-user-id").text(),s=n(t[q]).find(".picker-collection-grid-row-user-FQN").text();r.push({DisplayName:f,Email:e,ObjectSID:o,FQN:s})}n("#picker-collection-add-user-container").remove();popupManager.closeLast({cancelOnClose:!0});this.widget.options.isPickerOpen=!1;this.serialNumber===""?this.callback(r,this.parentPicker):this.callback(r)},showAjaxLoader:function(n){n.append("<div class='ajaxLoader'>");n.find(".ajaxLoader").css({height:n.height()+"px",width:n.width()+"px",position:"absolute"})},removeAjaxLoader:function(n){n.find(".ajaxLoader").remove()},cancelOperation:function(){n("#picker-collection-add-user-container").remove();this.callback([],!0)},closeBtn:function(){n("#picker-collection-add-user-container").remove();popupManager.closeLast();this.widget.options.isPickerOpen=!1}}})(jQuery);
/*!
 SourceCode.Forms.Controls.Web.ControlPack.PickerCollection.Resources.JS.PickerCollectionAddOOFException.js (Embedded resource)
*/
function initializeOOFExceptionPicker(n,t,q,r,u){SourceCode.Forms.Controls.PickerCollection.OOFExcep.initializeRuntime(n,t,q,r,u)}(function(n){(typeof SourceCode=="undefined"||SourceCode===null)&&(SourceCode={});(typeof SourceCode.Forms=="undefined"||SourceCode.Forms===null)&&(SourceCode.Forms={});(typeof SourceCode.Forms.Controls=="undefined"||SourceCode.Forms.Controls===null)&&(SourceCode.Forms.Controls={});(typeof SourceCode.Forms.Controls.PickerCollection=="undefined"||SourceCode.Forms.Controls.PickerCollection===null)&&(SourceCode.Forms.Controls.PickerCollection={});SourceCode.Forms.Controls.PickerCollection.OOFExcep=OOFExceptionPicker={name:"OOFExceptionPicker",Resx:null,controlId:"",callback:null,widget:null,treeXml:null,rulesWizardTree:null,tempTree:null,exception:null,isEditMode:!1,tmpExceptionUser:null,initializeRuntime:function(t,q,r,u,f){var e=this;this.widget=t;this.controlId=q;this.callback=r;this.Resx=ControlResources.SourceCode.Forms.Controls.Web.ControlPack.Properties.PickerCollection;f===SourceCode.Forms.Controls.PickerCollection.OOFConfig.EXCEPTION_PICKER_MODE.ADD?(this.exception={},this.exception.users=[],this.isEditMode=!1):(this.isEditMode=!0,this.exception=n.extend(!0,{},u));this.loadPicker(q)},loadPicker:function(){var t=this;n.ajax({url:applicationRoot+"PickerCollectionOOFExceptionPicker.sdk",dataType:"text",data:{controlId:t.controlId},async:!1,type:"POST",success:function(n){t.displayPicker(n);t.configureContent(n)},complete:function(){var t=n("#addOOFException");SourceCode.Forms.Browser.mozilla&&t.addClass("moz");SourceCode.Forms.Browser.msie&&(t.addClass("ie"),document.documentMode===9&&t.addClass("ie9"),document.documentMode===10&&t.addClass("ie10"))}})},displayPicker:function(n){popupManager.showPopup({id:"addOOFException",buttons:[{id:"OOFExceptionHelp",type:"help",click:function(){HelpHelper.runHelp(5010)}},{text:this.Resx.OK,click:this.createException.bind(this,!1)},{id:"OOFExceptionCancel",text:this.Resx.Cancel,click:this.closePopupCancel.bind(this)}],headerText:this.Resx.OOFExceptionPickerTitle,draggable:!0,content:n,width:600,height:351,onClose:this.closePopup.bind(this)})},configureContent:function(){var t=this,r=n("#addOOFException");t.tmpExceptionUser=[];var q=n("#addOOFException").find(".editableUserLookupTextbox");if(q.attr("spellcheck",!1),q.empty(),t.isEditMode){var l=decodeURIComponent(t.exception.name);r.find(".OOFExceptionName").val(l);for(var e="",a=JSON.parse(localStorage.oofNames),f=0;f<t.exception.users.length;f++)if(t.exception.users[f].deleted===!1){var h=t.exception.users[f].name,o=a[h];typeof o=="undefined"&&(o=t.exception.users[f].friendlyName);e+="<span class='spacer'>&nbsp;<\/span><span class='OOFUserLookupUsername entity' contenteditable='false' data-name='{0}' data-friendly='{1}' title='{0}'><span class='resolved'>{1}<\/span>;<\/span>".format(h.htmlEncode(),o.htmlEncode())}e+="<span class='spacer'>&nbsp;<\/span>";q.append(e);t.tmpExceptionUser=t.exception.users}q.on("mouseover.picker",t.onMouseOver.bind(this,q));var s=r.find("div.popup-body-c"),u=s.find(".workflowContainer");u.addClass("workflowTreeContainer");var c=r.find("input").eq(1),w=window.location.href.indexOf("Designer")>-1?"Designer":"Runtime",v=r.find(".OOFExceptionName");v.off("blur").on("blur",function(){var q=encodeURIComponent(n(this).val());t.exception.name=q});var y=n("#OOFGrid").find(".OOFTreeXSLTReference");SourceCode.Forms.Controls.Web.ControlPack.Utils.TreeNodeFilterHelper.setXSLTFile(y);var p=n("#addOOFException").find(".workflowContainer");SourceCode.Forms.Controls.Web.ControlPack.Utils.TreeNodeFilterHelper.setTreeContainerElement(p);n.ajax({url:applicationRoot+"Utilities/AJAXCall.ashx",data:{method:"getItems",resultTypes:"ProcessFolders|ProcessSets|Processes|Activities|ActivitiesWithClientEvents",resultFlags:"Client"},type:"POST",dataType:"text",global:!1,beforeSend:function(n){t.isEditMode?s.addClass("disabled"):r.find("input").eq(0).trigger("focus");c.prop("readonly",!0);q.prop("contenteditable",!1);t.showAjaxLoader(u);SourceCode.Forms.XSRFHelper.setAntiXSRFHeader(n)},success:function(r){if(r=="<Items />"){t.closePopupCancel();popupManager.showNotification(t.Resx.NoWorkflowsAvailableToUser);return}if(SourceCode.Forms.ExceptionHandler.isException(r)){t.closePopupCancel();SourceCode.Forms.ExceptionHandler.handleException(r);return}SourceCode.Forms.Controls.Web.ControlPack.Utils.TreeNodeFilterHelper.loadWorkflowTree(r);var s=n("#OOFExceptionContext");this.tempTree=u.html();var o=n("#workflowSearchBox"),h=8,c=32,l=96,a=105;o.on("keyup",function(t){var q=t.keyCode;(q===h||41<q&&q<91||l<=q&&q<=a||q===c||186<q&&q<192)&&(n(this).val().trim().length===0?SourceCode.Forms.Controls.Web.ControlPack.Utils.TreeNodeFilterHelper.loadWorkflowTree(r):SourceCode.Forms.Controls.Web.ControlPack.Utils.TreeNodeFilterHelper.filterOut(this))});if(o.textbox(),t.isEditMode){var v=t.exception.activity.name;$root=u.find(".root");$tree=u.find(".tree");$root.find("li").each(function(){var q=n(this),r=q.data().metadata.name;if(v===r){q.addClass("selected");for(var t=q;t.hasClass("root")===!1;)t=t.parent().closest("li",$tree),t.addClass("open").removeClass("closed")}})}SourceCode.Forms.Controls.Worklist.bindUserPickerEvents(t,s);var e,f;u.on("keydown",function(t){f=t.keyCode;f===9?(e=u.find(".selected"),e.length>0&&e.removeClass("selected"),n(document.activeElement).parent().addClass("selected"),t.shiftKey?n("#workflowSearchBox").trigger("focus"):q.trigger("focus"),t.preventDefault()):(f===32||36<f&&f<41)&&t.preventDefault()})},complete:function(){t.isEditMode&&(s.removeClass("disabled"),r.find("input").eq(0).trigger("focus"));c.prop("readonly",!1);q.prop("contenteditable",!0);t.removeAjaxLoader(r)},error:function(){}})},onMouseOver:function(t){if(t.hasClass("invalid")){var q=n("#OOF_Tooltip");UtilitiesHelper.setToolTipPosition(q,t);q.show()}},createException:function(){if(this.validate()!==!1){var t=n("#OOFExceptionContext"),q=t.find(".workflowContainer").find(".selected");this.exception.activity=q.data().metadata;this.exception.activity.text=this.exception.activity.text.replace(/<\/?[^>]+(>|$)/g,"");this.callback(this.exception);popupManager.closeLast({cancelOnClose:!0})}},validate:function(){var r=n("#OOFExceptionContext"),q=r.find(".OOFExceptionName").val().trim();if(q.length===0)return popupManager.showWarning(this.Resx.OOFExceptionPickerNoRuleName),!1;if(/<(.|\n)*?>/.test(q))return popupManager.showWarning(ControlResources.SourceCode.Forms.Controls.Web.ControlPack.Properties.PickerCollection.OOFExceptionPickerInvalidRuleName),!1;if(q=ControlPackBase.escapeSpecialChar(q),!this.isEditMode||this.isEditMode&&q!==this.exception.name)for(var t=0;t<OOF.exceptions.length;t++)if(q===OOF.exceptions[t].name)return popupManager.showWarning(this.Resx.OOFExceptionPickerRuleNameExists.format(q)),!1;this.exception.name=q;var u=r.find(".workflowContainer").find(".selected");if(u.length===0||u.data().metadata.ItemType!=="Activity")return popupManager.showWarning(this.Resx.OOFExceptionPickerInvalidActivity),!1;if(typeof this.exception.users=="undefined"||this.exception.users.length===0)return popupManager.showWarning(this.Resx.OOFPickerNoDestination),!1;if(r.find(".unresolved").length>0)return popupManager.showWarning(ControlResources.SourceCode.Forms.Controls.Web.ControlPack.Properties.PickerCollection.OOFPickerUnresolved),!1;for(var f=!1,t=0;t<this.exception.users.length;t++)if(this.exception.users[t].deleted===!1){f=!0;break}if(f===!1)return popupManager.showWarning(this.Resx.OOFPickerNoDestination),!1;for(var t=0;t<this.exception.users.length;t++)if(this.exception.users[t].deleted===!1&&this.exception.users[t].name===SourceCode.Forms.Settings.User.FQN)return popupManager.showWarning(this.Resx.OOFPickerLoggedInUserAsDestination),!1;return!0},showAjaxLoader:function(n){n.append("<div class='ajaxLoader'><\/div>");n.find(".ajaxLoader").css({height:n.height()+"px",width:n.width()+"px",position:"absolute"})},removeAjaxLoader:function(n){n.find(".ajaxLoader").remove()},closePopupCancel:function(){n("#addOOFException").remove();popupManager.closeLast({cancelOnClose:!0});SourceCode.Forms.Browser.msie&&setTimeout(function(){n(popupManager.getPopup("OOFConfig").element[0].nextSibling).remove()},50)},closePopup:function(){n("#addOOFException").remove();SourceCode.Forms.Browser.msie&&setTimeout(function(){n(popupManager.getPopup("OOFConfig").element[0].nextSibling).remove()},50)}}})(jQuery);
/*!
 SourceCode.Forms.Controls.Web.ControlPack.PickerCollection.Resources.JS.PickerCollectionShareConfig.js (Embedded resource)
*/
function initializeSharePickerRuntime(n,t,q,r){SourceCode.Forms.Controls.PickerCollection.ShareConfig.initializeRuntime(n,t,q,r)}(function(n){(typeof SourceCode=="undefined"||SourceCode===null)&&(SourceCode={});(typeof SourceCode.Forms=="undefined"||SourceCode.Forms===null)&&(SourceCode.Forms={});(typeof SourceCode.Forms.Controls=="undefined"||SourceCode.Forms.Controls===null)&&(SourceCode.Forms.Controls={});(typeof SourceCode.Forms.Controls.PickerCollection=="undefined"||SourceCode.Forms.Controls.PickerCollection===null)&&(SourceCode.Forms.Controls.PickerCollection={});SourceCode.Forms.Controls.PickerCollection.ShareConfig={stringXML:null,callback:null,controlId:null,widget:null,serialNumber:null,localAddedUserCache:null,initializeRuntime:function(t,q,r,u){this.widget=t;this.serialNumber=q;this.worklistId=r;this.callback=u;this.controlId=t.element.prop("id");this.localAddedUserCache=[];var f=this;f.widget.options.isPickerOpen=!0;f.widget.options.SharedUsers="";popupManager.showPopup({id:"picker-collection-popup-root",buttons:[{id:"picker-collection-popup-help-button-share",type:"help",click:function(){HelpHelper.runHelp(5001)}},{text:ControlResources.SourceCode.Forms.Controls.Web.ControlPack.Properties.PickerCollection.OK,click:this.shareWorkList.bind(this)},{id:"picker-collection-share-cancel-button",text:ControlResources.SourceCode.Forms.Controls.Web.ControlPack.Properties.PickerCollection.Cancel,click:this.closeBtn.bind(this)}],headerText:ControlResources.SourceCode.Forms.Controls.Web.ControlPack.Properties.PickerCollection.Share,draggable:!0,content:jQuery("#picker-collection-share-container"),width:500,height:300,onClose:this.cancelOperation.bind(this)});var e=n("#picker-collection-popup-root");SourceCode.Forms.Browser.msie?e.addClass("ie"):SourceCode.Forms.Browser.mozilla&&(document.documentMode===11?e.addClass("ie"):e.addClass("moz"));e.find(":focus").trigger("blur");n("#picker-collection-share-add-button").off("click").on("click",function(){n(this).trigger("blur");initializeAddUserPickerRuntime(f,SourceCode.Forms.Controls.PickerCollection.ShareConfig.updateGridRow)});n("#picker-collection-share-remove-button").off("click").on("click",function(t){var q=n(this);if(q.hasClass("picker-collection-button-disabled"))return t.preventDefault(),!1;n("#picker-collection-share-operation-box-body .picker-collection-grid-row").filter(function(){return q.addClass("picker-collection-button-disabled"),n(this).hasClass("selected")?!0:!1}).remove()});if(n.ajax({url:applicationRoot+"Worklist.sdk",type:"POST",data:{call:"GetWorklist",serial:f.serialNumber},dataType:SourceCode.Forms.Browser.msie?"text":"xml",cache:!1,async:!0,beforeSend:function(t){n("#picker-collection-share-operation-box-body").showBusyModal(!0);SourceCode.Forms.XSRFHelper.setAntiXSRFHeader(t)},success:function(t){var e=f.parseXml(t),o=n(e).find("WorklistItem").filter(function(){return n(this).attr("SerialNumber")===f.serialNumber?!0:!1}),r=n(o).find("DelegatedUser");if(r.length!=0){for(var u="",q=0;q<r.length;q++)q!=0&&(u+=","),u+=n(r[q]).attr("Name");n.ajax({type:"POST",url:applicationRoot+"PickerCollectionDelegatedUserList.sdk",dataType:"JSON",async:!1,data:{delegates:u},cache:!1,success:function(t){n("#picker-collection-share-operation-box-body .picker-collection-grid-row").remove();f._populateGridRow(t,!1);f.trackOriginalUsers()},error:function(){popupManager.showWarning("PickerCollectionDelegatedUserList.sdk failed. Unable to connect to server")}})}},complete:function(){n("#picker-collection-share-operation-box-body").showBusyModal(!1)},error:function(){popupManager.showWarning("REST Call /K2Services/rest.svc/Worklist/Items failed. Unable to connect to server")}}),n("#picker-collection-share-remove-button").addClass("picker-collection-button-disabled"),SourceCode.Forms.Browser.msie&&SourceCode.Forms.Browser.version<=9){var o=n("#picker-collection-popup-root"),s=o[0].style.display;o[0].style.display="none";setTimeout(function(){o[0].style.display=s},0)}},parseXml:function(n){if(SourceCode.Forms.Browser.msie){var t=new ActiveXObject("Microsoft.XMLDOM");t.loadXML(n);n=t}return n},updateGridRow:function(n){SourceCode.Forms.Controls.PickerCollection.ShareConfig._populateGridRow(n,!0)},_populateGridRow:function(t,q){var f=n("#picker-collection-share-operation-box-body"),r=n("#picker-collection-share-operation-box-body .picker-collection-grid-row");n.each(t,function(t,u){for(var e=0;e<r.length;e++)if(u.FQN===n(r[e]).find(".picker-collection-grid-row-user-FQN").text())return!0;var o=q?"removable":"";f.append("<div class='picker-collection-grid-row "+o+"'> \t\t\t\t\t\t<div class='picker-collection-grid-row-user-image'><\/div> \t\t\t\t\t\t<div class='picker-collection-grid-row-user-display-name' title=\""+u.DisplayName.htmlEncode()+'">'+u.DisplayName.htmlEncode()+"<\/div> \t\t\t\t\t\t<div class='picker-collection-grid-row-user-email' title=\""+u.Email.htmlEncode()+'">'+u.Email.htmlEncode()+"<\/div> \t\t\t\t\t\t<div class='picker-collection-grid-row-user-id'>"+u.ObjectSID.htmlEncode()+"<\/div> \t\t\t\t\t\t<div class='picker-collection-grid-row-user-FQN'>"+u.FQN.htmlEncode()+"<\/div> \t\t\t\t\t<\/div>")});r=n("#picker-collection-share-operation-box-body .picker-collection-grid-row");for(var u=0;u<r.length;u++){var e=u%2==0?"even":"";n(r[u]).addClass(e)}n("#picker-collection-share-operation-box-body").find(".picker-collection-grid-row").off("click").on("click",function(){var r=n(this);r.toggleClass("selected");for(var t=n("#picker-collection-share-operation-box-body").find(".picker-collection-grid-row.selected"),q=0;q<t.length;q++)if(!n(t[q]).hasClass("removable")){n("#picker-collection-share-remove-button").addClass("picker-collection-button-disabled");return}t.length>0?n("#picker-collection-share-remove-button").removeClass("picker-collection-button-disabled"):n("#picker-collection-share-remove-button").addClass("picker-collection-button-disabled")})},trackOriginalUsers:function(){for(var r=n("#picker-collection-share-operation-box-body .picker-collection-grid-row"),q=0;q<r.length;q++){var t=n(r[q]),u=t.find(".picker-collection-grid-row-user-display-name").text(),f=t.find(".picker-collection-grid-row-user-email").text(),e=t.find(".picker-collection-grid-row-user-id").text(),o=t.find(".picker-collection-grid-row-user-FQN").text();this.localAddedUserCache.push({DisplayName:u,Email:f,ObjectSID:e,FQN:o})}},shareWorkList:function(){for(var f=n("#picker-collection-share-operation-box-body .picker-collection-grid-row-user-FQN"),q=!0,e=!1,r=[],t=0;t<f.length;t++){var o=n(f[t]).text();q=!0;for(var u=0;u<this.localAddedUserCache.length;u++)if(o===this.localAddedUserCache[u].FQN){q=!1;break}q&&(this.callback(this.serialNumber,o,this.widget),e=!0,this.widget.options.SharedUsers!==""&&(r=this.widget.options.SharedUsers.split(",")),r.push(n("#picker-collection-share-operation-box-body").find(".picker-collection-grid-row-user-email").eq(t).text()),this.widget.options.SharedUsers=r.join(","))}n("#picker-collection-share-container").remove();popupManager.closeLast({cancelOnClose:!0});this.widget.options.isPickerOpen=!1;e&&raiseEvent(this.controlId,"Control","Shared")},cancelOperation:function(){n("#picker-collection-share-container").remove();this.widget.options.isPickerOpen=!1},closeBtn:function(){n("#picker-collection-share-container").remove();popupManager.closeLast();this.widget.options.isPickerOpen=!1}}})(jQuery);
/*!
 SourceCode.Forms.Controls.Web.ControlPack.PickerCollection.Resources.JS.PickerCollectionSleepConfig.js (Embedded resource)
*/
function initializeSleepPickerRuntime(n,t,q,r){SourceCode.Forms.Controls.PickerCollection.SleepConfig.initializeRuntime(n,t,q,r)}(function(n){(typeof SourceCode=="undefined"||SourceCode===null)&&(SourceCode={});(typeof SourceCode.Forms=="undefined"||SourceCode.Forms===null)&&(SourceCode.Forms={});(typeof SourceCode.Forms.Controls=="undefined"||SourceCode.Forms.Controls===null)&&(SourceCode.Forms.Controls={});(typeof SourceCode.Forms.Controls.PickerCollection=="undefined"||SourceCode.Forms.Controls.PickerCollection===null)&&(SourceCode.Forms.Controls.PickerCollection={});var t;SourceCode.Forms.Controls.PickerCollection.SleepConfig={callback:null,controlId:null,widget:null,serialNumber:null,worklistId:null,initializeRuntime:function(q,r,u,f){this.widget=q;this.serialNumber=r;this.callback=f;this.controlId=q.element.prop("id");this.worklistId=u;var s=this;s.widget.options.isPickerOpen=!0;popupManager.showPopup({id:"picker-collection-popup-root",buttons:[{id:"picker-collection-popup-help-button-sleep",type:"help",click:function(){HelpHelper.runHelp(5001)}},{text:ControlResources.SourceCode.Forms.Controls.Web.ControlPack.Properties.PickerCollection.OK,click:this.sleepWorklist.bind(this)},{id:"picker-collection-popup-cancel-button",text:ControlResources.SourceCode.Forms.Controls.Web.ControlPack.Properties.PickerCollection.Cancel,click:this.closeBtn.bind(this)}],headerText:ControlResources.SourceCode.Forms.Controls.Web.ControlPack.Properties.PickerCollection.Sleep,draggable:!0,content:jQuery("#picker-collection-sleep-container"),width:440,height:250,onClose:this.cancelOperation.bind(this)});n("#picker-collection-popup-root").find(":focus").trigger("blur");var c=n("#picker-collection-popup-root");SourceCode.Forms.Browser.msie?c.addClass("ie"):SourceCode.Forms.Browser.mozilla?c.addClass("moz"):c.addClass("webkit");checkExists(t)||(t=new Calendar(!1));n(".input-control.lookup-box").lookupbox();var h=n("#"+s.controlId+"_TextBox");h.data("format","<Format>d<\/Format>");t.addCalendarUpdateObject(h,n("#"+s.controlId+"_Image"),{firstDayOfWeek:"7",minInterval:"1",secInterval:"1",timeFormat:"hh:mm:ss",type:"datePicker"});var v=t.getCurrentDate(h),p={formatXmlString:"<Format>YYYY/MM/dd<\/Format>",value:v};n("#picker-collection-sleep-operation-box input[type='radio']").radiobutton();n("#picker-collection-popup-root").on("change",".input-control.lookup-box",function(){t&&!h.data().isValidDate?(n(this).addClass("invalid"),popupManager.showWarning(ControlResources.SourceCode.Forms.Controls.Web.ControlPack.Properties.PickerCollection.InvalidDate)):n(this).removeClass("invalid")});n(".date.calender-control-button").on("calendarChanged",function(){n(".input-control.lookup-box").removeClass("invalid")});s._enableBasicOptions();var e=n(".picker-collection-sleep-operation-box-date-options-outer-container"),o=n(".picker-collection-sleep-operation-box-basic-options-outer-container");o.find("label.input-control.radio").eq(0).off("click").on("click",function(){s._enableBasicOptions()});e.find("label.input-control.radio").eq(0).off("click").on("click",function(){s._enableDateOptions()});if(navigator.userAgent.contains("Firefox")){var l=e.find(".overlay");l.length===0&&(l=n('<div class="overlay"> <\/div>'),l.appendTo(e.find("div.input-control-body.styling-left")))}e.find("div.input-control-body.styling-left").eq(0).off("click").on("click",function(){o.find("> label.input-control.radio").removeClass("checked");e.find("span.input-control-img").eq(0).removeClass("hovered");e.find("label.input-control.radio").addClass("checked");s._enableDateOptions();e.find("input:text").trigger("focus")});o.find("div.picker-collection-sleep-operation-box-basic-options-container").eq(0).off("mouseenter").on("mouseenter",function(){o.find("label.input-control.radio").eq(0).hasClass("checked")||o.find("span.input-control-img").eq(0).addClass("hovered")});o.find("div.picker-collection-sleep-operation-box-basic-options-container").eq(0).off("mouseleave").on("mouseleave",function(){o.find("span.input-control-img").eq(0).removeClass("hovered")});o.find("label.radio").off("click").on("click",function(){e.find("label.input-control.radio").removeClass("checked");o.find("span.input-control-img").eq(0).removeClass("hovered");o.find("label.input-control.radio").eq(0).addClass("checked");s._enableBasicOptions()});e.find("div.input-control-body.styling-left").eq(0).off("mouseenter").on("mouseenter",function(){e.find("label.input-control.radio").eq(0).hasClass("checked")||e.find("span.input-control-img").eq(0).addClass("hovered")});e.find("div.input-control-body.styling-left").eq(0).off("mouseleave").on("mouseleave",function(){e.find("span.input-control-img").eq(0).removeClass("hovered")});if(o.find("span").eq(0).trigger("focus"),SourceCode.Forms.Browser.msie&&SourceCode.Forms.Browser.version<=9){var a=n("#picker-collection-popup-root"),y=a[0].style.display;a[0].style.display="none";setTimeout(function(){a[0].style.display=y},0)}},_enableBasicOptions:function(){n(".picker-collection-sleep-operation-box-basic-options-container").find("ul li label").removeClass("disabled");n(".picker-collection-sleep-operation-box-basic-options-container").find("ul li label input").prop("disabled",!1);var t=n("#"+this.controlId+"_TextBox"),q=n("#"+this.controlId+"_Image"),r=t.parents();r.closest(".input-control.select-box.lookup-box").lookupbox({}).lookupbox("disable");r.closest(".form-field").addClass("disabled");q.attr("tabindex",-1);t.attr("tabindex",-1);q.prop("disabled",!0);t.prop("disabled",!0);n("#"+this.controlId+"_Image").off("click")},_enableDateOptions:function(){var f={firstDayOfWeek:"7",minInterval:"1",secInterval:"1",timeFormat:"hh:mm:ss",type:"datePicker"};n(".picker-collection-sleep-operation-box-basic-options-container").find("ul li label").addClass("disabled");n(".picker-collection-sleep-operation-box-basic-options-container").find("ul li label input").prop("disabled",!0);var q=n("#"+this.controlId+"_TextBox"),r=n("#"+this.controlId+"_Image"),u=q.parents();u.closest(".form-field").removeClass("disabled");u.closest(".input-control.select-box.lookup-box").lookupbox({}).lookupbox("enable");var f={firstDayOfWeek:"7",minInterval:"1",secInterval:"1",timeFormat:"hh:mm:ss",type:"datePicker"};q.attr("tabindex",0);r.attr("tabindex",0);q.prop("disabled",!1);r.prop("disabled",!1);q.data("format","<Format Type='Date'>d<\/Format>");t.addCalendarUpdateObject(q,r,f)},isPastDate:function(n){DateNow=new Date;DateNow.setHours(0,0,0,0);var t=Date.parse(n);return(t.setHours(0,0,0,0),t<DateNow)?!0:!1},sleepWorklist:function(){var e=this.computeDurationFromUserInput(),r=!1;if(n(".picker-collection-sleep-operation-box-date-options-outer-container").find("label.input-control.radio").eq(0).hasClass("checked")){var u=t.getCurrentDate("#{0}_TextBox".format(this.controlId));if(!checkExists(u)){n(".input-control.lookup-box").addClass("invalid");popupManager.showWarning(ControlResources.SourceCode.Forms.Controls.Web.ControlPack.Properties.PickerCollection.InvalidDate);return}var f=SCCultureHelper.Current()._convertUTCDateToObj(u);if(f===null){n(".input-control.lookup-box").addClass("invalid");popupManager.showWarning(ControlResources.SourceCode.Forms.Controls.Web.ControlPack.Properties.PickerCollection.InvalidDate);return}r=this.isPastDate(f)?!0:!1}if(r){n(".input-control.lookup-box").addClass("invalid");popupManager.showWarning(ControlResources.SourceCode.Forms.Controls.Web.ControlPack.Properties.PickerCollection.InvalidDate);return}for(var q=0;q<this.serialNumber.length;q++)this.callback(this.serialNumber[q],e,this.widget);this.widget.options.isPickerOpen=!1;t.calendarPopup=null;n("#picker-collection-sleep-container").remove();popupManager.closeLast({cancelOnClose:!0})},computeDurationFromUserInput:function(){var r=this;if(n(".picker-collection-sleep-operation-box-basic-options-outer-container").find("label").eq(0).hasClass("checked")){var o=n(".picker-collection-sleep-operation-box-basic-options-container").find("ul li label").filter(function(){return n(this).hasClass("checked")?!0:!1}).find("input").eq(0).val(),q=new Date;switch(o){case"breakfast":q.setDate(q.getDate()+1);q.setHours(8);q.setMinutes(0);q.setSeconds(0);var u=r._computeTimezoneOffset(q);return u;case"lunch":q.setDate(q.getDate()+1);q.setHours(13);q.setMinutes(0);q.setSeconds(0);var u=r._computeTimezoneOffset(q);return u;case"week":q.setDate(q.getDate()+7);var u=r._computeTimezoneOffset(q);return u}}else{var f=t.getCurrentDate("#{0}_TextBox".format(r.controlId));if(!checkExists(f))return null;var e=SCCultureHelper.Current()._convertUTCDateToObj(f);if(e===null)return null;var u=r._computeTimezoneOffset(e);return u}},_computeTimezoneOffset:function(n){var t=n.getTimezoneOffset(),q=Math.abs(Math.floor(t/60)),r=Math.abs(t%60),u=n.format("yyyy-MM-ddThh:mm:ss");return u+(t>0?"-":"+")+(q<10?"0":"")+q+":"+(r<10?"0":"")+r},_isDST:function(){var n=new Date,t=new Date(n.getFullYear(),0,1),q=new Date(n.getFullYear(),6,1);return n.getTimezoneOffset()<Math.max(t.getTimezoneOffset(),q.getTimezoneOffset())},cancelOperation:function(){popupManager.closeLast();t.calendarPopup=null;n("#picker-collection-sleep-container").remove();this.widget.options.isPickerOpen=!1},closeBtn:function(){t.calendarPopup=null;popupManager.closeLast();try{popupManager.closeLast()}catch(n){}this.widget.options.isPickerOpen=!1}}})(jQuery);
/*!
 SourceCode.Forms.Controls.Web.ControlPack.PickerCollection.Resources.JS.PickerCollectionOOFConfig.js (Embedded resource)
*/
function initializeOOF(n,t){SourceCode.Forms.Controls.PickerCollection.OOFConfig.initializeRuntime(n,t)}(function(n){(typeof SourceCode=="undefined"||SourceCode===null)&&(SourceCode={});(typeof SourceCode.Forms=="undefined"||SourceCode.Forms===null)&&(SourceCode.Forms={});(typeof SourceCode.Forms.Controls=="undefined"||SourceCode.Forms.Controls===null)&&(SourceCode.Forms.Controls={});(typeof SourceCode.Forms.Controls.PickerCollection=="undefined"||SourceCode.Forms.Controls.PickerCollection===null)&&(SourceCode.Forms.Controls.PickerCollection={});SourceCode.Forms.Controls.PickerCollection.OOFConfig=OOF={name:"OOF",Resx:null,ID:"",widget:null,callback:null,users:[],exceptions:[],EXCEPTION_PICKER_MODE:{ADD:1,EDIT:2},initializeRuntime:function(t,q){var r=this;this.widget=t;this.ID=t.element.attr("id");this.callback=q;this.Resx=ControlResources.SourceCode.Forms.Controls.Web.ControlPack.Properties.PickerCollection;var a=800;n(window).width()<a&&(a=n(window).width()*.8);popupManager.showPopup({id:"OOFConfig",buttons:[{id:"pickerCollectionOOFHelp",type:"help",click:function(){HelpHelper.runHelp(5010)}},{id:"pickerCollectionOOFOK",text:r.Resx.OK,click:this.applyOOF.bind(this,!1)},{id:"pickerCollectionOOFCancel",text:r.Resx.Cancel,click:this.closePopup.bind(this)}],headerText:r.Resx.oofPickerHeader,draggable:!0,content:n("#OOFGrid"),width:a,height:400,onClose:this.closePopup.bind(this)});var f=n("#oof-options");f.addClass("disabled");f.find(".OOFDelegatedUserLookupContainer").children().prop("tabindex","-1");var u=n("#OOFConfig"),v=u.find(".OOFDelegatedUserLookup"),y=v.find(".input-control-body"),e=y.add(u.find(".search")).add(u.find(".pickerCollectionOOFDelegatedUserRemoveAll")).add(u.find(".toolbar").find("a"));e.attr("tabindex",-1);n("#btnAddExceps").attr("tabindex",0);var h=n("#OOFExceptionGrid"),c=n("#OOFConfig");SourceCode.Forms.Browser.mozilla&&c.addClass("moz");SourceCode.Forms.Browser.msie&&(c.addClass("ie"),document.documentMode===9&&c.addClass("ie9"),document.documentMode===10&&c.addClass("ie10"));var o=u.find(".OOFStatusInOfficeWrapper").find("label"),s=u.find(".OOFStatusOutOfOfficeWrapper").find("label");o.off("click").on("click",function(){r.toggleOOFOptions(!0,s,o,f,e)}).on("keydown",function(n){n.keyCode===32&&r.toggleOOFOptions(!0,s,o,f,e)});s.off("click").on("click",function(){r.toggleOOFOptions(!1,o,s,f,e)}).on("keydown",function(n){n.keyCode===32&&r.toggleOOFOptions(!1,o,s,f,e)});var p=n("#OOFGrid").find("input:radio");p.on("focus",function(){n(this).parent().addClass("focus")}).on("blur",function(){n(this).parent().removeClass("focus")});var l=u.find(".editableUserLookupTextbox");l.attr("spellcheck",!1);l.empty();l.on("mouseover.picker",r.onMouseOver.bind(this,l));h.grid();h.grid("clear");n.ajax({url:applicationRoot+"OOFLoad.sdk",type:"POST",data:{},dataType:"json",async:"true",beforeSend:function(n){r.showAjaxLoader(u);SourceCode.Forms.XSRFHelper.setAntiXSRFHeader(n)},success:function(n){r.applyDataToFields(n)},error:function(){},complete:function(){SourceCode.Forms.Controls.Worklist.bindUserPickerEvents(r,u);r.removeAjaxLoader(u)}});var w=h.find(".grid-content-table"),b=w.find("tr");n("#btnAddExceps").off("click").on("click",function(){initializeOOFExceptionPicker(r.widget,r.ID,OOF.setException,null,r.EXCEPTION_PICKER_MODE.ADD)}).on("focus",function(){h.find(".selected").length===0&&n("#btnEditExceps, #btnRemoveExceps").attr("tabindex",-1)});n("#btnEditExceps").off("click").on("click",function(){r.editException()});n("#btnRemoveExceps").off("click").on("click",function(){r.removeException()}).on("focus",function(){n(this).hasClass("disabled")&&n("#btnAddExceps").trigger("focus")})},toggleOOFOptions:function(t,q,r,u,f){if(checkExists(q)===!1){var e=n("#OOFConfig"),o=e.find(".OOFStatusInOfficeWrapper").find("label"),s=e.find(".OOFStatusOutOfOfficeWrapper").find("label");t?(q=s,r=o):(q=o,r=s);var u=n("#oof-options"),f=e.find(".OOFDelegatedUserLookup").find(".input-control-body").add(e.find(".search")).add(e.find(".pickerCollectionOOFDelegatedUserRemoveAll")).add(e.find(".toolbar").find("a"))}q.removeClass("checked");r.addClass("checked").trigger("focus");f=f.add(n("#OOFExceptionGrid").find("td.first").parent());t?(u.addClass("disabled"),u.find(".OOFDelegatedUserLookupContainer").children().prop("tabindex",-1)):(u.removeClass("disabled"),u.find(".OOFDelegatedUserLookupContainer").children().prop("tabindex",0))},onMouseOver:function(t){if(t.hasClass("invalid")){var q=n("#OOF_Tooltip");UtilitiesHelper.setToolTipPosition(q,t);q.show()}},editException:function(){var t=this,u=n("#OOFExceptionGrid").find(".grid-content-table");if(!(u.find(".empty-grid").length>0)){var f=u.find("tr.selected");if(f.length>0)for(var e=f.find("td.first").find(".grid-content-cell-wrapper").text(),q=0;q<t.exceptions.length;q++){var r=t.exceptions[q];if(r.name===e){r.tmpId="".generateGuid();initializeOOFExceptionPicker(t.widget,t.ID,OOF.setException,r,t.EXCEPTION_PICKER_MODE.EDIT);break}}}},removeException:function(){var r=this,c=n("#OOFExceptionGrid"),o=c.find(".grid-content-table");if(!(o.find(".empty-grid").length>0)){var s=o.find("tr.selected"),u=s.next("tr");u.length||(u=s.prev("tr"));var l;if(u.length&&(l=u.find("td.first").find(".grid-content-cell-wrapper").html()),s.length>0){for(var y=s.find("td.first").find(".grid-content-cell-wrapper").text(),t=0;t<r.exceptions.length;t++)r.exceptions[t].name===y&&(typeof r.exceptions[t].id=="undefined"?r.exceptions.splice(t,1):r.exceptions[t].deleted=!0);c.grid("clear");for(var t=0;t<r.exceptions.length;t++){var q=r.exceptions[t];if(q.deleted===!1){for(var p=q.activity.name.split("\\"),a=p.pop(),v=q.activity.text,f="",e="",h=0;h<q.users.length;h++)f+=q.users[h].friendlyName+"; ",e+=q.users[h].name+"; ";f=f.substring(0,f.trim().length-1);e=e.substring(0,e.trim().length-1);c.grid("add","row",[{display:q.name,title:q.name},{display:a,title:a},{display:v,title:v},{display:f,title:e}])}}OOF.bindEventsToExceptionRows(o);u.length?(u="div[title='"+l+"']",o.find(u).parents("tr").trigger("focus")):(n("#btnEditExceps, #btnRemoveExceps").addClass("disabled").attr("tabindex",-1),n("#btnAddExceps").trigger("focus"))}}},applyDataToFields:function(t){this.toggleOOFOptions(this.widget.options.OOFSettings.Status);var u="";this.users=[];var c=n("#OOFGrid").find(".editableUserLookupTextbox");if(c.empty(),t!==null){for(var f=checkExists(localStorage.oofNames)?JSON.parse(localStorage.oofNames):{},r=0;r<t.delegatedUsers.length;r++){var q=t.delegatedUsers[r].Name;checkExists(f[q])||(f[q]=this.getDisplayName(q));var e=f[q];u+=c.children().length===0&&r===0?"<span class='spacer'>&nbsp;<\/span><span class='OOFUserLookupUsername entity' contenteditable='false' data-name='{0}' data-friendly='{1}' title='{0}'><span class='resolved'>{1}<\/span>;<\/span><span class='spacer'>&nbsp;<\/span>".format(q.htmlEncode(),e.htmlEncode()):"<span class='OOFUserLookupUsername entity' contenteditable='false' data-name='{0}' data-friendly='{1}' title='{0}'><span class='resolved'>{1}<\/span>;<\/span><span class='spacer'>&nbsp;<\/span>".format(q.htmlEncode(),e.htmlEncode());this.users.push({id:t.delegatedUsers[r].ID,name:q,destinationType:"User",deleted:!1,friendlyName:e})}c.append(u);var p=n("#OOFExceptionGrid"),w=!1;this.exceptions=[];for(var r=0;r<t.exceptions.length;r++){w=!0;for(var l=t.exceptions[r].Name,k=t.exceptions[r].ID,o=t.exceptions[r].WorklistCriteria.Filters,a=o[0].Value,d=o[1].Value,v=checkExists(o[2])?o[2].Value:o[1].Value,u="",s="",y=t.exceptions[r].Destinations,b=[],h=0;h<y.length;h++){var q=y[h].Name;checkExists(f[q])||(f[q]=this.getDisplayName(q));var e=f[q];s+=q.htmlEncode()+"; ";u+=e.htmlEncode()+"; ";b.push({id:y[h].ID,name:q,destinationType:"User",deleted:!1,friendlyName:e})}u=u.substring(0,u.trim().length-1);s=s.substring(0,s.trim().length-1);p.grid("add","row",[{display:l,title:l.name},{display:a,title:a},{display:v,title:v},{display:u,title:s}]);var g=a+"\\"+d,nt={icon:"process-activity",ItemType:"Activity",name:g,text:v};this.exceptions.push({name:l,id:k,activity:nt,users:b,deleted:!1})}w&&OOF.bindEventsToExceptionRows(p.find(".grid-content-table"));localStorage.oofNames=JSON.stringify(f)}},getDisplayName:function(t){var q;return n.ajax({url:applicationRoot+"OOFLoad.sdk",type:"POST",data:{method:"GetDisplayNameByFQN",FQN:t},dataType:"text",async:!1,success:function(n){q=n},error:function(){}}),q.trim()===""&&(q=t),q},setException:function(n){if(typeof n.id=="undefined"&&typeof n.tmpId=="undefined"){OOF.exceptions.push({name:n.name,activity:n.activity,users:n.users,deleted:!1});for(var q=checkExists(localStorage.oofNames)?JSON.parse(localStorage.oofNames):{},t=0;t<n.users.length;t++)checkExists(q[n.users[t].name])||(q[n.users[t].name]=n.users[t].friendlyName);localStorage.oofNames=JSON.stringify(q)}else if(typeof n.id=="undefined")for(var t=0;t<OOF.exceptions.length;t++)OOF.exceptions[t].tmpId===n.tmpId&&(OOF.exceptions[t].name=n.name,OOF.exceptions[t].activity=n.activity,OOF.exceptions[t].users=n.users,OOF.exceptions[t].deleted=n.deleted);else for(var t=0;t<OOF.exceptions.length;t++)OOF.exceptions[t].id===n.id&&(OOF.exceptions[t].name=n.name,OOF.exceptions[t].activity=n.activity,OOF.exceptions[t].users=n.users,OOF.exceptions[t].deleted=n.deleted);OOF.updateExceptionGrid()},updateExceptionGrid:function(){var q=n("#OOFExceptionGrid"),s=q.find("tr.selected");if(s.length)var v=q.find("tr"),h=v.index(s[0]);q.grid("clear");for(var t=0;t<this.exceptions.length;t++)if(!this.exceptions[t].deleted){var c=this.exceptions[t].name,y=this.exceptions[t].activity.name,o=[];n.each(y.split("\\"),function(){o.push(this.trim())});for(var l=o[0]+"\\"+o[1],a=this.exceptions[t].activity.text,r="",u="",e=this.exceptions[t].users,f=0;f<e.length;f++)e[f].deleted===!1&&(r+=e[f].friendlyName.htmlEncode()+"; ",u=e[f].name.htmlEncode()+"; ");r=r.substring(0,r.trim().length-1);u=u.substring(0,u.trim().length-1);q.grid("add","row",[{display:c,title:c.name},{display:l,title:l},{display:a,title:a},{display:r,title:u}])}OOF.bindEventsToExceptionRows(q.find(".grid-content-table"));typeof h!="undefined"&&q.find("tr").eq(h).trigger("click").trigger("focus")},bindEventsToExceptionRows:function(t){var r=this;t.off("keydown").on("keydown",function(t){n.inArray(t.keyCode,[13,46,32,38,40])>-1&&t.preventDefault()});var u=n("#btnEditExceps, #btnRemoveExceps");if(t.find(".empty-grid").length>0){u.addClass("disabled").attr("tabindex",-1);return}var q=t.find("td.first").parent();n("#oof-options").hasClass("disabled")?q.attr("tabindex",-1):q.attr("tabindex",0);q.off("click").on("click",function(){u.removeClass("disabled").attr("tabindex",0);q.removeClass("selected").removeClass("highlighted");n(this).addClass("selected").addClass("highlighted")});q.off("focus").on("focus",function(){q.removeClass("highlighted");n(this).addClass("highlighted")});q.off("keydown").on("keydown",function(t){switch(t.keyCode){case 38:var q=n(this).prev();q.length&&q.trigger("focus");break;case 40:var u=n(this).next();u.length&&u.trigger("focus");break;case 32:n(this).trigger("click");break;case 13:n(this).trigger("click");r.editException();break;case 46:n(this).trigger("click");r.removeException()}n.inArray(t.keyCode,[13,46,32,38,40])>-1&&t.preventDefault()})},validate:function(){var e=this,q=n("#OOFConfig"),u=q.find(".editableUserLookupTextbox"),f=q.find(".OOFStatusOutOfOfficeWrapper").find("label");if(f.hasClass("checked")){if(this.users.length===0)return popupManager.showWarning(ControlResources.SourceCode.Forms.Controls.Web.ControlPack.Properties.PickerCollection.OOFPickerNoDestination),!1;if(u.find(".unresolved").length>0)return popupManager.showWarning(ControlResources.SourceCode.Forms.Controls.Web.ControlPack.Properties.PickerCollection.OOFPickerUnresolved),!1;for(var r=!0,t=0;t<this.users.length;t++)if(this.users[t].deleted===!1){if(this.users[t].name===SourceCode.Forms.Settings.User.FQN)return popupManager.showWarning(ControlResources.SourceCode.Forms.Controls.Web.ControlPack.Properties.PickerCollection.OOFPickerLoggedInUserAsDestination),!1;r=!1}if(r)return popupManager.showWarning(ControlResources.SourceCode.Forms.Controls.Web.ControlPack.Properties.PickerCollection.OOFPickerNoDestination),!1}},applyOOF:function(){var r=this,e=n("#OOFConfig");if(this.validate()!==!1){var o=!0,h=e.find(".OOFStatusOutOfOfficeWrapper").find("label");h.hasClass("checked")&&(o=!1);var s=[];s.push({name:"empty",type:"normal",destinations:this.users,deleted:!1});for(var f={},t=0;t<this.users.length;t++)f[this.users[t].name]=this.users[t].friendlyName;var q={};q.OOFSettings={};q.OOFSettings.status=o;q.OOFSettings.startDate="NULL";q.OOFSettings.endDate="NULL";q.OOFSettings.workType=s;q.OOFException=[];for(var t=0;t<this.exceptions.length;t++){q.OOFException.push({id:this.exceptions[t].id,name:this.exceptions[t].name,workflow:this.exceptions[t].activity,users:this.exceptions[t].users,deleted:this.exceptions[t].deleted});for(var u=0;u<this.exceptions[t].users.length;u++)checkExists(f[this.exceptions[t].users[u].name])||(f[this.exceptions[t].users[u].name]=this.exceptions[t].users[u].friendlyName)}localStorage.oofNames=JSON.stringify(f);var c=JSON.stringify(q);n.ajax({url:applicationRoot+"OOF.sdk",type:"POST",data:c,dataType:"json",async:"true",beforeSend:function(n){r.showAjaxLoader(e);SourceCode.Forms.XSRFHelper.setAntiXSRFHeader(n)},success:function(){r.users=[]},error:function(){},complete:function(){r.closePopup();r.widget.GetOOFStatus();r.removeAjaxLoader(e)}})}},showAjaxLoader:function(n){n.append("<div class='ajaxLoader'><\/div>");n.find(".ajaxLoader").css({height:n.height()+"px",width:n.width()+"px",position:"absolute"})},removeAjaxLoader:function(n){n.find(".ajaxLoader").remove()},closePopup:function(){n("#OOFGrid").remove();n("#OOF_Tooltip").remove();popupManager.closeLast({cancelOnClose:!0});OOF.exceptions=[]}}})(jQuery);
