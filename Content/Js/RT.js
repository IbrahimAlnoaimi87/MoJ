/*!
 ~/Script/javascript-xpath.js
*/
/*!  JavaScript-XPath 0.1.12
* Copyright (c) 2007 Cybozu Labs, Inc.
* 
* Permission is hereby granted, free of charge, to any person obtaining a copy
* of this software and associated documentation files (the "Software"), to deal
* in the Software without restriction, including without limitation the rights
* to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
* copies of the Software, and to permit persons to whom the Software is
* furnished to do so, subject to the following conditions:
*
* THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
* IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
* FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
* AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
* LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
* OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
* SOFTWARE.
*
*  JavaScript-XPath is freely distributable under the terms of an MIT-style license.
*  For details, see the JavaScript-XPath web site: http://coderepos.org/share/wiki/JavaScript-XPath
*
--------------------------------------------------------------------------*/
(function(){var undefined=void 0,defaultConfig={targetFrame:undefined,exportInstaller:!1,useNative:!0,useInnerText:!0},config;if(window.jsxpath)config=window.jsxpath;else{var scriptElms=document.getElementsByTagName("script"),scriptElm=scriptElms[scriptElms.length-1],scriptSrc=scriptElm.src;config={};var scriptSrcMatchResult=scriptSrc.match(/\?(.*)$/);if(scriptSrcMatchResult)for(var configStrings=scriptSrcMatchResult[1].split("&"),i=0,l=configStrings.length;i<l;i++){var configString=configStrings[i],configStringSplited=configString.split("="),configName=configStringSplited[0],configValue=configStringSplited[1];configValue==undefined?configValue==!0:(configValue=="false"||/^-?\d+$/.test(configValue))&&(configValue=eval(configValue));config[configName]=configValue}}for(var n in defaultConfig)n in config||(config[n]=defaultConfig[n]);if(config.hasNative=!!(document.implementation&&document.implementation.hasFeature&&document.implementation.hasFeature("XPath",null)),!config.hasNative||!config.useNative||config.exportInstaller){var BinaryExpr,FilterExpr,FunctionCall,Literal,NameTest,NodeSet,NodeType,NodeUtil,Number,PathExpr,Step,UnaryExpr,UnionExpr,VariableReference,uai=new function(){var n=navigator.userAgent;if(RegExp==undefined)n.indexOf("Opera")>=0?this.opera=!0:n.indexOf("Netscape")>=0?this.netscape=!0:n.indexOf("Mozilla/")==0?this.mozilla=!0:this.unknown=!0,n.indexOf("Gecko/")>=0&&(this.gecko=!0),n.indexOf("Win")>=0?this.windows=!0:n.indexOf("Mac")>=0?this.mac=!0:n.indexOf("Linux")>=0?this.linux=!0:n.indexOf("BSD")>=0?this.bsd=!0:n.indexOf("SunOS")>=0&&(this.sunos=!0);else{/*@cc_on@if(@_jscript)function t(){switch(@_jscript_version){case 3:return"4.0";case 5:return"5.0";case 5.1:return"5.01";case 5.5:return"5.5";case 5.6:return"XMLHttpRequest"in window?"7.0":"6.0";case 5.7:return"7.0";default:return!0}}@_win16||@_win32||@_win64?(this.windows=!0,this.trident=t()):(@_mac||navigator.platform.indexOf("Mac")>=0)&&(this.mac=!0,this.tasman=t());/MSIE (\d+\.\d+)b?;/.test(n)&&(this.ie=RegExp.$1,this["ie"+RegExp.$1.charAt(0)]=!0);@else@*//AppleWebKit\/(\d+(?:\.\d+)*)/.test(n)?(this.applewebkit=RegExp.$1,RegExp.$1.charAt(0)==4?this.applewebkit2=!0:this.applewebkit3=!0):typeof Components=="object"&&(/Gecko\/(\d{8})/.test(n)||navigator.product=="Gecko"&&/^(\d{8})$/.test(navigator.productSub))&&(this.gecko=RegExp.$1);/*@end@*/if(typeof opera=="object"&&typeof opera.version=="function"?(this.opera=opera.version(),this["opera"+this.opera[0]+this.opera[2]]=!0):typeof opera=="object"&&/Opera[\/ ](\d+\.\d+)/.test(n)?this.opera=RegExp.$1:this.ie||(/Safari\/(\d+(?:\.\d+)*)/.test(n)?this.safari=RegExp.$1:/NetFront\/(\d+(?:\.\d+)*)/.test(n)?this.netfront=RegExp.$1:/Konqueror\/(\d+(?:\.\d+)*)/.test(n)?this.konqueror=RegExp.$1:n.indexOf("(compatible;")<0&&/^Mozilla\/(\d+\.\d+)/.test(n)?(this.mozilla=RegExp.$1,/\([^(]*rv:(\d+(?:\.\d+)*).*?\)/.test(n)&&(this.mozillarv=RegExp.$1),/Firefox\/(\d+(?:\.\d+)*)/.test(n)?this.firefox=RegExp.$1:/Netscape\d?\/(\d+(?:\.\d+)*)/.test(n)&&(this.netscape=RegExp.$1)):this.unknown=!0),n.indexOf("Win 9x 4.90")>=0)this.windows="ME";else if(/Win(?:dows)? ?(NT ?(\d+\.\d+)?|\d+|ME|Vista|XP)/.test(n))if(this.windows=RegExp.$1,RegExp.$2)this.winnt=RegExp.$2;else switch(RegExp.$1){case"2000":this.winnt="5.0";break;case"XP":this.winnt="5.1";break;case"Vista":this.winnt="6.0"}else n.indexOf("Mac")>=0?this.mac=!0:n.indexOf("Linux")>=0?this.linux=!0:/(\w*BSD)/.test(n)?this.bsd=RegExp.$1:n.indexOf("SunOS")>=0&&(this.sunos=!0)}},Lexer=function(n){for(var q=Lexer.prototype,t=n.match(q.regs.token),r=0,f=t.length;r<f;r++)q.regs.strip.test(t[r])&&t.splice(r,1);for(var u in q)t[u]=q[u];return t.index=0,t};Lexer.prototype.regs={token:/\$?(?:(?![0-9-])[\w-]+:)?(?![0-9-])[\w-]+|\/\/|\.\.|::|\d+(?:\.\d*)?|\.\d+|"[^"]*"|'[^']*'|[!<>]=|(?![0-9-])[\w-]+:\*|\s+|./g,strip:/^\s/};Lexer.prototype.peek=function(n){return this[this.index+(n||0)]};Lexer.prototype.next=function(){return this[this.index++]};Lexer.prototype.back=function(){this.index--};Lexer.prototype.empty=function(){return this.length<=this.index};var Ctx=function(n,t,q){this.node=n;this.position=t||1;this.last=q||1},BaseExpr=function(){};BaseExpr.prototype.number=function(n){var t=this.evaluate(n);return t.isNodeSet?t.number():+t};BaseExpr.prototype.string=function(n){var t=this.evaluate(n);return t.isNodeSet?t.string():""+t};BaseExpr.prototype.bool=function(n){var t=this.evaluate(n);return t.isNodeSet?t.bool():!!t};var BaseExprHasPredicates=function(){};BaseExprHasPredicates.parsePredicates=function(n,t){while(n.peek()=="["){if(n.next(),n.empty())throw Error("missing predicate expr");var q=BinaryExpr.parse(n);if(t.predicate(q),n.empty())throw Error("unclosed predicate expr");if(n.next()!="]"){n.back();throw Error("bad token: "+n.next());}}};BaseExprHasPredicates.prototype=new BaseExpr;BaseExprHasPredicates.prototype.evaluatePredicates=function(n,t){var u,s,h,n,f,c;c=this.reverse;u=this.predicates;n.sort();for(var e=t||0,l=u.length;e<l;e++){s=u[e];for(var o=[],h=n.list(),q=0,r=h.length;q<r;q++){f=c?r-q:q+1;exrs=s.evaluate(new Ctx(h[q],f,r));switch(typeof exrs){case"number":exrs=f==exrs;break;case"string":exrs=!!exrs;break;case"object":exrs=exrs.bool()}exrs||o.push(q)}for(var q=o.length-1,r=0;q>=r;q--)n.del(o[q])}return n};!window.BinaryExpr&&window.defaultConfig&&(window.BinaryExpr=null);BinaryExpr=function(n,t,q){this.op=n;this.left=t;this.right=q;this.datatype=BinaryExpr.ops[n][2];this.needContextPosition=t.needContextPosition||q.needContextPosition;this.needContextNode=t.needContextNode||q.needContextNode;this.op=="="&&(q.needContextNode||q.needContextPosition||q.datatype=="nodeset"||q.datatype=="void"||!t.quickAttr?t.needContextNode||t.needContextPosition||t.datatype=="nodeset"||t.datatype=="void"||!q.quickAttr||(this.quickAttr=!0,this.attrName=q.attrName,this.attrValueExpr=t):(this.quickAttr=!0,this.attrName=t.attrName,this.attrValueExpr=q))};BinaryExpr.compare=function(n,t,q,r,u){var a,o,s,h,c,e;if(q=q.evaluate(u),r=r.evaluate(u),q.isNodeSet&&r.isNodeSet){o=q.list();s=r.list();for(var f=0,v=o.length;f<v;f++)for(var l=0,y=s.length;l<y;l++)if(t(NodeUtil.to("string",o[f]),NodeUtil.to("string",s[l])))return!0;return!1}if(q.isNodeSet||r.isNodeSet){q.isNodeSet?(c=q,e=r):(c=r,e=q);h=c.list();a=typeof e;for(var f=0,p=h.length;f<p;f++)if(t(NodeUtil.to(a,h[f]),e))return!0;return!1}return n=="="||n=="!="?typeof q=="boolean"||typeof r=="boolean"?t(!!q,!!r):typeof q=="number"||typeof r=="number"?t(+q,+r):t(q,r):t(+q,+r)};BinaryExpr.ops={div:[6,function(n,t,q){return n.number(q)/t.number(q)},"number"],mod:[6,function(n,t,q){return n.number(q)%t.number(q)},"number"],"*":[6,function(n,t,q){return n.number(q)*t.number(q)},"number"],"+":[5,function(n,t,q){return n.number(q)+t.number(q)},"number"],"-":[5,function(n,t,q){return n.number(q)-t.number(q)},"number"],"<":[4,function(n,t,q){return BinaryExpr.compare("<",function(n,t){return n<t},n,t,q)},"boolean"],">":[4,function(n,t,q){return BinaryExpr.compare(">",function(n,t){return n>t},n,t,q)},"boolean"],"<=":[4,function(n,t,q){return BinaryExpr.compare("<=",function(n,t){return n<=t},n,t,q)},"boolean"],">=":[4,function(n,t,q){return BinaryExpr.compare(">=",function(n,t){return n>=t},n,t,q)},"boolean"],"=":[3,function(n,t,q){return BinaryExpr.compare("=",function(n,t){return n==t},n,t,q)},"boolean"],"!=":[3,function(n,t,q){return BinaryExpr.compare("!=",function(n,t){return n!=t},n,t,q)},"boolean"],and:[2,function(n,t,q){return n.bool(q)&&t.bool(q)},"boolean"],or:[1,function(n,t,q){return n.bool(q)||t.bool(q)},"boolean"]};BinaryExpr.parse=function(n){for(var r,u,f,q,t=[],e=n.index;;){if(n.empty())throw Error("missing right expression");if(q=UnaryExpr.parse(n),r=n.next(),!r)break;if(f=this.ops[r],u=f&&f[0],!u){n.back();break}while(t.length&&u<=this.ops[t[t.length-1]][0])q=new BinaryExpr(t.pop(),t.pop(),q);t.push(q,r)}while(t.length)q=new BinaryExpr(t.pop(),t.pop(),q);return q};BinaryExpr.prototype=new BaseExpr;BinaryExpr.prototype.evaluate=function(n){return BinaryExpr.ops[this.op][1](this.left,this.right,n)};BinaryExpr.prototype.show=function(n){n=n||"";var t="";return t+=n+"binary: "+this.op+"\n",n+="    ",t+=this.left.show(n),t+this.right.show(n)};!window.UnaryExpr&&window.defaultConfig&&(window.UnaryExpr=null);UnaryExpr=function(n,t){this.op=n;this.expr=t;this.needContextPosition=t.needContextPosition;this.needContextNode=t.needContextNode};UnaryExpr.ops={"-":1};UnaryExpr.parse=function(n){return this.ops[n.peek()]?new UnaryExpr(n.next(),UnaryExpr.parse(n)):UnionExpr.parse(n)};UnaryExpr.prototype=new BaseExpr;UnaryExpr.prototype.datatype="number";UnaryExpr.prototype.evaluate=function(n){return-this.expr.number(n)};UnaryExpr.prototype.show=function(n){n=n||"";var t="";return t+=n+"unary: "+this.op+"\n",n+="    ",t+this.expr.show(n)};!window.UnionExpr&&window.defaultConfig&&(window.UnionExpr=null);UnionExpr=function(){this.paths=[]};UnionExpr.ops={"|":1};UnionExpr.parse=function(n){var t,q;if(q=PathExpr.parse(n),!this.ops[n.peek()])return q;for(t=new UnionExpr,t.path(q);;){if(!this.ops[n.next()])break;if(n.empty())throw Error("missing next union location path");t.path(PathExpr.parse(n))}return n.back(),t};UnionExpr.prototype=new BaseExpr;UnionExpr.prototype.datatype="nodeset";UnionExpr.prototype.evaluate=function(n){for(var q=this.paths,r=new NodeSet,t=0,f=q.length;t<f;t++){var u=q[t].evaluate(n);if(!u.isNodeSet)throw Error("PathExpr must be nodeset");r.merge(u)}return r};UnionExpr.prototype.path=function(n){this.paths.push(n);n.needContextPosition&&(this.needContextPosition=!0);n.needContextNode&&(this.needContextNode=!0)};UnionExpr.prototype.show=function(n){n=n||"";var t="";t+=n+"union:\n";n+="    ";for(var q=0;q<this.paths.length;q++)t+=this.paths[q].show(n);return t};!window.PathExpr&&window.defaultConfig&&(window.PathExpr=null);PathExpr=function(n){this.filter=n;this.steps=[];this.datatype=n.datatype;this.needContextPosition=n.needContextPosition;this.needContextNode=n.needContextNode};PathExpr.ops={"//":1,"/":1};PathExpr.parse=function(n){var u,t,q,r;if(this.ops[n.peek()]){if(u=n.next(),r=n.peek(),u=="/"&&(n.empty()||r!="."&&r!=".."&&r!="@"&&r!="*"&&!/(?![0-9])[\w]/.test(r)))return FilterExpr.root();if(q=new PathExpr(FilterExpr.root()),n.empty())throw Error("missing next location step");t=Step.parse(n);q.step(u,t)}else if(t=FilterExpr.parse(n),t)if(this.ops[n.peek()])q=new PathExpr(t);else return t;else t=Step.parse(n),q=new PathExpr(FilterExpr.context()),q.step("/",t);for(;;){if(!this.ops[n.peek()])break;if(u=n.next(),n.empty())throw Error("missing next location step");q.step(u,Step.parse(n))}return q};PathExpr.prototype=new BaseExpr;PathExpr.prototype.evaluate=function(n){var q=this.filter.evaluate(n);if(!q.isNodeSet)throw Exception("Filter nodeset must be nodeset type");for(var h=this.steps,e=0,a=h.length;e<a&&q.length;e++){var r=h[e][1],v=r.reverse,u=q.iterator(v),c=q;q=null;var t,f;if(r.needContextPosition||r.axis!="following")if(r.needContextPosition||r.axis!="preceding"){t=u();var s=0;for(q=r.evaluate(new Ctx(t),!1,c,s);t=u();)s++,q.merge(r.evaluate(new Ctx(t),!1,c,s))}else t=u(),q=r.evaluate(new Ctx(t));else{for(t=u();f=u();t=f)if(uai.applewebkit2){var l=!1,o=f;do if(o==t){l=!0;break}while(o=o.parentNode);if(!l)break}else try{if(!t.contains(f))break}catch(y){if(!(f.compareDocumentPosition(t)&8))break}q=r.evaluate(new Ctx(t))}}return q};PathExpr.prototype.step=function(n,t){if(t.op=n,this.steps.push([n,t]),this.quickAttr=!1,this.steps.length==1&&n=="/"&&t.axis=="attribute"){var q=t.test;q.notOnlyElement||q.name=="*"||(this.quickAttr=!0,this.attrName=q.name)}};PathExpr.prototype.show=function(n){n=n||"";var t="";if(t+=n+"path:\n",n+="    ",t+=n+"filter:\n",t+=this.filter.show(n+"    "),this.steps.length){t+=n+"steps:\n";n+="    ";for(var q=0;q<this.steps.length;q++){var r=this.steps[q];t+=n+"operator: "+r[0]+"\n";t+=r[1].show(n)}}return t};!window.FilterExpr&&window.defaultConfig&&(window.FilterExpr=null);FilterExpr=function(n){this.primary=n;this.predicates=[];this.datatype=n.datatype;this.needContextPosition=n.needContextPosition;this.needContextNode=n.needContextNode};FilterExpr.parse=function(n){var t,r,q,u;q=n.peek();u=q.charAt(0);switch(u){case"$":t=VariableReference.parse(n);break;case"(":if(n.next(),t=BinaryExpr.parse(n),n.empty())throw Error('unclosed "("');if(n.next()!=")"){n.back();throw Error("bad token: "+n.next());}break;case'"':case"'":t=Literal.parse(n);break;default:if(isNaN(+q)){if(NodeType.types[q])return null;if(/(?![0-9])[\w]/.test(u)&&n.peek(1)=="(")t=FunctionCall.parse(n);else return null}else t=Number.parse(n)}return n.peek()!="["?t:(r=new FilterExpr(t),BaseExprHasPredicates.parsePredicates(n,r),r)};FilterExpr.root=function(){return new FunctionCall("root-node")};FilterExpr.context=function(){return new FunctionCall("context-node")};FilterExpr.prototype=new BaseExprHasPredicates;FilterExpr.prototype.evaluate=function(n){var t=this.primary.evaluate(n);if(!t.isNodeSet){if(this.predicates.length)throw Error("Primary result must be nodeset type if filter have predicate expression");return t}return this.evaluatePredicates(t)};FilterExpr.prototype.predicate=function(n){this.predicates.push(n)};FilterExpr.prototype.show=function(n){n=n||"";var t="";if(t+=n+"filter: \n",n+="    ",t+=this.primary.show(n),this.predicates.length){t+=n+"predicates: \n";n+="    ";for(var q=0;q<this.predicates.length;q++)t+=this.predicates[q].show(n)}return t};!window.NodeUtil&&window.defaultConfig&&(window.NodeUtil=null);NodeUtil={to:function(n,t){var q,r=t.nodeType;if(r==1&&config.useInnerText&&!uai.applewebkit2&&(q=t.textContent,q=q==undefined||q==null?t.innerText:q,q=q==undefined||q==null?"":q),typeof q!="string")if(r==9||r==1)for(t=r==9?t.documentElement:t.firstChild,q="",stack=[],i=0;t;){do t.nodeType!=1&&(q+=t.nodeValue),stack[i++]=t;while(t=t.firstChild);while(i&&!(t=stack[--i].nextSibling));}else q=t.nodeValue;switch(n){case"number":return+q;case"boolean":return!!q;default:return q}},attrPropMap:{name:"name","class":"className",dir:"dir",id:"id",name:"name",title:"title"},attrMatch:function(n,t,q){return!t||q==null&&n.hasAttribute&&n.hasAttribute(t)||q!=null&&n.getAttribute&&n.getAttribute(t)==q?!0:!1},getDescendantNodes:function(n,t,q,r,u,f,e){if(f&&f.delDescendant(t,e),u&&r=="id"&&t.getElementById)t=t.getElementById(u),t&&n.match(t)&&q.push(t);else if(u&&r=="name"&&t.getElementsByName)for(var s=t.getElementsByName(u),o=0,h=s.length;o<h;o++)t=s[o],(uai.opera?t.name==u&&n.match(t):n.match(t))&&q.push(t);else if(u&&r=="class"&&t.getElementsByClassName)for(var s=t.getElementsByClassName(u),o=0,h=s.length;o<h;o++)t=s[o],t.className==u&&n.match(t)&&q.push(t);else if(n.notOnlyElement)(function(t){for(var e=arguments.callee,f=t.firstChild;f;f=f.nextSibling)NodeUtil.attrMatch(f,r,u)&&n.match(f.nodeType)&&q.push(f),e(f)})(t);else{var c=n.name;if(t.getElementsByTagName){var s=t.getElementsByTagName(c);if(s)for(var o=0;t=s[o++];)NodeUtil.attrMatch(t,r,u)&&q.push(t)}}return q},getChildNodes:function(n,t,q,r,u){for(var t=t.firstChild;t;t=t.nextSibling)NodeUtil.attrMatch(t,r,u)&&n.match(t)&&q.push(t);return q}};!window.Step&&window.defaultConfig&&(window.Step=null);Step=function(n,t){this.axis=n;this.reverse=Step.axises[n][0];this.func=Step.axises[n][1];this.test=t;this.predicates=[];this._quickAttr=Step.axises[n][2]};Step.axises={ancestor:[!0,function(n,t,q,r,u,f,e){while(t=t.parentNode)f&&t.nodeType==1&&f.reserveDelByNode(t,e,!0),n.match(t)&&q.unshift(t);return q}],"ancestor-or-self":[!0,function(n,t,q,r,u,f,e){do f&&t.nodeType==1&&f.reserveDelByNode(t,e,!0),n.match(t)&&q.unshift(t);while(t=t.parentNode);return q}],attribute:[!1,function(n,t,q){var u=t.attributes;if(u)if(n.notOnlyElement&&n.type==0||n.name=="*")for(var f=0,r;r=u[f];f++)q.push(r);else{var r=u.getNamedItem(n.name);r&&q.push(r)}return q}],child:[!1,NodeUtil.getChildNodes,!0],descendant:[!1,NodeUtil.getDescendantNodes,!0],"descendant-or-self":[!1,function(n,t,q,r,u,f,e){return NodeUtil.attrMatch(t,r,u)&&n.match(t)&&q.push(t),NodeUtil.getDescendantNodes(n,t,q,r,u,f,e)},!0],following:[!1,function(n,t,q,r,u){do for(var f=t;f=f.nextSibling;)NodeUtil.attrMatch(f,r,u)&&n.match(f)&&q.push(f),q=NodeUtil.getDescendantNodes(n,f,q,r,u);while(t=t.parentNode);return q},!0],"following-sibling":[!1,function(n,t,q,r,u,f,e){while(t=t.nextSibling)f&&t.nodeType==1&&f.reserveDelByNode(t,e),n.match(t)&&q.push(t);return q}],namespace:[!1,function(n,t,q){return q}],parent:[!1,function(n,t,q){if(t.nodeType==9)return q;if(t.nodeType==2)return q.push(t.ownerElement),q;var t=t.parentNode;return n.match(t)&&q.push(t),q}],preceding:[!0,function(n,t,q,r,u){var f=[];do f.unshift(t);while(t=t.parentNode);for(var e=1,h=f.length;e<h;e++){var o=[];for(t=f[e];t=t.previousSibling;)o.unshift(t);for(var s=0,c=o.length;s<c;s++)t=o[s],NodeUtil.attrMatch(t,r,u)&&n.match(t)&&q.push(t),q=NodeUtil.getDescendantNodes(n,t,q,r,u)}return q},!0],"preceding-sibling":[!0,function(n,t,q,r,u,f,e){while(t=t.previousSibling)f&&t.nodeType==1&&f.reserveDelByNode(t,e,!0),n.match(t)&&q.unshift(t);return q}],self:[!1,function(n,t,q){return n.match(t)&&q.push(t),q}]};Step.parse=function(n){var t,u,q,r;if(n.peek()==".")q=this.self(),n.next();else if(n.peek()=="..")q=this.parent(),n.next();else{if(n.peek()=="@"){if(t="attribute",n.next(),n.empty())throw Error("missing attribute name");}else if(n.peek(1)=="::"){if(!/(?![0-9])[\w]/.test(n.peek().charAt(0)))throw Error("bad token: "+n.next());if(t=n.next(),n.next(),!this.axises[t])throw Error("invalid axis: "+t);if(n.empty())throw Error("missing node name");}else t="child";if(r=n.peek(),/(?![0-9])[\w]/.test(r.charAt(0)))if(n.peek(1)=="("){if(!NodeType.types[r])throw Error("invalid node type: "+r);u=NodeType.parse(n)}else u=NameTest.parse(n,t);else if(r=="*")u=NameTest.parse(n);else throw Error("bad token: "+n.next());q=new Step(t,u)}return BaseExprHasPredicates.parsePredicates(n,q),q};Step.self=function(){return new Step("self",new NodeType("node"))};Step.parent=function(){return new Step("parent",new NodeType("node"))};Step.prototype=new BaseExprHasPredicates;Step.prototype.evaluate=function(n,t,q,r){var f=n.node;if(t||this.op!="//"){if(this.needContextPosition&&(q=null,r=null),this.quickAttr){var s=this.attrValueExpr?this.attrValueExpr.string(n):null,u=this.func(this.test,f,new NodeSet,this.attrName,s,q,r);u=this.evaluatePredicates(u,1)}else{var u=this.func(this.test,f,new NodeSet,null,null,q,r);u=this.evaluatePredicates(u)}q&&q.doDel()}else if(this.needContextPosition||this.axis!="child"){var h=new Step("descendant-or-self",new NodeType("node")),o=h.evaluate(n,!1,q,r).list(),u=null;h.op="/";for(var e=0,c=o.length;e<c;e++)u?u.merge(this.evaluate(new Ctx(o[e]),!0)):u=this.evaluate(new Ctx(o[e]),!0);u=u||new NodeSet}else if(this.quickAttr){var s=this.attrValueExpr?this.attrValueExpr.string(n):null,u=NodeUtil.getDescendantNodes(this.test,f,new NodeSet,this.attrName,s,q,r);u=this.evaluatePredicates(u,1)}else{var u=NodeUtil.getDescendantNodes(this.test,f,new NodeSet,null,null,q,r);u=this.evaluatePredicates(u)}return u};Step.prototype.predicate=function(n){if(this.predicates.push(n),(n.needContextPosition||n.datatype=="number"||n.datatype=="void")&&(this.needContextPosition=!0),this._quickAttr&&this.predicates.length==1&&n.quickAttr){var t=n.attrName;this.attrName=t;this.attrValueExpr=n.attrValueExpr;this.quickAttr=!0}};Step.prototype.show=function(n){n=n||"";var t="";if(t+=n+"step: \n",n+="    ",this.axis&&(t+=n+"axis: "+this.axis+"\n"),t+=this.test.show(n),this.predicates.length){t+=n+"predicates: \n";n+="    ";for(var q=0;q<this.predicates.length;q++)t+=this.predicates[q].show(n)}return t};!window.NodeType&&window.defaultConfig&&(window.NodeType=null);NodeType=function(n,t){this.name=n;this.literal=t;switch(n){case"comment":this.type=8;break;case"text":this.type=3;break;case"processing-instruction":this.type=7;break;case"node":this.type=0}};NodeType.types={comment:1,text:1,"processing-instruction":1,node:1};NodeType.parse=function(n){var q,r,t;if(q=n.next(),n.next(),n.empty())throw Error("bad nodetype");if(t=n.peek().charAt(0),(t=='"'||t=="'")&&(r=Literal.parse(n)),n.empty())throw Error("bad nodetype");if(n.next()!=")"){n.back();throw Error("bad token "+n.next());}return new NodeType(q,r)};NodeType.prototype=new BaseExpr;NodeType.prototype.notOnlyElement=!0;NodeType.prototype.match=function(n){return!this.type||this.type==n.nodeType};NodeType.prototype.show=function(n){n=n||"";var t="";return t+=n+"nodetype: "+this.type+"\n",this.literal&&(n+="    ",t+=this.literal.show(n)),t};!window.NameTest&&window.defaultConfig&&(window.NameTest=null);NameTest=function(n){this.name=n};NameTest.parse=function(n,t){return n.peek()!="*"&&n.peek(1)==":"&&n.peek(2)=="*"?new NameTest(n.next()+n.next()+n.next()):new NameTest(n.next(),t)};NameTest.prototype=new BaseExpr;NameTest.prototype.match=function(n){var t=n.nodeType;return(t==1||t==2)&&(this.name=="*"||this.name==n.nodeName)?!0:!1};NameTest.prototype.show=function(n){n=n||"";return""+(n+"nametest: "+this.name+"\n")};!window.VariableReference&&window.defaultConfig&&(window.VariableReference=null);VariableReference=function(n){this.name=n.substring(1)};VariableReference.parse=function(n){var t=n.next();if(t.length<2)throw Error("unnamed variable reference");return new VariableReference(t)};VariableReference.prototype=new BaseExpr;VariableReference.prototype.datatype="void";VariableReference.prototype.show=function(n){n=n||"";return""+(n+"variable: "+this.name+"\n")};!window.Literal&&window.defaultConfig&&(window.Literal=null);Literal=function(n){this.text=n.substring(1,n.length-1)};Literal.parse=function(n){var t=n.next();if(t.length<2)throw Error("unclosed literal string");return new Literal(t)};Literal.prototype=new BaseExpr;Literal.prototype.datatype="string";Literal.prototype.evaluate=function(){return this.text};Literal.prototype.show=function(n){n=n||"";return""+(n+"literal: "+this.text+"\n")};!window.Number&&window.defaultConfig&&(window.Number=null);Number=function(n){this.digit=+n};Number.parse=function(n){return new Number(n.next())};Number.prototype=new BaseExpr;Number.prototype.datatype="number";Number.prototype.evaluate=function(){return this.digit};Number.prototype.show=function(n){n=n||"";return""+(n+"number: "+this.digit+"\n")};!window.FunctionCall&&window.defaultConfig&&(window.FunctionCall=null);FunctionCall=function(n){var t=FunctionCall.funcs[n];if(!t)throw Error(n+" is not a function");this.name=n;this.func=t[0];this.args=[];this.datatype=t[1];t[2]&&(this.needContextPosition=!0);this.needContextNodeInfo=t[3];this.needContextNode=this.needContextNodeInfo[0]};FunctionCall.funcs={"context-node":[function(){if(arguments.length!=0)throw Error("Function context-node expects ()");var n;return n=new NodeSet,n.push(this.node),n},"nodeset",!1,[!0]],"root-node":[function(){if(arguments.length!=0)throw Error("Function root-node expects ()");var n,t;return n=new NodeSet,t=this.node,t.nodeType==9?n.push(t):n.push(t.ownerDocument),n},"nodeset",!1,[]],last:[function(){if(arguments.length!=0)throw Error("Function last expects ()");return this.last},"number",!0,[]],position:[function(){if(arguments.length!=0)throw Error("Function position expects ()");return this.position},"number",!0,[]],count:[function(n){if(arguments.length!=1||!(n=n.evaluate(this)).isNodeSet)throw Error("Function count expects (nodeset)");return n.length},"number",!1,[]],id:[function(n){var e,q,u,r,t,f,o;if(arguments.length!=1)throw Error("Function id expects (object)");for(f=this.node,o=f.nodeType==9?f:f.ownerDocument,n=n.string(this),e=n.split(/\s+/),q=new NodeSet,u=0,l=e.length;u<l;u++)if(r=e[u],t=o.getElementById(r),uai.opera&&t&&t.id!=r)for(var h=o.getElementsByName(r),s=0,c=h.length;s<c;s++)t=h[s],t.id==r&&q.push(t);else t&&q.push(t);return q.isSorted=!1,q},"nodeset",!1,[]],"local-name":[function(n){var t;switch(arguments.length){case 0:t=this.node;break;case 1:if((n=n.evaluate(this)).isNodeSet){t=n.first();break}default:throw Error("Function local-name expects (nodeset?)");}return""+t.nodeName},"string",!1,[!0,!1]],name:[function(){return FunctionCall.funcs["local-name"][0].apply(this,arguments)},"string",!1,[!0,!1]],"namespace-uri":[function(){return""},"string",!1,[!0,!1]],string:[function(n){switch(arguments.length){case 0:n=NodeUtil.to("string",this.node);break;case 1:n=n.string(this);break;default:throw Error("Function string expects (object?)");}return n},"string",!1,[!0,!1]],concat:[function(){if(arguments.length<2)throw Error("Function concat expects (string, string[, ...])");for(var t="",n=0,q=arguments.length;n<q;n++)t+=arguments[n].string(this);return t},"string",!1,[]],"starts-with":[function(n,t){if(arguments.length!=2)throw Error("Function starts-with expects (string, string)");return n=n.string(this),t=t.string(this),n.indexOf(t)==0},"boolean",!1,[]],contains:[function(n,t){if(arguments.length!=2)throw Error("Function contains expects (string, string)");return n=n.string(this),t=t.string(this),n.indexOf(t)!=-1},"boolean",!1,[]],substring:[function(n,t,q){var r,u;n=n.string(this);t=t.number(this);switch(arguments.length){case 2:q=n.length-t+1;break;case 3:q=q.number(this);break;default:throw Error("Function substring expects (string, string)");}return t=Math.round(t),q=Math.round(q),r=t-1,u=t+q-1,u==Infinity?n.substring(r<0?0:r):n.substring(r<0?0:r,u)},"string",!1,[]],"substring-before":[function(n,t){var q;if(arguments.length!=2)throw Error("Function substring-before expects (string, string)");return(n=n.string(this),t=t.string(this),q=n.indexOf(t),q==-1)?"":n.substring(0,q)},"string",!1,[]],"substring-after":[function(n,t){if(arguments.length!=2)throw Error("Function substring-after expects (string, string)");n=n.string(this);t=t.string(this);var q=n.indexOf(t);return q==-1?"":n.substring(q+t.length)},"string",!1,[]],"string-length":[function(n){switch(arguments.length){case 0:n=NodeUtil.to("string",this.node);break;case 1:n=n.string(this);break;default:throw Error("Function string-length expects (string?)");}return n.length},"number",!1,[!0,!1]],"normalize-space":[function(n){switch(arguments.length){case 0:n=NodeUtil.to("string",this.node);break;case 1:n=n.string(this);break;default:throw Error("Function normalize-space expects (string?)");}return n.replace(/\s+/g," ").replace(/^ /,"").replace(/ $/,"")},"string",!1,[!0,!1]],translate:[function(n,t,q){if(arguments.length!=3)throw Error("Function translate expects (string, string, string)");n=n.string(this);t=t.string(this);q=q.string(this);for(var f=[],r=0,e=t.length;r<e;r++){var u=t.charAt(r);f[u]||(f[u]=q.charAt(r)||"")}for(var o="",r=0,e=n.length;r<e;r++){var u=n.charAt(r),s=f[u];o+=s!=undefined?s:u}return o},"string",!1,[]],boolean:[function(n){if(arguments.length!=1)throw Error("Function boolean expects (object)");return n.bool(this)},"boolean",!1,[]],not:[function(n){if(arguments.length!=1)throw Error("Function not expects (object)");return!n.bool(this)},"boolean",!1,[]],"true":[function(){if(arguments.length!=0)throw Error("Function true expects ()");return!0},"boolean",!1,[]],"false":[function(){if(arguments.length!=0)throw Error("Function false expects ()");return!1},"boolean",!1,[]],lang:[function(){return!1},"boolean",!1,[]],number:[function(n){switch(arguments.length){case 0:n=NodeUtil.to("number",this.node);break;case 1:n=n.number(this);break;default:throw Error("Function number expects (object?)");}return n},"number",!1,[!0,!1]],sum:[function(n){var q,r,t,u;if(arguments.length!=1||!(n=n.evaluate(this)).isNodeSet)throw Error("Function sum expects (nodeset)");for(q=n.list(),r=0,t=0,u=q.length;t<u;t++)r+=NodeUtil.to("number",q[t]);return r},"number",!1,[]],floor:[function(n){if(arguments.length!=1)throw Error("Function floor expects (number)");return n=n.number(this),Math.floor(n)},"number",!1,[]],ceiling:[function(n){if(arguments.length!=1)throw Error("Function ceiling expects (number)");return n=n.number(this),Math.ceil(n)},"number",!1,[]],round:[function(n){if(arguments.length!=1)throw Error("Function round expects (number)");return n=n.number(this),Math.round(n)},"number",!1,[]]};FunctionCall.parse=function(n){var t,q=new FunctionCall(n.next());for(n.next();n.peek()!=")";){if(n.empty())throw Error("missing function argument list");if(t=BinaryExpr.parse(n),q.arg(t),n.peek()!=",")break;n.next()}if(n.empty())throw Error("unclosed function argument list");if(n.next()!=")"){n.back();throw Error("bad token: "+n.next());}return q};FunctionCall.prototype=new BaseExpr;FunctionCall.prototype.evaluate=function(n){return this.func.apply(n,this.args)};FunctionCall.prototype.arg=function(n){this.args.push(n);n.needContextPosition&&(this.needContextPosition=!0);var t=this.args;n.needContextNode&&(t.needContexNode=!0);this.needContextNode=t.needContextNode||this.needContextNodeInfo[t.length]};FunctionCall.prototype.show=function(n){n=n||"";var t="";if(t+=n+"function: "+this.name+"\n",n+="    ",this.args.length){t+=n+"arguments: \n";n+="    ";for(var q=0;q<this.args.length;q++)t+=this.args[q].show(n)}return t};var NodeID={uuid:1,get:function(n){return n.__jsxpath_id__||(n.__jsxpath_id__=this.uuid++)}};!window.NodeSet&&window.defaultConfig&&(window.NodeSet=null);NodeSet=function(){this.length=0;this.nodes=[];this.seen={};this.idIndexMap=null;this.reserveDels=[]};NodeSet.prototype.isNodeSet=!0;NodeSet.prototype.isSorted=!0;NodeSet.prototype.merge=function(n){if(this.isSorted=!1,n.only)return this.push(n.only);if(this.only){var r=this.only;delete this.only;this.push(r);this.length--}for(var q=n.nodes,t=0,u=q.length;t<u;t++)this._add(q[t])};NodeSet.prototype.sort=function(){if(!this.only&&!this.sortOff&&!this.isSorted){this.isSorted=!0;this.idIndexMap=null;var n=this.nodes;n.sort(function(n,t){if(n==t)return 0;if(n.compareDocumentPosition){var s=n.compareDocumentPosition(t);return s&2?1:s&4?-1:0}for(var q=n,r=t,e=n,o=t,u=0,f=0;e=e.parentNode;)u++;while(o=o.parentNode)f++;if(u>f){while(u--!=f)q=q.parentNode;if(q==r)return 1}else if(f>u){while(f--!=u)r=r.parentNode;if(q==r)return-1}while((e=q.parentNode)!=(o=r.parentNode))q=e,r=o;while(q=q.nextSibling)if(q==r)return-1;return 1})}};NodeSet.prototype.reserveDelByNodeID=function(n,t,q){var u=this.createIdIndexMap(),r;if((r=u[n])&&(q&&this.length-t-1>r||!q&&t<r)){var f={value:r,order:String.fromCharCode(r),toString:function(){return this.order},valueOf:function(){return this.value}};this.reserveDels.push(f)}};NodeSet.prototype.reserveDelByNode=function(n,t,q){this.reserveDelByNodeID(NodeID.get(n),t,q)};NodeSet.prototype.doDel=function(){if(this.reserveDels.length){if(this.length<65536)var t=this.reserveDels.sort(function(n,t){return t-n});else var t=this.reserveDels.sort(function(n,t){return t-n});for(var n=0,q=t.length;n<q;n++)this.del(t[n]);this.reserveDels=[];this.idIndexMap=null}};NodeSet.prototype.createIdIndexMap=function(){if(this.idIndexMap)return this.idIndexMap;for(var t=this.idIndexMap={},q=this.nodes,n=0,r=q.length;n<r;n++){var u=q[n],f=NodeID.get(u);t[f]=n}return t};NodeSet.prototype.del=function(n){if(this.length--,this.only)delete this.only;else{var t=this.nodes.splice(n,1)[0];this._first==t&&(delete this._first,delete this._firstSourceIndex,delete this._firstSubIndex);delete this.seen[NodeID.get(t)]}};NodeSet.prototype.delDescendant=function(n,t){if(!this.only){var r=n.nodeType;if((r==1||r==9)&&!uai.applewebkit2){if(!n.contains)if(r==1){var f=n;n={contains:function(n){return n.compareDocumentPosition(f)&8}}}else n={contains:function(){return!0}};for(var u=this.nodes,q=t+1;q<u.length;q++)n.contains(u[q])&&(this.del(q),q--)}}};NodeSet.prototype._add=function(n,t){var q=this.seen,r=NodeID.get(n);if(q[r])return!0;q[r]=!0;this.length++;t?this.nodes.unshift(n):this.nodes.push(n)};NodeSet.prototype.unshift=function(n){if(!this.length){this.length++;this.only=n;return}if(this.only){var t=this.only;delete this.only;this.unshift(t);this.length--}return this._add(n,!0)};NodeSet.prototype.push=function(n){if(!this.length){this.length++;this.only=n;return}if(this.only){var t=this.only;delete this.only;this.push(t);this.length--}return this._add(n)};NodeSet.prototype.first=function(){return this.only?this.only:(this.nodes.length>1&&this.sort(),this.nodes[0])};NodeSet.prototype.list=function(){return this.only?[this.only]:(this.sort(),this.nodes)};NodeSet.prototype.string=function(){var n=this.only||this.first();return n?NodeUtil.to("string",n):""};NodeSet.prototype.bool=function(){return!!(this.length||this.only)};NodeSet.prototype.number=function(){return+this.string()};NodeSet.prototype.iterator=function(n){this.sort();var t=this;if(n){var q=0;return function(){var n=t.length-q++-1;return t.only&&n==0?t.only:t.nodes[n]}}var q=0;return function(){return t.only&&q++==0?t.only:t.nodes[q++]}};var install=function(n){n=n||this;var t=n.document,q=n.undefined;n.XPathExpression=function(t){if(!t.length)throw n.Error("no expression");var q=this.lexer=Lexer(t);if(q.empty())throw n.Error("no expression");if(this.expr=BinaryExpr.parse(q),!q.empty())throw n.Error("bad token: "+q.next());};n.XPathExpression.prototype.evaluate=function(t,q){return new n.XPathResult(this.expr.evaluate(new Ctx(t)),q)};n.XPathResult=function(n,t){if(t==0)switch(typeof n){case"object":t++;case"boolean":t++;case"string":t++;case"number":t++}this.resultType=t;switch(t){case 1:this.numberValue=n.isNodeSet?n.number():+n;return;case 2:this.stringValue=n.isNodeSet?n.string():""+n;return;case 3:this.booleanValue=n.isNodeSet?n.bool():!!n;return;case 4:case 5:case 6:case 7:this.nodes=n.list();this.snapshotLength=n.length;this.index=0;this.invalidIteratorState=!1;break;case 8:case 9:this.singleNodeValue=n.first();return}};n.XPathResult.prototype.iterateNext=function(){return this.nodes[this.index++]};n.XPathResult.prototype.snapshotItem=function(n){return this.nodes[n]};n.XPathResult.ANY_TYPE=0;n.XPathResult.NUMBER_TYPE=1;n.XPathResult.STRING_TYPE=2;n.XPathResult.BOOLEAN_TYPE=3;n.XPathResult.UNORDERED_NODE_ITERATOR_TYPE=4;n.XPathResult.ORDERED_NODE_ITERATOR_TYPE=5;n.XPathResult.UNORDERED_NODE_SNAPSHOT_TYPE=6;n.XPathResult.ORDERED_NODE_SNAPSHOT_TYPE=7;n.XPathResult.ANY_UNORDERED_NODE_TYPE=8;n.XPathResult.FIRST_ORDERED_NODE_TYPE=9;t.createExpression=function(t){return new n.XPathExpression(t,null)};t.evaluate=function(n,q,r,u){return t.createExpression(n,null).evaluate(q,u)}},win;if(config.targetFrame){var frame=document.getElementById(config.targetFrame);frame&&(win=frame.contentWindow)}config.exportInstaller&&(window.install=install);config.hasNative&&config.useNative||install(win||window)}})();
/*!
 ~/Script/native.Forms.xml.js
*/
var SourceCode=SourceCode||{};SourceCode.Forms=SourceCode.Forms||{};SourceCode.Forms.Xml=SourceCode.Forms.Xml||{};var createXML=function(){var n;return supportsActiveX()?(n=new ActiveXObject("Msxml2.DOMDocument.6.0"),n.async=!1,n.preserveWhiteSpace=!0):n=document.implementation.createDocument(null,null,null),n},parseXML=function(n){if((typeof n=="undefined"||n==null||n==="")&&!jasmine)throw"tried to parse bad xml";return jQuery.parseXML(n)},tryParseXML=function(n){var t=null;try{typeof n=="string"&&n.toString().trim().indexOf("<")!=0?(t=jQuery.parseXML("<Dummy/>"),t.removeChild(t.documentElement)):t=jQuery.parseXML(n)}catch(q){t=jQuery.parseXML("<Dummy/>");t.removeChild(t.documentElement)}return t},xmlRegularExpressions={slashes:/\\\\/g};if(window.XMLSerializer&&window.Node&&Node.prototype&&Node.prototype.__defineGetter__){var _xmlDocumentPrototype={transformNode:function(n){return this.transformXML(n).xml},transformXML:function(n){var t=new XSLTProcessor;return t.importStylesheet(n),t.transformToDocument(this)},_detectEdgeCrash:function(){if(SourceCode.Forms.Browser.edge===!0&&!this.documentElement&&!this.parentNode&&this.childNodes.length===0)return!0},selectSingleNode:function(n){var t=this;if(t.nodeType!==9&&(t=t.ownerDocument),(typeof t.nsResolver=="undefined"||t.nsResolver===null)&&(t.nsResolver=function(){return null}),_xmlDocumentPrototype._detectEdgeCrash.call(this))return null;var q=t.evaluate(n.replace(xmlRegularExpressions.slashes,"\\"),this,t.nsResolver,XPathResult.ANY_UNORDERED_NODE_TYPE,null);return q!==null&&typeof q.singleNodeValue!="undefined"&&q.singleNodeValue!==null?q.singleNodeValue:null},selectNodes:function(n){var t=this;if(t.nodeType!==9&&(t=t.ownerDocument),t.nsResolver===null&&(t.nsResolver=function(){return null}),_xmlDocumentPrototype._detectEdgeCrash.call(this))return[];for(var u=t.evaluate(n,this,t.nsResolver,XPathResult.ANY_TYPE,null),q=[],r;r=u.iterateNext();)q.push(r);return q}};XMLDocument.prototype.evaluate||supportsActiveX()||(XMLDocument.prototype.evaluate=function(n,t,q,r,u){return document.evaluate(n,t,q,r,u)});jQuery.extend(XMLDocument.prototype,_xmlDocumentPrototype);Node.prototype.selectSingleNode=XMLDocument.prototype.selectSingleNode;Node.prototype.selectNodes=XMLDocument.prototype.selectNodes;XMLDocument.prototype.__defineGetter__("xml",function(){return(new XMLSerializer).serializeToString(this)});Node.prototype.__defineGetter__("xml",function(){return(new XMLSerializer).serializeToString(this)});Node.prototype.__defineGetter__("text",function(){var t="";if(this.childNodes.length>0)for(var n=0;n<this.childNodes.length;n++)t+=this.childNodes[n].hasChildNodes()?this.childNodes[n].text:this.childNodes[n].nodeValue!==null?this.childNodes[n].nodeValue:"";else checkExists(this.nodeValue)&&(t=this.nodeValue);return t});typeof Attr!="undefined"&&Attr.prototype.__defineGetter__("text",function(){return this.value})}function XslTransform(n){this.init(n)}var _xslTransformPrototype={options:{stylesheet:"",parameters:[]},init:function(n){this.options=jQuery.extend({},this.options,n);this.processor=null;$defined(this.options.stylesheet)&&this.options.stylesheet!=""&&this.importStylesheet(this.options.stylesheet);this.options.parameters.length&&this.options.parameters.length>0&&this.options.parameters.each(function(n,t){this.addParameter(t,n)})},_stylesheets:{},importStylesheet:function(n){var t,r=!1;if(checkExistsNotEmpty(n)&&n.indexOf("?")===-1&&checkExists(SourceCode.Forms.Settings)&&checkExistsNotEmpty(SourceCode.Forms.Settings.Version)&&(n=n+"?_v="+encodeURIComponent(SourceCode.Forms.Settings.Version)),typeof this._stylesheets[n]!="undefined")t=this._stylesheets[n],typeof XSLTProcessor=="undefined"&&(r=!0);else if(typeof XSLTProcessor!="undefined")try{t=document.implementation.createDocument("","",null);t.async=!1;t.load(n)}catch(f){try{var q=new window.XMLHttpRequest;q.open("GET",n,!1);q.send(null);checkExists(q.responseXML)&&checkExists(q.responseXML.documentElement)?t=q.responseXML.documentElement:checkExistsNotEmpty(q.responseText)&&(t=parseXML(q.responseText))}catch(e){}}else r=!0,t=new ActiveXObject("Msxml2.FreeThreadedDOMDocument.6.0"),t.async=!1,t.load(n);if(r===!1)this.processor===null&&(this.processor=new XSLTProcessor),this.processor.importStylesheet(t);else{var u=new ActiveXObject("Msxml2.XSLTemplate.6.0");u.stylesheet=t;this.processor=u.createProcessor()}return this._stylesheets[n]=t,this},addParameter:function(n,t){this.processor!==null&&(this.processor.setParameter?this.processor.setParameter("",n,t):this.processor.addParameter(n,t))},transform:function(n,t,q){var r;if($defined(n.documentElement)?r=n:$type(n)==="string"&&(r=parseXML(n)),checkExists(t)&&this.importStylesheet(t),typeof XSLTProcessor!="undefined"){var u=this.processor.transformToDocument(r);return q==="text"&&(u=u===null?"":u.xml),u}this.processor.input=r;try{this.processor.transform()}catch(f){}return q==="text"?this.processor.output:parseXML(this.processor.output)},transformToText:function(n,t){return this.transform(n,t,"text")},transformToDocument:function(n,t){return this.transform(n,t,"document")}};jQuery.extend(XslTransform.prototype,_xslTransformPrototype);function cloneNodes(n,t,q,r){if(t!==null&&n!==null&&q!==null&&q!==""&&typeof t.selectNodes!="undefined"&&typeof n.appendChild!="undefined"){var f=t.selectNodes(q);if(checkExists(r)&&r!==!1)for(var u=0;u<f.length;u++)n.appendChild(f[u].cloneNode(!0));else for(var u=f.length-1;u>=0;u--)n.appendChild(f[u].cloneNode(!0))}}function cloneItemTypeNodes(n,t,q,r){cloneNodes(n,t,"/Items/Item[@ItemType='{0}']".format(q),r)}function removeXmlNodes(n,t,q){var u=n;if(typeof n=="string"){if(n==="")return"";u=parseXML(n)}for(var r=u.selectNodes(t);r.length>0;){for(var f=r.length-1;f>=0;f--)r[f].parentNode.removeChild(r[f]);r=q?u.selectNodes(t):[]}n=u}function removeXmlNodesParentNode(n,t){var r=n;if(typeof n=="string"){if(n==="")return"";r=parseXML(n)}for(var u=r.selectNodes(t),q=u.length-1;q>=0;q--)u[q].parentNode.parentNode.removeChild(u[q].parentNode);n=r}function removeXmlNodesString(n,t){return(removeXmlNodes(n,t),typeof n!="string"&&typeof n.xml!="undefined")?n.xml:n}var $xml=function(n){var t=parseXML(n);return t.preserveWhiteSpace=!0,t},$sn=function(n,t){return n.selectSingleNode(t)},$mn=function(n,t){return n.selectNodes(t)};function _getCurrentNodeXpath(n){var c=n.originalFromNode,u=n.fromNode,v=n.currentXpath;if(typeof u.tagName=="undefined")return v;var e=u.tagName;if(v!=="")e=v+"/"+e;else if(n.orginalToNodeIsChild)return n.orginalToNodeIsChild=!1,"";var f=$mn(c,e),l=0,a=0,y=u.attributes.length,p=u.childNodes.length,t=e,w=y===0?"mustAdd":"na",b=p===0?"mustAdd":"na",q=!1;if(n.isIdentifyingPath=!1,checkExists(n.identifyingPath)){for(var tt=e.split("/"),ut=tt.length,qt=n.identifyingPath.split("/"),rt=qt.length,k=!0,r=1;r<=rt&&k;r++)k=tt[ut-r].split("[")[0]===qt[rt-r];if(n.isIdentifyingPath=k,n.isIdentifyingPath){if(checkExists(n.identifyingAttributes))for(var r=0;r<n.identifyingAttributes.length&&f.length>1;r++){var o=n.identifyingAttributes[r],d=u.getAttribute(o);t=checkExists(d)?q?"{0} and @{1}='{2}']".format(t.substr(0,t.length-1),o,d):"{0}[@{1}='{2}']".format(t,o,d):q?"{0} and not(@{1})]".format(t.substr(0,t.length-1),o):"{0}[not(@{1})]".format(t,o);q=!0;f=$mn(c,t)}if(checkExists(n.identifyingNodes))for(var r=0;r<n.identifyingNodes.length&&f.length>1;r++){var s=n.identifyingNodes[r],g=u.selectSingleNode(s);t=checkExists(g)?q?"{0} and {1}='{2}']".format(t.substr(0,t.length-1),s,g.text):"{0}[{1}='{2}'".format(t,s,g.text):q?"{0} and not({1})]".format(t.substr(0,t.length-1),s):"{0}[not({1})]".format(t,s);q=!0;f=$mn(c,t)}}}while(f.length>1&&(l!==y||a!==p||b==="mustAdd"||w==="mustAdd")){if(l<y){var h=u.attributes[l];n.isIdentifyingPath&&checkExists(n.identifyingAttributes)&&n.identifyingAttributes.contains(h.name)||(t=q?"{0} and @{1}='{2}']".format(t.substr(0,t.length-1),h.name,h.value):"{0}[@{1}='{2}']".format(t,h.name,h.value),q=!0);l++}else if(w==="mustAdd")t=q?"{0} and not(@*)]".format(t.substr(0,t.length-1)):"{0}[not(@*)]".format(t),w="added",q=!0;else if(a<p){var nt=u.childNodes[a];n.isIdentifyingPath&&checkExists(n.identifyingNodes)&&n.identifyingNodes.contains(nt.tagName)||(t=q?t.substr(0,t.length-1)+" and "+nt.tagName+"]":t+"["+nt.tagName+"]",q=!0);a++}else b==="mustAdd"&&(t=q?"{0} and not(*)]".format(t.substr(0,t.length-1)):"{0}[not(*)]".format(t),b="added",q=!0);f=$mn(c,t)}return f.length>1&&(t=e),t}function MergeXmlNodes(n){return(checkExists(n.overideValue==="undefined")||(n.overideValue=!1),checkExists(n.compareOnly)||(n.compareOnly=!1),!checkExists(n.fromNode))?null:(n.changesMade=0,n.currentXpath="",n.orginalToNodeIsChild=!1,!n.toNode.parentNode&&n.toNode.documentElement?(n.originalToNode=n.toNode,n.toNode=n.toNode.documentElement):n.toNode.parentNode?n.originalToNode=n.toNode.parentNode:(n.orginalToNodeIsChild=!0,n.originalToNode=n.toNode),!n.fromNode.parentNode&&n.fromNode.documentElement?(n.originalFromNode=n.fromNode,n.fromNode=n.fromNode.documentElement):n.originalFromNode=n.fromNode.parentNode?n.fromNode.parentNode:n.fromNode,MergeXmlNodesInternal(n))}function MergeXmlNodesInternal(n){var o=0,l=null,s=_getCurrentNodeXpath(n);if(n.fromNode.hasChildNodes()){for(var q=0;q<n.fromNode.childNodes.length;q++){var nt=n.fromNode.childNodes[q],d={fromNode:n.fromNode.childNodes[q],toNode:n.toNode,overideValue:n.overideValue,compareOnly:n.compareOnly,changesMade:n.changesMade,originalToNode:n.originalToNode,originalFromNode:n.originalFromNode,orginalToNodeIsChild:n.orginalToNodeIsChild,identifyingPath:n.identifyingPath,identifyingAttributes:n.identifyingAttributes,identifyingNodes:n.identifyingNodes,currentXpath:s};if(n.changesMade=MergeXmlNodesInternal(d),n.compareOnly&&n.changesMade>0)return n.changesMade}if(typeof n.fromNode.attributes!="undefined"&&n.fromNode.attributes!==null)for(var g=n.fromNode.attributes.length,a=0;a<g;a++){var h=n.fromNode.attributes[a],y=$sn(n.originalToNode,s),p=y.getAttribute(h.name);if(p!==h.value&&(!n.compareOnly&&(p===null||n.overideValue)&&y.setAttribute(h.name,h.value),n.changesMade++,n.compareOnly))return n.changesMade}}else{var w=typeof n.fromNode.tagName=="undefined",t=$sn(n.originalToNode,s);if(typeof t!="undefined"&&t!==null){if(w){for(var r=null,q=0;q<t.childNodes.length;q++)if(r=t.childNodes[q],typeof r.tagName=="undefined"){t=r;break}r===null&&(r=n.toNode.ownerDocument.createTextNode(""),t.appendChild(r),t=r)}if(t.nodeValue!==n.fromNode.nodeValue&&(t.nodeValue===null||n.fromNode.nodeValue===null||t.nodeValue.toLowerCase()!==n.fromNode.nodeValue.toLowerCase())&&(!n.compareOnly&&(n.fromNode.nodeValue===null||n.overideValue)&&(t.nodeValue=n.fromNode.nodeValue),n.changesMade++,n.compareOnly))return n.changesMade}else{for(var e=s+"",c=null,f=null,b=!1,u=n.fromNode;t===null;){var v=e.lastIndexOf("/"),k="";if(v>=0?(k=e.substr(v+1).split("[")[0],e=e.substr(0,v),t=$sn(n.originalToNode,e)):t=n.toNode,n.changesMade++,n.compareOnly)return n.changesMade;for(c=n.toNode.ownerDocument.createElement(k),!b&&w&&(c.appendChild(n.toNode.ownerDocument.createTextNode(u.nodeValue)),b=!0,u=u.parentNode),f!==null&&c.appendChild(f),f=c,o=0;o<u.attributes.length;o++)l=u.attributes[o],f.setAttribute(l.name,l.value);u=u.parentNode}!n.compareOnly&&f&&t.appendChild(f)}}return n.changesMade}function MergeXmlNodeCollections(n,t){for(var r=[],q=0;q<n.length;q++)r.push(n[q]);for(var q=0;q<t.length;q++)r.push(t[q]);return r}function CompareXmlNodes(n,t){var r={fromNode:n,toNode:t,compareOnly:!0},q=MergeXmlNodes(r);if(q!==0)return!1;var r={fromNode:t,toNode:n,compareOnly:!0};return(q=MergeXmlNodes(r),q!==0)?!1:!0}function populateIdentifyingNode(n,t,q){if(n.isIdentifyingPath){if(checkExists(n.identifyingAttributes))for(var r=0;r<n.identifyingAttributes.length;r++){var u=n.identifyingAttributes[r],f=q.getAttribute(u);checkExists(f)&&t.setAttribute(u,f)}if(checkExists(n.identifyingNodes))for(var r=0;r<n.identifyingNodes.length;r++){var o=n.identifyingNodes[r],e=q.selectSingleNode(o);checkExists(e)&&t.appendChild(e.cloneNode(!0))}}}function FindXmlDelta(n){checkExists(n.overideValue)||(n.overideValue=!1);checkExists(n.compareOnly)||(n.compareOnly=!1);var q=n.toNode.parentNode;n.currentXpath="";!n.toNode.parentNode&&n.toNode.documentElement?(n.originalToNode=n.toNode,n.toNode=n.toNode.documentElement):n.originalToNode=n.toNode.parentNode?n.toNode.parentNode:n.toNode;!n.fromNode.parentNode&&n.fromNode.documentElement?(n.originalFromNode=n.fromNode,n.fromNode=n.fromNode.documentElement):n.originalFromNode=n.fromNode.parentNode?n.fromNode.parentNode:n.fromNode;n.delta=parseXML("<Delta/>");var t=FindXmlDeltaInternal(n);return t===null?t:t.cloneNode(!0)}function FindXmlDeltaInternal(n){var f=_getCurrentNodeXpath(n),t=null;if(n.fromNode.hasChildNodes()){for(var q=0;q<n.fromNode.childNodes.length;q++){var v=n.fromNode.childNodes[q],s={fromNode:n.fromNode.childNodes[q],toNode:n.toNode,overideValue:n.overideValue,compareOnly:n.compareOnly,delta:n.delta,originalToNode:n.originalToNode,originalFromNode:n.originalFromNode,identifyingPath:n.identifyingPath,identifyingAttributes:n.identifyingAttributes,identifyingNodes:n.identifyingNodes,currentXpath:f},h=FindXmlDeltaInternal(s);h!=null&&(t===null&&(t=s.delta.createElement(n.fromNode.tagName),populateIdentifyingNode(n,t,n.fromNode)),t.appendChild(h))}if(typeof n.fromNode.attributes!="undefined"&&n.fromNode.attributes!==null)for(var l=n.fromNode.attributes.length,e=0;e<l;e++){var u=n.fromNode.attributes[e],c=$sn(n.originalToNode,f);c&&c.getAttribute(u.name)===u.value||(t==null&&(t=n.delta.createElement(n.fromNode.tagName)),t.setAttribute(u.name,u.value))}}else{var a=typeof n.fromNode.tagName=="undefined",r=$sn(n.originalToNode,f);if(r!=null){if(a)for(var o=null,q=0;q<r.childNodes.length;q++)if(o=r.childNodes[q],typeof o.tagName=="undefined"){r=o;break}r.nodeValue!==n.fromNode.nodeValue&&(r.nodeValue===null||n.fromNode.nodeValue===null||r.nodeValue.toLowerCase()!==n.fromNode.nodeValue.toLowerCase())&&(t=n.fromNode.cloneNode(!0))}else t=n.fromNode.cloneNode(!0)}return t}var prettyFormatOptions={indentChr:"\t",newLineChr:"\n"};function prettyFormatXml(n,t){return!checkExists(n.parentNode)&&checkExists(n.documentElement)&&(n=n.documentElement),checkExists(t)||(t=prettyFormatOptions),prettyFormatNode(t,n,"")}function prettyFormatNode(n,t,q){for(var e=q+n.indentChr,u="{0}<{1}".format(q,t.tagName),o=t.attributes.length,r=0;r<o;r++)u+=prettyFormatAttribute(t.attributes[r]);u+=">{0}".format(n.newLineChr);for(var o=t.childNodes.length,r=0;r<o;r++){var f=t.childNodes[r];u+=f.nodeType===3||f.nodeType===4?prettyFormatTextNode(n,f,e):prettyFormatNode(n,f,e)}return u+"{0}<\/{1}>{2}".format(q,t.tagName,n.newLineChr)}function prettyFormatAttribute(n){return" {0}={1}".format(n.name,n.value)}function prettyFormatTextNode(n,t,q){return"{0}{1}{2}".format(q,t.nodeValue,n.newLineChr)}function getNodeValue(n,t,q){var r=q;if(checkExists(t)){var u=t.selectSingleNode(n);checkExists(u)&&(r=u.text)}return r}function getNodeAttribute(n,t,q,r){if(checkExists(t)){var u=t.getAttribute(n);if(checkExists(r)||(r=checkExists),r(u))return u}return q}var _supportsDOMParser=null;function supportsDOMParser(){if(_supportsDOMParser===null&&(_supportsDOMParser=typeof DOMParser!="undefined",_supportsDOMParser)){var n=new DOMParser,t=n.parseFromString("<test/>","text/xml");_supportsDOMParser=typeof t.evaluate=="function"}return _supportsDOMParser}var _supportsActiveX=null;function supportsActiveX(){if(_supportsActiveX===null)try{var n=new ActiveXObject("Msxml2.DOMDocument.6.0");_supportsActiveX=!0}catch(t){_supportsActiveX=!1}return _supportsActiveX}var _supportsNativeXPath=null;function supportsNativeXPath(){if(_supportsNativeXPath===null){_supportsNativeXPath=!1;try{if(typeof DOMParser!="undefined")var n=new DOMParser,t=n.parseFromString("<root><node/><node/><\/root>","text/xml"),q=t.selectNodes("/root/node");_supportsNativeXPath=!0}catch(r){}}return _supportsNativeXPath}SourceCode.Forms.Xml.smoXmlToObjects=function(n){for(var r=[],u=n.selectNodes("Items/Item"),q=0;q<u.length;q++){var t=u[q],c=t.getAttribute("Guid"),p=t.getAttribute("ItemType"),l=t.getAttribute("SubType"),f=t.selectSingleNode("Name"),e=t.selectSingleNode("DisplayName"),a=t.getAttribute("ValidationStatus"),v=t.getAttribute("validationMessages"),o="",s="";checkExists(f)&&(o=f.text);checkExists(e)&&(s=e.text);var h=new SourceCode.Forms.Types.SmartObject({id:c,name:o,displayName:s,validationStatus:a,validationMessages:v,subType:l}),y=t.selectNodes("Items/Item");SourceCode.Forms.Xml.addSmoPropertiesAndMethodsFromXml(y,h);r.push(h)}return r};SourceCode.Forms.Xml.addSmoPropertiesAndMethodsFromXml=function(n,t){for(var u=0;u<n.length;u++){var q=n[u],r=q.getAttribute("ItemType"),c=q.getAttribute("SubType"),f=q.selectSingleNode("Name"),e=q.selectSingleNode("DisplayName"),l=q.getAttribute("ValidationStatus"),a=q.getAttribute("validationMessages"),o="",s="";checkExists(f)&&(o=f.text);checkExists(e)&&(s=e.text);var h={name:o,displayName:s,validationStatus:l,validationMessages:a,subType:c};r&&r.toUpperCase()==="METHOD"&&t.methods.add(new SourceCode.Forms.Types.SmartObjectMethod(h));r&&r.toUpperCase()==="OBJECTPROPERTY"&&t.objectProperties.add(new SourceCode.Forms.Types.SmartObjectProperty(h))}};$.parseXML=function(n){var t,q;try{supportsActiveX()?(t=new ActiveXObject("Msxml2.DOMDocument.6.0"),t.async="false",t.preserveWhiteSpace=!0,t.loadXML(n)):(q=new DOMParser,t=q.parseFromString(n,"text/xml"))}catch(r){t=undefined}return t&&t.documentElement&&!t.getElementsByTagName("parsererror").length||(checkExists(n)&&typeof n.toString=="function"?jQuery.error("Invalid XML: "+n):jQuery.error("Invalid XML (cannot represent object as string).")),t};$.ajaxSettings.converters["text xml"]=$.parseXML;
/*!
 ~/Script/native.Forms.string.js
*/
var _stringPrototype={test:function(n,t){var q=n;return $type(n)==="string"&&(q=this._getTestRegex(n,t)),q.test(this)},_getTestRegex:function(n,t){return checkExists(stringRegularExpressions.testPatterns[n])?stringRegularExpressions.testPatterns[n].lastIndex=0:stringRegularExpressions.testPatterns[n]=new RegExp(n,t),stringRegularExpressions.testPatterns[n]},toInt:function(){return parseInt(this,10)},toFloat:function(){return parseFloat(this)},camelCase:function(){return this.replace(stringRegularExpressions.camelCase,function(n){return n.charAt(1).toUpperCase()})},hyphenate:function(){return this.replace(stringRegularExpressions.hyphenate,function(n){return n.charAt(0)+"-"+n.charAt(1).toLowerCase()})},capitalizeFirstLetter:function(){return this.charAt(0).toUpperCase()+this.slice(1)},capitalize:function(){return this.replace(stringRegularExpressions.capitalise,function(n){return n.toUpperCase()})},trim:function(){return this.replace(stringRegularExpressions.trimLeft,"").replace(stringRegularExpressions.trimRight,"")},properCase:function(n){var r="",u=["A","An","And","As","On","Or","The","For","That","Have","Been","In","With","Go","To","Are","Was","From","All","From","Made","Its"],t=n.capitalize();t=t.split(/\s+/g);for(var q=0,f=t.length;q<f;q++)r=u.contains(t[q])?q===0?r+t[q]+" ":r+t[q].toLowerCase()+" ":r+t[q]+" ";return r.trim(),r},properObjectName:function(n){for(key in stringRegularExpressions.properObjectName)n=n.replace(stringRegularExpressions.properObjectName[key],key);return n},clean:function(){return this.replace(stringRegularExpressions.clean," ").trim()},strip:function(){return this.replace(stringRegularExpressions.strip,"")},rgbToHex:function(n){var t=this.match(stringRegularExpressions.rgbToHex);return t?t.rgbToHex(n):!1},hexToRgb:function(n){var t=this.match(stringRegularExpressions.hexToRgb);return t?t.slice(1).hexToRgb(n):!1},randomColor:function(){for(var t="#",q=0;q<6;q++){var n=Math.floor(Math.random()*16);switch(n){case 10:n="A";break;case 11:n="B";break;case 12:n="C";break;case 13:n="D";break;case 14:n="E";break;case 15:n="F"}t+=n}return t},contains:function(n,t){return t?(t+this+t).indexOf(t+n+t)>-1:this.indexOf(n)>-1},escapeRegExp:function(){return this.replace(stringRegularExpressions.escapeRegExp,"\\$1")},stripTags:function(){return this.replace(stringRegularExpressions.stripTags,"")},stripScripts:function(){return this.replace(stringRegularExpressions.stripScripts,"")},stripStyles:function(){return this.replace(stringRegularExpressions.stripStyles,"")},replaceAll:function(n,t,q){for(var f=["^","$",".","|","?","*","+","(",")","{","}","\\","]","["],r=0;r<n.length;r++)for(var u=0;u<f.length;u++)if(n.charAt(r)===f[u]){n=n.substr(0,r)+"\\"+n.substr(r);r++;break}return this.replace(new RegExp(n,checkExists(q)?q:"gi"),t)},escapeQuotes:function(){return this.replaceAll("'","\\'").replaceAll('"','\\"')},encodeSeparator:function(n){return this.replaceAll(n,"◕_◕")},decodeSeparator:function(n){return this.replaceAll("◕_◕",n)},parseQuery:function(){var n=this.split(/[&;]/),t={};return n.length&&jQuery.each(n,function(n,q){var r=q.split("=");r.length&&r.length===2&&(t[encodeURIComponent(r[0])]=encodeURIComponent(r[1]))}),t},tidy:function(){var t=this.toString(),n=stringRegularExpressions.tidy,q=[{replaceText:n.spaces,withText:" "},{replaceText:n.star,withText:"*"},{replaceText:n.invertedcomma1,withText:"'"},{replaceText:n.invertedcomma2,withText:"'"},{replaceText:n.ellipsis,withText:"..."},{replaceText:n.hyphen,withText:"-"},{replaceText:n.doublehyphen,withText:"--"}];return jQuery.each(q,function(n,q){t=t.replace(q.replaceText,q.withText)}),t},generateGuidPart:function(){return((1+Math.random())*65536|0).toString(16).substring(1)},generateGuid:function(){return this.generateGuidPart()+this.generateGuidPart()+"-"+this.generateGuidPart()+"-"+this.generateGuidPart()+"-"+this.generateGuidPart()+"-"+this.generateGuidPart()+this.generateGuidPart()+this.generateGuidPart()},equals:function(n,t){var q;if(checkExists(n)&&typeof n=="string")q=n;else return!1;return t?this.toUpperCase()===q.toUpperCase():this.toString()===q},isNumeric:function(){return this.match(stringRegularExpressions.isNumeric)!==null?!0:!1},isFloat:function(){return this.match(stringRegularExpressions.isFloat)!==null?!0:!1},trimZeros:function(){var n=this+"",t="";for(n.length>0&&(n.charAt(0)==="-"||n.charAt(0)==="+")&&(t=n.charAt(0),n=n.substr(1));n.length!==0&&n.charAt(0)==="0"&&n.length!==1&&n.charAt(1)!==".";)n=n.substr(1);if(n.indexOf(".")>=0)while(n.length!==0&&n.charAt(n.length-1)==="0"&&n.length!==1)n=n.substr(0,n.length-1);return n.indexOf(".")===n.length-1&&(n=n.substr(0,n.length-1)),t+n},format:function(){var q=0,t=this,u=this===String;if(u&&(q=1,t=arguments[0]),arguments[q]instanceof Array)for(var r=arguments[q],n=0;n<r.length;n++){var f=this._getFormatRegex(n),e=typeof r[n]=="string"?r[n].split("$").join("$$"):r[n];t=t.replace(f,e)}else for(var n=q;n<arguments.length;n++){var o=n;u&&o--;var f=this._getFormatRegex(o),e=typeof arguments[n]=="string"?arguments[n].split("$").join("$$"):arguments[n];t=t.replace(f,e)}return t},_getFormatRegex:function(n){return checkExists(stringRegularExpressions.format[n])?stringRegularExpressions.format[n].lastIndex=0:stringRegularExpressions.format[n]=new RegExp("\\{"+n+"\\}","g"),stringRegularExpressions.format[n]},containsGuid:function(){return this.match(stringRegularExpressions.containsGuid)!==null?!0:!1},isValidGuid:function(){return this.match(stringRegularExpressions.isValidGuid)!==null?!0:!1},toArray:function(){for(var t=[],n=0;n<this.length;n++)t.push(this.substr(n,1));return t},repeat:function(n){for(var t=[],q=0;q<n;q++)t.push(this);return t.join("")},zeroise:function(n){return"0".repeat(n-this.length)+this},removeNBSpace:function(){return this.replace(stringRegularExpressions.spacesReplacementRegex," ")},insertNBSpace:function(){return this.replace(stringRegularExpressions.spacesReplacementRegex,String.fromCharCode(160))},smartObjectEncoding:function(){return this.replace(stringRegularExpressions.smartObjectCharacterReplacement,"_")},replaceSpacesBetweenTags:function(){return this.replace(stringRegularExpressions.spacesBetweenTags,"><")},stripHtml:function(){var n=document.createElement("DIV");n.innerHTML=this.stripScripts().stripStyles();var t=n.textContent||n.innerText||"";return t.replaceAll('"',"")},htmlEncode:function(){return stringRegularExpressions.htmlSpecial.lastIndex=0,stringRegularExpressions.htmlSpecial.test(this)?this.replace(stringRegularExpressions.isAmpersand,"&amp;").replace(stringRegularExpressions.isQuote,"&quot;").replace(stringRegularExpressions.isApostrophe,"&#39;").replace(stringRegularExpressions.isLessThan,"&lt;").replace(stringRegularExpressions.isGreaterThan,"&gt;").toString():this.toString()},htmlEncodeWithExclusionList:function(n){var t=0,r=this.htmlEncode(),q=["<br/>","<br>","<wbr/>","<wbr>","<i>","<\/i>","<b>","<\/b>","<em>","<\/em>"];if(checkExists(n)&&Object.prototype.toString.call(n)==="[object Array]")for(t=0;t<n.length;t++)q.push(n[t]);for(t=0;t<q.length;t++)r=r.replaceAll(q[t].htmlEncode(),q[t]);return r},xmlEncode:function(){return stringRegularExpressions.xmlSpecial.lastIndex=0,stringRegularExpressions.xmlSpecial.test(this)?this.replace(stringRegularExpressions.isAmpersand,"&amp;").replace(stringRegularExpressions.isQuote,"&quot;").replace(stringRegularExpressions.isApostrophe,"&apos;").replace(stringRegularExpressions.isLessThan,"&lt;").replace(stringRegularExpressions.isGreaterThan,"&gt;").toString():this.toString()},htmlDecode:function(){return stringRegularExpressions.hasEncodedEntities.lastIndex=0,stringRegularExpressions.hasEncodedEntities.test(this)?this.replace(stringRegularExpressions.isEncodedQuote,'"').replace(stringRegularExpressions.isEncodedApostrophe,"'").replace(stringRegularExpressions.isEncodedLessThan,"<").replace(stringRegularExpressions.isEncodedGreaterThan,">").replace(stringRegularExpressions.isEncodedAmpersand,"&").toString():this.toString()},xmlDecode:function(){return stringRegularExpressions.hasEncodedEntities.lastIndex=0,stringRegularExpressions.hasEncodedEntities.test(this)?this.replace(stringRegularExpressions.isEncodedQuote,'"').replace(stringRegularExpressions.isEncodedApostrophe,"'").replace(stringRegularExpressions.isEncodedLessThan,"<").replace(stringRegularExpressions.isEncodedGreaterThan,">").replace(stringRegularExpressions.isEncodedAmpersand,"&").toString():this.toString()},xpathValueEncode:function(){return stringRegularExpressions.xpathSpecial.lastIndex=0,stringRegularExpressions.xpathSpecial.test(this)?"concat('"+this.replace(stringRegularExpressions.isApostrophe,"', string(\"'\"), '")+"')":"'"+this+"'"},xpathEncodeBackslash:function(){return this.replace(stringRegularExpressions.isBackslash,"\\\\")},selectorEncode:function(){return stringRegularExpressions.selectorSpecial.lastIndex=0,stringRegularExpressions.selectorSpecial.test(this)?this.replace(stringRegularExpressions.selectorSpecial,"\\$1"):this.toString()},selectorDecode:function(){return stringRegularExpressions.isDoubleBackslash.lastIndex=0,stringRegularExpressions.isDoubleBackslash.test(this)?this.replace(stringRegularExpressions.isDoubleBackslash,""):this.toString()}},stringRegularExpressions={spacesReplacementRegex:/[\u0020\u00a0\uFEFF]/g,isValidGuid:/^[a-fA-F0-9]{8}\-[a-fA-F0-9]{4}\-[a-fA-F0-9]{4}\-[a-fA-F0-9]{4}\-[a-fA-F0-9]{12}$/g,isValidURL:/^((mailto:|(news|(ht|f)tp(s?)):\/\/){1}.+)?$/i,isValidWebURLScheme:/^http(s?):\/\/.+$/i,containsGuid:/([a-fA-F0-9]{8}\-[a-fA-F0-9]{4}\-[a-fA-F0-9]{4}\-[a-fA-F0-9]{4}\-[a-fA-F0-9]{12})+/,findGuids:/([a-fA-F0-9]{8}\-[a-fA-F0-9]{4}\-[a-fA-F0-9]{4}\-[a-fA-F0-9]{4}\-[a-fA-F0-9]{12}_[a-fA-F0-9]{8}\-[a-fA-F0-9]{4}\-[a-fA-F0-9]{4}\-[a-fA-F0-9]{4}\-[a-fA-F0-9]{12}|([a-fA-F0-9]{8}\-[a-fA-F0-9]{4}\-[a-fA-F0-9]{4}\-[a-fA-F0-9]{4}\-[a-fA-F0-9]{12}))+/gm,format:[],testPatterns:{},isNumeric:/^[-+]?[0-9]+$/g,isFloat:/^[-+]?[0-9]+(\.{1}[0-9]*)?$/g,camelCase:/-\D/g,hyphenate:/\w[A-Z]/g,capitalise:/\b[a-z]/g,clean:/\s{2,}/g,strip:/\s/g,rgbToHex:/\d{1,3}/g,hexToRgb:/^#?(\w{1,2})(\w{1,2})(\w{1,2})$/,escapeRegExp:/([.*+?^${}()|[\]\/\\])/g,trimLeft:/^\s+/,trimRight:/\s+$/,stripTags:/<\/?[^>]+>/gi,stripScripts:/<script[^>]*?>.*?<\/script>/img,stripScriptsFirst:/^<script[^>]*?>/,stripScriptsSecond:/<\/script>$/,stripStyles:/<style[^>]*?>.*?<\/style>/img,smartObjectCharacterReplacement:/\W/g,isAmpersand:/&/g,isQuote:/"/g,isApostrophe:/'/g,isLessThan:/</g,isGreaterThan:/>/g,isEncodedAmpersand:/&amp;/g,isEncodedQuote:/&quot;/g,isEncodedApostrophe:/&(apos|#39);/g,isEncodedLessThan:/&lt;/g,isEncodedGreaterThan:/&gt;/g,isBackslash:/\\/g,isDoubleBackslash:/\\\\/g,htmlSpecial:/[&"'<>]/g,xmlSpecial:/[&"'<>]/g,xpathSpecial:/'/g,selectorSpecial:/([!"#$%&'()*+,\./:;<=>?@\[\\\]^`{|}~ ])/g,hasApostrophe:/'/g,hasEncodedEntities:/&(amp|quot|lt|gt|#[0-9]+|apos);/g,spacesBetweenTags:/>[ \t\r\n\v\f]*</g,tidy:{spaces:/[\xa0\u2002\u2003\u2009]/g,star:/\xb7/g,invertedcomma1:/[\u2018\u2019]/g,invertedcomma2:/[\u201c\u201d]/g,ellipsis:/\u2026/g,hyphen:/\u2013/g,doublehyphen:/\u2013/g},unitDimention:/%|px/gi,properObjectName:{View:/\bview\b/gi,Form:/\bform\b/gi,SmartObject:/\bsmartobject\b/gi,Workflow:/\bworkflow\b/gi,Views:/\bviews\b/gi,Forms:/\bforms\b/gi,SmartObjects:/\bsmartobjects\b/gi,Workflows:/\bworkflows\b/gi},init:function(){isAmpersand.compile();isQuote.compile();isApostrophe.compile();isLessThan.compile();isGreaterThan.compile();isEncodedAmpersand.compile();isEncodedQuote.compile();isEncodedApostrophe.compile();isEncodedLessThan.compile();isEncodedGreaterThan.compile();htmlSpecial.compile();xmlSpecial.compile();hasEncodedEntities.compile();spacesBetweenTags.compile()}};jQuery.extend(String.prototype,_stringPrototype);jQuery.extend(String,_stringPrototype);
/*!
 ~/Script/native.Forms.number.js
*/
var _numberPrototype={toInt:function(){return parseInt(this)},toFloat:function(){return parseFloat(this)},limit:function(n,t){return Math.min(t,Math.max(n,this))},round:function(n){return n=Math.pow(10,n||0),Math.round(this*n)/n},times:function(n){for(var t=0;t<this;t++)n(t)},between:function(n,t){return n>t?this>=t&&this<=n:this>=n&&this<=t},zeroise:function(n){return String(this).zeroise(n)}};jQuery.extend(Number.prototype,_numberPrototype);jQuery.extend(Number,_numberPrototype);
/*!
 ~/Script/native.Forms.hash.js
*/
function Hash(n){this.init(n)}var HashObject={length:0,init:function(n){this.obj=n||{};this.setLength()},get:function(n){return this.hasKey(n)?this.obj[n]:null},hasKey:function(n){return n in this.obj},set:function(n,t){return this.hasKey(n)||this.length++,this.obj[n]=t,this},setLength:function(){this.length=0;for(var n in this.obj)this.length++;return this},remove:function(n){return this.hasKey(n)&&(delete this.obj[n],this.length--),this},empty:function(){return this.obj={},this.length=0,this},keys:function(){var n=[];for(var t in this.obj)n.push(t);return n},values:function(){var n=[];for(var t in this.obj)n.push(this.obj[t]);return n}};jQuery.extend(Hash.prototype,HashObject);
/*!
 ~/Script/native.Forms.date.js
*/
(function(){Date.prototype.clone||(Date.prototype.clone=function(){return new Date(this.getTime())});Date.prototype.clearTime||(Date.prototype.clearTime=function(){return this.setHours(0),this.setMinutes(0),this.setSeconds(0),this.setMilliseconds(0),this});Date.prototype.fractionalDifference||(Date.prototype.fractionalDifference=function(n,t){$type(n)=="string"&&(n=Date.parse(n));checkExists(t)||(t="day");t=SourceCode.Forms.DateHelper.getResolutionIdentifier(t);var q=0,r=0;if(t==="year"||t==="month"){var s=new Big(n.getFullYear()),h=new Big(this.getFullYear()),f=new Big(n.getMonth()),e=new Big(this.getMonth()),u=f.eq(1)&&n.getDate()===Date.daysInMonth(f,s)?new Big(30):new Big(n.getDate()),o=e.eq(1)&&this.getDate()===Date.daysInMonth(e,h)?new Big(30):new Big(this.getDate());o.eq(31)&&u.lt(29)&&(o=new Big(30));u.eq(31)&&(u=new Big(30));q=h.minus(s).times(360).plus(e.minus(f).times(30)).plus(o.minus(u));r=t==="year"?q.div(360):q.div(30)}else{q=new Big(this.difference(n,"day"));var c=n.getHours()*SourceCode.Forms.DateHelper.units.hour+n.getMinutes()*SourceCode.Forms.DateHelper.units.minute+n.getSeconds()*SourceCode.Forms.DateHelper.units.second+n.getMilliseconds(),l=this.getHours()*SourceCode.Forms.DateHelper.units.hour+this.getMinutes()*SourceCode.Forms.DateHelper.units.minute+this.getSeconds()*SourceCode.Forms.DateHelper.units.second+this.getMilliseconds();if(t==="day"){var a=new Big(l-c).div(SourceCode.Forms.DateHelper.units.day);r=a.plus(q)}else r=q.times(SourceCode.Forms.DateHelper.units.day).plus(new Big(l-c)).div(SourceCode.Forms.DateHelper.units[t])}return r});Date.prototype.difference||(Date.prototype.difference=function(n,t){$type(n)=="string"&&(n=Date.parse(n));var r=this.getFullYear()-n.getFullYear(),u=this.getMonth()-n.getMonth(),q=0;t=SourceCode.Forms.DateHelper.getResolutionIdentifier(t);switch(t){case"year":q=r;break;case"month":q=r*12+u;break;case"day":q=SourceCode.Forms.DateHelper.getDayDifferenceBetweenTwoDates(this,n)}return q});Date.prototype.getOrdinal||(Date.prototype.getOrdinal=function(){var n=this.toString(),t=n.substr(-Math.min(n.length,2));return t>3&&t<21?"th":["th","st","nd","rd","th"][Math.min(this%10,4)]});Date.prototype.getDayOfYear||(Date.prototype.getDayOfYear=function(){return(Date.UTC(this.getFullYear(),this.getMonth(),this.getDate()+1,0,0,0)-Date.UTC(this.getFullYear(),0,1,0,0,0))/SourceCode.Forms.DateHelper.units.day});Date.prototype.lastDayofMonth||(Date.prototype.lastDayofMonth=function(){var n=this.clone();return n.setMonth(n.getMonth()+1,0),n.getDate()});Date.prototype.getWeek||(Date.prototype.getWeek=function(n){if(checkExists(SourceCode.Forms.Settings)&&checkExists(SourceCode.Forms.Settings.Compatibility)&&checkExists(SourceCode.Forms.Settings.Compatibility.DateWeekNumberLegacyLogic)&&SourceCode.Forms.Settings.Compatibility.DateWeekNumberLegacyLogic){var t=new Date(this.getFullYear(),0,1).getDate();return Math.round((this.getDayOfYear()+(t>3?t-4:t+3))/7)}return n=n||0,Math.ceil((this.getDayOfYear()+new Date(this.getFullYear(),0,1).getDay()-n)/7)});Date.prototype.getTimezone||(Date.prototype.getTimezone=function(){return console.warn("getTimezone has been deprecated"),this.toString().replace(/^.*? ([A-Z]{3}).[0-9]{4}.*$/,"$1").replace(/^.*?\(([A-Z])[a-z]+ ([A-Z])[a-z]+ ([A-Z])[a-z]+\)$/,"$1$2$3")});Date.prototype.getGMTOffset||(Date.prototype.getGMTOffset=function(){console.warn("getGMTOffset has been deprecated");var n=this.getTimezoneOffset();return(n>0?"-":"+")+Math.floor(Math.abs(n)/60).zeroise(2)+(n%60).zeroise(2)});Date.prototype.isLeapYear||(Date.prototype.isLeapYear=function(){return Date.isLeapYear(this.getYear())});Date.prototype.daysInMonth||(Date.prototype.daysInMonth=function(){return Date.daysInMonth(this.getMonth(),this.getYear())});Date.prototype.setSafeUTCMonth||(Date.prototype.setSafeUTCMonth=function(n,t){var r=this.getUTCFullYear();n=parseInt(n);var u=Date.daysInMonth(n,r),q=checkExists(t)?parseInt(t):this.getUTCDate();q>u-1&&(q=u-1);var f=Date.UTC(r,n,q,this.getUTCHours(),this.getUTCMinutes(),this.getUTCSeconds(),this.getUTCMilliseconds());this.setTime(f)});Date.prototype.setSafeUTCFullYear||(Date.prototype.setSafeUTCFullYear=function(n,t,q){n=parseInt(n);var u=checkExists(t)?parseInt(t):this.getUTCMonth(),f=Date.daysInMonth(u,n),r=checkExists(q)?parseInt(q):this.getUTCDate();r>f-1&&(r=f-1);var e=Date.UTC(n,u,r,this.getUTCHours(),this.getUTCMinutes(),this.getUTCSeconds(),this.getUTCMilliseconds());this.setTime(e)});Date.prototype.setSafeMonth||(Date.prototype.setSafeMonth=function(n,t){var f=this.getTimeZoneOffset(),e=this.getFullYear();n=parseInt(n);var r=Date.daysInMonth(n,e),q=checkExists(t)?parseInt(t):this.getDate();q>r&&(q=r);this.setDate(1);this.setMonth(n);this.setDate(q);var u=this.getTimeZoneOffset()-f;return u!==0&&this.setTime(this.getTime()+u*6e4),this});Date.prototype.setSafeFullYear||(Date.prototype.setSafeFullYear=function(n,t,q){var e=this.getTimeZoneOffset();n=parseInt(n);var o=checkExists(t)?parseInt(t):this.getMonth(),u=Date.daysInMonth(o,n),r=checkExists(q)?parseInt(q):this.getDate();r>u&&(r=u);this.setDate(1);this.setFullYear(n);this.setMonth(t);this.setDate(r);var f=this.getTimeZoneOffset()-e;return f!==0&&this.setTime(this.getTime()+f*6e4),this});Date.prototype.parse||(Date.prototype.parse=function(n){return this.setTime(Date.parse(n)),this});Date.prototype.clone||(Date.prototype.clone=function(){return new Date(this.getTime())});Date.prototype.increment||(Date.prototype.increment=function(n){var u=this.getTimezoneOffset(),t=this.clone(),e=checkExists(n)?n:1,q=this.getTime()+864e5*e;this.setTime(q);var f=this.getTimezoneOffset();if(u!=f){var r=this.clone(),o=t.getFullYear()==r.getFullYear()&&t.getMonth()==r.getMonth()&&t.getDate()===r.getDate();if(o)q=this.getTime()+(f-u)*6e4,this.setTime(q)}return this});Date.prototype.decrement||(Date.prototype.decrement=function(n){var q=this.getTimezoneOffset(),u=checkExists(n)?n:1,t=this.getTime()-864e5*u;this.setTime(t);var r=this.getTimezoneOffset();if(q!=r)t=this.getTime()+(r-q)*6e4,this.setTime(t);return this});Date.prototype.compare||(Date.prototype.compare=Date.prototype.diff);Date.prototype.strftime||(Date.prototype.strftime=Date.prototype.format);Date.prototype.compareTo||(Date.prototype.compareTo=function(n){if(comparison=this.getTime()>n.getTime(),comparison===!0)comparison=1;else{var t=this.getTime()===n.getTime();comparison=t?0:-1}return comparison});Date.prototype.equals||(Date.prototype.equals=function(n){return this.getTime()===n.getTime()});Date.prototype.getTimeZoneOffset||(Date.prototype.getTimeZoneOffset=function(){return this.getTimezoneOffset()});Date.prototype.convertTime||(Date.prototype.convertTime=function(){var n=this.getTimeZoneOffset();this.setTime(this.getTime()+n*6e4);var t=this.getTimeZoneOffset()-n;t!==0&&this.setTime(this.getTime()+t*6e4)});Date.prototype.getLocalTime||(Date.prototype.getLocalTime=function(){return this.getTime()-this.getTimeZoneOffset()*SourceCode.Forms.DateHelper.units.minute});Date.$months=["January","February","March","April","May","June","July","August","September","October","November","December"];Date.$days=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];Date.$daysInMonth=[31,28,31,30,31,30,31,31,30,31,30,31];Date.$epoch=-1;Date.$era=-2;Date.$formats={db:"%Y-%m-%d %H:%M:%S",iso8601:"%Y-%m-%dT%H:%M:%S%T",rfc822:"%a, %d %b %Y %H:%M:%S %Z",short:"%d %b %H:%M",long:"%B %d, %Y %H:%M"};Date.isLeapYear=function(n){return n%400==0?!0:n%100==0?!1:n%4==0?!0:!1};Date.daysInMonth=function(n,t){return(n=(n+12)%12,n===1&&Date.isLeapYear(t))?29:Date.$daysInMonth[n]};Date.parseMonth=function(n,t){var q=-1;switch($type(n)){case"object":q=Date.$months[n.getMonth()];break;case"number":if(q=Date.$months[n-1]||!1,!q)throw new Error("Invalid month index value must be between 1 and 12:"+index);break;case"string":var r=Date.$months.filter(function(n){return this.test(n)},new RegExp("^"+n,"i"));if(!r.length)throw new Error("Invalid month string");if(r.length>1)throw new Error("Ambiguous month");q=r[0]}return t?Date.$months.indexOf(q):q};Date.parseDay=function(n,t){var q=-1;switch($type(n)){case"number":if(q=Date.$days[n-1]||!1,!q)throw new Error("Invalid day index value must be between 1 and 7");break;case"string":var r=Date.$days.filter(function(n){return this.test(n)},new RegExp("^"+n,"i"));if(!r.length)throw new Error("Invalid day string");if(r.length>1)throw new Error("Ambiguous day");q=r[0]}return t?Date.$days.indexOf(q):q};Date.$parsePatterns=[{re:/^(\d{4})(?:-?(\d{2})(?:-?(\d{2})(?:[T ](\d{2})(?::?(\d{2})(?::?(\d{2})(?:\.(\d+))?)?)?(?:Z|(?:([-+])(\d{2})(?::?(\d{2}))?)?)?)?)?)?$/,handler:function(n){var q=0,t=new Date(n[1],0,1);return n[2]&&t.setMonth(n[2]-1),n[3]&&t.setDate(n[3]),n[4]&&t.setHours(n[4]),n[5]&&t.setMinutes(n[5]),n[6]&&t.setSeconds(n[6]),n[7]&&t.setMilliseconds(("0."+n[7]).toInt()*1e3),n[9]&&(q=(n[9].toInt()*60+n[10].toInt())*(n[8]=="-"?1:-1)),q-=t.getTimezoneOffset(),t.setTime(t*1+(q*6e4).toInt()),t}},{re:/^tod/i,handler:function(){return new Date}},{re:/^tom/i,handler:function(){var n=new Date;return n.setDate(n.getDate()+1),n}},{re:/^yes/i,handler:function(){var n=new Date;return n.setDate(n.getDate()-1),n}},{re:/^(\d{1,2})(st|nd|rd|th)?$/i,handler:function(n){var t=new Date;return t.setDate(n[1].toInt()),t}},{re:/^(\d{1,2})(?:st|nd|rd|th)? (\w+)$/i,handler:function(n){var t=new Date;return t.setMonth(Date.parseMonth(n[2],!0),n[1].toInt()),t}},{re:/^(\d{1,2})(?:st|nd|rd|th)? (\w+),? (\d{4})$/i,handler:function(n){var t=new Date;return t.setMonth(Date.parseMonth(n[2],!0),n[1].toInt()),t.setYear(n[3]),t}},{re:/^(\w+) (\d{1,2})(?:st|nd|rd|th)?,? (\d{4})$/i,handler:function(n){var t=new Date;return t.setMonth(Date.parseMonth(n[1],!0),n[2].toInt()),t.setYear(n[3]),t}},{re:/^next (\w+)$/i,handler:function(n){var t=new Date,q=t.getDay(),r=Date.parseDay(n[1],!0),u=r-q;return r<=q&&(u+=7),t.setDate(t.getDate()+u),t}},{re:/^last (\w+)$/i,handler:function(){throw new Error("Not yet implemented");}}];Date.fromSFDateAndSFTime=function(n,t){return new Date(n.getFullYear(),n.getMonth(),n.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds())};Date.fromSFDateAndSFTimeUTC=function(n,t){return new Date(Date.UTC(n.getFullYear(),n.getMonth(),n.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()))};Date.fromSFDate=function(n){return new Date(n.getFullYear(),n.getMonth(),n.getDate())};Date.fromSFDateUTC=function(n){return new Date(Date.UTC(n.getFullYear(),n.getMonth(),n.getDate()))};Date.fromSFTime=function(n){return new Date(0,0,0,n.getHours(),n.getMinutes(),n.getSeconds(),n.getMilliseconds())};Date.fromCurrentDateWithSFTime=function(n){var t=new Date;return new Date(t.getFullYear(),t.getMonth(),t.getDate(),n.getHours(),n.getMinutes(),n.getSeconds(),n.getMilliseconds())};Date.fromSFTimeUTC=function(n){return new Date(Date.UTC(0,0,0,n.getHours(),n.getMinutes(),n.getSeconds(),n.getMilliseconds()))};typeof Date.$nativeParse=="undefined"&&(Date.$nativeParse=Date.parse);Date.parse=function(n){var q=$type(n);if(q=="number")return new Date(str);if(q!="string")return n;if(!n.length)return null;for(var t=0,u=Date.$parsePatterns.length;t<u;t++){var r=Date.$parsePatterns[t].re.exec(n);if(r)return Date.$parsePatterns[t].handler(r)}return new Date(Date.$nativeParse(n))}})(jQuery);
/*!
 ~/Script/native.Forms.array.js
*/
Array.prototype.indexOf||(Array.prototype.indexOf=function(n){"use strict";if(this===void 0||this===null)throw new TypeError;var u=Object(this),r=u.length>>>0;if(r===0)return-1;var t=0;if(arguments.length>0&&(t=Number(arguments[1]),t!==t?t=0:t!==0&&t!==1/0&&t!==-(1/0)&&(t=(t>0||-1)*Math.floor(Math.abs(t)))),t>=r)return-1;for(var q=t>=0?t:Math.max(r-Math.abs(t),0);q<r;q++)if(q in u&&u[q]===n)return q;return-1});Array.prototype.filter||(Array.prototype.filter=function(n){"use strict";if(this===void 0||this===null)throw new TypeError;var q=Object(this),f=q.length>>>0;if(typeof n!="function")throw new TypeError;for(var r=[],e=arguments[1],t=0;t<f;t++)if(t in q){var u=q[t];n.call(e,u,t,q)&&r.push(u)}return r});Array.prototype.reduce||(Array.prototype.reduce=function(n){"use strict";if(this===void 0||this===null)throw new TypeError;var q=Object(this),u=q.length>>>0;if(typeof n!="function")throw new TypeError;if(u==0&&arguments.length==1)throw new TypeError;var t=0,r;if(arguments.length>=2)r=arguments[1];else do{if(t in q){r=q[t++];break}if(++t>=u)throw new TypeError;}while(1);while(t<u)t in q&&(r=n.call(undefined,r,q[t],t,q)),t++;return r});Array.prototype.reduceRight||(Array.prototype.reduceRight=function(n){"use strict";if(this===void 0||this===null)throw new TypeError;var r=Object(this),u=r.length>>>0;if(typeof n!="function")throw new TypeError;if(u===0&&arguments.length===1)throw new TypeError;var t=u-1,q;if(arguments.length>=2)q=arguments[1];else do{if(t in this){q=this[t--];break}if(--t<0)throw new TypeError;}while(1);while(t>=0)t in r&&(q=n.call(undefined,q,r[t],t,r)),t--;return q});Array.prototype.lastIndexOf||(Array.prototype.lastIndexOf=function(n){"use strict";if(this===void 0||this===null)throw new TypeError;var u=Object(this),r=u.length>>>0;if(r===0)return-1;var t=r;arguments.length>1&&(t=Number(arguments[1]),t!==t?t=0:t!==0&&t!==1/0&&t!==-(1/0)&&(t=(t>0||-1)*Math.floor(Math.abs(t))));for(var q=t>=0?Math.min(t,r-1):r-Math.abs(t);q>=0;q--)if(q in u&&u[q]===n)return q;return-1});var _arrayPrototype={remove:function(n){for(var t=0,q=this.length;t<q;)this[t]===n?(this.splice(t,1),q--):t++;return this},removeAt:function(n){for(var t=0,q=this.length;t<q;)if(t===n){this.splice(t,1);q--;break}else t++;return this},contains:function(n,t){return this.indexOf(n,t)!=-1},associate:function(n){for(var q={},r=Math.min(this.length,n.length),t=0;t<r;t++)q[n[t]]=this[t];return q},extend:function(n){for(var t=0,q=n.length;t<q;t++)this.push(n[t]);return this},merge:function(n){for(var t=0,q=n.length;t<q;t++)this.include(n[t]);return this},include:function(n){return this.contains(n)||this.push(n),this},getRandom:function(){return this[$random(0,this.length-1)]||null},getLast:function(){return this[this.length-1]||null},insert:function(n,t){for(var r=[],q=0;q<this.length;q++)q<t?r[q]=this[q]:q==t?(r[q]=n,r[q+1]=this[q]):r[q+1]=this[q];return r},rgbToHex:function(n){if(this.length<3)return!1;if(this.length==4&&this[3]==0&&!n)return"transparent";for(var t=[],q=0;q<3;q++){var r=(this[q]-0).toString(16);t.push(r.length==1?"0"+r:r)}return n?t:"#"+t.join("")},hexToRgb:function(n){if(this.length!=3)return!1;for(var q=[],t=0;t<3;t++)q.push(parseInt(this[t].length==1?this[t]+this[t]:this[t],16));return n?q:"rgb("+q.join(",")+")"}};jQuery.extend(Array.prototype,_arrayPrototype);Array.prototype.test=Array.prototype.contains;Array.prototype.every||(Array.prototype.every=function(n){"use strict";if(this===void 0||this===null)throw new TypeError;var q=Object(this),r=q.length>>>0;if(typeof n!="function")throw new TypeError;for(var u=arguments[1],t=0;t<r;t++)if(t in q&&!n.call(u,q[t],t,q))return!1;return!0});Array.prototype.some||(Array.prototype.some=function(n){"use strict";if(this===null)throw new TypeError("Array.prototype.some called on null or undefined");if(typeof n!="function")throw new TypeError;for(var q=Object(this),r=q.length>>>0,u=arguments.length>=2?arguments[1]:void 0,t=0;t<r;t++)if(t in q&&n.call(u,q[t],t,q))return!0;return!1});
/*!
 ~/Script/big.js
*/
(function(n){"use strict";t.DP=20;t.RM=1;var r=1e6,c=1e6,e=-7,o=21,q=t.prototype,l=/^-?(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,s=new t(1);function t(n){var u,q,f,r=this;if(!(r instanceof t))return new t(n);if(n instanceof t){r.s=n.s;r.e=n.e;r.c=n.c.slice();return}if(n===0&&1/n<0)n="-0";else if(!l.test(n+=""))throw NaN;for(r.s=n.charAt(0)=="-"?(n=n.slice(1),-1):1,(u=n.indexOf("."))>-1&&(n=n.replace(".","")),(q=n.search(/e/i))>0?(u<0&&(u=q),u+=+n.slice(q+1),n=n.substring(0,q)):u<0&&(u=n.length),q=0;n.charAt(q)=="0";q++);if(q==(f=n.length))r.c=[r.e=0];else{for(;n.charAt(--f)=="0";);for(r.e=u-q-1,r.c=[],u=0;q<=f;r.c[u++]=+n.charAt(q++));}}function u(n,t,q,r){var f=n.c,u=n.e+t+1;if(q===1)r=f[u]>=5;else if(q===2)r=f[u]>5||f[u]==5&&(r||u<0||f[u+1]!=null||f[u-1]&1);else if(q===3)r=r||f[u]!=null||u<0;else if(r=!1,q!==0)throw"!Big.RM!";if(u<1||!f[0])n.c=r?(n.e=-t,[1]):[n.e=0];else{if(f.length=u--,r)for(;++f[u]>9;)f[u]=0,u--||(++n.e,f.unshift(1));for(u=f.length;!f[--u];f.pop());}return n}function f(n,q){var s,e=n.c,o=(q=new t(q)).c,r=n.s,h=q.s,u=n.e,f=q.e;if(!e[0]||!o[0])return e[0]?r:o[0]?-h:0;if(r!=h)return r;if(s=r<0,u!=f)return u>f^s?1:-1;for(r=-1,h=(u=e.length)<(f=o.length)?u:f;++r<h;)if(e[r]!=o[r])return e[r]>o[r]^s?1:-1;return u==f?0:u>f^s?1:-1}q.abs=function(){var n=new t(this);return n.s=1,n};q.div=function(n){var w=this,c=w.c,o=(n=new t(n)).c,y=w.s==n.s?1:-1,l=t.DP;if(l!==~~l||l<0||l>r)throw"!Big.DP!";if(!c[0]||!o[0]){if(c[0]==o[0])throw NaN;if(!o[0])throw y/0;return new t(y*0)}var h,b,p,a,e,tt=o.slice(),k=h=o.length,qt=c.length,q=c.slice(0,h),f=q.length,v=new t(s),d=v.c=[],g=0,nt=l+(v.e=w.e-n.e)+1;for(v.s=y,y=nt<0?0:nt,tt.unshift(0);f++<h;q.push(0));do{for(p=0;p<10;p++){if(h!=(f=q.length))a=h>f?1:-1;else for(e=-1,a=0;++e<h;)if(o[e]!=q[e]){a=o[e]>q[e]?1:-1;break}if(a<0){for(b=f==h?o:tt;f;){if(q[--f]<b[f]){for(e=f;e&&!q[--e];q[e]=9);--q[e];q[f]+=10}q[f]-=b[f]}for(;!q[0];q.shift());}else break}d[g++]=a?p:++p;q[0]&&a?q[f]=c[k]||0:q=[c[k]]}while((k++<qt||q[0]!=null)&&y--);return d[0]||g==1||(d.shift(),v.e--),g>nt&&u(v,l,t.RM,q[0]!=null),v};q.eq=function(n){return!f(this,n)};q.gt=function(n){return f(this,n)>0};q.gte=function(n){return f(this,n)>-1};q.lt=function(n){return f(this,n)<0};q.lte=function(n){return f(this,n)<1};q.minus=function(n){var e,o,s,l,h=this,f=h.s,r=(n=new t(n)).s;if(f!=r)return n.s=-r,h.plus(n);var q=h.c.slice(),a=h.e,u=n.c,c=n.e;if(!q[0]||!u[0])return u[0]?(n.s=-r,n):new t(q[0]?h:0);if(f=a-c){for(e=(l=f<0)?(f=-f,q):(c=a,u),e.reverse(),r=f;r--;e.push(0));e.reverse()}else for(s=((l=q.length<u.length)?q:u).length,f=r=0;r<s;r++)if(q[r]!=u[r]){l=q[r]<u[r];break}if(l&&(e=q,q=u,u=e,n.s=-n.s),(r=-((s=q.length)-u.length))>0)for(;r--;q[s++]=0);for(r=u.length;r>f;){if(q[--r]<u[r]){for(o=r;o&&!q[--o];q[o]=9);--q[o];q[r]+=10}q[r]-=u[r]}for(;q[--s]==0;q.pop());for(;q[0]==0;q.shift(),--c);return q[0]||(q=[c=0]),n.c=q,n.e=c,n};q.mod=function(n){n=new t(n);var e,q=this,r=q.s,u=n.s;if(!n.c[0])throw NaN;return q.s=n.s=1,e=f(n,q)==1,q.s=r,n.s=u,e?new t(q):(r=t.DP,u=t.RM,t.DP=t.RM=0,q=q.div(n),t.DP=r,t.RM=u,this.minus(q.times(n)))};q.plus=function(n){var e,o=this,r=o.s,f=(n=new t(n)).s;if(r!=f)return n.s=-f,o.minus(n);var h=o.e,q=o.c,s=n.e,u=n.c;if(!q[0]||!u[0])return u[0]?n:new t(q[0]?o:r*0);if(q=q.slice(),r=h-s){for(e=r>0?(s=h,u):(r=-r,q),e.reverse();r--;e.push(0));e.reverse()}for(q.length-u.length<0&&(e=u,u=q,q=e),r=u.length,f=0;r;f=(q[--r]=q[r]+u[r]+f)/10^0,q[r]%=10);for(f&&(q.unshift(f),++s),r=q.length;q[--r]==0;q.pop());return n.c=q,n.e=s,n};q.pow=function(n){var u=n<0,q=new t(this),r=s;if(n!==~~n||n<-c||n>c)throw"!pow!";for(n=u?-n:n;;){if(n&1&&(r=r.times(q)),n>>=1,!n)break;q=q.times(q)}return u?s.div(r):r};q.round=function(n,q){var f=new t(this);if(n==null)n=0;else if(n!==~~n||n<0||n>r)throw"!round!";return u(f,n,q==null?t.RM:q),f};q.sqrt=function(){var f,n,e,r=this,s=r.c,q=r.s,o=r.e,h=new t("0.5");if(!s[0])return new t(r);if(q<0)throw NaN;q=Math.sqrt(r.toString());q==0||q==1/0?(f=s.join(""),f.length+o&1||(f+="0"),n=new t(Math.sqrt(f).toString()),n.e=((o+1)/2|0)-(o<0||o&1)):n=new t(q.toString());q=n.e+(t.DP+=4);do e=n,n=h.times(e.plus(r.div(e)));while(e.c.slice(0,q).join("")!==n.c.slice(0,q).join(""));return u(n,t.DP-=4,t.RM),n};q.times=function(n){var q,h=this,e=h.c,o=(n=new t(n)).c,s=e.length,r=o.length,f=h.e,u=n.e;if(n.s=h.s==n.s?1:-1,!e[0]||!o[0])return new t(n.s*0);for(n.e=f+u,s<r&&(q=e,e=o,o=q,u=s,s=r,r=u),u=s+r,q=[];u--;q.push(0));for(f=r-1;f>-1;f--){for(r=0,u=s+f;u>f;r=q[u]+o[f]*e[u-f-1]+r,q[u--]=r%10|0,r=r/10|0);r&&(q[u]=(q[u]+r)%10)}for(r&&++n.e,q[0]||q.shift(),u=q.length;!q[--u];q.pop());return n.c=q,n};q.toString=q.valueOf=function(){var r=this,t=r.e,n=r.c.join(""),q=n.length;if(t<=e||t>=o)n=n.charAt(0)+(q>1?"."+n.slice(1):"")+(t<0?"e":"e+")+t;else if(t<0){for(;++t;n="0"+n);n="0."+n}else if(t>0)if(++t>q)for(t-=q;t--;n+="0");else t<q&&(n=n.slice(0,t)+"."+n.slice(t));else q>1&&(n=n.charAt(0)+"."+n.slice(1));return r.s<0&&r.c[0]?"-"+n:n};q.isWhole=function(){var n=this;return n.e>0&&n.c.length==n.e+1};q.negate=function(){var n=new t(this);return n.s=n.s==-1?1:-1,n};q.floor=function(n){var q=new t(this);if(n==null)n=0;else if(n!==~~n||n<0||n>r)throw"!floor!";return u(q,n,0),q};q.ceiling=q.ceil=function(n){var q=new t(this),f=q.c,e=new t(q);if(n==null)n=0;else if(n!==~~n||n<0||n>r)throw"!round!";return u(q,n,3),q};q.toInt=function(){return parseInt(new t(this).round(0))};q.toFloat=function(){return parseFloat(new t(this))};function h(n,q,r){var f=q-(n=new t(n)).e,o=n.c;for(o.length>++q&&u(n,f,t.RM),f=o[0]?r?q:(o=n.c,n.e+f+1):f+1;o.length<f;o.push(0));return f=n.e,r==1||r==2&&(q<=f||f<=e)?(n.s<0&&o[0]?"-":"")+(o.length>1?(o.splice(1,0,"."),o.join("")):o[0])+(f<0?"e":"e+")+f:n.toString()}q.toExponential=function(n){if(n==null)n=this.c.length-1;else if(n!==~~n||n<0||n>r)throw"!toExp!";return h(this,n,1)};q.toFixed=function(n){var t,q=this,u=e,f=o;if(e=-(o=1/0),n==null?t=q.toString():n===~~n&&n>=0&&n<=r&&(t=h(q,q.e+n),q.s<0&&q.c[0]&&t.indexOf("-")<0&&(t="-"+t)),e=u,o=f,!t)throw"!toFix!";return t};q.toPrecision=function(n){if(n==null)return this.toString();if(n!==~~n||n<1||n>r)throw"!toPre!";return h(this,n-1,2)};typeof module!="undefined"&&module.exports?module.exports=t:typeof define=="function"&&define.amd?define(function(){return t}):n.Big=t})(this);
/*!
 ~/Script/Types/SourceCode.Forms.Types.Mappings.js
*/
var SourceCode=SourceCode||{};SourceCode.Forms=SourceCode.Forms||{};SourceCode.Forms.Types=SourceCode.Forms.Types||{},function(){var n=SourceCode.Forms.Types;n.Mappings=function(t){if(this.mappings=[],Array.isArray(t))for(var q=0;q<t.length;q++)this.mappings.push(new n.Mapping(t[q]));else this.mappings.push(new n.Mapping(t));return this};n.Mappings.prototype.addMapping=function(t){t instanceof n.Mapping?this.mappings.push(t):this.mappings.push(new n.Mapping(t))};n.Mappings.prototype.fromMappingsXml=function(t){for(var r=t.selectNodes("Mapping"),q=0;q<r.length;q++){var u=r[q],f=u.selectSingleNode("Item[@ContextType='context']"),e=u.selectSingleNode("Item[@ContextType='target']");this.addMapping(new n.Mapping({context:(new n.MappingContext).fromMappingContextXml(f),target:(new n.MappingTarget).fromMappingTargetXml(e)}))}return this};n.Mappings.prototype.getArray=function(){return this.mappings};n.Mapping=function(t){return this.isSelected=!1,t&&(this.context=new n.MappingContext(t.context),this.target=new n.MappingTarget(t.target),this.isSelected=t.isSelected),this};n.Mapping.prototype.fromMappingXml=function(t){if(checkExists(t)){this.context={};this.target={};this.isSelected=!1;var q=t.selectSingleNode("Item[@ContextType='context']"),r=t.selectSingleNode("Item[@ContextType='target']");return checkExists(q)&&(this.context=(new n.MappingContext).fromMappingContextXml(q)),checkExists(r)&&(this.target=(new n.MappingTarget).fromMappingTargetXml(r)),this.context||this.target?this:null}return null};n.MappingTarget=function(n){return n=n||{},this.guid=n.guid,this.contextType="target",this.instanceId=n.instanceId||"00000000-0000-0000-0000-000000000000",this.itemType=n.itemType||"",this.subformId=n.subformId||"",this.targetPath=n.targetPath||"",this.validationStatus=n.validationStatus||"",this.validationMessages=n.validationMessages||"",this};n.MappingTarget.prototype.fromMappingTargetXml=function(n){if(this.contextType=n.getAttribute("ContextType"),this.contextType!=="target")throw"trying to create target with a context type that is not target: "+n.xml;return this.guid=n.getAttribute("Guid"),this.instanceId=n.getAttribute("InstanceID"),this.itemType=n.getAttribute("ItemType"),this.subformId=n.getAttribute("SubformID"),this.targetPath=n.getAttribute("TargetPath"),this.validationStatus=n.getAttribute("ValidationStatus"),this.validationMessages=n.getAttribute("ValidationMessages"),this};n.MappingContext=function(n){return n=n||{},this.guid=n.guid,this.contextType="context",this.instanceId=n.instanceId||"00000000-0000-0000-0000-000000000000",this.itemType=n.itemType||"",this.subformId=n.subformId||"",this.validationStatus=n.validationStatus||"",this.validationMessages=n.validationMessages||"",this};n.MappingContext.prototype.fromMappingContextXml=function(n){if(this.contextType=n.getAttribute("ContextType"),this.contextType!=="context")throw"trying to create context with a context type that is not context: "+n.xml;return this.guid=n.getAttribute("Guid"),this.instanceId=n.getAttribute("InstanceID"),this.itemType=n.getAttribute("ItemType"),this.subformId=n.getAttribute("SubformID"),this.targetPath=n.getAttribute("TargetPath"),this.validationStatus=n.getAttribute("ValidationStatus"),this.validationMessages=n.getAttribute("ValidationMessages"),this}}();
/*!
 ~/Script/Types/SourceCode.Forms.Types.RuleMappingTargetItems.js
*/
var SourceCode=SourceCode||{};SourceCode.Forms=SourceCode.Forms||{};SourceCode.Forms.Types=SourceCode.Forms.Types||{},function(){var n=SourceCode.Forms.Types;n.RuleMappingTargetItems=function(n){return this.mappingItems={},n&&this.addItem(n),this};n.RuleMappingTargetItems.prototype.addItem=function(t,q){if(!checkExistsNotEmpty(q))for(q=0;this.mappingItems.hasOwnProperty(q);)q++;return this.mappingItems[q]=t instanceof n.RuleMappingTargetItem?t:new n.RuleMappingTargetItem(t),this.mappingItems[q]};n.RuleMappingTargetItems.prototype.findItemByKey=function(n){return this.mappingItems[n]};n.RuleMappingTargetItems.prototype.findItem=function(n){return findObjectInArrayMatchingAll({queryObject:n,targetObject:this.mappingItems,splitQueryObjectDelimiter:",",sourcePropertiesContainMultipleValues:!0})};n.RuleMappingTargetItems.prototype.findItems=function(n){return findObjectInArrayMatchingAll({queryObject:n,targetObject:this.mappingItems,matchMultiple:!0,splitQueryObjectDelimiter:",",sourcePropertiesContainMultipleValues:!0})};n.RuleMappingTargetItems.prototype.length=function(){return Object.getOwnPropertyNames(this.mappingItems).length};n.RuleMappingTargetItems.prototype.getArray=function(){var n=[];for(prop in this.mappingItems)this.mappingItems.hasOwnProperty(prop)&&n.push(this.mappingItems[prop]);return n};n.RuleMappingTargetItems.prototype.foreach=function(n,t){if(n instanceof Function)for(var r=Object.getOwnPropertyNames(this.mappingItems),q=0;q<r.length;q++)checkExists(t)?n.apply(t,[this.mappingItems[r[q]]]):n(this.mappingItems[r[q]])};n.RuleMappingTargetItem=function(t){return t=t||{},this.guid=t.guid||"",this.targetId=t.targetId||null,this.targetPath=t.targetPath||null,this.icon=t.icon||"",this.itemType=t.itemType||"",this.name=t.name||"",this.displayName=t.displayName||this.name,this.description=t.description||null,this.dataType=t.dataType||null,this.instanceId=t.instanceId||"00000000-0000-0000-0000-000000000000",this.subformInstanceId=t.subformInstanceId||"00000000-0000-0000-0000-000000000000",this.subformId=t.subformId||"00000000-0000-0000-0000-000000000000",this.subType=t.subType||null,this.watermarkText=t.watermarkText||"",this.tooltip=t.tooltip||"",this.soGuid=t.soGuid||null,this.fieldObject=t.fieldObject||null,this.controlField=t.controlField||null,this.value=t.value||null,this.text=t.text||null,this.actionPropertyCollection=t.actionPropertyCollection||null,this.required=t.required||null,this.grouping=t.grouping||null,this.visibility=t.visibility||null,this.readonly=t.readonly||null,this.renderInputAs=t.renderInputAs||"tokenbox",this.renderLabelAs=t.renderLabelAs||"checkbox",this.accept=t.accept||null,this.allowTextInput=t.allowTextInput||!0,this.toBeProcessed=t.toBeProcessed||!1,this.isMapping=t.isMapping||!1,this.isReadOnly=t.isReadOnly||!1,this.isInvalid=t.isInvalid||!1,this.isChecked=t.isChecked||!1,this.isRequired=t.isRequired||!1,this.listItemElem=t.listItemElem||null,this.parentListItemElem=t.parentListItemElem||null,this.parentRuleMappingTargetItem=t.parentRuleMappingTargetItem||null,this.tokenboxElem=t.tokenboxElem||null,this.checkboxElem=t.checkboxElem||null,this.itemXmlNode=t.itemXmlNode||null,this.mappingXmlNode=t.mappingXmlNode||null,this.level=t.level||null,this.renderEnhancedSubType=t.renderEnhancedSubType||!1,this.mappings=t.mappings||[],this.childItems=new n.RuleMappingTargetItems,this};var t={},f={populateFromItemXml:function(n){this.itemXmlNode=n;for(var q=0;q<n.attributes.length;q++){var r=n.attributes.item(q),f=r.name.toUpperCase();t.hasOwnProperty(f)&&checkExistsNotEmpty(r.value)&&(this[t[f]]=r.value)}for(var q=0;q<n.childNodes.length;q++){var u=n.childNodes.item(q),e=u.nodeName.toUpperCase();t.hasOwnProperty(e)&&checkExistsNotEmpty(u.text)&&(this[t[e]]=u.text)}return checkExistsNotEmpty(this.displayName)||(checkExists(this.text)?this.displayName=this.text:checkExists(this.value)?this.displayName=this.value:checkExistsNotEmpty(this.name)&&(this.displayName=this.name)),this}};jQuery.extend(n.RuleMappingTargetItem.prototype,f);for(var r=Object.getOwnPropertyNames(new n.RuleMappingTargetItem),q=0;q<r.length;q++){var u=r[q];t[u.toUpperCase()]=u}}(jQuery);
/*!
 ~/Script/Types/SourceCode.Forms.Types.SmartForm.js
*/
var SourceCode=SourceCode||{};SourceCode.Forms=SourceCode.Forms||{};SourceCode.Forms.Types=SourceCode.Forms.Types||{},function(){var n=SourceCode.Forms.Types,t=SourceCode.Forms.TypeHelper,q={version:14};n.SmartForm=function(u){return r(u),this.views=new n.Collection({key:"id",name:"Views",itemType:n.View}),typeof u=="number"?this.version=u:(checkExists(u)&&t.addToCollection("views",u,this),t.setObjProperties(this,q,u)),this};function r(){!1&&t.handlePropertyError({message:"Error message about which property is missing"})}$.extend(n.SmartForm.prototype,{toXml:function(){var n="<SmartForm Version='{0}'>".format(this.version.toString());return n+=this.views.toXml(),n+"<\/SmartForm>"}})}();
/*!
 ~/Script/Types/SourceCode.Forms.Types.SmartObject.js
*/
var SourceCode=SourceCode||{};SourceCode.Forms=SourceCode.Forms||{};SourceCode.Forms.Types=SourceCode.Forms.Types||{},function(){var n=SourceCode.Forms.Types,t=SourceCode.Forms.TypeHelper;(function(){var t=SourceCode.Forms.Types,n=SourceCode.Forms.TypeHelper,q={id:"",name:"",displayName:"",validationStatus:"",validationMessages:"",itemType:"Object",subType:"User",mode:"simple",description:"",defaultListMethod:"getList"};SourceCode.Forms.Types.SmartObject=function(u){return u=u||{},r(u),this.objectProperties=new t.Collection({key:"name",name:"Properties",itemType:SourceCode.Forms.Types.SmartObjectProperty}),this.methods=new t.Collection({key:"name",name:"Methods",itemType:SourceCode.Forms.Types.SmartObjectMethod}),this.associations=new t.Collection({key:"name",name:"Associations",itemType:SourceCode.Forms.Types.SmartObjectAssociation}),n.addToCollection("objectProperties",u,this),n.addToCollection("methods",u,this),n.addToCollection("associations",u,this),n.setObjProperties(this,q,u),this};function r(){}})()}();
/*!
 ~/Script/jquery.Forms.utilities.json.js
*/
(function(n){var r=Object.prototype.hasOwnProperty,u=/function\s{1,}(.{1,})\s{0,}\(/,f=function(n,t){return t},t=function(n){if(n===null)return null;var q=typeof n;if(q==="object"){var t=u.exec(n.constructor.toString());return t&&t.length>1?t[1]:""}return q},q=function(n){for(var q='"',u=0;u<n.length;u++){var r=n.charAt(u);switch(r){case'"':q+='\\"';break;case"\\":q+="\\\\";break;case"\b":q+="\\b";break;case"\f":q+="\\f";break;case"\n":q+="\\n";break;case"\r":q+="\\r";break;case"\t":q+="\\t";break;default:var t=r.charCodeAt(0);q+=t>=0&&t<=31||t===127||t>=128&&t<=159||t===65529||r===65530||r===65531||t===8206||t===8207||t===8234||t===8235||t===8236||t===8237||t===8238?"\\u00"+Math.floor(r/16).toString(16)+(r%16).toString(16):r}}return q+'"'};n.toJSON=typeof JSON=="object"&&typeof JSON.stringify=="function"&&JSON.stringify?JSON.stringify:function(u,e){if((typeof e=="undefined"||e===null)&&(e=f),t(e)==="Array"){var rt=e;e=function(t,q){return t===""||n.inArray(t,rt)>=0?q:undefined}}if(u=e("",u),u===null)return"null";if(typeof u=="undefined")return"";switch(t(u)){case"undefined":return undefined;case"number":return""+u;case"string":return q(u);case"boolean":return u?'"true"':'"false"';case"Date":var v=u.getMonth()+1,y=u.getDate(),ut=u.getFullYear(),p=u.getHours(),w=u.getMinutes(),b=u.getSeconds(),c=u.getMilliseconds(),k=u.getTimezoneOffset(),s=k%60,o=Math.floor((k-s)/60),ft=o<0;return s=Math.abs(s),o=Math.abs(o),v<10&&(v="0"+v),y<10&&(y="0"+y),p<10&&(p="0"+p),w<10&&(w="0"+w),b<10&&(b="0"+b),c<100&&(c="0"+c),c<10&&(c="0"+c),s<10&&(s="0"+s),o<10&&(o="0"+o),k=o<0?"-"+o+":"+s:"+"+o+":"+s,'"'+ut+"-"+v+"-"+y+"T"+p+":"+w+":"+b+"."+c+k+'"';case"Array":for(var l="[",d=0;d<u.length;d++)d>0&&(l+=","),l+=n.toJSON(u[d]);return l+"]";default:if(typeof u.toJSON=="function")return n.toJSON(u.toJSON());var nt=!1,l="{";for(var tt in u)if(r.call(u,tt)){var h=tt,qt=typeof h,a=u[h],g=typeof a;if(qt==="number")h='"'+h+'"';else if(qt==="string")h=q(h);else continue;g!=="function"&&g!=="undefined"&&(a=e(h,a),g!=="function"&&g!=="undefined")&&(a=n.toJSON(a),nt&&(l+=","),nt=!0,l+=h+":"+a)}return l+"}"}}})(jQuery);
/*!
 ~/Script/jquery.Forms.widget.button.js
*/
(function(n){(typeof SourceCode=="undefined"||SourceCode===null)&&(SourceCode={});(typeof SourceCode.Forms=="undefined"||SourceCode.Forms===null)&&(SourceCode.Forms={});(typeof SourceCode.Forms.Widget=="undefined"||SourceCode.Forms.Widget===null)&&(SourceCode.Forms.Widget={});SourceCode.Forms.Widget.Button={types:["help","forward","backward","lookup","finish","cancel","save","clearsearch","filter","leftpaneltoggle","rightpaneltoggle"],buttonStyles:["primary","secondary","normal","icon"],behaviors:["normal","toggle"],_behavior:null,_buttonStyle:null,_toggled:!1,_TOGGLE_STATE_CLASS:"st-toggle-on",_create:function(){var t=this.options;if(this.element&&(n(this.element).hasClass("button")||n(this.element).hasClass("toolbar-button")))this._adoptValues();else{var q=this.element.attr("id");this.element=this.element.replaceWith(this.html(t));this.element.attr("id",q)}if(t.id&&(this.id=t.id),t.disabled&&(this.disabled=t.disabled),t.type&&(this.type=t.type),t.parent&&(this.parent=t.parent),t.container&&n(t.container).append(this.element),t.click&&this.addClickEvent(t.click),!!t.behavior&&t.behavior==="toggle")this.element.on("click",this._click.bind(this));t.toggled===!0&&(this._toggled=!0);this.element.on("click",function(){this.blur()});SourceCode.Forms.Browser.msie&&this.element.attr("onclick","return false;");this.element.on("mousedown",this._mousedown.bind(this));this.element.on("focus",this._focus.bind(this));this.element.on("blur",this._blur.bind(this))},_click:function(){!this.options.behavior||this.options.behavior!=="toggle"||this._change()},_change:function(n){this._toggled=!this._toggled;this._toggled===!0?this.element.addClass(this._TOGGLE_STATE_CLASS):this.element.removeClass(this._TOGGLE_STATE_CLASS);this._trigger("change",n)},_mousedown:function(){this.element.attr("data-mouseevent","true")},_focus:function(){this.element.attr("data-mouseevent")||this.element.addClass("focus")},_blur:function(){this.element.attr("data-mouseevent","");this.element.removeClass("focus")},disable:function(){this.disabled=!0;this.element.hasClass("disabled")||(this.element.addClass("disabled"),this.element.prop("disabled",!0));!this.element.attr("href")||(this.element.attr("data-oldhref",this.element.attr("href")),this.element.removeAttr("href"));this.element.attr("tabIndex","-1")},enable:function(){this.disabled=!1;this.element.hasClass("disabled")&&(this.element.removeClass("disabled"),this.element.prop("disabled",!1));!this.element.attr("data-oldhref")||this.element.attr("href",this.element.attr("data-oldhref"));this.element.removeAttr("tabIndex")},loading:function(){this.element.removeClass("disabled");this.element.addClass("loading")},complete:function(n){var t=this;this.element.addClassTransition("complete",function(){t.element.removeClass("loading complete disabled error");typeof n=="function"&&n()},".button")},error:function(n){var t=this;this.element.addClassTransition("error",function(){t.element.removeClass("loading complete disabled error");typeof n=="function"&&n()},".button")},html:function(t){t||(t=this.options);var r=n("<div><\/div>");r.html("<a class='button' href='javascript:;'><span class=\"button-wrapper\"><span class=\"button-text\">"+(t.text?t.text:"")+"<\/span><\/span><\/a>");var q=r.find("a");if(t.title&&q.attr("title",t.title),t.id&&q.attr("id",t.id),this.types.contains(t.type)&&(this.type=t.type,q.addClass(this.type)),this.buttonStyles.contains(t.buttonstyle)){this._buttonStyle=t.buttonstyle;switch(this._buttonStyle.toLowerCase()){case"primary":q.addClass("buttonstyle-primary");break;case"secondary":q.addClass("buttonstyle-secondary");break;case"icon":q.addClass("buttonstyle-icon")}}if(this.behaviors.contains(t.behavior)){this._behavior=t.behavior;switch(this._behavior.toLowerCase()){case"toggle":q.addClass("toggle-button");t.toggled===!0&&q.addClass(this._TOGGLE_STATE_CLASS)}}return t.enabled||t.enabled!==!1||(t.disabled=!0,q.addClass("disabled")),r.html()},_adoptValues:function(){n(this.element).attr("id")!==""&&(this.options.id=n(this.element).attr("id"));n(this.element).text().trim()!==""&&(this.options.text=n(this.element).text().trim());for(var q=jQuery(this.element)[0].className.split(" "),t=0;t<q.length;t++)if(this.types.contains(q[t])){this.options.type=q[t];break}},isToggledOn:function(){return this._toggled===!0},isToggledOff:function(){return this._toggled===!1},toggle:function(){this.disabled?this.enable():this.disable()},remove:function(){this.element.remove();this.element=null},addClickEvent:function(n){this.element.on("click",n)}};n.widget("ui.k2button",SourceCode.Forms.Widget.Button);n.extend(n.ui.k2button.prototype,{options:{click:null,preserveWidthDuringProgress:!1,enabled:!0,element:null,id:"",disabled:!1,type:"",container:null,title:null}});SourceCode.Forms.Widget.ButtonGroup={alignments:["left","right"],_create:function(){var t=this.options;if(this.id=null,this.buttons=[],this.parent=null,this.element&&n(this.element)?this._adoptValues():this.element.replaceWith(this.html(t)),t.id&&(this.id=t.id),t.alignment&&(this.alignment=t.alignment),t.parent&&(this.parent=t.parent),this.element&&(this.element=n(this.element),t.adoptChildren&&this._adoptChildren()),t.buttons&&t.buttons.length&&t.buttons.length>0)for(var q=0;q<t.buttons.length;q++)this.addButton(t.buttons[q])},html:function(t){var q=n("<div><\/div>");t||(t=this.options?this.options:{});q.html("<div class='button-group'><\/div>");var r=q.find(".button-group");return t.id&&r.attr("id",t.id),this.alignments.contains(t.alignment)&&r.addClass(t.alignment),q.html()},_adoptValues:function(){n(this.element).attr("id")!==""&&(this.options.id=n(this.element).attr("id"));for(var q=n(this.element)[0].className.split(" "),t=0;t<q.length;t++)if(this.alignments.contains(q[t])){this.options.alignment=q[t];break}},_adoptChildren:function(){if(n(this.element).find("a.button").length)for(var q=jQuery(this.element).find("a.button"),t=0;t<q.length;t++)this.addButton(q[t])},addButton:function(t){var q=n(t);this.element.append(q);var r=q.k2button();return this.buttons.push(r),r},addButtonFromOptions:function(t){button=SourceCode.Forms.Widget.Button.html(t);var q=n(button);this.element.append(q);var r=q.k2button(t);return this.buttons.push(r),r},clear:function(){for(var n=0;n<this.buttons.length;n++)this.buttons[n].remove();this.buttons=[]},findButton:function(n){for(var t=0;t<this.buttons.length;t++)if(n===this.buttons[t].k2button("option").id||n===this.buttons[t].element.id)return this.buttons[t];return!1},remove:function(){this.clear();this.element.remove()}};n.widget("ui.buttonGroup",SourceCode.Forms.Widget.ButtonGroup);n.extend(n.ui.buttonGroup.prototype,{options:{alignment:"right",adoptChildren:!0}});SourceCode.Forms.Widget.ButtonBar={_create:function(){var t=this.options;this.id=null;this.buttons=[];this.groups=[];this.element&&n(this.element)?this._adoptValues():this.element.replaceWith(this.html(t));t.id&&(this.id=t.id)},html:function(t){var q=n("<div><\/div>");t||(t=this.options?this.options:{});var r=jQuery("<div class='button-bar'><div class='button-bar-wrapper'><\/div><\/div>");return q.append(r),t.id&&r.attr("id",t.id),q.html()},_adoptValues:function(){jQuery(this.element).attr("id")!==""&&(this.options.id=jQuery(this.element).attr("id"))},_adoptChildren:function(){if(jQuery(this.element).find(".buttons").length)for(var t=jQuery(this.element).find(".buttons"),n=0;n<t.length;n++)this.addButtonGroup(t[n])},addButtonGroup:function(t){var q=n(t);return t.parent=this,this.element.find(".button-bar-wrapper").append(q),q.buttonGroup(),this.groups.push(q),q},addButtonGroupFromOptions:function(n){var t=SourceCode.Forms.Widget.ButtonGroup.html(n);return this.addButtonGroup(t)},findButton:function(n){for(var t=0;t<this.groups.length;t++)if(this.groups[t].buttongroup("findButton",n)!==!1)return this.groups[t].buttongroup("findButton",n);return!1},addButtonFromOptions:function(t){var u=SourceCode.Forms.Widget.Button.html(t),q=n(u);this.element.children().eq(0).append(q);var r=q.k2button(t);return q.k2button("option").parent=this,this.buttons.push(r),r},addButton:function(t){var q=n(t);this.element.children().eq(0).append(q);var r=q.k2button();return q.k2button("option").parent=this,this.buttons.push(r),r},getGroups:function(){return this.groups}};n.widget("ui.buttonBar",SourceCode.Forms.Widget.ButtonBar);n.extend(n.ui.buttonBar.prototype,{options:{adoptChildren:!0}})})(jQuery);
/*!
 ~/Script/jquery.Forms.widget.popupwindow.js
*/
(function(n){(typeof SourceCode=="undefined"||SourceCode===null)&&(SourceCode={});(typeof SourceCode.Forms=="undefined"||SourceCode.Forms===null)&&(SourceCode.Forms={});(typeof SourceCode.Forms.Widget=="undefined"||SourceCode.Forms.Widget===null)&&(SourceCode.Forms.Widget={});var q=SourceCode.Forms.ExceptionHandler;jQuery.popupManager=new t;function t(){this.window=window}t.prototype.getContainer=function(){return typeof this.container=="undefined"&&(this.container=n('<div class="popupManager"><\/div>'),n(document.body).append(this.container)),this.container.parent().css("position")==="relative"&&(this.container.css({position:"absolute",left:"0px",top:"0px",right:"0px",bottom:"0px"}),this.container.css({height:this.container.height()-this.container.offset().top,width:this.container.width()-this.container.offset().left})),this.container};t.prototype._addPopup=function(n){checkExists(this.popUps)||(this.popUps=[]);this.popUps.push(n)};t.prototype._removePopup=function(n){if(checkExists(this.popUps)){var t=this.popUps.indexOf(n);t!==-1&&this.popUps.splice(t,1)}};t.prototype._getLastPopup=function(n){if(checkExists(this.popUps))for(var t=this.popUps.length;t--;){var q=this.popUps[t];if(n(q))return q}};t.prototype.closeLast=function(n){var t=this.getLastOpenPopup();checkExists(t)&&this.closeSpecific(t,n)};t.prototype.closeSpecific=function(t,q){checkExists(t)&&t.isOpen()&&(n("#"+t.id).find("select").each(function(){n(this).isWidget("dropdown")&&n(this).dropdown("hidedropdown")}),t.close(q))};t.prototype.closeAll=function(n,t){var q=n;typeof n!="string"?q=n.id:typeof n.jquery=="string"&&(q=n.popupwindow().id);var u=this.getPopup(q);if(u!==null)do{var r=this.getLastOpenPopup();checkExists(r)&&this.closeSpecific(r,t)}while(checkExists(r)&&r.id!==q)};t.prototype.hasClosingPopups=function(){var n=this._getLastPopup(function(n){return!n.isOpen()});return checkExists(n)};t.prototype.getLastModal=function(){return this._getLastPopup(function(n){return n.options.modal})};t.prototype.getLastOpenModal=function(){return this._getLastPopup(function(n){return n.isOpen()&&n.options.modal})};t.prototype.getLastOpenPopup=function(){return this._getLastPopup(function(n){return n.isOpen()})};t.prototype.getPopup=function(n){var t=n;return this._getLastPopup(function(n){return n.id===t})};t.prototype.isAnyPopupShown=function(){var n=this._getLastPopup(function(n){return n.visible});return checkExists(n)};t.prototype._getOptions=function(n){return typeof n=="string"?{message:n}:n};t.prototype.showConfirmation=function(t){var q=n("<div><\/div>");return this.getContainer().append(q),q.confirmationbox(n.extend(this._getOptions(t),{type:"confirmation"})),q.confirmationbox("show")};t.prototype.showError=function(t){var q=n("<div><\/div>");return this.getContainer().append(q),q.errorbox(n.extend(this._getOptions(t),{type:"error"})),q.errorbox("show")};t.prototype.showNotification=function(t){var q=n("<div><\/div>");return this.getContainer().append(q),q.notificationbox(n.extend(this._getOptions(t),{type:"info"})),q.notificationbox("show")};t.prototype.showMessage=function(t){var q=n("<div><\/div>");return this.getContainer().append(q),q.messagebox(this._getOptions(t)),q.messagebox("show")};t.prototype.showPopup=function(n){return this.createPopup(n).popupwindow("show")};t.prototype.createPopup=function(t){var q=n("<div><\/div>");return this.getContainer().append(q),q.popupwindow(this._getOptions(t))};t.prototype.refreshPriorPopupsForIE=function(){if(SourceCode.Forms.Browser.msie&&SourceCode.Forms.Browser.version>8){var t=n.popupManager.popUps;if(checkExists(t)){var q=t.length;if(checkExists(q)&&q>1)for(var f=q-1;f--;){var e=t[f];if(checkExists(e)){var o=e.controls;if(checkExists(o)){var r=o.main;if(checkExists(r)&&r.length>0){var u=r[0].style;checkExists(u)&&u.display!=="none"&&(u.cssText+="")}}}}}}};t.prototype.showExtendedMessage=function(t){var q=n("<div><\/div>");return this.getContainer().append(q),q.extendedbox(n.extend(this._getOptions(t),{cssClass:"extended-message"})),q.extendedbox("show")};t.prototype.showWarning=function(t){var q=n("<div><\/div>");return this.getContainer().append(q),q.warningbox(n.extend(this._getOptions(t),{type:"warning"})),q.warningbox("show")};t.prototype.showCategoryBrowserPopup=function(t){var q=n("<div><\/div>");return this.getContainer().append(q),q.categorybrowserpopup(n.extend(this._getOptions(t),{cssClass:"category-browser"})),q.categorybrowserpopup("show")};SourceCode.Forms.Widget.PopupWindow={options:{width:200,height:100,closeObj:null,setInnerDimensions:!1,centered:!0,show:!0,showHeaderButtons:!0,resizable:!1,draggable:!0,modal:!0,maximizable:!1,maximized:!1,minimizable:!1,minimized:!1,showContentOnly:!1,elementToFocusOnClose:null},_create:function(){SourceCode.Forms.Layout.isRuntime()&&setTabIndexesToNone();var e=this.options;if(this.controls={main:null,header:null,body:null,footer:null,buttonbar:null,mainbuttongroup:null,toolbuttongroup:null},this.visible=!1,this.buttonbar=null,this._restore={width:0,height:0,top:0,left:0},this._heightClass="",this._attach(),this.options.modal&&this._makeModal(),this._setHeader(),n("html").hasClass("safari")&&n("html").hasClass("mobile")&&this.element.remove(),this._setButtons(),this._setContent(),this.options.setInnerDimensions?this._calculateInnerDimensions():this._calculateOuterDimensions(),this.id=this.options.id||"PopupWin_"+"".generateGuid(),this.controls.main.attr("id",this.id),this.controls.main.addClass(this._getDialogClassnames()),this.options.draggable&&this._makeDraggable(),this.options.resizable&&this._applyResizeHandles(),!this.options.showContentOnly&&this.options.showHeaderButtons&&this._setHeaderButtons(),typeof this.options.closeWith!="undefined"&&this._applyCloseControls(),this.options.centered?this.center():(this.visible||this.controls.main.show(),this.controls.main.css({top:"0px",left:"0px"}),this.visible||this.controls.main.hide()),checkExists(this.options.buttons)&&this.options.buttons.length!==0||jQuery(this.controls.main).addClass("no-buttons"),n("html").hasClass("safari")&&n("html").hasClass("mobile")&&n.popupManager.container.append(this.element),n.popupManager._addPopup(this),SourceCode.Forms.Layout.isRuntime()){var q=n.popupManager.popUps,r=q.length;checkExists(n.popupManager.elementsToFocusCollection)||(n.popupManager.elementsToFocusCollection=[]);var t=this.options.elementToFocusOnClose;if(!checkExists(t)){if(r>1){var u=q[r-2].element.find("iframe");if(u.length>0){var f=u.contents();if(f.length>0)try{t=n(f[0].activeElement)}catch(o){}}}if(!checkExists(t)){try{var s=document.activeElement}catch(h){document.documentElement.focus()}t=typeof document.activeElement!="undefined"&&checkExists(document.activeElement)?n(document.activeElement):null;checkExists(t)&&t.length>0&&checkExists(t[0].tagName)&&t.is("body")&&typeof event!="undefined"&&checkExists(event)&&(t=n(event.target))}}checkExists(t)&&t.length>0&&n.popupManager.elementsToFocusCollection.push(t);SourceCode.Forms.Layout.isRuntime()&&this._setPopupFocus()}},_getDialogClassnames:function(){var n=["dialog"];return checkExistsNotEmpty(this.options.type)&&(n.push(this.options.type+"-message"),n.push("auto-scale-height"),(this.options.type==="error"||this.options.type==="info"||this.options.type==="warning")&&n.push("simple-message-content")),this.options.cssClass!==undefined&&this.options.cssClass!==""&&n.push(this.options.cssClass),n.join(" ")},_setPopupFocus:function(){try{var q=document.activeElement;this._isValidActiveElement(q)&&q.tagName.toLowerCase()!=="body"&&n(q).trigger("blur")}catch(f){}var u=checkExists(n.popupManager)&&checkExists(n.popupManager.popUps)?n.popupManager.popUps.length:0;if(u>0){var t=n.popupManager.popUps[u-1];if(checkExists(t)&&checkExists(t.element)&&t.element instanceof jQuery){var r=t.element.find("iframe");if(r.length>0&&!r.hasClass("runtime-popup"))r.on("load",function(){n(this).contents().find("a, input[type!='hidden'], textarea, [tabindex][tabindex!='-1']").first().trigger("focus")})}}},html:function(){return'<div class="popup-header"><div class="popup-header-l"><\/div><div class="popup-header-c"><div class="popup-header-wrapper"><div class="wrapper"><div class="popup-header-text"><\/div><div class="popup-header-buttons"><div class="popup-header-button-bar"><div class="popup-header-button-bar-wrapper"><\/div><\/div><\/div><\/div><\/div><\/div><div class="popup-header-r"><\/div><\/div><div class="popup-body"><div class="popup-body-l"><\/div><div class="popup-body-c"><div class="popup-body-content"><div class="scroll-wrapper"><\/div><\/div><\/div><div class="popup-body-r"><\/div><\/div><div class="popup-footer"><div class="popup-footer-l"><\/div><div class="popup-footer-c"><\/div><div class="popup-footer-r"><\/div><\/div><div class="popup-closing-modal hidden"><\/div>'},_attach:function(){this.element.hasClass("popup")&&this.element.find(".popup-header").length!==0||(this.element.addClass("popup"),this.options.showContentOnly||this.element.html(this.html()));this.controls.main=this.element;this.controls.header=this.controls.main.find(".popup-header");this.controls.body=this.controls.main.find(".popup-body");this.controls.footer=this.controls.main.find(".popup-footer");this.controls.buttonbar=this.controls.footer.find(".button-bar")},_makeModal:function(){modalizer.show(!1,null,null,!0,!1,{excludeFromVisibilityCalculations:!0});n(modalizer.element).insertBefore(this.element)},_applyResizeHandles:function(){this.controls.main.css("position","absolute");this.controls.main.resizable()},_makeDraggable:function(){if(n(document.documentElement).hasClass("mobile")){this.options.draggable=!1;return}var t=this.controls.main,q=function(n,q){SourceCode.Forms.Widget.fixPosition(q);SourceCode.Forms.Widget.createUnderlay(t)};t.SFCPopupdraggable({handle:this.controls.header[0],containment:"window",stop:q,drag:q})},_setHeader:function(n){checkExists(n)||(n=checkExists(this.options.headerText)?this.options.headerText:"");var t=this.controls.header.find(".popup-header-text");t.html(n.htmlEncode());t.attr("title",n)},getControls:function(){return this.controls},_useRuntimeButtons:function(){return typeof initializeRuntimeForm=="function"&&checkExists(SourceCode)&&checkExists(SourceCode.Forms)&&checkExists(SourceCode.Forms.Controls)&&checkExists(SourceCode.Forms.Controls.Web)&&checkExists(SourceCode.Forms.Controls.Web.Button)},_getFooterContentContainer:function(){return this.controls.footer.find(".popup-footer-c")},_ensureButtonBar:function(){if(!checkExists(this.controls.buttonbar)||!!this.controls.buttonbar&&this.controls.buttonbar.length===0){var n=jQuery(SourceCode.Forms.Widget.ButtonBar.html());this._getFooterContentContainer().append(n);this.controls.buttonbar=n.buttonBar()}this.controls.buttonbar.buttonBar("getGroups").length==0&&(this.controls.toolbuttongroup=this.controls.buttonbar.buttonBar("addButtonGroupFromOptions",{alignment:"left"}),this.controls.mainbuttongroup=this.controls.buttonbar.buttonBar("addButtonGroupFromOptions",{alignment:"right"}))},_setButtons:function(){checkExists(this.options.buttons)&&this.options.buttons.length&&this.options.buttons.length>0&&(this._useRuntimeButtons()?this._setButtons_Runtime():this._setButtons_Designtime())},_setButtons_Designtime:function(){this._ensureButtonBar();for(var n=0;n<this.options.buttons.length;n++)switch($type(this.options.buttons[n])){case"object":var t=this.options.buttons[n];this.options.toolbuttons?this.controls.mainbuttongroup.buttonGroup("addButtonFromOptions",t):!t.type||t.type!=="help"?this.controls.mainbuttongroup.buttonGroup("addButtonFromOptions",t):this.controls.toolbuttongroup.buttonGroup("addButtonFromOptions",t)}if(this.options.toolbuttons&&this.options.toolbuttons.length&&this.options.toolbuttons.length>0)for(var n=0;n<this.options.toolbuttons.length;n++)switch($type(this.options.toolbuttons[n])){case"object":var t=this.options.toolbuttons[n];this.controls.toolbuttongroup.buttonGroup("addButtonFromOptions",t)}},_setButtons_Runtime:function(){for(var r=0;r<this.options.buttons.length;r++){var t=this.options.buttons[r],q=[];q[0]=t.id?"id='{0}'".format(t.id):"";q[1]=t.title?t.title:"";q[2]=t.type?" "+t.type:"";q[2]+=!t.enabled&&t.enabled===!1?(t.type?" ":"")+"disabled":"";q[3]=t.type?"<span class='Button-Image icon icon-size16'><\/span>":"";q[4]=t.text?t.text:"";var e="<a {0} title='{1}' class='SFC SourceCode-Forms-Controls-Web-Button button{2}' href='javascript:;'>{3}{4}<\/a>".format(q),u=n(e);this.controls.footer.find(".popup-footer-c").append(u);var f={};t.click&&(f.click=t.click);u.SFCButton(f)}},_calculateOuterDimensions:function(){this.options.width!==-1&&this.options.height!==-1&&this.controls.main.css({width:this.options.width+"px",height:this.options.height+"px"});var n=this.visible;n||this.controls.main.show();var t=this.options.height;t-=this.controls.header.height();t-=this.controls.footer.height();n||this.controls.main.hide()},_calculateInnerDimensions:function(){this.options.width!==-1&&this.options.height!==-1&&this.controls.main.css({width:this.options.width+"px",height:this.options.height+"px"})},content:function(n){this.options.content=n;this._setContent()},_setContent:function(){var q=this.options,n=q.content;checkExists(n)||(n=q.message);var t=null;t=this.options.showContentOnly?jQuery(this.controls.main):jQuery(this.controls.body).children().eq(1).children().first().children().first();!checkExists(n)&&typeof(this.options.contentUrl=="string")?(this.controls.body.overlay({modal:!0,icon:"loading",classes:"popup-loading"}),this.controls.buttons=this.controls.footer.find("a.button, SourceCode-Forms-Controls-Web-Button"),this.controls.buttons.k2button(),this.controls.buttons.k2button("disable"),t.load(this.options.contentUrl,this.options.contentData,function(n,q,r){if(this.isClosing!=!0)if(this.controls.body.removeOverlay(),SourceCode.Forms.ExceptionHandler.AjaxUnsuccessful(r,q,n)){if(typeof this.options.onContentLoadException=="function")this.options.onContentLoadException(r,q,n);else SourceCode.Forms.ExceptionHandler.AddErrorHTML(t,r,q,n);this.controls.buttons.k2button("disable")}else if(this.controls.buttons.k2button("enable"),typeof this.options.onContentLoaded=="function")this.options.onContentLoaded(t,n,q,r)}.bind(this))):checkExists(n)&&(typeof n=="string"?n.charAt(0)==="#"&&(n=jQuery(n)):checkExists(n.jquery)||(n=jQuery(n)),checkExists(n.jquery)?(n.appendTo(t),n.show()):t.html(n))},_applyCloseControls:function(){switch($type(this.options.closeWith)){case"element":jQuery(this.options.closeWith).on("click",function(){this.close()}.bind(this));break;case"string":var n=document.getElementById(this.options.closeWith);if(checkExists(n))jQuery(n).on("click",function(){this.close()}.bind(this))}},_setHeaderButtons:function(){var q=0;if(this.options.showHeaderButtons===!0){var u=this.controls.header.find(".popup-header-button-bar-wrapper");if(this.options.minimizable){var f=jQuery("<a class='minimize' href='javascript:;' title='"+Resources.CommonActions.Maximize+"'><\/a>");u.append(f);f.html("<span><\/span>");f.on("click",this.minimise.bind(this));checkExists(SourceCode.Forms.Widget.PopupWindow.headerButtonMaxWidth)||(SourceCode.Forms.Widget.PopupWindow.headerButtonMaxWidth=f.outerWidth(!0));q+=SourceCode.Forms.Widget.PopupWindow.headerButtonMaxWidth}if(this.options.maximizable){var e=jQuery("<a class='maximize' href='javascript:;' title='"+Resources.CommonActions.Maximize+"'><\/a>");u.append(e);e.html("<span><\/span>");e.on("click",this.maximise.bind(this));var o=this;this.controls.header.find(".popup-header-text").on("dblclick",function(n){o.doubleClickMaximise(n)});checkExists(SourceCode.Forms.Widget.PopupWindow.headerButtonMinWidth)||(SourceCode.Forms.Widget.PopupWindow.headerButtonMinWidth=e.outerWidth(!0));q+=SourceCode.Forms.Widget.PopupWindow.headerButtonMinWidth}var r=jQuery("<a class='close' href='javascript:;' title='"+Resources.CommonActions.Close+"'><\/a>");u.append(r);r.html("<span><\/span>");r.on("click",function(){if(this.options.onCancel)this.options.onCancel();else if(SourceCode.Forms.Layout.isRuntime()){r.off("click");var t=this,q=null,n=null,u=null;if(checkExists(t.controls)&&checkExists(t.controls.main)){var f=t.controls.main.find("iframe"),q=t._getPopupIframeContentWindow(f);q!==null&&(n=typeof q.document=="undefined"?null:q.document,n!==null&&(u=typeof n.readyState=="undefined"?null:n.readyState))}if(n===null||u==="complete"&&typeof q._runtimeScriptsLoaded!="undefined")t.close();else var e=setInterval(function(){q=t.controls.main.find("iframe")[0].contentWindow;n=q.document;u=typeof n.readyState=="undefined"?null:n.readyState;u==="complete"&&typeof q._runtimeScriptsLoaded!="undefined"&&(clearInterval(e),t.close())},60)}else this.close()}.bind(this));if(checkExists(SourceCode.Forms.Widget.PopupWindow.headerButtonCloseWidth)||(SourceCode.Forms.Widget.PopupWindow.headerButtonCloseWidth=r.outerWidth(!0)),q+=SourceCode.Forms.Widget.PopupWindow.headerButtonCloseWidth,window.ie){var t=u.children();if(t.length>1)for(var n=0;n<t.length;n++)n===0&&jQuery(t[n]).addClass("first"),n!==0&&n===t.length-1&&jQuery(t[n]).addClass("last");else jQuery(t[0]).addClass("only")}}document.documentElement.getAttribute("dir")==="rtl"?this.controls.header.find(".popup-header-text")[0].style.left=q+"px":this.controls.header.find(".popup-header-text")[0].style.right=q+"px"},_getPopupIframeContentWindow:function(n){if(checkExists(n)&&n.length>0&&n.hasClass("navigated")===!1){var t=n[0].contentWindow;if(checkExists(t))return t}return null},focusLastFocussed:function(){var f=n.popupManager.popUps,r=n.popupManager.elementsToFocusCollection,e=f.length;if(e>0&&checkExists(r)&&r.length>0){var t=r.pop();if(checkExists(t)&&t.length>0){if(SourceCode.Forms.Browser.msie)if(checkExists(this.controls)&&checkExists(this.controls.main)&&this.controls.main.find("iframe").length>0){var q=null;try{if(checkExists(t[0].ownerDocument)){var o=n(t[0].ownerDocument);q=o.find(".temporaryFocusingTextBox");q===null||q.length===0?q=n('<input type="text" class="temporaryFocusingTextBox" style="position:absolute;left:-100px;width:1px;height:1px;"/>').appendTo("body"):q.show();q.insertAfter(t).trigger("focus").hide()}}catch(s){return}}else if(SourceCode.Forms.Browser.version<=8){var u=n("body");u.on("focusin.lastFocus",function(){u.off("focusin.lastFocus");t.trigger("focus")})}t.trigger("focus")}}},doubleClickMaximise:function(n){var t=jQuery(n.target).parent().find(".maximize,.restore");this._maximise(t)},maximise:function(n){var t=jQuery(n.target)[0].tagName.toLowerCase()==="a"?jQuery(n.target):jQuery(n.target.parentNode);this._maximise(t)},_maximise:function(n){n.hasClass("maximize")?(n.removeClass("maximize"),n.addClass("restore"),n[0].title=Resources.CommonActions.Minimize,this.maximize(),this.options.draggable===!0&&this.controls.main.SFCPopupdraggable("disable")):(n.removeClass("restore"),n.addClass("maximize"),n[0].title=Resources.CommonActions.Maximize,this.restore(),this.options.draggable===!0&&this.controls.main.SFCPopupdraggable("enable"));n.trigger("blur")},minimize:function(){var n=jQuery(ev.target)[0].tagName.toLowerCase()==="a"?jQuery(ev.target):jQuery(ev.target.parentNode);this._minimize(n)},_minimize:function(n){n.hasClass("minimize")?(n.removeClass("minimize"),n.addClass("restore"),this.minimize()):(n.removeClass("restore"),n.addClass("minimize"),this.restore());n.trigger("blur")},show:function(){if(this.controls.main.addClass("intro"),this.controls.main.show(),n.popupManager.refreshPriorPopupsForIE(),this.options.onShow)this.options.onShow(this);return this.visible=!0,this.options.maximized&&this.maximize(),n(".popup").last().find(".popup-footer .button").length===1?n(".popup").last().find(".popup-footer .button").eq(0).trigger("focus"):n(".popup").last().find(".popup-footer .button").length===2?n(".popup").last().find(".popup-footer .button").eq(0).trigger("focus"):n(".popup").last().find(".popup-footer .button").length===3&&n(".popup").last().find(".popup-footer .button").eq(1).trigger("focus"),SourceCode.Forms.Widget.createUnderlay(this.element),this.controls.main.removeClass("intro"),this},hide:function(){return $this=this,SourceCode.Forms.Layout.useAnimationsOnPopupClosing()&&SourceCode.Forms.Layout.useAnimations()&&!SourceCode.Forms.Layout.isRuntime()?($this.controls.main.find(".popup-closing-modal").removeClass("hidden"),$this.controls.main.addClassTransition("exit",function(){$this.controls.main.hide();$this.visible=!1;$this.options.onHide&&$this.options.onHide();n(this).removeClass("exit intro");n(this).find(".popup-closing-modal").addClass("hidden")},".popup")):($this.controls.main.hide(),$this.visible=!1,$this.options.onHide&&$this.options.onHide()),this},close:function(n){SourceCode.Forms.Layout.isRuntime()&&(this.isClosing=!0,restoreTabIndexes(),this.focusLastFocussed());var t=!1,q=!1,r=!1;if(checkExists(this.options)&&(checkExists(this.options.cancelClose)&&(t=this.options.cancelClose),checkExists(this.options.cancelOnClose)&&(q=this.options.cancelOnClose),checkExists(this.options.removeContentOnClose)&&(r=this.options.removeContentOnClose)),typeof n!="undefined"&&(checkExists(n.cancelClose)&&(t=n.cancelClose),checkExists(n.cancelOnClose)&&(q=n.cancelOnClose),checkExists(n.removeContent)&&(r=n.removeContent)),q!==!0&&checkExists(this.options.onClose))this.options.onClose(this,n);return t!==!0&&this.closed(n),this},closed:function(t){var c,u;typeof t!="undefined"&&t!==null&&(c=t.cancelOnClose,u=t.removeContent);var e=this.options,l=typeof u=="undefined"?e.removeContent!==!0:u===!1,f=this.controls;if(l){var o=e.content;if(typeof o!="undefined"&&typeof o!="string"){var r=null;r=this.options.showContentOnly?f.main[0].firstChild:f.body[0].firstChild.nextSibling.firstChild.firstChild.firstChild;checkExists(r)&&(r.style.display="none",document.body.appendChild(r))}}var q=f.main;SourceCode.Forms.Widget.destroyUnderlay(this.element);var a=q.find("iframe"),s=this._getPopupIframeContentWindow(a);s!==null&&typeof $clearHandlers!="undefined"&&$clearHandlers(s);function h(){q.isWidget("resizable")&&q.resizable("destroy");q.isWidget("draggable")&&q.draggable("destroy");q.hide();q.remove();n.popupManager._removePopup(this);var t=n.popupManager.getLastModal();if(t===undefined&&n.popupManager.container.parent().css("position")==="relative"&&n.popupManager.container.css({position:"static",top:"0px",left:"0px",width:"100%",height:"100%"}),SourceCode.Forms.Browser.msie||SourceCode.Forms.Browser.edge){var r=this;setTimeout(function(){var t=n.popupManager.getLastModal();if(t===undefined)r.hideModalizer();else if(!SourceCode.Forms.Layout.useAnimationsOnPopupClosing()||!SourceCode.Forms.Layout.useAnimations()||SourceCode.Forms.Layout.isRuntime()||popupManager.hasClosingPopups()===!1){var q=t.controls,u=q.main;n(modalizer.element).insertBefore(n(u[0]))}}.bind(this),0)}else if(t===undefined)this.hideModalizer();else{var u=t.controls,f=u.main;SourceCode.Forms.Layout.useAnimationsOnPopupClosing()&&SourceCode.Forms.Layout.useAnimations()&&!SourceCode.Forms.Layout.isRuntime()&&popupManager.hasClosingPopups()!==!1||n(modalizer.element).insertBefore(n(f[0]))}}return SourceCode.Forms.Layout.useAnimationsOnPopupClosing()&&SourceCode.Forms.Layout.useAnimations()&&!SourceCode.Forms.Layout.isRuntime()?(q.find(".popup-closing-modal").removeClass("hidden"),q.addClassTransition("exit",function(){h.call(this);q.removeClass("exit intro");q.find(".popup-closing-modal").addClass("hidden")}.bind(this),".popup")):h.call(this),this.isClosed=!0,this},isOpen:function(){return!this.isClosed&&!this.isClosing},hideModalizer:function(t){var q=n(modalizer.element);SourceCode.Forms.Layout.useAnimationsOnPopupClosing()&&SourceCode.Forms.Layout.useAnimations()&&!SourceCode.Forms.Layout.isRuntime()?q.addClassTransition("exit",function(){modalizer.hide();q.removeClass("intro exit");typeof t=="function"&&t()},".modalizer"):(modalizer.hide(),typeof t=="function"&&t())},maximize:function(){this.options.maximized=null;this._restore.width=this.controls.main.width();this._restore.height=this.controls.main.height();this._restore.left=this.controls.main.offset().left;this._restore.top=this.controls.main.offset().top;var n=jQuery(window),t=5,q=5,e=t*2,o=q*2,r=n.scrollTop()+t,u=n.scrollLeft()+q;r=r<t?t:r;u=u<q?q:u;this.controls.main[0].style.top=r+"px";this.controls.main[0].style.left=u+"px";this.controls.main[0].style.height=n.height()-e+"px";this.controls.main[0].style.width=n.width()-o+"px";var s=this.controls.main.height()-this.controls.header.height()-this.controls.footer.height(),f=jQuery(this.controls.header).find("a.maximize").eq(0);return f.removeClass("maximize"),f.addClass("restore"),this.controls.main.addClass("maximized"),this.options.onMaximize&&this.options.onMaximize(),this},restore:function(){this.controls.main.css({top:this._restore.top+"px",left:this._restore.left+"px",height:this._restore.height+"px",width:this._restore.width+"px"});var n=this.controls.main.height()-this.controls.header.height()-this.controls.footer.height();return this.controls.main.removeClass("maximized"),this.options.onRestore&&this.options.onRestore(),this},minimize:function(){return this._restore.width=this.controls.main.width(),this._restore.height=this.controls.main.height(),this._restore.left=this.controls.main.offset().left,this._restore.top=this.controls.main.offset().top,this.options.onMinimize&&this.options.onMinimize(),this},resize:function(n,t){return this.controls.main.css({width:n+"px",height:t+"px"}),this.options.onResize&&this.options.onResize(),SourceCode.Forms.Widget.createUnderlay(this.controls.main),this},move:function(n,t){return this.controls.main.css({left:n+"px",top:t+"px"}),SourceCode.Forms.Widget.createUnderlay(this.controls.main),this},center:function(){this.visible||this.controls.main.show();var r=jQuery(window).scrollTop(),e=getWindowOuterHeight(),c=n("html.mobile").length>0;c&&(e===0&&(e=window.screen.availHeight),r===0&&(r=-n("form")[0].getBoundingClientRect().top));var q=getWindowInnerHeight(),t=0,u=0,o=10,f=null;switch(this.options.subformVerticalAlign){case"middle":f=!1;break;case"auto":f=!evalCommon("SourceCode.Forms.Settings.Compatibility.DisableAlternatePopupPositioningOnLargeiFrames");break;default:f=!evalCommon("SourceCode.Forms.Settings.Compatibility.DisableAlternatePopupPositioningOnLargeiFrames")&&c}if(f&&q>e){var s=this.controls.main.height(),h=null;try{h=document.activeElement}catch(l){}t=this._isValidActiveElement(h)?n(h).offset().top-s/2:(q-this.controls.main.height())/2+r;t<o&&(t=o);t+s>q&&(t=q-s-o)}else t=(q-this.controls.main.height())/2+r;return u=(jQuery(window).width()-this.controls.main.width())/2+jQuery(window).scrollLeft(),t<0&&(t=0),u<0&&(u=0),this.controls.main.css({top:t+"px",left:u+"px"}),this.visible||this.controls.main.hide(),this},_isValidActiveElement:function(n){return checkExists(n)&&checkExists(n.tagName)},addButton:function(n){return this._ensureButtonBar(),this.controls.mainbuttongroup.buttonGroup("addButtonFromOptions",n),this},getButtonBar:function(){return this.controls.buttonbar},getButtonById:function(n){return this.controls.buttonbar.find("#"+n+".button")},getButtonByType:function(n){return this.controls.buttonbar.find("."+n+".button")},showBusy:function(n){checkExists(n)||(n=!0);var t=this.controls.body.find("div.popup-body-content");return t.modalize(n),t.showBusy(n),jQuery(this.controls.footer).find("a.button").each(function(){jQuery(this).modalize(n)}),this},hideBusy:function(){return this.showBusy(!1),this},_destroy:function(){this.controls.main.isWidget("resizable")&&this.controls.main.resizable("destroy")}};n.widget("ui.popupwindow",SourceCode.Forms.Widget.PopupWindow);SourceCode.Forms.Widget.ExtendedBox={options:{width:640,height:158,expandedWidth:640,draggable:!0,expandedHeight:358,showHeaderButtons:!1,isExpanded:!1},_create:function(){var t=String.generateGuid();this.options.buttons=[];this.options.messageDetail&&this.options.buttons.push({id:"btnExHandler_Details"+t,text:Resources.CommonActions.Details,click:this._toggleDetails.bind(this),title:Resources.CommonActions.ExceptionInfo});this.options.onCancel?(this.options.buttons.push({id:"ok"+t,text:Resources.WizardButtons.OKButtonText,click:this.options.onAccept?this.options.onAccept:this.close.bind(this)}),this.options.buttons.push({id:"cancel"+t,text:Resources.WizardButtons.CancelButtonText,click:this.options.onCancel?this.options.onCancel:this.close.bind(this)}),this._useRuntimeButtons()||(this.options.closeWith="cancel"+t)):(this.options.buttons.push({id:"ok"+t,text:Resources.WizardButtons.OKButtonText,click:this.options.onAccept?this.options.onAccept:this.close.bind(this)}),this._useRuntimeButtons()||(this.options.closeWith="ok"+t));var f=this.options.expandedWidth-73,e=this.options.expandedHeight-this.options.height-15,q="panel without-header without-footer";(SourceCode.Forms.Layout.isRuntime()||SourceCode.Forms.Layout.isLoginPage())&&(q=q+" full");var r='<div id="ExceptionPanel" class="{0}">'.format(q)+'<div class="panel-body"><div class="panel-body-t"><div class="panel-body-t-l"><\/div><div class="panel-body-t-c"><\/div><div class="panel-body-t-r"><\/div><\/div><div class="panel-body-m"><div class="panel-body-m-l"><\/div><div class="panel-body-m-c"><div class="wrapper"><div class="scroll-wrapper"><div class="lyt-messagebox-layout" id="exMessage"><div class="icon"><\/div><div class="message">'+this.options.message+"<\/div><\/div>";this.options.messageDetail&&(r+='<div id="exDivider"><\/div><div id="exDetails" style="display: none;" class="exceptionDetails"><ul class="tree">'+this.options.messageDetail+"<\/div>");r+='<\/div><\/div><\/div><div class="panel-body-m-r"><\/div><\/div><div class="panel-body-b"><div class="panel-body-b-l"><\/div><div class="panel-body-b-c"><\/div><div class="panel-body-b-r"><\/div><\/div><\/div><\/div>';this.options.content=r;n.ui.popupwindow.prototype._create.apply(this,arguments);var u=jQuery(this.controls.body).find("div.popup-body-content > div.scroll-wrapper").addClass("message-box-content");this.options.type&&u.addClass(this.options.type);this.options.isExpanded&&(this.options.isExpanded=!1,this._toggleDetails())},_toggleDetails:function(){this.options.isExpanded=!this.options.isExpanded;this.options.isExpanded?(jQuery("#exMessage").addClass("exceptionMessage"),jQuery("#exDivider").addClass("exceptionDivider"),jQuery("#exDetails").show(),popupManager.getLastModal().resize(this.options.expandedWidth,this.options.expandedHeight).center()):(jQuery("#exMessage").removeClass("exceptionMessage"),jQuery("#exDivider").removeClass("exceptionDivider"),jQuery("#exDetails").hide(),popupManager.getLastModal().resize(this.options.width,this.options.height).center())}};n.widget("ui.extendedbox",n.ui.popupwindow,SourceCode.Forms.Widget.ExtendedBox);SourceCode.Forms.Widget.MessageBox={options:{width:384,draggable:!0,height:185,showHeaderButtons:!1},_create:function(){if(!checkExists(this.options)||!checkExists(this.options.buttons)){var q="messageBoxButton_OK"+(new Date).getTime();this.options.buttons=[{id:q,text:Resources.WizardButtons.OKButtonText}];this._useRuntimeButtons()?this.options.buttons[0].click=this.close.bind(this):this.options.closeWith=q}var r="",t="without-header ";checkExists(this.options.title)&&(r='<div class="panel-header">                     <div class="panel-header-l"><\/div>                     <div class="panel-header-c">                         <div class="panel-header-wrapper">                             <div class="panel-header-text" title="{1}">{0}<\/div>                         <\/div>                     <\/div>                     <div class="panel-header-r"><\/div>                 <\/div>'.replace("{0}",this.options.title).replace("{1}",this.options.title.htmlEncode()),t="");(SourceCode.Forms.Layout.isRuntime()||SourceCode.Forms.Layout.isLoginPage())&&(t=t+" full");this.options.content='<div class="panel {2} without-footer">                 {1}                 <div class="panel-body">                     <div class="panel-body-t">                         <div class="panel-body-t-l"><\/div>                         <div class="panel-body-t-c"><\/div>                         <div class="panel-body-t-r"><\/div>                     <\/div>                     <div class="panel-body-m">                         <div class="panel-body-m-l"><\/div>                         <div class="panel-body-m-c">                             <div class="scroll-wrapper">                                 <div class="lyt-messagebox-layout">                                     <div class="icon"><\/div>                                     <div class="message">{0}<\/div>                                 <\/div>                             <\/div>                         <\/div>                         <div class="panel-body-m-r"><\/div>                     <\/div>                     <div class="panel-body-b">                         <div class="panel-body-b-l"><\/div>                         <div class="panel-body-b-c"><\/div>                         <div class="panel-body-b-r"><\/div>                     <\/div>                 <\/div>             <\/div>'.replace("{0}",this.options.message).replace("{1}",r).replace("{2}",t);n.ui.popupwindow.prototype._create.apply(this,arguments);jQuery(this.controls.body).find("div.popup-body-content > div.scroll-wrapper").addClass("message-box-content");checkExists(this.options.type)&&jQuery(this.controls.body).find("div.popup-body-content > div.scroll-wrapper").addClass(this.options.type)}};n.widget("ui.messagebox",n.ui.popupwindow,SourceCode.Forms.Widget.MessageBox);SourceCode.Forms.Widget.NotificationBox={_create:function(){checkExists(this.options)&&checkExists(this.options.headerText)||(this.options.headerText=Resources.MessageBox.Notification);n.ui.messagebox.prototype._create.apply(this,arguments);jQuery(this.controls.body).find("div.popup-body-content > div.scroll-wrapper").addClass("info")}};n.widget("ui.notificationbox",n.ui.messagebox,SourceCode.Forms.Widget.NotificationBox);SourceCode.Forms.Widget.WarningBox={_create:function(){this.options.headerText=Resources.MessageBox.Warning;n.ui.messagebox.prototype._create.apply(this,arguments);jQuery(this.controls.body).find("div.popup-body-content > div.scroll-wrapper").addClass("warning")}};n.widget("ui.warningbox",n.ui.messagebox,SourceCode.Forms.Widget.WarningBox);SourceCode.Forms.Widget.ConfirmationBox={_create:function(){var q=Resources.MessageBox,t=this.options;t.headerText||(t.headerText=q.Confirmation);var u={click:t.onAccept},r=[u];t.onCancel&&!t.onDecline?(u.text=q.OKButtonText,r.push({click:t.onCancel,text:q.CancelButtonText})):(u.text=q.YesButtonText,r.push({click:t.onDecline?t.onDecline:function(){this.close.apply(this,[].slice(arguments))}.bind(this),text:q.NoButtonText}),!t.onCancel||r.push({click:t.onCancel,text:q.CancelButtonText}));t.buttons=r;n.ui.messagebox.prototype._create.apply(this,arguments);checkExistsNotEmpty(t.iconClass)?jQuery(this.controls.body).find("div.popup-body-content > div.scroll-wrapper").addClass(t.iconClass):jQuery(this.controls.body).find(".popup-body-content").find(".scroll-wrapper").eq(0).addClass(t.type||"confirmation")}};n.widget("ui.confirmationbox",n.ui.messagebox,SourceCode.Forms.Widget.ConfirmationBox);SourceCode.Forms.Widget.ErrorBox={_create:function(){this.options.headerText=Resources.MessageBox.Error;n.ui.messagebox.prototype._create.apply(this,arguments);jQuery(this.controls.body).find("div.popup-body-content > div.scroll-wrapper").addClass("error")}};n.widget("ui.errorbox",n.ui.messagebox,SourceCode.Forms.Widget.ErrorBox);SourceCode.Forms.Widget.getBoxShadow=function(n){var u={hShadow:0,vShadow:0,blur:0,spread:0},t=n.css("box-shadow");if(checkExistsNotEmpty(t)&&t!=="none"){t=t.replace(/rgba?\([^\)]+\)/gi,"");t=t.replace(/#[0-9a-f]+/gi,"");t=t.replace(/[a-z]+/gi,"").trim();var q=function(n,t){var q=n[t];return typeof q=="undefined"?0:parseInt(n[t])},r=t.split(" "),u={hShadow:q(r,0),vShadow:q(r,1),blur:q(r,2),spread:q(r,3)}}return u};SourceCode.Forms.Widget.fixPosition=function(t){if(n(window).scrollTop()>0){var r=t.offset.top,q=t.position;q.top>r&&(q.top=r);t.position=q}};SourceCode.Forms.Widget.createUnderlay=function(t){if(SourceCode.Forms.Browser.msie){var r={width:t[0].offsetWidth,height:t[0].offsetHeight,frameborder:0,src:"about:blank"},e=t.position(),u={position:"absolute",top:e.top+"px",left:e.left+"px",display:t[0].style.display==="none"?"none":"block",filter:'Alpha(Opacity="0")'},o=t[0].style.zIndex;o.length>0&&(u.zIndex=parseInt(o)-1);var f=SourceCode.Forms.Widget.getBoxShadow(t);f||(f=SourceCode.Forms.Widget.getBoxShadow(n(t[0].firstChild)));var s=t.children(".popup-body");s.length>0&&(f=SourceCode.Forms.Widget.getBoxShadow(s));f&&(r.width+=f.hShadow+f.spread,r.height+=f.vShadow+f.spread);r.width+="px";r.height+="px";var h=t.data("underlay")||n("<iframe><\/iframe>").insertBefore(t),q=h[0];return q.className="ie-underlay",q.setAttribute("width",r.width),q.setAttribute("height",r.height),q.setAttribute("frameborder",r.frameborder),q.setAttribute("src",r.src),q.style.position=u.position,q.style.top=u.top,q.style.left=u.left,q.style.display=u.display,q.style.filter=u.filter,checkExists(u.zIndex)&&(q.style.zIndex=u.zIndex),t.data("underlay",h),t}};SourceCode.Forms.Widget.destroyUnderlay=function(n){var t=n.data("underlay");typeof t!="undefined"&&(t.remove(),n.removeData("underlay"))}})(jQuery);var popupManager=jQuery.popupManager,masterPopupManager=popupManager;
/*!
 ~/Script/jquery.forms.widget.categorybrowserpopup.js
*/
(function(n){(typeof SourceCode=="undefined"||SourceCode===null)&&(SourceCode={});(typeof SourceCode.Forms=="undefined"||SourceCode.Forms===null)&&(SourceCode.Forms={});(typeof SourceCode.Forms.Widget=="undefined"||SourceCode.Forms.Widget===null)&&(SourceCode.Forms.Widget={});SourceCode.Forms.Widget.CategoryBrowserPopup={options:{width:256,height:384,tree:{dataType:""},onSelect:null,draggable:!0,resizable:!0},_create:function(){if(typeof this.options.headerText=="undefined"||this.options.headerText==="")if(this.options.tree.dataType==="")this.options.headerText=Resources.Categories.SelectCategoryText;else{var q=this.options.tree.dataType;switch(this.options.tree.dataType.toUpperCase()){case"SMARTOBJECT":q=Resources.ObjectNames.SmartObjectIndefiniteSingular;break;case"VIEW":q=Resources.ObjectNames.SmartViewIndefiniteSingular;break;case"FORM":q=Resources.ObjectNames.SmartFormIndefiniteSingular;break;case"WORKFLOW":q=Resources.ObjectNames.WorkflowProcessIndefiniteSingular}this.options.headerText=Resources.Categories.SelectSpecificItem.format(q)}(this.options.buttons===undefined||this.options.buttons.length===0)&&(this.options.buttons=[{type:"help",click:function(){HelpHelper.runHelp(7001)}},{text:Resources.WizardButtons.OKButtonText,click:this.getSelectedTreeObject.bind(this)},{id:"CatPopupCloseBtn",text:Resources.WizardButtons.CancelButtonText}],this.options.closeWith="CatPopupCloseBtn");this.options.content='<div class="panel full without-header without-toolbar without-footer"><div class="panel-body"><div class="panel-body-t"><div class="panel-body-t-l"><\/div><div class="panel-body-t-c"><\/div><div class="panel-body-t-r"><\/div><\/div><div class="panel-body-m"><div class="panel-body-m-l"><\/div><div class="panel-body-m-c"><div class="scroll-wrapper"><ul class="tree"><li class="root children category"><a href="javascript:;">'+Resources.CommonPhrases.LoadingWaitText.htmlEncode()+'<\/a><\/li><\/ul><\/div><\/div><div class="panel-body-m-r"><\/div><\/div><div class="panel-body-b"><div class="panel-body-b-l"><\/div><div class="panel-body-b-c"><\/div><div class="panel-body-b-r"><\/div><\/div><\/div><\/div>';n.ui.popupwindow.prototype._create.apply(this,arguments);var t={};this.options.tree.dataType!==undefined&&(t.objecttypes=this.options.tree.dataType.toLowerCase());this.options.tree.persistance!==undefined&&this.options.tree.persistance.enabled&&(t.selected={},parseInt(this.options.tree.persistance.vcategory)>0&&(t.selected.catid=this.options.tree.persistance.vcategory),this.options.tree.persistance.object!==undefined&&this.options.tree.persistance.object!==""&&(t.selected.objectid=this.options.tree.persistance.object,t.selected.objecttype=t.objecttypes.split(",")[0]));checkExists(this.options.tree.url)&&this.options.tree.url!==""&&(t.url=this.options.tree.url);this.categorytree=n(this.controls.body).find(".tree").categorytree(t)},getSelectedTreeObject:function(){var t=this.categorytree.categorytree("value");if(!n.isEmptyObject(t)){if(this.options.onSelect)this.options.onSelect(t);t.objecttype!==undefined&&this.options.tree.dataType!==undefined&&t.objecttype.toLowerCase()===this.options.tree.dataType.toLowerCase()&&this.close()}}};n.widget("ui.categorybrowserpopup",n.ui.popupwindow,SourceCode.Forms.Widget.CategoryBrowserPopup)})(jQuery);
/*!
 ~/Script/SourceCode.Forms.ExceptionHandler.js
*/
(typeof SourceCode=="undefined"||SourceCode===null)&&(SourceCode={});(typeof SourceCode.Forms=="undefined"||SourceCode.Forms===null)&&(SourceCode.Forms={});SourceCode.Forms.ExceptionHandler=new function(){var n=this;this.AJAX_READYSTATE_REQUEST_NOT_INITIALIZED=0;this.AJAX_READYSTATE_REQUEST_BEEN_SETUP=1;this.AJAX_READYSTATE_REQUEST_BEEN_SENT=2;this.AJAX_READYSTATE_REQUEST_IN_PROCESS=3;this.AJAX_READYSTATE_REQUEST_COMPLETE=4;this._formatText=function(n){var t="";return checkExists(n)&&(t=n.htmlDecode(),t=t.htmlEncodeWithExclusionList()),t.replace(/\s+/g," ").replace(/\.([a-z])/ig,".<wbr/>$1").replace(/ (at) ([a-zA-Z])/g,'<br/><br/><span style="font-weight: 700;">$1<\/span> $2').replace(/ (in) ([A-Z]:\\)/g,'<br/><span style="font-weight: 700;">$1<\/span> $2').replace(/<br\/>/,"")};this._writeDetail=function(n){for(var q="",e=n.childNodes,r=0,o=e.length;r<o;r++){var u=e[r],h=u.nodeName,f,t="";if((f=u.firstChild)!==null){t=u.getAttribute("Name");checkExists(t)&&(t=t.htmlDecode(),t=t.htmlEncodeWithExclusionList());q+="<li>"+t;var s=f.nodeValue;q+=f.nodeType===3?": <pre>"+this._formatText(s)+"<\/pre><\/li>":"<\/li><ul>"+this._writeDetail(u)}r===o-1&&(q+="<\/ul>")}return q};this.getExceptionDetails=function(n){if(!this.isException(n))return null;var t={};typeof n=="string"&&(n=parseXML(n));var q=n.documentElement,r=q.selectSingleNode("DisplayMessage");checkExists(r)||(r=q.selectSingleNode("Message"));q.removeChild(r);var f=q.getAttribute("ExtendedDetail")==="T";t.detail="";t.message="";t.title="";var e=this._formatText(r.text);t.message=String.properObjectName(e);f&&(t.detail=this._writeDetail(q)+"<\/div>");var u=q.getAttribute("Title");return checkExists(u)&&(t.title=u.htmlDecode(),t.title=t.title.htmlEncodeWithExclusionList()),t};this.getVanillaExceptionDetails=function(n){if(!this.isException(n))return null;var q={stack:"",message:"",title:""};typeof n=="string"&&(n=parseXML(n));var t=n.documentElement,r=t.selectSingleNode("DisplayMessage");checkExists(r)||(r=t.selectSingleNode("Message"));checkExists(r)&&(q.message=r.text);var e=t.getAttribute("ExtendedDetail")==="T";if(e){var u=t.selectSingleNode("StackTrace");checkExists(u)&&(q.stack=u.text)}var f=t.getAttribute("Title");return checkExists(f)&&(q.title=f),q};this.redirectPost=function(n,t){var q=document.createElement("form");document.body.appendChild(q);q.method="post";q.action=n;for(var u in t){var r=document.createElement("input");r.type="hidden";r.name=u;r.value=t[u];q.appendChild(r)}q.submit()};this.handleException=function(n,t){var q=this.getExceptionDetails(n);if(q==null)return!1;var r=Math.floor(jQuery(window).width()/10*9);return r>640&&(r=640),masterPopupManager.showExtendedMessage({headerText:q.title,message:q.message,messageDetail:q.detail,showHeaderButtons:!1,width:r,type:"error",height:168,draggable:!0,resizable:!0,onClose:$chk(t)&&typeof t=="function"?t:$.noop}),jQuery("#exDetails").find("ul.tree").removeClass("tree").addClass("exception"),!0};this.handleCustomException=function(n){if(!this.isException(n))return!1;typeof n=="string"&&(n=parseXML(n));var t=n.documentElement,q=t.selectSingleNode("DisplayMessage");q===null&&(q=t.selectSingleNode("Message"));t.removeChild(q);var f=t.getAttribute("ExtendedDetail")==="T",e="",u="",o=this._formatText(q.text);u=String.properObjectName(o);f&&(e=this._writeDetail(t)+"<\/div>");var r=Math.floor(jQuery(window).width()/10*9);return r>640&&(r=640),masterPopupManager.showExtendedMessage({headerText:t.getAttribute("Title"),message:u,showHeaderButtons:!1,width:r,type:"error",height:158,draggable:!0,resizable:!0}),jQuery("#exDetails").find("ul.tree").removeClass("tree").addClass("exception"),!0};this.handleExceptionErrorPage=function(n){var t=this.getVanillaExceptionDetails(n);if(!checkExists(t))return!1;var q={};return q.errTitle=t.title,q.errMessage=t.message,q.errDetail=t.stack,$(window).off("beforeunload"),this.redirectPost("Error.aspx",q),!0};this.handleAuthenticationException=function(n,t,q){if(!this.isAuthenticationException(n))return!1;if($("#authExDialog").length===0){typeof n=="string"&&(n=parseXML(n));var u=n.documentElement,e=getNodeValue("RedirectURL",u,"");if(checkExistsNotEmpty(e)){var f=Math.floor(jQuery(window).width()/10*9);f>500&&(f=500);var s="<a href='{0}' target='_blank'>{1}<\/a>".format(e,Resources.ExceptionHandler.LoginLinkDisplay),h=Resources.ExceptionHandler.AuthRequiredMessagePart1.format(s),c=Resources.ExceptionHandler.AuthRequiredMessagePart2.format(Resources.WizardButtons.OKButtonText),l="{0}<br/><br/>{1}".format(h,c);masterPopupManager.showMessage({id:"authExDialog",headerText:Resources.ExceptionHandler.PleaseLoginHeader,message:l,showHeaderButtons:!1,width:f,height:158,draggable:!0,resizable:!0,removeContentOnClose:!0,modal:!0,onClose:function(){if(_runtimeRetryAjaxQueue.length>0){var n=_runtimeRetryAjaxQueue[0];n.initialRetry=!0;ajaxCall.executeRuntimeBehaviour(n)}},onShow:function(n){n.element.find(".popup-body-content > .scroll-wrapper").addClass("no-left-panel")}})}else{var a=getNodeValue("ExceptionCode",u,"");if(a==="CredentialsNotCached"){var v=getNodeValue("ProviderFriendlyName",u,""),y=getNodeValue("ProviderTypeString",u,""),o="",r=t.brokerPackagesJson;checkExists(r)&&r.length>0&&checkExists(r[0].metadata)&&checkExists(r[0].metadata.methodexecuted)&&(o=r[0].metadata.methodexecuted);var p={providerName:v,providerTypeString:y,providerMethod:o},w=checkExists(t.initialRetry)?t.initialRetry:!1;this._showAuthLoginPopup(p,n,q,w)}}}return!0};this.isException=function(n,t){if(n===null)return!1;var r="Exception",q=!1;if(typeof n=="string")if(q=n.length>10&&n.substr(0,11)==="<"+r+" ",q&&t!==undefined&&t!==null)n=tryParseXML(n);else return q;if(checkExists(n)&&typeof n.documentElement!="undefined"){if(q=n.documentElement.nodeName===r,q&&t!==undefined&&t!==null){var u=n.selectSingleNode("Exception/Type");if(u!==null&&u.text===t)return!0}return q}return!1};this.isCustomException=function(n){if(SourceCode.Forms.ExceptionHandler.isException(n)){var t=null;if(typeof n.documentElement!="undefined"?t=n:typeof n=="string"&&(t=tryParseXML(n)),t!==null){var q=t.selectSingleNode("Exception/Type");if(q!==null&&q.text==="SourceCode.Forms.Management.CustomException")return!0}}return!1};this.pageHasHtmlException=function(n){checkExists(n)&&n.length!==0||(n=$("body"));var t=n.find(".intro-content.error");return t.length>0};this.isAuthenticationException=function(n){if(SourceCode.Forms.ExceptionHandler.isException(n)){var t=null;if(typeof n.documentElement!="undefined"?t=n:typeof n=="string"&&(t=tryParseXML(n)),t!==null){var q=t.selectSingleNode("Exception/Type");if(q!==null&&q.text==="SourceCode.Hosting.Exceptions.AuthenticationException")return!0}}return!1};this.loginContent=null;this._showAuthLoginPopup=function(n,t,q,r){var e="{0}LoginPopup.aspx".format(applicationRoot),u=!0,f=this;checkExists(this.loginContent)?this._formatAndShowLoginPopup(n,t,q,r):(u=!1,$.ajax({dataType:"text",url:e,type:"GET",async:!0,success:function(e){SourceCode.Forms.ExceptionHandler.isException!==undefined&&SourceCode.Forms.ExceptionHandler.isException(e)?(SourceCode.Forms.ExceptionHandler.handleException(e),u=!1):(u=!0,f.loginContent=e,f._formatAndShowLoginPopup(n,t,q,r))},error:function(n){SourceCode.Forms.ExceptionHandler.handleException(n);u=!1}}))};this._formatAndShowLoginPopup=function(n,t,q,r){var l=this,f=masterPopupManager.window.$("#AuthExLoginDialog");checkExists(f)&&f.length!==0||(f=masterPopupManager.window.$('<div id="AuthExLoginDialog"><\/div>').appendTo("body"));f.empty().append('<div id="AuthExLoginDialogPanel"><\/div>');var y=f.find("#AuthExLoginDialogPanel").panel(),p=y.panel("fetch","body");p.html(this.loginContent);var u=masterPopupManager.showPopup({headerText:Resources.CommonLabels.LoginPopupHeader,modalize:!0,content:f,buttons:[],cssClass:"credentialsPopupDialog",width:-1,height:-1});u.find("#SignInButton").addClass("SFC SourceCode-Forms-Controls-Web-Button");u.find("#SignInButton").SFCButton().off("click").on("click",function(){l._logInClicked(n,u).bind(l)});u.find(".close").off("click").on("click",function(){masterPopupManager.closeLast();checkExists(q)&&typeof q=="function"?q():SourceCode.Forms.ExceptionHandler.handleException(t)});u.find("#UserName,#Password,#ExtraData").textbox().textbox("setValue","").on("blur",function(){l._validateCredentialTextBox($(this))});var o=u.find("#divCredentialsRequiredReason");r?(o.addClass("loginFailed"),o.html(Resources.CommonPhrases.LoginFailed)):(o.removeClass("loginFailed"),SourceCode.Forms.Settings.ObfuscateMethodNames===!1?o.html(Resources.CommonPhrases.CredentialsNeededText.format(n.providerName,n.providerMethod)):o.html(Resources.CommonPhrases.CredentialsNeededNoMethodText.format(n.providerName)));var e=!0,s=!1,h=Resources.CommonLabels.CredentialsExtraDataLabelDefault,v=[],c=n.providerName.toUpperCase();h=v.length!==0&&v.indexOf(c)>-1?Resources.CommonLabels["CredentialsExtraDataLabel"+c]:Resources.CommonLabels.CredentialsExtraDataLabelDefault;["K2","K2SQL","SHAREPOINT","SP"].indexOf(c)>-1&&(e=!1,s=!1);["CRM","SALESFORCE","SAP"].indexOf(c)>-1&&(s=!0,e=!0);e?(u.find("#ExtraDataField")[0].removeAttribute("disabled"),u.find("#ExtraData")[0].removeAttribute("disabled")):(u.find("#ExtraDataField")[0].setAttribute("disabled","disabled"),u.find("#ExtraData")[0].setAttribute("disabled","disabled"));u.find("#ExtraDataField").toggleClass("disabled",!e);u.find("#ExtraData").toggleClass("disabled",!e);u.find("#ExtraDataField").find(".form-field-label").text("{0}{1}".format(h,":"));var a=u.find("#ExtraData").textbox();a.textbox("setWatermark",h);a.textbox("setToolTip",h);u.find("#ExtraData").toggleClass("required",s);u.find("#ExtraDataField").toggleClass("required",s);a.textbox("setReadOnly",!e);u.find("#CacheCredentials").checkbox()};this._logInClicked=function(n,t){var q=t.find("#UserName"),r=t.find("#Password"),u=t.find("#ExtraData"),f=t.find("#CacheCredentials"),e=this._validateCredentialTextBox(q),o=this._validateCredentialTextBox(r),s=this._validateCredentialTextBox(u);if(e&&o&&s){var h={username:q.val(),password:r.val(),extradata:u.val(),cacheCredentials:f[0].checked,providerName:n.providerName,providerTypeString:n.providerTypeString};this._resendRequestForAuthentication(h);masterPopupManager.closeLast()}};this._resendRequestForAuthentication=function(n){if(_runtimeRetryAjaxQueue.length>0){var t=_runtimeRetryAjaxQueue[0];t.initialRetry=!0;checkExists(n)&&(t.credentials=n);ajaxCall.executeRuntimeBehaviour(t)}};this._validateCredentialTextBox=function(n){var t=n.closest(".input-control.text-input");if(t.hasClass("required")||n.hasClass("required")){if(checkExistsNotEmpty(n.val()))return t.removeClass("invalid"),t.off("mouseover").off("mouseout"),!0;var q={CurrentControlId:n[0].id,Error:!0,IsRequired:!0,IgnoreInvisible:!0,IgnoreReadOnly:!0,IgnoreDisabled:!0};t.addClass("invalid");UtilitiesHelper.showValidationMessage(n,q);t.on("mouseover",{txtBox:n},this._onInvalidCredentialOver.bind(this));t.on("mouseout",{txtBox:n},this._onInvalidCredentialOut.bind(this));return!1}return!0};this._onInvalidCredentialOver=function(n){$("#"+n.data.txtBox[0].id+"_Tooltip").show()};this._onInvalidCredentialOut=function(n){$("#"+n.data.txtBox[0].id+"_Tooltip").hide()};this.SmartObjectNotFound={_list:{},_timeout:1e3,_getTimeStamp:function(){return Date.now()},check:function(t){var q=!1,r=n.SmartObjectNotFound._list[t];if(checkExists(r)){var u=n.SmartObjectNotFound._getTimeStamp();u-r.timeStamp<=n.SmartObjectNotFound._timeout?q=!0:(n.SmartObjectNotFound._list[t]=null,q=!1)}return q},process:function(t,q){var r=parseXML(t),u=checkExists(r.selectSingleNode("/Exception[Type='SourceCode.SmartObjects.Client.SmartObjectNotFoundException']"));u&&(n.SmartObjectNotFound._list[q]={timeStamp:n.SmartObjectNotFound._getTimeStamp(),exception:t})}};this.AjaxUnsuccessful=function(n,t,q){var r=["error","timeout","abort"].indexOf(t)!==-1||[0,12029].indexOf(n.status)!==-1;return r===!1&&typeof SourceCode.Forms.ExceptionHandler.isException=="function"&&(r=SourceCode.Forms.ExceptionHandler.isException(q)||SourceCode.Forms.ExceptionHandler.isCustomException(q)),r!==!1||!n.responseXML||(r=checkExists(q.selectSingleNode("Error"))),r};this.AjaxAborted=function(n){return n.status===0&&n.statusText==="abort"};this.IsAjaxInProgress=function(n){var t=!1;return checkExists(n)&&n.readyState!==this.AJAX_READYSTATE_REQUEST_COMPLETE&&(t=!0),t};this.AddErrorHTML=function(n,t,q,r,u){var f=this.GetErrorDetails(t,q,r);return this.AddErrorHTMLFromErrorInfo(n,f,u)};this.AddErrorHTMLFromErrorInfo=function(n,t,q){var r='<div style="text-align:left" class="error-page {2}"> <table class="error-page-layout-table"> \t<tbody> \t\t<tr> \t\t\t<td > \t\t\t\t<div class="error-page-content {2}"> \t\t\t\t\t<span class="{2} icon icon-size64 ic-error"><\/span> \t\t\t\t\t<h2 class="h2 error">{0}<\/h2> \t\t\t\t\t<span class="{2} instruction">{1}<\/span> \t\t\t\t<\/div> \t\t\t<\/td> \t\t<\/tr> \t<\/tbody> <\/table> <\/div>'.format(t.title,t.message,!q?"":q);return n.append(r),n};this.IsServerError=function(n,t){return n.state()==="rejected"||[12029].indexOf(XMLHttpRequest.status)!==-1?!1:t==="timeout"?!1:!0};this.GetErrorDetails=function(n,t,q){var r="",u="";if(n.state()==="rejected"||[12029].indexOf(XMLHttpRequest.status)!==-1)r=Resources.AppStudio.GenericNoConnectionMessage;else if(t==="timeout")r=Resources.AppStudio.GenericTimeoutMessage;else if(t==="error"&&[0,12007].indexOf(XMLHttpRequest.status)!==-1)r=Resources.ExceptionHandler.WebServerErrorSource;else{var f=SourceCode.Forms.ExceptionHandler.getExceptionDetails(q);if(f!=null)return f;r=typeof q=="string"&&checkExistsNotEmpty(q)&&t!=="abort"?q:checkExists(q)&&checkExists(q.selectSingleNode("Error"))?q.selectSingleNode("Error").text:Resources.AppStudio.UnknownErrorMessage}var e=typeof SourceCode.Forms.ExceptionHandler.isException=="function"&&SourceCode.Forms.ExceptionHandler.isException(q)&&SourceCode.Forms.ExceptionHandler.isCustomException(q);return u==""&&(u=Resources.ExceptionHandler.WebServerErrorType),{title:u,message:r,detail:null,custom:e}}};
/*!
 ~/Script/SourceCode.Forms.SessionManagement.js
*/
(function(n){(typeof SourceCode=="undefined"||SourceCode===null)&&(SourceCode={});(typeof SourceCode.Forms=="undefined"||SourceCode.Forms===null)&&(SourceCode.Forms={});SourceCode.Forms.SessionManagement={_countdowntimer:null,_expiretimer:null,_keepalivetimer:null,_warntimer:null,_dialogtimerPlaceHolder:null,_dialogHeight:450,_dialogWidth:780,_isMobileApp:navigator.userAgent.indexOf("Mobilies")>=0,Session:{},_applyCountDownTimer:function(){if(this._dialogtimerPlaceHolder=n("#SessionExpirationWarningDialog .countdown-timer"),checkExists(this.Session.expiration)){var t=(new Date).getTime(),q=this.Session.expiration.getTime();t<q&&this._dialogtimerPlaceHolder.length>0?(this._dialogtimerPlaceHolder.text(Math.floor((q-t)/1e3)),this._countdowntimer=window.setTimeout(this._applyCountDownTimer.bind(this),1e3)):(window.clearTimeout(this._countdowntimer),this._countdowntimer=null)}},_checkSessionRenewalDialog:function(n){n.closed?(window.focus(),this._getSessionDetails()):window.setTimeout(this._checkSessionRenewalDialog.bind(this,n),1e3)},_getClaimsSessionRenewalUrl:function(){var n=this.Session.loginurl.indexOf("?")>0?"&":"?";return"{0}{1}_sessionUpdate=1&ReturnUrl={2}".format(this.Session.loginurl,n,applicationRoot+"Session.aspx")},_claimSessionRenewal:function(){var u=this,q=Math.floor((screen.availWidth-this._dialogWidth)/2),r=Math.floor((screen.availHeight-this._dialogHeight)/2),t=window.open(this._getClaimsSessionRenewalUrl(),"dlg","height="+this._dialogHeight+",width="+this._dialogWidth+",status=no,toolbar=no,menubar=no,location=no,left="+q+",top="+r);t!==undefined&&t!==null&&(this._expiretimer!==null&&(window.clearTimeout(this._expiretimer),this._expiretimer=null),n("body").overlay({modal:!0,icon:"loading"}),window.blur(),t.focus(),window.setTimeout(this._checkSessionRenewalDialog.bind(this,t),0))},_dialogClose:function(n){n.id==="SessionExpiredDialog"&&this._redirectToLoginPage()},_dialogShow:function(t){if(t.id==="SessionExpirationWarningDialog"){if(this.Session.keepalive)var q=n("#SessionExpirationWarningDialog input[type=checkbox]").checkbox();window.focus()}},_extendSessionButtonClick:function(){var t=n("#SessionExpirationWarningDialog input[type=checkbox]"),q=t.length>0&&t.is(":checked");popupManager.closeLast();q?this.keepalive():this.Session.type=="forms"?this.updatesession():this.renewclaimssession()},_loadSessionDetails:function(){typeof __runtimeSessionDetails=="undefined"?this._getSessionDetails():this._getSessionDetailsSuccess($xml(__runtimeSessionDetails))},_getSessionDetails:function(){n.ajax({cache:!1,url:applicationRoot+"Utilities/AJAXCall.ashx",data:"method=GetSessionDetails",success:this._getSessionDetailsSuccess.bind(this)})},_getSessionDetailsSuccess:function(t){if(typeof t.documentElement!="undefined"&&t.documentElement.tagName.toLowerCase()==="session"){n("body").removeOverlay();var u={};if(n.each(t.documentElement.attributes,function(){switch(this.name){case"expiration":u[this.name]=Date.parse(this.value);break;case"keepalive":case"slidingexpiration":u[this.name]=this.value.toLowerCase()==="true"?!0:!1;break;case"timeout":case"warntimeout":u[this.name]=parseInt(this.value,10);break;case"loginurl":case"userfqn":case"userdisplayname":case"useremail":case"showlogout":u[this.name]=this.value;break;default:u[this.name]=this.value}}),this.Session=u,this.Session.expiration!=null&&this.Session.type!=="anonymous"){var o=checkExists(this.Session.warntimeout)?this.Session.warntimeout*1e3:3e4,f=0,s={headerText:Resources.CommonPhrases.SessionExpirationText,type:"sign-in",onClose:this._dialogClose.bind(this),onShow:this._dialogShow.bind(this),preserveContent:!1,cssClass:"auto-scale-height"},r=n.extend({id:"SessionExpirationWarningDialog"},s);f=checkExists(this.Session.expiration)?this.Session.expiration.getTime()-(new Date).getTime():(new Date).getTime()+this.Session.timeout*6e4;this.Session.slidingexpiration?(r.message=Resources.CommonPhrases.SessionExpirationWarningExtendableText,r.buttons=[{text:Resources.CommonActions.ConfirmText,click:this._extendSessionButtonClick.bind(this)},{text:Resources.CommonActions.Close,click:function(){popupManager.closeLast()}}]):r.message=Resources.CommonPhrases.SessionExpirationWarningNonExtendableText;r.message=r.message.replace("{0}",'<span class="countdown-timer" />');this.Session.keepalive&&this.Session.slidingexpiration&&this.Session.type==="forms"&&(r.message+="<div>{0}<\/div>".format(SCCheckbox.html({id:"SessionKeepAliveCheckbox",label:Resources.CommonPhrases.SessionKeepAliveText})));this._warntimer!==null&&(window.clearTimeout(this._warntimer),this._warntimer=null);f-o>0&&(this._warntimer=window.setTimeout(function(){window.clearTimeout(this._warntimer);this._warntimer=null;popupManager.showMessage(r);this._applyCountDownTimer()}.bind(this),f-o));var h=n.extend({id:"SessionExpiredDialog",message:Resources.CommonPhrases.SessionExpiredText,cssClass:"auto-scale-height simple-message-content"},s);this._expiredpopup=h;this._expiretimer!==null&&(window.clearTimeout(this._expiretimer),this._expiretimer=null);f>0&&(this._expiretimer=window.setTimeout(function(){n("#SessionExpirationWarningDialog").length>0&&popupManager.closeLast();popupManager.showMessage(h);window.setTimeout(function(){popupManager.closeLast()},3e3)},f))}var q=document,e=n(".avatar-control");if(n(".main-avatar",q).length===0)try{q=parent.document;e=parent.$(".avatar-control")}catch(c){}this.Session.type!=="anonymous"&&n(".main-avatar",q).length>0&&(n(".avatar-name",q).attr("title",this.Session.userfqn).text(this.Session.userdisplayname),n(".lyt-avatar-text .name",q).text(this.Session.userdisplayname),n(".lyt-avatar-text .email",q).text(this.Session.useremail),n(".avatar-popup #EmailLink",q).attr("href","mailto:?Subject=Nintex%20Designer&cc="+this.Session.useremail),this.Session.showlogout==="false"||checkExists(e)&&e.avatar("option","showLogout").toString()==="false"?n(".avatar-popup #LogoutLink",q).hide():n(".avatar-popup #LogoutLink",q).show())}else this._redirectToLoginPage()},_redirectToLoginPage:function(){n(window).off("beforeunload");var u=this.Session.loginurl.indexOf("?")>0?"&":"?",t=location.href.substring(location.href.toUpperCase().indexOf(applicationRoot.toUpperCase()));if(t.indexOf("?")>0||t.indexOf("&")>0)for(var r=t.split(/\?|\&/),q=0;q<r.length;q++)r[q].toUpperCase().indexOf("_SPINT=0")===0&&(t=t.replace(r[q],"_spmod=1"));t=encodeURIComponent(t);document.location.href="{0}{1}ReturnUrl={2}&_sessionUpdate=1".format(this.Session.loginurl,u,t)},_updateSessionError:function(n){n.status===403&&this.Session.type!=="forms"&&this._redirectToLoginPage()},_updateSessionSuccess:function(n){if(typeof SourceCode.Forms.ExceptionHandler.isException=="function"&&SourceCode.Forms.ExceptionHandler.isException(n)){SourceCode.Forms.ExceptionHandler.handleException(n);return}this._getSessionDetails()},init:function(){var t=!1;try{t=window.self!==window.parent&&window.parent.document.getElementById("AuthenticatedPaneContainer")}catch(u){}var q=!1;try{if(__runtimeFormLevel){var r=parseInt(__runtimeFormLevel,10);r>0&&(q=window.self!==window.parent&&n(window.frameElement).is("iframe.runtime-popup"))}}catch(u){}if(n("#SignInWrapper").length==0&&!t&&!q){n("body").on("click",".sflogout-button",function(){n(window).off("beforeunload");n("body").on("click",".sflogout-button",function(n){n.preventDefault()})});this._loadSessionDetails()}},keepalive:function(){this._expiretimer!==null&&(window.clearTimeout(this._expiretimer),this._expiretimer=null);var r=checkExists(this.Session.expiration)?this.Session.expiration.getTime()-(new Date).getTime():(new Date).getTime()+this.Session.timeout*6e4;function t(n){typeof n.documentElement!="undefined"&&n.documentElement.tagName.toLowerCase()==="success"?this._keepalivetimer=window.setTimeout(q,r):(popupManager.showMessage(this._expiredpopup),window.setTimeout(function(){popupManager.closeLast()},3e3))}var q=function(){n.ajax({cache:!1,url:applicationRoot+"Utilities/AJAXCall.ashx",data:"method=extendsession",success:t.bind(this),error:t.bind(this)})}.bind(this);q()},renewclaimssession:function(){this._warntimer!==null&&(window.clearTimeout(this._warntimer),this._warntimer=null);this._isMobileApp?(this._expiretimer!==null&&(window.clearTimeout(this._expiretimer),this._expiretimer=null),n("body").overlay({modal:!0,icon:"loading"}),SourceCode.Forms.Runtime.MobileBridge.sendToMobileDevice({methodName:"renewSession",url:window.location.origin+SourceCode.Forms.SessionManagement._getClaimsSessionRenewalUrl()+"?_mobileSession=1"}).done(function(){SourceCode.Forms.SessionManagement._getSessionDetails()})):this._claimSessionRenewal()},updatesession:function(){this._warntimer!==null&&(window.clearTimeout(this._warntimer),this._warntimer=null);this._expiretimer!==null&&(window.clearTimeout(this._expiretimer),this._expiretimer=null);n.ajax({cache:!1,url:applicationRoot+"Utilities/AJAXCall.ashx",data:"method=extendsession",success:this._getSessionDetails.bind(this),error:this._updateSessionError.bind(this)})}};n(function(){SourceCode.Forms.SessionManagement.init()})})(jQuery);
/*!
 ~/Script/native.Forms.library.js
*/
function $defined(n){return n!==undefined}function checkExists(n){return n!==undefined&&n!==null}function checkExistsNotEmpty(n){return n!==undefined&&n!==null&&n!==""}function checkExistsNotEmptyGuid(n){return n!==undefined&&n!==null&&n!==""&&n!=="00000000-0000-0000-0000-000000000000"}function checkExistsNotGuid(n){return n!==undefined&&n!==null&&n!==""&&!n.toString().containsGuid()}var _evalFunctionCache={},_evalStringCache={};function _evalCommon(n){var t=null;if(typeof n=="string"){var r=n.split(".");t=window;for(var u=0,q=0;q<r.length;q++)if(u=q,t=t[r[q]],typeof t=="undefined"||t===null)break;u<r.length-1&&(t=null)}return t}function evalCommon(n){var t=_evalCommon(n);return typeof t=="undefined"&&(t=null),t}function evalString(n){var t=null;return typeof _evalFunctionCache[n]!="undefined"&&_evalFunctionCache[n]!==null?returnFunction=_evalFunctionCache[n]:(t=_evalCommon(n),typeof t!="string"?t=null:_evalStringCache[n]=t),t}function evalFunction(n){var t=null;return typeof _evalFunctionCache[n]!="undefined"&&_evalFunctionCache[n]!==null?t=_evalFunctionCache[n]:(t=_evalCommon(n),typeof t!="function"?t=null:_evalFunctionCache[n]=t),t}function getQueryStringFromUrl(n){if(!checkExistsNotEmpty(n))return null;var t=n.split("?");return t.length<2?null:"?"+t[1]}function getQueryStringParameterValue(n,t){if(!checkExistsNotEmpty(n))return null;var q=getQueryStringAsObject(t);return q[n.toUpperCase()]}function getQueryStringAsObject(n){var r={};if(checkExistsNotEmpty(n)||(n=getQueryString()),checkExistsNotEmpty(n)&&n.substring(0,1)==="?"){n=n.substring(1,n.length);for(var u=n.split("&"),t=0;t<u.length;t++){var f=u[t],q=f.split("=");if(q.length===2){var e=q[0],o=q[1];r[e.toUpperCase()]=o}}}return r}function getQueryString(){var n=null,t=window.location;return checkExists(t)&&(n=t.search),n}function paramWithEncodeURIComponent(n){var f="";if(checkExists(n)){var t=Object.keys(n);if(t.length!==0){for(var q="",r=0;r<t.length;r++){var e=t[r],u=n[e];checkExists(u)||(u="");q+=encodeURIComponent(e)+"="+encodeURIComponent(u)+"&"}f=q.substring(0,q.length-1)}}return f}function sortArraysByObjectProperty(n){var u=n.data,q=n.objectIndex||0,r=n.property||0,f=n.descending===!0?1:-1,t=n.getPropertyValue;return u.sort(function(n,u){var e,o;typeof t=="function"?(e=t(n),o=t(u),e===o&&(e=t(n,!0),o=t(u,!0))):(e=n[q][r],o=u[q][r]);typeof e=="string"&&typeof o=="string"&&(e=e.toUpperCase(),o=o.toUpperCase());var s=e<o?-1:e>o?1:0;return s*f})}function sortObjectsByProperty(n,t,q){return n.sort(dynamicSort(t,q))}function dynamicSort(n,t){var q=t===!0?1:-1;return function(t,r){var u=t[n],f=r[n];typeof u=="string"&&typeof f=="string"&&(u=u.toUpperCase(),f=f.toUpperCase());var e=u<f?-1:u>f?1:0;return e*q}}function eachPropertyInObjects(n,t){var c=n.callback,r=n.obj,l=checkExists(n.includeInherrited)?n.includeInherrited:!1,e=checkExists(n.returnOnFirstValue)?n.returnOnFirstValue:!1,a=checkExists(n.includeChildren)?n.includeChildren:!1,v=checkExists(n.maxDepth)?n.maxDepth:999999,o=checkExists(n.whitelist)?n.whitelist:null,s=checkExists(n.blacklist)?n.blacklist:null;if(t=t||0,!(t>v))for(var q in r)if(!(r[q]instanceof jQuery)&&(typeof XMLDocument=="undefined"||!(r[q]instanceof XMLDocument))&&!(r[q]instanceof HTMLElement)&&(!checkExists(r[q])||typeof r[q].nodeType=="undefined")&&(l||r.hasOwnProperty(q))){var u=null;if(a&&typeof r[q]=="object"&&(o===null||o.indexOf(q)>0)&&(s===null||s.indexOf(q)===-1))if(Array.isArray(r[q]))for(var f=0;f<r[q].length;f++){t++;var h=$.extend(n,{obj:r[q][f]});if(u=eachPropertyInObjects(h,t),t--,e&&checkExists(u))return u}else{t++;var h=$.extend(n,{obj:r[q]});u=eachPropertyInObjects(h,t);t--}else u=c(q,r[q],r);if(e&&checkExists(u))return u}}function eachObjectInArray(n,t){var o=n.callback,u=n.obj,f=checkExists(n.returnOnFirstValue)?n.returnOnFirstValue:!1,l=checkExists(n.includeInherrited)?n.includeInherrited:!1,a=checkExists(n.maxDepth)?n.maxDepth:999999,s=checkExists(n.whitelist)?n.whitelist:null,h=checkExists(n.blacklist)?n.blacklist:null;if(t=t||0,!(t>a))for(var r in u)if(l||u.hasOwnProperty(r)){var q=null;if(typeof u[r]=="object"&&(s===null||s.indexOf(r)>0)&&(h===null||h.indexOf(r)===-1))if(Array.isArray(u[r]))for(var e=0;e<u[r].length;e++){if(q=o(u[r][e]),f&&checkExists(q))return q;t++;var c=$.extend(n,{obj:u[r][e]});if(q=eachObjectInArray(c,t),t--,f&&checkExists(q))return q}else{if(q=o(u[r]),q===!1)continue;if(f&&checkExists(q))return q;t++;var c=$.extend(n,{obj:u[r]});if(q=eachObjectInArray(c,t),t--,f&&checkExists(q))return q}}}function findObjectInArrayMatchingAny(n){var e=n.queryObject,o=n.targetObject,t=checkExists(n.matchMultiple)?n.matchMultiple:!1,s=checkExists(n.targetPropertiesContainMultipleValues)?n.targetPropertiesContainMultipleValues:!1,h=checkExists(n.circularReferenceProtection)?n.circularReferenceProtection:!1,r=checkExists(n.whitelist)?n.whitelist:null,u=checkExists(n.blacklist)?n.blacklist:null,q=[],f=[],c=eachPropertyInObjects({obj:o,includeInherrited:!1,returnOnFirstValue:!t,maxDepth:n.searchDepth,includeChildren:!0,whitelist:r,blacklist:u,callback:function(n,o,c){if(h===!0){if(f.indexOf(c)>-1)return!1;f.push(c)}var l=eachPropertyInObjects({obj:e,includeInherrited:!1,returnOnFirstValue:!t,includeChildren:!0,whitelist:r,blacklist:u,callback:function(r,u){if(r===n)if(s&&o!==null){for(var e=o.split(","),f=0;f<e.length;f++)if(e[f]===u){if(t){q.push(c);return}return c}}else if(u===c[r]){if(t){q.push(c);return}return c}}});if(!t)return l}});return t?q:c}function findObjectInArrayMatchingAll(n){var f=n.queryObject,e=n.targetObject,t=checkExists(n.matchMultiple)?n.matchMultiple:!1,r=checkExists(n.targetPropertiesContainMultipleValues)?n.targetPropertiesContainMultipleValues:!1,o=checkExists(n.sourcePropertiesContainMultipleValues)?n.sourcePropertiesContainMultipleValues:!1,s=checkExists(n.circularReferenceProtection)?n.circularReferenceProtection:!1,h=checkExists(n.whitelist)?n.whitelist:null,c=checkExists(n.blacklist)?n.blacklist:null,q=[],u=[];return eachObjectInArray({obj:e,includeInherrited:!1,returnOnFirstValue:!t,maxDepth:n.searchDepth,includeChildren:!0,whitelist:h,blacklist:c,callback:function(e){if(s===!0){if(u.indexOf(e)>-1)return!1;u.push(e)}if(e instanceof jQuery||typeof XMLDocument!="undefined"&&e instanceof XMLDocument||e instanceof HTMLElement||checkExists(e)&&typeof e.nodeType!="undefined")return!1;var h=!0;return eachPropertyInObjects({obj:f,includeInherrited:!1,returnOnFirstValue:!0,maxDepth:n.searchDepth,includeChildren:!0,callback:function(t,q){if(o===!0&&typeof q=="string"&&q.indexOf(",")!==-1){for(var u=!1,s=q.split(","),l=s.length,f=0;f<l&&!u;f++){var a=s[f],c=hasMatchingPropertyValue({queryVal:a,targetObj:e,propertyName:t,targetContainsMultipleOptions:r});c&&(u=!0)}if(h=u,!h)return!1}else{checkExistsNotEmpty(n.splitQueryObjectDelimiter)&&typeof q=="string"&&(q=q.decodeSeparator(n.splitQueryObjectDelimiter));var c=hasMatchingPropertyValue({queryVal:q,targetObj:e,propertyName:t,targetContainsMultipleOptions:r});if(!c)return h=!1,!1}}}),h===!0&&(q.push(e),t===!1)?!0:void 0}}),t===!1?q[0]:q}function hasMatchingPropertyValue(n){var q=n.queryVal,f=n.targetObj,o=n.propertyName,s=checkExists(n.targetContainsMultipleOptions)?n.targetContainsMultipleOptions:!1;if(checkExists(f)){var t=f[o];if(typeof t=="string"&&typeof q=="string"&&(t=t.toUpperCase(),q=q.toUpperCase()),checkExists(q)&&checkExists(t)){if(s===!0&&typeof t=="string"&&t.indexOf(",")!==-1){for(var r=!1,e=t.split(","),h=e.length,u=0;u<h&&!r;u++){var c=e[u];c===q&&(r=!0)}return r}return q===t}if(!checkExists(q)&&checkExists(t))return!0}return!1}function replaceTokensInTemplate(n,t,q){if(!checkExists(t)||!checkExistsNotEmpty(n))return n;return n.replace(/{{(.*?)}}/g,function(n){var r=n.replace("{{","").replace("}}",""),u=t.hasOwnProperty(r)?t[r]:"";return q?u.toString().xmlEncode():u})}function mergeTokenizedStringWithModelPropertyValues(n,t){if(!checkExists(t)||!checkExistsNotEmpty(n))return n;return n.replace(/{{(.*?)}}/g,function(n){var r="",q=n.replace("{{","").replace("}}",""),u=q.indexOf("="),f=q.substr(u+1),e=q.substr(0,u);return checkExists(t[f])&&(r='{0}="{1}"'.format(e,t[f])),r})}function $type(n){if(!$defined(n))return!1;if(n.htmlElement)return"element";var t=typeof n;if(t==="object"&&n.nodeName)switch(n.nodeType){case 1:return"element";case 3:return/\S/.test(n.nodeValue)?"textnode":"whitespace"}if(t==="object"||t==="function"){switch(n.constructor){case Array:return"array";case RegExp:return"regexp"}if(typeof n.length=="number"){if(n.item)return"collection";if(n.callee)return"arguments"}}return t}function $merge(){for(var t={},n=0;n<arguments.length;n++)for(var q in arguments[n]){var r=arguments[n][q],u=t[q];t[q]=u&&$type(r)==="object"&&$type(u)==="object"?$merge(u,r):r}return t}var $extend=function(){var n=arguments;n[1]||(n=[this,n[0]]);for(var t in n[1])n[0][t]=n[1][t];return n[0]};function $chk(n){return!!(n||n===0)}function $pick(n,t){return $defined(n)?n:t}function $random(n,t){return Math.floor(Math.random()*(t-n+1)+n)}function $time(){return(new Date).getTime()}function $clear(n){return clearTimeout(n),clearInterval(n),null}function CalculatePerformance(n){if(typeof PerformanceStartTime=="undefined"&&(PerformanceStartTime={},PerformanceTotals={},(typeof console=="undefined"||typeof console.log=="undefined")&&(PerformanceConsole=$("<input id='PerformanceConsole' type='text' value='' style='display:none'/>"),PerformanceConsole.appendTo("body"))),PerformanceStartTime[n]){var q=new Date,t=q.getTime()-PerformanceStartTime[n].getTime();if(checkExists(PerformanceTotals[n])?PerformanceTotals[n]+=t:PerformanceTotals[n]=t,typeof PerformanceConsole=="undefined"){var r="Perf: ({0}): {1}  Total : {2}".format(n,t,PerformanceTotals[n]);console.log(r);typeof console.groupEnd!="undefined"&&console.groupEnd()}else PerformanceConsole.val(PerformanceConsole.val()+"<t>{1}<\/t><\/{0}>".format(n,t));PerformanceStartTime[n]=null}else PerformanceStartTime[n]=new Date,typeof PerformanceConsole=="undefined"?typeof console.group!="undefined"&&console.group(n):PerformanceConsole.val(PerformanceConsole.val()+"<{0}>".format(n))}var LoggingConsole=null,LoggingGrid=null,LoggingDebugValues=null;function translateDebugLevel(n){return checkExists(n)?isNaN(n)?_debuggingTypes.indexOf(n.toLowerCase())+1:parseInt(n,10):null}var _debugPreviousCategory=null,SFLogData="";function WriteExceptionXml(n){for(var t="<{0}>{1}<\/{0}>",r=""+t.format("Message",n.message),u=printStackTrace({e:n,guess:!0}),f="",q=0;q<u.length;q++)f+=t.format("Item",u[q].xmlEncode());return r+=t.format("Trace",f),"<Exception>{0}<\/Exception>".format(r)}var _humateCollectionPopulated=!1,_AssocDictionary={};function queryAssocDictionary(n,t){if(checkExists(n)){var r=_AssocDictionary.length,q=_AssocDictionary[n];return checkExists(q)?q:checkExists(t)?(_AssocDictionary[n+""]=t,t):null}}function _humanateFromDocument(n,t,q,r,u){if(r=checkExists(r)?r:"@ID",u=checkExists(u)?u:"@Name",checkExists(t))for(var s=t.selectNodes(q),c=s.length,o=0;o<c;o++){var h=s[o],f=h.selectSingleNode(r),e=h.selectSingleNode(u);if(checkExists(f)&&f!==""&&checkExists(e)&&e!==""){checkExists(f.text)&&(f=f.text);checkExists(e.text)&&(e=e.text);var l="(Name: '{0}', Id: '{1}')".format(e,f);queryAssocDictionary(f,l)}}return n}function HumanateLookup(n){var q=stringRegularExpressions.findGuids;q.lastIndex=0;var r="",t=0;q.lastIndex=0;for(var u=q.exec(n);u;){var f=q.lastIndex;f>=u[0].length&&(f=f-u[0].length);var o=n.substr(f,u[0].length),e=queryAssocDictionary(o);if(checkExists(e)?(r+=n.substr(t,f-t),r+=e):r+=n.substr(t,f+u[0].length-t),t=q.lastIndex,t===0||t===n.length)break;u=q.exec(n)}return t!==0&&t!==n.length&&(r+=n.substr(t,n.length-t)),r!==""?r:n}function Humanate(n){return typeof n=="string"&&checkExists(n)&&n!==""&&n.containsGuid()?(_humateCollectionPopulated||(_humateCollectionPopulated=!0,_humanateFromDocument(n,viewControllerDefinition,"Controllers/Controller",null,"ViewName"),_humanateFromDocument(n,viewControllerDefinition,"Controllers/Controller/Fields/Field",null,"PropertyName"),_humanateFromDocument(n,viewControllerDefinition,"Controllers/Controller/Controls/Control"),_humanateFromDocument(n,formBindingXml,"Events/Event")),HumanateLookup(n)):n}function buildSFLogRows(){var f=[],q,t;SFLogData="<Logs>";for(var r=0;r<_runtimeSFLogEntries.length;r++){var n=_runtimeSFLogEntries[r];if(q="<Log Time='"+n.logTime+"'",t=[],t.push({display:n.logTime,value:n.logTime}),checkExists(n.type)?(q+=" Type='"+n.type+"'",t.push({display:n.type,value:n.type})):t.push({display:"",value:""}),checkExists(n.category)?(q+=" Category='"+n.category+"'",t.push({display:n.category,value:n.category})):t.push({display:"",value:""}),checkExists(n.source)?(q+=" Source='"+n.source+"'",t.push({display:n.source,value:n.source})):t.push({display:"",value:""}),checkExists(n.message)){var u=n.message.htmlEncode();q+=" Message='"+u+"'";t.push({display:u,value:u})}else t.push({display:"",value:""});q+=">";checkExists(n.data)?(t.push({display:"X",value:r}),q+=n.data.xml):t.push({display:"",value:-1});q+="<\/Log>";SFLogData+=q;f.push(t)}return SFLogData+="<\/Logs>",f}var _runtimeSFLogEntries=[],_runtimeCreateErrorControlsTimeout=null;function SFLog(n){if(checkExists(_debug)){var h=translateDebugLevel(n.type);if(h>=_debug){var u=n.type,e=n.source,r=n.category,q=n.message,c=n.parameters,o=checkExists(n.exception)?WriteExceptionXml(n.exception):null,t=n.data,l=checkExists(t),y=checkExists(n.humanateData)?n.humanateData:!0,f=(new Date).format("yyyy-MM-ddTHH:mm:ss:fff"),s=null;if(l)if(dataString=t.xml,checkExists(dataString)||(dataString=t),y===!0&&(dataString=Humanate(dataString)),typeof t=="string"){typeof"".trimLeft!="function"&&(String.prototype.trimLeft=function(){return this.replace(/^\s+/,"")});var v=t.trimLeft().indexOf("<");if(v===-1||v!==0)try{s=JSON.parse(t)}catch(p){}}else typeof t!="object"||checkExists(t.xml)||(s=t);if(checkExists(s))t={data:s,isJSON:!0},checkExists(o)&&(t.data.exception=o);else{var a="<Data>{0}<\/Data>";l&&checkExists(o)?(dataString=a.format(o+dataString),t=parseXML(dataString).documentElement):checkExists(o)?(dataString=a.format(o),t=parseXML(dataString).documentElement):l&&(dataString=a.format(dataString),t=parseXML(dataString).documentElement)}n.data=t;checkExists(q)&&(checkExists(c)&&c.length>0&&(q=q.format(c)),n.message=Humanate(q));n.logTime=f;u=_debuggingTypes[h-1];n.type=u;_runtimeSFLogEntries.push(n);checkExists(LoggingGrid)||_runtimeCreateErrorControlsTimeout!==null||(_runtimeCreateErrorControlsTimeout=setTimeout(function(){LoggingConsole=$("<textarea id='LoggingConsole' type='multiline' readonly='true' value='' style='display:none; height:99%; width:99%; border:0'><\/textarea>");LoggingDebugValues=$("<textarea id='LoggingDebugValues' type='multiline' readonly='true' value='' style='display:none; height:99%; width:99%; border:0'><\/textarea>");LoggingConsole.appendTo("body");LoggingDebugValues.appendTo("body");LoggingGrid=$(SCGrid.html({id:"LoggingGrid",header:"Logger",toolbars:1,resources:{emptygrid:Resources.CommonPhrases.EmptyGridMessageText,page:Resources.CommonLabels.PagingPageText,pagecount:Resources.CommonLabels.PagingTotalPagesText,actionrow:Resources.CommonActions.AddText},columns:[{display:"Time",name:"time",width:"160px",sortable:!0,align:"left",datatype:"datetime"},{display:"Type",name:"type",width:"60px",sortable:!0,align:"left",datatype:"text"},{display:"Category",name:"category",width:"60px",sortable:!0,align:"left",datatype:"text"},{display:"Source",name:"source",width:"140px",sortable:!0,align:"left",datatype:"text"},{display:"Message",name:"message",sortable:!0,align:"left",datatype:"text",modulus:!0},{display:"Data",name:"data",width:"60px",sortable:!0,align:"left",datatype:"text"}]}));LoggingGrid.appendTo("body");LoggingGrid.grid({rowdblclick:function(){var n=LoggingGrid.grid("fetch","selected-rows").children("td").eq(5).metadata().value;checkExists(n)&&n>-1&&(n=_runtimeSFLogEntries[n].data,checkExists(n)&&(n=n.isJSON===!0?JSON.stringify(n.data):prettyFormatXml(n),LoggingDebugValues.val(n),popupManager.showPopup({id:"LoggingDebugValues_popUp",content:LoggingDebugValues,headerText:"Debugging Data",height:t/10*6,removeContent:!1,showHeaderButtons:!0,width:q/10*6})))}});var n=LoggingGrid.grid("fetch","toolbars").toolbargroup("fetch","toolbars").eq(0).toolbar();n.toolbar("add","button",{id:"clearLogger",icon:"delete",description:"Clear log"});n.toolbar("add","button",{id:"showXml",icon:"settings",description:"Get log XML"});var e=n.toolbar("fetch","buttons").eq(0).on("click",function(){LoggingConsole.val("");SFLogData="";LoggingGrid.grid("clear");_runtimeSFLogEntries=[]});e=n.toolbar("fetch","buttons").eq(1).on("click",function(){LoggingConsole.val(SFLogData);popupManager.showPopup({id:"LoggingConsole_popUp",content:LoggingConsole,headerText:"Logging XML",height:t/10*6,removeContent:!1,showHeaderButtons:!0,width:q/10*6})});LoggingGrid[0].style.display="none";var r=$("<input type='button' id='ShowLog' value='Show Log' />"),u=$("<div style='z-index: 1000; position: absolute; right: 0; top: 0; width:90px;'><\/div>");u.appendTo("body");var f=8,t=Math.floor(jQuery(window).height()/10*f),q=Math.floor(jQuery(window).width()/10*f);r.appendTo(u);r.on("click",function(){LoggingGrid.grid("clear");LoggingGrid.grid("add","rows",buildSFLogRows());LoggingGrid[0].style.display="";popupManager.showPopup({id:"LoggingGrid_popUp",content:LoggingGrid,headerText:"Logging Information",height:t,removeContent:!1,showHeaderButtons:!0,width:q});LoggingGrid.grid("synccolumns")})},0));typeof console!="undefined"&&typeof console.log!="undefined"&&console&&console.log&&setTimeout(function(){var n="";if(checkExists(t)&&(n=t,n.isJSON===!0?n=JSON.stringify(n.data):SourceCode.Forms.Browser.msie&&(n=n.xml)),r!==_debugPreviousCategory&&console.group){checkExists(_debugPreviousCategory)&&console.groupEnd();console.group(r);_debugPreviousCategory=r;switch(h){case 1:console.debug(f,"["+u+"]",q,"("+r+": "+e+")",n);break;case 2:console.log(f,"["+u+"]",q,"("+r+": "+e+")",n);break;case 3:console.info(f,"["+u+"]",q,"("+r+": "+e+")",n);break;case 4:console.warn(f,"["+u+"]",q,"("+r+": "+e+")",n);break;case 5:console.error(f,"["+u+"]",q,"("+r+": "+e+")",n)}}else console.log(f,"["+u+"]",q,"("+r+": "+e+")",n)},0)}}}var PFInstances={};function PFStart(n,t,q){try{if(SourceCode.Forms.Settings.PerformanceMonitoringEnabled){var r=new Date;PFInstances["{0}___{1}___{2}".format(n,t,q)]=r}}catch(u){}}var PFLogToAjax=!1,PFLogToConsole=!0;function PFSuccess(n,t,q){PFEnd(n,t,q,!0)}function PFFailed(n,t,q){PFEnd(n,t,q,!1)}function PFEnd(n,t,q,r){try{if(SourceCode.Forms.Settings.PerformanceMonitoringEnabled){var u=new Date,f=PFInstances["{0}___{1}___{2}".format(n,t,q)];PFLogToConsole&&console.log("PF,{4},{5},{1},{2},{3},{6},{7}".format(applicationRoot,n,t,q,(u.getTime()-f.getTime()).toString(),(!r).toString(),f.toISOString(),u.toISOString()));PFLogToAjax&&jQuery.ajax({url:"{0}Utilities/AjaxCall.ashx?method=LogPerformance&Category={1}&Operation={2}&Instance={3}&Duration={4}&Failed={5}&Start={6}&End={7}".format(applicationRoot,n,t,q,(u.getTime()-f.getTime()).toString(),(!r).toString(),f.toISOString(),u.toISOString()),type:"GET",async:!0,cache:!1,dataType:"xml"})}}catch(e){}}PFStart("PF","Load","");function LogInternalErrorMessage(n,t,q){SFLog({type:4,source:t,category:n,message:q})}(typeof SourceCode=="undefined"||SourceCode===null)&&(SourceCode={});(typeof SourceCode.Forms=="undefined"||SourceCode.Forms===null)&&(SourceCode.Forms={});SourceCode.Forms.BorderBox={featureDetectionRun:!1,supportsHorizontal:!1,supportsVertical:!1,nativeBorderBoxSupport:!1,workingPaddingAndBorders:!0,runFeatureDetection:function(){var n=jQuery("<div class='test-container' style='position:absolute;left:100px;display:inline-block;padding:2px;border:2px solid red;'><div class='test-content' style='display:inline-block;box-sizing: border-box;-moz-box-sizing: border-box;-webkit-box-sizing: border-box;min-width:60px;min-height:50px;padding:2px;border:2px solid black;'><\/div><\/div>");jQuery("body").append(n);var q=n.outerWidth();q===68&&(SourceCode.Forms.BorderBox.supportsHorizontal=!0);var r=n.outerHeight();if(r===58&&(SourceCode.Forms.BorderBox.supportsVertical=!0),SourceCode.Forms.BorderBox.nativeBorderBoxSupport=n.children().first().outerWidth()===60&&n.children().first().outerHeight()===50,n.remove(),checkExists(SourceCode.Forms.Browser.msie)){var t=SourceCode.Forms.Browser.version;t=t.slice(0,t.indexOf("."));(t<9||document.documentMode<9)&&(SourceCode.Forms.BorderBox.workingPaddingAndBorders=!1)}SourceCode.Forms.BorderBox.featureDetectionRun=!0},GetWorkingPaddingAndBorders:function(){return SourceCode.Forms.BorderBox.featureDetectionRun||SourceCode.Forms.BorderBox.runFeatureDetection(),SourceCode.Forms.BorderBox.workingPaddingAndBorders},checkIsBlockElement:function(n){return checkExists(n[0].style.width)&&n[0].style.width==="100%"||n.css("display")==="block"&&n.css("float")==="none"||n.css("position")==="absolute"},fixContainer:function(n,t,q,r,u,f){if(checkExists(n)&&n.length!==0&&!SourceCode.Forms.BorderBox.checkIsBlockElement(n)){SourceCode.Forms.BorderBox.featureDetectionRun||SourceCode.Forms.BorderBox.runFeatureDetection();var c=t.length;if(!SourceCode.Forms.BorderBox.supportsHorizontal&&q===!0){var l=t.widthAll();if(!checkExists(u)||l<u*c){var a=t.outerWidthAll(!0);n.length>0&&(n[0].style.width=a+"px")}}if(!SourceCode.Forms.BorderBox.supportsVertical&&r===!0){for(var o=0,s=0,h=c,e=0;h--;)e=jQuery(t[h]).height(!0),e>o&&(o=e),e=jQuery(t[h]).outerHeight(!0),e>s&&(s=e);(!checkExists(f)||o<f)&&n.length>0&&(n[0].style.height=s+"px")}}}};function getWindowInnerHeight(){return window.innerHeight}function getWindowOuterHeight(){return window.outerHeight}SourceCode.Forms.Layout={_useAnimations:null,useAnimations:function(n){function t(n){if(n)$("html").removeClass("disableAnimations"),$("#disableAnimationsCss").remove();else{$("html").addClass("disableAnimations");$("head").append("<style id='disableAnimationsCss'>html.disableAnimations *{-o-transition-property:none!important;-moz-transition-property:none!important;-ms-transition-property:none!important;-webkit-transition-property:none!important;transition-property:none!important;-o-transform:none!important;-moz-transform:none!important;-ms-transform:none!important;-webkit-transform:none!important;transform:none!important;-webkit-animation:none!important;-moz-animation:none!important;-o-animation:none!important;-ms-animation:none!important;animation:none!important}<\/style>")}}if(checkExists(n)&&(n===!0||n===!1))SourceCode.Forms.Layout._useAnimations=n===!0,t(SourceCode.Forms.Layout._useAnimations);else if(SourceCode.Forms.Layout._useAnimations===null){var q=checkExists(SourceCode.Forms.Settings)&&checkExists(SourceCode.Forms.Settings.Compatibility)&&checkExists(SourceCode.Forms.Settings.Compatibility.UseAnimations),r=q&&!SourceCode.Forms.Layout.isRuntime()?SourceCode.Forms.Settings.Compatibility.UseAnimations:!0;SourceCode.Forms.Layout._useAnimations=r;SourceCode.Forms.Layout._useAnimations||t(SourceCode.Forms.Layout._useAnimations)}return SourceCode.Forms.Layout._useAnimations},_useAnimationsOnPopupClosing:!1,useAnimationsOnPopupClosing:function(){return SourceCode.Forms.Layout._useAnimationsOnPopupClosing},isRuntime:function(){return typeof initializeRuntimeForm=="function"},isLoginPage:function(){return $("#SignInPanel").length>0},checkAndFixView:function(n){if(SourceCode.Forms.Layout.isRuntime()&&checkExists(n)&&n.length!==0&&checkExists(SourceCode.Forms.Browser.msie)&&SourceCode.Forms.Browser.version<9){var t=n.parent();if(t.length>0&&(t=t.parent(),t.hasClass("view"))){var q=t[0];q.style.cssText+=""}}},checkAndFix:function(n){checkExists(SourceCode.Forms.Browser.msie)&&SourceCode.Forms.Browser.version<9&&SourceCode.Forms.Layout.reflowIE(n)},reflowIE:function(n){if(checkExists(n)&&n.length!==0){var t=n[0];t.style.cssText+=""}}};$(SourceCode.Forms.Layout.useAnimations);jQuery.acceptData=function(){return!0},function(n){var t=0;n.Widget.prototype._createWidget=function(q,r){r=n(r||this.defaultElement||this)[0];this.element=n(r);this.uuid=t++;this.eventNamespace="."+this.widgetName+this.uuid;this.bindings=n();this.hoverable=n();this.focusable=n();this.classesElementLookup={};r!==this&&(n.data(r,this.widgetFullName,this),this._on(!0,this.element,{remove:function(n){n.target===r&&this.destroy()}}),this.document=n(r.style?r.ownerDocument:r.document||r),this.window=n(this.document[0].defaultView||this.document[0].parentWindow));this.options=n.widget.extend({},this.options,this._getCreateOptions(),q);this._create();this.options.disabled&&this._setOptionDisabled(this.options.disabled);this._init()}}(jQuery);jQuery.fn.isWidget=function(n){return checkExists(this.data("ui-"+n))?!0:checkExists(this.data("k2-"+n))?!0:!1};function ClickManager(n){return $.extend(this,n||{}),this.timeout=350,this.timer=null,this.source=null,this.clicks=0,this.click=function(n,t,q){if(checkExists(t.originalEvent)&&(t.originalEvent instanceof MouseEvent||checkExists(t.originalEvent.originalEvent)&&t.originalEvent.originalEvent instanceof MouseEvent)){if(this.clicks++,this.clicks>1){if(this.source===t.target){this.reset();return}this.timer&&this.reset()}this.source=t.target;var r=this;this.timer=setTimeout(function(){r.reset();q(n,t)},this.timeout)}else q(n,t)},this.dblClick=function(n,t,q){this.source===t.target&&checkExists(t.originalEvent)&&(t.originalEvent instanceof MouseEvent||checkExists(t.originalEvent.originalEvent)&&t.originalEvent.originalEvent instanceof MouseEvent)&&this.reset();q(n,t)},this.reset=function(){this.source=null;this.clicks=0;clearTimeout(this.timer)},this}checkExists(SourceCode.Forms.Utilities)||(SourceCode.Forms.Utilities={});SourceCode.Forms.Utilities.defineLazyLoadProperty=function(n){try{var t={};checkExists(n.get)&&(t.get=n.get);checkExists(n.set)&&(t.set=n.set);Object.defineProperty(n.object,n.propertyName,t)}catch(q){n.object[n.propertyName]=n.get()}};SourceCode.Forms.BrowserDetection=function(n){var q=n.toLowerCase(),r=/(edge)[ \/]([\w.]+)/.exec(q)||/(chrome)[ \/]([\w.]+)/.exec(q)||/(webkit)[ \/]([\w.]+)/.exec(q)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(q)||/(msie) ([\w.]+)/.exec(q)||/(trident)(?:.*? rv:([\w.]+)|)/.exec(q)||q.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(q)||[],t={};checkExists(r[1])&&(r[1]==="trident"&&(r[1]="msie"),t[r[1]]=!0,t.edge?(t.edgeHTMLVersion=r[2]||"0",t.version=determineEdgeVersionFromEdgeHTMLVersion(t.edgeHTMLVersion)):t.version=r[2]||"0");t.chrome?t.webkit=!0:t.webkit&&(t.safari=!0);$("html.safari.mobile").length>0&&(t.safarimobile=!0);/(iPad)/i.test(q)&&(t.ipad=!0);SourceCode.Forms.Browser=t};function determineEdgeVersionFromEdgeHTMLVersion(n){var t="unknown";if(checkExistsNotEmpty(n)){var u=n.split(".");if(u.length===2){var r=u[1];if(checkExistsNotEmpty(r)&&!isNaN(r)){var q=parseInt(r,10);q>15063?t="latest":q===15063?t="40":q>=14901&&q<=14986?t="39":q>=14342&&q<=14393?t="38":q>=14316&&q<=14327?t="37":q===14291?t="34":q>=14267&&q<=14279?t="31":q===11099?t="27":q===10586?t="25":q===10565?t="23":q===10547?t="21":q>=10166&&q<=10532&&(t="20");q===10049&&(t="0.10");t!=="unknown"&&t!=="latest"&&(t=t+"."+r)}}}return t}SourceCode.Forms.InjectBrowserUserAgentToHtml=function(){var t=navigator.userAgent.toLowerCase(),n=$(document.documentElement),q=parseInt((/msie (\d+)/.exec(t)||[])[1]);isNaN(q)&&(q=parseInt((/trident\/.*; rv:(\d+)/.exec(t)||[])[1]));q>0&&(n.addClass("msie"),n.addClass("ie"+q.toString()),!document.documentMode||n.addClass("ie-document-mode-"+parseInt(document.documentMode,10).toString()));!window.opera&&t.indexOf(" opr/")===-1||(n.addClass("opera"),t.indexOf("webkit")&&n.addClass("webkit"));!window.chrome||t.indexOf("chrome")===-1||t.indexOf(" opr/")!==-1||(t.indexOf("edge")>=0?n.addClass("edge"):n.addClass("webkit chrome"));(typeof InstallTrigger!="undefined"||t.indexOf("firefox")!==-1)&&n.addClass("mozilla firefox");Object.prototype.toString.call(window.HTMLElement).indexOf("Constructor")>0&&n.addClass("webkit safari");SourceCode.Forms.BorderBox.featureDetectionRun||SourceCode.Forms.BorderBox.runFeatureDetection();SourceCode.Forms.BorderBox.nativeBorderBoxSupport||n.addClass("no-border-box-support")};SourceCode.Forms.BrowserDetection(navigator.userAgent);$.widget("sfc.SFCdraggable",$.ui.draggable,{widgetEventPrefix:"drag",widgetName:"draggable",_getParentOffset:function(){return{top:0,left:0}},_cacheHelperProportions:function(){this.helperProportions={width:1,height:1}},_cacheMargins:function(){this.margins={left:0,top:0,right:0,bottom:0}},_mouseStart:function(n){var q=this.element.offset,t=n;this.element.offset=function(){return{top:t.pageX-t.offsetX,left:t.pageY-t.offsetY}};var r=this._generatePosition;this._generatePosition=function(){return this.element.offset()};var u=$.ui.draggable.prototype._mouseStart.apply(this,arguments);return this._generatePosition=r,this.element.offset=q,u},_createHelper:function(){var n=$.ui.draggable.prototype._createHelper.apply(this,arguments);return n.offsetParent=function(){return $("body")},n.scrollParent=function(){return $("html")},n}});$.widget("sfc.SFCPopupdraggable",$.ui.draggable,{widgetEventPrefix:"drag",widgetName:"draggable",_mouseDrag:function(n,t){if(this.hasFixedAncestor&&(this.offset.parent=this._getParentOffset()),this.position=this._generatePosition(n,!0),this.positionAbs=this._convertPositionTo("absolute"),!t){var q=this._uiHash();if(this._trigger("drag",n,q)===!1)return this._mouseUp(new $.Event("mouseup",n)),!1;this.position=q.position}return this.helper[0].style.left=this.position.left+"px",this.helper[0].style.top=this.scrollParent.scrollTop()===0?this.position.top+"px":this.positionAbs.top+"px",$.ui.ddmanager&&$.ui.ddmanager.drag(this,n),!1}});function _removeCursorPluginFromSFCdraggable(){if(checkExists($.sfc.SFCdraggable.prototype.plugins)){var n=$.sfc.SFCdraggable.prototype.plugins;checkExists(n.start)&&n.start[1][0]==="cursor"&&n.start.splice(1,1);checkExists(n.stop)&&n.stop[1][0]==="cursor"&&n.stop.splice(1,1)}}_removeCursorPluginFromSFCdraggable();getDocumentLocationHash=function(){return document.location.hash.substr(1)};getDocumentLocationHashObject=function(){return $.deparam(getDocumentLocationHash())};_removeCursorPluginFromSFCdraggable();getMethodByName=function(n,t){if(!n||!n.length)return null;var q=n.split(".");n=q.pop();do if(!q[0]&&typeof t[n]=="function")return t[n];while(t=t[q.shift()]);return null};getWindowObj=function(){return window};
/*!
 ~/Script/native.forms.objectUtils.js
*/
var SourceCode=SourceCode||{};SourceCode.Forms=SourceCode.Forms||{};SourceCode.Forms.ObjectUtils=SourceCode.Forms.ObjectUtils||{},function(){var n=SourceCode.Forms.ObjectUtils;SourceCode.Forms.ObjectUtils.isEqual=function(t,q){if(Object.keys(t).length!==Object.keys(q).length)return!1;for(prop in t)if(typeof t[prop]!="function")if(typeof t[prop]!="object"){if(q[prop]!==t[prop])return!1}else{var r=n.isEqual(t[prop],q[prop]);if(r===!1)return!1}return!0}}();
/*!
 ~/Script/jquery.Forms.modalizer.js
*/
(function(n){(typeof SourceCode=="undefined"||SourceCode===null)&&(SourceCode={});(typeof SourceCode.Forms=="undefined"||SourceCode.Forms===null)&&(SourceCode.Forms={});(typeof SourceCode.Forms.Utilities=="undefined"||SourceCode.Forms.Utilities===null)&&(SourceCode.Forms.Utilities={});var r=3,t={};function e(){}e.prototype={timeoutId:0,checkSize:function(){window.clearTimeout(this.timeoutId);var f=null,e=null,u=!1;for(var a in t){var r=t[a];if(checkExists(r)&&r.options.autoResize===!0)if(r.options.isJqueryExtension){var c=o(r);for(var s in c)r[s]!==c[s]&&(u=!0,r[s]=c[s]);if(u){var h=r.element[0].style;h.left=r.left+"px";h.top=r.top+"px";h.width=r.width+"px";h.height=r.height+"px"}}else{if(!checkExists(f)||!checkExists(e)){var l=n(document);f=l.width();e=l.height()}checkExists(r.width)&&checkExists(r.height)?(r.width!==f||r.height!==e)&&(u=!0,r.width=f,r.height=e):(r.height=e,r.width=f,u=!1)}}u&&q(t);var v=this;return this.timeoutId=window.setTimeout(function(){v.checkSize()},200),u},beginMonitor:function(){this.monitorStarted=!0;return{visibilityRun:this.checkSize()}},tryEndMonitor:function(){if(this.monitorStarted===!0){for(var n=0,r=t.length;n<r;n++){var q=t[n];if(checkExists(q)&&q.options.autoResize===!0)return!1}window.clearTimeout(this.timeoutId)}return!0}};var u=new e;function q(t){var f=[],h=[],e=null,q=null,u=0,o=0,c=!1,l=null,a=null;for(var y in t)if(q=t[y],checkExists(q)&&(!checkExists(q.options)||!checkExists(q.options.excludeFromVisibilityCalculations)||q.options.excludeFromVisibilityCalculations===!1)){if(!q.isJqueryExtension&&!checkExists(q.width)||!checkExists(q.height)){if(!checkExists(l)||!checkExists(a)){var v=n(document);l=v.width();a=v.height()}q.height=a;q.width=l}for(u=f.length,c=!1;u--;)for(o=f[u].length;o--;){var s=f[u][o];if(r<s.left+s.width-q.left&&r<q.left+q.width-s.left&&r<s.top+s.height-q.top&&r<q.top+q.height-s.top){f[u].push(q);e=q.width*q.height;h[u].area<e&&(h[u].area=e,h[u].modalIndex=f[u].length-1);c=!0;break}}c||(f.push([q]),e=q.width*q.height,h.push({area:e,modalIndex:0}))}for(u=f.length;u--;){var p=h[u];for(e=f[u],o=e.length;o--;){q=e[o];var w=o!==p.modalIndex;q.element.toggleClass("hidden",w)}}}function f(){}f.prototype={show:function(r,f,e,o,s,h){SourceCode.Forms.Layout.isRuntime()||checkExists(SourceCode.Forms.Designers)&&checkExists(SourceCode.Forms.Designers.Common)&&checkExists(SourceCode.Forms.Designers.Common.Context)&&SourceCode.Forms.Designers.Common.Context.toggleCanvasAdornments(!1);var c=this.element,l,v=checkExists(o)&&o===!0?"base2":"base0";checkExists(f)&&typeof f=="string"&&checkExists(frames[f])?(l=frames[f],l=l.document):l=document;(!checkExists(c)||checkExists(e))&&(c=l.createElement("div"),checkExists(e)||(e="".generateGuid(),this.element=c),c.setAttribute("id",e));checkExists(e)||(e=c.id);checkExists(c)&&(c.className=v+" base1 modalizer modal-element");var a=this.ajaxLoader;typeof r=="boolean"&&r===!0?(checkExists(a)||(a=this.ajaxLoader=l.createElement("div"),a.className=v+" base1 ajaxLoader modal-element",c.appendChild(a)),a.style.display="block"):checkExists(a)&&(a.style.display="none");var y=c.parentNode;checkExists(y)&&y===l.body||l.body.appendChild(c);var w=t[e]={left:0,top:0,element:n(c),options:{targetFrame:null,id:e,offset:null,type:null,fixedPosition:o,autoResize:s,isJqueryExtension:!1}};for(property in h)w.options[property]=h[property];var p=!1;if(s){var b=u.beginMonitor();p=b.visibilityRun}return p||q(t),this._applyExtendedOptions(c,h),this},hide:function(n){SourceCode.Forms.Layout.isRuntime()||checkExists(SourceCode.Forms.Designers)&&checkExists(SourceCode.Forms.Designers.Common)&&checkExists(SourceCode.Forms.Designers.Common.Context)&&SourceCode.Forms.Designers.Common.Context.toggleCanvasAdornments(!0);var r;if(checkExists(n)?r=document.getElementById(n):(r=this.element,checkExists(r)&&(n=r.id)),checkExists(r)){var f=r.parentNode;if(checkExists(f)){f.removeChild(r);var e=null;checkExists(t[n])&&(e=t[n].autoResize);t[n]=null;delete t[n];e&&u.tryEndMonitor();q(t)}}return this},_applyExtendedOptions:function(n,t){checkExists(n)&&checkExists(t)&&(typeof t.opacity=="number"?jQuery(n).css("opacity",t.opacity):jQuery(n).css("opacity",""))}};window.modalizer=new f;window.runtimeModalizer=new f;SourceCode.Forms.Utilities.RunModalVisibilityCalculator=q;function o(n){document.msCSSOMElementFloatMetrics=!0;var q=n.modalisedElement,t={left:0,top:0,width:q.outerWidth(),height:q.outerHeight(),calculatePosition:!0};if(n.options.offset){t.left=n.options.offset;t.top=n.options.offset;var r=n.options.offset*2;t.width=t.width-r;t.height=t.height-r}else t.left=0,t.top=0,n.options.addToElement?t.calculatePosition=!1:n.options.overrideAbsolute||q.css("position")!=="absolute"||(t.calculatePosition=!1);if(t.calculatePosition){var u=q.offset();t.left+=u.left;t.top+=u.top;var f=Math.floor(t.left),e=t.left-f;e!==0&&(t.left=f,t.width=t.width+1+Math.round(e));var o=Math.floor(t.top),s=t.top-o;s!==0&&(t.top=o,t.height=t.height+1+Math.round(s))}return q[0].offsetWidth===0&&(t.width=0),q[0].offsetHeight===0&&(t.height=0),document.msCSSOMElementFloatMetrics=!1,t}jQuery.fn.modalize=function(r,f,e,s,h,c){var ut=checkExists(s)&&s===!0?"base2":"base0";c||(c={});for(var g=0;g<this.length;g++)if(typeof r=="boolean"&&(f===null||typeof f=="number")){var w=jQuery(this[g]),a=w.data("modalizerId");checkExists(a)||(a="".generateGuid(),w.data("modalizerId",a));e=e||["modalizer"];typeof e=="String"&&(e=[e]);for(var v=null,nt=e.length,k=null,y=null,p=null,b=nt;b--;){b===nt-1&&(k=a+"_"+e[b],y=n(document.getElementById(k)));var l=t[a];if(r)if(y.length===0){if(!l){l={element:null,modalisedElement:w,options:{targetFrame:null,id:k,offset:f,type:e,fixedPosition:s,autoResize:h,isJqueryExtension:!0}};for(p in c)l.options[p]=c[p];t[a]=l}v=o(l);for(p in v)l[p]=v[p];y=jQuery('<div id="'+k+'" class="'+ut+" "+e[b]+' modal-element"><\/div>').css({left:v.left+"px",top:v.top+"px",width:v.width+"px",height:v.height+"px"}).appendTo(v.calculatePosition?document.body:w);l.element=y;var tt=!1;if(h){var ft=u.beginMonitor();tt=ft.visibilityRun}tt||q(t)}else{var d="";if(l.options.innerPositions&&l.options.innerPositions.length){var qt=l.options.innerPositions.pop();d=" style='";for(var rt in qt)d+=rt+":"+qt[rt];d+="'"}y.append('<div class="'+e[b]+' inner-modal"'+d+"><\/div>")}else if(y.length!==0){t[a]=null;delete t[a];w.data("modalizerId",null);u.tryEndMonitor();y.remove();q(t);break}}}return this};jQuery.fn.showBusy=function(n,t,q){return this.modalize(n,0,["ajaxLoader"],t,q)};jQuery.fn.showBusyModal=function(n,t,q){return this.modalize(n,0,["ajaxLoader","modalizer"],t,q)};jQuery.fn.showControlBusyModal=function(t,q){return q=n.extend({overrideAbsolute:!0,innerPositions:[{right:"3px"}]},q),this.modalize(t,0,["control-loading","modalizer"],!1,!0,q)};jQuery.fn.showControlModal=function(t,q){return q=n.extend({overrideAbsolute:!0},q),this.modalize(t,0,["modalizer"],!1,!0,q)};jQuery.fn.updateControlModal=function(t){var u=this.data("modalizerId");if(typeof u=="string"){var f=n(document.getElementById(u));if(f.length!==0&&t.innerPositions&&t.innerPositions.length)for(var o=t.innerPositions.length,s=f.children();o--;){var q=s.pop(),r=t.innerPositions.pop();if(checkExists(r)&&checkExists(q)&&q.length>0){var h=q.style;for(var e in r)h[e]=r[e]}}}}})(jQuery);
/*!
 ~/Script/jquery.Forms.controls.formfield.js
*/
(function(){(typeof SourceCode=="undefined"||SourceCode===null)&&(SourceCode={});(typeof SourceCode.Forms=="undefined"||SourceCode.Forms===null)&&(SourceCode.Forms={});(typeof SourceCode.Forms.Controls=="undefined"||SourceCode.Forms.Controls===null)&&(SourceCode.Forms.Controls={});SourceCode.Forms.Controls.FormField={html:function(n){var t='<div class="form-field';return n.required!==undefined&&n.required&&(t+=" required"),n.stacked!==undefined&&n.stacked&&(t+=" stacked"),n.boldlabel!==undefined&&n.boldlabel&&(t+=" bold-label"),t+='"',n.id!==undefined&&n.id!==""&&(t+=' id="'+n.id+'"'),t+=">",t+='<label class="form-field-label"',n.forid!==undefined&&n.forid!==""&&(t+=' for="'+n.forid+'"'),t+=">"+n.label+"<\/label>",t+='<div class="form-field-element-wrapper"><\/div>',t+"<\/div>"}};typeof SCFormField=="undefined"&&(SCFormField=SourceCode.Forms.Controls.FormField)})(jQuery);
/*!
 ~/Script/jquery.Forms.controls.textbox.js
*/
(function(n){(typeof SourceCode=="undefined"||SourceCode===null)&&(SourceCode={});(typeof SourceCode.Forms=="undefined"||SourceCode.Forms===null)&&(SourceCode.Forms={});(typeof SourceCode.Forms.Controls=="undefined"||SourceCode.Forms.Controls===null)&&(SourceCode.Forms.Controls={});SourceCode.Forms.Controls.Textbox={_create:function(){var n=this.element;if(this.element.hasClass("input-control")&&this.element.hasClass("text-input")){var q=this.element.find("input[type=text], input[type=password], textarea").eq(0);if(q.length>0)this.element=q;else return this}else n=this.element.parent().closest(".input-control");var r=this.element[0],t=this.element.siblings(".input-control-watermark");if(this.element.prop("disabled")&&n.addClass("disabled"),this.element.prop("readonly")&&n.addClass("read-only"),this._waterMark=t,this._parent=n,this.bind(),SourceCode.Forms.Browser.msie&&this.element.closest(".input-control-wrapper").addClass("msie"),SourceCode.Forms.Browser.safari&&this.element.closest(".input-control-wrapper").addClass("webkit"),SourceCode.Forms.Browser.mozilla&&r.tagName.toUpperCase()==="TEXTAREA"){var u=this.element.attr("rows");u!==""&&this.element.css("height",parseInt(u)*1.2+"em")}window.setTimeout(function(){this.element.val()!==""&&t.length>0&&t.hide()}.bind(this),150);this.specifiedTabIndex=r.getAttribute("tabindex")},bind:function(){var t=this._waterMark,q=this._parent;this.element.on("focus.textbox",function(){this._parent.hasClass("read-only")||(this._parent.addClass("active"),this._waterMark.hide())}.bind(this)).on("blur.textbox",function(){q.removeClass("active");n(this).val()===""&&t.show()}).on("change.textbox",function(){n(this).val()===""?t.show():t.hide()});this.element.on("keydown",function(n){this._trigger("keydown",n)}.bind(this));this._waterMark.on("click",function(){n(this).siblings("input, textarea").prop("disabled")||n(this).siblings("input, textarea").prop("readonly")||(n(this).hide(),n(this).siblings("input, textarea").first().trigger("focus"))})},disable:function(){this.element.prop("disabled",!0);this.element.closest(".input-control.text-input").eq(0).addClass("disabled");this.specifiedTabIndex=this.element[0].getAttribute("tabindex");this.element[0].setAttribute("tabindex","-1")},readonly:function(){this.element.prop("readonly",!0);this.element.closest(".input-control.text-input").eq(0).addClass("read-only")},enable:function(){this.element.prop("disabled",!1);this.element.closest(".input-control.text-input").eq(0).removeClass("disabled");this.element[0].setAttribute("tabindex",this.specifiedTabIndex)},editable:function(){this.element.prop("readonly",!1);this.element.closest(".input-control.text-input").eq(0).removeClass("read-only")},find:function(){switch(arguments[0]){case"watermark":return this.element.siblings(".input-control-watermark");case"element":return jQuery(this.element)}},setReadOnly:function(n){n===!0?this.readonly():n===!1&&this.editable()},setToolTip:function(n){if(checkExistsNotEmpty(n)){var t=this.element.closest(".input-control.text-input");t.length!==0&&checkExistsNotEmpty(t[0].getAttribute("title"))&&t[0].removeAttribute("title");this.element[0].setAttribute("title",n)}},getValue:function(){return jQuery(this.element).val()},setValue:function(){jQuery(this.element).val(arguments[0])},getWatermark:function(){var n=this.find("watermark");return n.text()},setWatermark:function(){var n=this.find("watermark");n.text(arguments[0])},showWatermark:function(){var n=this.find("watermark");n.show()},hideWatermark:function(){var n=this.find("watermark");n.hide()},html:function(n){var t='<div class="input-control text-input';n!==undefined&&n.icon!==undefined&&n.icon!==""&&(t+=" icon-control "+n.icon);n!==undefined&&n.disabled!==undefined&&n.disabled&&(t+=" disabled");n!==undefined&&n.cssClass!==undefined&&n.cssClass!=""&&(t+=" "+n.cssClass);t+='">';t+='<div class="input-control-t"><div class="input-control-t-l"><\/div><div class="input-control-t-c"><\/div><div class="input-control-t-r"><\/div><\/div><div class="input-control-m"><div class="input-control-m-l"><\/div><div class="input-control-m-c">';t+='<div class="input-control-wrapper'+(SourceCode.Forms.Browser.msie?" msie":SourceCode.Forms.Browser.safari?" webkit":"")+'">';var q={};return n!==undefined&&n.rows!==undefined&&parseInt(n.rows)>1?(t+='<textarea cols="" rows="'+n.rows+'" class="input-control',n!==undefined&&n.watermark!==undefined&&n.watermark!==""&&(q={},q.watermark=n.watermark,t+='" data-options="'+jQuery.toJSON(q).htmlEncode()),t+='"',n!==undefined&&n.id!==undefined&&n.id!==""&&(t+=' id="'+n.id+'"'),n!==undefined&&n.disabled!==undefined&&n.disabled&&(t+=' disabled="disabled"'),n!==undefined&&n.readonly!==undefined&&n.readonly&&(t+=' readonly="readonly"'),n!==undefined&&n.description!==undefined&&n.description!==""&&(t+=' title="'+n.description.htmlEncode()+'"'),t+=">",n!==undefined&&n.value!==undefined&&n.value!==""&&(t+=typeof n.value=="string"?n.value.htmlEncode():n.value),t+="<\/textarea>"):(t+='<input type="'+(n!==undefined&&n.password!==undefined&&n.password?"password":"text")+'" class="input-control',n!==undefined&&n.watermark!==undefined&&n.watermark!==""&&(q={},q.watermark=n.watermark,t+='" data-options="'+jQuery.toJSON(q).htmlEncode()),t+='"',checkExists(n)&&checkExistsNotEmpty(n.ngModel)&&(t+='data-ng-model="{0}"'.format(n.ngModel)),n!==undefined&&n.id!==undefined&&n.id!==""&&(t+=' id="'+n.id+'"'),n!==undefined&&n.value!==undefined&&n.value!==""&&(t+=typeof n.value=="string"?' value="'+n.value.htmlEncode()+'"':' value="'+n.value+'"'),n!==undefined&&n.disabled!==undefined&&n.disabled&&(t+=' disabled="disabled"'),n!==undefined&&n.readonly!==undefined&&n.readonly&&(t+=' readonly="readonly"'),n!==undefined&&n.description!==undefined&&n.description!==""&&(t+=' title="'+n.description.htmlEncode()+'"'),t+="/>"),n!==undefined&&n.watermark!==undefined&&n.watermark!==""&&(t+='<div class="input-control-watermark"',n!==undefined&&n.value!==undefined&&n.value!==""&&(t+=' style="display:none;"'),t+=">"+n.watermark.htmlEncode()+"<\/div>"),t+="<\/div>",t+='<\/div><div class="input-control-m-r"><\/div><\/div>',t+='<div class="input-control-b"><div class="input-control-b-l"><\/div><div class="input-control-b-c"><\/div><div class="input-control-b-r"><\/div><\/div>',t+"<\/div>"}};typeof SCTextbox=="undefined"&&(SCTextbox=SourceCode.Forms.Controls.Textbox);n.widget("ui.textbox",SourceCode.Forms.Controls.Textbox);n(document).ready(function(){n(".input-control.text-input").filter(function(){return!n(this).hasClass("SFC")}).textbox()});n.extend(n.ui.textbox,{getter:"find getValue",setter:"setValue"})})(jQuery);
/*!
 ~/Script/jquery.Forms.controls.lookupbox.js
*/
(function(n){var t=/(iPhone|iPad)/i;(typeof SourceCode=="undefined"||SourceCode===null)&&(SourceCode={});(typeof SourceCode.Forms=="undefined"||SourceCode.Forms===null)&&(SourceCode.Forms={});(typeof SourceCode.Forms.Controls=="undefined"||SourceCode.Forms.Controls===null)&&(SourceCode.Forms.Controls={});SourceCode.Forms.Controls.LookupBox={options:{selector:"input[type=text]",focusViaClick:!1},_create:function(){this.watermarkElement=this.element.find(".input-control-watermark");this.controlValueIsEmpty()===!1&&this.watermarkElement.hide();this.evaluateRegex(t,navigator.userAgent)&&evalCommon("SourceCode.Forms.Settings.Compatibility.DisablePickerWatermarksOnIOS")&&this.watermarkElement.addClass("hide-watermark");checkExistsNotEmpty(this.watermarkElement.text().trim())||this.watermarkElement.addClass("empty")},value:function(n){var t=this.element.find("input[type='text']");t.val(n)},inputOnFocus:function(t){n(t.target).is(this.options.selector)&&(this.element.addClass("active"),this.watermarkElement.hide())},inputOnBlur:function(t){n(t.target).is(this.options.selector)&&(this.options.focusViaClick=!1,this.element.removeClass("active"),this.controlValueIsEmpty()===!0&&this.watermarkElement.show())},watermarkOnClick:function(){this.options.focusViaClick=!0;this.element.find(this.options.selector).trigger("focus")},focus:function(){this.element.hasClass("disabled")||this.element.hasClass("read-only")||(this.options.focusViaClick=!1,this.element.find(this.options.selector).trigger("focus"))},controlValueIsEmpty:function(){if(typeof this.options.controlValueIsEmptyMethod=="function"&&checkExists(this.options.controlToEvalute))return this.options.controlValueIsEmptyMethod(this.options.controlToEvalute);var n=this.element.find(this.options.selector);return n.val()===""},disable:function(){this.element.addClass("disabled");n.Widget.prototype.disable.apply(this,arguments)},readonly:function(){this.element.addClass("read-only");n.Widget.prototype.disable.apply(this,arguments)},enable:function(){this.element.removeClass("disabled");this.element.hasClass("read-only")||n.Widget.prototype.enable.apply(this,arguments)},editable:function(){this.element.removeClass("read-only");this.element.hasClass("disabled")||n.Widget.prototype.enable.apply(this,arguments)},find:function(){var n;return arguments[0]==="watermark"&&(n=this.watermarkElement),n},html:function(n){var t='<div class="input-control select-box lookup-box';n!==undefined&&n.disabled!==undefined&&n.disabled&&(t+=" disabled");n!==undefined&&n.icon!==undefined&&n.icon!==""&&(t+=" icon-control "+n.icon);t+='"';var q;return n!==null&&(q=[' id="',n.id,"_base",'"']),q!==null&&(t+=q.join("")),t+='><div class="input-control-body"><div class="input-control-t"><div class="input-control-t-l"><\/div><div class="input-control-t-c"><\/div><div class="input-control-t-r"><\/div><\/div><div class="input-control-m"><div class="input-control-m-l"><\/div><div class="input-control-m-c"><div class="input-control-wrapper">',t+='<input type="text" class="input-control"',q!==null&&(q.splice(2,1),t+=q.join("")),n!==undefined&&n.value!==undefined&&n.value!==""&&(t+=' value="'+n.value+'"'),n!==undefined&&n.disabled!==undefined&&n.disabled&&(t+=' disabled="disabled"'),n!==undefined&&n.readonly!==undefined&&n.readonly&&(t+=' readonly="readonly"'),t+="/>",n!==undefined&&n.watermark!==undefined&&n.watermark!==""&&(t+='<div class="input-control-watermark"',n!==undefined&&n.value!==undefined&&n.value!==""&&(t+=' style="display:none;"'),t+=">"+n.watermark+"<\/div>"),t+='<\/div><\/div><div class="input-control-m-r"><\/div><\/div><div class="input-control-b"><div class="input-control-b-l"><\/div><div class="input-control-b-c"><\/div><div class="input-control-b-r"><\/div><\/div><\/div>',t+='<div class="input-control-buttons"><a id="'+(n!==undefined&&n.buttonId!==undefined&&n.buttonId?n.buttonId:"")+'" class="'+(n!==undefined&&n.buttonIcon!==undefined&&n.buttonIcon?n.buttonIcon:"ellipsis")+'" href="javascript:;"><span><span>...<\/span><\/span><\/a><\/div>',t+"<\/div>"},evaluateRegex:function(n,t){return n.test(t)}};typeof SCLookupBox=="undefined"&&(SCLookupBox=SourceCode.Forms.Controls.LookupBox);n.widget("ui.lookupbox",SourceCode.Forms.Controls.LookupBox);n.extend(n.ui.lookupbox.prototype,{getter:"find"});n(function(){n(".input-control.lookup-box").lookupbox();n(document).on("focus.lookup",".input-control.lookup-box:not(.disabled):not(.read-only)",function(t){n(this).lookupbox().lookupbox("inputOnFocus",t)});n(document).on("blur.lookup",".input-control.lookup-box:not(.disabled):not(.read-only)",function(t){n(this).lookupbox().lookupbox("inputOnBlur",t)});n(document).on("click.lookup touchstart.lookup",".input-control.lookup-box:not(.disabled):not(.read-only) .input-control-watermark",function(t){n(this).closest(".input-control.lookup-box").lookupbox().lookupbox("watermarkOnClick",t)})})})(jQuery);
/*!
 ~/Script/jquery.Forms.controls.checkradio.js
*/
(function(n){(typeof SourceCode=="undefined"||SourceCode===null)&&(SourceCode={});(typeof SourceCode.Forms=="undefined"||SourceCode.Forms===null)&&(SourceCode.Forms={});(typeof SourceCode.Forms.Controls=="undefined"||SourceCode.Forms.Controls===null)&&(SourceCode.Forms.Controls={});SourceCode.Forms.Controls.CheckboxRadioShared={_create:function(t){var f=this.options,q=null;this.element[0].tagName.toLowerCase()==="label"?(q=this.element,this.element.addClass("input-control"),t!="radio"&&this.element.addClass("checkbox"),this.element=n(this.element.children("input")[0])):this.element.parent()[0].tagName.toLowerCase()!=="label"?(this.element.wrap('<label class="input-control {0}"><\/label>'.format(t)),q=this.element.parent()):(q=this.element.parent(),q.addClass("input-control").addClass(t));this.element.addClass("input-control");var r=this.element[0],e=r.getAttribute("checked");checkExists(e)&&e==="checked"&&q.addClass("checked");q.hasClass("read-only")&&r.setAttribute("disabled","disabled");var u=r.getAttribute("title");if(checkExists(u)&&u!==""&&r.setAttribute("title",u),q.children(".input-control-img").length===0&&q.append('<span class="input-control-img"><\/span>'),q.children(".input-control-text").length===0){var o=q.text(),s=q.contents().filter(function(){return this.nodeType===3}).remove();q.append('<span class="input-control-text">'+o+"<\/span>")}f.icon!==""&&(q.addClass("icon-control").addClass(f.icon),q.children(".input-control-icon").length===0&&n('<span class="input-control-icon"><\/span>').insertBefore(q.children(".input-control-text")))},html:function(t,q){checkExists(t)||(t={checked:!1,disabled:!1,readonly:!1});var e=checkExists(t)&&checkExistsNotEmpty(t.ngModel);checkExists(t.checked)||(t.checked=!1);checkExists(t.disabled)||(t.disabled=!1);checkExists(t.readonly)||(t.readonly=!1);t.checked==="true"&&(t.checked=!0);t.checked==="false"&&(t.checked=!1);t.disabled==="true"&&(t.disabled=!0);t.disabled==="false"&&(t.disabled=!1);t.readonly==="true"&&(t.readonly=!0);t.readonly==="false"&&(t.readonly=!1);var r='<label class="input-control style-aware '+q;checkExists(t.icon)&&t.icon!==""&&(r+=" icon-control "+t.icon);t.checked===!0&&(r+=" checked");t.disabled===!0&&(r+=" disabled");t.readonly===!0&&(r+=" read-only");r+='"';e&&(r+=' data-ng-class="{checked: {0}}"'.format(t.ngModel));checkExists(t.description)&&t.description!==""&&(r+=' title="'+t.description.htmlEncode()+'"');var u=t.id;checkExists(u)&&(r+=' id="{0}_base" for="{0}"'.format(u));checkExists(t.isJoinOnDisplay)&&t.isJoinOnDisplay!==""&&(r+=' isJoinOnDisplay ="{0}" '.format(t.isJoinOnDisplay));r+=">";r+='<span class="input-control-img"><\/span>';checkExists(t.icon)&&t.icon!==""&&(r+='<span class="input-control-icon"><\/span>');var f=".style-aware-{0}-svg".replace("{0}",q);if(n(f).length>0){var o=n(f+" > svg")[0];r+=o.outerHTML;n(f).slice(1).remove()}return r+='<span class="input-control-text">'+(checkExists(t.label)&&t.label!==""?t.label.htmlEncode():"")+"<\/span>",r+='<input type="{0}"'.format(q),checkExists(u)&&(r+=' id="{0}"'.format(u)),e&&(r+=' data-ng-model="{0}"'.format(t.ngModel),r+=' data-ng-class="{checked: {0}}"'.format(t.ngModel)),r+=' class="input-control',checkExists(t.skipCreateChecks)&&t.skipCreateChecks===!0&&(r+=" sc "),r+='"',checkExists(t.tabIndex)&&(r+=' tabindex="'+t.tabIndex+'"'),checkExists(t.value)&&(r+=' value="'+t.value.htmlEncode()+'"'),checkExists(t.name)&&(r+=' name="'+t.name.htmlEncode()+'"'),t.checked===!0&&(r+=' checked="checked"'),(t.disabled===!0||t.readonly===!0)&&(r+=' disabled="disabled"'),checkExists(t.isChanged)&&(r+=' isChanged ="{0}" '.format(t.isChanged)),r+="/>",r+"<\/label>"}};SourceCode.Forms.Controls.Checkbox={_create:function(){this.element.hasClass("sc")||SourceCode.Forms.Controls.CheckboxRadioShared._create.apply(this,["checkbox"]);var t=this.element.closest("label.input-control");this.element.on("click",function(){return n(this).is(":checked")?t.addClass("checked"):t.removeClass("checked"),!0}).on("focus",function(){t.addClass("focus")}).on("blur",function(){t.removeClass("focus")})},focus:function(){this.element.trigger("focus")},disable:function(){this.element.prop("disabled",!0);this.element.parent().addClass("disabled");this.element.toggleClass("ui-state-disabled",!0);n.Widget.prototype.disable.apply(this,arguments)},enable:function(){var t=this.element.parent();t.removeClass("disabled");t.hasClass("read-only")||(this.element.prop("disabled",!1),this.element.toggleClass("ui-state-disabled",!1),n.Widget.prototype.enable.apply(this,arguments))},editable:function(){var t=this.element.parent();t.removeClass("read-only");t.hasClass("disabled")||(this.element.prop("disabled",!1),this.element.toggleClass("ui-state-disabled",!1),n.Widget.prototype.enable.apply(this,arguments))},isChecked:function(){return this.element[0].checked},check:function(){var n=this.element.parent();n.removeClass("indeterminate");this.element.prop("checked",!0);n.addClass("checked");this.element[0].checked=!0},setValue:function(n){var t=n===!0;t?this.check():this.uncheck()},uncheck:function(){var n=this.element.parent();n.removeClass("indeterminate");this.element.prop("checked",!1);n.removeClass("checked");this.element[0].checked=!1},indeterminate:function(){var n=this.element.parent();this.element.prop("checked",!1);n.removeClass("checked");n.addClass("indeterminate")},disabled:function(){this.element.prop("disabled",!0);this.element.parent().addClass("disabled");this.element.toggleClass("ui-state-disabled",!0);n.Widget.prototype.disable.apply(this,arguments)},enabled:function(){var t=this.element.parent();t.removeClass("disabled");t.hasClass("read-only")||(this.element.prop("disabled",!1),this.element.toggleClass("ui-state-disabled",!1),n.Widget.prototype.enable.apply(this,arguments))},readonly:function(){this.element.prop("disabled",!0);this.element.parent().addClass("read-only");this.element.toggleClass("ui-state-disabled",!0);n.Widget.prototype.disable.apply(this,arguments)},html:function(n){return SourceCode.Forms.Controls.CheckboxRadioShared.html.apply(this,[n,"checkbox"])}};typeof SCCheckbox=="undefined"&&(SCCheckbox=SourceCode.Forms.Controls.Checkbox);n.widget("ui.checkbox",SourceCode.Forms.Controls.Checkbox);n.extend(n.ui.checkbox.prototype,{options:{icon:""}});SourceCode.Forms.Controls.Radiobutton={_create:function(){var n=this.element.closest("label.input-control");this.element.hasClass("sc")||SourceCode.Forms.Controls.CheckboxRadioShared._create.apply(this,["radio"]);this.element.on("click",function(){this.check();n.trigger("focus")}.bind(this)).on("focus",function(){n.addClass("focus");this._trigger("focus")}.bind(this)).on("blur",function(){n.removeClass("focus")})},focus:function(){this.element.trigger("focus")},check:function(){var t=this.element.prop("name"),u=checkExistsNotEmpty(t),q=u?n("input.input-control[type=radio][name='{0}']".format(t)):[],r=q.length>0?q:this.element.closest("ul").find("li label");r.prop("checked",!1);r.closest("label.input-control.radio").removeClass("checked");this.element.prop("checked",!0);this.element.closest("label.input-control").addClass("checked");this._trigger("change")},uncheck:function(){this.element.prop("checked",!1);this.element.closest("label.input-control").removeClass("checked")},disable:function(){this.element.prop("disabled",!0);this.element.parent().addClass("disabled");this.element.toggleClass("ui-state-disabled",!0);n.Widget.prototype.disable.apply(this,arguments)},readonly:function(){this.element.prop("disabled",!0);this.element.toggleClass("ui-state-disabled",!0);this.element.parent().addClass("read-only");n.Widget.prototype.disable.apply(this,arguments)},enable:function(){var t=this.element.parent();t.removeClass("disabled");t.hasClass("read-only")||(this.element.prop("disabled",!1),this.element.toggleClass("ui-state-disabled",!1),n.Widget.prototype.enable.apply(this,arguments))},editable:function(){var t=this.element.parent();t.removeClass("read-only");t.hasClass("disabled")||(this.element.prop("disabled",!1),this.element.toggleClass("ui-state-disabled",!1),n.Widget.prototype.enable.apply(this,arguments))},disabled:function(){this.element.prop("disabled",!0);this.element.parent().addClass("disabled")},enabled:function(){this.element.prop("disabled",!1);this.element.parent().removeClass("disabled");this.element.parent().removeClass("read-only")},html:function(n){return SourceCode.Forms.Controls.CheckboxRadioShared.html.apply(this,[n,"radio"])},destroy:function(){this.element.off().removeData()}};typeof SCRadiobutton=="undefined"&&(SCRadiobutton=SourceCode.Forms.Controls.Radiobutton);n.widget("ui.radiobutton",SourceCode.Forms.Controls.Radiobutton);n.extend(n.ui.radiobutton.prototype,{options:{icon:""}});SourceCode.Forms.Controls.CheckboxGroup={disable:function(){this.element.find("input[type=checkbox]").checkbox("disable");n.Widget.prototype.disable.apply(this,arguments)},enable:function(){this.element.find("input[type=checkbox]").checkbox("enable");n.Widget.prototype.enable.apply(this,arguments)},check:function(){typeof arguments[0]!="undefined"?this.element.find("input[type=checkbox]").eq(arguments[0]).checkbox("check"):this.element.find("input[type=checkbox]").checkbox("check")},uncheck:function(){this.element.find("input[type=checkbox]").checkbox("uncheck")},html:function(n){(typeof n.collapsed=="undefined"||n.collapsed===null)&&(n.collapsed=!1);var t='<ul class="input-control-group checkbox';return n.collapsed&&(t+=" collapsed"),t+='"',typeof n.id!="undefined"&&n.id!==""&&(t+=' id="'+n.id+'"'),t+"><\/ul>"},add:function(){var t="<li>"+SCCheckbox.html(arguments[0])+"<\/li>";typeof arguments[1]=="undefined"||isNaN(parseInt(arguments[1],10))?n(t).appendTo(this.element).find("input[type=checkbox]").checkbox():n(t).insertBefore(this.element.children("li").eq(arguments[1])).find("input[type=checkbox]").checkbox()},clear:function(){this.element.find("input[type=checkbox]").checkbox("destroy");this.element.children("li").remove()},hasItems:function(){return this.element.children("li").length>0}};typeof SCCheckboxGroup=="undefined"&&(SCCheckboxGroup=SourceCode.Forms.Controls.CheckboxGroup);n.widget("ui.checkboxgroup",SourceCode.Forms.Controls.CheckboxGroup);SourceCode.Forms.Controls.RadiobuttonGroup={disable:function(){this.element.find("input[type=radio]").radiobutton("disable");n.Widget.prototype.disable.apply(this,arguments)},enable:function(){this.element.find("input[type=radio]").radiobutton("enable");n.Widget.prototype.enable.apply(this,arguments)},clear:function(){var t=n(this.element).closest("ul").find("li label");t.removeClass("checked");t.eq(0).addClass("checked")},value:function(t){if(checkExists(t)){var q=n(this.element).closest("ul").find("li label");q.removeClass("checked");q.each(function(){if(n(this).text()===t){n(this).addClass("checked");return}})}else{var r=n(this.element).closest("ul").find("li label.checked");return r.text()}},html:function(n){(typeof n.collapsed=="undefined"||n.collapsed===null)&&(n.collapsed=!1);var t='<ul class="input-control-group radio';return n.collapsed&&(t+=" collapsed"),t+='"',typeof n.id!="undefined"&&n.id!==""&&(t+=' id="'+n.id+'"'),t+"><\/ul>"},add:function(){var t="<li>"+SCRadiobutton.html(arguments[0])+"<\/li>",q={change:function(){this._trigger("change")}.bind(this),focus:function(){this._trigger("focus")}.bind(this)};typeof arguments[1]=="undefined"||isNaN(parseInt(arguments[1],10))?n(t).appendTo(this.element).find("input[type=radio]").radiobutton(q):n(t).insertBefore(this.element.children("li").eq(arguments[1])).find("input[type=checkbox]").radiobutton(q)}};typeof SCRadiobuttonGroup=="undefined"&&(SCRadiobuttonGroup=SourceCode.Forms.Controls.RadiobuttonGroup);n.widget("ui.radiobuttongroup",SourceCode.Forms.Controls.RadiobuttonGroup);n(function(){n("input.input-control[type=checkbox]").checkbox();n("input.input-control[type=radio]:not(.rbs)").radiobutton();n(".input-control-group.checkbox").checkboxgroup();n(".input-control-group.radio").radiobuttongroup()})})(jQuery);
/*!
 ~/Script/jquery.Forms.controls.dropdown.js
*/
(function(n){(typeof SourceCode=="undefined"||SourceCode===null)&&(SourceCode={});(typeof SourceCode.Forms=="undefined"||SourceCode.Forms===null)&&(SourceCode.Forms={});(typeof SourceCode.Forms.Controls=="undefined"||SourceCode.Forms.Controls===null)&&(SourceCode.Forms.Controls={});var t=/(iPad|iPhone|iPod touch)/i;SourceCode.Forms.Controls.DropDown={popupVerticalOffsetFromControl:"3",options:{isModalized:!1,initialDisplayValue:null,defaultRightBorder:1,additionalModalSpacing:2},uniqueNameSpacePrefix:"",mousedownNameSpaceEvent:"mousedown.dropdown-{0}",dragNameSpaceEvent:"drag.dropdown-{0}",scrollNameSpaceEvent:"scroll.dropdown-{0}",_create:function(){var q=null;typeof this.options.width!="undefined"&&this.options.width==="inherit"?q=this.element.width()+26+"px":typeof this.options.width=="undefined"&&typeof this.element[0].style.width!="undefined"&&(q=this.element[0].style.width);var s=n(this.element).children("OPTION");s.length==0&&checkExists(this.options.items)&&this.options.items.length==0&&(this.options.items=[]);this.element[0].style.display="none";var t="",u="";if(this.element[0].id!==null){var f=this.element[0].id.lastIndexOf("_");f>0&&(t=' id="'+this.element[0].id.substring(0,f),u=t+'_droplist"',t=t+'"');this.uniqueNameSpacePrefix=this.element[0].id}else this.uniqueNameSpacePrefix="".generateGuid();this.mousedownNameSpaceEvent=this.mousedownNameSpaceEvent.format(this.uniqueNameSpacePrefix);this.dragNameSpaceEvent=this.dragNameSpaceEvent.format(this.uniqueNameSpacePrefix);this.scrollNameSpaceEvent=this.scrollNameSpaceEvent.format(this.uniqueNameSpacePrefix);var e=this.element.hasClass("icon-control")?" icon-control":"";this.control=n("<div"+t+' class="input-control select-box dropdown-box'+e+'"'+(q!==null?' style="width:'+q+';"':"")+'><div class="styling-outer-wrapper"><div class="input-control-body  styling-left styling-inner-wrapper"><div class="input-control-t"><div class="input-control-t-l"><\/div><div class="input-control-t-c"><\/div><div class="input-control-t-r"><\/div><\/div><div class="input-control-m"><div class="input-control-m-l"><\/div><div class="input-control-m-c"><div class="input-control-wrapper"><a href="javascript:;" tabindex="'+this.element[0].tabIndex+'" class="input-control  styling-font"><span class="styling-font"><\/span><\/a><\/div><\/div><div class="input-control-m-r"><\/div><\/div><div class="input-control-b"><div class="input-control-b-l"><\/div><div class="input-control-b-c"><\/div><div class="input-control-b-r"><\/div><\/div><\/div><div class="input-control-buttons styling-right styling-inner-wrapper"><a href="javascript:;" tabIndex="-1" class="dropdown border-left-only"><span><span>...<\/span><\/span><\/a><\/div><\/div><\/div>').insertAfter(this.element);this.dropdown=n("<div"+u+' class="drop-menu'+e+'" style="display:none"><div class="drop-menu-t"><div class="drop-menu-t-l"><\/div><div class="drop-menu-t-c"><\/div><div class="drop-menu-t-r"><\/div><\/div><div class="drop-menu-m"><div class="drop-menu-m-l"><\/div><div class="drop-menu-m-c"><div class="drop-menu-wrapper"><ul class="drop-menu"><\/ul><\/div><\/div><div class="drop-menu-m-r"><\/div><\/div><div class="drop-menu-b"><div class="drop-menu-b-l"><\/div><div class="drop-menu-b-c"><\/div><div class="drop-menu-b-r"><\/div><\/div><\/div>').appendTo(n("body"));this.element[0].tabIndex="-1";this.icon="";this.element.hasClass("icon-control")&&(this.control.addClass("icon-control"),this.dropdown.addClass("icon-control"),this.control.find(".input-control-icon").length===0&&this.control.children(".input-control-l").html('<div class="input-control-icon"><\/div>'));var r=this.element.attr("title");if(r!==undefined&&r!==null&&r!==""&&this.control.attr("title",r),this.element.hasClass("small")&&this.control.addClass("small"),this.overflown=!1,this.selected=null,this.menu=n(this.dropdown.find("ul.drop-menu")[0]),this.menuWrapper=this.menu.parent(),this.changetimer=null,this._loadOptions(),this._applyOptionEventHandlers(),this.previouslySelected=0,this.userSearchString=[],this.searchStartTime=null,this.searchCounter=0,!this.options.disableHideScrollable&&SourceCode.Forms.Layout.isRuntime()&&(this.options.disableHideScrollable=!0),!this.options.disableHideScrollable)this.element.parents(":scrollable").on("scroll",this._hideDropdown.bind(this));var o=this.element[0];this.element.prop("disabled")&&this.disable();checkExists(o.getAttribute("data-readonly"))&&this.readonly();o.getAttribute("data-isvisible")==="false"&&this.hide();this.options.defaultHasBeenApplied=!1;this.options.defaultIndex=0;this.canOpenDropdown=!0;this.openDropdownDelay=2e3;this.canOpenDropdownTimeoutHandle=null},_destroy:function(){n(window).off("scroll.dropdown");n("body",document).off("scroll.dropdown");n(document).off("mousedown.dropdown");this.element.show();this.control.remove();this.dropdown.remove();this.options.disableHideScrollable||this.element.parents(":scrollable").off("scroll")},disable:function(){this.control.addClass("disabled");n.Widget.prototype.disable.apply(this,arguments)},readonly:function(){this.control.addClass("read-only");n.Widget.prototype.disable.apply(this,arguments)},editable:function(){this.control.removeClass("read-only");this.control.hasClass("disabled")||n.Widget.prototype.enable.apply(this,arguments)},enable:function(){this.control.removeClass("disabled");this.control.hasClass("read-only")||n.Widget.prototype.enable.apply(this,arguments)},refresh:function(){var n=!1;if(this.dropdown[0].style.display!=="none"&&(this.dropdown[0].style.display="none",n=!0),this.menu.empty(),this._loadOptions(),n){var t=this;setTimeout(function(){t._handleKeyPressOpen()},0)}},SpecifyDefaultIndex:function(n){if(checkExists(n)){var t=parseInt(n);isNaN(t)?SFLog({type:3,source:"specifyDefaultIndex",category:"Dropdown functions",message:"Attempted to set the default index to a non-numeric value"}):this.options.defaultIndex=t}},SelectDefaultValue:function(){return checkExists(this.options.defaultIndex)&&typeof this.options.defaultIndex=="number"?(this._selectValue(this.options.defaultIndex,!this.options.defaultHasBeenApplied),this.options.defaultHasBeenApplied=!0,!0):(SFLog({type:3,source:"selectDefaultValue",category:"Dropdown functions",message:"Default index is not a number"}),!1)},refreshDisplay:function(){this._refreshValue()},hide:function(){this.control[0].style.display="none";this.dropdown[0].style.display="none"},show:function(){this.control[0].style.display="";this.dropdown[0].style.display="none"},measureRightBorder:function(){checkExists(this.stylingLeftWrapper)||(this.stylingLeftWrapper=this.control.find(".styling-left.styling-inner-wrapper"));checkExists(this.stylingRightWrapper)||(this.stylingRightWrapper=this.control.find(".styling-right.styling-inner-wrapper"));var n=parseInt(this.stylingLeftWrapper.css("border-right-width").replace(stringRegularExpressions.unitDimention,""),10);return(n+=parseInt(this.stylingRightWrapper.css("border-left-width").replace(stringRegularExpressions.unitDimention,""),10),this.options.defaultRightBorder=n,n!==this.options.defaultRightBorder)?(this.options.defaultRightBorder=n,!0):!1},toggleModal:function(n){checkExists(this.options.initialDisplayValue)?(this.control.find(".styling-right").showControlModal(!1),this.control.find(".styling-left").showControlBusyModal(!1),this.dropdown.toggleClass("modalized",n)):(this.measureRightBorder(),this.control.find(".styling-right").showControlModal(n),this.control.find(".styling-left").showControlBusyModal(n,{innerPositions:[{right:this.options.defaultRightBorder+this.options.additionalModalSpacing+"px"}]}),this.dropdown.removeClass("modalized"));this.options.isModalized=n},updateModalPosition:function(){this.options.isModalized&&this.measureRightBorder()&&this.control.find(".styling-right").updateControlModal({innerPositions:[{right:this.options.defaultRightBorder+this.options.additionalModalSpacing+"px"}]})},prepareForRefresh:function(){this.menu.empty();this.clearOptions();this.options.items=[];this._setTextboxContent(null)},clearOptions:function(){checkExists(this.options.items)&&this.options.items.length>0?this.options.items=[]:this.element.find("option").remove();this.SelectedIndex(-1)},_loadOptions:function(){this.options.initialDisplayValue=null;var q=null;if(checkExists(this.options.items))q=this.options.items;else{var u=this.element.find("option"),o=this.SelectedIndex();q=[];for(var t=0,f=u.length;t<f;t++){var r=u.eq(t),s=r.selected===!0||o===t?!0:!1,h=r.disabled===!0?!0:!1,c={index:t,text:r.text(),value:r.val(),className:r[0].className,selected:s,disabled:h,title:r.attr("title"),metadata:r.metadata()};q.push(c)}}if(checkExists(this.options.allowEmptyFirstItem)&&!this.options.allowEmptyFirstItem&&this.Items().length>0){var l=q.filter(function(n){if(n.selected)return!0});l.length===0&&(q[0].selected=!0)}this.menuDataOptions=q;this.selected=null;this._selectedIndex=-1;for(var e="",t=0,f=q.length;t<f;t++){var n=q[t];checkExists(n.text)||(n.text="");checkExists(n.index)||(n.index=t);checkExists(n.className)||(n.className="");var a=n.text.htmlEncode(),v=n.title?n.title.htmlEncode():a;e+=this._generateMenuOptionHtml(n);n.selected&&(this._selectedIndex=t)}this.menu.html(e);this.selected=this._findByIndex(this._selectedIndex);this._refreshValue()},_generateMenuOptionHtml:function(n){var r=n.text.htmlEncode(),u=n.title?n.title.htmlEncode():r,t="<li data-index="+n.index+' title="'+u+'" class="'+n.className+(n.selected?" selected":"")+'"',q=0;if(checkExists(n.metadata))for(var f in n.metadata){q++;break}return q>0&&(t+=' data-options="'+jQuery.toJSON(n.metadata).htmlEncode()+'"'),t+='><a href="javascript:;" class="'+n.className+(n.disabled?" disabled":"")+'"',q>0&&(t+=' data-options="'+jQuery.toJSON(n.metadata).htmlEncode()+'"'),t+("><span>"+r+"<\/span><\/a><\/li>")},_refreshValue:function(){var u=null,t=null;if(checkExists(this.options.items)){if(this.options.items.length>0){var n=this.SelectedIndex();if(n===null||n===-1)for(var r=0;r<this.options.items.length&&(n===null||n===-1);r++)this.options.items[r].selected&&(n=r);n!==null&&n!==-1&&(this.SelectedIndex(n),checkExists(this.options.items[n])&&(u=this.options.items[n].className),checkExists(this.selected)&&this.selected.length>0&&(t=this.selected.text()),t===""&&(t=null))}}else if(this.SelectedIndex()===0&&this.options.allowEmptyFirstItem!==!0&&this.element[0].options[this.SelectedIndex()].value==="")t=null;else{var n=-1;if(this.element.find("option").each(function(t){if(jQuery(this).is(":selected"))return n=t,!1}),n!==-1){this.selected=this._findByIndex(this.SelectedIndex());t=this.selected.text();var q=this.element[0].options[this.SelectedIndex()];q&&q.className!==undefined&&q.className!==null&&q.className!==""&&(u=q.className)}}this._setTextboxContent(t,u)},_getIcon:function(n){return checkExists(n)||(n=this._findHighlightedIndex()),checkExistsNotEmpty(n)?checkExists(this.options.items)?this.options.items[n].className:this.element[0].options[n].className:void 0},_setTextboxContent:function(n,t){checkExists(this.controlTextElement)||(this.controlTextElement=this.control.find("a.input-control > span"));checkExistsNotEmpty(n)?(this.controlTextElement.text(n),this.controlTextElement[0].setAttribute("title",n),this.control.removeClass("watermark")):checkExists(this.options.initialDisplayValue)?(this.controlTextElement.text(this.options.initialDisplayValue),this.controlTextElement[0].setAttribute("title",this.options.initialDisplayValue),this.control.removeClass("watermark"),this.toggleModal(this.options.isModalized)):checkExistsNotEmpty(this.options.watermark)?(this.controlTextElement.text(this.options.watermark),this.controlTextElement[0].setAttribute("title",this.options.watermark),this.control.addClass("watermark")):(this.controlTextElement.text(""),this.controlTextElement.removeAttr("title"));t&&(this.icon!=""&&this.control.removeClass(this.icon),this.icon=t,this.control.addClass(this.icon))},_selectValue:function(n,t){n=parseInt(n);checkExists(t)||(t=!1);var q=this.SelectedIndex();if(q!==n||q===0&&!checkExists(this.options.items)){this.ClearSelection();this.SelectedIndex(n);checkExists(this.options.items)?n!=-1&&n<this.options.items.length&&(this.options.items[n].selected=!0):this.element.children("option").eq(n).addClass("selected");this.selected=this._findByIndex(n);this.dropdown[0].style.display!=="none"&&this._highlight(this.selected);this._refreshValue();var r=this;checkExists(this.options.items)?t!==!0&&this._triggerChange():(this.changetimer!==null&&(window.clearTimeout(this.changetimer),this.changetimer=null),this.changetimer=window.setTimeout(function(){r._triggerChange()},50));this.dropdown[0].style.display!=="none"&&this._adjustItemVisibility(this.selected)}},SelectValueAtIndex:function(n){checkExists(n)&&(checkExists(this.options.items)?this._selectValue(n):this.element.get(0).selectedIndex=n)},SelectedIndex:function(n){if(checkExists(n))checkExists(this.options.items)?this._selectedIndex=n:this.element.get(0).selectedIndex=n;else return checkExists(this.options.items)?checkExists(this._selectedIndex)?this._selectedIndex:-1:this.element.get(0).selectedIndex},SelectedDisplay:function(){return this.control.find("a.input-control > span").text()},SelectedValue:function(n){if(typeof n!="undefined"&&n!==null)switch(typeof n){case"number":this._selectValue(n);break;case"string":var t=-1;if(checkExists(this.options.items))for(var q=0;q<this.options.items.length&&(t===null||t===-1);q++)this.options.items[q].value.toUpperCase()===n.toUpperCase()&&(t=q);else this.element.find("option").each(function(q){if(this.value.toUpperCase()===n.toUpperCase())return t=q,!1});t!==-1&&this._selectValue(t)}else{if(checkExists(this.options.items)){if(this.options.items.length>0){var r=this.options.items[this.SelectedIndex()];if(checkExists(r))return r.value}return null}if(checkExists(this.element[0].options)&&this.element[0].options.length>0){var r=this.element[0].options[this.SelectedIndex()];if(checkExists(r))return r.value}return null}},OptionsCount:function(){return checkExists(this.options.items)?this.options.items.length:this.element.get(0).options.length},select:function(){this.SelectedValue(arguments[0])},_applyOptionEventHandlers:function(){var n=this;this.control.find(".input-control-buttons a.dropdown, a.input-control").on("focus.dropdown",function(t){return n._activateControl(t)}).on("blur.dropdown",function(t){return n._deactivateControl(t)}).on("keypress.dropdown",function(t){return n._onKeyPress(t)}).on("keydown.dropdown",function(t){return n._controlKeyDown(t)}).parent().on("click",function(q){navigator.userAgent.match(t)||n.focus(q);n.dropdown[0].style.display!=="none"?n._refreshValue():n._handleKeyPressOpen(q)});this.menu.on("mousedown.dropdown",function(){n.menuMousedown=!0});this.menu.on("click.dropdown",function(t){return n._optionClick(t)});this.dropdown.on("keydown.dropdown",function(t){return n._optionKeyDown(t)})},_handleDocumentClick:function(t){var q=n(t.target);if(q.hasClass("drop-menu-wrapper"))return!0;if(this.menuMousedown===!0)return this.menuMousedown=!1,!0;if(!this.options.disabled)if(q.closest("div.input-control").get(0)!==this.control.get(0))this.dropdown[0].style.display!=="none"&&(this._blurDropdown(t),this._hideDropdown(t));else if(this.dropdown[0].style.display!=="none"){this.canOpenDropdown=!1;var r=this;this.canOpenDropdownTimeoutHandle=setTimeout(function(){r.canOpenDropdown=!0},this.openDropdownDelay);this._hideDropdown(t)}},_handleDocumentScroll:function(n){return this._blurDropdown(n),this._hideDropdown(n)},_findByIndex:function(t){return n(this.menu[0].getElementsByTagName("li")[t])},_highlight:function(n){return checkExists(n)&&typeof n=="object"&&n.length>0?(this._clearHighlighted(),n.addClass("selected"),this._setTextboxContent(n.text(),this._getIcon()),n):(isNaN(n)||(this._clearHighlighted(),n=this._findByIndex(n).addClass("selected")),this._setTextboxContent(n.text(),this._getIcon()),n)},_highlightPrevious:function(){var n=this._findHighlighted(),q=this.OptionsCount();if(n.length===0)var t=this._findByIndex(q-1);else if(n.attr("data-index")>0){this._clearHighlighted(n);var t=n.prev()}checkExists(t)||(t=n);this._highlight(t);this._adjustItemVisibility(t)},_highlightNext:function(){var n=this._findHighlighted();if(n.length===0)var t=this._findByIndex(0);else if(n.attr("data-index")<this.OptionsCount()-1){this._clearHighlighted(n);var t=n.next()}checkExists(t)||(t=n);this._highlight(t);this._adjustItemVisibility(t)},_findHighlighted:function(){var n=this.menu.children(".selected");return n.length===0&&(n=this._findByIndex(this.SelectedIndex())),n},_findHighlightedIndex:function(){return this.menu.children(".selected").attr("data-index")},_clearHighlighted:function(n){var t=checkExists(n)?n:this._findHighlighted();return t.find(".selected").removeClass("selected"),t.removeClass("selected")},_adjustItemVisibility:function(n){if(!checkExists(n))var n=this._findHighlighted();if(checkExists(n)&&n.length!==0&&(n.position().top<this.menuWrapper.scrollTop()||n.position().top>=this.menuWrapper.scrollTop()+this.menuWrapper.height())){var t=n.position().top-this.menuWrapper.parent().height()+n.height();this.menuWrapper.scrollTop(t)}},_controlKeyDown:function(n){if(!this.options.disabled)switch(n.keyCode){case 33:n.preventDefault();this.dropdown[0].style.display==="none"&&this._handleKeyPressOpen(n);var t=this._findHighlighted();t.length===0&&(t=this._findByIndex(0));var r=this.menuWrapper.parent().height(),u=t.position().top-r+t.height();this.menuWrapper.scrollTop(u);var f=parseInt(t.attr("data-index")),e=t.height(),o=parseInt(r/e),q=f-o;q>=0?this._highlight(q):this._highlight(0);break;case 34:n.preventDefault();this.dropdown[0].style.display==="none"&&this._handleKeyPressOpen(n);var t=this._findHighlighted();t.length===0&&(t=this._findByIndex(0));var u=t.position().top;this.menuWrapper.scrollTop(u);var f=parseInt(t.attr("data-index")),r=this.menuWrapper.parent().height(),e=t.height(),o=parseInt(r/e),q=f+o,s=this.OptionsCount()-1;q<=s?this._highlight(q):this._highlight(s);break;case 35:this.dropdown[0].style.display==="none"&&this._handleKeyPressOpen(n);this._highlight(this.OptionsCount()-1);n.preventDefault();break;case 36:this.dropdown[0].style.display==="none"&&this._handleKeyPressOpen(n);this._highlight(0);n.preventDefault();break;case 38:n.stopPropagation();n.stopImmediatePropagation();n.preventDefault();this.dropdown[0].style.display==="none"&&this._handleKeyPressOpen(n);this._highlightPrevious();break;case 40:n.stopPropagation();n.stopImmediatePropagation();n.preventDefault();this.dropdown[0].style.display==="none"&&this._handleKeyPressOpen(n);this._highlightNext();break;case 27:if(n.preventDefault(),this.dropdown[0].style.display!=="none")return this._selectValue(this.previouslySelected),this._refreshValue(),this._hideDropdown(n);break;case 13:this.dropdown[0].style.display!=="none"&&(this._handleKeyPressSelect(n),n.stopPropagation());n.preventDefault();break;case 32:this.dropdown[0].style.display!=="none"?this._handleKeyPressSelect(n):this._handleKeyPressOpen(n);n.preventDefault();break;case 9:this.dropdown[0].style.display!=="none"&&this._handleKeyPressSelect(n)}},_handleKeyPressOpen:function(n){if((this.OptionsCount()!==0||this.options.isModalized===!0)&&!this.options.disabled)return this._showDropdown(n),this.searchStartTime=null,this.OptionsCount()!==0&&this._highlight(this.SelectedIndex()),typeof n!="undefined"&&(n.preventDefault(),n.stopPropagation()),!1},_handleKeyPressSelect:function(n){var t=this._findHighlightedIndex();return this._selectValue(t),this.previouslySelected=t,this._blurDropdown(n),this._hideDropdown(n),!1},_onKeyPress:function(n){if(!this.options.disabled&&n.which!==0&&n.which!==13&&n.which!==8&&n.which!==32){this.dropdown[0].style.display==="none"&&this._showDropdown(n);var t=new Date;(!checkExists(this.searchStartTime)||t-this.searchStartTime>700)&&(this.userSearchString.length=0);this.searchStartTime=new Date;this.userSearchString.push(String.fromCharCode(n.which));this._findItemBySearchString()}},_findItemBySearchString:function(){var n=this,f=n.userSearchString.join("").trim().escapeRegExp(),e=new RegExp("^"+f,"i"),t=[],r=this._findHighlightedIndex();r=checkExists(r)?parseInt(r):-1;n.searchCounter=0;for(var q=0;q<n.menuDataOptions.length;q++)n.menuDataOptions[q].text.match(e)!==null&&(t.push(n.menuDataOptions[q]),r===q&&(n.searchCounter=t.length));if(t.length>0){n.searchCounter>=t.length&&(n.searchCounter=0);var u=n._highlight(t[n.searchCounter].index);n._adjustItemVisibility(u);var o=n._getIcon(u.attr("data-index"))}},focus:function(){this.control.find(".input-control-buttons a.dropdown, a.input-control")[0].focus()},_activateControl:function(){this.options.disabled||this.options.readonly||this.control.addClass("active")},_deactivateControl:function(){this.control.removeClass("active")},_optionClick:function(t){if(!n(t.target).closest("a").is(".disabled")&&!this.options.disabled){this.control.find("a.input-control").trigger("focus");var q=n(t.target).closest("li"),r=q.parent().find("li").index(q);this._selectValue(r);this._hideDropdown(t);this.previouslySelected=r}},_optionKeyDown:function(t){if(t.keyCode===32){var q=n(t.target).closest("li"),r=q.parent().find("li").index(q);this._selectValue(r);this._refreshValue()}},_showDropdown:function(){if(this.canOpenDropdown===!1)return this.canOpenDropdown=!0,clearTimeout(this.canOpenDropdownTimeoutHandle),!0;n(document).on(this.mousedownNameSpaceEvent,this._handleDocumentClick.bind(this));n(document).on(this.dragNameSpaceEvent,this._handleDocumentClick.bind(this));n(window,"body",document).on(this.scrollNameSpaceEvent,this._handleDocumentScroll.bind(this));var q=this._calculateAvailableHeight();this.dropdown.appendTo(n("body"));this.dropdown.css({top:"0px",left:"",width:"auto",height:"auto",position:"absolute","max-height":q.height+1}).removeClass("overflown");var t=this.control.find(".styling-outer-wrapper");t.length===0&&(t=this.control);var r=t.innerWidth(),c=(this.control.outerWidth(!0)-r)/2,e={position:"absolute",width:r-2+"px","min-width":r-2+"px",left:t.offset().left+c+"px","z-index":1},l=this.dropdown.show().height(),a=q.height<l;if(a){this.dropdown.addClass("overflown");var o=this.menu.children("li:first-child").height(),s=this.dropdown.children(".drop-menu-t").height()+this.dropdown.children(".drop-menu-b").height(),u=q.height-s;u=parseInt(u/o)*o+s;n.extend(e,{height:u})}else this.dropdown.removeClass("overflown").css({height:"auto",position:"absolute"});this.dropdown.css(e);this.control.addClass("active");q.position==="below"?this.dropdown.position({my:"left top+"+this.popupVerticalOffsetFromControl,at:"left bottom",of:t,collision:"none fit"}):this.dropdown.position({my:"left bottom-"+this.popupVerticalOffsetFromControl,at:"left top",of:t,collision:"none fit"});var h=this.control.find(".styling-font");if(h.length>0){var f=h[0].style.textAlign;checkExists(f)&&f!==""&&this.dropdown.find("ul.drop-menu").each(function(){this.style.textAlign=f})}this._adjustItemVisibility();SourceCode.Forms.Widget.createUnderlay(this.dropdown)},_calculateAvailableHeight:function(){var t=this.control.offset().top-n(document).scrollTop(),q=SourceCode.Forms.Widget.getBoxShadow(this.dropdown),r=n(window).height()-t-this.control.height()-q.vShadow-q.spread;return t>r?{position:"above",height:parseInt(t)-this.popupVerticalOffsetFromControl}:{position:"below",height:parseInt(r)-this.popupVerticalOffsetFromControl}},hidedropdown:function(){this._hideDropdown()},_hideDropdown:function(){n(document).off(this.mousedownNameSpaceEvent).off(this.dragNameSpaceEvent);n(window,"body",document).off(this.scrollNameSpaceEvent);this._refreshValue();this._clearHighlighted();this.dropdown.hide();SourceCode.Forms.Widget.destroyUnderlay(this.dropdown)},_blurDropdown:function(t){n(t.target).closest(".input-control.select-box, .menu").length===0&&(this.control.removeClass("active"),this._hideDropdown(t))},_triggerChange:function(){this.changetimer=null;this.element.trigger("change")},fetch:function(){if(arguments[0]==="control"&&this.control!==null)return this.control},Items:function(){var n=[];return checkExists(this.options.items)&&(n=this.options.items),n},AppendItem:function(n){var q=!1;if(this.element[0].options&&this.element[0].options.length>0&&checkExists(this.options.allowEmptyFirstItem)&&this.options.allowEmptyFirstItem===!0)throw new Error("allowEmptyFirstItem property incorrectly used.");var t=this.Items(),r=t.indexOf(n);if(r==-1&&(q=!0,checkExists(this.options.items)||(this.options.items=[]),t=this.Items(),n.index=t.length,t.push(n),t.length>0&&this.SelectedIndex()==-1&&checkExists(this.options.allowEmptyFirstItem)&&!this.options.allowEmptyFirstItem)){var u=t[0];u.selected=!0}return q},RemoveItemByValue:function(n){var q=!1,t=this.Items(),r=t.filter(function(t){if(t.value===n)return!0});return r.length>0&&(q=!0),r.forEach(function(n){var q=t.indexOf(n);t.splice(q,1)}),q},ClearSelection:function(){var q=null,t=!1;return checkExists(this.options.items)?this.Items().forEach(function(n){n.selected&&(t=!0,n.selected=!1)}):(q=n(this.element).children("OPTION[selected], OPTION.selected").prop("selected",!1).removeClass("selected"),t=q.length>0?!0:!1),t}};typeof SCDropDown=="undefined"&&(SCDropDown=SourceCode.Forms.Controls.DropDown);n.widget("ui.dropdown",SourceCode.Forms.Controls.DropDown);n(function(){n("select.input-control:not(.runtime)").dropdown()})})(jQuery);
/*!
 ~/Script/jquery.Forms.controls.panel.js
*/
(function(n){(typeof SourceCode=="undefined"||SourceCode===null)&&(SourceCode={});(typeof SourceCode.Forms=="undefined"||SourceCode.Forms===null)&&(SourceCode.Forms={});(typeof SourceCode.Forms.Controls=="undefined"||SourceCode.Forms.Controls===null)&&(SourceCode.Forms.Controls={});SourceCode.Forms.Controls.Panel={_create:function(){var e=this.options;this.element.hasClass("panel")?this.panel=this.element:(this.panel=n(this.html(e)).appendTo(this.element.parent()),this.panel.find(".panel-body-wrapper .wrapper, .panel-body-wrapper .scroll-wrapper").append(this.element));this.header=null;this.body=null;this.footer=null;this.toolbars=null;for(var r=this.panel.children(),u=r.length,q=null;u--;){var t=n(r[u]);this.header===null&&t.hasClass("panel-header")?(q=t,this.header=t.find(".panel-header-text"),this.header=this.header.length===0?null:n(this.header[0])):this.body===null&&t.hasClass("panel-body")?(this.body=t.find(".panel-body-wrapper > .scroll-wrapper, .panel-body-wrapper > .wrapper"),this.body=this.body.length===0?null:n(this.body[0])):this.footer===null&&t.hasClass("panel-footer")?(this.footer=t.find(".toolbar-wrapper"),this.footer=this.footer.length===0?null:n(this.footer[0])):this.toolbars===null&&t.hasClass("panel-body")&&(this.toolbars=t.find(".toolbar-wrapper"),this.toolbars=this.toolbars.length===0?null:n(this.toolbars[0]))}var f=this;if(checkExists(q)&&q.length>0){if(!SourceCode.Forms.Layout.isRuntime())n("a",q).on("click",function(){n(this).is(".collapse-vertical")?f.collapse():n(this).is(".expand-vertical")&&f.expand()});this.specifiedTabIndex=q[0].getAttribute("tabindex");this.currentTabIndex=this.specifiedTabIndex}},collapse:function(n){this.element.hasClass("collapsed")||(this.element.addClass("collapsed"),this.element.children(".panel-header").find(".collapse-vertical").removeClass("collapse-vertical").addClass("expand-vertical"),SourceCode.Forms.Layout.checkAndFixView(this.element),n!==!1&&this._trigger("collapse"))},destroy:function(){n.Widget.prototype.destroy.apply(this,arguments)},expand:function(n){this.element.hasClass("collapsed")&&(this.element.removeClass("collapsed"),this.element.children(".panel-header").find(".expand-vertical").removeClass("expand-vertical").addClass("collapse-vertical"),SourceCode.Forms.Layout.checkAndFixView(this.element),n!==!1&&this._trigger("expand"))},html:function(n){typeof n=="undefined"&&(n={toolbars:0,scrolling:!1,footer:!1,fullsize:!1});var t='<div class="panel';t+=typeof n.scrolling!="undefined"&&n.scrolling?" scroll-contents":"";t+=typeof n.header!="undefined"&&n.header!==""?" with-header":" without-header";t+=typeof n.footer!="undefined"&&n.footer?" with-footer":" without-footer";t+=typeof n.fullsize!="undefined"&&n.fullsize?" full":"";typeof n.toolbars=="undefined"&&(n.toolbars=0);switch(n.toolbars){case 1:t+=" with-toolbar";break;case 2:t+=" with-double-toolbar";break;case 3:t+=" with-triple-toolbar";break;default:t+=" without-toolbar"}if(t+='"',n.id&&(t+=' id="'+n.id+'"'),t+=">",typeof n.header!="undefined"&&n.header!==""&&(t+='<div class="panel-header"><div class="panel-header-l"><\/div><div class="panel-header-c"><div class="panel-header-wrapper"><div class="panel-header-text">'+n.header+'<\/div><\/div><\/div><div class="panel-header-r"><\/div><\/div>'),n.toolbars>0){t+='<div class="panel-toolbars"><div class="toolbars';switch(n.toolbars){case 1:t+=" single";break;case 2:t+=" double";break;case 3:t+=" triple"}t+='">';for(var q=0;q<n.toolbars;q++)t+='<div class="toolbar"><div class="toolbar-wrapper"><\/div><\/div>';t+="<\/div><\/div>"}return t+='<div class="panel-body"><div class="panel-body-t"><div class="panel-body-t-l"><\/div><div class="panel-body-t-c"><\/div><div class="panel-body-t-r"><\/div><\/div><div class="panel-body-m"><div class="panel-body-m-l"><\/div><div class="panel-body-m-c"><div class="panel-body-wrapper"><div class="'+(typeof n.scrolling!="undefined"&&n.scrolling?"scroll-wrapper":"wrapper")+'">'+(typeof n.content!="undefined"&&n.content?n.content:"")+'<\/div><\/div><\/div><div class="panel-body-m-r"><\/div><\/div><div class="panel-body-b"><div class="panel-body-b-l"><\/div><div class="panel-body-b-c"><\/div><div class="panel-body-b-r"><\/div><\/div><\/div>',typeof n.footer!="undefined"&&n.footer&&(t+='<div class="panel-footer"><div class="toolbars single"><div class="toolbar"><div class="toolbar-l"><\/div><div class="toolbar-c"><div class="toolbar-wrapper"><\/div><\/div><div class="toolbar-r"><\/div><\/div><\/div><\/div>'),t+"<\/div>"},fetch:function(){switch(arguments[0]){case"header":return this.header!==null?this.header:this.header=this.panel.children(".panel-header").find(".panel-header-text").length>0?this.panel.children(".panel-header").find(".panel-header-text").eq(0):null;case"toolbars":return this.toolbars!==null?this.toolbars:this.toolbars=this.panel.children(".panel-toolbars").find(".toolbar-wrapper").length>0?this.panel.children(".panel-toolbars").find(".toolbar-wrapper"):null;case"body":return this.body!==null?this.body:this.body=this.panel.children(".panel-body").find(".panel-body-wrapper > .scroll-wrapper, .panel-body-wrapper > .wrapper").eq(0);case"footer":return this.footer!==null?this.footer:this.footer=this.panel.children(".panel-footer").find(".wrapper").length>0?this.panel.children(".panel-footer").find(".wrapper").eq(0):null}},add:function(){switch(arguments[0]){case"header":if(this.header===null){var t=checkExists(arguments[1])?arguments[1]:"",q=n('<div class="panel-header"><div class="panel-header-l"><\/div><div class="panel-header-c"><div class="panel-header-wrapper"><div class="panel-header-text">'+t+'<\/div><\/div><\/div><div class="panel-header-r"><\/div><\/div>').prependTo(this.panel);this.header=q.find(".panel-header-text").eq(0);this.panel.removeClass("without-header").addClass("with-header")}else this.fetch("header").text(arguments[1]);break;case"toolbar":this.panel.children(".panel-toolbars").length===0&&n('<div class="panel-toolbars"><div class="toolbars"><\/div><\/div>').insertBefore(this.panel.children(".panel-body").eq(0));this.panel.children(".panel-toolbars").children(".toolbars").append('<div class="toolbar"><div class="toolbar-wrapper"><\/div><\/div>');this.toolbars=this.panel.children(".panel-toolbars").find(".toolbar-wrapper");switch(this.toolbars.length){case 1:this.panel.addClass("with-toolbar").removeClass("without-toolbar").removeClass("with-double-toolbar").removeClass("with-triple-toolbar");this.panel.children(".panel-toolbars").children(".toolbars").addClass("single").removeClass("double").removeClass("triple");break;case 2:this.panel.addClass("with-double-toolbar").removeClass("without-toolbar").removeClass("with-toolbar").removeClass("with-triple-toolbar");this.panel.children(".panel-toolbars").children(".toolbars").addClass("double").removeClass("single").removeClass("triple");break;case 3:this.panel.addClass("with-triple-toolbar").removeClass("without-toolbar").removeClass("with-double-toolbar").removeClass("with-toolbar");this.panel.children(".panel-toolbars").children(".toolbars").addClass("triple").removeClass("double").removeClass("single")}break;case"footer":this.footer===null&&(this.footer=n('<div class="panel-footer"><div class="toolbars single"><div class="toolbar"><div class="toolbar-wrapper"><\/div><\/div><\/div><\/div>').appendTo(this.panel).find(".toolbar-wrapper").eq(0),this.panel.removeClass("without-footer").addClass("with-footer"))}},remove:function(){switch(arguments[0]){case"header":this.header!==null&&this.header.remove();this.header=null;this.panel.removeClass("with-header").addClass("without-header");break;case"footer":this.footer!==null&&this.footer.remove();this.footer=null;this.panel.removeClass("with-footer").addClass("without-footer");break;case"toolbars":this.toolbars!==null&&this.toolbars.length>0&&this.panel.children(".panel-toolbars").remove();this.toolbars=null;this.panel.removeClass("with-toolbar").removeClass("with-double-toolbar").removeClass("with-triple-toolbar").addClass("without-toolbar")}},SetTabPanelProperty:function(t,q,r,u){r=parseXML(r);var e=r.selectSingleNode("Controls/Control").getAttribute("ID"),o=n("#"+e).find(".collapse-vertical, .collapse-horizontal"),f=n("#"+e).children("a");switch(u.toLowerCase()){case"title":f.find(".tab-text").text(q!==""?q:Resources.FormDesigner.TabTitleDescription);break;case"isenabled":f.toggleClass("disabled",q==="false");break;case"isvisible":f.toggleClass("invisible",q==="false");break;case"tabindex":o[0].setAttribute("tabindex",q)}}};typeof SCPanel=="undefined"&&(SCPanel=SourceCode.Forms.Controls.Panel);n.widget("ui.panel",SourceCode.Forms.Controls.Panel);n.extend(n.ui.panel.prototype,{getter:"fetch",options:{scrolling:!1,toolbars:0,footer:!1,fullsize:!1}})})(jQuery);
/*!
 ~/Script/jquery.Forms.controls.pane.js
*/
(function(n){(typeof SourceCode=="undefined"||SourceCode===null)&&(SourceCode={});(typeof SourceCode.Forms=="undefined"||SourceCode.Forms===null)&&(SourceCode.Forms={});(typeof SourceCode.Forms.Controls=="undefined"||SourceCode.Forms.Controls===null)&&(SourceCode.Forms.Controls={});SourceCode.Forms.Controls.PaneContainer={AnimationTypes:{none:"none",auto:"auto",slideLeft:"slide-left",slideRight:"slide-right",slideUp:"slide-up",slideDown:"slide-down"},_create:function(){this.orientation=this.element.is(".horizontal")?"horizontal":"vertical";this.panes=this.element.children(".pane");this.dividers=this.element.children(".divider");this._initPanes();this._initDivDragHandlers();this._trigger("create",null,{})},regexp:{percentage:/^\d+\%$/gi,pixel:/^\d+(px)?$/gi},getOrientationCSSEndPositionText:function(){return this.orientation==="horizontal"?"right":"bottom"},getOrientationCSSBeginPositionText:function(){return this.orientation==="horizontal"?"left":"top"},getOrientationCSSBeginPosition:function(n){return n===null||n.length===0?0:parseInt(n.css(this.getOrientationCSSBeginPositionText()))},getOrientationCSSEndPosition:function(n){return n===null||n.length===0?0:parseInt(n.css(this.getOrientationCSSEndPositionText()))},getOrientationDimensionText:function(){return this.orientation==="horizontal"?"width":"height"},getOrientationDimension:function(n){return n===null||n.length===0?0:this.orientation==="horizontal"?n.outerWidth():n.outerHeight()},setOrientationCSSBeginPosition:function(n,t){n!==null&&(t.toString().indexOf("px")<0&&t!=="auto"&&(t=t+"px"),n.css(this.getOrientationCSSBeginPositionText(),t))},setOrientationCSSEndPosition:function(n,t){n!==null&&(t.toString().indexOf("px")<0&&t!=="auto"&&(t=t+"px"),n.css(this.getOrientationCSSEndPositionText(),t))},setOrientationCSSDimension:function(n,t){n!==null&&(t.toString().indexOf("px")<0&&(t=t+"px"),n.css(this.getOrientationDimensionText(),t))},getOffSetPosition:function(n){return n===null||n.length===0?0:this.orientation==="horizontal"?n.offset().left:n.offset().top},getOrientationMetaDimension:function(n){if(n===null||n.length===0)return 0;var q=n.metadata(),t="";if(this.orientation==="horizontal"){if(t=q.width,checkExists(t)&&t.indexOf("%")>-1){var r=n.parent(),f=r.width(),u=r.children().filter(".divider").length,o=r.children().filter(".divider").width();t=u===0?Math.floor(parseInt(t.replace("%",""))/100*f)+"px":Math.floor(parseInt(t.replace("%",""))/100*(f-u*o))+"px"}else checkExists(q.autosize)&&q.autosize===!0&&(n.css("position","relative"),t=n.children().outerWidthAll(!0)+"px",n.css("position","absolute"));return t}if(t=q.height,checkExists(t)&&t.indexOf("%")>-1){var r=n.parent(),e=r.height(),u=r.children().filter(".divider").length,s=r.children().filter(".divider").height();t=u===0?Math.floor(parseInt(t.replace("%",""))/100*e)+"px":Math.floor(parseInt(t.replace("%",""))/100*(e-u*s))+"px"}else checkExists(q.autosize)&&q.autosize===!0&&(n.css("position","relative"),t=n.children().outerHeightAll(!0)+"px",n.css("position","absolute"));return t},_initPanes:function(){for(var c=this.getOrientationDimensionText(),u=-1,y=this.panes.length,n=0;n<y;n++){var q=this.panes.eq(n),l=q.metadata();if(!checkExists(l[c])&&(!checkExists(l.autosize)||l.autosize===!1)){u=n;break}}for(var o=0,n=0,b=u;n<b;n++){var q=this.panes.eq(n),l=q.metadata(),s=q.prev(".divider"),t=[];if(q.data("isHidden")===!0){o++;continue}if(n===o)t.push([this.getOrientationCSSBeginPositionText(),"0"]);else{var a=n>o?this.panes.eq(n-1):null,k=n>o?q.prev(".divider"):null;a!==null&&t.push([this.getOrientationCSSBeginPositionText(),this.getOrientationCSSBeginPosition(a)+this.getOrientationDimension(a)+this.getOrientationDimension(k)+"px"])}t.push([c,this.getOrientationMetaDimension(q)]);for(var r=0,v=t.length;r<v;r++)q.css(t[r][0],t[r][1]);var f=0;f=this.getOrientationCSSBeginPosition(this.panes.eq(n-1))+this.getOrientationDimension(this.panes.eq(n-1));s.css(this.getOrientationCSSBeginPositionText(),f);q.attr("location","-1")}for(var n=this.panes.length-1;n>u;n--){var q=this.panes.eq(n),l=q.metadata(),s=q.prev(".divider"),t=[],e=this.panes.eq(n+1),d=q.next(".divider");e.length!==0&&e.data("isHidden")!=!0?t.push([this.getOrientationCSSEndPositionText(),this.getOrientationCSSEndPosition(e)+this.getOrientationDimension(e)+this.getOrientationDimension(d)+"px"]):t.push([this.getOrientationCSSEndPositionText(),"0"]);t.push([c,this.getOrientationMetaDimension(q)]);for(var r=0,v=t.length;r<v;r++)q.css(t[r][0],t[r][1]);var f=0;f=this.getOrientationCSSEndPosition(this.panes.eq(n))+this.getOrientationDimension(this.panes.eq(n));s.css(this.getOrientationCSSEndPositionText(),f);q.attr("location","1")}var h=this.panes.eq(u),s=h.prev(".divider"),e=this.panes.eq(u+1),p=this.panes.eq(u-1),t=[];if(u===o)t.push([this.getOrientationCSSBeginPositionText(),"0px"]);else{var w=this.getOrientationCSSBeginPosition(p)+this.getOrientationDimension(p)+this.getOrientationDimension(s)+"px";t.push([this.getOrientationCSSBeginPositionText(),w])}if(u===y-1)t.push([this.getOrientationCSSEndPositionText(),"0px"]);else{var w=this.getOrientationCSSEndPosition(e)+this.getOrientationDimension(e)+this.getOrientationDimension(h.next(".divider"))+"px";t.push([this.getOrientationCSSEndPositionText(),w])}for(var r=0,v=t.length;r<v;r++)h.css(t[r][0],t[r][1]);var f=0;f=this.getOrientationCSSBeginPosition(this.panes.eq(n-1))+this.getOrientationDimension(this.panes.eq(n-1));s.css(this.getOrientationCSSBeginPositionText(),f);h.attr("location","0")},getPaneWidth:function(n){var t=this.panes.filter(n);if(t.length==0)throw"PaneID "+n+" could not be found";return t.data("isHidden")===!0?t.data("restore"):t.width()},draggableMouseDown:function(t){var r=this,q=n(t.target);q.off("mousedown");q.draggable({helper:"clone",axis:r.orientation==="horizontal"?"x":"y",opacity:.7,containment:r._calculateContainment(q),start:function(t,u){n(u.helper).data("divider",q);r.element.find("iframe").overlay({modal:!0})},stop:function(t,u){r.element.find("iframe").removeOverlay();r._dragStop(t,u);n(u.helper).removeData("divider");q.draggable("destroy");q.on("mousedown",function(n){r.draggableMouseDown(n)})}});q.trigger(t)},_initDivDragHandlers:function(){var t=this;this.dividers.each(function(){n(this).off(".panecontainer");var q=n(this),r=q.metadata();if(r.divResize!=="none")n(this).on("mousedown.panecontainer",function(n){t.draggableMouseDown(n)})})},_calculateContainment:function(t){var o=t.prev(".pane"),r=t.next(".pane"),u=o.metadata(),f=r.metadata(),e=o.offset(),s=r.offset(),v=n(t),y=v.metadata().divResize,h=0,c=0,l=0,a=0;typeof u.minwidth!="undefined"&&(h=parseInt(u.minwidth.replace("px","")));typeof f.minwidth!="undefined"&&(c=parseInt(f.minwidth.replace("px","")));typeof u.minheight!="undefined"&&(l=parseInt(u.minheight.replace("px","")));typeof f.minheight!="undefined"&&(a=parseInt(f.minheight.replace("px","")));var q={x1:0,y1:0,x2:0,y2:0};return this.orientation==="horizontal"?(q.y1=q.y2=e.top,q.x1=e.left+h,q.x2=s.left+r.width()-c):(q.y1=e.top+l,q.x1=q.x2=e.left,q.y2=s.top+r.height()-a),[q.x1,q.y1,q.x2,q.y2]},_dragStop:function(t,q){var o=this,e=n(q.helper).data("divider"),u=e.prev(".pane"),f=e.next(".pane"),nt=e.parent(),tt=n(e).parent().children().filter("div[location='0']"),l=e.metadata().divResize,r=this.getOffSetPosition(e)-this.getOffSetPosition(q.helper),c=u.attr("location"),a=f.attr("location");if(c===a)if(c==="-1"){var v=f,o=this;switch(l){case"before":v=u.nextAll(".pane").filter("div[location!='1']");var s=this.getOrientationDimension(u);this.setOrientationCSSDimension(u,s-r);break;case"both":var s=this.getOrientationDimension(u);this.setOrientationCSSDimension(u,s-r);var h=this.getOrientationDimension(f);this.setOrientationCSSDimension(f,h+r)}v.each(function(){var t=n(this),q=o.getOrientationCSSBeginPosition(t);o.setOrientationCSSBeginPosition(t,q-r);var u=t.prev(".divider"),q=o.getOrientationCSSBeginPosition(u);o.setOrientationCSSBeginPosition(u,q-r)})}else{var y=u,o=this;switch(l){case"after":y=f.prevAll(".pane").filter("div[location!='-1']");var h=this.getOrientationDimension(f);this.setOrientationCSSDimension(f,h+r);break;case"both":var s=this.getOrientationDimension(u);this.setOrientationCSSDimension(u,s-r);var h=this.getOrientationDimension(f);this.setOrientationCSSDimension(f,h+r)}y.each(function(){var t=n(this),u=o.getOrientationCSSEndPosition(t);o.setOrientationCSSEndPosition(t,u+r);var q=t.next(".divider"),f=o.getOrientationCSSEndPosition(q);o.setOrientationCSSEndPosition(q,f+r)})}else if(c==="0"){var h=this.getOrientationDimension(f);this.setOrientationCSSDimension(f,h+r);var p=this.getOrientationCSSEndPosition(u);this.setOrientationCSSEndPosition(u,p+r);var w=this.getOrientationCSSEndPosition(e);this.setOrientationCSSEndPosition(e,w+r)}else if(a==="0"){var s=this.getOrientationDimension(u);this.setOrientationCSSDimension(u,s-r);var b=this.getOrientationCSSBeginPosition(f);this.setOrientationCSSBeginPosition(f,b-r);var k=this.getOrientationCSSBeginPosition(e);this.setOrientationCSSBeginPosition(e,k-r)}var d={parentToHandleOn:this.element,selectorToWaitFor:".pane",onEndCallback:function(){o._trigger("resize",null,{});SourceCode.Forms.Designers.Common.triggerEvent("LayoutChanged")}},g=new SourceCode.Forms.TransitionHelper(d);g.handleTransition()},html:function(n){var q="<div";n.id!==undefined&&n.id!==""&&(q+=' id="'+n.id+'"');q+=' class="pane-container '+(n.orientation==="horizontal"?"horizontal":"vertical")+'"';q+=">";for(var t=0,e=n.panes.length;t<e;t++){if(t!==0&&n.showDividers!==!1){q+='<div class="divider '+(n.orientation==="horizontal"?"vertical":"horizontal");var r={};n.panes[t].resizable!==undefined&&n.panes[t].resizable||n.panes[t-1].resizeable!==undefined&&n.panes[t-1].resizeable?(q+=" draggable",n.panes[t].resizable!==undefined&&n.panes[t].resizable&&n.panes[t-1].resizeable!==undefined&&n.panes[t-1].resizeable?(r={},r.divResize="both",q+='" data-options="'+jQuery.toJSON(r).htmlEncode()):(n.panes[t].resizable===undefined||!n.panes[t].resizable)&&n.panes[t-1].resizeable!==undefined&&n.panes[t-1].resizeable?(r={},r.divResize="before",q+='" data-options="'+jQuery.toJSON(r).htmlEncode()):n.panes[t].resizable!==undefined&&n.panes[t].resizable&&(n.panes[t-1].resizeable===undefined||!n.panes[t-1].resizeable)&&(r={},r.divResize="after",q+='" data-options="'+jQuery.toJSON(r).htmlEncode())):(r={},r.divResize="after",q+='" data-options="'+jQuery.toJSON(r).htmlEncode());q+='"><\/div>'}q+="<div";n.panes[t].id!==undefined&&n.panes[t].id!==""&&(q+=' id="'+n.panes[t].id+'"');var u={},f=0;n.orientation==="horizontal"?(n.panes[t].width!==undefined&&(u.width=n.panes[t].width,f++),n.panes[t].minwidth!==undefined&&(u.minwidth=n.panes[t].minwidth,f++),n.panes[t].maxwidth!==undefined&&(u.maxwidth=n.panes[t].maxwidth,f++)):(n.panes[t].height!==undefined&&(u.height=n.panes[t].height,f++),n.panes[t].minheight!==undefined&&(u.minheight=n.panes[t].minheight,f++),n.panes[t].maxheight!==undefined&&(u.maxheight=n.panes[t].maxheight,f++));n.panes[t].autosize!==undefined&&(u.autosize=n.panes[t].autosize,f++);n.panes[t].resizable!==undefined&&(u.resizable=n.panes[t].resizable,f++);q+=' class="pane"';f>0&&(q+=' data-options="'+jQuery.toJSON(u).htmlEncode()+'"');q+="><\/div>"}return q+"<\/div>"},hidePane:function(n){var t=this.element.find("#"+n+".pane"),r=t.width(),u=t.children(":visible");t.data("restore",r);t.data("isHidden",!0);u.css({width:r,position:"absolute"});u.css("right","0px");var q=t.next(".divider"),f=q.next(".pane"),s=t.prev(".pane"),e=t.position().left;function o(){}new SourceCode.Forms.TransitionHelper({parentToHandleOn:this.element,selectorToWaitFor:"#"+n,onEndCallback:o}).handleTransition();t.width("0");q.length>0&&q.css("left",e-q.width());f.length>0&&f.css("left",e)},showPane:function(n){var e="right",t=this.element.find("#"+n+".pane"),r=t.data("restore"),u=t.children(":visible");t.data("isHidden",!1);var q=t.next(".divider"),f=q.next(".pane"),s=t.prev(".pane"),h=t.position().left;function o(){u.css({width:"",position:""});u.css(e,"")}new SourceCode.Forms.TransitionHelper({parentToHandleOn:this.element,selectorToWaitFor:"#"+n,onEndCallback:o}).handleTransition();t.width(r);q.length>0&&q.css("left",r);f.length>0&&f.css("left",r+q.width())},refresh:function(){this._initPanes()}};typeof SCPaneContainer=="undefined"&&(SCPaneContainer=SourceCode.Forms.Controls.PaneContainer);n.widget("ui.panecontainer",SourceCode.Forms.Controls.PaneContainer);n.extend(n.ui.panecontainer.prototype,{options:{}});n(function(){n(".pane-container").panecontainer()})})(jQuery);
/*!
 ~/Script/jquery.Forms.controls.grid.js
*/
(function(n){(typeof SourceCode=="undefined"||SourceCode===null)&&(SourceCode={});(typeof SourceCode.Forms=="undefined"||SourceCode.Forms===null)&&(SourceCode.Forms={});(typeof SourceCode.Forms.Controls=="undefined"||SourceCode.Forms.Controls===null)&&(SourceCode.Forms.Controls={});GridResources={emptygrid:Resources.CommonPhrases.EmptyGridMessageText,page:Resources.CommonLabels.PagingPageText,pagecount:Resources.CommonLabels.PagingTotalPagesText,gofirst:Resources.CommonLabels.PagingFirstPageText,golast:Resources.CommonLabels.PagingLastPageText,goprevious:Resources.CommonLabels.PagingPreviousPageText,gonext:Resources.CommonLabels.PagingNextPageText,actionrow:Resources.CommonActions.AddText};SourceCode.Forms.Controls.Grid={_create:function(){var q=this.options;this.resources=n.extend(q.resources,GridResources);this.multiline=q.multiline;this.dragcolumns=q.dragcolumns;this.multiselect=q.multiselect;this.cellcontentselect=q.cellcontentselect;this.initialGroupSelectedRow=null;this.groupSelectedRows=[];this.previouslySelectedIndexes=[];this.disablemodulus=q.disablemodulus;this.sortedItemsArray=null;this.zebraStripes=q.zebraStripes;this.header=null;this.toolbars=null;this.columntable=null;this.contenttable=null;this.footer=null;this.summary=null;this.sortColumn=null;this.reverseSort=null;this.sortState=null;this.singleToDoubleClickTimer=null;this.lastClickTime=null;this.lastClickTarget=null;this.touchDragged=!1;this.useTouchEvents=q.useTouchEvents;this.isMobileIOS=q.isMobileIOS;this.isMobileIOSApp=q.isMobileIOSApp;this.maxDoubleDoubleClickDelay=500;this.actionrow=q.actionrow;this.page=1;this.totalpages=1;this.hasmorepages=null;this.tabableElements=[];this.editableRowTabIndexCounter=0;this.itemsHaveTabIndices=!1;this.captureInputs=["textarea","input","select","a"];this.autopopulate=q.autopopulate;this.columns=[];var h=this.element,r=h.children();r.filter(".grid-header").length>0&&(this.header=r.filter(".grid-header").find(".grid-header-text").eq(0));r.filter(".grid-toolbars").length>0&&(this.toolbars=r.filter(".grid-toolbars").children(".toolbars").toolbargroup());r.filter(".grid-footer").length>0&&(this.footer=r.filter(".grid-footer").children(".toolbars").toolbargroup());r.filter(".grid-body").find(".grid-summary").length>0&&(this.summary=r.filter(".grid-body").find(".grid-summary"));this.rownumbering=h.is(".with-rownumbering");var o=r.filter(".grid-aggregation");if(o.length!==0&&(this.aggregationContentTableBody=o.find("tbody"),this._applyAggregationHeaderClickHandler(o)),checkExists(this.summary)&&this.summary.length>0&&this.element.is(".full.with-summary")&&r.filter(".grid-body").css("bottom",this.summary.outerHeight()),this.columnsheadertable=r.filter(".grid-body").children(".grid-column-headers").find("table.grid-column-header-table"),this.contentscrollwrapper=r.filter(".grid-body").find(".grid-body-content .grid-body-content-wrapper > .scroll-wrapper"),this.contenttable=this.contentscrollwrapper.children("table.grid-content-table"),this.contenttabletbody=this.contenttable.children("tbody").filter(function(){return n(this).closest("table").not(".control-table")}),this.tabIndex=this.contenttable[0].getAttribute("tabindex"),!checkExists(q.columns)||!q.columns.length||q.columns.length===0)for(var s=this.contenttable.children("colgroup").children("col"),f=0,a=s.length;f<a;f++){for(var c={},e=["name","display","sortable","align","datatype","hidden","modulus","width","resizable"],u=0,v=e.length;u<v;u++){var l=checkExists(s.eq(f))?s.eq(f).metadata():{};checkExists(l[e[u]])&&(c[e[u]]=l[e[u]])}this.columns.push(c)}if(this.multiselect&&this.cellcontentselect!==!0)this.contenttabletbody.on("selectstart",function(){var t=event.target;if(!checkExists(t)&&(t=event.srcElement,!checkExists(t))||(t.nodeType===3&&(t=t.parentElement),typeof t.tagName=="false"))return!0;var q=t.tagName.toLowerCase();if(q==="input"||q==="textarea")return!0;var r=!1;return r=t.getAttribute("contenteditable")==="true"?!0:!n(t).closest(".grid-content-table, [contenteditable=true]").hasClass("grid-content-table"),r?!0:!1});this.cellcontentselect===!0&&this.element.addClass("allow-cell-content-selection");this.contenttabletbody.children("tr.empty-grid").length>0&&(this.resources.emptygrid=this.contenttabletbody.children("tr.empty-grid").text());this.contenttabletbody.children("tr.action-row").length>0&&(this.actionrow=!0);this.actionrow&&this._applyActionRow();n(this.contenttable.parents(".grid")[0]).hasClass("enter-commits-behaviour")&&(this.enterCommitsRow=!0);var t=this;if(!SourceCode.Forms.Layout.isRuntime())n(".grid-header a",this.element).on("click",function(){n(this).hasClass("collapse-vertical")?t.collapse():n(this).hasClass("expand-vertical")&&t.expand()});if(this.isRuntime=SourceCode.Forms.Layout.isRuntime(),checkExists(this.isMobileIOS)&&checkExists(this.isMobileIOSApp)||this._checkMobileDevice(this),checkExists(this.useTouchEvents)||(this.useTouchEvents=this.isMobileIOSApp),this._syncWidths(this.zebraStripes,!0),this._applyScrollEventHandlers(),this._applyColumnHeaderClickHandlers(),this._applyColumnHeaderResizeHandlers(),this._resizeColumnHeaderCells(),this._applyContentClickHandlers(),this._applyWindowResizeHandler(),this.isRuntime)this.contenttable.on("keydown",this,this._onKeyDown);this.contenttable.on("click",function(n){var f=n.target.tagName.toLowerCase(),q="";checkExists(document.activeElement)&&checkExists(document.activeElement.tagName)&&(q=document.activeElement.tagName.toLocaleLowerCase());var r=!1;if(checkExists(n.target.className)&&typeof n.target.className=="string"){var u=n.target.className.toLowerCase();r=u.indexOf("editable-area")>-1||u.indexOf("input-control-watermark")>-1}jQuery.inArray(f,t.captureInputs)===-1&&jQuery.inArray(q,t.captureInputs)===-1&&r&&t.contenttable.has(document.activeElement).length===0&&t.contenttable.trigger("focus")}).on("focusin",function(q){if(t.isRuntime&&t._getHighlighted().length===0){var r=t.contenttable.find(".edit-template-row");r.length>0?t._highlight(r):checkExists(q)&&checkExists(q.target)?n(q.target).is("a.action-row")||t._isFocussedOnEditableItem()||r.has(document.activeElement).length!==0||t._highlightSelectedOrFirst():t._highlightSelectedOrFirst()}}).on("focusout",function(){setTimeout(function(){try{var n=document.activeElement;checkExists(n)?t.contenttable.has(document.activeElement).length!==0||t.contenttable.is(document.activeElement)||t._findHighlightedAndClear():t._findHighlightedAndClear()}catch(q){t._findHighlightedAndClear()}},50)});this.headerMouseEvent=!1;this.columnsheadertable.on("mouseenter",function(){this.headerMouseEvent=!0});this.columnsheadertable.on("mouseleave",function(){this.headerMouseEvent=!1});this.columnsheadertable.on("focus",function(){if(!this.headerMouseEvent){for(var q=0;q<t.columns.length&&(!t.columns[q].sortable||t.columns[q].hidden);)q++;var r=n(n(this).find("td")[q]);r.length!==0&&r.addClass("focus")}});this.columnsheadertable.on("focusout",function(){n(this).find(".focus").removeClass("focus")});this.columnsheadertable.on("click","td",function(){n(this).addClass("focus");n(this).siblings(".focus").removeClass("focus")});if(checkExists(this.toolbars)){this.toolbars.on("keydown","a",function(t){t.which===32&&(n(this).find(".button-text").trigger("click"),t.preventDefault())});this.toolbars.on("click","a",function(q){var u=q.target.tagName.toLowerCase(),r="";checkExists(document.activeElement)&&checkExists(document.activeElement.tagName)&&(r=document.activeElement.tagName.toLocaleLowerCase());jQuery.inArray(u,t.captureInputs)===-1&&jQuery.inArray(r,t.captureInputs)===-1&&n(this).trigger("focus")})}this.options.autopopulate&&this.options.url!==undefined&&this.options.url!==""&&this.populate();this.options.paging&&this._buildPagingControls();this.lrCounter=-1;this.previousFocussedItemColumn=-1;this.rowCountModifier=this.actionrow===!0?0:1},_bindContentEvents:function(){this.contenttabletbody.find(".runtime-list-item .hyperlink").on("keydown",this._onListviewItemKeyDown).on("click",this._onListviewItemClick);this.contenttabletbody.find(".grid-content-cell-wrapper .fileImage").on("keydown",this._onListviewItemKeyDown).on("click",this._onListviewItemClick);this.contenttabletbody.find(".runtime-list-item .image").on("keydown",this._onListviewItemKeyDown).on("click",this._onListviewItemClick)},_onListviewItemClick:function(n){n.stopPropagation()},_onListviewItemKeyDown:function(n){if(n.keyCode===32){if(!n.ctrlKey&&!n.metaKey)if(checkExists(n.target.click))n.target.click();else{var t=document.createEvent("MouseEvents"),q=checkExists(n.target)?n.target.getAttribute("target"):"";t.initMouseEvent("click",!0,!0,q);n.target.dispatchEvent(t)}n.stopPropagation();n.preventDefault()}},collapse:function(n){this.element.hasClass("collapsed")||(this.element.addClass("collapsed"),this.element.children(".grid-header").find(".collapse-vertical").removeClass("collapse-vertical").addClass("expand-vertical"),SourceCode.Forms.Layout.checkAndFixView(this.element),n!==!1&&this._trigger("collapse"))},_destroy:function(){n(window).off("resize")},expand:function(n){this.element.hasClass("collapsed")&&(this.element.removeClass("collapsed"),this.element.children(".grid-header").find(".expand-vertical").removeClass("expand-vertical").addClass("collapse-vertical"),this._syncWidths(!1),SourceCode.Forms.Layout.checkAndFixView(this.element),n!==!1&&this._trigger("expand"),this.synccolumns())},html:function(t){checkExists(t)||(t={resources:{}});n.extend(t.resources,GridResources);var q="<div";checkExists(t.id)&&t.id!==""&&(q+=' id="'+t.id+'"');q+=' class="grid';q+=checkExists(t.header)&&t.header!==""?" with-header":" without-header";q+=checkExists(t.footer)&&t.footer?" with-footer":" without-footer";q+=" without-aggregation with";t.rownumbering!==!0&&(q+="out");q+="-rownumbering";checkExists(t.toolbars)||(t.toolbars=0);switch(t.toolbars){case 3:q+=" with-triple-toolbar";break;case 2:q+=" with-double-toolbar";break;case 1:q+=" with-toolbar";break;default:q+=" without-toolbar"}return q+=checkExists(t.fullsize)&&t.fullsize?" full":"",q+='">',checkExists(t.header)&&t.header!==""&&(q+=this._generateHeaderHTML(t.header)),t.toolbars>0&&(q+='<div class="grid-toolbars">',q+=SourceCode.Forms.Controls.ToolbarGroup.html({toolbars:t.toolbars}),q+="<\/div>"),q+='<div class="grid-body">',q+=this._generateColumnsHeaderHTML(t),q+='<div class="grid-body-content"><div class="grid-body-content-wrapper"><div class="scroll-wrapper">',q+='<table class="grid-content-table" tabindex="0">',q+=this._generateColGroupHTML(t),q+="<tbody>",q+=t.actionrow?this._generateActionRowHTML(t):this._generateEmptyGridHTML(t),q+="<\/tbody><\/table>",q+="<\/div><\/div><\/div>",q+='<div class="grid-drag-elements"><\/div>',q+="<\/div>",checkExists(t.footer)&&t.footer&&(q+=this._generateFooterHTML()),checkExists(t.templates)&&checkExists(t.templates.edit)&&t.templates.edit&&(q+=this._generateEditTemplateHTML()),checkExists(t.templates)&&checkExists(t.templates.display)&&t.templates.display&&(q+=this._generateDisplayTemplateHTML()),q+"<\/div>"},_generateColGroupHTML:function(n){var u="";if(checkExists(n.columns)&&n.columns.length&&n.columns.length>0){u+="<colgroup>";for(var t=0,o=n.columns.length;t<o;t++){var q={},r=0,f=[],e=[];checkExists(n.columns[t].name)&&n.columns[t].name!==""&&(q.name=n.columns[t].name,r++);checkExists(n.columns[t].modulus)&&Boolean(n.columns[t].modulus)&&(q.modulus=Boolean(n.columns[t].modulus),r++);checkExists(n.columns[t].datatype)&&n.columns[t].datatype!==""&&(q.datatype=n.columns[t].datatype,r++);checkExists(n.columns[t].control)&&n.columns[t].control!==""&&(q.control=n.columns[t].control,r++);checkExists(n.columns[t].hidden)&&Boolean(n.columns[t].hidden)?(q.hidden=Boolean(n.columns[t].hidden),r++,e.push("hidden")):checkExists(n.columns[t].width)&&n.columns[t].width!==""&&(q.width=n.columns[t].width,r++,checkExists(n.columns[t].modulus)&&Boolean(n.columns[t].modulus)?f.push("min-width:"+n.columns[t].width):f.push("width:"+n.columns[t].width));checkExists(n.columns[t].align)&&n.columns[t].align!==""&&(q.align=n.columns[t].align,r++,f.push("text-align:"+n.columns[t].align));checkExists(n.columns[t].sortable)&&Boolean(n.columns[t].sortable)?(q.sortable=Boolean(n.columns[t].sortable),r++):(q.sortable=!0,r++);u+="<col";e.length>0&&(u+=' class="'+e.join(" ")+'"');r>0&&(u+=' data-options="'+jQuery.toJSON(q).htmlEncode()+'"');u+=' style="'+f.join("; ")+'" />'}u+="<\/colgroup>"}return u},_generateHeaderHTML:function(n){return'<div class="grid-header"><div class="grid-header-wrapper"><div class="grid-header-text">'+n+"<\/div><\/div><\/div>"},_generateColumnsHeaderHTML:function(n){n.rownumbering===!0&&n.columns.unshift({display:"#",width:66});var t='<div class="grid-column-headers"><div class="grid-column-headers-wrapper">';return t+='<table  tabindex="0" class="grid-column-header-table" cellpadding="0" cellspacing="0" border="0">',t+("<tbody>"+this._generateColumnsHeaderCellsHTML(n)+"<\/tbody><\/table><\/div><\/div>")},_generateColumnsHeaderCellsHTML:function(n){var q="";if(checkExists(n.columns)&&n.columns.length&&n.columns.length>0){q+="<tr>";for(var t=0,e=n.columns.length;t<e;t++){var f=[],r={},u=0;checkExists(n.columns[t].name)&&n.columns[t].name!==""&&(r.name=n.columns[t].name,u++);checkExists(n.columns[t].hidden)&&Boolean(n.columns[t].hidden)&&(r.hidden=Boolean(n.columns[t].hidden),u++);checkExists(n.columns[t].modulus)&&Boolean(n.columns[t].modulus)&&(r.modulus=Boolean(n.columns[t].modulus),u++);checkExists(n.columns[t].align)&&n.columns[t].align!==""&&(r.align=n.columns[t].align,u++);checkExists(n.columns[t].datatype)&&n.columns[t].datatype!==""&&(r.datatype=n.columns[t].datatype,u++);checkExists(n.columns[t].width)&&n.columns[t].width!==""&&(r.width=n.columns[t].width,u++);checkExists(n.columns[t].control)&&n.columns[t].control!==""&&(r.control=n.columns[t].control,u++);checkExists(n.columns[t].sortable)?(r.sortable=Boolean(n.columns[t].sortable),u++,n.columns[t].sortable===!1&&f.push("not-sortable")):(r.sortable=!0,u++);checkExists(n.columns[t].resizable)?(r.resizable=Boolean(n.columns[t].resizable),u++,n.columns[t].resizable===!1&&f.push("not-resizable")):(r.resizable=!0,u++);checkExists(n.columns[t].hidden)&&n.columns[t].hidden&&f.push("hidden");q+='<td class="';q+=f.join(" ");u>0&&(q+='" data-options="'+jQuery.toJSON(r).htmlEncode());q+='" style="';checkExists(n.columns[t].hidden)&&n.columns[t].hidden||checkExists(n.columns[t].width)&&n.columns[t].width!=="auto"&&parseInt(n.columns[t].width)>0&&(q+="width: "+n.columns[t].width);q+='"><div class="grid-column-header-cell"><div class="grid-column-header-cell-wrapper"><div class="grid-column-header-cell-content"><div class="grid-column-header-text" title="'+n.columns[t].display+'">';q+=checkExists(n.columns[t].display)?n.columns[t].display:"";q+="<\/div>";checkExists(n.customcolumns)&&n.customcolumns&&(q+='<a href="javascript:;" class="grid-column-header-button" title="Hide/Show Columns"><span><\/span><\/a>');q+='<\/div><\/div><div class="grid-column-header-divider"><\/div><\/div><\/td>'}q+="<\/tr>"}return q},_generateActionRowHTML:function(n){return'<tr class="action-row"><td class="action-row"'+(checkExists(n.columns)&&n.columns.length>0?' colspan="'+n.columns.length+'"':"")+'><div class="grid-content-cell"><div class="grid-content-cell-wrapper"><a href="javascript:;" class="action-row" tabindex="'+this.tabindex+'">'+(checkExists(n.resources)&&checkExists(n.resources.actionrow)?n.resources.actionrow:SCGridDefaults.options.resources.actionrow)+"<\/a><\/div><\/div><\/td><\/tr>"},_generateEmptyGridHTML:function(n){return'<tr class="empty-grid"><td class="empty-grid"'+(checkExists(n.columns)&&n.columns.length>0?' colspan="'+n.columns.length+'"':"")+'><div class="grid-content-cell"><div class="grid-content-cell-wrapper">'+(checkExists(n.resources)&&checkExists(n.resources.emptygrid)?n.resources.emptygrid:SCGridDefaults.options.resources.emptygrid)+"<\/div><\/div><\/td><\/tr>"},_generateFooterHTML:function(){return'<div class="grid-footer">'+SourceCode.Forms.Controls.ToolbarGroup.html({toolbars:1})+"<\/div>"},_generateDisplayTemplateHTML:function(){return'<div class="grid-display-templates"><table class="grid-display-templates-table" cellpadding="0" cellspacing="0" border="0"><tbody><\/tbody><\/table><\/div>'},_generateEditTemplateHTML:function(){return'<div class="grid-edit-templates"><table class="grid-edit-templates-table" cellpadding="0" cellspacing="0" border="0"><tbody><\/tbody><\/table><\/div>'},_getColumnIndex:function(n){for(var q=-1,t=0,r=this.columns.length;t<r;t++)if(checkExists(this.columns[t].name)&&this.columns[t].name===n){q=t;break}return q},_applyAggregationHeaderClickHandler:function(n){var t=this.options;n.find(".grid-aggregation-header-link").on("click",function(){if(n.is(".collapsed")){var q=t.canexpand;q===undefined?q=!0:typeof q=="function"&&(q=q());q===!0&&n.removeClass("collapsed").addClass("expanded")}else n.removeClass("expanded").addClass("collapsed")})},_applyScrollEventHandlers:function(){var t=this;this.contentscrollwrapper.on("scroll",function(q){t.columnsheadertable.css(document.documentElement.getAttribute("dir")==="rtl"?"right":"left","-"+Math.abs(n(q.target).scrollLeft())+"px")})},_applyColumnHeaderClickHandlers:function(){var t=this;if(t.options.sorting){t.columnsheadertable.on("click","td",function(q){if(!n(this).is(".not-sortable")){var r=n(this).parent().children().index(this);if(t.columns[r].sortable){var u=t.contenttabletbody.children("tr.edit-template-row");u.length>0&&t._trigger("commitrowwithkey",q,u);t.sort(r,!1)}}});if(t.isRuntime)t.columnsheadertable.on("keydown",function(q){switch(q.which){case 13:case 32:var u=n(this).find(".focus"),r=n(this).find("td").index(u);t.columns[r].sortable&&t.sort(r,!1);q.preventDefault();break;case 39:var u=n(this).find(".focus").removeClass("focus"),f=n(this).find("td"),r=f.index(u);for(r++;r<t.columns.length&&(!t.columns[r].sortable||t.columns[r].hidden);)r++;var e=n(f[r]);e.length===0?u.addClass("focus"):e.addClass("focus");break;case 37:var u=n(this).find(".focus").removeClass("focus"),f=n(this).find("td"),r=f.index(u);for(r--;r>=0&&(!t.columns[r].sortable||t.columns[r].hidden);)r--;var o=n(f[r]);o.length===0?u.addClass("focus"):o.addClass("focus")}})}},_resizeColumnHeaderCells:function(){},_columnsHeaderDividerDragStart:function(t,q,r,u,f,e,o){var s=n(r).closest("td"),k=s.parent().children("td").index(s),l=s.offset(),a=u.columnsheadertable.offset(),y=u.columnsheadertable.width(),h,v=l.top,c,p=v+s.height();f.attr("dir")==="rtl"?(h=a.left,c=a.left+y-50,e?(h=s.nextAll("td:visible").first().offset().left+50,c=l.left+s.width()-50):h-=10):(h=l.left+50,c=a.left+y,e?c=h+s.width()+s.nextAll("td:visible").first().width()-100:o&&(c+=10));var w=n(r),b=w.data("ui-draggable");b.containment=[h,v,c,p];b.options.containment=[h,v,c,p];w.closest(".grid-column-header-table").overlay()},_columnsHeaderDividerDragStop:function(t,q,r,u){n(r).closest(".grid-column-header-table").removeOverlay();var h=n(document.documentElement).attr("dir")==="rtl"?q.originalPosition.left-q.position.left:q.position.left-q.originalPosition.left,s=n(r).closest("td"),f=s.parent().children("td").index(s),c=s.width();if(h!==0){var y=u._percentageWidth(u.columns[f]),p=checkExists(u.columns[f+1]),w=u._percentageWidth(u.columns[f+1]),d=Boolean(u.columns[f].hidden),b=Boolean(u.columns[f+1].hidden),k=u._explicitWidth(u.columns[f]);if(k){var e=parseInt(checkExists(u.columns[f].modulus)&&u.columns[f].modulus?s.width():u.columns[f].width)+h;u.columns[f].width=(e>0?e:0)+"px";u._setColumnWidth(f)}else if(y&&p){var o=parseInt(u.columns[f].width),l=parseInt(u.columns[f+1].width),e=Math.floor(o*((c+h)/c));if(w)if(u.columns[f].width=e+"%",b){u._setColumnWidth(f);var a=o>e?o-e:-(e-o);u._updateColumnWidths(a)}else{var v=o>e?l+(o-e):l-(e-o);if(v>0)u.columns[f+1].width=v+"%",u._setColumnWidth(f),u._setColumnWidth(f+1);else{u._setColumnWidth(f);var a=o>e?o-e:-(e-o);u._updateColumnWidths(a)}}}u._trigger("colresize",t,{grid:u.element,columns:u.columns});u._syncWidths(null,!0);u._resizeColumnHeaderCells()}},_applyColumnHeaderResizeHandlers:function(){var q=n(document.documentElement);if(!q.hasClass("mobile")){var r=this.columns.filter(this._visibleColumn.bind(this)),u=r.every(this._explicitWidth.bind(this)),f=r.every(this._percentageWidth.bind(this)),t=this;this.columnsheadertable.find("td:not(.not-resizable) .grid-column-header-divider").each(function(){n(this).draggable({appendTo:t.columnsheadertable.parent()[0],axis:"x",helper:"clone",start:function(n,r){t._columnsHeaderDividerDragStart(n,r,n.target,t,q,f,u)},stop:function(n,q){t._columnsHeaderDividerDragStop(n,q,n.target,t)},zIndex:1e3})})}},_checkMobileDevice:function(n){n.isMobileIOS=/(iPhone|iPad|iPod)/i.test(navigator.userAgent);n.isMobileIOSApp=n.isMobileIOS&&SourceCode.Forms.Runtime.MobileBridge.inMobileAppContext()},_handleTouchStart:function(t,q){checkExists(q)&&q instanceof n.Widget||(q=t.data.self);q.touchDragged=!1},_handleTouchMove:function(t,q){checkExists(q)&&q instanceof n.Widget||(q=t.data.self);q.touchDragged=!0},_handleTouchEnd:function(t,q,r,u,f,e){(checkExists(q)&&q instanceof n.Widget||(q=t.data.self),q.touchDragged)||(checkExists(r)||(r=t.target),clearTimeout(q.singleToDoubleClickTimer),checkExists(q.lastClickTarget)&&q.lastClickTarget===r?(t.preventDefault(),q._handleClick(t,q,r,u,f,e,!1),q._handleDblClick(t,q,r),q.lastClickTarget=null):(checkExists(q.lastClickTarget)&&q.lastClickTarget!==r&&q._handleClick(t,q,q.lastClickTarget,u,f,e,!0),q.singleToDoubleClickTimer=setTimeout(function(){clearTimeout(q.singleToDoubleClickTimer);q.lastClickTarget=null;q._handleClick(t,q,r,u,f,e,!0)}.bind(q),q.maxDoubleDoubleClickDelay),q.lastClickTarget=r))},_handleClick:function(t,q,r,u,f,e,o){checkExists(q)&&q instanceof n.Widget||(q=t.data.self);checkExists(u)||(t.ctrlKey?u=t.ctrlKey:t.metaKey&&(u=t.metaKey));checkExists(f)||(f=t.shiftKey);checkExists(r)||(r=t.target);var h=n(r).closest("tr"),y=q.fetch("rows"),c=y.index(h);if(c!==-1){if((!checkExists(t.button)||t.button===0)&&!h.hasClass("empty-grid")&&!h.hasClass("action-row")){var p=h.hasClass("selected")?!0:!1;if(q.multiselect&&u)p?q.deselect([c],t):q.select([c],t);else if(q.multiselect&&f){var l=[],b=[],a=checkExists(q.initialGroupSelectedRow)?y.index(q.initialGroupSelectedRow):-1;if(a!==-1)if(a<=c)for(var s=a;s<=c;s++)l.push(s);else for(var s=c;s<=a;s++)l.push(s);else l.push(c);for(var v=0;v<q.groupSelectedRows.length;v++)l.indexOf(q.groupSelectedRows[v])===-1&&b.push(q.groupSelectedRows[v]);q.deselect(b,t);q.select(l,t)}else{for(var w=q.fetch("selected-rows"),k=[],s=0,d=w.length;s<d;s++)(!p||p&&h.get(0)!==w.get(s))&&k.push(y.index(w.eq(s)));q.deselect(k,t);q.select([c],t)}h.hasClass("highlighted")||(q._findHighlightedAndClear(),q.isRuntime&&q._highlight(h))}e||q.multiselect&&(u||f)||h.hasClass("edit-template-row")||checkExists(o)&&o===!1||q._trigger("rowclick",t,h)}(q.actionrow||t.type==="click")&&(q.lrCounter=-1,q.previousFocussedItemColumn=-1)},_handleDblClick:function(t,q,r){if(checkExists(q)||(q=t.data.self),checkExists(r)||(r=t.target),r.tagName!==undefined){var u=n(r).closest("tr"),f=q.fetch("rows"),e=f.index(u);e!==-1&&q._trigger("rowdblclick",t,u)}},_applyContentClickHandlers:function(){var t=this;if(this.useTouchEvents){this.contenttabletbody.on("touchstart",{self:this},this._handleTouchStart);this.contenttabletbody.on("touchmove",{self:this},this._handleTouchMove);this.contenttabletbody.on("touchend",{self:this},this._handleTouchEnd)}else{t.contenttabletbody.on("click",{self:this},this._handleClick);t.contenttabletbody.on("dblclick",{self:this},this._handleDblClick)}if(this.options.showcustomcontextmenu===null||this.options.showcustomcontextmenu===undefined)t.contenttabletbody.on("contextmenu",function(q){var u=n(q.target).closest("tr"),o=t.fetch("rows"),s=o.index(u);if(s!==-1){if(!t.multiselect||t.multiselect&&!q.ctrlKey&&!q.metaKey&&q.button!==2){for(var f=t.fetch("selected-rows"),e=[],r=0,h=f.length;r<h;r++)f[r]!==u[0]&&e.push(o.index(f.eq(r)));t.deselect(e,q)}if(u.is(".selected")||t.multiselect&&(!t.multiselect||q.ctrlKey||q.metaKey||q.button===2)){if(!u.is(".selected")&&(!t.multiselect||t.multiselect&&!q.ctrlKey&&!q.metaKey&&q.button===2)){for(var f=t.fetch("selected-rows"),e=[],r=0,h=f.length;r<h;r++)f[r]!==u[0]&&e.push(o.index(f.eq(r)));t.deselect(e,q);t.select([s],q)}}else t.select([s],q);t._trigger("rowcontextmenu",q,u);q.preventDefault()}})},_applyEditTabbingBehaviour:function(t){var q=this;if(!q.editEventsAttached){if(q.enterCommitsRow){checkExists(t)||(t=q.fetch("edit-template-row"));var r=t.find("td:not(.hidden) input[type='radio'][tabindex!='-1']:not(.disabled), td:not(.hidden) :not(div.HyperlinkPopupOuterWrapper) [tabindex][tabindex!='-1'][disabled!='disabled']:not(.disabled)");if(r.length>0){q.itemsHaveTabIndices=!0;for(var u=[],f=0;f<r.length;f++)typeof r=="object"&&u.push(r[f]);q.sortedItemsArray=u.slice();q.sortedItemsArray.sort(function(n,t){return aTabIndex=parseInt(n.getAttribute("tabindex")),bTabIndex=parseInt(t.getAttribute("tabindex")),difference=aTabIndex-bTabIndex,difference!==0?difference:u.indexOf(n)-u.indexOf(t)})}t.on("keydown.tabbing",function(t){if(t.which===9)if(t.stopPropagation(),q.itemsHaveTabIndices){var u=q.sortedItemsArray,s=t.target,r=u.indexOf(s),e=u.length;if(t.shiftKey)if(r===0)try{n(u[e-1]).trigger("focus")}catch(h){}else{r--;try{n(u[r]).trigger("focus")}catch(h){}}else if(r===e-1)try{n(u[0]).trigger("focus")}catch(h){}else{r++;try{n(u[r]).trigger("focus")}catch(h){}}t.preventDefault()}else{var f=n(this).find("input, a"),o=f.length,r=f.index(t.target);if(t.shiftKey===!1&&r===o-1){try{n(f[0]).trigger("focus")}catch(h){}t.preventDefault()}else if(t.shiftKey===!0&&r===0){try{n(f[o-1]).trigger("focus")}catch(h){}t.preventDefault()}}})}q.editEventsAttached=!0}},_applyWindowResizeHandler:function(){var t=this;n(window).on("resize",function(){t._syncWidthsInternal(null,!0);t._resizeColumnHeaderCells()})},clearsort:function(){this.reverseSort=null;this.sortColumn=null;this.sortState=null;this.columnsheadertable.children("tbody").children("tr").children("td").children(".grid-column-header-cell").removeClass("asc").removeClass("desc")},sort:function(n,t){if(checkExists(n)?(this.reverseSort===null&&(this.reverseSort=[]),this.reverseSort[n]===null&&(this.reverseSort[n]=t),n===this.sortColumn&&(this.reverseSort[n]=!this.reverseSort[n]),this.sortColumn=n):checkExists(this.sortColumn)&&(n=this.sortColumn,t=this.reverseSort[n]),checkExists(n)){t=this.reverseSort[n];var s=this.columns[n];if(checkExists(this.options.customsort)&&typeof this.options.customsort=="function")this.options.customsort(n,t,this.element);else{this.contenttabletbody[0].style.display="none";for(var q=this.fetch("rows"),u=s.datatype,h=q.length,r=0;r<h-1;r++){for(var c=q.eq(r),w=c.children().eq(n),l=this._getColumnValueForComparison(w,u),f=null,e=r+1;e<h;e++){var a=q.eq(e),b=a.children().eq(n),v=this._getColumnValueForComparison(b,u),o=this._compareValues(l,v,u);t&&(o=-o);o>0&&(f=a,l=v)}f!==null&&(f.insertBefore(c),q=this.fetch("rows"))}this._applyZebraStripes();this.contenttabletbody[0].style.display=""}var y=t?"desc":"asc";this.sortState={direction:y,columnName:s.name};var p=this.columnsheadertable.children("tbody").children("tr").children();p.children(".grid-column-header-cell").removeClass("asc").removeClass("desc");p.eq(n).children(".grid-column-header-cell").addClass(y)}},_getColumnValueForComparison:function(n,t){var q=n.metadata().value;return checkExistsNotEmpty(q)&&t!=="text"||(q=n.text()),t!=="date"&&(q=this._normalizeString(q.toLowerCase())),q},_compareValues:function(n,t,q){var r,u;switch(q){case"number":r=parseFloat(n);u=parseFloat(t);isNaN(r)||isNaN(u)||(n=r,t=u);break;case"date":SourceCode.Forms.Browser.msie&&SourceCode.Forms.Layout.isRuntime()?(r=Date.parse(n),u=Date.parse(t)):(r=new Date(n),u=new Date(t));n=r;t=u}return n>t?1:n<t?-1:0},_normalizeString:function(n){return n=n.replace(new RegExp("\\s\\s+","g")," "),n.replace(new RegExp("^\\s*|\\s*$","g"),"")},_escapeMetadataString:function(n){return n.htmlEncode()},synccolumns:function(){this.options.triggersynccolumns=!0;this._syncWidths(null,!0);this._resizeColumnHeaderCells()},syncWidths:function(n){this._syncWidths(n)},_regex:{repx:/^(\d{1,})(px)?(%{0})$/,repw:/^100(\.0{0,2})? *%$|^\d{1,2}(\.\d{1,2})? *%$/,pixelOrPercentage:/px|%/gi},_explicitWidth:function(n){return checkExists(n.width)&&checkExists(n.width.toString().match(SCGrid._regex.repx))},_percentageWidth:function(n){return checkExists(n.width)&&checkExists(n.width.toString().match(SCGrid._regex.repw))},_visibleColumn:function(n){return checkExists(n.hidden)&&n.hidden===!0?!1:!0},_getGridMinWidth:function(){var n=this.columns.filter(this._visibleColumn.bind(this)),r=n.every(this._explicitWidth.bind(this));if(r){for(var q=0,t=0,u=n.length;t<u;t++)q+=parseInt(n[t].width);return q}return-1},_setColumnWidth:function(n,t){var s=this.element.find("table.grid-column-header-table, table.grid-content-table, table.grid-edit-templates-table, table.grid-display-templates-table, table.grid-summary-content-table"),h=this.contenttable.children("colgroup");t!==undefined&&(this.columns[n].width=t);var c=h.find("> col:nth-child("+(n+1)+")"),o=s.find("> tbody > tr > td:nth-child("+(n+1)+")");o.length>0&&o.each(function(){this.style.width=""});var q={},u=[],e=[],r=0;checkExists(this.columns[n].name)&&this.columns[n].name!==""&&(q.name=this.columns[n].name,r++);checkExists(this.columns[n].modulus)&&Boolean(this.columns[n].modulus)&&(q.modulus=Boolean(this.columns[n].modulus),r++);checkExists(this.columns[n].datatype)&&this.columns[n].datatype!==""&&(q.datatype=this.columns[n].datatype,r++);checkExists(this.columns[n].control)&&this.columns[n].control!==""&&(q.control=this.columns[n].control,r++);checkExists(this.columns[n].hidden)&&Boolean(this.columns[n].hidden)?(q.hidden=Boolean(this.columns[n].hidden),r++,e.push("hidden")):checkExists(this.columns[n].width)&&this.columns[n].width!==""&&(q.width=this.columns[n].width,r++,checkExists(this.columns[n].modulus)&&Boolean(this.columns[n].modulus)?u.push("min-width:"+this.columns[n].width):u.push("width:"+this.columns[n].width));checkExists(this.columns[n].align)&&this.columns[n].align!==""&&(q.align=this.columns[n].align,r++,u.push("text-align:"+this.columns[n].align));checkExists(this.columns[n].sortable)&&Boolean(this.columns[n].sortable)?(q.sortable=Boolean(this.columns[n].sortable),r++):(q.sortable=!0,r++);var f="<col";e.length>0&&(f+=' class="'+e.join(" ")+'"');r>0&&(f+=' data-options="'+jQuery.toJSON(q).htmlEncode()+'"');f+=' style="'+u.join("; ")+'" />';c.replaceWith(f)},runtimeSyncColumns:function(){var t=this.element.find("table.grid-column-header-table, table.grid-edit-templates-table, table.grid-display-templates-table, table.grid-summary-content-table"),q=this.contenttable.children("colgroup");t.each(function(){n(this).children("colgroup").remove();n(this).prepend(q.clone(!0))});t.each(function(){this.style.width=""})},_syncWidths:function(n,t){(t||this.options.disableInternalWidthSync!==!0)&&SourceCode.Forms.Utilities.performance.debounce(this._syncWidthsInternal,{args:arguments,thisContext:this,delay:100})},_syncWidthsInternal:function(t,q){var f=this;if(q||this.options.disableInternalWidthSync!==!0){var h=this.element.find("table.grid-column-header-table, table.grid-content-table, table.grid-edit-templates-table, table.grid-display-templates-table, table.grid-summary-content-table"),l=this.contenttable.children("colgroup"),a=this.columns.filter(this._visibleColumn.bind(this)),v=a.every(this._explicitWidth.bind(this)),c=-1,o,e;if(v&&a.length>0){for(var r=0,y=this.columns.length;r<y;r++)if(checkExists(this.columns[r].modulus)&&this.columns[r].modulus)break;r===y&&r--;var s=l.find("> col:nth-child("+(r+1)+")"),u=h.find("> tbody > tr > td:nth-child("+(r+1)+")");c=r;h.length>0&&h.each(function(){this.style.width=""});s.length>0&&(s[0].style.width="");u.length>0&&u.each(function(){this.style.width=""});var p=this.contenttable.width(),w=this._getGridMinWidth();p>w?(e=parseInt(this.columns[r].width)+(p-w),o=parseInt(this.columns[r].width)):e=o=parseInt(this.columns[r].width);s.length>0&&(s[0].style.width=e+"px");u.length>0&&u.each(function(){this.style.minWidth=o+"px";this.style.width=e+"px"})}this.element.find("table.grid-column-header-table, table.grid-edit-templates-table, table.grid-display-templates-table, table.grid-summary-content-table").each(function(){if(n(this).children("colgroup").remove(),n(this).prepend(l.clone(!0)),v&&c>-1){var t=n(this).find("> tbody > tr > td:nth-child("+(c+1)+")");t.length>0&&t.each(function(){this.style.minWidth=o+"px";this.style.width=e+"px"})}});var k=this.contenttable.width();checkExists(f.isMobileIOS)&&checkExists(f.isMobileIOSApp)||f._checkMobileDevice(f);this.element.find("table.grid-column-header-table, table.grid-edit-templates-table, table.grid-display-templates-table").each(function(){this.style.width=k+"px";f.isMobileIOS&&(this.style.width="100%")});var b=this.element.find("table.grid-column-header-table"),d=b.find("> colgroup > col"),u=b.find("> tbody > tr > td");u.find(".grid-column-header-cell").each(function(){this.style.width=""});d.each(function(n){var f=u.eq(n),q=f.children().first(),r=q.width(),t=q.find(".grid-column-header-text.LabelWrap");t.length>0&&(t[0].style.maxWidth="");r>0&&(q[0].style.width=r+"px",t.length>0&&(t[0].style.maxWidth=r+"px"))})}t!==!1&&this._applyZebraStripes();this.options.triggersynccolumns===!0&&(this.options.triggersynccolumns=!1,this._trigger("synccolumns",null,this.columns))},fetch:function(){switch(arguments[0]){case"header":return this.header;case"toolbars":return this.toolbars;case"columns":for(var u=0;u<this.columns.length;u++)this.columns[u].display=this.columnsheadertable.find(">tbody>tr>td").eq(u).find(".grid-column-header-text").text().trim();return this.columns;case"footer":if(checkExists(this.footer))return this.footer;break;case"rows":var t=this.contenttabletbody.children("tr:not(.action-row):not(.empty-grid):not(.edit-template-row, .display-template-row)");switch(arguments[1]){case"objects":return this._getSelectedValueObjects(t);case"text":return this._getSelectedText(t);case"values":return this._getSelectedValues(t);default:return t}break;case"selected-rows":switch(arguments[1]){case"objects":return this._getSelectedValueObjects(this.contenttabletbody.children("tr.selected"));case"text":return this._getSelectedText(this.contenttabletbody.children("tr.selected"));case"values":return this._getSelectedValues(this.contenttabletbody.children("tr.selected"));default:return this.contenttabletbody.children("tr.selected")}break;case"unselected-rows":return this.contenttabletbody.children("tr:not(.action-row):not(.empty-grid):not(.edit-template-row, .display-template-row):not(.selected)");case"first-row":case"last-row":var t=this.fetch("rows"),f=arguments[0]==="first-row"?t.first():t.last();switch(arguments[1]){case"objects":return this._getSelectedValueObjects(f);case"text":return this._getSelectedText(f);case"values":return this._getSelectedValues(f);default:return f}break;case"first-selected-row":var e=this.contenttabletbody.children("tr.selected");return e.length>1?n(e[0]):e;case"edit-template-row":return this.element.find(">.grid-edit-templates>table>tbody>tr");case"display-template-row":return this.element.find(">.grid-display-templates>table>tbody>tr");case"subset-rows":var o=this.contenttabletbody.children("tr:not(.action-row):not(.empty-grid):not(.edit-template-row, .display-template-row)"),q=o,s="";if(checkExists(arguments[1])){var r=arguments[1],h=checkExistsNotEmpty(r.startIndex)?parseInt(r.startIndex):0,c=checkExistsNotEmpty(r.endIndex)?parseInt(r.endIndex):q.length;s=checkExistsNotEmpty(r.returnType)?r.returnType:"";q=o.slice(h,c)}switch(s){case"objects":return this._getSelectedValueObjects(q);case"text":return this._getSelectedText(q);case"values":return this._getSelectedValues(q);default:return q}}},add:function(){switch(arguments[0]){case"header":this._addHeader(arguments[1]);break;case"toolbar":this._addToolbar();break;case"footer":this._buildFooter();break;case"rows":this._addRows(arguments[1]);break;case"row":this._addRow(arguments[1],arguments[2],arguments[3],arguments[4]);SourceCode.Forms.Layout.checkAndFixView(this.element);break;case"edit-template":this._addRowTemplate("edit",arguments[1],arguments[2],arguments[3]);break;case"display-template":this._addRowTemplate("display",arguments[1],arguments[2],arguments[3]);break;case"paging-controls":this._buildPagingControls()}},_getSelectedValueObjects:function(n){for(var o=[],u=0,c=n.length;u<c;u++){for(var s=[],h=n.eq(u).children("td"),f=0,l=h.length;f<l;f++){var q={},r=h.eq(f),t=r.metadata();if(checkExists(t.icon)&&(q.icon=t.icon),checkExists(t.value)&&(q.value=t.value),checkExists(t.control)&&(q.control=t.control),checkExists(t.fieldPropertyType)&&(q.fieldPropertyType=t.fieldPropertyType),q.display=r.text(),!checkExists(t.value)&&r.children(".grid-content-cell").is(".edit-mode")){var e=r.children(".grid-content-cell").children(".grid-content-cell-wrapper");e.children().length===1&&e.children().is("label.checkbox, label.radio")&&(q.value=e.find("input[type=checkbox], input[type=radio]").is(":checked"))}r.hasClass("hidden")&&(q.hidden=!0);s.push(q)}o.push(s)}return o},_getSelectedText:function(n){for(var r=[],t=0,e=n.length;t<e;t++){for(var u=[],f=n.eq(t).children("td"),q=0,o=f.length;q<o;q++)u.push(f.eq(q).text());r.push(u)}return r},_getSelectedValues:function(n){for(var u=[],q=0,c=n.length;q<c;q++){for(var f=[],e=n.eq(q).children("td"),r=0,l=e.length;r<l;r++){var o,t,s=e.eq(r),h=s.metadata();t=checkExists(h.value)?h.value:s.text();o=/^[-+]?\d*\.?\d*$/.test(t)?parseFloat(t):/^[-+]?\d*$/.test(t)?parseInt(t):/^([Ff]+(alse)?|[Tt]+(rue)?)$/.test(t)?Boolean(t):t;f.push(o)}u.push(f)}return u},setRowsClass:function(){for(var n=0,t=arguments[0].length;n<t;n++){var q=arguments[0][n];q.addClass(arguments[1])}},removeRowsClass:function(){for(var n=0,t=arguments[0].length;n<t;n++){var q=arguments[0][n];q.removeClass(arguments[1])}},_addRowTemplate:function(){var f=arguments[0]==="edit"?this.fetch("edit-template-row"):this.fetch("display-template-row");f.find(".edit-mode").removeClass("edit-mode");var r=f.clone(!0);this.contenttabletbody.children("tr.empty-grid").remove();this.element.removeClass("empty");var t=null;checkExists(this.rows)&&this.rows.length>0&&checkExists(arguments[3])&&parseInt(arguments[3])!==NaN&&parseInt(arguments[3])<=this.rows.length&&(t=n(r).insertBefore(this.contenttabletbody.children("tr").eq(parseInt(arguments[3]))));t===null&&(t=this.actionrow?n(r).insertBefore(this.contenttabletbody.children("tr.action-row").eq(0)):n(r).appendTo(this.contenttabletbody));var s=this;r.find("input.token-input").tokenbox({accept:".ui-draggable"});for(var u=r.find(".grid-content-cell-wrapper"),t=null,q=0;checkExists(arguments[1])&&q<u.length&&q<arguments[1].length;q++){n(u[q]).find("select").val(arguments[1][q]);var e=n(u[q]).find("input.token-input");e.length>0?e.tokenbox("value",arguments[1][q]):n(u[q]).find("input").val(arguments[1][q])}r.find("select").dropdown();this.rows=this.contenttabletbody.children("tr:not(.empty-grid):not(.action-row):not(.edit-template-row, .display-template-row)");checkExists(t)&&t.length>0&&(t.find("input.input-control[type=checkbox]").checkbox(),t.find("input.input-control[type=radio]").radiobutton(),t.find(".input-control.text-input").textbox(),t.find("select.input-control").dropdown());var o=arguments[2];o===undefined||o===!0?this._syncWidths():this._applyZebraStripes()},_addRows:function(t){if(t!==undefined&&t.length>0){var r=this.contenttabletbody.children("tr.action-row"),f=!1;r.length>0&&checkExists(document.activeElement)&&n(document.activeElement).is("a.action-row")&&(f=!0);this.contenttabletbody[0].style.display="none";var h=t.length;this._calculateVisibleColumnIndex();for(var e="",q=0;q<h;q++){var c=this.previouslyHighlightedIndex===q,l=this.previouslySelectedIndexes.indexOf(q)!==-1,u=t[q],o=u,s=null;u instanceof Array||(o=u.values,s=u.options.rowClasses);e+=this._buildRowHtml(o,null,null,s,c,l)}if(this.contenttabletbody.empty(),this.element.removeClass("empty"),this.contenttabletbody.html(e),this.contenttabletbody[0].style.display="",r.length>0){this.contenttabletbody.append(r);var a=this;r.on("click",function(t){a._trigger("actionrowclick",t,n(this))});f===!0&&(this._findHighlightedAndClear(),this.contenttabletbody.find("a.action-row").trigger("focus"))}this._bindContentEvents()}},_addRow:function(){this._calculateVisibleColumnIndex();var q=this._buildRowHtml(arguments[0],arguments[1],arguments[2]||null,arguments[3]||null);this.contenttabletbody.children("tr.empty-grid").remove();this.element.removeClass("empty");var t=null;this.rows=this.fetch("rows");checkExists(this.rows)&&this.rows.length>0&&checkExists(arguments[2])&&parseInt(arguments[2])!==NaN&&parseInt(arguments[2])<=this.rows.length&&(t=n(q).insertBefore(this.contenttabletbody.children("tr").eq(parseInt(arguments[2]))));t===null&&(t=this.actionrow?n(q).insertBefore(this.contenttabletbody.children("tr.action-row").eq(0)):n(q).appendTo(this.contenttabletbody));checkExists(t)&&t.length>0&&(t.find("input.input-control[type=checkbox]").checkbox(),t.find("input.input-control[type=radio]").radiobutton(),t.find(".input-control.text-input").textbox(),t.find("select.input-control").dropdown());var r=arguments[1];(r===undefined||r===!0)&&this._syncWidths();t.find(".fileImage, .hyperlink, .image").on("keydown",this._onListviewItemKeyDown).on("click",this._onListviewItemClick).on("focus",this._onListviewItemFocus).on("blur",this._onListviewItemBlur);return this.rows=this.fetch("rows"),t},_calculateVisibleColumnIndex:function(){if((!checkExists(this.firstVisibleColumnIndex)||!checkExists(this.lastVisibleColumnIndex))&&checkExists(this.columns))for(var t=!1,n=0;n<this.columns.length;n++)checkExists(this.columns[n].hidden)&&this.columns[n].hidden||(t===!1&&(this.firstVisibleColumnIndex=n,t=!0),this.lastVisibleColumnIndex=n)},_buildRowHtml:function(){var q='<tr class="';this.options.paging||(arguments[4]&&(q+="highlighted "),arguments[5]&&(q+="selected "));this.multiline===!1&&(q+="nowrap");checkExists(arguments[3])&&arguments[3]!==""&&(q+=" {0}".format(arguments[3]));q+='">';for(var c=this.columns.length,e=0,l=c;e<l;e++){var n={},f=[];e===this.firstVisibleColumnIndex?f.push("first"):e===this.lastVisibleColumnIndex&&f.push("last");n.isLiteral=this.options.isLiteral;var t=arguments[0][e];checkExists(t)&&(typeof t=="string"&&(n.value=t),checkExists(t.icon)&&(n.icon=t.icon),checkExists(t.value)&&(n.value=t.value),checkExists(t.display)&&(n.display=t.display),checkExists(t.control)&&(n.control=t.control),checkExists(t.html)&&(n.html=t.html),checkExists(t.cellclass)&&(n.cellclass=t.cellclass),checkExists(t.counter)&&(n.counter=t.counter),checkExists(t.align)&&(n.align=t.align),checkExists(t.isLiteral)&&(n.isLiteral=t.isLiteral),checkExists(t.title)&&(n.title=t.title),checkExists(t.fieldPropertyType)&&(n.fieldPropertyType=t.fieldPropertyType));q+="<td";var o={},s=0;checkExists(n.icon)&&(o.icon=n.icon,s++);checkExists(n.value)&&(o.value=n.value,s++);checkExists(n.control)&&(o.control=n.control,s++);checkExists(n.counter)&&(o.counter=n.counter,s++);checkExists(n.fieldPropertyType)&&(o.fieldPropertyType=n.fieldPropertyType,s++);var r=this.columns[e];checkExists(r.hidden)&&r.hidden&&f.push("hidden");checkExists(n.align)&&n.align!=="none"?f.push(n.align.toLowerCase()+"-align"):checkExists(r.align)&&r.align!=="none"&&f.push(r.align.toLowerCase()+"-align");f.length>0&&(q+=' class="'+f.join(" ")+'"');s>0&&(q+=' data-options="'+jQuery.toJSON(o).htmlEncode()+'"');q+='><div class="grid-content-cell';checkExists(n.icon)&&n.icon!==""&&(q+=" icon "+n.icon);checkExists(n.cellclass)&&n.cellclass!==""&&(q+=" "+n.cellclass);checkExists(n.align)||checkExists(r.datatype)&&r.datatype==="number"&&(q+=" numeric");checkExists(r.control)&&r.control!==""&&(q+=" checkradio-cell");var u=null;if(checkExistsNotEmpty(n.title)&&n.title!=="&nbsp;"?(u=n.title,typeof u=="string"&&(u=this._escapeMetadataString(u))):checkExistsNotEmpty(n.display)&&n.display!=="&nbsp;"&&(u=n.display,typeof u=="string"&&(u=this._getTooltip(n))),q+=checkExists(u)?'"><div class="grid-content-cell-wrapper" title="'+u+'">':'"><div class="grid-content-cell-wrapper">',checkExistsNotEmpty(n.html))q+=n.html;else if(checkExists(r.control)&&(r.control==="checkbox"||r.control==="radiobutton"))switch(r.control){case"checkbox":q+=SCCheckbox.html({checked:r.datatype==="boolean"&&n.value});break;case"radiobutton":q+=SCRadiobutton.html({})}else{var h=checkExists(n.display)?n.display:n.value;n.isLiteral||typeof h!="string"||(h=this._escapeMetadataString(h));q+=h}q+="<\/div><\/div><\/td>"}return q+"<\/tr>"},_highlight:function(t){if(checkExists(t)){if(typeof t=="object")return this._findHighlightedAndClear(),t.length>1&&(t=n(t[t.length-1])),t.addClass("highlighted"),this.previouslyHighlightedIndex=this._getHighlightedIndex(),t;if(!isNaN(t)){var q=this._highlight(this._findByIndex(t));return this.previouslyHighlightedIndex=t,q}}},_setRowFirstAndLastVisibleColumnClasses:function(){var q=this.contenttabletbody.find("tr");if(q.length>0)for(var r=0;r<q.length;r++){var u=n(q[r]),t=u.find("td:not(.hidden)").removeClass("first last");t.length>0&&(n(t[0]).addClass("first"),n(t[t.length-1]).addClass("last"))}},_findByIndex:function(t){return isNaN(t)?-1:n(this.contenttabletbody.children()[t])},_highlightNext:function(n){var t=this._findHighlightedAndClear(),q=this.contenttabletbody.children().index(t);if(q!==-1&&q<this._getItemCount()-this.rowCountModifier){if(this.actionrow===!0&&q===this._getItemCount()-this.rowCountModifier-1)return checkExists(n)&&n===!0?this._highlight(t):(this.contenttabletbody.find("a.action-row").trigger("focus"),null);var r=t.next();return this._highlight(r),this.adjustItemVisibility(r),r}return this._highlight(t)},_highlightPrevious:function(){var n=this._findHighlightedAndClear(),q=this.contenttabletbody.children().index(n);if(q===-1)return this._highlight(this._getItemCount()-this.rowCountModifier-1);if(q>0){var t=n.prev();return this._highlight(t),this.adjustItemVisibility(t),t}return this._highlight(n)},_getHighlightedIndex:function(n){var t=-1;checkExists(n)&&typeof n=="object"||(n=this._getHighlighted());var r=this.contenttabletbody.children();t=r.index(n);for(var q=0;q<r.length;q++)r[q].style.display==="none"&&q<t&&t--;return t},_findHighlightedAndClear:function(n){return checkExists(n)?typeof n=="object"?(n.removeClass("highlighted"),n):-1:this._findHighlightedAndClear(this._getHighlighted())},_highlightSelectedOrFirst:function(){var q=this._getHighlighted();if(q.length===0){var t=this.contenttabletbody.find(".selected");checkExists(t)&&t.length>1&&(t=n(t[t.length-1]));q=this._highlight(t);q.length===0&&(this._getItemCount()===0&&this.actionrow===!0?this.contenttabletbody.find("a.action-row").trigger("focus"):q=this._highlight(0))}},_getHighlighted:function(){return this.contenttabletbody.find(".highlighted")},_getItemCount:function(){var n=this.contenttabletbody.children().length;return this.actionrow===!0&&n--,n},_getRowPosition:function(n){return checkExists(n)||(n=this.contenttable.find("tr.highlighted")),this.contenttabletbody.children().index(n)},_onKeyDown:function(t){var q=checkExists(t)&&checkExists(t.data)?t.data:this,a=t.target.tagName.toLowerCase()!=="textarea",f=t.ctrlKey;t.metaKey&&(f=t.metaKey);switch(t.which){case 9:var u=q._isFocussedOnEditableItem(),e=q._getHighlighted(),w=q._isActionRowActive();if(!u){var s=q.contenttable.find("tr.highlighted"),b=q._getRowPosition(s),o=q._buildTabIndexArray(s),k=o.length;t.shiftKey?(b!==0||q.lrCounter>=0)&&(q._focusPreviousItem(),t.stopPropagation(),t.preventDefault()):q.lrCounter<k&&!w&&e.length>0?(b<=q._getItemCount()-1-q.rowCountModifier||q.lrCounter<k-1)&&(q._focusNextItem(),t.stopPropagation(),t.preventDefault()):w||(q.contenttable.trigger("focus"),q._highlight(q._getItemCount()),q.lrCounter=-1,q._focusPreviousItem(),t.stopPropagation(),t.preventDefault())}break;case 37:var u=q._isFocussedOnEditableItem();u||(q._isActionRowActive()&&(q.contenttable.trigger("focus"),q._highlight(q._getItemCount()),q.lrCounter=-1),q._focusPreviousItem());break;case 39:var u=q._isFocussedOnEditableItem();u||q._isActionRowActive()||q._focusNextItem();break;case 38:var u=q._isFocussedOnEditableItem();if(!u){var v=q._isActionRowActive();if(v){var d=q.contenttable.find("tr.action-row");v=!0;document.activeElement.blur();q.contenttable.trigger("focus");q._highlight(d);q.adjustItemVisibility(d)}if(a&&(!q._isFocussedOnEditableItem()||v))if(q.previousFocussedItemColumn>=0)for(var h=!1;!h;){var y=q._highlightPrevious(),c=q._focusItemInColumn(q.previousFocussedItemColumn);if(c.length>0){h=!0;for(var s=q.contenttable.find("tr.highlighted"),o=q._buildTabIndexArray(s),r=0,g=o.length;r<g;r++)n(o[r]).is(c)&&(q.lrCounter=r)}else if(!checkExists(y)||y.length===0||q._getRowPosition(y)===0){q.lrCounter=-1;q.previousFocussedItemColumn=-1;q.contenttable.trigger("focus");break}}else{var ft=q._highlightPrevious();q.multiselect&&t.shiftKey&&q._handleClick(t,q,ft)}}t.target.tagName.toLowerCase()!=="textarea"&&t.preventDefault();break;case 40:var u=q._isFocussedOnEditableItem();if(!u&&a)if(q.previousFocussedItemColumn>=0&&!q._isActionRowActive())for(var h=!1,ht=q._getItemCount();!h;){var l=q._highlightNext(),c=q._focusItemInColumn(q.previousFocussedItemColumn),ct=q._getRowPosition();if(c.length>0){h=!0;for(var s=q.contenttable.find("tr.highlighted"),o=q._buildTabIndexArray(s),r=0,g=o.length;r<g;r++)n(o[r]).is(c)&&(q.lrCounter=r)}else if(!checkExists(l)||l.length===0||q._getRowPosition(l)===q._getItemCount()-1){q.lrCounter=-1;q.previousFocussedItemColumn=-1;q.contenttable.trigger("focus");break}}else if(q.multiselect&&t.shiftKey){var l=q._highlightNext(!0);q._handleClick(t,q,l)}else q._highlightNext();t.target.tagName.toLowerCase()!=="textarea"&&t.preventDefault();break;case 13:var nt=!1,tt=t.target.className;if(checkExists(tt)&&typeof tt=="string"&&(nt=n(t.target).hasClass("file-wrapper")),t.target.tagName.toLowerCase()!=="textarea"&&!nt&&t.target.getAttribute("contentEditable")!=="true"){var e=q._getHighlighted(),p=q.contenttabletbody.children("tr.edit-template-row");if(document.activeElement===q.contenttable[0]&&t.preventDefault(),q.enterCommitsRow&&p.length>0){t.preventDefault();var qt=p.find(".focus");if(qt.length>0)qt.trigger("blur");else try{var rt=document.activeElement;checkExists(rt)&&n(rt).trigger("blur")}catch(lt){}var et=q.contenttable.parents(".grid"),ot=et[0].getAttribute("actionType");q._trigger("commitrowwithkey",t,p);ot==="add"&&q.actionrow===!0?(q._findHighlightedAndClear(),q.contenttabletbody.find("a.action-row").trigger("focus"),t.preventDefault(),t.stopPropagation()):(q.contenttable.trigger("focus"),q.adjustItemVisibility(q._getHighlighted()))}else q.actionrow===!0&&t.target===q.contenttabletbody.find("a.action-row")[0]?(q._findHighlightedAndClear(),q.deselect(),t.preventDefault(),q._trigger("actionrowclick",t,n(this))):(q._handleClick(t,q,e,f,null,!0),t.preventDefault(),e.trigger("dblclick",q))}break;case 32:var u=q._isFocussedOnEditableItem();if((document.activeElement===q.contenttable[0]||n(document.activeElement).hasClass("action-row"))&&(t.preventDefault(),t.stopPropagation()),!u){var e=q._getHighlighted();e.hasClass("action-row")||n(document.activeElement).hasClass("action-row")?(q._findHighlightedAndClear(),q.deselect(),q._trigger("actionrowclick",t,n(this))):q._handleClick(t,q,e,f)}break;case 27:n(document.activeElement).is("a.action-row")||(q.lrCounter=-1,q.previousFocussedItemColumn=-1,q.contenttable.trigger("focus"));break;case 65:if(f){var u=q._isFocussedOnEditableItem();if(!u&&a){if(q.multiselect)for(var ut=q.fetch("unselected-rows"),r=0;r<ut.length;r++){var st=n(ut[r]);q._handleClick(t,q,st)}return!1}}break;case 67:var u=q._isFocussedOnEditableItem();f&&!u&&q.cellcontentselect!==!0&&q._copySelectedRowsToClipboard.call(q,t)}},_copySelectedRowsToClipboard:function(n){n.preventDefault();for(var e=this.fetch("selected-rows","text"),t="<html><table>",q="",r=0;r<e.length;r++){var o=e[r];t+="<tr>";for(var u=0;u<o.length;u++){var s=o[u];t+="<td>"+s+"<\/td>";q+=s+"\t"}t+="<\/tr>";q+="\r\n"}t+="<\/table><\/html>";var f=function(){var r=document.activeElement,t=jQuery(window),u=t.scrollTop(),f=t.scrollLeft(),n=jQuery('<textarea style="display:block;width:2px;height:2px;position:absolute;top:{0}px;left:{1}px;"><\/textarea>'.format(u,f));jQuery("body").append(n);n.val(q);n.trigger("focus");n[0].setSelectionRange(0,n[0].value.length);document.execCommand("copy");n.remove();checkExists(r)&&r.focus();t.scrollTop(u);t.scrollLeft(f)},h=!0,c=function(n){if(h){document.removeEventListener("copy",c);try{n.clipboardData.setData("text/plain",q);n.clipboardData.setData("text/html",t);n.preventDefault()}catch(r){h=!1;f()}}};SourceCode.Forms.Browser.edge?f():(document.addEventListener("copy",c),f())},_isActionRowActive:function(){try{var t=document.activeElement;if(checkExists(t))return n(t).hasClass("action-row")}catch(q){return!1}},_focusNextItem:function(){var q=this.contenttable.find("tr.highlighted"),t=this._buildTabIndexArray(q),r=t.length;if(r-1!==this.lrCounter||this._getRowPosition(q)!==this._getItemCount()-1||this.actionrow)if(this.lrCounter++,this.lrCounter>=t.length)this.lrCounter=-1,this.previousFocussedItemColumn=-1,this.contenttable.trigger("focus"),this._highlightNext();else if(this.lrCounter>=0&&checkExists(t[this.lrCounter])){try{n(t[this.lrCounter]).trigger("focus")}catch(u){}this.previousFocussedItemColumn=n(t[this.lrCounter]).closest("td")[0].cellIndex}},_focusPreviousItem:function(){this.lrCounter--;var q=this.contenttable.find("tr.highlighted"),t=this._buildTabIndexArray(q),r=t.length;if(this.lrCounter<-1)if(this._highlightPrevious(),q=this.contenttable.find("tr.highlighted"),t=this._buildTabIndexArray(q),r=t.length,this.lrCounter=r-1,checkExists(t[this.lrCounter])){this.previousFocussedItemColumn=n(t[this.lrCounter]).closest("td")[0].cellIndex;try{n(t[this.lrCounter]).trigger("focus")}catch(u){}}else this.previousFocussedItemColumn=-1,this.contenttable.trigger("focus");else if(this.lrCounter===-1)this.previousFocussedItemColumn=-1,this.contenttable.trigger("focus");else if(r>0&&this.lrCounter>=0){this.previousFocussedItemColumn=n(t[this.lrCounter]).closest("td")[0].cellIndex;try{n(t[this.lrCounter]).trigger("focus")}catch(u){}}},_focusItemInColumn:function(t){var r=this.contenttable.find("tr.highlighted > td"),q=!1;try{q=n(r[t]).find("input[tabindex!=-1]:not(.disabled), a[tabindex!=-1], [tabindex][tabindex!='-1']:not(.disabled)").first().trigger("focus")}catch(u){}return q},_buildTabIndexArray:function(n){return n.find("td:not(.hidden) input[type='radio'][tabindex!='-1']:not(.disabled), td:not(.hidden) :not(div.HyperlinkPopupOuterWrapper) [tabindex][tabindex!='-1'][disabled!='disabled']:not(.disabled)")},_isFocussedOnEditableItem:function(){return checkExists(document.activeElement)?this.contenttable.find(".edit-template-row").has(document.activeElement).length>0:!1},adjustItemVisibility:function(t){if(checkExists(t)||(t=this._getHighlighted()),checkExists(this.scrollWrapper)||(this.scrollWrapper=this._getScrollWrapper(t)),this.scrollWrapper===-1)return!1;var q=t.offset().top,o=t.height(),u=q+o,r=n(document),f=n(window).height(),e=r.scrollTop();u>e?r.scrollTop(u-f):q<e-f&&r.scrollTop(q)},_getScrollWrapper:function(t){var q=t.parents(":scrollable(y)"),u=q.length;if(u===0)return-1;for(var r=0;r<u;r++)if(q[r].scrollHeight>n(q[r]).height())return n(q[r]);return n(q[u-1])},_buildPagingControls:function(){var n=this;if(this.element.removeClass("without-footer").addClass("with-footer"),this.element.children(".grid-footer").length===0&&this.element.append('<div class="grid-footer"><\/div>'),this.element.children(".grid-footer").children(".toolbars").length===0){var r={toolbars:1,toolbarOptions:[{buttons:[{icon:"paging-first",description:Resources.CommonLabels.PagingFirstPageText,tabIndex:this.tabIndex},{icon:"paging-left",description:Resources.CommonLabels.PagingPreviousPageText,tabIndex:this.tabIndex},{icon:"paging-right",description:Resources.CommonLabels.PagingNextPageText,tabIndex:this.tabIndex},{icon:"paging-last",description:Resources.CommonLabels.PagingLastPageText,tabIndex:this.tabIndex}]}]};this.element.children(".grid-footer").append(SourceCode.Forms.Controls.ToolbarGroup.html(r));this.footer=this.element.children(".grid-footer").children(".toolbars").toolbargroup();var u='<div class="toolbar-divider"><\/div>'+('<div class="grid-paging-control"><div class="grid-paging-control-text current">'+Resources.CommonLabels.PagingPageText+"<\/div>"+SCTextbox.html({id:this.element.attr("id")+"_pagingtxtbox",value:"1",tabIndex:this.tabIndex})+'<div class="grid-paging-control-text total">'+Resources.CommonLabels.PagingTotalPagesText.replace("{0}","1")+"<\/div><\/div>");var f=this.footer.find(".toolbar-button.paging-left");jQuery(u).insertAfter(f);this.footer.find(".input-control.text-input").addClass("small").textbox();this.footer.find(".grid-paging-control-text.total")[0].style.display="none";this.footer.find(".toolbar-button.paging-last")[0].style.display="none";this.unhide("footer");this.footer.find(".toolbar-button.paging-first, .toolbar-button.paging-left, .toolbar-button.paging-right, .toolbar-button.paging-last").on("click",function(){jQuery(this).hasClass("disabled")||(jQuery(this).hasClass("paging-first")?n.gotopage("start",n.page,n.element):jQuery(this).hasClass("paging-left")?n.gotopage("previous",n.page,n.element):jQuery(this).hasClass("paging-right")?n.gotopage("next",n.page,n.element):jQuery(this).hasClass("paging-last")&&n.gotopage("end",n.page,n.element))});this.footer.find(".input-control.text-input input[type=text]").on("blur",function(){n._changePage()}).on("keyup",function(t){t.keyCode===13&&(n._changePage(),jQuery(this).get(0).focus())}).on("keypress",function(t){var q=t.which!==0?t.which:t.keyCode,f=n.options.page,u=n.options.totalpages,r=parseInt(jQuery(this).val());if(isNaN(r)&&(r=0),q>45&&q<58||q>32&&q<41||q===8||q===9){if((q!==8||q!==9)&&r!==0&&checkExists(u)&&u==="-1"&&r.toString().length>=u.toString().length)return t.preventDefault(),t.stopPropagation(),!1}else return t.preventDefault(),t.stopPropagation(),!1})}if(SourceCode.Forms.Browser.msie)for(var t=this.footer.find(".toolbar-button"),q=t.length;q--;)t[q].setAttribute("onclick","return false");n._updatePagingControls()},_addHeader:function(){this.header===null&&(this.header=n('<div class="grid-header"><div class="grid-header-l"><\/div><div class="grid-header-c"><div class="grid-header-wrapper"><div class="grid-header-text"><\/div><\/div><\/div><div class="grid-header-r"><\/div><\/div>').insertBefore(this.element.children(":first-child")).find(".grid-header-text"),this.element.removeClass("without-header").addClass("with-header"));this.header.html(arguments[0].htmlEncode())},_addToolbar:function(){this.toolbars===null&&(this.toolbars=n('<div class="grid-toolbars"><div class="toolbars"><\/div><\/div>').insertBefore(this.element.children(".grid-body")).find(".toolbars"),this.toolbars.toolbargroup(),this.element.removeClass("without-toolbar"));this.toolbars.toolbargroup("addtoolbar");switch(this.toolbars.toolbargroup("fetch","toolbars").length){case 1:this.element.addClass("with-toolbar").removeClass("with-double-toolbar").removeClass("with-triple-toolbar");break;case 2:this.element.addClass("with-double-toolbar").removeClass("with-toolbar").removeClass("with-triple-toolbar");break;case 3:this.element.addClass("with-triple-toolbar").removeClass("with-double-toolbar").removeClass("with-toolbar")}},_buildColumns:function(){var n=this._generateColumnsHeaderCellsHTML({columns:this.columns,customcolumns:this.customcolumns});this.columnsheadertable.children("tbody").html(n);this.columnsheadertable.find("input.input-control[type=checkbox]").checkbox();this.actionrow&&this.contenttabletbody.children("tr.action-row").attr("colspan",this.columns.length)},_buildFooter:function(){if(this.footer===null){var n=this._generateFooterHTML();this.element.append(n);this.element.removeClass("without-footer").addClass("with-footer")}this.footer=this.element.children(".grid-footer").children(".toolbars").toolbargroup()},zebra:function(){this._applyZebraStripes()},_applyZebraStripes:function(){if(this.options.zebraStripes)if(SourceCode.Forms.Browser.msie&&parseInt(SourceCode.Forms.Browser.version,10)===8)for(var t=!1,u=this.contenttabletbody.children("tr"),q=0,f=u.length;q<f;q++){var r=n(u[q]);r.removeClass("even");r.hasClass("hidden")||(t===!1?(r.addClass("even"),t=!0):t=!1)}else this.contenttable.addClass("zebra-stripes")},clear:function(){var t=arguments[0];this.contenttabletbody.children("tr.edit-template-row").length>0&&this.commit();checkExists(this.options.customsort)||checkExists(t)&&t!==!1||this.clearsort();var q=!1;checkExists(document.activeElement)&&n(document.activeElement).is("a.action-row")&&(q=!0);var r=this.contenttabletbody.children("tr.action-row").clone(!0);this.contenttabletbody.empty();this.actionrow?r.length>0&&(this.contenttabletbody.append(r),q===!0&&(this._findHighlightedAndClear(),this.contenttabletbody.find("a.action-row").trigger("focus"))):this.contenttabletbody.html('<tr class="empty-grid"><td class="empty-grid"'+(this.columns.length>0?' colspan="'+this.columns.length+'"':"")+'><div class="grid-content-cell"><div class="grid-content-cell-wrapper">'+this.resources.emptygrid+"<\/div><\/div><\/td><\/tr>");this.element.addClass("empty");this.isRuntime||(this.previouslySelectedIndexes=[],this.previouslyHighlightedIndex=-1);this.rows=this.contenttabletbody.children("tr:not(.empty-grid):not(.action-row)")},populate:function(){var t=this;n.ajax({type:t.options.method,url:t.options.url,dataType:t.options.datatype,data:checkExists(t.options.urldata)?t.options.urldata:{},success:function(q){n(q).find("header").length>0&&t._addHeader(n(q).find("header").text());n(q).find("columns").length>0&&t._importColumns(n(q).find("columns"));n(q).find("rows").length>0&&t._importData(n(q).find("rows"))},error:function(){}})},_importColumns:function(){var q=n(arguments[0]).children("column");this.columns=[];for(var t=0,e=q.length;t<e;t++){for(var f={},u=["name","sortable","align","datatype","hidden","control","modulus"],r=0,o=u.length;r<o;r++)checkExists(q.eq(t).attr(u[r]))&&(f[u[r]]=q.eq(t).attr(u[r])==="true"||q.eq(t).attr(u[r])==="false"?q.eq(t).attr(u[r])==="true"?!0:!1:q.eq(t).attr(u[r]));checkExists(q.eq(t).attr("width"))&&(f.width=q.eq(t).attr("width"));checkExists(f.display)||(f.display=q.eq(t).text());this.columns.push(f)}this._buildColumns()},_importData:function(){this.clear();for(var f=n(arguments[0]).children("row"),r=0,s=f.length;r<s;r++){for(var e=[],u=0,h=this.columns.length;u<h;u++){var q={},t=f.eq(r).children("cell[column='"+this.columns[u].name+"']");q.display=t.text();q.value=t.attr("value")!==undefined&&t.attr("value")!==""?t.attr("value"):t.text();t.attr("icon")!==""&&(q.icon=t.attr("icon"));e.push(q)}this._addRow(e,!1)}if(this.options.paging){n(arguments[0]).attr("page")!==""&&(this.page=parseInt(n(arguments[0]).attr("page"))+1);var c=n(arguments[0]).attr("total")!==""?parseInt(n(arguments[0]).attr("total")):0,o=n(arguments[0]).attr("rows")!==""?parseInt(n(arguments[0]).attr("rows")):0;this.page=n(arguments[0]).attr("page")!==""?parseInt(n(arguments[0]).attr("page"))+1:1;this.totalpages=o>0?Math.ceil(c/o):1;this._updatePagingControls()}this._syncWidths()},remove:function(){switch(arguments[0]){case"header":checkExists(this.header)&&this.header.closest(".grid-header").remove();this.header=null;this.element.removeClass("with-header").addClass("without-header");break;case"footer":checkExists(this.footer)&&this.footer.closest(".grid-footer").remove();this.footer=null;this.panel.removeClass("with-footer").addClass("without-footer");break;case"toolbars":(checkExists(this.toolbars)||this.toolbars.length>0)&&this.element.children(".grid-toolbars").remove();this.toolbars=null;this.element.removeClass("with-toolbar").removeClass("with-double-toolbar").removeClass("with-triple-toolbar").addClass("without-toolbar");break;case"row":if(this.contenttabletbody.children("tr:not(.action-row)").eq(parseInt(arguments[1])).remove(),this.rows=this.contenttabletbody.children("tr:not(.empty-grid):not(.action-row):not(.edit-template-row, .display-template-row)"),this.previouslySelectedIndexes=[],this.previouslyHighlightedIndex=this._getHighlightedIndex(),this.rows.length<1)this.clear();else for(var t=this.fetch("selected-rows"),n=0;n<t.length;n++)this.previouslySelectedIndexes.push(this.rows[0].indexOf(t[n]));var q=arguments[2];q===undefined||q===!0?this._syncWidths():this._applyZebraStripes();break;case"selected-row":case"selected-rows":this.fetch("selected-rows").remove();this.rows=this.contenttabletbody.children("tr:not(.empty-grid):not(.action-row):not(.edit-template-row, .display-template-row)");this.previouslySelectedIndexes=[];this.previouslyHighlightedIndex=this._getHighlightedIndex();this.rows.length<1&&this.clear();this._syncWidths();break;case"first-selected-row":if(this.fetch("first-selected-row").remove(),this.rows=this.contenttabletbody.children("tr:not(.empty-grid):not(.action-row):not(.edit-template-row, .display-template-row)"),this.previouslySelectedIndexes=[],this.previouslyHighlightedIndex=this._getHighlightedIndex(),this.rows.length<1)this.clear();else for(var t=this.fetch("selected-rows"),n=0;n<t.length;n++)this.previouslySelectedIndexes.push(this.rows.index(t[n]));var q=arguments[1];q===undefined||q===!0?this._syncWidths():this._applyZebraStripes()}},_applyActionRow:function(){function r(n){return checkExists(n.hidden)&&n.hidden===!0?!1:!0}var t=this,q=this.contenttabletbody.find("a.action-row");if(q.length===0){var u='<tr class="action-row"><td class="action-row"'+(checkExists(this.columns)&&this.columns.length>0?' colspan="'+this.columns.filter(r).length+'"':"")+'><div class="grid-content-cell"><div class="grid-content-cell-wrapper"><a href="javascript:;" class="action-row" tabindex="'+this.tabindex+'">'+this.resources.actionrow+"<\/a><\/div><\/div><\/td><\/tr>";this.contenttabletbody.append(u);q=this.contenttabletbody.find("a.action-row")}q.closest("tr.action-row").on("click",function(q){t._findHighlightedAndClear();t.deselect();t._trigger("actionrowclick",q,n(this))})},getActionRow:function(){return this.contenttabletbody.find("a.action-row")},getContentTable:function(){return this.contenttable},select:function(t,q){var o=this.contenttabletbody.children("tr:not(.empty-grid):not(.action-row):not(.edit-template-row, .display-template-row)");if(checkExists(t)){for(var e=t||[],f=checkExists(q)?q:null,r=null,u=0,s=e.length;u<s;u++)r=n(o[e[u]]),r.hasClass("highlighted")||(this._findHighlightedAndClear(),this.isRuntime&&this._highlight(r)),(!checkExists(this.initialGroupSelectedRow)||checkExists(f)&&f.shiftKey===!1)&&(this.initialGroupSelectedRow=r,this.groupSelectedRows=[]),r.hasClass("selected")||(r.addClass("selected"),this.groupSelectedRows.push(e[u]),this.previouslySelectedIndexes.push(e[u]),this.options.singleEventOnMultiSelect===!1&&this._trigger("rowselect",f,r));this.options.singleEventOnMultiSelect===!0&&this._trigger("rowselect",f,r,e)}else{for(var f=checkExists(q)?q:null,h=[],r=null,u=0,s=o.length;u<s;u++)r=n(o[u]),r.hasClass("highlighted")||(this._findHighlightedAndClear(),this.isRuntime&&this._highlight(r)),(!checkExists(this.initialGroupSelectedRow)||checkExists(f)&&f.shiftKey===!1)&&(this.initialGroupSelectedRow=r,this.groupSelectedRows=[]),r.hasClass("selected")||(h.push(u),r.addClass("selected"),this.groupSelectedRows.push(u),this.previouslySelectedIndexes.push(u),this.options.singleEventOnMultiSelect===!1&&this._trigger("rowselect",f,r));this.options.singleEventOnMultiSelect===!0&&this._trigger("rowselect",f,r,h)}},deselect:function(){var e=this.contenttabletbody.children("tr:not(.empty-grid):not(.action-row):not(.edit-template-row, .display-template-row)");if(checkExists(arguments[0])){for(var q=arguments[0]||[],r=checkExists(arguments[1])?arguments[1]:null,t=null,n=0,o=q.length;n<o;n++)if(t=e.eq(q[n]),t.hasClass("selected")){t.removeClass("selected");var u=this.groupSelectedRows.indexOf(q[n]);u!==-1&&this.groupSelectedRows.splice(u,1);var f=this.previouslySelectedIndexes.indexOf(q[n]);f!==-1&&this.previouslySelectedIndexes.splice(f,1);this.options.singleEventOnMultiSelect===!1&&this._trigger("rowunselect",r,t)}this.options.singleEventOnMultiSelect===!0&&this._trigger("rowunselect",r,t,q)}else{for(var s=[],t=null,n=0,o=e.length;n<o;n++)if(t=e.eq(n),t.hasClass("selected")){s.push(n);t.removeClass("selected");var u=this.groupSelectedRows.indexOf(n);u!==-1&&this.groupSelectedRows.splice(u,1);var f=this.previouslySelectedIndexes.indexOf(n);f!==-1&&this.previouslySelectedIndexes.splice(f,1);this.options.singleEventOnMultiSelect===!1&&this._trigger("rowunselect",r,t)}this.options.singleEventOnMultiSelect===!0&&this._trigger("rowunselect",r,t,s)}},_trigger:function(t,q,r){var f=this.options[t],o=t===this.widgetEventPrefix?t:this.widgetEventPrefix+t;if(q=n.Event(q),q.type=o,q.originalEvent)for(var e=n.event.props.length,u;e;)u=n.event.props[--e],q[u]=q.originalEvent[u];return this.element.trigger(q,r),!(typeof f=="function"&&f.call(this.element[0],r,q)===!1||q.isDefaultPrevented())},moverowup:function(n){n>0&&this.moverow(n,n-1)},moverowdown:function(n){n<this.rows.length-1&&this.moverow(n,n+1)},moverow:function(n,t){n!==t&&(this.rows=this.contenttabletbody.children("tr:not(.empty-grid):not(.action-row):not(.edit-template-row, .display-template-row)"),t===this.rows.length-1?this.rows.eq(n).insertAfter(this.rows.eq(t)):n<t?this.rows.eq(n).insertAfter(this.rows.eq(t)):this.rows.eq(n).insertBefore(this.rows.eq(t)),this.rows=this.contenttabletbody.children("tr:not(.empty-grid):not(.action-row):not(.edit-template-row, .display-template-row)"),this._applyZebraStripes())},_toggleColumn:function(n,t){var q=!t,f=this.element.find("table.grid-edit-templates-table"),e=this.element.find("table.grid-display-templates-table"),o=this.element.find("table.grid-summary-content-table"),s=this.element.hasClass("bw");this.columns[n].hidden=q;var h=n+1,r="col:nth-child("+h+")",u="td:nth-child("+h+")",c=this.contenttable.children("colgroup").children(r).toggleClass("hidden",q);this.columnsheadertable.children("colgroup").children(r).toggleClass("hidden",q);f.children("colgroup").children(r).toggleClass("hidden",q);e.children("colgroup").children(r).toggleClass("hidden",q);o.children("colgroup").children(r).toggleClass("hidden",q);this.contenttable.find(u).toggleClass("hidden",q);this.columnsheadertable.find(u).toggleClass("hidden",q);f.find(u).toggleClass("hidden",q);e.find(u).toggleClass("hidden",q);o.find(u).toggleClass("hidden",q);s||q||checkExists(this.columns[n].width)&&this.columns[n].width!==""&&(this.columns[n].modulus?c[0].style.minWidth=this.columns[n].width:c[0].style.width=this.columns[n].width);s&&this._updateColumnWidths()},_updateColumnWidths:function(t){var h=this.element.find("table.grid-content-table").children("colgroup"),c=h.children(".hidden"),f=h.children(":not(.hidden)"),l=c.length,q=f.length,a=0,s=this.contenttable.find("td.action-row");s.length>0&&(s.removeClass("hidden"),s.attr("colspan",q));for(var e=0;l--;){var k=n(c[l]),v=k.metadata(),u="";checkExistsNotEmpty(v.width)&&(u=v.width,u=u.replace(SCGrid._regex.pixelOrPercentage,""),e+=parseInt(u))}while(q--){var d=n(f[q]),y=d.metadata(),u="";checkExistsNotEmpty(y.width)&&(u=y.width,u=u.replace(SCGrid._regex.pixelOrPercentage,""),a+=parseInt(u))}if(q=f.length,e=100-a,checkExistsNotEmpty(t)&&(e+=t),e>0||e<0){var p=e/q,w=parseInt(p),o=p-w;for(o>0&&(o=e%q);q--;){var r="",g=n(f[q]),b=g.metadata();checkExistsNotEmpty(b.width)&&(r=b.width,r=parseInt(r.replace(SCGrid._regex.pixelOrPercentage,"")));r+=w;o&&(r+=o,o-=o);f[q].style.width=r+"%"}}else while(q--){var r=n(f[q]).metadata().width;r=parseInt(r.replace(SCGrid._regex.pixelOrPercentage,""));f[q].style.width=r+"%"}},hide:function(){var n=arguments.length===3?arguments[2]:typeof arguments[1]=="boolean"?arguments[1]:!0;switch(arguments[0]){case"column":case"column-header":var t=typeof arguments[1]=="string"?this._getColumnIndex(arguments[1]):arguments[1];t>-1?(arguments[0]==="column"?this._toggleColumn(t,!1):this.element.find("table.grid-column-header-table td:nth-child("+(t+1)+")").children().first().hide(),this._setRowFirstAndLastVisibleColumnClasses()):n=!1;break;case"column-headers":this.element.addClass("hide-column-headers");n=!1;break;case"header":this.element.removeClass("with-header").addClass("without-header");n=!1;break;case"toolbar":this.toolbars.toolbargroup("hide",arguments[1]);this.toolbars.hasClass("none")?this.element.addClass("without-toolbar").removeClass("with-toolbar").removeClass("with-double-toolbar").removeClass("with-triple-toolbar"):this.toolbars.hasClass("single")?this.element.addClass("with-toolbar").removeClass("without-toolbar").removeClass("with-double-toolbar").removeClass("with-triple-toolbar"):this.toolbars.hasClass("double")?this.element.addClass("with-double-toolbar").removeClass("without-toolbar").removeClass("with-toolbar").removeClass("with-triple-toolbar"):this.toolbars.hasClass("triple")&&this.element.addClass("with-triple-toolbar").removeClass("without-toolbar").removeClass("with-toolbar").removeClass("with-double-toolbar");n=!1;break;case"footer":this.footer&&(this.footer.toolbargroup("hide",0),this.footer.hasClass("none")?this.element.addClass("without-footer").removeClass("with-footer"):this.footer.hasClass("single")&&this.element.addClass("with-footer").removeClass("without-footer"));n=!1;break;case"row":this.rows.eq(arguments[1]).hide();n||this._applyZebraStripes()}n&&this._syncWidths(null,!0)},unhide:function(){var n=arguments.length===3?arguments[2]:typeof arguments[1]=="boolean"?arguments[1]:!0;switch(arguments[0]){case"column":case"column-header":var t=typeof arguments[1]=="string"?this._getColumnIndex(arguments[1]):arguments[1];t>-1?(arguments[0]==="column"?this._toggleColumn(t,!0):this.element.find("table.grid-column-header-table td:nth-child("+(t+1)+")").children().first().show(),this._setRowFirstAndLastVisibleColumnClasses()):n=!1;break;case"column-headers":this.element.removeClass("hide-column-headers");n=!1;break;case"header":this.element.removeClass("without-header").addClass("with-header");n=!1;break;case"toolbar":this.toolbars.toolbargroup("unhide",arguments[1]);this.toolbars.hasClass("none")?this.element.addClass("without-toolbar").removeClass("with-toolbar").removeClass("with-double-toolbar").removeClass("with-triple-toolbar"):this.toolbars.hasClass("single")?this.element.addClass("with-toolbar").removeClass("without-toolbar").removeClass("with-double-toolbar").removeClass("with-triple-toolbar"):this.toolbars.hasClass("double")?this.element.addClass("with-double-toolbar").removeClass("without-toolbar").removeClass("with-toolbar").removeClass("with-triple-toolbar"):this.toolbars.hasClass("triple")&&this.element.addClass("with-triple-toolbar").removeClass("without-toolbar").removeClass("with-toolbar").removeClass("with-double-toolbar");n=!1;break;case"footer":checkExists(this.footer)||this._buildFooter();this.footer.toolbargroup("unhide",0);this.footer.hasClass("none")?this.element.addClass("without-footer").removeClass("with-footer"):this.footer.hasClass("single")&&this.element.addClass("with-footer").removeClass("without-footer");n=!1;break;case"row":this.rows.eq(arguments[1]).show();n||this._applyZebraStripes()}n&&this._syncWidths(null,!0)},_setOption:function(t,q){switch(t){case"page":this.page=parseInt(q);checkExists(this.footer)&&(this.footer.find(".input-control.text-input input[type=text]").val(this.page.toString()),this._updatePagingControls());break;case"hasrowcount":this.hasrowcount=q;this.hasrowcount?checkExists(this.footer)&&(this.footer.find(".grid-paging-control-text.total")[0].style.display="inline",this.footer.find(".toolbar-button.paging-last")[0].style.display="inline"):(this.totalpages=-1,checkExists(this.footer)&&(this.footer.find(".grid-paging-control-text.total")[0].style.display="none",this.footer.find(".toolbar-button.paging-last")[0].style.display="none"));break;case"hasmorepages":this.hasmorepages=q;checkExists(this.footer)&&this._updatePagingControls();break;case"totalpages":this.totalpages=parseInt(q);checkExists(this.footer)&&(this.totalpages!==-1&&this.footer.find(".grid-paging-control-text.total").text(Resources.CommonLabels.PagingTotalPagesText.replace("{0}",this.totalpages.toString())),this._updatePagingControls());break;case"paging":q===!1?this.hide("footer"):this.options.paging===!1&&q===!0&&(this.unhide("footer"),this._buildPagingControls());break;case"sorting":q===!1?this.columnsheadertable.addClass("not-sortable"):this.columnsheadertable.removeClass("not-sortable");break;case"columns":if(checkExists(q))for(var u=0;u<q.length;u++){var f=q[u],r=this._getColumnIndex(f.name);if(r!==-1){var e=f.hidden===!0,s=this.columns[r].hidden===!0;s!==e&&(e?this.hide("column",r):this.unhide("column",r))}}break;case"sortState":if(checkExists(q)){var r=this._getColumnIndex(q.columnName);if(r!==-1){this.clearsort();this.sortState=q;this.sortColumn=r;this.reverseSort=[];var h=q.direction==="desc";this.reverseSort[r]=h;var o=this.columnsheadertable.children("tbody").children("tr").children("td");o.children(".grid-column-header-cell").removeClass("asc").removeClass("desc");o.eq(r).children(".grid-column-header-cell").addClass(q.direction)}}break;case"canexpand":this.canexpand=q}n.Widget.prototype._setOption.apply(this,arguments)},_changePage:function(){var n=this,f=this.footer.toolbargroup("fetch","toolbars").eq(0),r=f.find(".input-control.text-input input[type=text]"),u=n.options.page||1,q=n.options.totalpages,t=r.val();!isNaN(t)&&n.page!==t&&t>0&&(!checkExists(q)||q===-1||t<=q)?n.gotopage(t,u,n.element):r.val(u.toString())},_updatePagingControls:function(){if(checkExists(this.footer)){var n=this.footer.toolbargroup("fetch","toolbars").eq(0),q=n.find(".toolbar-button.paging-first"),r=n.find(".toolbar-button.paging-left"),u=n.find(".toolbar-button.paging-right"),t=n.find(".toolbar-button.paging-last"),f=n.find(".input-control.text-input input[type=text]"),e=n.find(".grid-paging-control-text.total");f.val(this.page.toString());!1&&e.text(Resources.CommonLabels.PagingTotalPagesText.replace("{0}",this.totalpages.toString()));this.page===1?(q.addClass("disabled"),r.addClass("disabled"),q.addClass("hide-browser-highlight"),q[0].setAttribute("tabIndex","-1"),r[0].setAttribute("tabIndex","-1")):(q.removeClass("disabled"),r.removeClass("disabled"),q[0].setAttribute("tabIndex",this.tabIndex),r[0].setAttribute("tabIndex",this.tabIndex));this.page===1&&(this.hasmorepages===!1||this.page===this.totalpages)?f[0].setAttribute("disabled","disabled"):f[0].removeAttribute("disabled");this.totalpages===1||this.hasmorepages===!1||this.page===this.totalpages?(u.addClass("disabled"),t.addClass("disabled"),u[0].setAttribute("tabIndex","-1"),t[0].setAttribute("tabIndex","-1")):(u.removeClass("disabled"),u[0].setAttribute("tabIndex",this.tabIndex),this.hasmorepages===!0&&this.totalpages>0?(t.removeClass("disabled"),t[0].setAttribute("tabIndex",this.tabIndex)):(t.addClass("disabled"),t[0].setAttribute("tabIndex","-1")))}},gotopage:function(n){checkExists(this.options.custompaging)&&typeof this.options.custompaging=="function"&&this.options.custompaging(n,this.page,this.element)},_updateAggregation:function(n,t,q){if(q>0)switch(n){case"count":this.aggregationContentTableBody.children(".aggregation-count").children().eq(q).text(t);break;case"avg":this.aggregationContentTableBody.children(".aggregation-average").children().eq(q).text(t);break;case"sum":this.aggregationContentTableBody.children(".aggregation-summary").children().eq(q).text(t);break;case"min":this.aggregationContentTableBody.children(".aggregation-minimum").children().eq(q).text(t);break;case"max":this.aggregationContentTableBody.children(".aggregation-maximum").children().eq(q).text(t)}},_updateRow:function(){for(var h=this.contenttabletbody.children("tr:not(.empty-grid):not(.action-row):not(.edit-template-row, .display-template-row)"),r=h.eq(arguments[2]),q="",t=0,c=this.columns.length;t<c;t++){var n={};n.isLiteral=this.options.isLiteral;checkExists(arguments[0][t])&&(typeof arguments[0][t]=="string"&&(n.value=arguments[0][t]),checkExists(arguments[0][t].icon)&&(n.icon=arguments[0][t].icon),checkExists(arguments[0][t].value)&&(n.value=arguments[0][t].value),checkExists(arguments[0][t].display)&&(n.display=arguments[0][t].display),checkExists(arguments[0][t].control)&&(n.control=arguments[0][t].control),checkExists(arguments[0][t].html)&&(n.html=arguments[0][t].html),checkExists(arguments[0][t].cellclass)&&(n.cellclass=arguments[0][t].cellclass),checkExists(arguments[0][t].counter)&&(n.counter=arguments[0][t].counter),checkExists(arguments[0][t].align)&&(n.align=arguments[0][t].align),checkExists(arguments[0][t].isLiteral)&&(n.isLiteral=arguments[0][t].isLiteral),checkExists(arguments[0][t].fieldPropertyType)&&(n.fieldPropertyType=arguments[0][t].fieldPropertyType));q+='<td style="';checkExists(n.align)&&n.align!=="none"?q+="text-align:"+n.align.toLowerCase()+";":checkExists(this.columns[t].align)&&this.columns[t].align!=="none"&&(q+="text-align:"+this.columns[t].align+";");q+='"';var u={},f=0;if(checkExists(n.icon)&&(u.icon=n.icon,f++),checkExists(n.value)&&(u.value=n.value,f++),checkExists(n.control)&&(u.control=n.control,f++),checkExists(n.counter)&&(u.counter=n.counter,f++),checkExists(n.fieldPropertyType)&&(u.fieldPropertyType=n.fieldPropertyType,f++),checkExists(this.columns[t].hidden)&&this.columns[t].hidden&&(q+=' class="hidden"'),f>0&&(q+=' data-options="'+jQuery.toJSON(u).htmlEncode()+'"'),q+='><div class="grid-content-cell',checkExists(n.icon)&&n.icon!==""&&(q+=" icon "+n.icon),checkExists(n.cellclass)&&n.cellclass!==""&&(q+=" "+n.cellclass),checkExists(n.align)||checkExists(this.columns[t].datatype)&&this.columns[t].datatype==="number"&&(q+=" numeric"),checkExists(this.columns[t].control)&&this.columns[t].control!==""&&(q+=" checkradio-cell"),checkExists(n.display)&&n.display!=="")if(typeof n.display=="string"){var o=this._getTooltip(n);q+='"><div class="grid-content-cell-wrapper" title="'+o+'">'}else q+='"><div class="grid-content-cell-wrapper" title="'+n.display+'">';else q+='"><div class="grid-content-cell-wrapper">';if(checkExists(n.html)&&n.html!=="")q+=n.html;else if(checkExists(this.columns[t].control)&&(this.columns[t].control==="checkbox"||this.columns[t].control==="radiobutton"))switch(this.columns[t].control){case"checkbox":q+=SCCheckbox.html({checked:this.columns[t].datatype==="boolean"&&n.value});break;case"radiobutton":q+=SCRadiobutton.html({})}else{var e=checkExists(n.display)?n.display:n.value;if(n.isLiteral||typeof e!="string")q+=e;else{var o=this._escapeMetadataString(e);q+=o}}q+="<\/div><\/div><\/td>"}r.html(q);r.find("input.input-control[type=checkbox]").checkbox();r.find("input.input-control[type=radio]").radiobutton();r.find(".input-control.text-input").textbox();r.find("select.input-control").dropdown();r.find(".fileImage, .hyperlink, .image").on("keydown",this._onListviewItemKeyDown).on("click",this._onListviewItemClick).on("focus",this._onListviewItemFocus).on("blur",this._onListviewItemBlur);var s=arguments[1];(s===undefined||s===!0)&&this._syncWidths(!1)},_getTooltip:function(n){return n.isLiteral===!0?n.display.stripHtml():this._escapeMetadataString(n.display)},_onListviewItemFocus:function(){n(this).addClass("focus")},_onListviewItemBlur:function(){n(this).removeClass("focus")},edit:function(n){var t=this.fetch("edit-template-row");if(t.hasClass("edit-template-row")||t.addClass("edit-template-row"),t.length>0){this.rows=this.contenttabletbody.children("tr:not(.empty-grid):not(.action-row)");for(var q=isNaN(parseInt(n))?null:this.rows.eq(n),f=t.children("td"),r=0,e=this.columns.length;r<e;r++)this.columns[r].hidden&&f.eq(r).addClass(" hidden");if(checkExists(q)&&q.length>0?(q.addClass("edit-row"),q.after(t),this.hide("row",n)):this.contenttabletbody.children("tr.empty-grid").length>0?this.contenttabletbody.empty().append(t):this.contenttabletbody.children("tr.action-row").length>0?t.insertBefore(this.contenttabletbody.children("tr.action-row")):this.contenttabletbody.append(t),checkExists(SourceCode.Forms.Controls.Textbox)&&t.find(".input-control.text-input").textbox(),checkExists(SourceCode.Forms.Controls.Checkbox)&&t.find("input[type=checkbox]").checkbox(),checkExists(SourceCode.Forms.Controls.Radiobutton)&&t.find("input[type=radio]").radiobutton(),checkExists(SourceCode.Forms.Controls.DropDown)&&t.find("select").each(function(n,t){var q=jQuery(t);q.is(".list-display")||q.dropdown()}),this._syncWidths(),this.contenttabletbody.children("tr.empty-grid").length>0&&(this.contenttabletbody.children("tr.empty-grid").remove(),this.element.removeClass("empty")),this.isRuntime)if(this.sortedItemsArray===null||this.sortedItemsArray.length>0)if(this.sortedItemsArray===null&&(this.sortedItemsArray=[]),this.sortedItemsArray.length!==t.find("td:not(.hidden) [tabindex][tabindex!='-1'][disabled!='disabled']:not(.disabled)").length&&(this.editEventsAttached=!1,t.off("keydown.tabbing"),this._applyEditTabbingBehaviour(t)),this.sortedItemsArray.length>0)try{this.sortedItemsArray[0].focus()}catch(o){}else this.sortedItemsArray=null;else{var u=t.find("a, input, textarea").filter(":not(.disabled), :visible");if(u.length>0)try{u[0].focus()}catch(o){}}this._trigger("rowedit",null,{row:n,template:t});SourceCode.Forms.Layout.checkAndFixView(this.element);this._highlight(t)}},commit:function(){var n=this.contenttabletbody.children("tr.edit-template-row"),t;n.prev().hasClass("edit-row")&&(t=n.prev().css("display","").removeClass("edit-row"));this.element.children(".grid-edit-templates").eq(0).find("table tbody").append(n);this.contenttabletbody.children("tr").length!==0||this.actionrow||this.contenttabletbody.html('<tr class="empty-grid"><td class="empty-grid"'+(this.columns.length>0?' colspan="'+this.columns.length+'"':"")+'><div class="grid-content-cell"><div class="grid-content-cell-wrapper">'+this.resources.emptygrid+"<\/div><\/div><\/td><\/tr>");this._syncWidths();this._trigger("rowcommit",null,{row:t,template:n})},update:function(){var q=arguments[0];switch(q){case"row":this._updateRow(arguments[1],arguments[2],arguments[3]);break;case"aggregation":this._updateAggregation(arguments[1],arguments[2],arguments[3]);break;case"column":if(arguments.length===3){var t=typeof arguments[1]=="string"?this._getColumnIndex(arguments[1]):arguments[1];if(t>-1){this.columns[t]=n.extend({},this.columns[t],arguments[2]);var r=this.contenttable.children("colgroup").replaceWith(this._generateColGroupHTML({columns:this.columns}));this._syncWidths()}}}},saveState:function(){for(var r={},u=this.getStateSupportedProperties(),n=0;n<u.length;n++){var t=u[n],q=this[t];t==="columns"&&(q=this.fetch("columns"));typeof q!="undefined"&&(r[t]=q)}return r},loadState:function(n){for(var q=this.getStateSupportedProperties(),t=0;t<q.length;t++){var r=q[t],u=n[r];typeof u!="undefined"&&this._setOption(r,u)}},getStateSupportedProperties:function(){return["page","hasrowcount","hasmorepages","totalpages","sorting","columns","sortState","canexpand"]}};(typeof SCGrid=="undefined"||SCGrid===null)&&(SCGrid=SourceCode.Forms.Controls.Grid);n.widget("ui.grid",SourceCode.Forms.Controls.Grid);SCGridDefaults={getter:"fetch",options:{dragcolumns:!1,multiline:!0,multiselect:!1,cellcontentselect:!1,singleEventOnMultiSelect:!1,disablemodulus:!1,paging:!1,method:"POST",datatype:"xml",autopopulate:!0,actionrow:!1,sorting:!0,zebraStripes:!0,resources:{},disableInternalWidthSync:!1,isLiteral:!0,useTouchEvents:null}};n.extend(n.ui.grid.prototype,SCGridDefaults)})(jQuery);
/*!
 ~/Script/jquery.Forms.controls.toolbar.js
*/
(function(n){(typeof SourceCode=="undefined"||SourceCode===null)&&(SourceCode={});(typeof SourceCode.Forms=="undefined"||SourceCode.Forms===null)&&(SourceCode.Forms={});(typeof SourceCode.Forms.Controls=="undefined"||SourceCode.Forms.Controls===null)&&(SourceCode.Forms.Controls={});SourceCode.Forms.Controls.ToolbarGroup={_create:function(){var q=this.options;this.element.hasClass("toolbars")||this.element.addClass("toolbars");this.toolbars=null;switch(this.element.children(".toolbar:not(.hidden)").length){case 1:this.element.addClass("single").removeClass("double").removeClass("triple");break;case 2:this.element.addClass("double").removeClass("single").removeClass("triple");break;case 3:this.element.addClass("triple").removeClass("double").removeClass("single")}if(this.element.children(".toolbar").length>0&&(this.toolbars=this.element.children(".toolbar").toolbar()),SourceCode.Forms.Browser.msie)for(var n=this.element.find(".toolbar-button"),t=n.length;t--;)n[t].setAttribute("onclick","return false")},html:function(n){(typeof n=="undefined"||n===null)&&(n={toolbars:0});var t='<div class="toolbars';switch(n.toolbars){case 1:t+=" single";break;case 2:t+=" double";break;case 3:t+=" triple"}t+='"';typeof n.id!="undefined"&&n.id!==""&&(t+=' id="'+n.id+'"');t+=">";for(var q=0;q<n.toolbars;q++){var r={};checkExists(n.toolbarOptions)&&checkExists(n.toolbarOptions[q])&&(r=n.toolbarOptions[q]);n.toolbars>2&&q+1===n.toolbars&&(r.alignment="bottom");t+=SourceCode.Forms.Controls.Toolbar.html(r)}return t+"<\/div>"},fetch:function(){if(arguments[0]==="toolbars"){var n=this.element.children(".toolbar");return this.toolbars=n.length>0?n.toolbar():null}},addtoolbar:function(t){(this.fetch("toolbars")===null||this.fetch("toolbars")!==null&&this.fetch("toolbars").length<3)&&(n(SourceCode.Forms.Controls.Toolbar.html(t)).appendTo(this.element).toolbar(),this.toolbars=this.element.children(".toolbar").toolbar());switch(this.fetch("toolbars").filter(":visible").length){case 1:this.element.addClass("single").removeClass("double").removeClass("triple");break;case 2:this.element.addClass("double").removeClass("single").removeClass("triple");break;case 3:this.element.addClass("triple").removeClass("double").removeClass("single")}},hideAllButtons:function(){this.element.find(".toolbar-button").hide()},hide:function(){var t=this.toolbars[arguments[0]];checkExists(t)&&(t.style.display="none",n(t).addClass("hidden"));var q=this.toolbars.filter(function(){return this.style.display!=="none"}).length;switch(q){case 0:this.element.addClass("none").removeClass("single").removeClass("double").removeClass("triple");break;case 1:this.element.addClass("single").removeClass("none").removeClass("double").removeClass("triple");break;case 2:this.element.addClass("double").removeClass("none").removeClass("single").removeClass("triple");break;case 3:this.element.addClass("triple").removeClass("none").removeClass("double").removeClass("single")}},unhide:function(){var t=this.toolbars[arguments[0]];checkExists(t)&&(t.style.display="",n(t).removeClass("hidden"));var q=this.toolbars.filter(function(){return this.style.display!=="none"}).length;switch(q){case 0:this.element.addClass("none").removeClass("single").removeClass("double").removeClass("triple");break;case 1:this.element.addClass("single").removeClass("none").removeClass("double").removeClass("triple");break;case 2:this.element.addClass("double").removeClass("none").removeClass("single").removeClass("triple");break;case 3:this.element.addClass("triple").removeClass("none").removeClass("double").removeClass("single")}}};SourceCode.Forms.Controls.Toolbar={_create:function(){var q=this.options;this.element.hasClass("toolbar")?this.toolbar=this.element:(this.toolbar=n(this.html(q)).appendTo(this.element),this.element=this.toolbar);this.body=this.element.find(".toolbar-wrapper").eq(0);var t=this.body.find("a.toolbar-button");t.k2button();t.on("click",this.checkForDisabledOnClick)},checkForDisabledOnClick:function(t){var q=n(t.target),r=q.closest("a.toolbar-button");r.is(".disabled")&&(t.stopImmediatePropagation(),t.stopPropagation())},html:function(n){(typeof n=="undefined"||n===null)&&(n={});var t="<div";if(typeof n.id!="undefined"&&n.id!==""&&(t+=' id="'+n.id+'"'),t+=' class="toolbar',typeof n.alignment!="undefined"&&n.alignment!=="")switch(n.alignment){case"top":t+=" top-aligned";break;case"bottom":t+=" bottom-aligned"}if(t+='"><div class="toolbar-wrapper">',checkExists(n.buttons))for(var r=n.buttons.length,q=0;q<r;q++)t+=this._buttonHTML(n.buttons[q]);return t+"<\/div><\/div>"},add:function(){switch(arguments[0]){case"button":this._addButton(arguments[1]);break;case"divider":this._addDivider(arguments[1]);break;case"group":this._addGroup(arguments[1])}},_buttonHTML:function(n){var t='<a href="'+(typeof n.href!="undefined"&&n.href!==""?n.href:"javascript:;")+'" class="toolbar-button',q=!0;return typeof n.selected!="undefined"&&n.selected&&(t+=" selected"),typeof n.disabled!="undefined"&&n.disabled&&(t+=" disabled",q=!1),typeof n.icon!="undefined"&&n.icon!==""&&(t+=" "+n.icon),t+='"',typeof n.id!="undefined"&&n.id!==""&&(t+=' id="'+n.id+'"'),checkExists(n.tabIndex)&&(t+=q?' tabindex="'+n.tabIndex+'"':' tabindex="-1"'),SourceCode.Forms.Browser.msie&&(t+=' onclick="return false;"'),(typeof n.text!="undefined"&&n.text!==""||typeof n.description!="undefined"&&n.description!=="")&&(t+=' title="'+(typeof n.description!="undefined"&&n.description!==""?n.description:n.text)+'"'),t+='><span class="button-l"><\/span><span class="button-c">',typeof n.icon!="undefined"&&n.icon!==""&&(t+='<span class="button-icon"><\/span>'),typeof n.text!="undefined"&&n.text!==""&&(t+='<span class="button-text">'+n.text+"<\/span>"),t+'<\/span><span class="button-r"><\/span><\/a>'},_bindButtons:function(){this.body.find("a.toolbar-button").on("click",this.checkForDisabledOnClick)},_addButton:function(n){var t=this._buttonHTML(n);typeof n.group!="undefined"&&n.group!==null?(n.group.children(":last-child").hasClass("toolbar-button")&&this._addDivider({group:n.group}),n.group.append(t)):(this.body.children(":last-child").hasClass("toolbar-button")&&this._addDivider(),this.body.append(t));this._bindButtons()},_addDivider:function(n){typeof n=="undefined"&&(n={});var t='<div class="toolbar-divider"';typeof n.id!="undefined"&&n.id!==""&&(t+=' id="'+n.id+'"');t+="><\/div>";typeof n.group!="undefined"&&n.group!==null?n.group.append(t):this.body.append(t)},_addGroup:function(n){typeof n=="undefined"&&(n={});var t='<div class="toolbar-controls-group"';typeof n.id!="undefined"&&n.id!==""&&(t+=' id="'+n.id+'"');t+=">";typeof n.label!="undefined"&&n.label!==""&&(t+='<div class="toolbar-controls-group-label">'+n.label+"<\/div>");t+="<\/div>";this.body.append(t)},fetch:function(){switch(arguments[0]){case"buttons":return this.body.find("a.toolbar-button");case"dividers":return this.body.find(".toolbar-divider");case"groups":return this.body.find(".toolbar-controls-group")}},remove:function(){switch(arguments[0]){case"buttons":if(typeof arguments[1]!="undefined")for(var n=0,t=arguments[1].length;n<t;n++)this.body.find("a.toolbar-button").eq(arguments[1][n]).remove();else this.body.find("a.toolbar-button").remove();break;case"dividers":if(typeof arguments[1]!="undefined")for(var n=0,t=arguments[1].length;n<t;n++)this.body.find(".toolbar-divider").eq(arguments[1][n]).remove();else this.body.find(".toolbar-divider").remove();break;case"groups":if(typeof arguments[1]!="undefined")for(var n=0,t=arguments[1].length;n<t;n++)this.body.find(".toolbar-controls-group").eq(arguments[1][n]).remove();else this.body.find(".toolbar-controls-group").remove()}},disable:function(){switch(arguments[0]){case"buttons":if(typeof arguments[1]!="undefined")for(var n=0,t=arguments[1].length;n<t;n++)this.body.find("a.toolbar-button").eq(arguments[1][n]).addClass("disabled");else this.body.find("a.toolbar-button").addClass("disabled");break;case"groups":if(typeof arguments[1]!="undefined")for(var n=0,t=arguments[1].length;n<t;n++)this.body.find(".toolbar-controls-group").eq(arguments[1][n]).children("a.toolbar-button").addClass("disabled");else this.body.find(".toolbar-controls-group").children("a.toolbar-button").addClass("disabled")}},enable:function(){switch(arguments[0]){case"buttons":if(typeof arguments[1]!="undefined")for(var n=0,t=arguments[1].length;n<t;n++)this.body.find("a.toolbar-button").eq(arguments[1][n]).removeClass("disabled");else this.body.find("a.toolbar-button").removeClass("disabled");break;case"groups":if(typeof arguments[1]!="undefined")for(var n=0,t=arguments[1].length;n<t;n++)this.body.find(".toolbar-controls-group").eq(arguments[1][n]).children("a.toolbar-button").removeClass("disabled");else this.body.find(".toolbar-controls-group").children("a.toolbar-button").removeClass("disabled")}}};typeof SCToolbarGroup=="undefined"&&(SCToolbarGroup=SourceCode.Forms.Controls.ToolbarGroup);typeof SCToolbar=="undefined"&&(SCToolbar=SourceCode.Forms.Controls.Toolbar);n.widget("ui.toolbargroup",SourceCode.Forms.Controls.ToolbarGroup);n.widget("ui.toolbar",SourceCode.Forms.Controls.Toolbar);n.extend(n.ui.toolbargroup.prototype,{getter:"fetch"});n.extend(n.ui.toolbar.prototype,{getter:"fetch"})})(jQuery);
/*!
 ~/Script/jquery.Forms.controls.tree.js
*/
(function(n){(typeof SourceCode=="undefined"||SourceCode===null)&&(SourceCode={});(typeof SourceCode.Forms=="undefined"||SourceCode.Forms===null)&&(SourceCode.Forms={});(typeof SourceCode.Forms.Controls=="undefined"||SourceCode.Forms.Controls===null)&&(SourceCode.Forms.Controls={});SourceCode.Forms.Controls.Tree={regex:{quote:/\"/g},treedragoptions:{cursorAt:{left:-5,top:-5},helper:"clone",appendTo:"body",distance:20},applyDragHandlers:function(n){this._applyDragHandlers(n)},_applyDragHandlers:function(t){if(this.options.draggable!==!1&&typeof this.options.draggable=="string"){checkExists(t)||(t=this.element);this.options.refreshDraggingPositions===!0&&(this.treedragoptions.start=function(t){n(document).on("mousewheel.treescroll MozMousePixelScroll.treescroll",function(){n(t.target)[this.draggableWidgetName]("option","refreshPositions",!0)})},this.treedragoptions.stop=function(t){n(document).off("mousewheel.treescroll MozMousePixelScroll.treescroll");n(t.target)[this.draggableWidgetName]("option","refreshPositions",!1)});var q=this.treedragoptions;checkExists(this.options.treedragoptions)&&(q=n.extend({},q,this.options.treedragoptions));this.draggableWidgetName="draggable";checkExists(q.draggableWidgetName)&&(this.draggableWidgetName=q.draggableWidgetName);var r=t.find("a")[this.draggableWidgetName](q),u=this.options.draggable;r.on("dragstart",function(){var t=n(this);return t.is(u)?!0:!1})}},_objModel:null,_create:function(){this._initClickHandler();this._applyDragHandlers();this._initKeyboardNavigation();this.rtl=document.documentElement.getAttribute("dir")==="rtl"||!1;this.options.enabled=!0},_destroy:function(){this._removeDragHandlers();this.element.off(".tree");this.element.off(".tree")},_setOption:function(t,q){t==="draggable"?q!==!1&&q!==""?(this.options.draggable!==q&&this._removeDragHandlers(),this.options.draggable=q,this._applyDragHandlers()):(this.options.draggable=!1,this._removeDragHandlers()):t==="enabled"&&(this.options.enabled=q,q!==!1?this._applyDragHandlers():this._removeDragHandlers());n.Widget.prototype._setOption.apply(this,arguments)},_initClickHandler:function(){var t=this;this.element.on("click.tree",function(n){return t._itemSelect(n)}).on("dblclick.tree",function(n){return t._itemChosen(n)}).on("contextmenu.tree",function(q){if(!t.options.enabled)return!1;var r=n(q.target);if(r.is("a"))return t._trigger("contextmenu",q,{node:r.closest("li")}),!1})},_initKeyboardNavigation:function(){var t=this;this.element.on("keyup.tree","a",function(q){if(!t.options.enabled)return!1;var r=n(this).closest("li");switch(q.keyCode){case 13:t._itemSelect(q);t._itemChosen(q);break;case 32:t._itemSelect(q);break;case 37:r.is(".children.open")?t.collapse(r):r.parent().closest("li").children("a")[0].focus();break;case 38:if(r.prev("li").length>0){var f=r.prev("li");if(f.is(".children.open")){while(f.is(".children.open"))f=f.children("ul").children("li:last-child");f.children("a")[0].focus()}else f.children("a")[0].focus()}else r.parent().is(":not(.tree)")&&r.parent().closest("li").children("a")[0].focus();break;case 39:r.is(".children")?r.is(".open")?r.children("ul").children("li:first-child").children("a")[0].focus():t.expand(r):r.next("li").length>0&&r.next("li").children("a")[0].focus();break;case 40:if(r.is(".children.open"))r.children("ul").children("li:first-child").children("a")[0].focus();else if(r.next("li").length>0)r.next("li").children("a")[0].focus();else{for(var u=r.parent().closest("li");u.length===0||u.next("li").length===0;){if(u.parent().is(".tree"))break;u=u.parent().closest("li")}u.length>0&&u.next("li").length>0&&u.next("li").children("a")[0].focus()}}})},_itemSelect:function(t){var q=this;if(!q.options.enabled)return!1;var r=this,u=function(){var o=18,s=parseInt(n(r).data("double"),10);if(s>0)return n(r).data("double",s-1),!1;var u=n(t.target),f=u.offset(),h=u.outerWidth();if(u[0].tagName.toUpperCase()==="LI"){var e={horizontal:{},vertical:{top:f.top,bottom:f.top+o}};e.horizontal=q.rtl?{left:f.left+h-o,right:f.left+h}:{left:f.left,right:f.left+o};t.pageX>=e.horizontal.left&&t.pageX<=e.horizontal.right&&t.pageY>=e.vertical.top&&t.pageY<=e.vertical.bottom&&(u.is(".children")||u.children("ul").children("li").length>0)&&q.toggle(u)}else(u[0].tagName.toUpperCase()==="A"||u[0].parentNode.tagName.toUpperCase()==="A")&&(q.options.multiselect&&(!q.options.multiselect||t.ctrlKey)?q._toggleSelect(u.closest("li")):(q.deselect(u.closest(".tree").find(".selected")),q.select(u.closest("li"))),q._trigger("click",t,{node:u.closest("li")}))};return typeof this.options.dblclick=="function"?setTimeout(u,300):u(),!1},_itemChosen:function(t){var q=this;if(!q.options.enabled)return!1;n(this).data("double",2);t.stopPropagation();var r=n(t.target);if(r.is("a"))return q._trigger("dblclick",t,{node:r.closest("li")}),!1},_removeDragHandlers:function(n){(this.options.draggable===!1||typeof this.options.draggable=="string"&&this.options.draggable==="")&&checkExists(this.draggableWidgetName)&&(checkExists(n)||(n=this.element),n.find(this.options.draggable)[this.draggableWidgetName]("destroy"))},singleSelect:function(){var n=arguments[0];this.deselect(n.closest(".tree").find(".selected"));this.select(n.closest("li"))},select:function(){arguments[0].addClass("selected");this.selectedValue=n(n(arguments[0])[0]);this._trigger("select",null,{node:arguments[0],tree:this.element})},deselect:function(){arguments[0].removeClass("selected");this._trigger("deselect",null,{node:arguments[0],tree:this.element})},_toggleSelect:function(){arguments[0].is(".selected")?this.deselect(arguments[0]):this.select(arguments[0])},_correctObjectInfoData:function(n){if(checkExists(n.data)){for(prop in n.data)n[prop]=n.data[prop];delete n.data}},add:function(t,q,r,u,f){var l=this.element.attr("data-treeiconclass");checkExists(u)||(u=!0);this._correctObjectInfoData(q);var s="";t.children("ul").length===0&&t.append("<ul><\/ul>");checkExists(q.checkout)&&(s=q.checkout==="self"?"checked-out":"checked-out-user");var o=n('<li><a href="javascript:;"><\/a><\/li>');checkExistsNotEmpty(q.nodeId)&&o.attr("id",q.nodeId);o.data("metadata",q);var e=null;if(e=checkExists(r)?r===-1?o.insertBefore(t.children("ul").children("li").eq(0)):o.insertAfter(t.children("ul").children("li").eq(r)):o.appendTo(t.children("ul")),$this=this,n.each(q,function(n,t){switch(n.toLowerCase()){case"id":case"target":checkExistsNotEmpty(t)&&e.attr(n,t);break;case"text":e.children("a").text(t);break;case"icon":e.addClass(t).children("a").addClass(t).addClass(l).addClass("icon");break;case"children":case"selected":t&&e.addClass(n);break;case"location":e.attr("href",t);break;case"open":e.addClass(t?"open":"closed")}}),this.options.renderObjectModel===!1&&f===!0&&(q.tooltip=q.text,checkExists(t)&&!t.hasClass("root"))){var h=n(t[0]).metadata();if(checkExists(h)){var c=h.tooltip;checkExists(c)&&(q.tooltip=c+" - "+q.tooltip)}}return checkExists(q.tooltip)||(q.tooltip=checkExists(q.title)?q.title:q.description),checkExists(q.tooltip)&&checkExists(e[0])&&(e[0].childNodes[0].setAttribute("title",q.tooltip),n(e[0].childNodes[0]).data("draggingNode",{tooltip:q.tooltip})),s!==""&&e.addClass(s).children("a").addClass(s),t.is(".children")||t.addClass("children"),typeof arguments[2]=="boolean"&&arguments[2]&&t.is(":not(.open)")?t.addClass("open").removeClass("closed"):t.is(":not(.closed, .open)")&&t.addClass("closed"),e.is(".children:not(.closed, .open)")&&e.addClass("closed"),u&&this._applyDragHandlers(e),e},remove:function(){var n=arguments[0],t=n.parent().closest("li");this._removeDragHandlers(n);n.remove();t.children("ul").children("li").length===0&&t.removeClass("children").removeClass("open").removeClass("closed")},update:function(){var t=arguments[0],r=arguments[1],f=t.metadata(),q=t[0].className;q.indexOf("{")>-1&&(q=(q.substring(0,q.indexOf("{")-1)+" "+q.substring(q.lastIndexOf("}")+1,q.length)).trim());typeof r.data!="undefined"&&(typeof arguments[2]=="undefined"||typeof arguments[2]!="undefined"&&arguments[2]===!1)&&n.extend(f,r.data);var u={};n.each(f,function(n,t){switch(typeof t){case"boolean":case"number":u[n]=t;break;case"string":u[n]=t}});t[0].className=q;t.attr("data-options",jQuery.toJSON(u));typeof r.description=="undefined"&&t.children("a").removeAttr("title");n.each(r,function(n,q){switch(n.toLowerCase()){case"id":case"target":t.attr(n,q);break;case"text":t.children("a").text(q);break;case"icon":t.children("a")[0].className=q;break;case"children":q?(t.addClass("children"),typeof r.open=="undefined"&&t.removeClass("open").addClass("closed")):(t.removeClass("children").removeClass("open").removeClass("closed"),t.find("ul").remove());break;case"location":t.attr("href",q);break;case"open":t.removeClass(q?"closed":"open").addClass(q?"open":"closed");break;case"title":case"description":n.toUpperCase()!=="TITLE"&&(n.toUpperCase()!=="DESCRIPTION"||checkExists(r.title)&&r.title!=="")||t.children("a").attr("title",q);break;case"selected":q&&!t.hasClass("selected")?t.addClass("selected"):t.removeClass("selected")}})},collapse:function(){arguments[0].removeClass("open").addClass("closed");this._trigger("collapse",null,{node:arguments[0],tree:this.element})},expand:function(t,q){arguments[0].removeClass("closed").addClass("open");var r=t.data("dynamicLoadNodes");if(checkExists(r)&&(this._treeload(r,t,n.extend(t.metadata(),{open:!0})),this._applyDragHandlers(t),t.data("dynamicLoadNodes",null)),typeof arguments[1]!="undefined"?this._trigger("expand",null,{node:arguments[0],tree:this.element,refresh:arguments[1]}):this._trigger("expand",null,{node:arguments[0],tree:this.element}),this.options.autoExpand&&t.hasClass("children")){var f=this,u=t.find("> ul > li"),e=t.find("> ul > li.children");(e.length===0||u.length===1)&&f.expand(u.eq(0),q)}},clear:function(){var n=arguments[0]||this.element.children("li").eq(0);n.children("ul").remove();n.removeClass("children").removeClass("open").removeClass("closed")},toggle:function(){arguments[0].is(".open")?(n("#__designerStatus").text("tree collapse initializing"),this.collapse(arguments[0]),n("#__designerStatus").text("tree collapse initialized")):(n("#__designerStatus").text("tree expand initializing"),this.expand(arguments[0]),n("#__designerStatus").text("tree expand initialized"))},find:function(){var u,t=null;switch(arguments[0]){case"selected":t=this.element.find(".selected");break;case"id":t=this.element.find("#"+arguments[1]+"]");break;case"text":t=n([]);var o=arguments[2];this.element.find("a").each(function(){n(this).text()===o&&t.pushStack(this)});break;case"metadata":if(typeof arguments[2]=="string"){var e=arguments[2],s=arguments[3];t=this.element.find("li").filter(function(){return n(this).metadata()[e]!==undefined&&n(this).metadata()[e]===s})}else{var q=arguments[2];q instanceof Array||(q=[q]);var r=[];r.length=q.length;this.element.find("li").each(function(){for(var t=0;t<q.length;t++){var f=q[t],e=!0;for(var u in f)if(f.hasOwnProperty(u)&&checkExists(f[u]))if(n(this).metadata()[u]===undefined)e=!1;else{for(var c=f[u].toLowerCase(),s=n(this).metadata()[u].toLowerCase().split(","),h=!1,o=0;o<s.length;o++)s[o]===c&&(h=!0);h||(e=!1)}if(e&&(r[t]=jQuery(this),t===0))return!1}});for(var f=0;f<r.length;f++)if(r[f]){t=r[f];break}}break;case"root":t=this.element.children("li")}switch(arguments[1]){case"objects":u=[];t.each(function(){var t={},q=n(this);t.text=q.children("a").text();t.id=q.attr("id");t.children=q.is(".children");t.open=q.is(".open");t.target=q.attr("target");t.location=q.attr("href")!=="javascript:;"?q.attr("href"):"";t.icon=q.children("a")[0].className;u.push(t)});break;default:u=t}return u},partialLoadXmlIntoModel:function(n){var t=n.nodes,q=n.modelObj||{};this._treeload(t,null,q)},findModelObject:function(n){var t=null;if(Array.isArray(n))for(var r=n.length,q=0;checkExists(t)!==!0&&q<r;)t=findObjectInArrayMatchingAll({queryObject:n[q],targetObject:this._objModel,targetPropertiesContainMultipleValues:!0}),q++;else t=findObjectInArrayMatchingAll({queryObject:n,targetObject:this._objModel,targetPropertiesContainMultipleValues:!0});return typeof t=="undefined"?null:t},sort:function(t,q){var r=t.children("ul"),u=r.children("li").get();u.sort(function(t,r){var e=n(t).metadata(),o=n(r).metadata();if(q!=="category"){if(e.datatype!=="all"&&o.datatype!=="all"&&e.datatype===o.datatype){var u=n(t).text().toUpperCase(),f=n(r).text().toUpperCase();return u<f?-1:u>f?1:0}return 0}if(q==="category"){if(e.datatype==="all"&&o.datatype==="all"){var u=n(t).text().toUpperCase(),f=n(r).text().toUpperCase();return u<f?-1:u>f?1:0}return 0}});n.each(u,function(n,t){r.append(t)})},loadXML:function(t,q,r,u){checkExists(r)||(r=!0);t.ownerDocument&&(t=t.ownerDocument);var f=n("nodes > node",t);checkExists(q)||(q=this.element.children("li:first-child").addClass("loading"));checkExists(u)||(u=q.metadata(),checkExists(u)||(u={}),jQuery.isEmptyObject(u)&&(u.root=!0));var e=this._treeload(f,q,u);checkExists(this._objModel)||(this._objModel=e);r&&this._applyDragHandlers(q)},_addMetadataProperties:function(n,t,q){for(var e=n.attributes,f=0;f<e.length;f++){var u=e[f].nodeName,r=e[f].nodeValue;r.toString().toLowerCase()==="true"&&(r=!0);r.toString().toLowerCase()==="false"&&(r=!1);switch(u.toLowerCase()){case"text":case"open":t[u]=r;break;case"children":case"haschildren":t.children=r;break;case"description":t.description=r;break;case"icon":t[u]=r;break;case"title":t[u]=r.replaceAll("\\n","\n");break;default:t[u]=r}t.nodeId=(new String).generateGuid();this.options.renderObjectModel===!0&&this.options.buildTooltip?(t.tooltip=t.text,checkExists(q)&&(t.tooltip=q+" - "+t.tooltip)):checkExists(t.tooltip)||(t.tooltip=checkExists(t.title)?t.title:t.description)}},_treeload:function(t,q,r){var f=this;if(this.options.renderObjectModel!==!0||checkExists(r)||(r={}),this.options.renderObjectModel!==!0||checkExists(r.childItems)||(r.childItems=[]),t.length>0){this.options.renderObjectModel&&r.open!==!0&&r.root!==!0&&checkExists(q)&&(q.data("dynamicLoadNodes",t),q.addClass("children closed"));for(var e=0;e<t.length;e++){var o=t[e],u={};this._addMetadataProperties(o,u,r.tooltip);var s=null;checkExists(q)&&(!this.options.renderObjectModel||r.root===!0||r.open===!0)&&(s=f.add(q,u,undefined,!1,f.options.buildTooltip));this.options.renderObjectModel===!0&&(r.childItems[r.childItems.length]=u,r.dynamic===!0&&r.open===!0&&(r.dynamicloaded=!0));var h=n(o).children("node");h.length>0&&f._treeload(h,s,u)}}else checkExists(q)&&q.is(".children.open")&&window.setTimeout(function(){this.collapse(q)}.bind(this),2e3);return checkExists(q)&&q.removeClass("loading"),r},selectedValue:null,getValueData:function(){var n=null;return checkExists(this.selectedValue)&&(n=this.selectedValue.metadata()),n}};typeof SCTree=="undefined"&&(SCTree=SourceCode.Forms.Controls.Tree);n.widget("ui.tree",SourceCode.Forms.Controls.Tree);n.extend(n.ui.tree.prototype,{getter:"add find sort loadXML expand getValueData",options:{multiselect:!1,draggable:!1,renderObjectModel:!1}})})(jQuery);
/*!
 ~/Script/jquery.Forms.controls.spinner.js
*/
(function(n){(typeof SourceCode=="undefined"||SourceCode===null)&&(SourceCode={});(typeof SourceCode.Forms=="undefined"||SourceCode.Forms===null)&&(SourceCode.Forms={});(typeof SourceCode.Forms.Controls=="undefined"||SourceCode.Forms.Controls===null)&&(SourceCode.Forms.Controls={});SourceCode.Forms.Controls.Spinner={options:{inputs:[{range:{min:null,max:null,step:1},values:[],displays:{},specials:{},defaultValue:"",validationHandling:"none",errorMessage:null,selectOnFocus:!1}],increment:100},_create:function(){var n=this;this.lastFocusedIndex=0;this.spinnerDiv=this.element;this.spinnerInputs=this.element.find(".spinner-text-input");this.spinnerUpButton=this.element.find(".spinner-up-button");this.spinnerDownButton=this.element.find(".spinner-down-button");this.spinnerDiv.on("focus",".spinner-text-input:not(.disabled)",n._onFocus.bind(n));this.spinnerDiv.on("blur",".spinner-text-input:not(.disabled)",n._onBlur.bind(n));this.spinnerDiv.on("click",".spinner-text-input:not(.disabled)",n._onClick.bind(n));this.spinnerDiv.on("keydown",".spinner-text-input:not(.disabled)",n._onKeyDown.bind(n));this.spinnerDiv.on("keypress",".spinner-text-input:not(.disabled)",n._onKeyPress.bind(n));this.spinnerDiv.on("keyup",".spinner-text-input:not(.disabled)",n._onKeyUp.bind(n));this.spinnerDiv.on("mousedown",".spinner-up-button:not(.disabled)",n._startIncrease.bind(n));this.spinnerDiv.on("mouseup",".spinner-up-button:not(.disabled)",n._stopIncrease.bind(n));this.spinnerDiv.on("mousemove",".spinner-up-button:not(.disabled)",n._stopIncrease.bind(n));this.spinnerDiv.on("mousedown",".spinner-down-button:not(.disabled)",n._startDecrease.bind(n));this.spinnerDiv.on("mouseup",".spinner-down-button:not(.disabled)",n._stopDecrease.bind(n));this.spinnerDiv.on("mousemove",".spinner-down-button:not(.disabled)",n._stopDecrease.bind(n));this.currentValue=[];for(var t=0;t<this.options.inputs.length;t++)this._setSingleValue(t,this.options.inputs[t].defaultValue)},_decrease:function(){var t=this.lastFocusedIndex,y=n(this.spinnerInputs[t]);this.spinnerInputs.removeClass("active");y.addClass("active");var c=this._getSingleValue(t),r=c.display,p=this._validateSingleValue(t,r);r=checkExistsNotEmpty(p)?c.value:this._getValueFromDisplayValue(t,r);var q=null;if(this._valueInRange(t,r,!1)){var s=parseFloat(r),l=(s-this.options.inputs[t].range.min)%this.options.inputs[t].range.step;if(q=l!==0?s-l:s-this.options.inputs[t].range.step,q<this.options.inputs[t].range.min)if(this._hasSpecials(t)){var u=[];for(var f in this.options.inputs[t].specials)u.push(f);q=u[u.length-1]}else{var e=(this.options.inputs[t].range.max-this.options.inputs[t].range.min)%this.options.inputs[t].range.step;q=e!==0?this.options.inputs[t].range.max-e:this.options.inputs[t].range.max}}else if(this._valueInValues(t,r,!1)){var h=this.options.inputs[t].values.indexOf(r),a=this.options.inputs[t].values.length-1;if(h>0)q=this.options.inputs[t].values[h-1];else if(h===0)if(this._hasSpecials(t)){var u=[];for(var f in this.options.inputs[t].specials)u.push(f);q=u[u.length-1]}else q=this.options.inputs[t].values[a]}else if(this._valueInSpecials(t,r,!1)){var u=[],o=0,v=0;for(var f in this.options.inputs[t].specials)u.push(f),r===f&&(o=v),v++;var w=u.length-1;if(o>0)q=u[o-1];else if(o===0)if(this._hasRange(t)){var e=(this.options.inputs[t].range.max-this.options.inputs[t].range.min)%this.options.inputs[t].range.step;q=e!==0?this.options.inputs[t].range.max-e:this.options.inputs[t].range.max}else if(this._hasValues(t)){var a=this.options.inputs[t].values.length-1;q=this.options.inputs[t].values[a]}}this._setSingleValue(t,q);this.options.inputs[t].selectOnFocus&&this.spinnerInputs[t].select()},_focusInputLeft:function(t){var q=parseInt(t)-1;if(q>=0){var r=this.spinnerInputs[q],u=n(r);u.trigger("focus");this.options.inputs[q].selectOnFocus?r.select():u.caret("end")}},_focusInputRight:function(t){var q=parseInt(t)+1;if(q<this.spinnerInputs.length){var r=this.spinnerInputs[q],u=n(r);u.trigger("focus");this.options.inputs[q].selectOnFocus?r.select():u.caret("start")}},_focusInputRightWithVal:function(t,q){var u=parseInt(t)+1;if(u<this.spinnerInputs.length){var f=this.spinnerInputs[u],r=n(f);r.trigger("focus");var e=q;r.val(e);r.caret("end")}},_getDisplayValueFromValue:function(n,t){if(checkExists(t))t=t.toString();else return null;var q=t;if(checkExists(this.options.inputs[n].values))for(var r=0;r<this.options.inputs[n].values.length;r++)if(this.options.inputs[n].values[r].toLowerCase()===t.toLowerCase()){q=this.options.inputs[n].values[r].toString();break}return checkExists(this.options.inputs[n].specials)&&(checkExists(this.options.inputs[n].specials[t])?q=this.options.inputs[n].specials[t].toString():checkExists(this.options.inputs[n].specials[q])&&(q=this.options.inputs[n].specials[q].toString())),checkExists(this.options.inputs[n].displays)&&(checkExists(this.options.inputs[n].displays[t])?q=this.options.inputs[n].displays[t].toString():checkExists(this.options.inputs[n].displays[q])&&(q=this.options.inputs[n].displays[q].toString())),q},_getValueFromDisplayValue:function(n,t){if(checkExists(t))t=t.toString();else return null;t=t.toLowerCase();var q=t;if(checkExists(this.options.inputs[n].values))for(var u=0;u<this.options.inputs[n].values.length;u++)if(this.options.inputs[n].values[u].toLowerCase()===t){q=this.options.inputs[n].values[u].toString();break}if(checkExists(this.options.inputs[n].specials))for(var r in this.options.inputs[n].specials)if(this.options.inputs[n].specials[r].toLowerCase()===t||this.options.inputs[n].specials[r].toLowerCase()===q){q=r.toString();break}if(checkExists(this.options.inputs[n].displays))for(var r in this.options.inputs[n].displays)if(this.options.inputs[n].displays[r].toLowerCase()===t||this.options.inputs[n].displays[r].toLowerCase()===q.toLowerCase()){q=r.toString();break}return q},_getSingleValue:function(t){return{value:this.currentValue[t],display:n(this.spinnerInputs[t]).val()}},_hasDisplays:function(n){if(checkExists(this.options.inputs[n].displays)){var t=0;for(var q in this.options.inputs[n].displays)t++;if(t>0)return!0}return!1},_hasRange:function(n){return checkExists(this.options.inputs[n].range)&&checkExists(this.options.inputs[n].range.min)&&checkExists(this.options.inputs[n].range.max)&&checkExists(this.options.inputs[n].range.step)?!0:!1},_hasSpecials:function(n){if(checkExists(this.options.inputs[n].specials)){var t=0;for(var q in this.options.inputs[n].specials)t++;if(t>0)return!0}return!1},_hasValues:function(n){return checkExists(this.options.inputs[n].values)&&this.options.inputs[n].values.length>0?!0:!1},_increase:function(){var t=this.lastFocusedIndex,y=n(this.spinnerInputs[t]);this.spinnerInputs.removeClass("active");y.addClass("active");var h=this._getSingleValue(t),r=h.display,p=this._validateSingleValue(t,r);r=checkExistsNotEmpty(p)?h.value:this._getValueFromDisplayValue(t,r);var q=null;if(this._valueInRange(t,r,!1)){var e=parseFloat(r),c=(e-this.options.inputs[t].range.min)%this.options.inputs[t].range.step;if(q=c!==0?e-c+this.options.inputs[t].range.step:e+this.options.inputs[t].range.step,q>this.options.inputs[t].range.max)if(this._hasSpecials(t))for(var u in this.options.inputs[t].specials){q=u;break}else q=this.options.inputs[t].range.min}else if(this._valueInValues(t,r,!1)){var o=this.options.inputs[t].values.indexOf(r),l=this.options.inputs[t].values.length-1;if(o<l)q=this.options.inputs[t].values[o+1];else if(o===l)if(this._hasSpecials(t))for(var u in this.options.inputs[t].specials){q=u;break}else q=this.options.inputs[t].values[0]}else if(this._valueInSpecials(t,r,!1)){var s=[],f=0,a=0;for(var u in this.options.inputs[t].specials)s.push(u),r===u&&(f=a),a++;var v=s.length-1;f<v?q=s[f+1]:f===v&&(this._hasRange(t)?q=this.options.inputs[t].range.min:this._hasValues(t)&&(q=this.options.inputs[t].values[0]))}this._setSingleValue(t,q);this.options.inputs[t].selectOnFocus&&this.spinnerInputs[t].select()},_isTextSelected:function(n){var t=n.caret(),q=n.val();return t.end-t.start===q.length},_onBlur:function(n){var u=n.target.getAttribute("inputindex"),t=parseInt(u);if(checkExists(t)){var r=this._getSingleValue(t),q=this._validateSingleValue(t,r.display);checkExistsNotEmpty(q)?(checkExistsNotEmpty(this.options.inputs[t].validationHandling)&&(this.options.inputs[t].validationHandling==="internal"?checkExistsNotEmpty(this.options.inputs[t].errorMessage)?popupManager.showError(this.options.inputs[t].errorMessage):q==="range"?popupManager.showError(Resources.MessageBox.SpinnerValueNotInRange.format(this.options.inputs[t].range.min,this.options.inputs[t].range.max)):q==="rangespecials"?popupManager.showError(Resources.MessageBox.SpinnerValueNotInRangeOrSpecials.format(this.options.inputs[t].range.min,this.options.inputs[t].range.max,this._specialsErrorString(t))):q==="values"?popupManager.showError(Resources.MessageBox.SpinnerValueNotInValues.format(this._valuesErrorString(t))):q==="valuesspecials"&&popupManager.showError(Resources.MessageBox.SpinnerValueNotInValuesOrSpecials.format(this._valuesErrorString(t),this._specialssErrorString(t))):this.options.inputs[t].validationHandling==="external"&&this._trigger("spinnervalidationfailed",null,{})),this._setSingleValue(t,r.value)):this._setSingleValue(t,r.display)}this.spinnerDiv.removeClass("active")},_onClick:function(n){this.spinnerDiv.addClass("active");var t=n.target.getAttribute("inputindex");checkExists(t)&&(this.options.inputs[t].selectOnFocus&&n.target.select(),this.lastFocusedIndex=parseInt(t,10))},_onFocus:function(n){this.spinnerDiv.addClass("active");this.spinnerInputs.removeClass("active");jQuery(n.target).addClass("active");var t=n.target.getAttribute("inputindex");checkExists(t)&&(this.lastFocusedIndex=parseInt(t))},_onKeyDown:function(t){var q=t.target.getAttribute("inputindex");switch(t.which){case 37:return this._focusInputLeft(q),!1;case 38:return this._increase(),!1;case 39:return this._focusInputRight(q),!1;case 40:return this._decrease(),!1;case 8:var r=n(t.target);if(r.val().length===1&&q>0||this._isTextSelected(r)){checkExistsNotEmpty(this.options.inputs[q].defaultValue)?this._setSingleValue(q,this.options.inputs[q].defaultValue):this._setSingleValue(q,"");var f=this.spinnerInputs[q-1],u=n(f);return u.trigger("focus"),u.caret("end"),!1}}},_onKeyPress:function(t){var q=t.target.getAttribute("inputindex");if(t.which===58)return this._focusInputRight(q),!1;if(t.charCode!==0){var e=n(t.target).caret(),r=this._getSingleValue(q).display,u=e.start,o=e.end,f=String.fromCharCode(t.charCode),s=t.target.getAttribute("maxlength"),h=parseInt(q)+1;if(checkExistsNotEmpty(s)&&u===o&&u.toString()===s){if(checkExists(this.options.inputs[h])&&!this._partialValidateSingleValue(h,f))return this._focusInputRightWithVal(q,f),!1}else{var c="",l=r.substring(0,u),a=r.substring(o,r.length);return c=l+f+a,!this._partialValidateSingleValue(q,c)}}else if(t.which!==0&&t.which!==8||t.keyCode>=37&&t.keyCode<=40)return!1},_onKeyUp:function(n){var t=n.target.getAttribute("inputindex"),q=this._getSingleValue(t);checkExistsNotEmpty(q)||(checkExistsNotEmpty(this.options.inputs[t].defaultValue)?this._setSingleValue(t,this.options.inputs[t].defaultValue):this._setSingleValue(t,""),n.target.select())},_partialValidateSingleValue:function(n,t){var q=!1;return this._hasRange(n)?q=!this._partialValueInRange(n,t,!0):this._hasValues(n)&&(q=!this._partialValueInValues(n,t,!0)),q&&this._hasSpecials(n)&&(q=!this._partialValueInSpecials(n,t,!0)),q&&this._hasDisplays(n)&&(q=!this._partialValueInDisplays(n,t,!0)),q},_partialValueInDisplays:function(n,t,q){if(q||this._hasDisplays(n)){var r=t.length,f=t.toLowerCase();for(var e in this.options.inputs[n].displays){var u=this.options.inputs[n].displays[e],o=u.toLowerCase();if(u.length>=r&&o.substr(0,r)===f)return!0}}return!1},_partialValueInRange:function(n,t,q){return(q||this._hasRange(n))&&!isNaN(t)&&parseFloat(t)<=this.options.inputs[n].range.max?!0:!1},_partialValueInSpecials:function(n,t,q){if(q||this._hasSpecials(n)){var r=t.length,f=t.toLowerCase();for(var u in this.options.inputs[n].specials){var e=this.options.inputs[n].specials[u],o=u.toLowerCase(),s=e.toLowerCase();if(u.length>=r&&o.substr(0,r)===f||e.length>=r&&s.substr(0,r)===f)return!0}}return!1},_partialValueInValues:function(n,t,q){if(q||this._hasValues(n))for(var u=t.length,e=t.toLowerCase(),r=0;r<this.options.inputs[n].values.length;r++){var f=this.options.inputs[n].values[r],o=f.toLowerCase();if(f.length>=u&&o.substr(0,u)===e)return!0}return!1},_setSingleValue:function(t,q){var r=this._getValueFromDisplayValue(t,q),u=this._getDisplayValueFromValue(t,r);if(r!==this._getSingleValue(t).value||u!==this._getSingleValue(t).display){this.currentValue[t]=r;var f=n(this.spinnerInputs[t]);f.val(u);f.trigger("change")}},_specialsErrorString:function(n){var t="",q=0;for(var u in this.options.inputs[n].specials)q++;var r=0;for(var u in this.options.inputs[n].specials)t+=u.toString(),t+=r===q-1?" "+Resources.MessageBox.OrText+" ":", ",t+=this.options.inputs[n].specials[u].toString(),r!==q-1&&(t+=", "),r++;return t},_startDecrease:function(){this.startDecreaseTimer=window.setTimeout(function(){this.decreaseTimer=window.setInterval(this._decrease.bind(this),this.options.increment)}.bind(this),500);this._decrease()},_startIncrease:function(){this.startIncreaseTimer=window.setTimeout(function(){this.increaseTimer=window.setInterval(this._increase.bind(this),this.options.increment)}.bind(this),500);this._increase()},_stopDecrease:function(){checkExists(this.startDecreaseTimer)&&window.clearTimeout(this.startDecreaseTimer);checkExists(this.decreaseTimer)&&window.clearInterval(this.decreaseTimer)},_stopIncrease:function(){checkExists(this.startIncreaseTimer)&&window.clearTimeout(this.startIncreaseTimer);checkExists(this.increaseTimer)&&window.clearInterval(this.increaseTimer)},_validateSingleValue:function(n,t){var u=this._getValueFromDisplayValue(n,t),q="",r=!1;return this._hasRange(n)?(q="range",r=!this._valueInRange(n,u,!0)):this._hasValues(n)&&(q="values",r=!this._valueInValues(n,u,!0)),r&&this._hasSpecials(n)&&(q==="range"?q="rangespecials":q==="values"&&(q="valuesspecials"),r=!this._valueInSpecials(n,u,!0)),r?q:null},validateValue:function(n){for(var q={failedValidation:!1,validationInfo:[]},t=0;t<this.options.inputs.length;t++){var r=this._validateSingleValue(t,n[t]);checkExistsNotEmpty(r)&&(q.failedValidation=!0,q.validationInfo.push({failedIndex:t,failedIn:r}))}return q},_valueInRange:function(n,t,q){return(q||this._hasRange(n))&&!isNaN(t)&&parseFloat(t)>=this.options.inputs[n].range.min&&parseFloat(t)<=this.options.inputs[n].range.max?!0:!1},_valueInSpecials:function(n,t,q){return(q||this._hasSpecials(n))&&checkExists(this.options.inputs[n].specials[t])?!0:!1},_valueInValues:function(n,t,q){if(q||this._hasValues(n))for(var r=0;r<this.options.inputs[n].values.length;r++)if(this.options.inputs[n].values[r].toLowerCase()===t.toLowerCase())return!0;return!1},_valuesErrorString:function(n){for(var q="",t=0;t<this.options.inputs[n].values.length;t++)q+=this.options.inputs[n].values[t].toString(),t===this.options.inputs[n].values.length-2?q+=" "+Resources.MessageBox.OrText+" ":t!==this.options.inputs[n].values.length-1&&(q+=", ");return q},disable:function(){this.spinnerDiv.addClass("disabled");this.spinnerInputs.prop("disabled",!0);this.spinnerInputs.addClass("disabled");this.spinnerUpButton.addClass("disabled");this.spinnerDownButton.addClass("disabled")},editInputsHtml:function(t,q){var f=t.find(".spinner-text-input");if(f.length<q.inputsLength)for(var s=t.find(".spinner-input-wrapper"),u=f.length;u<q.inputsLength;u++){var o=null;checkExists(q.inputsInfo)&&checkExists(q.inputsInfo[u])&&(o=q.inputsInfo[u]);s.append(this.inputHtml(u,o))}else if(f.length>q.inputsLength)for(var u=f.length-1;u>=q.inputsLength;u--)t.find(".spinner-text-input").last().remove(),t.find(".spinner-delimiter").last().remove();for(var r=0;r<q.inputsLength;r++){var e=n(t.find(".spinner-text-input")[r]);r!==0&&(checkExists(q.inputsInfo)&&checkExists(q.inputsInfo[r])&&checkExists(q.inputsInfo[r].delimiterBeforeInput)?n(t.find(".spinner-delimiter")[r-1]).text(q.inputsInfo[r].delimiterBeforeInput):n(t.find(".spinner-delimiter")[r-1]).text(""));checkExists(q.inputsInfo)&&checkExists(q.inputsInfo[r])&&checkExists(q.inputsInfo[r].maxInputLength)?e.attr("maxlength",q.inputsInfo[r].maxInputLength):e.removeAttr("maxlength");checkExists(q.inputsInfo)&&checkExists(q.inputsInfo[r])&&checkExists(q.inputsInfo[r].rightAlign)?e.addClass("right-align"):e.removeClass("right-align")}},enable:function(){this.spinnerDiv.removeClass("disabled");this.spinnerInputs.prop("disabled",!1);this.spinnerInputs.removeClass("disabled");this.spinnerUpButton.removeClass("disabled");this.spinnerDownButton.removeClass("disabled")},html:function(n){var t="<div ";checkExistsNotEmpty(n.id)&&(t+="id='"+n.id+"' ");t+="class='spinner'><div class='spinner-inputs'><div class='spinner-input-wrapper'>";for(var q=0;q<n.inputsLength;q++){var r=null;checkExists(n.inputsInfo)&&checkExists(n.inputsInfo[q])&&(r=n.inputsInfo[q]);t+=this.inputHtml(q,r)}return t+="<\/div><\/div>",t+="<div class='spinner-buttons'><div class='spinner-up-button-wrapper'><button type='button' class='spinner-up-button' tabindex='-1'/><\/div>",t+="<div class='spinner-down-button-wrapper'><button type='button' class='spinner-down-button' tabindex='-1'/><\/div><\/div>",t+"<\/div>"},inputHtml:function(n,t){var q="";if(n!==0){var r="";checkExistsNotEmpty(t)&&checkExistsNotEmpty(t.delimiterBeforeInput)&&(r=t.delimiterBeforeInput);q+="<span class='spinner-delimiter'>"+r+"<\/span>"}return q+="<input class='spinner-text-input",checkExistsNotEmpty(t)&&checkExistsNotEmpty(t.rightAlign)&&t.rightAlign&&(q+=" right-align"),q+="' inputindex='"+n.toString(),checkExistsNotEmpty(t)&&checkExistsNotEmpty(t.maxInputLength)&&(q+="' maxlength='"+t.maxInputLength),q+"' type='text'>"},reset:function(){var t=this;this.lastFocusedIndex=0;this.spinnerDiv=this.element;this.spinnerInputs=this.element.find(".spinner-text-input");this.spinnerUpButton=this.element.find(".spinner-up-button");this.spinnerDownButton=this.element.find(".spinner-down-button");this.currentValue=[];for(var n=0;n<this.options.inputs.length;n++)this._setSingleValue(n,this.options.inputs[n].defaultValue)},value:function(n){if(checkExists(n)){if(!this.validateValue(n).failedValidation)for(var t=0;t<this.options.inputs.length;t++)this._setSingleValue(t,n[t])}else{for(var q=[],t=0;t<this.options.inputs.length;t++)q.push(this._getSingleValue(t).value);return q}}};typeof SCSpinner=="undefined"&&(SCSpinner=SourceCode.Forms.Controls.Spinner);n.widget("ui.spinner",SourceCode.Forms.Controls.Spinner);n.extend(n.ui.spinner,{getter:"value",setter:"value"})})(jQuery);
/*!
 ~/Script/jquery.forms.controls.categorytree.js
*/
(function(n){(typeof SourceCode=="undefined"||SourceCode===null)&&(SourceCode={});(typeof SourceCode.Forms=="undefined"||SourceCode.Forms===null)&&(SourceCode.Forms={});(typeof SourceCode.Forms.Controls=="undefined"||SourceCode.Forms.Controls===null)&&(SourceCode.Forms.Controls={});SourceCode.Forms.Controls.CategoryTree={_create:function(){this.element.children("li").length===0&&this.element.append('<li class="root"><a href="javascript:;" class="loading">'+Resources.CommonPhrases.LoadingText+"<\/a><\/li>");this.element.tree({expand:this._treeexpand.bind(this),dblclick:this._treeDblClick.bind(this)});var t=this,q={action:"initcatbrowsertree"};t.options!==undefined&&(t.options.objecttypes!==undefined&&(q.datatypes=t.options.objecttypes),t.options.selected!==undefined&&t.options.selected.catid!==undefined&&t.options.selected.catid>0&&(q.catid=t.options.selected.catid),t.options.selected!==undefined&&t.options.selected.objectid!==undefined&&t.options.selected.objectid!==""&&(q.guid=t.options.selected.objectid,q.objecttype=t.options.selected.objecttype,delete q.catid));t._url=applicationRoot+"AppStudio/AJAXCall.ashx";checkExists(t.options.url)&&t.options.url!==""&&(t._url=t.options.url);n.ajax({cache:!1,data:n.param(q),dataType:"xml",url:t._url,success:t._initTreeData.bind(t),type:"POST"})},_initTreeData:function(t){if(typeof SourceCode.Forms.ExceptionHandler.isException=="function"&&SourceCode.Forms.ExceptionHandler.isException(t)){SourceCode.Forms.ExceptionHandler.handleException(t);return}var o=this,f=this.element.children("li:first-child"),q=n("nodes > node",t).eq(0);f.children("a").text(q.attr("text")).addClass(q.attr("icon"));var e=[q.attr("icon")];q.attr("haschildren")!==undefined&&q.attr("haschildren")==="true"&&e.push("children");q.attr("open")!==undefined&&q.attr("open")==="true"&&e.push("open");q.attr("selected")!==undefined&&q.attr("selected")==="true"&&e.push("selected");var r={},u=0;q.attr("catid")!==undefined&&(r.catid=q.attr("catid"),u++);q.attr("datatype")!==undefined&&(r.datatype=q.attr("datatype"),u++);q.attr("datatypes")!==undefined&&(r.datatypes=q.attr("datatypes"),u++);q.attr("type")!==undefined&&(r.type=q.attr("type"),u++);q.attr("subtype")!==undefined&&(r.subtype=q.attr("subtype"),u++);u>0&&f.attr("data-options",jQuery.toJSON(r));f[0].className=e.join(" ");o._treeLoad(q.children("node"),f)},_treeLoad:function(t,q){var r=this,u=q.closest("ul.tree");t.length>0?t.each(function(){var t=n(this),f={data:{}};f.text=t.attr("text");f.icon=t.attr("icon");t.attr("haschildren")!==undefined&&(f.children=t.attr("haschildren")==="true"?!0:!1);t.attr("open")!==undefined&&(f.open=f.children&&t.attr("open")==="true"?!0:!1);t.attr("selected")!==undefined&&(f.selected=t.attr("selected")==="true"?!0:!1);t.attr("visible")!==undefined&&(f.visible=t.attr("visible"));t.attr("id")!==undefined&&(f.data.guid=t.attr("id"));t.attr("name")!==undefined&&(f.data.name=f.name=t.attr("name"));t.attr("description")!==undefined&&(f.data.description=f.description=t.attr("description"));t.attr("title")!==undefined&&(f.title=t.attr("title"));t.attr("catid")!==undefined&&(f.data.catid=t.attr("catid"));t.attr("datatype")!==undefined&&(f.data.datatype=t.attr("datatype"));t.attr("datatypes")!==undefined&&(f.data.datatypes=t.attr("datatypes"));t.attr("type")!==undefined&&(f.data.type=t.attr("type"));t.attr("subtype")!==undefined&&(f.data.subtype=t.attr("subtype"));var e=u.tree("add",q,f);t.children("node").length>0&&r._treeLoad(t.children("node"),e)}):q.is("li")&&q.is(".children.open")&&q.removeClass("open").addClass("closed").removeClass("children");q.is("li")&&q.removeClass("loading")},_treeDblClick:function(n,t){var q=t.node;q.children("a").trigger("click");q.is(".category.children")&&this.element.tree("toggle",q)},_treeexpand:function(t,q){var u=q.node,r=u.metadata(),e=this;if(u.children("ul").children("li").length===0){var f={action:"gettreedata"};typeof r.datatype!="undefined"&&(f.datatype=r.datatype);typeof r.datatypes!="undefined"&&(f.datatypes=r.datatypes);typeof r.catid!="undefined"&&(f.catid=r.catid);u.addClass("loading");n.ajax({cache:!1,data:n.param(f),dataType:"xml",url:e._url,success:function(t){if(typeof SourceCode.Forms.ExceptionHandler.isException=="function"&&SourceCode.Forms.ExceptionHandler.isException(t)){SourceCode.Forms.ExceptionHandler.handleException(t);return}e._treeLoad(n("nodes > node",t),u)},type:"POST"})}},value:function(){var t={};if(this.element.find(".selected").length>0){var r=this.element.find(".selected"),q=r.metadata();q.type!==undefined&&q.type!=="category"?(t.catid=r.parent("ul").parent("li").metadata().catid,t.catname=r.parent("ul").parent("li").children("a").text(),t.objectname=q.text,t.objectSystemName=q.name):(t.catid=q.catid,t.catname=r.children("a").text());for(var u="\\",n=[];r.parent().is(":not(.tree)");)n.push(r.children("a").text()),r=r.parent("ul").parent("li");n.push(r.children("a").text());n=n.reverse();q.type!==undefined&&q.type!=="category"&&(t.objecttype=q.type);q.guid!==undefined&&(t.objectid=q.guid);t.fullpath=n.join(u);q.type!==undefined&&q.type!=="category"?(n.pop(),n=n.reverse(),n.pop(),n=n.reverse(),t.path=n.join(u)):(n=n.reverse(),n.pop(),n=n.reverse(),t.path=n.join(u))}return t}};typeof SCCategoryTree=="undefined"&&(SCCategoryTree=SourceCode.Forms.Controls.CategoryTree);n.widget("ui.categorytree",SourceCode.Forms.Controls.CategoryTree)})(jQuery);
/*!
 ~/Script/jquery.Forms.utilities.overlay.js
*/
(function(n){(typeof SourceCode=="undefined"||SourceCode===null)&&(SourceCode={});(typeof SourceCode.Forms=="undefined"||SourceCode.Forms===null)&&(SourceCode.Forms={});(typeof SourceCode.Forms.Widget=="undefined"||SourceCode.Forms.Widget===null)&&(SourceCode.Forms.Widget={});SourceCode.Forms.Widget.OverlayControl={WAIT_FOR:300,MIN_OVERLAY_TIME:500,_overlay:null,_showTimer:null,_hideTimer:null,_canClose:!0,_closeRequested:!1,_create:function(){this.showOverlay()},_isShowing:function(){return!!this._overlay},_ensureOverlay:function(){if(!checkExists(this._overlay)){var n=this.element,t=(this.options.classes?this.options.classes:"")+(this.options.modal?" k2-modal-overlay ":"");var q='<div class="k2-overlay invisible-overlay '+t+'"><\/div>';n.after(q);this._overlay=n.next(".k2-overlay");this.options.icon!==""&&this._overlay.append('<div class="k2-overlay-icon '+this.options.icon+'"><\/div>')}},_showOverlay:function(){clearTimeout(this._showTimer);this._overlay.removeClass("invisible-overlay");this._canClose=!1;typeof this.options.onShow=="function"&&this.options.onShow();this._hideTimer=setTimeout(this._minOverlayTimeCompleted.bind(this),this.MIN_OVERLAY_TIME)},_minOverlayTimeCompleted:function(){this._canClose=!0;this._closeRequested==!0&&this._removeOverlay();clearTimeout(this._hideTimer);clearTimeout(this._showTimer)},_canInstantlyClose:function(){return this._canClose||!this._isShowing()},showOverlay:function(){if(clearTimeout(this._hideTimer),clearTimeout(this._showTimer),this._canClose=!0,this._closeRequested=!1,!this._isShowing()){var n=this.element,t=n.position();this._ensureOverlay();n.css("position")!=="static"&&n.css("position")!=="relative"&&this._overlay.css({top:t.top+"px",left:t.left+"px",width:n.outerWidth()+"px",height:n.outerHeight()+"px"});this._showTimer=setTimeout(this._showOverlay.bind(this),this.WAIT_FOR)}},removeOverlay:function(){this._canInstantlyClose()?this._removeOverlay():this._closeRequested=!0},_removeOverlay:function(){clearTimeout(this._hideTimer);clearTimeout(this._showTimer);this._canClose=!0;this._closeRequested=!1;!this._overlay||(this._overlay.remove(),this._overlay=null);typeof this.options.onHide=="function"&&this.options.onHide()}};n.widget("ui.overlaycontrol",SourceCode.Forms.Widget.OverlayControl);n.extend(n.ui.overlaycontrol.prototype,{options:{modal:!1,icon:"",classes:"",onHide:null,onShow:null}})})(jQuery),function(n){n.fn.overlay_old=function(t){var q=n.extend({modal:!1,icon:"",classes:""},t);return this.each(function(){var t=n(this),u=t.position(),f=(q.classes?q.classes:"")+(q.modal?" k2-modal-overlay ":"");var e='<div class="k2-overlay '+f+'"><\/div>';t.after(e);var r=t.next(".k2-overlay");t.css("position")!=="static"&&t.css("position")!=="relative"&&r.css({top:u.top+"px",left:u.left+"px",width:t.outerWidth()+"px",height:t.outerHeight()+"px"});q.icon!==""&&(r.append('<div class="k2-overlay-icon '+q.icon+'"><\/div>'),r.append('<div class="spinner-content"><div class="spinner-content-inner"><div class="spinner-header"><\/div><div class="spinner-icon"><div class="s1"><\/div><div class="s2"><\/div><div class="s3"><\/div><div class="s4"><\/div><\/div><div class="spinner-footer"><\/div><\/div><\/div>'))}),this};n.fn.removeOverlay_old=function(){return this.each(function(){n(this).next(".k2-overlay").remove()}),this};n.fn.overlay=function(t){var q=n.extend({modal:!1,icon:"",classes:"",onHide:null,onShow:null},t);return this.each(function(){var r=n(this),t=n(this).data("ui-overlaycontrol");t?t.showOverlay():r.overlaycontrol(q)}),this};n.fn.removeOverlay=function(){return this.each(function(){var t=n(this).data("ui-overlaycontrol");!t||t.removeOverlay()}),this}}(jQuery);
/*!
 ~/Script/jquery.Forms.utilities.metadata.js
*/
(function(n){n.extend({metadata:{defaults:{single:"metadata"},get:function(t,q){var u=n.extend({},this.defaults,q);u.single.length||(u.single="metadata");var r=n.data(t,u.single);if(checkExists(r))return r;r="{}";var o=function(n){return typeof n!="string"?n:JSON.parse(n)};if(checkExists(t.getAttribute)){var f=t.getAttribute("data-options");checkExists(f)&&(r=f)}var e=o(r);return n.data(t,u.single,e),e}}});n.fn.metadata=function(t){return n.metadata.get(this[0],t)}})(jQuery);
/*!
 ~/Script/jquery.Forms.utilities.array.js
*/
(function(n){n.extend({every:function(n,t){if(typeof t!="function")throw new TypeError;for(var r=arguments[2],q=0,u=n.length;q<u;q++)if(q in n&&!t.call(r,n[q],q,n))return!1;return!0},some:function(n,t){if(typeof t!="function")throw new TypeError;for(var r=arguments[2],q=0,u=n.length;q<u;q++)if(q in n&&t.call(r,n[q],q,n))return!0;return!1}})})(jQuery);
/*!
 ~/Script/jquery.Forms.utilities.events.js
*/
(function(n){n.fn.extend({copyEvents:function(t){return n.event.copy(n(t),this),this},copyEventsTo:function(t){return n.event.copy(this,n(t)),this}});n.event.copy=function(t,q){var r=n.data(t[0],"events");t.size()&&r&&q.size()&&q.each(function(){for(var t in r)for(var q in r[t])n.event.add(this,t,r[t][q],r[t][q].data)})};n.fn.extend({disable:function(){var t=n(this).clone(!0).hide();n(this).data("clone",t);n(this).off()},enable:function(){var t=n(this).data("clone");checkExists(t)&&(t.copyEventsTo(this),t.remove(),n(this).removeData("clone"))}});n.event.special.input={setup:function(){var r,q=this,o=q.value,u=document.createElement(this.tagName),s="oninput"in u||t(u),h="onpropertychange"in u;function f(){q.value!==o&&(o=q.value,n(q).trigger("input"))}function e(t){t.type==="propertychange"&&window.event.propertyName==="value"?n(this).trigger("input"):t.type==="focus"?(f(),clearInterval(r),r=window.setInterval(f,250)):t.type==="blur"?window.clearInterval(r):window.setTimeout(f,0)}if(s)return!1;if(h)n(this).on("propertychange",e);else n(this).on("focus blur paste cut keydown drop",e);n(this).data("inputEventHandler",e)},teardown:function(){n(this).off("focus blur propertychange paste cut keydown drop",n(this).data("inputEventHandler"))}};n.fn.input=function(n){return n?this.on("input",n):this.trigger("input")};function t(n){if(n.setAttribute("oninput","return"),typeof n.oninput=="function")return!0;try{var t=document.createEvent("KeyboardEvent"),q=!1,r=function(n){q=!0;n.preventDefault();n.stopPropagation()};return t.initKeyEvent("keypress",!0,!0,window,!1,!1,!1,!1,0,"e".charCodeAt(0)),document.body.appendChild(n),n.addEventListener("input",r,!1),n.dispatchEvent(t),n.removeEventListener("input",r,!1),document.body.removeChild(n),q}catch(t){}}})(jQuery);
/*!
 ~/Script/jquery.Forms.utilities.dimensions.js
*/
(function(n){n.fn.widthAll=function(t){var q=0;return t!==undefined&&t!==null?(this.each(function(){n(this).width(t)}),q=this):this.each(function(){q+=n(this).width()}),q};n.fn.heightAll=function(t){var q=0;return t!==null&&t!==null?(this.each(function(){n(this).height(t)}),q=this):this.each(function(){q+=n(this).height()}),q};n.fn.outerWidthAll=function(t){var q=0;return t===undefined&&(t=!1),this.each(function(){q+=n(this).outerWidth(t)}),q};n.fn.outerHeightAll=function(t){var q=0;return t===undefined&&(t=!1),this.each(function(){q+=n(this).outerHeight(t)}),q};n.fn.accurateHeight=function(){return this[0].getBoundingClientRect().height}})(jQuery);
/*!
 ~/Script/jquery.Forms.utilities.pseudo.js
*/
(function(n){n.expr.pseudos.overflown=function(n){return n.scrollHeight>n.clientHeight||n.scrollWidth>n.clientWidth};n.expr.pseudos.scrollable=function(t){return["auto","scroll"].indexOf(n(t).css("overflow"))!==-1||["auto","scroll"].indexOf(n(t).css("overflowX"))!==-1||["auto","scroll"].indexOf(n(t).css("overflowY"))!==-1};n.expr.pseudos.metadata=function(t,q,r){var s=r[3],u,o=n(t).metadata(),e,f;if(n.isEmptyObject(o))return!1;if(u=s.split("^=").length>1)return e=u[0],f=u[1].match("^'(.*)?'$")[1],o[e].search("^"+f)!==-1;if(u=s.split("$=").length>1)return e=u[0],f=u[1].match("^'(.*)?'$")[1],o[e].search(f+"$")!==-1;if(u=s.split("~=").length>1)return e=u[0],f=u[1].match("^'(.*)?'$")[1],o[e].search(f)!==-1;if(u=s.split("!=").length>1){if(typeof o[u[0]]!="undefined")return e=u[0],u[1].search("^'(.*)?'$")!==-1?f=u[1].match("^'(.*)?'$")[1]:(f=parseInt(u[1]),isNaN(f)&&(u[1].toLowerCase()==="true"&&(f=!0),u[1].toLowerCase()==="false"&&(f=!1),u[1].toLowerCase()==="null"&&(f=null))),o[e]!==f}else if((u=s.split("=").length>1)&&typeof o[u[0]]!="undefined")return e=u[0],u[1].search("^'(.*)?'$")!==-1?f=u[1].match("^'(.*)?'$")[1]:(f=parseInt(u[1]),isNaN(f)&&(u[1].toLowerCase()==="true"&&(f=!0),u[1].toLowerCase()==="false"&&(f=!1),u[1].toLowerCase()==="null"&&(f=null))),o[e]===f;return!1}})(jQuery);
/*!
 ~/Script/jquery.Forms.utilities.caret.js
*/
(function(n){n.fn.caret=function(n,t){if(!arguments.length){var q=this.get(0),r=q.value;if(r)if(q.setSelectionRange)n=q.selectionStart,t=q.selectionEnd;else{var u=document.selection.createRange(),f=u.duplicate(),e=r.length;u.moveEnd("character",e);f.moveStart("character",-e);n=r.lastIndexOf(u.text);t=f.text.length}else n=t=0;return{start:n,end:t}}var o=arguments;return this.each(function(){if(o.length===1)switch(o[0]){case"start":n=t=0;break;case"end":n=t=this.value.length;break;default:t=n}if(this.setSelectionRange)this.setSelectionRange(n,t);else{var q=this.createTextRange();q.collapse(!0);n===t?q.move("character",n):(q.moveStart("character",n),q.moveEnd("character",t));q.select()}}),this}})(jQuery);
/*!
 ~/Script/jquery.Forms.utilities.visible.js
*/
(function(n){n.fn.visibleUntil=function(t){for(var r=n(),q=0;q<this.length;q++){var u=n(this[q]).closest(".hidden, [style*='display:none'], [style*='display: none'], "+t);u.is(t)&&r.push(this[q])}return r}})(jQuery);
/*!
 ~/Script/jquery.Forms.controls.tokenbox.js
*/
(function(n){n.widget("k2.tokenbox",{options:{accept:".token",droppableEnabled:!0,multiValue:!0,multiline:!1,allowTextInput:!0,change:null,watermark:"",required:!1,active:!1,wysiwyg:{enabled:!1,commands:{fontName:{visible:!0},fontSize:{visible:!0},bold:{visible:!0},italic:{visible:!0},underline:{visible:!0},strikeThrough:{visible:!1},fontColor:{visible:!0},justifyLeft:{visible:!0},justifyCenter:{visible:!0},justifyRight:{visible:!0},justifyFull:{visible:!1},indent:{visible:!1},outdent:{visible:!1},subscript:{visible:!1},superscript:{visible:!1},insertOrderedList:{visible:!1},insertUnorderedList:{visible:!1},insertHorizontalRule:{visible:!1},cut:{visible:!1},copy:{visible:!1},paste:{visible:!1},html:{visible:!1},highlight:{visible:!0},clear:{visible:!0},loadTemplate:{visible:!1},clearTemplate:{visible:!1}},fonts:["Arial","Bookman Old Style","Comic Sans MS","Courier","Courier New","Garamond","Georgia","Impact","Lucida Console","Lucida Sans Unicode","MS Sans Serif","MS Serif","Palatino Linotype","Sans Serif","Serif","Tahoma","Times New Roman","Trebuchet MS","Verdana"],fontSizes:["8pt","9pt","10pt","11pt","12pt","14pt","16pt","18pt","20pt","22pt","24pt","26pt","28pt","36pt","48pt","72pt"],watermark:""}},regexp:{rp:/<p>/gim,rpe:/<\/p>/gim,rd:/<div>/gim,rde:/<\/div>/gim,rb:/<br.*?>/gim,rls:/^[ \t]+/gm,rts:/[ \t]+$/gm,rlsc:/^\s/,rtsc:/\s$/,formatBR:/<br>/gim,formatOpeningSpan:/<SPAN/gim,formatClosingSpan:/<\/SPAN>/gim,zeroWidthSpace:/\u200B/g,nonBreakSpace:/\u00A0/g,lineBreak:/<\/div><div>/gim},_create:function(){this.control=n(this._html()).insertAfter(this.element);this.element.hide();this.editor=this.control.find("*[contenteditable=true]");this.options.watermark===""||this.editor.text().length||this.control.find(".input-control-content").append('<span class="token-input-watermark">'+this.options.watermark+"<\/span>");this.control.find("select").dropdown({width:"inherit"});this.control.find(".toolbar-button").on("click.tokenbox",this._toolbarClick.bind(this));this.options.multiline||this.control.addClass("single-line");this.draggable=null;this.deleteCodes=[8,46];this.controlcodes=[9,16,17,18,19,20,27,33,34,35,36,37,38,39,40,44,45,91,92,93,112,113,114,115,116,117,118,119,120,121,122,123,144,145,182,183];this._initEditorEvents();this.control.addClass(this.options.multiValue?"multi-value":"single-value");this.control.addClass(this.options.allowTextInput?"mixed-values":"tokens-only")},_destroy:function(){this.control.remove();this.element.show()},_disableEditor:function(){this.editor.prop("contenteditable",!1)},_disableSpellCheck:function(){this.editor.prop("spellcheck",!1)},_enableEditor:function(){this.editor.prop("contenteditable",!0)},_enableSpellCheck:function(){this.editor.prop("spellcheck",!0)},_execCommand:function(n,t,q){return document.execCommand(n,t,q)},_html:function(){var t="";if(this.options.wysiwyg.enabled){t='<div class="panel full without-header with-toolbar without-footer scroll-contents token-input"><div class="panel-toolbars"><div class="toolbars single"><div class="toolbar"><div class="toolbar-wrapper">';var r=0,q=this;n.each(this.options.wysiwyg.commands,function(n,u){if(u.visible){r>0&&(t+='<div class="toolbar-divider"><\/div>');r++;switch(n){case"fontName":t+='<div class="toolbar-control-wrapper"><select><option class="" value="unchanged" selected="selected"><\/option>';for(var f=0,o=q.options.wysiwyg.fonts.length;f<o;f++)t+='<option class="font-family-'+q.options.wysiwyg.fonts[f].toLowerCase().replaceAll(" ","-")+'" value="'+q.options.wysiwyg.fonts[f]+'">'+q.options.wysiwyg.fonts[f]+"<\/option>";t+='<option value="">Clear<\/option><\/select><\/div>';break;case"fontSize":t+='<div class="toolbar-control-wrapper"><select><option value="unchanged"><\/option>';for(var f=0,o=q.options.wysiwyg.fontSizes.length;f<o;f++)t+='<option value="'+q.options.wysiwyg.fontSizes[f]+'">'+q.options.wysiwyg.fontSizes[f]+"<\/option>";t+='<option value="">Clear<\/option><\/select><\/div>';break;default:var e=n;switch(n){case"justifyLeft":e="justify-left";break;case"justifyCenter":e="justify-center";break;case"justifyRight":e="justify-right";break;case"justifyFull":e="justify-full";break;case"fontColor":e="text-color";break;case"highlight":e="text-highlight";break;case"loadTemplate":e="load-template";break;case"clearTemplate":e="clear-template"}t+='<a class="toolbar-button '+e+'" href="javascript:;" command="'+n+'"><span class="button-l"><\/span><span class="button-c"><span class="button-icon"><\/span><\/span><span class="button-r"><\/span><\/a>'}}});t+='<\/div><\/div><\/div><\/div><div class="panel-body"><div class="panel-body-t"><div class="panel-body-t-l"><\/div><div class="panel-body-t-c"><\/div><div class="panel-body-t-r"><\/div><\/div><div class="panel-body-m"><div class="panel-body-m-l"><\/div><div class="panel-body-m-c"><div class="panel-body-wrapper"><div class="scroll-wrapper"><div class="token-input-editor-area" contenteditable="true">'+q.element.val()+'<\/div><\/div><\/div><\/div><div class="panel-body-m-r"><\/div><\/div><div class="panel-body-b"><div class="panel-body-b-l"><\/div><div class="panel-body-b-c"><\/div><div class="panel-body-b-r"><\/div><\/div><\/div><\/div>'}else t='<div class="input-control token-input"><div class="input-control-content"><div class="input-control-wrapper"><div class="token-input-editor-area" contenteditable="true">'+this.element.val()+"<\/div><\/div><\/div><\/div>";return t},_initEditorEvents:function(){var t=this;t.editor.on("keydown.tokenbox",function(q){if(!t.options.multiline&&q.keyCode===13||!t.options.wysiwyg.enabled&&q.ctrlKey&&[66,69,73,74,76,82,85,107,188,190].indexOf(q.keyCode)!==-1||!t.options.allowTextInput&&t.deleteCodes.indexOf(q.keyCode)===-1&&t.controlcodes.indexOf(q.keyCode)===-1)return!1;var c=rangy.getSelection(),f=c.rangeCount>0?c.getRangeAt(0):rangy.createRange(),u=f.startContainer,o=f.startOffset,p=f.endContainer,w=f.endOffset;if(!t.options.multiValue&&t.controlcodes.indexOf(q.keyCode)===-1){var a=n(this),y=a.find(".entity");if(y.length>0)return a.empty(),this.appendChild(document.createTextNode("")),f.setStartAfter(this.childNodes[0]),f.collapse(!0),f.isValid()&&c.setSingleRange(f),!0}if(q.ctrlKey&&t.options.wysiwyg.enabled)switch(q.keyCode){case 66:return t._execCommand("bold",!1,null),!1;case 69:return t._execCommand("justifycenter",!1,null),!1;case 73:return t._execCommand("italic",!1,null),!1;case 74:return t._execCommand("justifyfull",!1,null),!1;case 76:return t._execCommand("justifyleft",!1,null),!1;case 82:return t._execCommand("justifyright",!1,null),!1;case 85:return t._execCommand("underline",!1,null),!1;case 107:return q.shiftKey?t._execCommand("superscript",!1,null):t._execCommand("subscript",!1,null),!1;case 188:return t._execCommand("decreasefontsize",!1,null),!1;case 190:return t._execCommand("increasefontsize",!1,null),!1}if(f.collapsed){var r=null,h;switch(q.keyCode){case 8:case 46:var e,s,l=null;if(u.nodeType===3&&n(u.parentNode).hasClass("text-node"))if(n(u.parentNode).hasClass("empty"))r=u.parentNode;else if(o===1&&q.keyCode===8||o===0&&q.keyCode===46){if(u.nodeValue.length===1)return u.nodeValue="​",n(u.parentNode).addClass("empty"),!1}else(o===u.nodeValue.length&&q.keyCode===46||o===0&&q.keyCode===8)&&(r=u.parentNode);else u.nodeType===1&&(n(u).hasClass("token-input-editor-area")?u.childNodes.length>0&&(r=u.childNodes.length===o?u.childNodes[o-1]:u.childNodes[o]):n(u).hasClass("text-node")&&n(u).hasClass("empty")&&(r=u));if(r!==null)return q.keyCode===8?(e=r.previousSibling,e!==null&&(n(e).hasClass("entity")||e.nodeName.toUpperCase()==="BR")&&(n(e).remove(),e=r.previousSibling,e!==null&&e.nodeType===1&&n(e).hasClass("text-node")&&n(r).hasClass("text-node")&&(n(e).hasClass("empty")&&n(r).hasClass("empty")?n(e).remove():!n(e).hasClass("empty")&&n(r).hasClass("empty")?(n(r).remove(),r=e):n(e).hasClass("empty")&&!n(r).hasClass("empty")?(n(e).remove(),l=0):n(e).hasClass("empty")||n(r).hasClass("empty")||(l=e.childNodes.length>0?e.childNodes[0].nodeValue.length:0,n(e).text(n(e).text()+n(r).text()),n(r).remove(),r=e)))):q.keyCode===46&&(s=r.nextSibling,s!==null&&(n(s).hasClass("entity")||s.nodeName.toUpperCase()==="BR")&&(n(s).remove(),s=r.nextSibling,s!==null&&s.nodeType===1&&n(s).hasClass("text-node")&&n(r).hasClass("text-node")&&(n(s).hasClass("empty")&&n(r).hasClass("empty")?n(s).remove():!n(s).hasClass("empty")&&n(r).hasClass("empty")?(n(r).remove(),r=s,l=0):n(s).hasClass("empty")&&!n(r).hasClass("empty")?n(s).remove():n(s).hasClass("empty")||n(r).hasClass("empty")||(l=r.childNodes[0].nodeValue.length,n(r).text(n(r).text()+n(s).text()),n(s).remove())))),r!==null&&(c=rangy.getSelection(),f=rangy.createRange(),l!==null?(f.setStart(r.childNodes[0],l),f.collapse(!0)):(f.selectNodeContents(r),f.collapse(n(r).hasClass("empty")?!0:!1)),c.setSingleRange(f)),!1;break;case 13:if(h=document.createElement("br"),u.nodeType===3&&n(u.parentNode).hasClass("text-node"))if(r=u.parentNode,o===0)n(h).insertBefore(r),n(h.previousSibling).hasClass("entity")&&n('<span class="text-node empty">&#8203;<\/span>').insertBefore(h);else if(o===u.nodeValue.length)n(h).insertAfter(r),(h.nextSibling===null||n(h.nextSibling).hasClass("entity"))&&n('<span class="text-node empty">&#8203;<\/span>').insertAfter(h);else{var v=[u.nodeValue.substring(0,o),u.nodeValue.substring(o)];n(r).text(v[0]);n(r).after(h);n(h).after('<span class="text-node">'+v[1]+"<\/span>")}else u.nodeType===1&&n(u).hasClass("text-node")?(r=u,n(h).insertBefore(r),n(h.previousSibling).hasClass("entity")&&n('<span class="text-node empty">&#8203;<\/span>').insertBefore(h)):(f.insertNode(h),n('<span class="text-node empty">&#8203;<\/span>').insertAfter(h));return r=h.nextSibling,r!==null&&(c=rangy.getSelection(),f=rangy.createRange(),f.selectNodeContents(r),f.collapse(!0),c.setSingleRange(f),q.preventDefault()),!1;case 37:for(u.nodeType===3&&n(u.parentNode).hasClass("text-node")&&(o===0||n(u.parentNode).hasClass("empty"))?r=u.parentNode.previousSibling:u.nodeType===1&&(n(u).hasClass("token-input-editor-area")?(u.childNodes.length>0&&(r=u.childNodes.length===o?u.childNodes[o-1]:u.childNodes[o]),r=r.previousSibling):n(u).hasClass("text-node")&&n(u).hasClass("empty")&&(r=u.previousSibling));r!==null&&!n(r).hasClass("text-node");)r=r.previousSibling;if(r!==null&&n(r).hasClass("text-node"))return c=rangy.getSelection(),f=rangy.createRange(),f.selectNodeContents(r),f.collapse(n(r).hasClass("empty")?!0:!1),c.setSingleRange(f),!1;break;case 39:for(u.nodeType===3&&n(u.parentNode).hasClass("text-node")&&(u.nodeValue.length===o||n(u.parentNode).hasClass("empty"))?r=u.parentNode.nextSibling:u.nodeType===1&&u.childNodes.length>0&&(n(u).hasClass("token-input-editor-area")?(r=u.childNodes.length===o?u.childNodes[o-1]:u.childNodes[o],r=r.nextSibling):n(u).hasClass("text-node")&&n(u).hasClass("empty")&&(r=u.nextSibling));r!==null&&!n(r).hasClass("text-node");)r=r.nextSibling;if(r!==null&&n(r).hasClass("text-node"))return c=rangy.getSelection(),f=rangy.createRange(),f.selectNodeContents(r),f.collapse(n(r).hasClass("empty")?!1:!0),c.setSingleRange(f),!1;break;default:t.controlcodes.indexOf(q.keyCode)===-1&&(u.nodeType===1&&n(u).hasClass("text-node")&&n(u).hasClass("empty")||u.nodeType===3&&n(u.parentNode).hasClass("text-node")&&n(u.parentNode).hasClass("empty")?(u.nodeType===3&&(u=u.parentNode),n(u).removeClass("empty"),c=rangy.getSelection(),f=rangy.createRange(),f.selectNodeContents(u),c.setSingleRange(f)):n(u).hasClass("token-input-editor-area")&&setTimeout(function(){for(var r=n(u).find(".text-node.empty"),q=0;q<r.length;q++){var f=n(r[q]),e=f.text().replace(t.regexp.zeroWidthSpace,"");e.length>0&&f.removeClass("empty")}},0))}}});t.editor.on("keyup.tokenbox",function(q){var f=rangy.getSelection(),r=f.rangeCount>0?f.getRangeAt(0):rangy.createRange(),u=null,e=r.startContainer,o=r.startOffset,s=r.endContainer,h=r.endOffset;if(r.collapsed&&e.nodeType===1&&(n(e).closest(".entity").length>0?u=n(e).closest(".entity"):n(e.childNodes[o]).is(".entity")&&(u=n(e.childNodes[o])),checkExists(u)))switch(q.keyCode){case 35:return u[0].nextSibling!==null&&u[0].nextSibling.nodeType!==1?(r.setStartAfter(u[0]),f.setSingleRange(r)):(r.selectNodeContents(u.children(".entity-text")[0].firstChild),r.collapse(!1),f.setSingleRange(r)),!1;case 36:return u[0].previousSibling!==null&&u[0].previousSibling.nodeType!==1?(r.setStartBefore(u[0]),f.setSingleRange(r)):(r.selectNodeContents(u.children(".entity-text")[0].firstChild),r.collapse(!0),f.setSingleRange(r)),!1}t._trigger("keypress",q)});t.editor.on("focus.tokenbox",function(q,r){t.options.htmlValue=t.editor.html();t.options.active=!0;t.control.find(".input-control-content > .token-input-watermark").remove();t.control.addClass("active");var e=rangy.getSelection(),f=e.rangeCount>0?e.getRangeAt(0):rangy.createRange(),o=f.startContainer,s=f.startOffset,h=f.endContainer,c=f.endOffset;if(checkExists(r)||t.editor.find(".entity.dropped").length>0&&(r=t.editor.find(".entity.dropped"),r.removeClass("dropped")),checkExists(r)){var u=null;r.hasClass("entity")?(u=r[0].nextSibling,u!==null&&u.nodeType===1&&n(u).hasClass("text-node")||(n('<span class="text-node empty">&#8203;<\/span>').insertAfter(r),u=r[0].nextSibling)):r.hasClass("text-node")&&(u=r[0]);u!==null&&n(u).hasClass("text-node")&&(f.setStart(u.childNodes[0],0),f.collapse(n(u).hasClass("empty")?!1:!0),e.setSingleRange(f))}t._trigger("focus",q,{select:r})});if(!t.options.wysiwyg.enabled)t.editor.on("blur.tokenbox",t._onBlur.bind(t));t.options.droppableEnabled===!0&&t.enableDroppable();t.editor.on("mousemove.tokenbox",function(q){if(t.draggable!==null){var r=n(q.target),u=t.editor.find(".active-caret");u.length>0&&u.parent()[0]!==r[0]&&u.remove();t.editor.find(".char.over, .text-node.over").removeClass("over");r.hasClass("token-input-editor-area")?u.length===0&&t.editor.children(".editor-line:last-child").append('<span class="active-caret"><\/span>'):r.hasClass("editor-line")?u.length===0&&r.append('<span class="active-caret"><\/span>'):(r.hasClass("char")||r.hasClass("text-node"))&&r.addClass("over");SourceCode.Forms.Browser.msie&&SourceCode.Forms.Browser.version<9&&t.editor.find(".active-caret").length>0&&t.editor.find(".active-caret").addClass("ie8")}});t.control.on("click.tokenbox",".token-input-watermark",function(){this.editor.trigger("focus")}.bind(t));t.editor.on("click.tokenbox",function(t){var u=n(t.target),r=null,e=!1,f=rangy.getSelection(),q=f.rangeCount>0?f.getRangeAt(0):rangy.createRange(),o=q.startContainer,s=q.startOffset,h=q.endContainer,c=q.endOffset;if(u.hasClass("text-node")&&u.hasClass("empty"))r=u[0];else if(u.closest(".entity").length>0)for(r=u.closest(".entity")[0],e=!0;r.nextSibling!==null&&!n(r).hasClass("text-node");)r=r.nextSibling;return r!==null&&(q=rangy.createRange(),q.selectNodeContents(r),q.collapse(e),q.getNodes().length>0&&f.setSingleRange(q)),!1});t.editor.on("paste.tokenbox",function(q){var o=rangy.getSelection(),r=o.rangeCount>0?o.getRangeAt(0):rangy.createRange(),u=null,s=r.startContainer,c=r.startOffset,l=r.endContainer,a=r.endOffset;if(r.collapsed&&s.nodeType===1&&n(s).hasClass("entity")&&c===0&&(u=n(s),u[0].nextSibling===null||u[0].nextSibling.nodeType===1)){var f=document.createTextNode(" ");u[0].nextSibling===null?f=u[0].parentNode.appendChild(f):(f=u[0].parentNode.insertBefore(f,u[0].nextSibling),t.resetrange={node:f});r.selectNode(f);o.setSingleRange(r)}if(!t.options.wysiwyg.enabled){q.preventDefault();var e="";(q.originalEvent||q).clipboardData!==undefined?e=(q.originalEvent||q).clipboardData.getData("text/plain"):window.clipboardData&&(e=window.clipboardData.getData("Text"));t.options.multiline||(e=e.replace(/\r\n/g,"").replace(/\n/g,""));var h=document.createTextNode(e);r.insertNode(h);r.setStart(h,h.nodeValue.length);r.collapse(!0);r.isValid()&&o.setSingleRange(r)}})},enableDroppable:function(){this.options.droppableEnabled=!0;this.control.is(".disabled")||this.editor.droppable({accept:this.options.accept,tolerance:"pointer",activate:this._tokenActivate.bind(this),deactivate:this._tokenDeactivate.bind(this),over:this._tokenOver.bind(this),out:this._tokenOut.bind(this),drop:this._tokenDrop.bind(this)})},disableDroppable:function(){this.control.is(".disabled")||this.options.droppableEnabled!==!0||this.editor.droppable("destroy");this.options.droppableEnabled=!1},_mergeTextNodes:function(){var u=this;this.editor.contents().filter(function(){return this.nodeType!==1}).wrap('<span class="text-node"><\/span>');this.editor.find("*:not(.text-node, .entity-text)").contents().filter(function(){return this.nodeType!==1}).wrap('<span class="text-node"><\/span>');this.editor.find(".text-node:not(.empty)").each(function(){n(this).prev(".text-node.empty").remove();n(this).next(".text-node.empty").remove();n(this).text(n(this).text().replace(u.regexp.zeroWidthSpace,""))});var r=this.editor.find(".text-node");for(index=0;index<r.length;){for(var t=r.eq(index),q=t.next();q.hasClass(".text-node");)t.text(t.text()+q.text()),q.remove(),q=t.next(),index++;index++}var f=this.editor.contents().toArray();f.every(function(t){return t.nodeType===1&&n(t).hasClass("text-node")&&n(t).hasClass("empty")?!0:!1})&&this.editor.empty()},_onBlur:function(){this._sanitize();this.options.active=!1;this.draggable===null&&(this.control.removeClass("active"),this.options.watermark===""||this.editor.text().length||this.control.find(".input-control-content").append('<span class="token-input-watermark">'+this.options.watermark+"<\/span>"));this.editor.find(".active-caret").remove();this.options.htmlValue!==this.editor.html()&&this._trigger("change")},_restoreTextNodes:function(){this.editor.find(".text-node").each(function(){this.parentNode.replaceChild(document.createTextNode(n(this).text()),this)})},_sanitize:function(){this.editor.find(".entity:empty").remove();var t=this.editor.contents();if(t.length===1&&t[0].nodeType===1&&t[0].nodeName.toUpperCase()==="BR"){this.editor.empty();return}var n=this.editor.html();n=n.replace(this.regexp.rpe,"<br/><br/>");n=n.replace(this.regexp.rp,"");n=n.replace(this.regexp.lineBreak,"<br/>");n=n.replace(this.regexp.rd,"");n=n.replace(this.regexp.rde,"");this.options.multiline||(n=n.replace(this.regexp.rb,""));n=n.replace(this.regexp.formatBR,"<br />");n=n.replace(this.regexp.formatOpeningSpan,"<span");n=n.replace(this.regexp.formatClosingSpan,"<\/span>");this.editor.html(n);this._mergeTextNodes()},_setOption:function(t,q){switch(t){case"value":this.options.value=q;this._setValue(q)}n.ui.version.substr(0,3)==="1.9"?this._super("_setOption",t,q):n.Widget.prototype._setOption.apply(this,arguments)},_setValue:function(t){var q="",r=this;n.each(t,function(){if(this.type==="value"){var t=this.data;t=t.htmlEncode().replace("\n","<br/>");t=t.replace(r.regexp.rls,function(n){return new Array(n.length+1).join("&nbsp;")});t=t.replace(r.regexp.rts,function(n){return new Array(n.length+1).join("&nbsp;")});q+=t}else{var u={},f="",e=0;n.each(this.data,function(n,t){n==="icon"&&(f=t);switch(typeof t){case"boolean":case"number":u[n]=t;e++;break;case"string":u[n]=t;e++}});var o="";checkExistsNotEmpty(this.status)&&(o=" "+this.status.toLowerCase(),u.status=this.status);var s=checkExistsNotEmpty(this.text)?this.text.htmlEncode():"",h=checkExistsNotEmpty(f)?" icon "+f:"",c=e>0?' data-options="'+jQuery.toJSON(u).htmlEncode()+'"':"",l=checkExistsNotEmpty(this.tooltip)?' title="'+this.tooltip.replace(/"/g,"")+'"':"";q+='<span class="entity resolved'+o+h+'"'+c+l;q+=' contenteditable="false"><span class="entity-text">'+s+"<\/span><\/span>"}});this.editor.html(q);this.options.watermark===""||this.editor.text().length?this.editor.text().length>0&&(this.control.find(".input-control-content > .token-input-watermark").remove(),this._wrapTextNodes(),this.editor.find(".entity:first-child, .entity + .entity, .entity + br:last-child").each(function(){n('<span class="text-node empty">&#8203;<\/span>').insertBefore(this)}),this.editor.find(".entity:last-child").each(function(){n('<span class="text-node empty">&#8203;<\/span>').insertAfter(this)})):this.control.find(".input-control-content").append('<span class="token-input-watermark">'+this.options.watermark+"<\/span>")},_tokenActivate:function(){this.options.active&&this.editor.trigger("blur");this._disableEditor()},_tokenDeactivate:function(){this._enableEditor()},_tokenDrop:function(t,q){var r=n(t.originalEvent.target),p;checkExists(this.draggable)||(this.draggable=q.draggable);this.options.multiValue||((r.hasClass("char")||r.hasClass("entity")||r.hasClass("entity-text"))&&(r=r.closest(".editor-line")),r.empty(),this.element.val(""));var o={},s="",h=0;n.each(this.draggable.parent().metadata(),function(n,t){n==="icon"&&(s=t);switch(typeof t){case"boolean":case"number":o[n]=t;h++;break;case"string":o[n]=t;h++}});var c="",l=this.draggable.data("draggingNode");l&&$chk(l.tooltip)&&(c=l.tooltip);var a='<span class="entity resolved dropped'+(s!==""?" icon "+s:"");h>0&&(a+='" data-options="'+jQuery.toJSON(o).htmlEncode());a+='"'+(c!==""?' title="'+c.replace(/"/g,"")+'"':"")+' contenteditable="false"><span class="entity-text">'+this.draggable.text().htmlEncode()+"<\/span><\/span>";var u=n(a);if(this.editor.find(".active-caret").remove(),r.hasClass("text-node")&&r.hasClass("empty"))r.replaceWith(u),n('<span class="text-node empty">&#8203;<\/span>').insertBefore(u),u.next().hasClass("entity")&&n('<span class="text-node empty">&#8203;<\/span>').insertAfter(u);else if(r.hasClass("char")){var f=r.parent(".text-node");p=f.children(".char").index(r[0]);var v=n('<span class="text-node"><\/span>').prependTo(f),y=n('<span class="text-node"><\/span>').appendTo(f);v.append(r.prevAll(".char").toArray().reverse());y.append(r.nextAll(".char")).prepend(r);u.insertBefore(y);f.children().insertBefore(f);f.remove();v.text()===""&&v.replaceWith('<span class="text-node empty">&#8203;<\/span>')}else if(r.hasClass("entity")||r.hasClass("entity-text"))r.closest(".entity").after(u),n('<span class="text-node empty">&#8203;<\/span>').insertAfter(r.closest(".entity"));else if(r.hasClass("editor-line"))r.removeClass("empty"),r.is(":empty")&&r.append('<span class="text-node empty">&#8203;<\/span>'),r.append(u),r.append('<span class="text-node empty">&#8203;<\/span>');else if(r[0]===this.editor[0]){var e=this.editor.children(".editor-line:last-child");e.is(":empty")&&e.append('<span class="text-node empty">&#8203;<\/span>');e.append(u);e.append('<span class="text-node empty">&#8203;<\/span>')}this.editor.find(".entity").off("mouseenter.tokenbox");this.editor.data("revert")!==undefined&&this.editor.removeData("revert");this.editor.find(".text-node").each(function(){n(this).text(n(this).text())});this.draggable=null;this._unWrapEditorLines();this._sanitize();q.tokenbox={};q.tokenbox.element=this.element;q.tokenbox.editor=this.editor;this._trigger("drop",t,q);this._trigger("change");window.setTimeout(function(){var t=rangy.getSelection(),n=t.rangeCount>0?t.getRangeAt(0):rangy.createRange(),q=this.editor.children(".dropped");q.length>0&&(n.setStartAfter(q[0]),n.collapse(!0),n.isValid()&&t.setSingleRange(n),this.editor.trigger("focus"))}.bind(this),0)},_tokenOut:function(n,t){t.helper.removeClass("valid");this.draggable=null;this.editor.find(".active-caret").remove();this.control.removeClass("active");this.editor.find(".entity").off("mouseenter.tokenbox");this.editor.data("revert")!==undefined?(this.editor.html(this.editor.data("revert")),this.editor.removeData("revert")):this._sanitize();this.options.watermark===""||this.editor.text().length||this.control.find(".input-control-content").append('<span class="token-input-watermark">'+this.options.watermark+"<\/span>")},_tokenOver:function(t,q){var r=this;if(r.control.find(".input-control-content > .token-input-watermark").remove(),this.control.addClass("active"),q.helper.addClass("valid"),r.draggable=q.draggable,r._wrapEditorLines(),r.editor.find(".text-node").each(function(){for(var t=n(this),u=t.text(),q=[],r=0;r<u.length;r++)q.push(u.substr(r,1));q.length>0?t.html('<span class="char">'+q.join('<\/span><span class="char">')+"<\/span>"):t.html('<span class="char empty"><\/span>')}),r.editor.children().length===0&&r.editor.append('<div class="editor-line"><\/div>'),r.options.multiline){var e=r.editor.children(".editor-line").last(),f=e.children(),u=e.length===0;!u&&f.length>0&&(u=f.length>1,u||f.hasClass("empty")||(u=!0));u&&r.editor.append('<div class="editor-line empty"><\/div>')}},_toolbarClick:function(t){var q=n(t.currentTarget).attr("command").toLowerCase();switch(q){case"bold":case"italic":case"underline":case"strikethrough":case"subscript":case"superscript":case"justifyleft":case"justifycenter":case"justifyright":this._execCommand(q,!1,null);break;case"clear":this.clear()}},_unWrapEditorLines:function(){for(var t=this.editor.children(":last-child");t.is(".editor-line:empty");)t.remove(),t=this.editor.children(".editor-line:last-child");if(t.is(":only-child")){this.editor.html(t.html());return}this.editor.find(".editor-line").each(function(){n(this).removeAttr("class")})},_value:function(){var t=[];if(this._sanitize(),this.options.wysiwyg.enabled){var q=this.editor.html(),r,u;if(q.indexOf('<span class="entity resolved')!==-1){while(q.indexOf('<span class="entity resolved')!==-1){r=q.indexOf('<span class="entity resolved');t.push({type:"value",data:q.substring(0,r)});u=q.indexOf("<\/span>",r)+7;var f=n(q.substring(r,u));t.push({type:"context",data:f.metadata(),text:f.text()});q=q.substring(u)}t.push({type:"value",data:q})}else t.push({type:"value",data:q})}else this.editor.contents().each(function(n,q){this.handleContents(q,t)}.bind(this));return t.length>0&&t[t.length-1].type==="value"&&t[t.length-1].data==="<br />"&&t.pop(),t},_wrapEditorLines:function(){this.editor.html().toLowerCase()==="<br>"&&this.editor.empty();var n=this.editor.html();this.editor.data("revert",n);var t=n.split(this.regexp.rb);this.editor.html('<div class="editor-line">'+t.join('<\/div><div class="editor-line">')+"<\/div>")},_wrapTextNodes:function(){this.editor.contents().filter(function(){return this.nodeType!==1&&!n(this.parentNode).is(".entity, .entity-text")}).wrap('<span class="text-node"><\/span>');this.editor.find("*:not(.text-node, .entity, .entity-text)").contents().filter(function(){return this.nodeType!==1}).wrap('<span class="text-node"><\/span>');this.editor.find("br + .entity").each(function(){n('<span class="text-node empty">&#8203;<\/span>').insertBefore(this)})},blur:function(){this.editor.trigger("blur")},geteditor:function(){return this.editor},handleContents:function(t,q){switch(t.nodeType){case 1:if(n(t).hasClass("entity")){var u={type:"context",data:n(t).metadata(),text:n(t).text()};u.status=checkExists(n(t).metadata().status)?n(t).metadata().status:"";q.push(u)}else if(n(t).hasClass("text-node")){if(!n(t).hasClass("empty")&&!n(t).is(":empty")){var r=n(t).text().replace(this.regexp.nonBreakSpace," ");q.push({type:"value",data:r,text:r})}}else n(t).is("br")?(q.push({type:"value",data:"\n",text:"\n"}),n(t).contents().each(function(n,t){this.handleContents(t,q)}.bind(this))):n(t).contents().each(function(n,t){this.handleContents(t,q)}.bind(this));break;case 3:var r=t.nodeValue.replace(this.regexp.rlsc," ").replace(this.regexp.rtsc," ");r!==""&&q.push({type:"value",data:r,text:r})}},disable:function(){this.control.is(".disabled")||(this.control.addClass("disabled"),this.editor.off(),this._disableEditor())},disabled:function(){return this.control.hasClass("disabled")},enable:function(){this.control.is(".disabled")&&(this.control.removeClass("disabled"),this._enableEditor(),this._initEditorEvents())},focus:function(){this.editor.trigger("focus")},clear:function(){this.element.val("");this.editor.empty();document.activeElement!==this.element[0]&&this._onBlur()},source:function(n){return n===undefined?this.editor.html():(this.editor.html(n),this)},stripstyling:function(){function t(){if(!n(this).is("span.entity, span.entity-text")){var t=n(this).text();this.parentNode.replaceChild(document.createTextNode(t),this)}}this.editor.find("span, b, strong, i, em, font, tt, sub, sup, big, small").each(t);this._sanitize()},value:function(n){return n===undefined?this._value():(this._setOption("value",n),this)},setOption:function(n,t){this._setOption(n,t)},setWatermark:function(n){this._setOption("watermark",n);this.element.parent().find(".token-input-watermark").text(n)}});document.execCommand("AutoUrlDetect",!1,!1)})(jQuery);
/*!
 ~/Script/SourceCode.Forms.menu.js
*/
var MenuBar=function(n){this.initialize(n)},_MenuBarPrototype={options:{element:null,container:null,buttons:[],target:"",id:"",hideURIs:!1,dropshadow:!1,onLoadError:null,onClick:null},initialize:function(n){this.options=$.extend({},this.options,n);this.element=null;this.buttons=[];this.id=this.options.id;this.target=this.options.target;this.hideURIs=this.options.hideURIs;this.activeButton=null;this.dropshadow=this.options.dropshadow;this.loading=!1;$chk(this.options.element)?this._adopt(this.options.element):this._build();$("body").on("mousedown.menu-bar",function(n){this.resetMenuBar(n)}.bind(this))},_build:function(){this.element=$("<div class='menu-bar'><\/div>");$chk(this.id)&&this.id!==""&&(this.element[0].id=this.id);this.element.html('<div class="menu-bar-wrapper"><\/div>');$chk(this.options.container)&&this.options.container.appendChild(this.element[0])},_adopt:function(n){if(n=$type(n)==="string"?$("#"+n):n.jquery?n:$(n),!n.hasClass("menu-bar"))return null;this.element=n;this.element[0].id!==""&&(this.id=this.element[0].id);this.element.children()[0].find("a.menu-bar-button").each(function(n){this.addButton({element:n})}.bind(this))},addButton:function(n){var t=new MenuBarButton($merge(n,{control:this,target:this.target}));return t!==null&&this.buttons.push(t),t},resetMenuBar:function(n){if(this.activeButton!==null){n||(n=new Event(n));var t=$(n.target);t!==this.activeButton.element&&t.parent()!==this.activeButton.element&&t.parent().parent()!==this.activeButton.element&&t.parent().parent()!==this.activeButton.element&&(t.closest(".menu-bar").length>0||t.closest(".menu").length===0)&&(this.activeButton.resetButton(),this.activeButton=null)}},load:function(n){if(!this.loading)if(this.loading=!0,$chk(n.xml)){var t=null;t=$type(n.xml)==="string"?parseXML(n.xml):n.xml;this._import(t.documentElement)}else if($chk(n.url)){$this=this;var q={url:n.url,type:n.method.toUpperCase()||"GET",data:n.vars,cache:!1,dataType:"xml",success:function(n,t){$this._load(n,t)},error:function(n,t){$this._loadError(n,t)}};$.ajax(q)}},_load:function(n,t){n!==null&&n.documentElement!==null?this._import(n.documentElement):this._import(parseXML(t).documentElement);this.loading=!1},_import:function(n){for(var q=n.childNodes,t=0;t<q.length;t++)if(q[t].tagName==="node"){for(var f={},u=q[t].attributes,r=0;r<u.length;r++)switch(u[r].name){case"text":case"id":case"icon":case"description":case"location":case"target":f[u[r].name]=u[r].value}var e=this.addButton(f);if(q[t].childNodes.length){var o=e.addMenu({});o._import(q[t])}}},_loadError:function(n,t){if(this.loading=!1,this.options.onLoadError)this.options.onLoadError(this,t,n)}};$.extend(MenuBar.prototype,_MenuBarPrototype);var MenuBarButton=function(n){this.initialize(n)},_MenuBarButtonPrototype={options:{id:"",element:null,control:null,text:"",location:"",target:"",description:"",hideURIs:!1,onClick:null},initialize:function(n){this.options=$.extend({},this.options,n);this.element=null;this.control=this.options.control;this.target=this.options.target;this.id=this.options.id;this.text=this.options.text;this.description=this.options.description;this.location=this.options.location;this.hideURIs=this.options.hideURIs;this.menu=null;$chk(this.options.element)?this._adopt(this.options.element):this._build();this.element.on("click.menu-bar-button",this._click.bind(this));this.element.on("click.menu-bar-button",this.buttonClick.bind(this));this.element.on("mouseover.menu-bar-button",this.buttonMouseOver.bind(this))},_build:function(){var n=$chk(this.location)&&this.location!==""?this.location:"javascript:;";if(this.element=$("<a href='"+n+"' class='menu-bar-button'><\/a>"),this.element.html('<span class="menu-bar-button-wrapper"><span class="menu-bar-button-text">'+this.text+"<\/span><\/span>"),$chk(this.id)&&this.id!==""&&(this.element[0].id=this.id),$chk(this.control.element)&&$(this.control.element.children()[0]).append(this.element),$chk(this.target)&&this.target!==""?this.element.attr("target",this.target):$chk(this.control.target)&&this.control.target!==""&&this.element.attr("target",this.control.target),$chk(this.description)&&this.description!==""&&this.element.attr("title",this.options.description),this.hideURIs||this.control.hideURIs){this.element.on("mouseenter.menu-bar-button",function(){window.status=this.text}.bind(this));this.element.on("mouseleave.menu-bar-button",function(){window.status=""})}},_adopt:function(n){if(n=$type(n)==="string"?$("#"+n):n.jquery?n:$(n),!n.hasClass("menu-bar-button"))return null;this.element=n;this.element[0].id!==""&&(this.id=this.element[0].id);this.element[0].href!=="javascript:;"&&(this.location=this.element[0].href);this.element.attr("title")!==""&&(this.description=this.element.attr("title"));this.element.attr("target")!==""&&(this.target=this.element.attr("target"));this.text=this.element.find(".menu-bar-button-text").text()},_click:function(n){if(this.element[0].href!=="javascript:;"){var t=$(this.element).attr("target");if(t)switch(t){case"_blank":case"_self":case"_top":case"_parent":break;default:t!==null&&t!==""?window.frames[t].location=this.element[0].href:window.location=this.element[0].href}}if(this.options.onClick)this.options.onClick(n,this)},addMenu:function(n){var t=new Menu($merge(n,{control:this,dropshadow:this.control.dropshadow,target:this.target}));return t!==null&&(this.menu=t),t},resetButton:function(){this.element.removeClass("active");this.menu!==null&&(this.menu.closeSubMenu(),this.menu.element.css("visibility","hidden"),this.menu.dropShadowElement!==null&&this.menu.dropShadowElement.css("visibility","hidden"))},buttonClick:function(){return this.element.trigger("blur"),this.control.activeButton!==null&&this.control.activeButton.resetButton(),this!==this.control.activeButton?(this.depressButton(),this.control.activeButton=this):this.control.activeButton=null,!1},depressButton:function(){if(this.menu!==null){var n,t;this.element.addClass("active");n=this.element.offset().left;t=this.element.offset().top+this.element.height();this.menu.element.css({left:n+"px",top:t+"px",visibility:"visible"});this.menu.dropShadowElement!==null&&this.menu.dropShadowElement.css({left:n+3+"px",top:t+3+"px",width:this.menu.element.width(),height:this.menu.element.height(),visibility:"visible"})}},buttonMouseOver:function(n){this.control.activeButton!==null&&this.control.activeButton!==this&&this.buttonClick(n)}};$.extend(MenuBarButton.prototype,_MenuBarButtonPrototype);var Menu=function(n){this.initialize(n)},_MenuPrototype={options:{id:"",element:null,target:"",control:null,dropshadow:!1,cssClass:null},initialize:function(n){this.options=$.extend({},this.options,n);this.id=this.options.id;this.element=null;this.dropshadow=this.options.dropshadow;this.target=this.options.target;this.control=this.options.control;this.items=[];this.activeItem=null;this.dropShadowElement=null;$chk(this.options.element)?this._adopt(this.options.element):this._build();this.options.cssClass!==null&&this.options.cssClass!==""&&this.element.addClass(this.options.cssClass);this.element.on("mouseover.menu",this.menuMouseOver.bind(this));this.element.on("keydown.menu","a",this._menuKeyDown.bind(this))},_build:function(){this.element=$("<div class='menu'><\/div>");this.element.html("<ul><\/ul>");$chk(this.id)&&this.id!==""&&(this.element[0].id=this.id);this.originalMaxHeight=$(!document.defaultView?document.parentWindow:document.defaultView).height()-10;$("body").append(this.element);this.element.css({"max-height":this.originalMaxHeight+"px",overflow:"auto",top:0,left:0});this.dropshadow&&(this.dropShadowElement=$("<div class='menu-shadow'><\/div>"),this.element.before(this.dropShadowElement))},_adopt:function(n){if(n=$type(n)==="string"?$("#"+n):n.jquery?n:$(n),!n.hasClass("menu"))return null;this.element=n;this.element[0].id!==""&&(this.id=this.element[0].id);this.element.children()[0].children().each(function(n){this.addItem({element:n})}.bind(this))},_import:function(n){for(var q=n.childNodes,t=0;t<q.length;t++)if(q[t].tagName==="node")if(q[t].attributes.type!==null&&q[t].attributes.type==="seperator")this.addSeperator();else{for(var f={},u=q[t].attributes,r=0;r<u.length;r++)switch(u[r].name){case"text":case"id":case"icon":case"description":case"location":case"target":f[u[r].name]=u[r].value}var e=this.addItem(f);if(q[t].childNodes.length){var o=e.addSubMenu({});o._import(q[t])}}},addItem:function(n){var t=null;typeof n.checked!="undefined"&&typeof n.type=="undefined"&&(n.type="checkbox");switch(n.type){case"filter":t=new FilterCheckMenuItem($merge(n,{control:this,target:this.target}));break;case"radiobutton":t=new RadioMenuItem($merge(n,{control:this,target:this.target}));break;case"checkbox":t=new CheckMenuItem($merge(n,{control:this,target:this.target}));break;default:t=new MenuItem($merge(n,{control:this,target:this.target}))}return t!==null&&this.items.push(t),t},addSeperator:function(){this.items.push(new MenuItemSeperator({control:this}))},closeSubMenu:function(){this.activeItem!==null&&(this.activeItem.subMenu!==null&&(this.activeItem.subMenu.closeSubMenu(),this.activeItem.subMenu.element.css("visibility","hidden"),this.activeItem.subMenu.dropShadowElement!==null&&this.activeItem.control.subMenu.dropShadowElement.css("visibility","hidden")),$(this.activeItem.element.children()[0]).removeClass("active"),this.activeItem=null)},menuMouseOver:function(){this.activeItem!==null&&this.closeSubMenu()},_menuKeyDown:function(n){var t=this.element.find("li:not(.seperator)"),u=this.element.find(".active"),e=t.index(u),q=!0;switch(n.which){case 37:case 39:q=!0;break;case 40:var f=e+1;f>=t.length&&(f=t.length-1);t.removeClass("active");$(t[f]).addClass("active").trigger("focus");q=!1;break;case 38:var r=e-1;r<0&&(r=r===-2?t.length-1:0);t.removeClass("active");$(t[r]).addClass("active").trigger("focus");q=!1;break;case 32:case 13:u.trigger("click");q=!1;n.stopPropagation();break;case 27:this.closeMenu();u.trigger("blur");q=!1;n.stopPropagation()}return q},closeMenu:function(){this.activeItem!==null&&this.closeSubMenu();this.element.css("visibility","hidden");this.dropShadowElement!==null&&this.dropShadowElement.css("visibility","hidden");$(this.element).trigger("close.contextmenu")},isOpen:function(){return this.element.css("visibility")==="visible"},afterMenuItemClick:function(){this.closeMenu()}};$.extend(Menu.prototype,_MenuPrototype);var MenuItem=function(n){this.initialize(n)},_MenuItemPrototype={options:{id:"",text:"",description:"",icon:"",location:"",target:"",hideURIs:!1,onClick:null},initialize:function(n){this.options=$.extend({},this.options,n);this.element=null;this.control=this.options.control;this.target=this.options.target;this.id=this.options.id;this.text=this.options.text;this.description=this.options.description;this.icon=this.options.icon;this.location=this.options.location;this.hideURIs=this.options.hideURIs;this.subMenu=null;$chk(this.options.element)?this._adopt(this.options.element):this._build();$(this.element.children()[0]).on("click.menu-item",function(n){this._click(n)}.bind(this));$(this.element.children()[0]).on("mouseover.menu-item",function(n){this.menuItemMouseOver(n)}.bind(this))},_build:function(){this.element=$("<li><\/li>");this.element.html('<a class="menu-item" href="javascript:;"><span class="menu-item-icon"><\/span><span class="menu-item-text">'+(typeof this.text=="string"?this.text.htmlEncode():this.text)+"<\/span><\/a>");$chk(this.control.element)&&$(this.control.element.children()[0]).append(this.element);$chk(this.id)&&this.id!==""&&(this.element.children()[0].id=this.id);$chk(this.location)&&this.location!==""&&$(this.element.children()[0]).attr("href",this.location);$chk(this.icon)&&this.icon!==""&&$(this.element.children()[0]).addClass(this.icon);$chk(this.target)&&this.target!==""?$(this.element.children()[0]).attr("target",this.target):$chk(this.control.target)&&this.control.target!==""&&$(this.element.children()[0]).attr("target",this.control.target);$chk(this.description)&&this.description!==""&&$(this.element.children()[0]).attr("title",this.options.description)},_adopt:function(n){if(n=$type(n)==="string"?$("#"+n):n.jquery?n:$(n),n[0].tagName!=="li")return null;this.element=n;this.element.children()[0].id!==""&&(this.id=this.element.children()[0].id);$(this.element.children()[0]).attr("href")!=="javascript:;"&&(this.location=$(this.element.children()[0]).attr("href"));$(this.element.children()[0]).attr("target")!==""&&(this.target=$(this.element.children()[0]).attr("target"));$(this.element.children()[0]).attr("title")!==""&&(this.description=$(this.element.children()[0]).attr("title"))},_click:function(n){if(this.options.onClick)this.options.onClick(n,this);for(var t=this.control;t.control;)t=t.control;t.afterMenuItemClick()},menuItemMouseOver:function(n){if(this.subMenu!==null){var t,q;n=new Event(n);this.activeItem!==null&&this.control.closeSubMenu();this.activeItem=this;$(this.element.children()[0]).addClass("active");t=$(this.element.children()[0]).offset().left+$(this.element.children()[0]).width();q=$(this.element.children()[0]).offset().top;var r,u;r=$(window).scrollLeft()+$(window).width();u=$(window).scrollTop()+$(window).height();r-=this.subMenu.element.width();u-=this.subMenu.element.height();t>r&&(t=Math.max(0,t-$(this.element.children()[0]).width()-this.subMenu.element.width()+(this.control.element.width()-$(this.element.children()[0]).width())));q=Math.max(0,Math.min(q,u));window.ie&&(t-=2);this.subMenu.element.css({left:t+"px",top:q+"px",visibility:"visible"});this.subMenu.dropShadowElement!==null&&this.subMenu.dropShadowElement.css({left:t+4+"px",top:q+4+"px",width:this.subMenu.element.width(),height:this.subMenu.element.height(),visibility:"visible"});n.stop()}},addSubMenu:function(n){var t=new Menu($merge(n,{control:this,dropshadow:this.control.dropshadow,target:this.target}));return t!==null&&(this.subMenu=t,$(this.element.children()[0]).addClass("children")),t}};$.extend(MenuItem.prototype,_MenuItemPrototype);var MenuItemSeperator=function(n){this.initialize(n)},_MenuItemSeperatorPrototype={options:{control:null},initialize:function(n){this.options=$.extend({},this.options,n);this.control=this.options.control;$chk(this.options.element)||this._build()},_build:function(){this.element=$("<li class='seperator'><\/li>");this.element.html("<span><\/span>");$chk(this.control.element)&&this.control.element.children()[0].appendChild(this.element[0])},_adopt:function(n){if(n=$type(n)==="string"?$("#"+n):n.jquery?n:$(n),n[0].tagName!=="li"||!n.hasClass("seperator"))return null;this.element=n}};$.extend(MenuItemSeperator.prototype,_MenuItemSeperatorPrototype);var ContextMenu=function(n){this.initialize(n)},_ContextMenuPrototype={options:{},clearTimer:function(){this.timer!==null&&(window.clearTimeout(this.timer),this.timer=null)},initialize:function(n){this.options=$.extend({},this.options,n);Menu.prototype.initialize.apply(this,arguments);this.timer=null},showContextMenu:function(n){n.stopPropagation();this.showContextMenuAt({event:n,x:n.clientX,y:n.clientY})},showContextMenuAt:function(n){this.clearTimer();checkExists(n.event)&&(n.event.preventDefault(),n.event.stopPropagation());$("body").on("click.contextmenu",this.hideContextMenu.bind(this));$(this.element).on("mouseout.contextmenu",this.applyHideTimer.bind(this));$(this.element).on("mouseover.contextmenu",this.clearTimer.bind(this));this.element.find(".menu-item").on("focus.contextmenu",this.clearTimer.bind(this));var t,q,r,u;win=!document.defaultView?document.parentWindow:document.defaultView;t=n.x;q=n.y;r=$(win).scrollLeft()+$(win).width();u=$(win).scrollTop()+$(win).height();r-=this.element.width();u-=this.element.height();t+this.element.width()>r&&(t-=this.element.width());t<10&&(t=10);q=Math.max(0,Math.min(q,u));q-=10;this.originalMaxHeight=$(win).height()-10;this.element.css({left:t+"px",top:q+"px",visibility:"visible","max-height":this.originalMaxHeight+"px"});this.dropShadowElement!==null&&this.dropShadowElement.css({left:t+3+"px",top:q+3+"px",width:this.element.width(),height:this.element.heigth(),visibility:"visible"});this.applyHideTimer();this.element.find(".menu-item").first().trigger("focus")},hideContextMenu:function(){this.clearTimer();this.closeMenu();$("body").off("click.contextmenu");$(this.element).off("mouseout.contextmenu");$(this.element).off("mouseover.contextmenu")},applyHideTimer:function(){this.clearTimer();this.timer=window.setTimeout(this.hideContextMenu.bind(this),4e3)}};$.extend(ContextMenu.prototype,_MenuPrototype,_ContextMenuPrototype);var CheckBoxContextMenu=function(n){this.initialize(n)},_CheckBoxContextMenuPrototype={options:{},initialize:function(n){this.options=$.extend({},this.options,n);Menu.prototype.initialize.apply(this,arguments);this.timers=[];this.hasChanged=!1},clearTimers:function(){if(this.timers!==null){for(var n=0;n<this.timers.length;n++)$clear(this.timers[n]);this.timers=[]}},showContextMenu:function(n){n.stopPropagation();this.showContextMenuAt({event:n,x:n.clientX,y:n.clientY})},attachEvents:function(){$("body").on("click.checkboxcontextmenu",function(n){this.applyCheck(n)}.bind(this))},updateItem:function(n,t){$this=this;for(var r=0;r<$this.items.length;r++){var u=$this.items[r];if(u.id===n){var q=$("label[id=FilterSearchScope_"+n+"]");t?(q.removeClass("unchecked"),q.addClass("checked"),u.checked=!0):(q.removeClass("checked"),q.addClass("unchecked"),u.checked=!1);break}}},showContextMenuAt:function(n){this.clearTimers();this.timers[this.timers.length]=setTimeout(this.attachEvents.bind(this));$(this.element).on("mouseout.checkboxcontextmenu",this.applyHideTimer.bind(this));$(this.element).on("mouseover.checkboxcontextmenu",this.clearTimers.bind(this));var q,t,r,u;q=n.x;t=n.y;r=$(window).scrollLeft()+$(window).width();u=$(window).scrollTop()+$(window).height();r-=this.element.width();u-=this.element.height();q>r&&(q-=this.element.width());t=Math.max(0,Math.min(t,u));t-=7;this.element.css({left:q+"px",top:t+"px",visibility:"visible",display:""});this.dropShadowElement!==null&&this.dropShadowElement.css({left:q+3+"px",top:t+3+"px",width:this.element.width(),height:this.element.heigth(),visibility:"visible"});SourceCode.Forms.Widget.createUnderlay(this.element);this.applyHideTimer(n.event)},hideContextMenu:function(){this.clearTimers();this.closeMenu();this.element.attr("visited","true");this.hasChanged&&(this.options.close&&this.options.close(),this.hasChanged=!1);$("body").off("click.checkboxcontextmenu");$(this.element).off("mouseout.checkboxcontextmenu");$(this.element).off("mouseover.checkboxcontextmenu");SourceCode.Forms.Widget.destroyUnderlay(this.element)},applyCheck:function(n){n&&n!==undefined&&($(n.target).hasClass("menu")||$(n.target).closest(".menu").length>0)||(this.dropShadowElement!==null&&this.dropShadowElement.css("visibility","hidden"),this.hideContextMenu())},applyHideTimer:function(n){var t=this;this.timers[this.timers.length]=setTimeout(function(){t.hideContextMenu(n)},1500)},afterMenuItemClick:function(){}};$.extend(CheckBoxContextMenu.prototype,_MenuPrototype,_CheckBoxContextMenuPrototype);var RadioMenuItem=function(n){this.initialize(n)},_RadioMenuItemPrototype={options:{id:"",text:"",description:"",icon:"",location:"",target:"",hideURIs:!1,onClick:null,checkbox:null,enabled:!0},initialize:function(n){this.options=$.extend({},this.options,n);this.element=null;this.control=this.options.control;this.target=this.options.target;this.id=this.options.id;this.text=this.options.text;this.description=this.options.description;this.icon=this.options.icon;this.location=this.options.location;this.hideURIs=this.options.hideURIs;this.enabled=this.options.enabled;this.subMenu=null;$chk(this.options.element)?this._adopt(this.options.element):this._build(this.options);$(this.element.children()[0]).on("click.radiomenu-item",function(n){this._click(n)}.bind(this));$(this.element.children()[0]).on("mouseover.radiomenu-item",function(n){this.menuItemMouseOver(n)}.bind(this))},_build:function(n){this.element=$("<li><\/li>");var q="SearchCriteriaScope_"+this.id,t=checkExists(n)&&n.checked===!0?!0:!1;this.enabled||this.element.addClass("disabled");this.element.html('<a class="radiomenu-item" '+(this.enabled?"":'disabled="disabled"')+' href="javascript:;"><label class="input-control radio'+(t?" checked":"")+'" id="'+q+'"><INPUT class="input-control" value="'+this.id+'" type="radio" name="SearchCriteriaScope"'+(t?' checked="checked"':"")+' /><SPAN class="input-control-img"><\/SPAN><SPAN class="input-control-text">'+(typeof this.text=="string"?this.text.htmlEncode():this.text)+"<\/SPAN><\/label><\/a>");$chk(this.control.element)&&$(this.control.element.children()[0]).append(this.element);$chk(this.id)&&this.id!==""&&(this.element.children()[0].id=this.id);$chk(this.location)&&this.location!==""&&$(this.element.children()[0]).attr("href",this.location);$chk(this.target)&&this.target!==""?$(this.element.children()[0]).attr("target",this.target):$chk(this.control.target)&&this.control.target!==""&&$(this.element.children()[0]).attr("target",this.control.target);$chk(this.description)&&this.description!==""&&$(this.element.children()[0]).attr("title",this.options.description)},_adopt:function(n){if(n=$type(n)==="string"?$("#"+n):n.jquery?n:$(n),n[0].tagName!=="li")return null;this.element=n;this.element.children()[0].id!==""&&(this.id=this.element.children()[0].id);$(this.element.children()[0]).attr("href")!=="javascript:;"&&(this.location=$(this.element.children()[0]).attr("href"));$(this.element.children()[0]).attr("target")!==""&&(this.target=$(this.element.children()[0]).attr("target"));$(this.element.children()[0]).attr("title")!==""&&(this.description=$(this.element.children()[0]).attr("title"))},_click:function(n){if(n.preventDefault(),!$(this.element).is(".disabled")){for(var t=this.control;t.control;)t=t.control;var q=t.element.find("input[name=SearchCriteriaScope]");q.parent().removeClass("checked").removeClass("unchecked");q.radiobutton("uncheck");var r=this.element.find("input[type=radio]");if(r.parent().addClass("checked"),r.radiobutton("check"),this.options.onClick)this.options.onClick(n,!0)}},menuItemMouseOver:function(n){if(this.subMenu!==null){var t,q,r,u;n=new Event(n);this.activeItem!==null&&this.control.closeSubMenu();this.activeItem=this;$(this.element.children()[0]).addClass("active");t=$(this.element.children()[0]).offset().left+$(this.element.children()[0]).width();q=$(this.element.children()[0]).offset().top;r=$(window).scrollLeft()+$(window).width();u=$(window).scrollTop()+$(window).height();r-=this.subMenu.element.width();u-=this.subMenu.element.height();t>r&&(t=Math.max(0,t-$(this.element.children()[0]).width()-this.subMenu.element.width()+(this.control.element.width()-$(this.element.children()[0]).width())));q=Math.max(0,Math.min(q,u));window.ie&&(t-=2);this.subMenu.element.css({left:t+"px",top:q+"px",visibility:"visible"});this.subMenu.dropShadowElement!==null&&this.subMenu.dropShadowElement.css({left:t+4+"px",top:q+4+"px",width:this.subMenu.element.width(),height:this.subMenu.element.height(),visibility:"visible"})}},addSubMenu:function(n){var t=new Menu($merge(n,{control:this,dropshadow:this.control.dropshadow,target:this.target}));return t!==null&&(this.subMenu=t,$(this.element.children()[0]).addClass("children")),t}};$.extend(RadioMenuItem.prototype,_RadioMenuItemPrototype);var CheckMenuItem=function(n){this.initialize(n)},_CheckMenuItemPrototype={options:{id:"",text:"",description:"",icon:"",location:"",target:"",hideURIs:!1,onClick:null,checkbox:null,enabled:!0},initialize:function(n){this.options=$.extend({},this.options,n);this.element=null;this.control=this.options.control;this.target=this.options.target;this.id=this.options.id;this.text=this.options.text;this.description=this.options.description;this.icon=this.options.icon;this.location=this.options.location;this.hideURIs=this.options.hideURIs;this.checked=this.options.checked;this.enabled=this.options.enabled;this.subMenu=null;$chk(this.options.element)?this._adopt(this.options.element):this._build();$(this.element.children()[0]).on("click.checkmenu-item",function(n){this._click(n)}.bind(this));$(this.element.children()[0]).on("mouseover.checkmenu-item",function(n){this.menuItemMouseOver(n)}.bind(this))},_build:function(){this.element=$("<li><\/li>");var n="FilterSearchScope_"+this.id;this.enabled?this.element.html('<a class="checkmenu-item" href="javascript:;"><label class="input-control checkbox'+(this.checked?" checked":"")+'" id="'+n+'"><INPUT class="input-control" value="'+this.id+'" type="checkbox" name="FilterSearchScope"'+(this.checked?' checked="checked"':"")+' /><SPAN class="input-control-img"><\/SPAN><SPAN class="input-control-text">'+(typeof this.text=="string"?this.text.htmlEncode():this.text)+"<\/SPAN><\/label><\/a>"):(this.element.addClass("disabled"),this.element.html('<a disabled="disabled" class="checkmenu-item" href="javascript:;"><label class="input-control checkbox'+(this.checked?" checked":"")+'" id="'+n+'"><INPUT class="input-control" value="'+this.id+'" type="checkbox" name="FilterSearchScope"'+(this.checked?' checked="checked"':"")+' /><SPAN class="input-control-img"><\/SPAN><SPAN class="input-control-text">'+(typeof this.text=="string"?this.text.htmlEncode():this.text)+"<\/SPAN><\/label><\/a>"));$chk(this.control.element)&&$(this.control.element.children()[0]).append(this.element);$chk(this.id)&&this.id!==""&&(this.element.children()[0].id=this.id);$chk(this.location)&&this.location!==""&&$(this.element.children()[0]).attr("href",this.location);$chk(this.target)&&this.target!==""?$(this.element.children()[0]).attr("target",this.target):$chk(this.control.target)&&this.control.target!==""&&$(this.element.children()[0]).attr("target",this.control.target);$chk(this.description)&&this.description!==""&&$(this.element.children()[0]).attr("title",this.options.description)},_adopt:function(n){if(n=$type(n)==="string"?$("#"+n):n.jquery?n:$(n),n[0].tagName!=="li")return null;this.element=n;this.element.children()[0].id!==""&&(this.id=this.element.children()[0].id);$(this.element.children()[0]).attr("href")!=="javascript:;"&&(this.location=$(this.element.children()[0]).attr("href"));$(this.element.children()[0]).attr("target")!==""&&(this.target=$(this.element.children()[0]).attr("target"));$(this.element.children()[0]).attr("title")!==""&&(this.description=$(this.element.children()[0]).attr("title"))},_click:function(n){if(n.preventDefault(),!$(this.element).is(".disabled")){for(var q=this.control;q.control;)q=q.control;var t=this.element.find("input[type=checkbox]");if(t.is(":checked")?(t.parent().removeClass("checked").addClass("unchecked"),t.checkbox("uncheck"),this.checked=!1):(t.parent().removeClass("unchecked").addClass("checked"),t.checkbox("check"),this.checked=!0),this.options.onClick)this.options.onClick(n,this.checked)}},menuItemMouseOver:function(n){if(this.subMenu!==null){var t,q,r,u;n=new Event(n);this.activeItem!==null&&this.control.closeSubMenu();this.activeItem=this;$(this.element.children()[0]).addClass("active");t=$(this.element.children()[0]).offset().left+$(this.element.children()[0]).width();q=$(this.element.children()[0]).offset().top;r=$(window).scrollLeft()+$(window).width();u=$(window).scrollTop()+$(window).height();r-=this.subMenu.element.width();u-=this.subMenu.element.height();t>r&&(t=Math.max(0,t-$(this.element.children()[0]).width()-this.subMenu.element.width()+(this.control.element.width()-$(this.element.children()[0]).width())));q=Math.max(0,Math.min(q,u));window.ie&&(t-=2);this.subMenu.element.css({left:t+"px",top:q+"px",visibility:"visible"});this.subMenu.dropShadowElement!==null&&this.subMenu.dropShadowElement.css({left:t+4+"px",top:q+4+"px",width:this.subMenu.element.width(),height:this.subMenu.element.height(),visibility:"visible"})}},addSubMenu:function(n){var t=new Menu($merge(n,{control:this,dropshadow:this.control.dropshadow,target:this.target}));return t!==null&&(this.subMenu=t,$(this.element.children()[0]).addClass("children")),t}};$.extend(CheckMenuItem.prototype,_CheckMenuItemPrototype);var FilterCheckBoxContextMenu=function(n){this.initialize(n)},_FilterCheckBoxContextMenuPrototype={options:{},initialize:function(n){this.options=$.extend({},this.options,n);Menu.prototype.initialize.apply(this,arguments);this.timers=[];this.hasChanged=!1},clearTimers:function(){if(this.timers!==null){for(var n=0;n<this.timers.length;n++)$clear(this.timers[n]);this.timers=[]}},showContextMenu:function(n){n.stopPropagation();var t=$(n.currentTarget).find(".button-wrapper"),r=t.outerHeight()+7,u=(t.outerWidth()+7)/2>>0,q=$(n.currentTarget).offset();this.showContextMenuAt({event:n,x:q.left+u,y:q.top+r})},attachEvents:function(){$("body").on("click.filtercheckboxcontextmenu",function(n){this.applyCheck(n)}.bind(this))},updateItem:function(n,t){$this=this;for(var r=0;r<$this.items.length;r++){var u=$this.items[r];if(u.id===n){var q=$("label[id=RulesFilterSearchScope_"+n+"]");t?(q.removeClass("unchecked"),q.addClass("checked"),u.checked=!0):(q.removeClass("checked"),q.addClass("unchecked"),u.checked=!1);break}}},clearMenu:function(){$this=this;for(var n=0;n<$this.items.length;n++){var q=$this.items[n],t=$("label[id=RulesFilterSearchScope_"+q.id+"]"),r=t.find(":checkbox");t.removeClass("unchecked");t.addClass("checked");r.checkbox();r.checkbox("check");q.checked=!0}},removeMenuItems:function(){$this=this;$this.items=[];$("#RulesFilterContext ul").children().remove()},showContextMenuAt:function(n){this.clearTimers();this.timers[this.timers.length]=setTimeout(this.attachEvents.bind(this));$(this.element).on("mouseout.checkboxcontextmenu",this.applyHideTimer.bind(this));$(this.element).on("mouseover.checkboxcontextmenu",this.clearTimers.bind(this));this.bindHideEvents();var q,t,r,u;q=n.x;t=n.y;r=$(window).scrollLeft()+$(window).width();u=$(window).scrollTop()+$(window).height();r-=this.element.width();u-=this.element.height();q>r&&(q-=this.element.width());t=Math.max(0,Math.min(t,u));t-=7;this.element.css({left:q+"px",top:t+"px",visibility:"visible",display:""});this.dropShadowElement!==null&&this.dropShadowElement.css({left:q+3+"px",top:t+3+"px",width:this.element.width(),height:this.element.heigth(),visibility:"visible"});SourceCode.Forms.Widget.createUnderlay(this.element);this.applyHideTimer(n.event)},hideContextMenu:function(){this.clearTimers();this.closeMenu();this.element.attr("visited","true");this.hasChanged&&(this.options.close&&this.options.close(),this.hasChanged=!1);$("body").off("click.checkboxcontextmenu");$(this.element).off("mouseout.checkboxcontextmenu");$(this.element).off("mouseover.checkboxcontextmenu");$("#fdrwRulesFilterBtn").hasClass("menu-active")&&$("#fdrwRulesFilterBtn").removeClass("menu-active");$("#vdrwRulesFilterBtn").hasClass("menu-active")&&$("#vdrwRulesFilterBtn").removeClass("menu-active");SourceCode.Forms.Widget.destroyUnderlay(this.element)},bindHideEvents:function(){var n=this.hideContextMenu.bind(this);$("#viewActionsListTable").off("click.contextMenuHide").on("click.contextMenuHide",n);$("#pgWizard_pgRulesStep").off("click.contextMenuHide").on("click.contextMenuHide",n);$("#pgRuleList .grid-body *").off("click.contextMenuHide").on("click.contextMenuHide",n);$("#pgRuleList .grid-header *").off("click.contextMenuHide").on("click.contextMenuHide",n);$("#pgRuleList .grid-toolbars").off("click.contextMenuHide").on("click.contextMenuHide",n);$("#pgRuleList").find(".grid-content-cell-wrapper").off("click.contextMenuHide").on("click.contextMenuHide",n);$("#rgAddRule").off("click.contextMenuHide").on("click.contextMenuHide",n);$("body").find(".steptree").off("click.steptree","li",n).on("click.steptree","li",n)},applyCheck:function(n){n&&n!==undefined&&($(n.target).hasClass("menu")||$(n.target).closest(".menu").length>0)||(this.dropShadowElement!==null&&this.dropShadowElement.css("visibility","hidden"),this.bindHideEvents())},applyHideTimer:function(n){var t=this;this.timers[this.timers.length]=setTimeout(function(){t.hideContextMenu(n)},1500)},afterMenuItemClick:function(){}};$.extend(FilterCheckBoxContextMenu.prototype,_MenuPrototype,_FilterCheckBoxContextMenuPrototype);var FilterCheckMenuItem=function(n){this.initialize(n)},_FilterCheckMenuItemPrototype={options:{id:"",text:"",description:"",icon:"",location:"",target:"",hideURIs:!1,onClick:null,checkbox:null,enabled:!0},initialize:function(n){this.options=$.extend({},this.options,n);this.element=null;this.control=this.options.control;this.target=this.options.target;this.id=this.options.id;this.text=this.options.text;this.description=this.options.description;this.icon=this.options.icon;this.location=this.options.location;this.hideURIs=this.options.hideURIs;this.checked=this.options.checked;this.enabled=this.options.enabled;this.subMenu=null;$chk(this.options.element)?this._adopt(this.options.element):this._build();$(this.element.children()[0]).on("click.checkmenu-item",function(n){this._click(n)}.bind(this));$(this.element.children()[0]).on("mouseover.checkmenu-item",function(n){this.menuItemMouseOver(n)}.bind(this))},_build:function(){this.element=$("<li><\/li>");var n="RulesFilterSearchScope_"+this.id;this.enabled?this.element.html('<a class="checkmenu-item" href="javascript:;"><label class="input-control checkbox'+(this.checked?" checked":"")+'" id="'+n+'"><INPUT class="input-control" value="'+this.id+'" type="checkbox" name="RulesFilterSearchScope"'+(this.checked?' checked="checked"':"")+' /><SPAN class="input-control-img"><\/SPAN><SPAN class="input-control-text" style="margin-left: 10px;">'+(typeof this.text=="string"?this.text.htmlEncode():this.text)+"<\/SPAN><\/label><\/a>"):(this.element.addClass("disabled"),this.element.html('<a disabled="disabled" class="checkmenu-item" href="javascript:;"><label class="input-control checkbox'+(this.checked?" checked":"")+'" id="'+n+'"><INPUT class="input-control" value="'+this.id+'" type="checkbox" name="RulesFilterSearchScope"'+(this.checked?' checked="checked"':"")+' /><SPAN class="input-control-img"><\/SPAN><SPAN class="input-control-text" style="margin-left: 10px;">'+(typeof this.text=="string"?this.text.htmlEncode():this.text)+"<\/SPAN><\/label><\/a>"));$chk(this.control.element)&&$(this.control.element.children()[0]).append(this.element);$chk(this.id)&&this.id!==""&&(this.element.children()[0].id=this.id);$chk(this.location)&&this.location!==""&&$(this.element.children()[0]).attr("href",this.location);$chk(this.target)&&this.target!==""?$(this.element.children()[0]).attr("target",this.target):$chk(this.control.target)&&this.control.target!==""&&$(this.element.children()[0]).attr("target",this.control.target);$chk(this.description)&&this.description!==""&&$(this.element.children()[0]).attr("title",this.options.description)},_adopt:function(n){if(n=$type(n)==="string"?$("#"+n):n.jquery?n:$(n),n[0].tagName!=="li")return null;this.element=n;this.element.children()[0].id!==""&&(this.id=this.element.children()[0].id);$(this.element.children()[0]).attr("href")!=="javascript:;"&&(this.location=$(this.element.children()[0]).attr("href"));$(this.element.children()[0]).attr("target")!==""&&(this.target=$(this.element.children()[0]).attr("target"));$(this.element.children()[0]).attr("title")!==""&&(this.description=$(this.element.children()[0]).attr("title"))},_click:function(n){var q=this;if(n.preventDefault(),!$(this.element).is(".disabled")){this.options.onClick&&this.options.onClick();for(var r=this.control;r.control;)r=r.control;var t=$("label[id=RulesFilterSearchScope_"+q.id+"]"),u=t.find(":checkbox");u.is(":checked")?(t.removeClass("checked"),t.addClass("unchecked"),u.checkbox("uncheck"),q.checked=!1):(t.removeClass("unchecked"),t.addClass("checked"),u.checkbox("check"),q.checked=!0)}},menuItemMouseOver:function(n){if(this.subMenu!==null){var t,q,r,u;n=new Event(n);this.activeItem!==null&&this.control.closeSubMenu();this.activeItem=this;$(this.element.children()[0]).addClass("active");t=$(this.element.children()[0]).offset().left+$(this.element.children()[0]).width();q=$(this.element.children()[0]).offset().top;r=$(window).scrollLeft()+$(window).width();u=$(window).scrollTop()+$(window).height();r-=this.subMenu.element.width();u-=this.subMenu.element.height();t>r&&(t=Math.max(0,t-$(this.element.children()[0]).width()-this.subMenu.element.width()+(this.control.element.width()-$(this.element.children()[0]).width())));q=Math.max(0,Math.min(q,u));window.ie&&(t-=2);this.subMenu.element.css({left:t+"px",top:q+"px",visibility:"visible"});this.subMenu.dropShadowElement!==null&&this.subMenu.dropShadowElement.css({left:t+4+"px",top:q+4+"px",width:this.subMenu.element.width(),height:this.subMenu.element.height(),visibility:"visible"})}},addSubMenu:function(n){var t=new Menu($merge(n,{control:this,dropshadow:this.control.dropshadow,target:this.target}));return t!==null&&(this.subMenu=t,$(this.element.children()[0]).addClass("children")),t}};$.extend(FilterCheckMenuItem.prototype,_FilterCheckMenuItemPrototype);
/*!
 ~/Script/rangy-core.js
*/
(function(n,t){typeof define=="function"&&define.amd?define(n):typeof module!="undefined"&&typeof exports=="object"?module.exports=n():t.rangy=n()})(function(){var d="object",ht="function",f="undefined",ct=["startContainer","startOffset","endContainer","endOffset","collapsed","commonAncestorContainer"],lt=["setStart","setStartBefore","setStartAfter","setEnd","setEndBefore","setEndAfter","collapse","selectNode","selectNodeContents","compareBoundaryPoints","deleteContents","extractContents","cloneContents","insertNode","surroundContents","cloneRange","toString","detach"],at=["boundingHeight","boundingLeft","boundingTop","boundingWidth","htmlText","text"],vt=["collapse","compareEndPoints","duplicate","moveToElementText","parentElement","select","setEndPoint","getBoundingClientRect"];function t(n,t){var q=typeof n[t];return q==ht||!!(q==d&&n[t])||q=="unknown"}function l(n,t){return!!(typeof n[t]==d&&n[t])}function g(n,t){return typeof n[t]!=f}function a(n){return function(t,q){for(var r=q.length;r--;)if(!n(t,q[r]))return!1;return!0}}var v=a(t),yt=a(l),y=a(g);function nt(n){return n&&v(n,vt)&&y(n,at)}function tt(n){return l(n,"body")?n.body:n.getElementsByTagName("body")[0]}var pt=[].forEach?function(n,t){n.forEach(t)}:function(n,t){for(var q=0,r=n.length;q<r;++q)t(n[q],q)},e={},q=typeof window!=f&&typeof document!=f,r={isHostMethod:t,isHostObject:l,isHostProperty:g,areHostMethods:v,areHostObjects:yt,areHostProperties:y,isTextRange:nt,getBody:tt,forEach:pt},n={version:"1.3.1",initialized:!1,isBrowser:q,supported:!0,util:r,features:{},modules:e,config:{alertOnFail:!1,alertOnWarn:!1,preferTextRange:!1,autoInitialize:typeof rangyAutoInitialize==f?!0:rangyAutoInitialize}};function o(n){typeof console!=f&&t(console,"log")&&console.log(n)}function qt(n,t){q&&t?alert(n):o(n)}function u(t){n.initialized=!0;n.supported=!1;qt("Rangy is not supported in this environment. Reason: "+t,n.config.alertOnFail)}n.fail=u;function wt(t){qt("Rangy warning: "+t,n.config.alertOnWarn)}n.warn=wt;var s;({}).hasOwnProperty?(r.extend=s=function(n,t,q){var u,r;for(var f in t)t.hasOwnProperty(f)&&(u=n[f],r=t[f],q&&u!==null&&typeof u=="object"&&r!==null&&typeof r=="object"&&s(u,r,!0),n[f]=r);return t.hasOwnProperty("toString")&&(n.toString=t.toString),n},r.createOptions=function(n,t){var q={};return s(q,t),n&&s(q,n),q}):u("hasOwnProperty not supported");q||u("Rangy can only run in a browser"),function(){var n;if(q){var t=document.createElement("div");t.appendChild(document.createElement("span"));var u=[].slice;try{u.call(t.childNodes,0)[0].nodeType==1&&(n=function(n){return u.call(n,0)})}catch(f){}}n||(n=function(n){for(var q=[],t=0,r=n.length;t<r;++t)q[t]=n[t];return q});r.toArray=n}();var h;q&&(t(document,"addEventListener")?h=function(n,t,q){n.addEventListener(t,q,!1)}:t(document,"attachEvent")?h=function(n,t,q){n.attachEvent("on"+t,q)}:u("Document does not have required addEventListener or attachEvent method"),r.addListener=h);var p=[];function rt(n){return n.message||n.description||String(n)}function w(){if(q&&!n.initialized){var r,s=!1,h=!1;t(document,"createRange")&&(r=document.createRange(),v(r,lt)&&y(r,ct)&&(s=!0));var f=tt(document);if(!f||f.nodeName.toLowerCase()!="body"){u("No body element found");return}if(f&&t(f,"createTextRange")&&(r=f.createTextRange(),nt(r)&&(h=!0)),!s&&!h){u("Neither Range nor TextRange are available");return}n.initialized=!0;n.features={implementsDomRange:s,implementsTextRange:h};var l,w;for(var b in e)(l=e[b])instanceof c&&l.init(l,n);for(var a=0,k=p.length;a<k;++a)try{p[a](n)}catch(d){w="Rangy init listener threw an exception. Continuing. Detail: "+rt(d);o(w)}}}function ut(t,q,r){r&&(t+=" in module "+r.name);n.warn("DEPRECATED: "+t+" is deprecated. Please use "+q+" instead.")}function ft(n,t,q,u){n[t]=function(){return ut(t,q,u),n[q].apply(n,r.toArray(arguments))}}r.deprecationNotice=ut;r.createAliasForDeprecatedMethod=ft;n.init=w;n.addInitListener=function(t){n.initialized?t(n):p.push(t)};var b=[];n.addShimListener=function(n){b.push(n)};function bt(n){n=n||window;w();for(var t=0,q=b.length;t<q;++t)b[t](n)}q&&(n.shim=n.createMissingNativeApi=bt,ft(n,"createMissingNativeApi","shim"));function c(n,t,q){this.name=n;this.dependencies=t;this.initialized=!1;this.supported=!1;this.initializer=q}c.prototype={init:function(){for(var r=this.dependencies||[],q=0,u=r.length,n,t;q<u;++q){if(t=r[q],n=e[t],!n||!(n instanceof c))throw new Error("required module '"+t+"' not found");if(n.init(),!n.supported)throw new Error("required module '"+t+"' not supported");}this.initializer(this)},fail:function(n){this.initialized=!0;this.supported=!1;throw new Error(n);},warn:function(t){n.warn("Module "+this.name+": "+t)},deprecationNotice:function(t,q){n.warn("DEPRECATED: "+t+" in module "+this.name+" is deprecated. Please use "+q+" instead")},createError:function(n){return new Error("Error in Rangy "+this.name+" module: "+n)}};function et(t,q,r){var u=new c(t,q,function(q){if(!q.initialized){q.initialized=!0;try{r(n,q);q.supported=!0}catch(u){var f="Module '"+t+"' failed to load: "+rt(u);o(f);u.stack&&o(u.stack)}}});return e[t]=u,u}n.createModule=function(t){var q,r;arguments.length==2?(q=arguments[1],r=[]):(q=arguments[2],r=arguments[1]);var u=et(t,r,q);n.initialized&&n.supported&&u.init()};n.createCoreModule=function(n,t,q){et(n,t,q)};function ot(){}n.RangePrototype=ot;n.rangePrototype=new ot;function kt(){}n.selectionPrototype=new kt;n.createCoreModule("DomUtil",[],function(n,t){var r="undefined",q=n.util,a=q.getBody;q.areHostMethods(document,["createDocumentFragment","createElement","createTextNode"])||t.fail("document missing a Node creation method");q.isHostMethod(document,"getElementsByTagName")||t.fail("document missing getElementsByTagName method");var o=document.createElement("div");q.areHostMethods(o,["insertBefore","appendChild","cloneNode"]||!q.areHostObjects(o,["previousSibling","nextSibling","childNodes","parentNode"]))||t.fail("Incomplete Element implementation");q.isHostProperty(o,"innerHTML")||t.fail("Element is missing innerHTML property");var v=document.createTextNode("test");q.areHostMethods(v,["splitText","deleteData","insertData","appendData","cloneNode"]||!q.areHostObjects(o,["previousSibling","nextSibling","childNodes","parentNode"])||!q.areHostProperties(v,["data"]))||t.fail("Incomplete Text Node implementation");var y=function(n,t){for(var q=n.length;q--;)if(n[q]===t)return!0;return!1};function ut(n){var t;return typeof n.namespaceURI==r||(t=n.namespaceURI)===null||t=="http://www.w3.org/1999/xhtml"}function ft(n){var t=n.parentNode;return t.nodeType==1?t:null}function u(n){for(var t=0;n=n.previousSibling;)++t;return t}function et(n){switch(n.nodeType){case 7:case 10:return 0;case 3:case 8:return n.length;default:return n.childNodes.length}}function p(n,t){for(var r=[],q=n;q;q=q.parentNode)r.push(q);for(q=t;q;q=q.parentNode)if(y(r,q))return q;return null}function w(n,t,q){for(var r=q?t:t.parentNode;r;){if(r===n)return!0;r=r.parentNode}return!1}function ot(n,t){return w(n,t,!0)}function f(n,t,q){for(var u,r=q?n:n.parentNode;r;){if(u=r.parentNode,u===t)return r;r=u}return null}function b(n){var t=n.nodeType;return t==3||t==4||t==8}function st(n){if(!n)return!1;var t=n.nodeType;return t==3||t==8}function k(n,t){var q=t.nextSibling,r=t.parentNode;return q?r.insertBefore(n,q):r.appendChild(n),n}function ht(n,t,q){var f=n.cloneNode(!1);if(f.deleteData(0,t),n.deleteData(t,n.length-t),k(f,n),q)for(var e=0,r;r=q[e++];)r.node==n&&r.offset>t?(r.node=f,r.offset-=t):r.node==n.parentNode&&r.offset>u(n)&&++r.offset;return f}function e(n){if(n.nodeType==9)return n;if(typeof n.ownerDocument!=r)return n.ownerDocument;if(typeof n.document!=r)return n.document;if(n.parentNode)return e(n.parentNode);throw t.createError("getDocument: no document found for node");}function d(n){var q=e(n);if(typeof q.defaultView!=r)return q.defaultView;if(typeof q.parentWindow!=r)return q.parentWindow;throw t.createError("Cannot get a window object for node");}function g(n){if(typeof n.contentDocument!=r)return n.contentDocument;if(typeof n.contentWindow!=r)return n.contentWindow.document;throw t.createError("getIframeDocument: No Document object found for iframe element");}function ct(n){if(typeof n.contentWindow!=r)return n.contentWindow;if(typeof n.contentDocument!=r)return n.contentDocument.defaultView;throw t.createError("getIframeWindow: No Window object found for iframe element");}function nt(n){return n&&q.isHostMethod(n,"setTimeout")&&q.isHostObject(n,"document")}function lt(n,t,r){var u;if(n?q.isHostProperty(n,"nodeType")?u=n.nodeType==1&&n.tagName.toLowerCase()=="iframe"?g(n):e(n):nt(n)&&(u=n.document):u=document,!u)throw t.createError(r+"(): Parameter must be a Window object or DOM node");return u}function at(n){for(var t;t=n.parentNode;)n=t;return n}function vt(n,q,r,e){var h,o,c,l,s;if(n==r)return q===e?0:q<e?-1:1;if(h=f(r,n,!0))return q<=u(h)?-1:1;if(h=f(n,r,!0))return u(h)<e?-1:1;if(o=p(n,r),!o)throw new Error("comparePoints error: nodes have no common ancestor");if(c=n===o?o:f(n,o,!0),l=r===o?o:f(r,o,!0),c===l)throw t.createError("comparePoints got to case 4 and childA and childB are the same!");else for(s=o.firstChild;s;){if(s===c)return-1;if(s===l)return 1;s=s.nextSibling}}var s=!1;function h(n){var t;try{return t=n.parentNode,!1}catch(q){return!0}}(function(){var t=document.createElement("b");t.innerHTML="1";var q=t.firstChild;t.innerHTML="<br />";s=h(q);n.features.crashyTextNodes=s})();function tt(n){if(!n)return"[No node]";if(s&&h(n))return"[Broken node]";if(b(n))return'"'+n.data+'"';if(n.nodeType==1){var t=n.id?' id="'+n.id+'"':"";return"<"+n.nodeName+t+">[index:"+u(n)+",length:"+n.childNodes.length+"]["+(n.innerHTML||"[innerHTML not supported]").slice(0,25)+"]"}return n.nodeName}function yt(n){for(var t=e(n).createDocumentFragment(),q;q=n.firstChild;)t.appendChild(q);return t}var c;typeof getComputedStyle!=r?c=function(n,t){return d(n).getComputedStyle(n,null)[t]}:typeof document.documentElement.currentStyle!=r?c=function(n,t){return n.currentStyle?n.currentStyle[t]:""}:t.fail("No means of obtaining computed style properties found");function pt(n,t,q){var u=a(n),r=n.createElement("div");r.contentEditable=""+!!q;t&&(r.innerHTML=t);var f=u.firstChild;return f?u.insertBefore(r,f):u.appendChild(r),r}function wt(n){return n.parentNode.removeChild(n)}function qt(n){this.root=n;this._next=n}qt.prototype={_current:null,hasNext:function(){return!!this._next},next:function(){var n=this._current=this._next,t,q;if(this._current)if(t=n.firstChild,t)this._next=t;else{for(q=null;n!==this.root&&!(q=n.nextSibling);)n=n.parentNode;this._next=q}return this._current},detach:function(){this._current=this._next=this.root=null}};function bt(n){return new qt(n)}function rt(n,t){this.node=n;this.offset=t}rt.prototype={equals:function(n){return!!n&&this.node===n.node&&this.offset==n.offset},inspect:function(){return"[DomPosition("+tt(this.node)+":"+this.offset+")]"},toString:function(){return this.inspect()}};function l(n){this.code=this[n];this.codeName=n;this.message="DOMException: "+this.codeName}l.prototype={INDEX_SIZE_ERR:1,HIERARCHY_REQUEST_ERR:3,WRONG_DOCUMENT_ERR:4,NO_MODIFICATION_ALLOWED_ERR:7,NOT_FOUND_ERR:8,NOT_SUPPORTED_ERR:9,INVALID_STATE_ERR:11,INVALID_NODE_TYPE_ERR:24};l.prototype.toString=function(){return this.message};n.dom={arrayContains:y,isHtmlNamespace:ut,parentElement:ft,getNodeIndex:u,getNodeLength:et,getCommonAncestor:p,isAncestorOf:w,isOrIsAncestorOf:ot,getClosestAncestorIn:f,isCharacterDataNode:b,isTextOrCommentNode:st,insertAfter:k,splitDataNode:ht,getDocument:e,getWindow:d,getIframeWindow:ct,getIframeDocument:g,getBody:a,isWindow:nt,getContentDocument:lt,getRootContainer:at,comparePoints:vt,isBrokenNode:h,inspectNode:tt,getComputedStyleProperty:c,createTestElement:pt,removeNode:wt,fragmentFromNodeChildren:yt,createIterator:bt,DomPosition:rt};n.DOMException=l});n.createCoreModule("DomRange",["DomUtil"],function(n){var t=n.dom,g=n.util,lt=t.DomPosition,f=n.DOMException,r=t.isCharacterDataNode,c=t.getNodeIndex,v=t.isOrIsAncestorOf,nt=t.getDocument,u=t.comparePoints,tt=t.splitDataNode,qt=t.getClosestAncestorIn,rt=t.getNodeLength,at=t.arrayContains,o=t.getRootContainer,wq=n.features.crashyTextNodes,y=t.removeNode;function p(n,t){return n.nodeType!=3&&(v(n,t.startContainer)||v(n,t.endContainer))}function e(n){return n.document||nt(n.startContainer)}function bq(n){return o(n.startContainer)}function vt(n){return new lt(n.parentNode,c(n))}function ut(n){return new lt(n.parentNode,c(n)+1)}function yt(n,q,u){var f=n.nodeType==11?n.firstChild:n;return r(q)?u==q.length?t.insertAfter(n,q):q.parentNode.insertBefore(n,u==0?q:tt(q,u)):u>=q.childNodes.length?q.appendChild(n):q.insertBefore(n,q.childNodes[u]),f}function pt(n,t,r){if(q(n),q(t),e(t)!=e(n))throw new f("WRONG_DOCUMENT_ERR");var o=u(n.startContainer,n.startOffset,t.endContainer,t.endOffset),s=u(n.endContainer,n.endOffset,t.startContainer,t.startOffset);return r?o<=0&&s>=0:o<0&&s>0}function wt(n){for(var q,t,u=e(n.range).createDocumentFragment(),r;t=n.next();){if(q=n.isPartiallySelectedSubtree(),t=t.cloneNode(!q),q&&(r=n.getSubtreeIterator(),t.appendChild(wt(r)),r.detach()),t.nodeType==10)throw new f("HIERARCHY_REQUEST_ERR");u.appendChild(t)}return u}function k(n,q,r){var e,o;r=r||{stop:!1};for(var u,f;u=n.next();)if(n.isPartiallySelectedSubtree()){if(q(u)===!1){r.stop=!0;return}if(f=n.getSubtreeIterator(),k(f,q,r),f.detach(),r.stop)return}else for(e=t.createIterator(u);o=e.next();)if(q(o)===!1){r.stop=!0;return}}function bt(n){for(var t;n.next();)n.isPartiallySelectedSubtree()?(t=n.getSubtreeIterator(),bt(t),t.detach()):n.remove()}function kt(n){for(var t,r=e(n.range).createDocumentFragment(),q;t=n.next();){if(n.isPartiallySelectedSubtree()?(t=t.cloneNode(!1),q=n.getSubtreeIterator(),t.appendChild(kt(q)),q.detach()):n.remove(),t.nodeType==10)throw new f("HIERARCHY_REQUEST_ERR");r.appendChild(t)}return r}function kq(n,t,q){var u=!!(t&&t.length),f,o=!!q;u&&(f=new RegExp("^("+t.join("|")+")$"));var e=[];return k(new s(n,!1),function(t){if((!u||f.test(t.nodeType))&&(!o||q(t))){var s=n.startContainer;if(t!=s||!r(s)||n.startOffset!=s.length){var h=n.endContainer;t==h&&r(h)&&n.endOffset==0||e.push(t)}}}),e}function dt(n){var q=typeof n.getName=="undefined"?"Range":n.getName();return"["+q+"("+t.inspectNode(n.startContainer)+":"+n.startOffset+", "+t.inspectNode(n.endContainer)+":"+n.endOffset+")]"}function s(n,t){if(this.range=n,this.clonePartiallySelectedTextNodes=t,!n.collapsed){this.sc=n.startContainer;this.so=n.startOffset;this.ec=n.endContainer;this.eo=n.endOffset;var q=n.commonAncestorContainer;this.sc===this.ec&&r(this.sc)?(this.isSingleCharacterDataNode=!0,this._first=this._last=this._next=this.sc):(this._first=this._next=this.sc===q&&!r(this.sc)?this.sc.childNodes[this.so]:qt(this.sc,q,!0),this._last=this.ec===q&&!r(this.ec)?this.ec.childNodes[this.eo-1]:qt(this.ec,q,!0))}}s.prototype={_current:null,_next:null,_first:null,_last:null,isSingleCharacterDataNode:!1,reset:function(){this._current=null;this._next=this._first},hasNext:function(){return!!this._next},next:function(){var n=this._current=this._next;return n&&(this._next=n!==this._last?n.nextSibling:null,r(n)&&this.clonePartiallySelectedTextNodes&&(n===this.ec&&(n=n.cloneNode(!0)).deleteData(this.eo,n.length-this.eo),this._current===this.sc&&(n=n.cloneNode(!0)).deleteData(0,this.so))),n},remove:function(){var n=this._current,t,q;r(n)&&(n===this.sc||n===this.ec)?(t=n===this.sc?this.so:0,q=n===this.ec?this.eo:n.length,t!=q&&n.deleteData(t,q-t)):n.parentNode&&y(n)},isPartiallySelectedSubtree:function(){var n=this._current;return p(n,this.range)},getSubtreeIterator:function(){var n;if(this.isSingleCharacterDataNode)n=this.range.cloneRange(),n.collapse(!1);else{n=new a(e(this.range));var t=this._current,q=t,r=0,u=t,f=rt(t);v(t,this.sc)&&(q=this.sc,r=this.so);v(t,this.ec)&&(u=this.ec,f=this.eo);ct(n,q,r,u,f)}return new s(n,this.clonePartiallySelectedTextNodes)},detach:function(){this.range=this._current=this._next=this._first=this._last=this.sc=this.so=this.ec=this.eo=null}};var gt=[1,3,4,5,7,8,10],dq=[2,9,11],gq=[1,3,4,5,7,8,10,11],nr=[1,3,4,5,7,8];function d(n){return function(t,q){for(var u,r=q?t:t.parentNode;r;){if(u=r.nodeType,at(n,u))return r;r=r.parentNode}return null}}var nq=d([9,11]),tr=d([5,6,10,12]),qr=d([6,10,12]),rr=d([1]);function h(n,t){if(qr(n,t))throw new f("INVALID_NODE_TYPE_ERR");}function w(n,t){if(!at(t,n.nodeType))throw new f("INVALID_NODE_TYPE_ERR");}function b(n,t){if(t<0||t>(r(n)?n.length:n.childNodes.length))throw new f("INDEX_SIZE_ERR");}function ft(n,t){if(nq(n,!0)!==nq(t,!0))throw new f("WRONG_DOCUMENT_ERR");}function l(n){if(tr(n,!0))throw new f("NO_MODIFICATION_ALLOWED_ERR");}function tq(n,t){if(!n)throw new f(t);}function qq(n,t){return t<=(r(n)?n.length:n.childNodes.length)}function rq(n){return!!n.startContainer&&!!n.endContainer&&!(wq&&(t.isBrokenNode(n.startContainer)||t.isBrokenNode(n.endContainer)))&&o(n.startContainer)==o(n.endContainer)&&qq(n.startContainer,n.startOffset)&&qq(n.endContainer,n.endOffset)}function q(n){if(!rq(n))throw new Error("Range error: Range is not valid. This usually happens after DOM mutation. Range: ("+n.inspect()+")");}var uq=document.createElement("style"),et=!1;try{uq.innerHTML="<b>x<\/b>";et=uq.firstChild.nodeType==3}catch(or){}n.features.htmlParsingConforms=et;var ur=et?function(n){var u=this.startContainer,e=nt(u);if(!u)throw new f("INVALID_STATE_ERR");var q=null;return u.nodeType==1?q=u:r(u)&&(q=t.parentElement(u)),q=q===null||q.nodeName=="HTML"&&t.isHtmlNamespace(nt(q).documentElement)&&t.isHtmlNamespace(q)?e.createElement("body"):q.cloneNode(!1),q.innerHTML=n,t.fragmentFromNodeChildren(q)}:function(n){var r=e(this),q=r.createElement("body");return q.innerHTML=n,t.fragmentFromNodeChildren(q)};function fq(n,t){q(n);var u=n.startContainer,o=n.startOffset,f=n.endContainer,e=n.endOffset,s=u===f;r(f)&&e>0&&e<f.length&&tt(f,e,t);r(u)&&o>0&&o<u.length&&(u=tt(u,o,t),s?(e-=o,f=u):f==u.parentNode&&e>=c(u)&&e++,o=0);n.setStartAndEnd(u,o,f,e)}function eq(n){q(n);var t=n.commonAncestorContainer.parentNode.cloneNode(!1);return t.appendChild(n.cloneContents()),t.innerHTML}var ot=["startContainer","startOffset","endContainer","endOffset","collapsed","commonAncestorContainer"],st=0,oq=1,fr=2,sq=3,hq=0,cq=1,lq=2,ht=3;g.extend(n.rangePrototype,{compareBoundaryPoints:function(n,t){q(this);ft(this.startContainer,t.startContainer);var r,f,e,o,s=n==sq||n==st?"start":"end",h=n==oq||n==st?"start":"end";return r=this[s+"Container"],f=this[s+"Offset"],e=t[h+"Container"],o=t[h+"Offset"],u(r,f,e,o)},insertNode:function(n){if(q(this),w(n,gq),l(this.startContainer),v(n,this.startContainer))throw new f("HIERARCHY_REQUEST_ERR");var t=yt(n,this.startContainer,this.startOffset);this.setStartBefore(t)},cloneContents:function(){q(this);var n,t;if(this.collapsed)return e(this).createDocumentFragment();if(this.startContainer===this.endContainer&&r(this.startContainer))return n=this.startContainer.cloneNode(!0),n.data=n.data.slice(this.startOffset,this.endOffset),t=e(this).createDocumentFragment(),t.appendChild(n),t;var u=new s(this,!0);return n=wt(u),u.detach(),n},canSurroundContents:function(){q(this);l(this.startContainer);l(this.endContainer);var n=new s(this,!0),t=n._first&&p(n._first,this)||n._last&&p(n._last,this);return n.detach(),!t},surroundContents:function(n){if(w(n,nr),!this.canSurroundContents())throw new f("INVALID_STATE_ERR");var t=this.extractContents();if(n.hasChildNodes())while(n.lastChild)n.removeChild(n.lastChild);yt(n,this.startContainer,this.startOffset);n.appendChild(t);this.selectNode(n)},cloneRange:function(){q(this);for(var t=new a(e(this)),r=ot.length,n;r--;)n=ot[r],t[n]=this[n];return t},toString:function(){q(this);var n=this.startContainer;if(n===this.endContainer&&r(n))return n.nodeType==3||n.nodeType==4?n.data.slice(this.startOffset,this.endOffset):"";var t=[],u=new s(this,!0);return k(u,function(n){(n.nodeType==3||n.nodeType==4)&&t.push(n.data)}),u.detach(),t.join("")},compareNode:function(n){q(this);var t=n.parentNode,r=c(n);if(!t)throw new f("NOT_FOUND_ERR");var e=this.comparePoint(t,r),u=this.comparePoint(t,r+1);return e<0?u>0?lq:hq:u>0?cq:ht},comparePoint:function(n,t){return(q(this),tq(n,"HIERARCHY_REQUEST_ERR"),ft(n,this.startContainer),u(n,t,this.startContainer,this.startOffset)<0)?-1:u(n,t,this.endContainer,this.endOffset)>0?1:0},createContextualFragment:ur,toHtml:function(){return eq(this)},intersectsNode:function(n,t){if(q(this),o(n)!=bq(this))return!1;var r=n.parentNode,f=c(n);if(!r)return!0;var e=u(r,f,this.endContainer,this.endOffset),s=u(r,f+1,this.startContainer,this.startOffset);return t?e<=0&&s>=0:e<0&&s>0},isPointInRange:function(n,t){return q(this),tq(n,"HIERARCHY_REQUEST_ERR"),ft(n,this.startContainer),u(n,t,this.startContainer,this.startOffset)>=0&&u(n,t,this.endContainer,this.endOffset)<=0},intersectsRange:function(n){return pt(this,n,!1)},intersectsOrTouchesRange:function(n){return pt(this,n,!0)},intersection:function(n){if(this.intersectsRange(n)){var q=u(this.startContainer,this.startOffset,n.startContainer,n.startOffset),r=u(this.endContainer,this.endOffset,n.endContainer,n.endOffset),t=this.cloneRange();return q==-1&&t.setStart(n.startContainer,n.startOffset),r==1&&t.setEnd(n.endContainer,n.endOffset),t}return null},union:function(n){if(this.intersectsOrTouchesRange(n)){var t=this.cloneRange();return u(n.startContainer,n.startOffset,this.startContainer,this.startOffset)==-1&&t.setStart(n.startContainer,n.startOffset),u(n.endContainer,n.endOffset,this.endContainer,this.endOffset)==1&&t.setEnd(n.endContainer,n.endOffset),t}throw new f("Ranges do not intersect");},containsNode:function(n,t){return t?this.intersectsNode(n,!1):this.compareNode(n)==ht},containsNodeContents:function(n){return this.comparePoint(n,0)>=0&&this.comparePoint(n,rt(n))<=0},containsRange:function(n){var t=this.intersection(n);return t!==null&&n.equals(t)},containsNodeText:function(n){var t=this.cloneRange();t.selectNode(n);var q=t.getNodes([3]);if(q.length>0){t.setStart(q[0],0);var r=q.pop();return t.setEnd(r,r.length),this.containsRange(t)}return this.containsNodeContents(n)},getNodes:function(n,t){return q(this),kq(this,n,t)},getDocument:function(){return e(this)},collapseBefore:function(n){this.setEndBefore(n);this.collapse(!1)},collapseAfter:function(n){this.setStartAfter(n);this.collapse(!0)},getBookmark:function(q){var o=e(this),r=n.createRange(o);q=q||t.getBody(o);r.selectNodeContents(q);var u=this.intersection(r),f=0,s=0;return u&&(r.setEnd(u.startContainer,u.startOffset),f=r.toString().length,s=f+u.toString().length),{start:f,end:s,containerNode:q}},moveToBookmark:function(n){var o=n.containerNode,t=0;this.setStart(o,0);this.collapse(!0);for(var s=[o],q,u=!1,h=!1,r,f,e;!h&&(q=s.pop());)if(q.nodeType==3)r=t+q.length,!u&&n.start>=t&&n.start<=r&&(this.setStart(q,n.start-t),u=!0),u&&n.end>=t&&n.end<=r&&(this.setEnd(q,n.end-t),h=!0),t=r;else for(e=q.childNodes,f=e.length;f--;)s.push(e[f])},getName:function(){return"DomRange"},equals:function(n){return a.rangesEqual(this,n)},isValid:function(){return rq(this)},inspect:function(){return dt(this)},detach:function(){}});function aq(n){n.START_TO_START=st;n.START_TO_END=oq;n.END_TO_END=fr;n.END_TO_START=sq;n.NODE_BEFORE=hq;n.NODE_AFTER=cq;n.NODE_BEFORE_AND_AFTER=lq;n.NODE_INSIDE=ht}function vq(n){aq(n);aq(n.prototype)}function yq(n,t){return function(){q(this);var r=this.startContainer,f=this.startOffset,o=this.commonAncestorContainer,u=new s(this,!0),h,e;r!==o&&(h=qt(r,o,!0),e=ut(h),r=e.node,f=e.offset);k(u,l);u.reset();var c=n(u);return u.detach(),t(this,r,f,r,f),c}}function pq(t,f){function e(n,t){return function(q){w(q,gt);w(o(q),dq);var r=(n?vt:ut)(q);(t?a:v)(this,r.node,r.offset)}}function a(n,t,q){var r=n.endContainer,e=n.endOffset;(t!==n.startContainer||q!==n.startOffset)&&((o(t)!=o(r)||u(t,q,r,e)==1)&&(r=t,e=q),f(n,t,q,r,e))}function v(n,t,q){var r=n.startContainer,e=n.startOffset;(t!==n.endContainer||q!==n.endOffset)&&((o(t)!=o(r)||u(t,q,r,e)==-1)&&(r=t,e=q),f(n,r,e,t,q))}var k=function(){};k.prototype=n.rangePrototype;t.prototype=new k;g.extend(t.prototype,{setStart:function(n,t){h(n,!0);b(n,t);a(this,n,t)},setEnd:function(n,t){h(n,!0);b(n,t);v(this,n,t)},setStartAndEnd:function(){var n=arguments,t=n[0],u=n[1],q=t,r=u;switch(n.length){case 3:r=n[2];break;case 4:q=n[2];r=n[3]}h(t,!0);b(t,u);h(q,!0);b(q,r);f(this,t,u,q,r)},setBoundary:function(n,t,q){this["set"+(q?"Start":"End")](n,t)},setStartBefore:e(!0,!0),setStartAfter:e(!1,!0),setEndBefore:e(!0,!1),setEndAfter:e(!1,!1),collapse:function(n){q(this);n?f(this,this.startContainer,this.startOffset,this.startContainer,this.startOffset):f(this,this.endContainer,this.endOffset,this.endContainer,this.endOffset)},selectNodeContents:function(n){h(n,!0);f(this,n,0,n,rt(n))},selectNode:function(n){h(n,!1);w(n,gt);var t=vt(n),q=ut(n);f(this,t.node,t.offset,q.node,q.offset)},extractContents:yq(kt,f),deleteContents:yq(bt,f),canSurroundContents:function(){q(this);l(this.startContainer);l(this.endContainer);var n=new s(this,!0),t=n._first&&p(n._first,this)||n._last&&p(n._last,this);return n.detach(),!t},splitBoundaries:function(){fq(this)},splitBoundariesPreservingPositions:function(n){fq(this,n)},normalizeBoundaries:function(){q(this);var t=this.startContainer,o=this.startOffset,n=this.endContainer,u=this.endOffset,a=function(t){var q=t.nextSibling;q&&q.nodeType==t.nodeType&&(n=t,u=t.length,t.appendData(q.data),y(q))},v=function(q){var r=q.previousSibling;if(r&&r.nodeType==q.nodeType){t=q;var e=q.length;if(o=r.length,q.insertData(0,r.data),y(r),t==n)u+=o,n=t;else if(n==q.parentNode){var f=c(q);u==f?(n=q,u=e):u>f&&u--}}},s=!0,e;if(r(n))u==n.length?a(n):u==0&&(e=n.previousSibling,e&&e.nodeType==n.nodeType&&(u=e.length,t==n&&(s=!1),e.appendData(n.data),y(n),n=e));else{if(u>0){var h=n.childNodes[u-1];h&&r(h)&&a(h)}s=!this.collapsed}if(s){if(r(t))o==0?v(t):o==t.length&&(e=t.nextSibling,e&&e.nodeType==t.nodeType&&(n==e&&(n=t,u+=t.length),t.appendData(e.data),y(e)));else if(o<t.childNodes.length){var l=t.childNodes[o];l&&r(l)&&v(l)}}else t=n,o=u;f(this,t,o,n,u)},collapseToPoint:function(n,t){h(n,!0);b(n,t);this.setStartAndEnd(n,t)},parentElement:function(){q(this);var n=this.commonAncestorContainer;return n?rr(this.commonAncestorContainer,!0):null}});vq(t)}function er(n){n.collapsed=n.startContainer===n.endContainer&&n.startOffset===n.endOffset;n.commonAncestorContainer=n.collapsed?n.startContainer:t.getCommonAncestor(n.startContainer,n.endContainer)}function ct(n,q,r,u,f){n.startContainer=q;n.startOffset=r;n.endContainer=u;n.endOffset=f;n.document=t.getDocument(q);er(n)}function a(n){ct(this,n,0,n,0)}pq(a,ct);g.extend(a,{rangeProperties:ot,RangeIterator:s,copyComparisonConstants:vq,createPrototypeRange:pq,inspect:dt,toHtml:eq,getRangeDocument:e,rangesEqual:function(n,t){return n.startContainer===t.startContainer&&n.startOffset===t.startOffset&&n.endContainer===t.endContainer&&n.endOffset===t.endOffset}});n.DomRange=a});n.createCoreModule("WrappedRange",["DomRange"],function(n,t){var o,r,q=n.dom,c=n.util,u=q.DomPosition,f=n.DomRange,e=q.getBody,s=q.getContentDocument,h=q.isCharacterDataNode;if(n.features.implementsDomRange&&function(){var r,b=f.rangeProperties;function u(n){for(var q=b.length,t;q--;)t=b[q],n[t]=n.nativeRange[t];n.collapsed=n.startContainer===n.endContainer&&n.startOffset===n.endOffset}function k(n,t,q,r,u){var f=n.startContainer!==t||n.startOffset!=q,e=n.endContainer!==r||n.endOffset!=u,o=!n.equals(n.nativeRange);(f||e||o)&&(n.setEnd(r,u),n.setStart(t,q))}var a;o=function(n){if(!n)throw t.createError("WrappedRange: Range must be specified");this.nativeRange=n;u(this)};f.createPrototypeRange(o,k);r=o.prototype;r.selectNode=function(n){this.nativeRange.selectNode(n);u(this)};r.cloneContents=function(){return this.nativeRange.cloneContents()};r.surroundContents=function(n){this.nativeRange.surroundContents(n);u(this)};r.collapse=function(n){this.nativeRange.collapse(n);u(this)};r.cloneRange=function(){return new o(this.nativeRange.cloneRange())};r.refresh=function(){u(this)};r.toString=function(){return this.nativeRange.toString()};var l=document.createTextNode("test");e(document).appendChild(l);var h=document.createRange();h.setStart(l,0);h.setEnd(l,0);try{h.setStart(l,1);r.setStart=function(n,t){this.nativeRange.setStart(n,t);u(this)};r.setEnd=function(n,t){this.nativeRange.setEnd(n,t);u(this)};a=function(n){return function(t){this.nativeRange[n](t);u(this)}}}catch(d){r.setStart=function(n,t){try{this.nativeRange.setStart(n,t)}catch(q){this.nativeRange.setEnd(n,t);this.nativeRange.setStart(n,t)}u(this)};r.setEnd=function(n,t){try{this.nativeRange.setEnd(n,t)}catch(q){this.nativeRange.setStart(n,t);this.nativeRange.setEnd(n,t)}u(this)};a=function(n,t){return function(q){try{this.nativeRange[n](q)}catch(r){this.nativeRange[t](q);this.nativeRange[n](q)}u(this)}}}r.setStartBefore=a("setStartBefore","setEndBefore");r.setStartAfter=a("setStartAfter","setEndAfter");r.setEndBefore=a("setEndBefore","setStartBefore");r.setEndAfter=a("setEndAfter","setStartAfter");r.selectNodeContents=function(n){this.setStartAndEnd(n,0,q.getNodeLength(n))};h.selectNodeContents(l);h.setEnd(l,3);var v=document.createRange();v.selectNodeContents(l);v.setEnd(l,4);v.setStart(l,2);r.compareBoundaryPoints=h.compareBoundaryPoints(h.START_TO_END,v)==-1&&h.compareBoundaryPoints(h.END_TO_START,v)==1?function(n,t){return t=t.nativeRange||t,n==t.START_TO_END?n=t.END_TO_START:n==t.END_TO_START&&(n=t.START_TO_END),this.nativeRange.compareBoundaryPoints(n,t)}:function(n,t){return this.nativeRange.compareBoundaryPoints(n,t.nativeRange||t)};var y=document.createElement("div");y.innerHTML="123";var p=y.firstChild,w=e(document);w.appendChild(y);h.setStart(p,1);h.setEnd(p,2);h.deleteContents();p.data=="13"&&(r.deleteContents=function(){this.nativeRange.deleteContents();u(this)},r.extractContents=function(){var n=this.nativeRange.extractContents();return u(this),n});w.removeChild(y);w=null;c.isHostMethod(h,"createContextualFragment")&&(r.createContextualFragment=function(n){return this.nativeRange.createContextualFragment(n)});e(document).removeChild(l);r.getName=function(){return"WrappedRange"};n.WrappedRange=o;n.createNativeRange=function(n){return n=s(n,t,"createNativeRange"),n.createRange()}}(),n.features.implementsTextRange){var p=function(n){var f=n.parentElement(),t=n.duplicate();t.collapse(!0);var r=t.parentElement();t=n.duplicate();t.collapse(!1);var e=t.parentElement(),u=r==e?r:q.getCommonAncestor(r,e);return u==f?u:q.getCommonAncestor(f,u)},w=function(n){return n.compareEndPoints("StartToEnd",n)==0},l=function(n,t,r,f,e){var c=n.duplicate();c.collapse(r);var o=c.parentElement();if(q.isOrIsAncestorOf(t,o)||(o=t),!o.canHaveHTML){var g=new u(o.parentNode,q.getNodeIndex(o));return{boundaryPosition:g,nodeInfo:{nodeIndex:g.offset,containerElement:g.node}}}var s=q.getDocument(o).createElement("span");s.parentNode&&q.removeNode(s);for(var y,qt=r?"StartToStart":"StartToEnd",p,k,nt,w,l=e&&e.containerElement==o?e.nodeIndex:0,tt=o.childNodes.length,a=tt,v=a;;){if(v==tt?o.appendChild(s):o.insertBefore(s,o.childNodes[v]),c.moveToElementText(s),y=c.compareEndPoints(qt,n),y==0||l==a)break;else if(y==-1)if(a==l+1)break;else l=v;else a=a==l+1?l:v;v=Math.floor((l+a)/2);o.removeChild(s)}if(w=s.nextSibling,y==-1&&w&&h(w)){c.setEndPoint(r?"EndToStart":"EndToEnd",n);var d;if(/[\r\n]/.test(w.data)){var b=c.duplicate(),rt=b.text.replace(/\r\n/g,"\r").length;for(d=b.moveStart("character",rt);(y=b.compareEndPoints("StartToEnd",b))==-1;)d++,b.moveStart("character",1)}else d=c.text.length;nt=new u(w,d)}else p=(f||!r)&&s.previousSibling,k=(f||r)&&s.nextSibling,nt=k&&h(k)?new u(k,0):p&&h(p)?new u(p,p.data.length):new u(o,q.getNodeIndex(s));return q.removeNode(s),{boundaryPosition:nt,nodeInfo:{nodeIndex:v,containerElement:o}}},a=function(n,t){var u,f,s=n.offset,l=q.getDocument(n.node),r,c,o=e(l).createTextRange(),a=h(n.node);return a?(u=n.node,f=u.parentNode):(c=n.node.childNodes,u=s<c.length?c[s]:null,f=n.node),r=l.createElement("span"),r.innerHTML="&#feff;",u?f.insertBefore(r,u):f.appendChild(r),o.moveToElementText(r),o.collapse(!t),f.removeChild(r),a&&o[t?"moveStart":"moveEnd"]("character",s),o};r=function(n){this.textRange=n;this.refresh()};r.prototype=new f(document);r.prototype.refresh=function(){var n,t,q,r=p(this.textRange);w(this.textRange)?t=n=l(this.textRange,r,!0,!0).boundaryPosition:(q=l(this.textRange,r,!0,!1),n=q.boundaryPosition,t=l(this.textRange,r,!1,!1,q.nodeInfo).boundaryPosition);this.setStart(n.node,n.offset);this.setEnd(t.node,t.offset)};r.prototype.getName=function(){return"WrappedTextRange"};f.copyComparisonConstants(r);var v=function(n){if(n.collapsed)return a(new u(n.startContainer,n.startOffset),!0);var q=a(new u(n.startContainer,n.startOffset),!0),r=a(new u(n.endContainer,n.endOffset),!1),t=e(f.getRangeDocument(n)).createTextRange();return t.setEndPoint("StartToStart",q),t.setEndPoint("EndToEnd",r),t};if(r.rangeToTextRange=v,r.prototype.toTextRange=function(){return v(this)},n.WrappedTextRange=r,!n.features.implementsDomRange||n.config.preferTextRange){var y=function(n){return n("return this;")()}(Function);typeof y.Range=="undefined"&&(y.Range=r);n.createNativeRange=function(n){return n=s(n,t,"createNativeRange"),e(n).createTextRange()};n.WrappedRange=r}}n.createRange=function(q){return q=s(q,t,"createRange"),new n.WrappedRange(n.createNativeRange(q))};n.createRangyRange=function(n){return n=s(n,t,"createRangyRange"),new f(n)};c.createAliasForDeprecatedMethod(n,"createIframeRange","createRange");c.createAliasForDeprecatedMethod(n,"createIframeRangyRange","createRangyRange");n.addShimListener(function(t){var q=t.document;typeof q.createRange=="undefined"&&(q.createRange=function(){return n.createRange(q)});q=t=null})});n.createCoreModule("WrappedSelection",["DomRange","WrappedRange"],function(n,t){n.config.checkSelectionRanges=!0;var qq="boolean",lt="number",r=n.dom,a=n.util,s=a.isHostMethod,b=n.DomRange,at=n.WrappedRange,k=n.DOMException,rq=r.DomPosition,d,g,u=n.features,v="Control",e=r.getDocument,p=r.getBody,vt=b.rangesEqual;function yt(n){return typeof n=="string"?/^backward(s)?$/i.test(n):!!n}function et(n,q){if(n){if(r.isWindow(n))return n;if(n instanceof o)return n.win;var u=r.getContentDocument(n,t,q);return r.getWindow(u)}return window}function gq(n){return et(n,"getWinSelection").getSelection()}function uq(n){return et(n,"getDocSelection").document.selection}function fq(n){var t=!1;return n.anchorNode&&(t=r.comparePoints(n.anchorNode,n.anchorOffset,n.focusNode,n.focusOffset)==1),t}var pt=s(window,"getSelection"),h=a.isHostObject(document,"selection");u.implementsWinGetSelection=pt;u.implementsDocSelection=h;var nt=h&&(!pt||n.config.preferTextRange);if(nt)d=uq,n.isSelectionValid=function(n){var t=et(n,"isSelectionValid").document,q=t.selection;return q.type!="None"||e(q.createRange().parentElement())==t};else if(pt)d=gq,n.isSelectionValid=function(){return!0};else return t.fail("Neither document.selection or window.getSelection() detected."),!1;n.getNativeSelection=d;var f=d();if(!f)return t.fail("Native selection was null (possibly issue 138?)"),!1;var eq=n.createNativeRange(document),wt=p(document),w=a.areHostProperties(f,["anchorNode","focusNode","anchorOffset","focusOffset"]);u.selectionHasAnchorAndFocus=w;var tt=s(f,"extend");u.selectionHasExtend=tt;var oq=s(f,"setBaseAndExtent");u.selectionHasSetBaseAndExtent=oq;var sq=typeof f.rangeCount==lt;u.selectionHasRangeCount=sq;var ot=!1,hq=!0,bt=tt?function(t,q){var u=b.getRangeDocument(q),r=n.createRange(u);r.collapseToPoint(q.endContainer,q.endOffset);t.addRange(kt(r));t.extend(q.startContainer,q.startOffset)}:null;a.areHostMethods(f,["addRange","getRangeAt","removeAllRanges"])&&typeof f.rangeCount==lt&&u.implementsDomRange&&function(){var t=window.getSelection();if(t){for(var o=t.rangeCount,l=o>1,f=[],a=fq(t),q=0;q<o;++q)f[q]=t.getRangeAt(q);var h=r.createTestElement(document,"",!1),e=h.appendChild(document.createTextNode("   ")),u=document.createRange();if(u.setStart(e,1),u.collapse(!0),t.removeAllRanges(),t.addRange(u),hq=t.rangeCount==1,t.removeAllRanges(),!l){var c=window.navigator.appVersion.match(/Chrome\/(.*?) /);if(c&&parseInt(c[1])>=36)ot=!1;else{var s=u.cloneRange();u.setStart(e,0);s.setEnd(e,3);s.setStart(e,2);t.addRange(u);t.addRange(s);ot=t.rangeCount==2}}for(r.removeNode(h),t.removeAllRanges(),q=0;q<o;++q)q==0&&a?bt?bt(t,f[q]):(n.warn("Rangy initialization: original selection was backwards but selection has been restored forwards because the browser does not support Selection.extend"),t.addRange(f[q])):t.addRange(f[q])}}();u.selectionSupportsMultipleRanges=ot;u.collapsedNonEditableSelectionsSupported=hq;var c=!1,cq;wt&&s(wt,"createControlRange")&&(cq=wt.createControlRange(),a.areHostProperties(cq,["item","add"])&&(c=!0));u.implementsControlRange=c;g=w?function(n){return n.anchorNode===n.focusNode&&n.anchorOffset===n.focusOffset}:function(n){return n.rangeCount?n.getRangeAt(n.rangeCount-1).collapsed:!1};function qt(n,t,q){var r=q?"end":"start",u=q?"start":"end";n.anchorNode=t[r+"Container"];n.anchorOffset=t[r+"Offset"];n.focusNode=t[u+"Container"];n.focusOffset=t[u+"Offset"]}function nr(n){var t=n.nativeSelection;n.anchorNode=t.anchorNode;n.anchorOffset=t.anchorOffset;n.focusNode=t.focusNode;n.focusOffset=t.focusOffset}function y(n){n.anchorNode=n.focusNode=null;n.anchorOffset=n.focusOffset=0;n.rangeCount=0;n.isCollapsed=!0;n._ranges.length=0;l(n)}function l(n){n.type=n.rangeCount==0?"None":g(n)?"Caret":"Range"}function kt(t){var q;return t instanceof b?(q=n.createNativeRange(t.getDocument()),q.setEnd(t.endContainer,t.endOffset),q.setStart(t.startContainer,t.startOffset)):t instanceof at?q=t.nativeRange:u.implementsDomRange&&t instanceof r.getWindow(t.startContainer).Range&&(q=t),q}function tr(n){if(!n.length||n[0].nodeType!=1)return!1;for(var t=1,q=n.length;t<q;++t)if(!r.isAncestorOf(n[0],n[t]))return!1;return!0}function dt(n){var q=n.getNodes();if(!tr(q))throw t.createError("getSingleElementFromRange: range "+n.inspect()+" did not consist of a single element");return q[0]}function gt(n){return!!n&&typeof n.text!="undefined"}function lq(n,t){var q=new at(t);n._ranges=[q];qt(n,q,!1);n.rangeCount=1;n.isCollapsed=q.collapsed;l(n)}function rt(t){if(t._ranges.length=0,t.docSelection.type=="None")y(t);else{var q=t.docSelection.createRange();if(gt(q))lq(t,q);else{t.rangeCount=q.length;for(var r,f=e(q.item(0)),u=0;u<t.rangeCount;++u)r=n.createRange(f),r.selectNode(q.item(u)),t._ranges.push(r);t.isCollapsed=t.rangeCount==1&&t._ranges[0].collapsed;qt(t,t._ranges[t.rangeCount-1],!1);l(t)}}}function aq(n,q){for(var r=n.docSelection.createRange(),o=dt(q),s=e(r.item(0)),u=p(s).createControlRange(),f=0,h=r.length;f<h;++f)u.add(r.item(f));try{u.add(o)}catch(c){throw t.createError("addRange(): Element within the specified Range could not be added to control selection (does it have layout?)");}u.select();rt(n)}var st;s(f,"getRangeAt")?st=function(n,t){try{return n.getRangeAt(t)}catch(q){return null}}:w&&(st=function(t){var r=e(t.anchorNode),q=n.createRange(r);return q.setStartAndEnd(t.anchorNode,t.anchorOffset,t.focusNode,t.focusOffset),q.collapsed!==this.isCollapsed&&q.setStartAndEnd(t.focusNode,t.focusOffset,t.anchorNode,t.anchorOffset),q});function o(n,t,q){this.nativeSelection=n;this.docSelection=t;this._ranges=[];this.win=q;this.refresh()}o.prototype=n.selectionPrototype;function vq(n){n.win=n.anchorNode=n.focusNode=n._ranges=null;n.rangeCount=n.anchorOffset=n.focusOffset=0;n.detached=!0;l(n)}var ut=[];function nq(n,t){for(var q=ut.length,r,u;q--;)if(r=ut[q],u=r.selection,t=="deleteAll")vq(u);else if(r.win==n)return t=="delete"?(ut.splice(q,1),!0):u;return t=="deleteAll"&&(ut.length=0),null}var tq=function(n){if(n&&n instanceof o)return n.refresh(),n;n=et(n,"getNativeSelection");var t=nq(n),q=d(n),r=h?uq(n):null;return t?(t.nativeSelection=q,t.docSelection=r,t.refresh()):(t=new o(q,r,n),ut.push({win:n,selection:t})),t};n.getSelection=tq;a.createAliasForDeprecatedMethod(n,"getIframeSelection","getSelection");var q=o.prototype;function yq(n,q){for(var o=e(q[0].startContainer),u=p(o).createControlRange(),r=0,f,s=q.length;r<s;++r){f=dt(q[r]);try{u.add(f)}catch(h){throw t.createError("setRanges(): Element within one of the specified Ranges could not be added to control selection (does it have layout?)");}}u.select();rt(n)}if(!nt&&w&&a.areHostMethods(f,["removeAllRanges","addRange"])){q.removeAllRanges=function(){this.nativeSelection.removeAllRanges();y(this)};var pq=function(n,t){bt(n.nativeSelection,t);n.refresh()};q.addRange=sq?function(t,q){if(c&&h&&this.docSelection.type==v)aq(this,t);else if(yt(q)&&tt)pq(this,t);else{var r;ot?r=this.rangeCount:(this.removeAllRanges(),r=0);var f=kt(t).cloneRange();try{this.nativeSelection.addRange(f)}catch(e){}if(this.rangeCount=this.nativeSelection.rangeCount,this.rangeCount==r+1){if(n.config.checkSelectionRanges){var u=st(this.nativeSelection,this.rangeCount-1);u&&!vt(u,t)&&(t=new at(u))}this._ranges[this.rangeCount-1]=t;qt(this,t,ft(this.nativeSelection));this.isCollapsed=g(this);l(this)}else this.refresh()}}:function(n,t){yt(t)&&tt?pq(this,n):(this.nativeSelection.addRange(kt(n)),this.refresh())};q.setRanges=function(n){if(c&&h&&n.length>1)yq(this,n);else{this.removeAllRanges();for(var t=0,q=n.length;t<q;++t)this.addRange(n[t])}}}else if(s(f,"empty")&&s(eq,"select")&&c&&nt)q.removeAllRanges=function(){try{if(this.docSelection.empty(),this.docSelection.type!="None"){var n;if(this.anchorNode)n=e(this.anchorNode);else if(this.docSelection.type==v){var t=this.docSelection.createRange();t.length&&(n=e(t.item(0)))}if(n){var q=p(n).createTextRange();q.select();this.docSelection.empty()}}}catch(r){}y(this)},q.addRange=function(t){this.docSelection.type==v?aq(this,t):(n.WrappedTextRange.rangeToTextRange(t).select(),this._ranges[0]=t,this.rangeCount=1,this.isCollapsed=this._ranges[0].collapsed,qt(this,t,!1),l(this))},q.setRanges=function(n){this.removeAllRanges();var t=n.length;t>1?yq(this,n):t&&this.addRange(n[0])};else return t.fail("No means of selecting a Range or TextRange was found"),!1;q.getRangeAt=function(n){if(n<0||n>=this.rangeCount)throw new k("INDEX_SIZE_ERR");else return this._ranges[n].cloneRange()};var ht;if(nt)ht=function(t){var q;n.isSelectionValid(t.win)?q=t.docSelection.createRange():(q=p(t.win.document).createTextRange(),q.collapse(!0));t.docSelection.type==v?rt(t):gt(q)?lq(t,q):y(t)};else if(s(f,"getRangeAt")&&typeof f.rangeCount==lt)ht=function(t){if(c&&h&&t.docSelection.type==v)rt(t);else if(t._ranges.length=t.rangeCount=t.nativeSelection.rangeCount,t.rangeCount){for(var q=0,r=t.rangeCount;q<r;++q)t._ranges[q]=new n.WrappedRange(t.nativeSelection.getRangeAt(q));qt(t,t._ranges[t.rangeCount-1],ft(t.nativeSelection));t.isCollapsed=g(t);l(t)}else y(t)};else if(w&&typeof f.isCollapsed==qq&&typeof eq.collapsed==qq&&u.implementsDomRange)ht=function(n){var t,q=n.nativeSelection;q.anchorNode?(t=st(q,0),n._ranges=[t],n.rangeCount=1,nr(n),n.isCollapsed=g(n),l(n)):y(n)};else return t.fail("No means of obtaining a Range or TextRange from the user's selection was found"),!1;q.refresh=function(n){var q=n?this._ranges.slice(0):null,r=this.anchorNode,u=this.anchorOffset;if(ht(this),n){var t=q.length;if(t!=this._ranges.length||this.anchorNode!=r||this.anchorOffset!=u)return!0;while(t--)if(!vt(q[t],this._ranges[t]))return!0;return!1}};var wq=function(n,t){var r=n.getAllRanges();n.removeAllRanges();for(var q=0,u=r.length;q<u;++q)vt(t,r[q])||n.addRange(r[q]);n.rangeCount||y(n)};q.removeRange=c&&h?function(n){if(this.docSelection.type==v){for(var t=this.docSelection.createRange(),o=dt(n),s=e(t.item(0)),r=p(s).createControlRange(),u,f=!1,q=0,h=t.length;q<h;++q)u=t.item(q),u!==o||f?r.add(t.item(q)):f=!0;r.select();rt(this)}else wq(this,n)}:function(n){wq(this,n)};var ft;!nt&&w&&u.implementsDomRange?(ft=fq,q.isBackward=function(){return ft(this)}):ft=q.isBackward=function(){return!1};q.isBackwards=q.isBackward;q.toString=function(){for(var t=[],n=0,q=this.rangeCount;n<q;++n)t[n]=""+this._ranges[n];return t.join("")};function ct(n,t){if(n.win.document!=e(t))throw new k("WRONG_DOCUMENT_ERR");}function bq(n,t){if(t<0||t>(r.isCharacterDataNode(n)?n.length:n.childNodes.length))throw new k("INDEX_SIZE_ERR");}q.collapse=function(t,q){ct(this,t);var r=n.createRange(t);r.collapseToPoint(t,q);this.setSingleRange(r);this.isCollapsed=!0};q.collapseToStart=function(){if(this.rangeCount){var n=this._ranges[0];this.collapse(n.startContainer,n.startOffset)}else throw new k("INVALID_STATE_ERR");};q.collapseToEnd=function(){if(this.rangeCount){var n=this._ranges[this.rangeCount-1];this.collapse(n.endContainer,n.endOffset)}else throw new k("INVALID_STATE_ERR");};q.selectAllChildren=function(t){ct(this,t);var q=n.createRange(t);q.selectNodeContents(t);this.setSingleRange(q)};oq?q.setBaseAndExtent=function(n,t,q,r){this.nativeSelection.setBaseAndExtent(n,t,q,r);this.refresh()}:tt&&(q.setBaseAndExtent=function(t,q,u,f){bq(t,q);bq(u,f);ct(this,t);ct(this,u);var e=n.createRange(node),o=r.comparePoints(t,q,u,f)==-1;o?e.setStartAndEnd(u,f,t,q):e.setStartAndEnd(t,q,u,f);this.setSingleRange(e,o)});q.deleteFromDocument=function(){if(c&&h&&this.docSelection.type==v){for(var t=this.docSelection.createRange(),q;t.length;)q=t.item(0),t.remove(q),r.removeNode(q);this.refresh()}else if(this.rangeCount){var n=this.getAllRanges();if(n.length){this.removeAllRanges();for(var u=0,f=n.length;u<f;++u)n[u].deleteContents();this.addRange(n[f-1])}}};q.eachRange=function(n,t){for(var q=0,r=this._ranges.length;q<r;++q)if(n(this.getRangeAt(q)))return t};q.getAllRanges=function(){var n=[];return this.eachRange(function(t){n.push(t)}),n};q.setSingleRange=function(n,t){this.removeAllRanges();this.addRange(n,t)};q.callMethodOnEachRange=function(n,t){var q=[];return this.eachRange(function(r){q.push(r[n].apply(r,t||[]))}),q};function kq(t){return function(q,r){var u;this.rangeCount?(u=this.getRangeAt(0),u["set"+(t?"Start":"End")](q,r)):(u=n.createRange(this.win.document),u.setStartAndEnd(q,r));this.setSingleRange(u,this.isBackward())}}q.setStart=kq(!0);q.setEnd=kq(!1);n.rangePrototype.select=function(n){tq(this.getDocument()).setSingleRange(this,n)};q.changeEachRange=function(n){var t=[],q=this.isBackward();this.eachRange(function(q){n(q);t.push(q)});this.removeAllRanges();q&&t.length==1?this.addRange(t[0],"backward"):this.setRanges(t)};q.containsNode=function(n,t){return this.eachRange(function(q){return q.containsNode(n,t)},!0)||!1};q.getBookmark=function(n){return{backward:this.isBackward(),rangeBookmarks:this.callMethodOnEachRange("getBookmark",[n])}};q.moveToBookmark=function(t){for(var q=[],f=0,u,r;u=t.rangeBookmarks[f++];)r=n.createRange(this.win),r.moveToBookmark(u),q.push(r);t.backward?this.setSingleRange(q[0],"backward"):this.setRanges(q)};q.saveRanges=function(){return{backward:this.isBackward(),ranges:this.callMethodOnEachRange("cloneRange")}};q.restoreRanges=function(n){this.removeAllRanges();for(var t=0,q;q=n.ranges[t];++t)this.addRange(q,n.backward&&t==0)};q.toHtml=function(){var n=[];return this.eachRange(function(t){n.push(b.toHtml(t))}),n.join("")};u.implementsTextRange&&(q.getNativeTextRange=function(){var q;if(q=this.docSelection){var r=q.createRange();if(gt(r))return r;throw t.createError("getNativeTextRange: selection is a control selection");}else{if(this.rangeCount>0)return n.WrappedTextRange.rangeToTextRange(this.getRangeAt(0));throw t.createError("getNativeTextRange: selection contains no range");}});function dq(n){var q=[],r=new rq(n.anchorNode,n.anchorOffset),u=new rq(n.focusNode,n.focusOffset),f=typeof n.getName=="function"?n.getName():"Selection";if(typeof n.rangeCount!="undefined")for(var t=0,e=n.rangeCount;t<e;++t)q[t]=b.inspect(n.getRangeAt(t));return"["+f+"(Ranges: "+q.join(", ")+")(anchor: "+r.inspect()+", focus: "+u.inspect()+"]"}q.getName=function(){return"WrappedSelection"};q.inspect=function(){return dq(this)};q.detach=function(){nq(this.win,"delete");vq(this)};o.detachAll=function(){nq(null,"deleteAll")};o.inspect=dq;o.isDirectionBackward=yt;n.Selection=o;n.selectionPrototype=q;n.addShimListener(function(n){typeof n.getSelection=="undefined"&&(n.getSelection=function(){return tq(n)});n=null})});var st=!1,k=function(){st||(st=!0,!n.initialized&&n.config.autoInitialize&&w())};return q&&(document.readyState=="complete"?k():(t(document,"addEventListener")&&document.addEventListener("DOMContentLoaded",k,!1),h(window,"load",k))),n},this);
/*!
 ~/Script/StackTrace.js
*/
function printStackTrace(n){n=n||{guess:!0};var r=n.e||null,u=!!n.guess,t=new printStackTrace.implementation,q=t.run(r);return u?t.guessAnonymousFunctions(q):q}printStackTrace.regex={chrome1:/^\S[^\(]+?[\n$]/gm,chrome2:/^\s+(at eval )?at\s+/gm,chrome3:/^([^\(]+?)([\n$])/gm,chrome4:/^Object.<anonymous>\s*\(([^\)]+)\)/gm,firefox1:/(?:\n@:0)?\s+$/m,firefox2:/^\(/gm,opera11_1:/^.*line (\d+), column (\d+)(?: in (.+))? in (\S+):$/,opera11_2:/<anonymous function: (\S+)>/,opera11_3:/<anonymous function>/,opera11_4:/^\s+/,opera10_1:/^(.*)@(.+):(\d+)$/,opera10_2:/Line (\d+).*script (?:in )?(\S+)(?:: In function (\S+))?$/i,opera9:/Line (\d+).*script (?:in )?(\S+)/i,other:/function\s*([\w\-$]+)?\s*\(/i,reStack:/\{anonymous\}\(.*\)@(.*)/,reRef:/^(.*?)(?::(\d+))(?::(\d+))?(?: -- .+)?$/,reFunctionDeclaration:/function\s+([^(]*?)\s*\(([^)]*)\)/,reFunctionExpression:/['"]?([0-9A-Za-z_]+)['"]?\s*[:=]\s*function\b/,reFunctionEvaluation:/['"]?([0-9A-Za-z_]+)['"]?\s*[:=]\s*(?:eval|new Function)\b/};printStackTrace.implementation=function(){};printStackTrace.implementation.prototype={run:function(n,t){return n=n||this.createException(),t=t||this.mode(n),t==="other"?this.other(arguments.callee):this[t](n)},createException:function(){try{this.undef()}catch(n){return n}},mode:function(n){return n.arguments&&n.stack?"chrome":typeof n.message=="string"&&typeof window!="undefined"&&window.opera?n.stacktrace?n.message.indexOf("\n")>-1&&n.message.split("\n").length>n.stacktrace.split("\n").length?"opera9":n.stack?n.stacktrace.indexOf("called from line")<0?"opera10b":"opera11":"opera10a":"opera9":n.stack?"firefox":"other"},instrumentFunction:function(n,t,q){n=n||window;var r=n[t];n[t]=function(){return q.call(this,printStackTrace().slice(4)),n[t]._instrumented.apply(this,arguments)};n[t]._instrumented=r},deinstrumentFunction:function(n,t){n[t].constructor===Function&&n[t]._instrumented&&n[t]._instrumented.constructor===Function&&(n[t]=n[t]._instrumented)},chrome:function(n){var t=(n.stack+"\n").replace(printStackTrace.regex.chrome1,"").replace(printStackTrace.regex.chrome2,"").replace(printStackTrace.regex.chrome3,"{anonymous}()@$1$2").replace(printStackTrace.regex.chrome4,"{anonymous}()@$1").split("\n");return t.pop(),t},firefox:function(n){return n.stack.replace(printStackTrace.regex.firefox1,"").replace(printStackTrace.regex.firefox2,"{anonymous}(").split("\n")},opera11:function(n){for(var e=printStackTrace.regex.opera11_1,r=n.stacktrace.split("\n"),f=[],q=0,o=r.length;q<o;q+=2){var t=e.exec(r[q]);if(t){var s=t[4]+":"+t[1]+":"+t[2],u=t[3]||"global code";u=u.replace(printStackTrace.regex.opera11_2,"$1").replace(printStackTrace.regex.opera11_3,"{anonymous}");f.push(u+"@"+s+" -- "+r[q+1].replace(printStackTrace.regex.opera11_4,""))}}return f},opera10b:function(n){for(var f=printStackTrace.regex.opera10_1,r=n.stacktrace.split("\n"),u=[],q=0,e=r.length;q<e;q++){var t=f.exec(r[q]);if(t){var o=t[1]?t[1]+"()":"global code";u.push(o+"@"+t[2]+":"+t[3])}}return u},opera10a:function(n){for(var f=printStackTrace.regex.opera10_2,r=n.stacktrace.split("\n"),u=[],t=0,e=r.length;t<e;t+=2){var q=f.exec(r[t]);if(q){var o=q[3]||"{anonymous}";u.push(o+"()@"+q[2]+":"+q[1]+" -- "+r[t+1].replace(printStackTrace.regex.opera11_4,""))}}return u},opera9:function(n){for(var f=printStackTrace.regex.opera9,q=n.message.split("\n"),u=[],t=2,e=q.length;t<e;t+=2){var r=f.exec(q[t]);r&&u.push("{anonymous}()@"+r[2]+":"+r[1]+" -- "+q[t+1].replace(printStackTrace.regex.opera11_4,""))}return u},other:function(n){for(var q="{anonymous}",f=printStackTrace.regex.other,t=[],r,u;n&&n.arguments&&t.length<10;)r=f.test(n.toString())?RegExp.$1||q:q,u=Array.prototype.slice.call(n.arguments||[]),t[t.length]=r+"("+this.stringifyArguments(u)+")",n=n.caller;return t},stringifyArguments:function(n){for(var r=[],u=Array.prototype.slice,q=0;q<n.length;++q){var t=n[q];t===undefined?r[q]="undefined":t===null?r[q]="null":t.constructor&&(t.constructor===Array?r[q]=t.length<3?"["+this.stringifyArguments(t)+"]":"["+this.stringifyArguments(u.call(t,0,1))+"..."+this.stringifyArguments(u.call(t,-1))+"]":t.constructor===Object?r[q]="#object":t.constructor===Function?r[q]="#function":t.constructor===String?r[q]='"'+t+'"':t.constructor===Number&&(r[q]=t))}return r.join(",")},sourceCache:{},ajax:function(n){var t=this.createXMLHTTPObject();if(t)try{return t.open("GET",n,!1),t.send(null),t.responseText}catch(q){}return""},createXMLHTTPObject:function(){for(var q,t=[function(){return new XMLHttpRequest},function(){return new ActiveXObject("Msxml2.XMLHTTP.6.0")}],n=0;n<t.length;n++)try{return q=t[n](),this.createXMLHTTPObject=t[n],q}catch(r){}},isSameDomain:function(n){return n.indexOf(location.hostname)!==-1},getSource:function(n){return n in this.sourceCache||(this.sourceCache[n]=this.ajax(n).split("\n")),this.sourceCache[n]},guessAnonymousFunctions:function(n){for(var t=0;t<n.length;++t){var u=n[t],f=printStackTrace.regex.reStack.exec(u);if(f){var q=printStackTrace.regex.reRef.exec(f[1]);if(q){var r=q[1],e=q[2],o=q[3]||0;if(r&&this.isSameDomain(r)&&e){var s=this.guessAnonymousFunction(r,e,o);n[t]=u.replace("{anonymous}",s)}}}}return n},guessAnonymousFunction:function(n,t){var q;try{q=this.findFunctionName(this.getSource(n),t)}catch(r){q="getSource failed with url: "+n+", exception: "+r.toString()}return q},findFunctionName:function(n,t){for(var o=printStackTrace.regex.reFunctionDeclaration,s=printStackTrace.regex.reFunctionExpression,h=printStackTrace.regex.reFunctionEvaluation,u="",r,c=Math.min(t,20),q,f,e=0;e<c;++e)if(r=n[t-e-1],f=r.indexOf("//"),f>=0&&(r=r.substr(0,f)),r&&((u=r+u,q=s.exec(u),q&&q[1])||(q=o.exec(u),q&&q[1])||(q=h.exec(u),q&&q[1])))return q[1];return"(?)"}};
/*!
 ~/Script/SourceCode.Forms.ServerTabControl.js
*/
(function(n){(typeof SourceCode=="undefined"||SourceCode===null)&&(SourceCode={});(typeof SourceCode.Forms=="undefined"||SourceCode.Forms===null)&&(SourceCode.Forms={});(typeof SourceCode.Forms.Controls=="undefined"||SourceCode.Forms.Controls===null)&&(SourceCode.Forms.Controls={});SourceCode.Forms.Controls.ServerTabBox={_create:function(){this.element.hasClass("tab-box")&&(this.TabBox=this.element);this.Tabs=this.TabBox.children("ul").children("li").find("a.tab");this.wireEvents()},wireEvents:function(){this.Tabs.on("click",this.TabClick.bind(this))},TabClick:function(){var r=typeof arguments[0]!="undefined"&&arguments[0]!==null?arguments[0]:null,n=jQuery(r.target).closest(".tab");if(!n.is(".disabled")){var t=this.Tabs.filter(".selected");if(n[0]!==t[0]){var u=jQuery("#"+t[0].id+"_Content");u.hide();t.removeClass("selected");var f=jQuery("#"+n[0].id+"_Content");f.show();n.addClass("selected");var q=jQuery.Event();q.type="tabselected";q.detail={newTab:n,oldTab:t};jQuery(this.TabBox).trigger(q)}}r.preventDefault()}};typeof SCServerTabBox=="undefined"&&(SCServerTabBox=SourceCode.Forms.Controls.ServerTabBox);n.widget("ui.ServerTabBox",SourceCode.Forms.Controls.ServerTabBox)})(jQuery);
/*!
 ~/Script/SourceCode.Forms.CultureHelper.js
*/
(function(n){(typeof SourceCode=="undefined"||SourceCode===null)&&(SourceCode={});(typeof SourceCode.Forms=="undefined"||SourceCode.Forms===null)&&(SourceCode.Forms={});SourceCode.Forms.CultureHelper=function(n,t,q,r){this._create(n,t,q,r)};var t={customDateRegex:/^[dDtTF]{1}$/,customNumberRegex:/^.*(#|[0])+.*$/,numberRegex:/^[FfNnEeCcGgPpRrXx]{1}[0-9]*$/,cultureXml:parseXML("<Cultures/>"),cultureObject:null,_formatObjectNodeCache:{},_create:function(n,t,q,r){this.cultureXml=parseXML(n);this.currentCultureName=t;this.timeZones=JSON.parse(q);this.timeZones.lookup={};for(var u=this.timeZones.length;u--;)this.timeZones.lookup[this.timeZones[u].Id]=this.timeZones[u];this.formatXsltPath=r?r:applicationRoot+"Runtime/XSLT/Formatting.xslt"},getCultureObject:function(n,t){return this.cultureObject&&this.cultureObject.Name===n?(t&&t(this.cultureObject),this.cultureObject):(this._getCultureNode(n,t),this.cultureObject)},_getCultureNode:function(t,q){var r=null;checkExists(this.cultureXml)&&(r=this.cultureXml.selectSingleNode("Cultures/Culture[Name='{0}']".format(t)));checkExists(r)&&r.selectSingleNode("PercentSymbol")?this._cultureNodeRetrieved(r,q):n.ajax({data:{filterIdentifiers:t,method:"getDetailCultures"},async:q!=="undefined"&&q!==null,dataType:"xml",url:applicationRoot+"Runtime/AJAXCall.ashx",error:function(n,t){popupManager.showError("<p>".concat(Resources.RuntimeMessages.CulutureInformationFailedToLoad,"<\/p><p>[",n.status,"] ",n.statusText," (",t,")<\/p>"))}.bind(this),success:function(n){SourceCode.Forms.ExceptionHandler.handleException(n)||(this.replaceListCultureNodeWithDetailedCultureNode(t,n),this._getCultureNode(t,q))}.bind(this)})},_cultureNodeRetrieved:function(n,t){var q=this._transformToCultureObject(n);t&&t(q)},_transformToCultureObject:function(n){var t={};t.Name=n.selectSingleNode("Name");t.Name=t.Name?t.Name.text:"";t.DisplayName=n.selectSingleNode("DisplayName");t.DisplayName=t.DisplayName?t.DisplayName.text:"";t.LCID=n.selectSingleNode("LCID");t.LCID=t.LCID?parseInt(t.LCID.text):"";t.CurrencySymbol=n.selectSingleNode("CurrencySymbol");t.CurrencySymbol=t.CurrencySymbol?t.CurrencySymbol.text:"";t.PercentSymbol=n.selectSingleNode("PercentSymbol");t.PercentSymbol=t.PercentSymbol?t.PercentSymbol.text:"";t.NaNSymbol=n.selectSingleNode("NaNSymbol");t.NaNSymbol=t.NaNSymbol?t.NaNSymbol.text:"";t.NegativeInfinitySymbol=n.selectSingleNode("NegativeInfinitySymbol");t.NegativeInfinitySymbol=t.NegativeInfinitySymbol?t.NegativeInfinitySymbol.text:"";t.PositiveInfinitySymbol=n.selectSingleNode("PositiveInfinitySymbol");t.PositiveInfinitySymbol=t.PositiveInfinitySymbol?t.PositiveInfinitySymbol.text:"";t.PositiveSign=n.selectSingleNode("PositiveSign");t.PositiveSign=t.PositiveSign?t.PositiveSign.text:"";t.NegativeSign=n.selectSingleNode("NegativeSign");t.NegativeSign=t.NegativeSign?t.NegativeSign.text:"";var r={},o=n.selectSingleNode("CurrencyDetails");r.PositivePattern=o.selectSingleNode("PositivePattern");r.PositivePattern=r.PositivePattern?r.PositivePattern.text:"";r.NegativePattern=o.selectSingleNode("NegativePattern");r.NegativePattern=r.NegativePattern?r.NegativePattern.text:"";r.DecimalDigits=o.selectSingleNode("DecimalDigits");r.DecimalDigits=r.DecimalDigits?r.DecimalDigits.text.toInt():"";r.DecimalSeparator=o.selectSingleNode("DecimalSeparator");r.DecimalSeparator=r.DecimalSeparator?r.DecimalSeparator.text:"";r.GroupSeparator=o.selectSingleNode("GroupSeparator");r.GroupSeparator=r.GroupSeparator?r.GroupSeparator.text:"";var g=o.selectNodes("GroupSizes/GroupSize");r.GroupSizes=[];for(var q=0;q<g.length;q++)r.GroupSizes[q]=g[q].text.toInt();t.CurrencyDetails=r;var u={},s=n.selectSingleNode("NumberDetails");u.PositivePattern=s.selectSingleNode("PositivePattern");u.PositivePattern=u.PositivePattern?u.PositivePattern.text:"";u.NegativePattern=s.selectSingleNode("NegativePattern");u.NegativePattern=u.NegativePattern?u.NegativePattern.text:"";u.DecimalDigits=s.selectSingleNode("DecimalDigits");u.DecimalDigits=u.DecimalDigits?u.DecimalDigits.text.toInt():"";u.DecimalSeparator=s.selectSingleNode("DecimalSeparator");u.DecimalSeparator=u.DecimalSeparator?u.DecimalSeparator.text:"";u.GroupSeparator=s.selectSingleNode("GroupSeparator");u.GroupSeparator=u.GroupSeparator?u.GroupSeparator.text:"";var nt=s.selectNodes("GroupSizes/GroupSize");u.GroupSizes=[];for(var q=0;q<nt.length;q++)u.GroupSizes[q]=nt[q].text.toInt();t.NumberDetails=u;var v={},tt=n.selectSingleNode("SpecialDetails");if(tt!==null){var qt=tt.selectNodes("Pattern");v.Patterns=[];for(var q=0;q<qt.length;q++){var l=qt[q],c={};c.Name=l.selectSingleNode("Name").text;c.Display=l.selectSingleNode("Display").text;c.Value=l.selectSingleNode("Value").text;c.PreviewText=l.selectSingleNode("PreviewText").text;v.Patterns[q]=c}t.SpecialDetails=v}var f={},h=n.selectSingleNode("PercentDetails");f.PositivePattern=h.selectSingleNode("PositivePattern");f.PositivePattern=f.PositivePattern?f.PositivePattern.text:"";f.NegativePattern=h.selectSingleNode("NegativePattern");f.NegativePattern=f.NegativePattern?f.NegativePattern.text:"";f.DecimalDigits=h.selectSingleNode("DecimalDigits");f.DecimalDigits=f.DecimalDigits?f.DecimalDigits.text.toInt():"";f.DecimalSeparator=h.selectSingleNode("DecimalSeparator");f.DecimalSeparator=f.DecimalSeparator?f.DecimalSeparator.text:"";f.GroupSeparator=h.selectSingleNode("GroupSeparator");f.GroupSeparator=f.GroupSeparator?f.GroupSeparator.text:"";var rt=h.selectNodes("GroupSizes/GroupSize");f.GroupSizes=[];for(var q=0;q<rt.length;q++)f.GroupSizes[q]=rt[q].text.toInt();t.PercentDetails=f;for(var a=n.selectNodes("DateTimePatterns/DateTimePattern"),ut=[],q=0;q<a.length;q++){var e={};e.Symbol=a[q].selectSingleNode("Symbol");e.Symbol=e.Symbol?e.Symbol.text:"";e.DisplayName=a[q].selectSingleNode("DisplayName");e.DisplayName=e.DisplayName?e.DisplayName.text:"";e.Value=a[q].selectSingleNode("Value");e.Value=e.Value?e.Value.text:"";ut[q]=e}t.DateTimePatterns=ut;t.DateTimeSettings={};t.DateTimeSettings.AMDesignator=n.selectSingleNode("DateTimeSettings/AMDesignator");t.DateTimeSettings.AMDesignator=t.DateTimeSettings.AMDesignator?t.DateTimeSettings.AMDesignator.text:"";t.DateTimeSettings.PMDesignator=n.selectSingleNode("DateTimeSettings/PMDesignator");t.DateTimeSettings.PMDesignator=t.DateTimeSettings.PMDesignator?t.DateTimeSettings.PMDesignator.text:"";t.DateTimeSettings.FirstDayOfWeek=n.selectSingleNode("DateTimeSettings/FirstDayOfWeek");t.DateTimeSettings.FirstDayOfWeek=t.DateTimeSettings.FirstDayOfWeek?t.DateTimeSettings.FirstDayOfWeek.text:"";t.DateTimeSettings.Today=n.selectSingleNode("DateTimeSettings/Today");t.DateTimeSettings.Today=t.DateTimeSettings.Today?t.DateTimeSettings.Today.text:"";t.DateTimeSettings.Tomorrow=n.selectSingleNode("DateTimeSettings/Tomorrow");t.DateTimeSettings.Tomorrow=t.DateTimeSettings.Tomorrow?t.DateTimeSettings.Tomorrow.text:"";t.DateTimeSettings.Yesterday=n.selectSingleNode("DateTimeSettings/Yesterday");t.DateTimeSettings.Yesterday=t.DateTimeSettings.Yesterday?t.DateTimeSettings.Yesterday.text:"";t.DateTimeSettings.NextWeek=n.selectSingleNode("DateTimeSettings/NextWeek");t.DateTimeSettings.NextWeek=t.DateTimeSettings.NextWeek?t.DateTimeSettings.NextWeek.text:"";t.DateTimeSettings.LastWeek=n.selectSingleNode("DateTimeSettings/LastWeek");t.DateTimeSettings.LastWeek=t.DateTimeSettings.LastWeek?t.DateTimeSettings.LastWeek.text:"";t.DateTimeSettings.FriendlyDateTimeFormatString=n.selectSingleNode("DateTimeSettings/FriendlyDateTimeFormatString");t.DateTimeSettings.FriendlyDateTimeFormatString=t.DateTimeSettings.FriendlyDateTimeFormatString?t.DateTimeSettings.FriendlyDateTimeFormatString.text:"";t.DateTimeSettings.FriendlyDateTimeNextLastWeekFormatString=n.selectSingleNode("DateTimeSettings/FriendlyDateTimeNextLastWeekFormatString");t.DateTimeSettings.FriendlyDateTimeNextLastWeekFormatString=t.DateTimeSettings.FriendlyDateTimeNextLastWeekFormatString?t.DateTimeSettings.FriendlyDateTimeNextLastWeekFormatString.text:"";for(var ft=n.selectNodes("DateTimeSettings/ShortDayNames/ShortDayName"),et=[],q=0;q<ft.length;q++)et[q]=ft[q].text;t.DateTimeSettings.ShortDayNames=et;for(var ot=n.selectNodes("DateTimeSettings/ShortestDayNames/ShortestDayName"),st=[],q=0;q<ot.length;q++)st[q]=ot[q].text;t.DateTimeSettings.ShortestDayNames=st;for(var ht=n.selectNodes("DateTimeSettings/DayNames/DayName"),ct=[],q=0;q<ht.length;q++)ct[q]=ht[q].text;t.DateTimeSettings.DayNames=ct;for(var lt=n.selectNodes("DateTimeSettings/ShortMonthNames/ShortMonthName"),at=[],q=0;q<lt.length;q++)at[q]=lt[q].text;t.DateTimeSettings.ShortMonthNames=at;for(var vt=n.selectNodes("DateTimeSettings/MonthNames/MonthName"),yt=[],q=0;q<vt.length;q++)yt[q]=vt[q].text;if(t.DateTimeSettings.MonthNames=yt,checkExists(n.selectNodes("DateTimeSettings/ShortTimeUnitNames")[0])){for(var y=n.selectNodes("DateTimeSettings/ShortTimeUnitNames")[0].childNodes,pt=[],q=0;q<y.length;q++){var p={};p.Name=y[q].tagName;p.Text=y[q].text;pt[q]=p}t.DateTimeSettings.ShortTimeUnitNames=pt}if(checkExists(n.selectNodes("DateTimeSettings/MediumTimeUnitNames")[0])){for(var w=n.selectNodes("DateTimeSettings/MediumTimeUnitNames")[0].childNodes,wt=[],q=0;q<w.length;q++){var b={};b.Name=w[q].tagName;b.Text=w[q].text;wt[q]=b}t.DateTimeSettings.MediumTimeUnitNames=wt}if(checkExists(n.selectNodes("DateTimeSettings/LongTimeUnitNames")[0])){for(var k=n.selectNodes("DateTimeSettings/LongTimeUnitNames")[0].childNodes,bt=[],q=0;q<k.length;q++){var d={};d.Name=k[q].tagName;d.Text=k[q].text;bt[q]=d}t.DateTimeSettings.LongTimeUnitNames=bt}return t.CalendarType=n.selectSingleNode("CalendarType"),t.CalendarType=t.CalendarType?t.CalendarType.text:"",this.cultureObject=t,t},replaceListCultureNodeWithDetailedCultureNode:function(n,t){checkExists(this.cultureXml)||(this.cultureXml=parseXML("<Cultures><\/Cultures>"));var q=this.cultureXml.selectSingleNode("Cultures/Culture[Name='{0}']".format(n)),u=t.selectSingleNode("Cultures/Culture[Name='{0}']".format(n));if(checkExists(q)){var f=q.parentNode;f.replaceChild(u.cloneNode(!0),q)}else{var r=this.cultureXml.selectSingleNode("Cultures");checkExists(r)||(this.cultureXml=parseXML("<Cultures><\/Cultures>"),r=this.cultureXml.selectSingleNode("Cultures"));r.appendChild(u.cloneNode(!0))}},getDefaultFormatObject:function(n){if(checkExists(SCCultureHelper.defaultFormatObjects)||(SCCultureHelper.defaultFormatObjects={}),!checkExists(SCCultureHelper.defaultFormatObjects[n])){var t={};t.type="date";t.cultureObject=this.getCultureObject(this.currentCultureName,null);t.cultureObject.type="date";switch(n){case"date":t.pattern=t.cultureObject.pattern="yyyy-MM-dd";break;case"time":t.pattern=t.cultureObject.pattern="HH:mm:ss.FFF";break;case"datetime":t.pattern=t.cultureObject.pattern="yyyy-MM-dd HH:mm:ssZ"}SCCultureHelper.defaultFormatObjects[n]=t}return SCCultureHelper.defaultFormatObjects[n]},getFormatObject:function(n){var q=null;if(n&&n!==""){q={};var t=this._formatObjectNodeCache[n];if(!checkExists(t)){var h=parseXML(n);t=h.selectSingleNode("Format");this._formatObjectNodeCache[n]=t}var u=t.getAttribute("Culture"),f=t.getAttribute("Type"),e=t.getAttribute("CurrencySymbol"),o=t.getAttribute("NegativePattern"),c=t.getAttribute("TimeZone"),s=t.text;q.type=f;q.pattern=s;q.timeZone=c;u&&u!==""||(u=this.currentCultureName);var l=this.getCultureObject(u,null),r=jQuery.extend({},l);e!==""&&(r.OverrideCurrencySymbol=e);o!==""&&(r.OverrideNegativePattern=o);r.type=f;r.pattern=s;q.cultureObject=r}return q},testForDateFormat:function(n){checkExists(n)&&typeof n!="object"&&(n=this.getFormatObject(n));var q=!1;if(checkExists(n)){var t=n.pattern,r=n.type;r==="Date"?q=!0:(r==="Custom"||!checkExistsNotEmpty(r))&&checkExistsNotEmpty(t)&&(!this.customDateRegex.test(t)&&(this.numberRegex.test(t)||this.customNumberRegex.test(t))||(q=!0))}return q},applyFormatToValueAndStyleXml:function(n,t,q){var f=q;try{var s=this.getFormatObject(n);if(s&&q&&q!==""){var o={formatObject:s,value:q};if(f=this.applyFormatToString(o),checkExists(o.negativePattern)&&o.negativePattern.contains("[Red]")&&checkExists(f))if(f.contains("[Red]")){f=f.replace(/\[Red\]/,"");checkExists(t)||(t=parseXML("<Style IsDefault='True'><Font><\/Font><\/Style>"));var e=t.selectSingleNode("Style");e||(e=t.createElement("Style"),e.setAttribute("IsDefault","True"),t.root.appendChild(e));var u=e.selectSingleNode("Font");u||(u=t.createElement("Font"),e.appendChild(u));var r=u.selectSingleNode("Color");r?r.firstChild&&r.removeChild(r.firstChild):(r=t.createElement("Color"),u.appendChild(r));r.appendChild(t.createTextNode("red"))}else if(checkExists(t)){var u=t.selectSingleNode("Style/Font[Color='red']");if(checkExists(u)){var r=u.selectSingleNode("Color");checkExists(r)&&u.removeChild(r)}}}}catch(h){typeof console!="undefined"&&typeof console.log!="undefined"&&console&&console.log&&(console.log("Format not applied"),console.log("format: "+n),console.log("value: "+q))}return f},applyFormatToControlValue:function(n){var q=n.value;try{if(checkExists(n.formatObject)||(n.formatObject=this.getFormatObject(n.formatXmlString)),checkExists(n.formatObject)&&(q=this.applyFormatToString(n),checkExists(n.negativePattern)&&n.negativePattern.contains("[Red]"))){var t=null;checkExists(n.elementToStyle)&&(checkExists(n.elementToStyle.length)||(n.elementToStyle=jQuery(n.elementToStyle)),n.elementToStyle.length>0&&(t=n.elementToStyle[0]));checkExists(q)&&checkExists(t)&&(q.contains("[Red]")?(q=q.replace(/\[Red\]/,""),n.elementToStyle&&checkExists(t.style)&&(t.style.color="red")):n.elementToStyle&&checkExists(t.style)&&checkExists(t.style.color)&&(t.style.color="red")&&(t.style.color=""))}}catch(r){typeof console!="undefined"&&typeof console.log!="undefined"&&console&&console.log&&(console.log("Format not applied"),console.log("styleOptions: "+n),console.log("result: "+q))}return q},applyFormatToSmartObjectValue:function(n,t,q,r,u){var f=r,e=null;if(n==null&&t==null){var s=this.getFormatObject(q);if(s&&r&&r!==""){var c={formatObject:formatOject,value:r,doSimpleReplace:!0},l=SCCultureHelper.current.getEditableValue(c);e={formatObject:s,value:l,valueIsEditableValue:getEditableValue,DoNotHandleInvariantPointAsGroupSeparator:u};f=this.applyFormatToString(e)}}else{var h=this.getCultureObject(n,null);if(h!==null){var o=SCCultureHelper._getFormatForSmartObjectField(t);q&&q!==""&&(o.pattern=q);e={formatObject:{pattern:o.pattern,type:o.type,cultureObject:h},value:r,DoNotHandleInvariantPointAsGroupSeparator:u};f=this.applyFormatToString(e)}}return checkExists(e)&&checkExists(e.negativePattern)&&e.negativePattern.contains("[Red]")&&checkExists(f)&&f.contains("[Red]")&&(f=f.replace(/\[Red\]/,""),f="<span style='color:red;'>{0}<\/span>".format(f)),f},getUnformattedNumber:function(n,t,q,r){typeof q!="string"&&(q=q.toString());q=q.replace(/\s/g,"");q=this.replaceCultureValue(q,n.PercentSymbol,"");q=this.replaceCultureValue(q,n.CurrencySymbol,"");var u=!0;return checkExists(r)&&(u=!(r&&t.GroupSeparator=="."&&t.DecimalSeparator==","&&q.contains(".")&&!q.contains(","))),u&&(q=this.replaceCultureValue(q,t.GroupSeparator,"")),t.DecimalSeparator!=="."&&(q=this.replaceCultureValue(q,t.DecimalSeparator,".")),n.NegativeSign!=="-"&&(q=this.replaceCultureValue(q,n.NegativeSign,"-")),q=this.replaceCultureValue(q,n.PositiveSign,""),q=q.replace(new RegExp("(|)","g"),""),q=q.replace(new RegExp("&nbsp;","g"),""),q.indexOf("e")<0&&(q=q.trimZeros()),q},replaceCultureValue:function(n,t,q){for(var f=["^","$",".","|","?","*","+","(",")","{","}"],r=0;r<t.length;r++)for(var u=0;u<f.length;u++)if(t.charAt(r)===f[u]){t=t.substr(0,r)+"\\"+t.substr(r);r++;break}return n.replace(new RegExp(t,"g"),q)},getEditableValue:function(n){if((n.formatObject||(n.formatObject=this.getFormatObject(n.formatXmlString)),(!$chk(n)||!$chk(n.formatObject)||!$chk(n.value))&&$chk(n.value))||n.value==="")return n.value;var u=n.formatObject.pattern,h=n.formatObject.type,q=n.formatObject.cultureObject,t=n.value,e=n.value;if(t===null||t==="")return t;if(this.numberRegex.test(u)&&h!=="Date"){var c=u.charAt(0).toUpperCase(),r=null,l=SourceCode.Forms.Settings.Formatting.UnformattedEditState||n.doSimpleReplace;switch(c){case"F":case"E":r=q.NumberDetails;l=!0;break;case"N":r=q.NumberDetails;break;case"C":r=q.CurrencyDetails;break;case"P":r=q.PercentDetails}if(l===!0)t="."!==r.DecimalSeparator?n.value.contains(r.DecimalSeparator)?this.replaceCultureValue(n.value,".",""):this.replaceCultureValue(n.value,".",r.DecimalSeparator):n.value;else{var a=n.value;c==="P"?(n.value=this.replaceCultureValue(n.value,".",r.DecimalSeparator),t=this._formatPercentage(n,q,-1,!1)):(n.value=this.replaceCultureValue(n.value,r.DecimalSeparator,"."),t=this._formatNumber(n,q,r,!0,-1,!1,!1));n.value=a}}else if((this.customDateRegex.test(u)||h==="Date")&&!n.ignoreDates){for(var o=-1,s=0;s<q.DateTimePatterns.length&&o<0;s++)o=q.DateTimePatterns[s].Symbol===u?s:-1;o>=0&&(u=q.DateTimePatterns[o].Value);var f=this._convertDateStringToObj(n);if(f==null)return n.value=e,t=e,typeof n.formattingError!="undefined"&&(n.formattingError=!0),t;n.value=this._convertDateObjToString(f);t=this._formatDate(f,n.value,q,u,n.formatObject)}else if(this.customNumberRegex.test(u))t=this.replaceCultureValue(n.value,".",q.NumberDetails.DecimalSeparator);else if(u!==""&&!n.ignoreDates){var f=this._convertDateStringToObj(n);if(f==null)return n.value=e,t=e,typeof n.formattingError!="undefined"&&(n.formattingError=!0),t;n.value=this._convertDateObjToString(f);t=this._formatDate(f,n.value,q,u,n.formatObject)}return t},getFormatPatternByName:function(n){for(var f=n.formatObject.cultureObject,e=n.formatObject.pattern,q=f.SpecialDetails.Patterns,o=q.length,r,t=0;t<o;t++){var u=q[t],s=u.Name;if(s===e){r=u.Value;break}}return r},applyFormatToString:function(n){if((!$chk(n)||!$chk(n.formatObject)||!$chk(n.value))&&$chk(n.value)||n.value==="")return n.value;var r=n.formatObject.pattern,l=n.formatObject.type,q=n.formatObject.cultureObject,t=n.value,u=n.value;if(t===null){if(typeof n.formattingError!="undefined")return n.formattingError=!0,t}else if(t="")return t;if(l==="Special"&&checkExistsNotEmpty(u)&&checkExistsNotEmpty(r)){if(checkExistsNotEmpty(n.formatXmlString)){var qt=n.formatXmlString.contains("Culture");qt||(r=this.getFormatPatternByName(n))}t=checkExistsNotEmpty(r)?this.formatNumberPattern(u,r):u}else if(this.numberRegex.test(r)&&l!=="Date"){var h=null;r.length>1&&(h=r.replace(r.charAt(0),""));var rt=r.charAt(0).toUpperCase();switch(rt){case"F":n.value=this.getUnformattedNumber(q,q.NumberDetails,n.value,n.DoNotHandleInvariantPointAsGroupSeparator);t=this._formatNumber(n,q,q.NumberDetails,!1,h);break;case"N":n.value=this.getUnformattedNumber(q,q.NumberDetails,n.value,n.DoNotHandleInvariantPointAsGroupSeparator);t=this._formatNumber(n,q,q.NumberDetails,!0,h);break;case"E":if(n.value=this.getUnformattedNumber(q,q.NumberDetails,n.value,n.DoNotHandleInvariantPointAsGroupSeparator),n.value==="")return n.value=u,t=u,typeof n.formattingError!="undefined"&&(n.formattingError=!0),t;var v=0,e=n.value,w=e.toLowerCase().split("e");if(w.length>1){var b=w[1];if(b==="")v=0,n.value=n.value.substr(0,n.value.length-1);else if(v=b.toInt(),v===NaN||!b.isNumeric())return n.value=u,t=u,typeof n.formattingError!="undefined"&&(n.formattingError=!0),t}e=w[0];var d=e.indexOf("-")>=0;d&&(e=e.replace(/-/,""));var o=e.split("."),a="",y="",f="";if(o.length===1)y=o[0].substr(0,1),f=o[0].substr(1),a=f.length;else if(o.length===2)if(o[0]!=="0")y=o[0].substr(0,1),f=o[0].substr(1)+o[1],a=f.length-o[1].length;else{f=o[1];var k=f.substr(0,1);for(f=f.substr(1),a--;k==="0";)k=f.substr(0,1),f=f.substr(1),a--;y=k}else return n.value=u,t=u,typeof n.formattingError!="undefined"&&(n.formattingError=!0),t;e=y+"."+f;d&&(e="-"+e);t=this._formatNumber(n,q,q.NumberDetails,!0,h,e);var g=v+a.toInt();g!==0&&(t+="E"+g);break;case"C":n.value=this.getUnformattedNumber(q,q.CurrencyDetails,n.value,n.DoNotHandleInvariantPointAsGroupSeparator);t=this._formatNumber(n,q,q.CurrencyDetails,!0,h);break;case"P":t=this._formatPercentage(n,q,h)}}else if(this.customDateRegex.test(r)||l==="Date"){var c=this._convertDateStringToObj(n);if(c==null)return n.value=u,t=u,typeof n.formattingError!="undefined"&&(n.formattingError=!0),t;for(var p=0;p<q.DateTimePatterns.length;p++)if(q.DateTimePatterns[p].Symbol===r){r=q.DateTimePatterns[p].Value;break}n.value=this._convertDateObjToString(c);t=this._formatDate(c,n.value,q,r,n.formatObject)}else if(this.customNumberRegex.test(r)){n.value=this.getUnformattedNumber(q,q.NumberDetails,n.value);var ut=$xml("<xml/>");if(xslFormatter=new XslTransform,xslFormatter.importStylesheet(this.formatXsltPath),xslFormatter.addParameter("value",n.value),xslFormatter.addParameter("format",r),xslFormatter.addParameter("type",l),t=xslFormatter.transformToText(ut,null),t=parseXML(t).selectSingleNode("Result").text,t==="NaN")return n.value=u,t=u,typeof n.formattingError!="undefined"&&(n.formattingError=!0),t}else if(l==="Duration"){var nt=r.split(":")[0],tt=r.split(":")[1];if(nt===""||tt==="")return t;if(u.toInt()){var s=u.toInt();switch(tt.toLowerCase()){case"seconds":s=s*1e3;break;case"minutes":s=s*6e4;break;case"hours":s=s*36e5}t=new SourceCode.Forms.Duration(s).toString(nt,q)}else t=u}else if(r!==""){var c=this._convertDateStringToObj(n);if(c===null)return n.value=u,t=n.value,typeof n.formattingError!="undefined"&&(n.formattingError=!0),t;n.value=this._convertDateObjToString(c);t=this._formatDate(c,n.value,q,r,n.formatObject)}return typeof n.formattingError!="undefined"&&n.formattingError===!0&&(n.value=u,t=u),t},formatNumberPattern:function(n,t){var r=[],f=[];for(r=n.split("").reverse(),patternCharArray=t.split("").reverse();patternCharArray.length>0;){var u=patternCharArray[0],q;if(u==="#"||u==="0"){while(r.length>0)if(q=r[0],isNaN(q)||q===" "){q="";r.shift();continue}else break;checkExistsNotEmpty(q)||u!=="0"||(q="0");r.shift()}else q=u;if(patternCharArray.shift(),f.push(q),q="",r.length>0&&!patternCharArray.contains("#")&&!patternCharArray.contains("0")){while(r.length>0)if(q=r[0],isNaN(q)||q===" "){q="";r.shift();continue}else r.shift(),f.push(q),q="";r=[]}}return f.reverse().join("")},_convertDateObjToString:function(n,t){var q=null,r=n._type?n._type.toLowerCase():"";switch(r){case"time":case"date":q=n.toString();break;default:q=t===!0?this._convertDateObjToLocalString(n):this._convertDateObjToUTCString(n)}return q},_checkDateIsZuluDate:function(n,t){if(!$chk(n)||n.length!==20||n.charAt(19)!=="Z")return null;var f=n.removeNBSpace().split(" ");if(f.length!==2||f[0].length!==10||f[1].length!==9)return null;var q=f[0].split("-");if(q.length!==3||q[0].length!==4||q[1].length!==2||q[2].length!==2||!q[0].isNumeric()||!q[1].isNumeric()||!q[2].isNumeric())return null;var a=q[0].toInt(),v=q[1].toInt()-1,y=q[2].toInt(),r=f[1].substr(0,8).split(":");if(r.length!==3||r[0].length!==2||r[1].length!==2||r[2].length!==2||!r[0].isNumeric()||!r[1].isNumeric()||!r[2].isNumeric())return null;var p=r[0].toInt(),w=r[1].toInt(),b=r[2].toInt(),u=new Date,e=Date.UTC(a,v,y,p,w,b,0);if(u.setTime(e),t){var o=u.getTimeZoneOffset(),s=u.getTimeZoneOffset()*6e4;u.setTime(e+s);var h=u.getTimezoneOffset();if(h!==o){var c=Math.abs(o)!==o,k=Math.abs(h)-Math.abs(o),l=k*6e4;c&&u.setTime(e+s-l);c||u.setTime(e+s+l)}}return u},_convertDateObjToUTCString:function(n){var t=n.getUTCMonth()+1;t<10&&(t="0"+t);var q=n.getUTCDate();q<10&&(q="0"+q);var r=n.getUTCHours();r<10&&(r="0"+r);var u=n.getUTCMinutes();u<10&&(u="0"+u);var f=n.getUTCSeconds();f<10&&(f="0"+f);return n.getUTCFullYear()+"-"+t+"-"+q+" "+r+":"+u+":"+f+"Z"},_convertDateStringToObj:function(n){var t=null;try{var q;if(checkExists(n.dataType))q=n.dataType.toLowerCase();else{if(n.value instanceof Date||n.value._type==="date"||n.value._type==="time"||n.value._type==="datetime")return n.value;q="datetime"}n.formatObject=n.formatObject?n.formatObject:this.getDefaultFormatObject(q);switch(q){case"date":t=SourceCode.Forms.Date.parse(n.value,n.formatObject);break;case"time":t=SourceCode.Forms.Time.parse(n.value,n.formatObject);break;default:if(n.value instanceof Date||n.value._type==="datetime")t=n.value;else if(n.value._type==="date")t=Date.fromSFDate(n.value);else if(n.value._type==="time")t=Date.fromSFTime(n.value);else if(checkExists(n.formatObject)&&checkExistsNotEmpty(n.formatObject.timeZone))t=SourceCode.Forms.DateTime.parse(n.value,n.formatObject);else{var r=SourceCode.Forms.Time.parseImpl(n.value,n.formatObject,!1);checkExists(r)&&(t=Date.fromCurrentDateWithSFTime(r));t===null&&(t=this._convertUTCDateToObj(n.value,n.formatObject.cultureObject.Name,n.formatObject))}}}catch(u){SFLog({type:5,source:"Formatting",category:"Events",message:u,data:n})}return t},_convertDateObjToLocalString:function(n){if(typeof n.toLocalString=="function")return n.toLocalString();var t=n.getMonth()+1;t<10&&(t="0"+t);var q=n.getDate();q<10&&(q="0"+q);var r=n.getHours();r<10&&(r="0"+r);var u=n.getMinutes();u<10&&(u="0"+u);var f=n.getSeconds();f<10&&(f="0"+f);return n.getFullYear()+"-"+t+"-"+q+"T"+r+":"+u+":"+f},_isISODateFormat:/([Z]$)|([+-]{1}\d{2}:\d{2})|\d{4}-\d{2}-\d{2}(T|\s){1}\d{2}(:?\d{2}){1,2}(\.\d{1,7})?\s?[+-]{1}(\d{2}:\d{2}$|\d{2}$|\d{4}$)/i,_convertUTCDateToObj:function(n,t){var q=null;if(n instanceof Date||n._type==="date"||n._type==="time"||n._type==="datetime")return n;var q=this._checkDateIsZuluDate(n);if(!$chk(q)){this._isISODateFormat.lastIndex=0;var r=!this._isISODateFormat.test(n);q=this._checkDateIsZuluDate(this.parseDateOnServer(n,t,"u",!0),r)}return q},_getMonthNumber:function(n,t){for(var u=n.DateTimeSettings.ShortMonthNames.length,r=-1,q=0;q<u&&r<0;q++)(n.DateTimeSettings.ShortMonthNames.toLowerCase()==t.toLowerCase()||n.DateTimeSettings.MonthNames.toLowerCase()==t.toLowerCase())&&(r=q)},getParticularFormatForDate:function(n,t,q){typeof formatXmlString=="string"&&(n=this.getFormatObject(formatXmlString));for(var r=-1,u=0;u<n.cultureObject.DateTimePatterns.length&&r<0;u++)r=n.cultureObject.DateTimePatterns[u].Symbol===t?u:-1;return r>=0&&(t=n.cultureObject.DateTimePatterns[r].Value),this._formatDate(q,null,n.cultureObject,t,n)},getParticularFormat:function(n,t,q){var r=q;try{var u=this.getFormatObject(n);if(u.pattern=t,u&&q&&q!==""){var f={formatObject:u,value:q};r=this.applyFormatToString(f);$chk(r)&&r.contains("[Red]")&&(r=r.replace(/\[Red\]/,""))}}catch(e){typeof console!="undefined"&&typeof console.log!="undefined"&&console&&console.log&&(console.log("Format not applied"),console.log("format: "+n),console.log("value: "+q))}return r},_formatPercentage:function(n,t,q,r){if(checkExists(r)||(r=!0),originalFormatValue=n.value,n.value=this.getUnformattedNumber(t,t.PercentDetails,n.value,n.DoNotHandleInvariantPointAsGroupSeparator),n.value==="")return n.value=originalValue,result=originalValue,typeof n.formattingError!="undefined"&&(n.formattingError=!0),result;var s=n.value.split(".");if(s.length>2)return n.value=originalValue,result=originalValue,typeof n.formattingError!="undefined"&&(n.formattingError=!0),result;var u=null,e=n.value.indexOf("-")>=0;if(typeof originalFormatValue!="string"&&(originalFormatValue=originalFormatValue.toString()),originalFormatValue.contains(t.PercentSymbol)||n.valueIsEditableValue===!1&&!SourceCode.Forms.Settings.Formatting.UnformattedEditState){u=n.value;e&&(u=u.replace(/-/,""));for(var f=u.split(".");f[0].length<3;)f[0]="0"+f[0];n.value=f[0].substr(0,f[0].length-2)+"."+f[0].substr(f[0].length-2);f.length>1&&(n.value+=f[1]);n.value=(e?"-":"")+n.value.trimZeros()}else{u=n.value;e&&(u=u.replace(/-/,""));var f=u.split(".");if(u=f[0],f.length===1)u+="00";else if(f.length===2)if(u=f[0],f[1].length===0)u+="00";else if(f[1].length===1)u+=f[1]+"0";else{var h=f[1].substr(0,2),o="";f[1].length>2&&(o=f[1].substr(2));u+=h;o!==""&&(u+="."+o)}else return n.value=originalValue,result=originalValue,typeof n.formattingError!="undefined"&&(n.formattingError=!0),result}return u=u.trimZeros(),e&&(u="-"+u),result=this._formatNumber(n,t,t.PercentDetails,!0,q,u,r)},_formatNumber:function(n,t,q,r,u,f,e){checkExists(e)||(e=!0);var d=$chk(f)?f:n.value;(u===undefined||u===null||u==="")&&(u=q.DecimalDigits);typeof u=="string"&&(u=parseInt(u));var s,o="";try{s=new Big(d)}catch(g){s=g}if(isNaN(s))return typeof n.formattingError!="undefined"&&(n.formattingError=!0),n.value;var y=s.lt(0);y&&(s=s.negate());var c=[];u>0?(s=s.round(u),c=s.toFixed(u).split(".")):c=s.toFixed().split(".");var a=c[0],nt=u!==0&&c.length>1?c[1]:"",h="",p=nt;if(r&&a!=="0")for(var w=a+"",l=w.length;l>0;l=l-3){var v=l-3;v<0&&(v=0);h=w.substring(v,l)+h;v!==0&&(h=q.GroupSeparator+h)}else r&&a!=="0"||(h=a);var b=h;p!==""&&(b+=q.DecimalSeparator+p);n.negativePattern=checkExistsNotEmpty(t.OverrideNegativePattern)?t.OverrideNegativePattern:q.NegativePattern;o=y&&e?n.negativePattern:q.PositivePattern;var k=t.CurrencySymbol;return t.OverrideCurrencySymbol&&(k=t.OverrideCurrencySymbol),y&&(o=e?o.replace(/-/g,t.NegativeSign):"-"+o),o=o.replace(/\%/g,t.PercentSymbol),o=o.replace(/\$/g,k),o=o.replace(/n/g,b),o===Number.NaN&&(o=t.NaNSymbol),o},_getCalendarMonth:function(n,t){this.getFormatObject(t);var q=this.getFormatObject(t),r=q.cultureObject},_formatDate:function(n,t,q,r){if(checkExists(n)){var u=null;switch(q.CalendarType){case"GregorianCalendar":u=this._formatGregorianDate(n,q,r);break;default:var f=this._convertDateObjToLocalString(n);u=this.parseDateOnServer(f,"",r,!1,q.Name)}}return u},df:[{p:/YYYY/i,v:"{0}"},{p:/YY/i,v:"{1}"},{p:/y/i,v:"{2}"},{p:/MMMM/,v:"{3}"},{p:/MMM/,v:"{4}"},{p:/MM/,v:"{5}"},{p:/M/,v:"{6}"},{p:/DDDD/i,v:"{7}"},{p:/DDD/i,v:"{8}"},{p:/DD/i,v:"{9}"},{p:/D/i,v:"{10}"},{p:/#th#/,v:"{11}"},{p:/hhh/,v:"{12}"},{p:/hh/,v:"{13}"},{p:/h/,v:"{12}"},{p:/mm/,v:"{14}"},{p:/m/,v:"{15}"},{p:/ss/,v:"{16}"},{p:/s/,v:"{17}"},{p:/ampm/,v:"{18}"},{p:/tt/,v:"{18}"},{p:/t/,v:"{19}"},{p:/HH/,v:"{20}"},{p:/H/,v:"{21}"},{p:/FFFFFFF/,v:"{22}"},{p:/FFFFFF/,v:"{23}"},{p:/FFFFF/,v:"{24}"},{p:/FFFF/,v:"{25}"},{p:/FFF/,v:"{26}"},{p:/FF/,v:"{27}"},{p:/F/,v:"{28}"},{p:/'|#/g,v:""}],_quotes:/'(.*?)'/,_formatGregorianDate:function(n,t,q){n._type==="datetime"&&(n=n.localDate());var l,a,w,b,k,e,d,g,nt,f,tt,qt,u,rt,o,ut,s,v,y,ft;l=n.getFullYear()+"";a=l.substr(2,2);Y=parseInt(a,10)+"";k=(e=n.getMonth()+1)<10?"0"+e:e;w=t.DateTimeSettings.MonthNames[n.getMonth()];b=t.DateTimeSettings.ShortMonthNames[n.getMonth()];nt=(f=n.getDate())<10?"0"+f:f;d=t.DateTimeSettings.DayNames[n.getDay()];g=t.DateTimeSettings.ShortDayNames[n.getDay()];ft=f>=10&&f<=20?"th":(y=f%10)==1?"st":y===2?"nd":y===3?"rd":"th";u=tt=n.getHours();var ot=u,st=u<10?"0"+u:u;u===0&&(u=24);u>12&&(u-=12);qt=u<10?"0"+u:u;v=tt<12?t.DateTimeSettings.AMDesignator:t.DateTimeSettings.PMDesignator;rt=(o=n.getMinutes())<10?"0"+o:o;ut=(s=n.getSeconds())<10?"0"+s:s;FFF=n.getMilliseconds();FFF<100&&(FFF="0"+FFF);FF=Math.round(FFF/10);F=Math.round(FFF/100);FFFF=FFF+"0";FFFFF=FFFF+"0";FFFFFF=FFFFF+"0";FFFFFFF=FFFFFF+"0";var r=[];r[0]=l;r[1]=a;r[2]=Y;r[3]=w;r[4]=b;r[5]=k;r[6]=e;r[7]=d;r[8]=g;r[9]=nt;r[10]=f;r[11]=ft;r[12]=u;r[13]=qt;r[14]=rt;r[15]=o;r[16]=ut;r[17]=s;r[18]=v;r[19]=v[0];r[20]=st;r[21]=ot;r[22]=FFFFFFF;r[23]=FFFFFF;r[24]=FFFFF;r[25]=FFFF;r[26]=FFF;r[27]=FF;r[28]=F;for(var et=this.df.length,h=et,p=this._quotes.exec(q);checkExists(p);)r[h]=p[1],q=q.replace(this._quotes,"{{0}}".format(h)),h=h+1,p=this._quotes.exec(q);for(var c=0;c<et;c++)q=q.replace(this.df[c].p,this.df[c].v);return q.format(r)},getSampleValue:function(n,t,q){var r="";switch(n){case"Number":r="-6789.1234";case"Currency":r="-6789.1234";break;case"Percentage":r="-6789.1234";break;case"Scientific":r="-6789.1234";break;case"Special":checkExistsNotEmpty(q)&&(r=this.getPreviewText(q));break;case"Date":r=this._convertDateObjToString(new Date);break;case"Custom":r=t.test(this.customNumberRegex)||t.test(this.numberRegex)?"-6789.1234":this._convertDateObjToString(new Date);break;case"Duration":r="6789";break;default:r="AaYy"}return r},getPreviewText:function(n){var r=SCCultureHelper.current.cultureObject.SpecialDetails.Patterns.length,t;for(p=0;p<r;p++){var q=SCCultureHelper.current.cultureObject.SpecialDetails.Patterns[p];if(q.Name===n){t=q.PreviewText;break}}return t},parseDateOnServer:function(n,t,q,r,u,f){var e={method:"parseDate",value:encodeURIComponent(n),pattern:q,toUniversalTime:r,cultureName:checkExists(t)?t:"",formatCultureName:checkExists(u)?u:"",timeZone:checkExists(f)?f:""},o={url:applicationRoot+"Runtime/CalendarAJAXCall.ashx",type:"GET",data:e,async:!1,dataType:"text",cache:!0},s=jQuery.ajax(o);return this.parseDateOnServerSuccess(s.responseText)},parseDateOnServerSuccess:function(n){return SourceCode.Forms.ExceptionHandler.isException(n)?null:n},parseDateOnServerError:function(){},getTimeZoneOffset:function(n,t){if(!checkExistsNotEmpty(t)||!checkExists(n))return 0;var r=this.timeZones.lookup[t];if(!checkExists(r)){var f=this.queryTimeZones(function(n){return n.Id.toUpperCase()===t.toUpperCase()});if(!f||f.length===0)throw new Error('Timezone "{0}" could not be found'.format(t));r=f[0]}var e=n,u=r.BaseUtcOffset,o=n;if(!r.SupportsDaylightSavingTime)return 0-u;for(var h=r.AdjustmentRules,s=0,q;q=h[s];++s)if(q.DateStart=SourceCode.Forms.DateTime.parse(q.DateStart),q.DateEnd=SourceCode.Forms.DateTime.parse(q.DateEnd),q.DateStart.compareTo(o)<=0&&q.DateEnd.compareTo(o)>=0){u+=q.IsFixedDateRule?this.getFixedDaylightAdjustment(q,e):this.getFloatingDaylightAdjustment(q,e,u);break}return 0-u},getFixedDaylightAdjustment:function(n,t){var q=n.DaylightTransitionStart.FixedDate=SourceCode.Forms.DateTime.parse(n.DaylightTransitionStart.FixedDate),r=n.DaylightTransitionEnd.FixedDate=SourceCode.Forms.DateTime.parse(n.DaylightTransitionEnd.FixedDate);return q.setFullYear(t.getUTCFullYear(),q.getUTCMonth(),q.getUTCDate()),r.setFullYear(t.getUTCFullYear(),r.getUTCMonth(),r.getUTCDate()),q<r?q.compareTo(t)<=0&&r.compareTo(t)>0?n.DaylightDelta:0:t.compareTo(r)>=0&&t.compareTo(q)<0?0:n.DaylightDelta},getFloatingDate:function(n,t,q){n.TimeOfDay=SourceCode.Forms.DateTime.parse(n.TimeOfDay);var r=n.TimeOfDay.clone();if(r.year(t.year()),r.month(n.Month),n.Week>4){r.day(SourceCode.Forms.DateTime.daysInMonth(t.year(),n.Month));var f=r.getDay()-n.DayOfWeek;f<0&&(f=f+7);f>0&&SourceCode.Forms.DateTime.addDays(r,0-f,!1)}else{r.day(1);var f=r.getDay(),u=n.DayOfWeek-f;u<0&&(u=u+7);u=u+7*(n.Week-1);u>0&&SourceCode.Forms.DateTime.addDays(r,u,!1)}return SourceCode.Forms.DateTime.addTime(r,4,0-q,!1),r},getFloatingDaylightAdjustment:function(n,t,q){var u=this.getFloatingDate(n.DaylightTransitionStart,t,q),r=this.getFloatingDate(n.DaylightTransitionEnd,t,q+n.DaylightDelta),f=u.year(),e=r.year();f!=e&&SourceCode.Forms.DateTime.addYears(r,f-e,!1);var o=t.year();f!=o&&(t=SourceCode.Forms.DateTime.addYears(t,f-o));var s=!1;return s=u<=r?t.compareTo(u)<0?!1:t.compareTo(r)<0:t.compareTo(r)<0?!0:t.compareTo(u)>=0,s?n.DaylightDelta:0},queryTimeZones:function(n){if(!checkExists(this.timeZones))throw Resources.RuntimeMessages.TimeZonesUnresolved;if(typeof n!="function")throw Resources.RuntimeMessages.TimeZonesQueryNotAFunction;return this.timeZones.filter(n)}};jQuery.extend(SourceCode.Forms.CultureHelper.prototype,t);SourceCode.Forms.CultureHelper._getFormatForSmartObjectField=function(n){var t={};switch(n){case"number":t.type="Number";t.pattern="N0";break;case"decimal":t.type="Number";t.pattern="N2";break;case"autonumber":t.type="Number";t.pattern="N0";break;case"datetime":t.type="Date";t.pattern="F"}return t};SourceCode.Forms.CultureHelper.getFormatXmlForSmartObjectField=function(n){var t=SCCultureHelper._getFormatForSmartObjectField(n);return typeof t.type!="undefined"&&t.pattern!=="undefined"?"<Format Type='{0}'>{1}<\/Format>".format(t.type,t.pattern):""};SourceCode.Forms.CultureHelper.setupCultureXml=function(n,t,q,r){if(!SCCultureHelper.current){SCCultureHelper.current=new SourceCode.Forms.CultureHelper(t,n,r);var u=parseXML(q);SCCultureHelper.current.replaceListCultureNodeWithDetailedCultureNode(n,u)}};SourceCode.Forms.CultureHelper.setupCultureXmlAjax=function(){SCCultureHelper.current||n.ajax({data:{method:"getCulturesListAndCurrentCultureDetailsAndTimezones"},async:!1,dataType:"xml",url:applicationRoot+"Runtime/AJAXCall.ashx",error:function(n,t){popupManager.showError("<p>".concat(Resources.RuntimeMessages.CulutureInformationFailedToLoad,"<\/p><p>[",n.status,"] ",n.statusText," (",t,")<\/p>"))}.bind(this),success:function(n){if(!SourceCode.Forms.ExceptionHandler.handleException(n)){var t=n.selectSingleNode("Results/CurrentCulture").text,q=n.selectSingleNode("Results/Cultures").xml,r=n.selectSingleNode("Results/Timezones").text;SCCultureHelper.current=new SourceCode.Forms.CultureHelper(q,t,r)}}.bind(this)})};SourceCode.Forms.CultureHelper.Current=function(){return SourceCode.Forms.CultureHelper.setupCultureXmlAjax(),SourceCode.Forms.CultureHelper.current};SourceCode.Forms.CultureHelper.addPendingCall=function(n){checkExists(SourceCode.Forms.CultureHelper.current)?n():(checkExists(SourceCode.Forms.CultureHelper.pendingCalls)||(SourceCode.Forms.CultureHelper.pendingCalls=[]),SourceCode.Forms.CultureHelper.pendingCalls.push(n))};SourceCode.Forms.CultureHelper.createCurrent=function(n,t,q,r){if(SCCultureHelper.current=new SourceCode.Forms.CultureHelper(n,t,q,r),checkExists(SourceCode.Forms.CultureHelper.pendingCalls)){for(var u=0;u<SourceCode.Forms.CultureHelper.pendingCalls.length;u++)SourceCode.Forms.CultureHelper.pendingCalls[u]();SourceCode.Forms.CultureHelper.pendingCalls=[]}};SCCultureHelper=SourceCode.Forms.CultureHelper;SCCultureHelper.current=null})(jQuery);
/*!
 ~/Script/SourceCode.Forms.DateTime.js
*/
(function(n){(typeof SourceCode=="undefined"||SourceCode===null)&&(SourceCode={});(typeof SourceCode.Forms=="undefined"||SourceCode.Forms===null)&&(SourceCode.Forms={});var r;SourceCode.Forms.DateHelper=r={units:{millisecond:1,second:1e3,minute:6e4,hour:36e5,day:864e5,week:6084e5,month:26784e5,year:31536e6},getShortResolutionIdentifier:function(n){return Resources.RuntimeMessages["ShortResolutionIdentifier_"+this.getResolutionIdentifier(n)]},getMediumResolutionIdentifier:function(n){return Resources.RuntimeMessages["MediumResolutionIdentifier_"+this.getResolutionIdentifier(n)]},getMediumSingularResolutionIdentifier:function(n){return Resources.RuntimeMessages["MediumResolutionIdentifierSingular_"+this.getResolutionIdentifier(n)]},getLongResolutionIdentifier:function(n){return Resources.RuntimeMessages["LongResolutionIdentifier_"+this.getResolutionIdentifier(n)]},getLongSingularResolutionIdentifier:function(n){return Resources.RuntimeMessages["LongResolutionIdentifierSingular_"+this.getResolutionIdentifier(n)]},getResolutionIdentifier:function(n){var t="millisecond";if(checkExists(n)){var q=n.toUpperCase();switch(q){case"MS":case"MILLISECOND":case"MILLISECONDS":t="millisecond";break;case"S":case"SS":case"SEC":case"SECOND":case"SECONDS":t="second";break;case"N":case"MI":case"MIN":case"MINUTE":case"MINUTES":t="minute";break;case"H":case"HH":case"HOUR":case"HOURS":t="hour";break;case"D":case"DD":case"DAY":case"DAYS":t="day";break;case"WW":case"WK":case"WEEK":case"WEEKS":t="week";break;case"M":case"MM":case"MONTH":case"MONTHS":t="month";break;case"Y":case"YY":case"YYYY":case"YEAR":case"YEARS":t="year"}}return t},getUnitMultiplier:function(n){return r.units[r.getResolutionIdentifier(n)]},getDayDifferenceBetweenTwoDates:function(n,q){var r=null,u=null,o=1;n<q?(r=new t(q.getFullYear(),q.getMonth()+1,q.getDate()),u=new t(n.getFullYear(),n.getMonth()+1,n.getDate()),o=-1):(r=new t(n.getFullYear(),n.getMonth()+1,n.getDate()),u=new t(q.getFullYear(),q.getMonth()+1,q.getDate()));var h=r.getFullYear()-u.getFullYear(),f=0;if(h>1){f+=SourceCode.Forms.DateHelper.getNumberOfDaysLeftForTheYear(u)+SourceCode.Forms.DateHelper.getNumberOfDaysPassedForTheYear(r);for(var e=u.getFullYear()+1;e<r.getFullYear();)f+=Date.isLeapYear(e)?366:365,e+=1}else for(var c=new t(r.getFullYear(),r.getMonth()+1,r.getDate()),s=new t(u.getFullYear(),u.getMonth()+1,u.getDate());c>s;)s.increment(1),f++;return f*o},getNumberOfDaysLeftForTheYear:function(n){for(var q=new t(n.getFullYear(),n.getMonth()+1,n.getDate()),r=0,u=q.getFullYear()+1;q.getFullYear()<u;)q.increment(1),r++;return r--,r},getNumberOfDaysPassedForTheYear:function(n){for(var q=new t(n.getFullYear(),n.getMonth()+1,n.getDate()),r=0,u=q.getFullYear()-1;q.getFullYear()>u;)q.decrement(1),r++;return r},compareTo:function(n,t,q){for(var r=0,f=0,e=n.length;r===0&&f<e;){var u=n[f];t[u]>q[u]?r=1:t[u]===q[u]?f++:r=-1}return r}};var o={getFullYear:function(){return 0},getMonth:function(){return 0},getWeek:function(){return 0},getDate:function(){return 0},getDay:function(){return 0},getHours:function(){return 0},getMinutes:function(){return 0},getSeconds:function(){return 0},getMilliseconds:function(){return 0},getUTCFullYear:function(){return 0},getUTCMonth:function(){return 0},getUTCWeek:function(){return 0},getUTCDate:function(){return 0},getUTCDay:function(){return 0},getUTCHours:function(){return 0},getUTCMinutes:function(){return 0},getUTCSeconds:function(){return 0},getUTCMilliseconds:function(){return 0},getTimeZoneOffset:function(){return 0},setFullYear:function(){throw Resources.RuntimeMessages.DateTimeInvalidOperation.format("setFullYear",this._type);},setMonth:function(){throw Resources.RuntimeMessages.DateTimeInvalidOperation.format("setMonth",this._type);},setDate:function(){throw Resources.RuntimeMessages.DateTimeInvalidOperation.format("setDate",this._type);},setHours:function(){throw Resources.RuntimeMessages.DateTimeInvalidOperation.format("setHours",this._type);},setMinutes:function(){throw Resources.RuntimeMessages.DateTimeInvalidOperation.format("setMinutes",this._type);},setSeconds:function(){throw Resources.RuntimeMessages.DateTimeInvalidOperation.format("setSeconds",this._type);},setMilliseconds:function(){throw Resources.RuntimeMessages.DateTimeInvalidOperation.format("setMilliseconds",this._type);},setUTCFullYear:function(){throw Resources.RuntimeMessages.DateTimeInvalidOperation.format("setUTCFullYear",this._type);},setUTCMonth:function(){throw Resources.RuntimeMessages.DateTimeInvalidOperation.format("setUTCMonth",this._type);},setUTCDate:function(){throw Resources.RuntimeMessages.DateTimeInvalidOperation.format("setUTCDate",this._type);},setUTCHours:function(){throw Resources.RuntimeMessages.DateTimeInvalidOperation.format("setUTCHours",this._type);},setUTCMinutes:function(){throw Resources.RuntimeMessages.DateTimeInvalidOperation.format("setUTCMinutes",this._type);},setUTCSeconds:function(){throw Resources.RuntimeMessages.DateTimeInvalidOperation.format("setUTCSeconds",this._type);},setUTCMilliseconds:function(){throw Resources.RuntimeMessages.DateTimeInvalidOperation.format("setUTCMilliseconds",this._type);},convertTime:function(){return this},clearUTCTime:function(){return this},clearTime:function(){return this},toLocalString:function(){return this.toString()},getLocalTime:function(){return this.getTime()}},t;SourceCode.Forms.Date=t=function(){this._create.apply(this,arguments)};n.extend(t,{keys:["_year","_month","_day"],stringFormat:"{0}-{1}-{2}",leapYearCache:{},_zeroDate:null,now:function(){return new t},expressions:{isodate:/^\s*(\d{1,4})-(\d{1,2})-(\d{1,2})\s*$/},isLeapYear:function(n){if(!checkExists(t.leapYearCache[n])){var q=n%4,r=n%100;t.leapYearCache[n]=q===0&&r!==0||q===0&&r===0&&n%400==0}return t.leapYearCache[n]},daysInMonth:function(n,q){var r=31;return q===9||q===4||q===6||q===11?r=30:q===2&&(r=t.isLeapYear(n)?29:28),r},correctDateValue:function(n){n._day<1&&(n._month=n._month-1);n._month<1&&(n._year=n._year-1,n._month=12+n._month);n._day<1&&(n._day=t.daysInMonth(n._year,n._month)+n._day);var r=t.daysInMonth(n._year,n._month),q=n._day-r;return q>0?n._day=r:q=0,q},addYears:function(n,q,r){var u;u=checkExists(r)&&r!==!0?n:n.clone();checkExists(q.toFloat)&&(q=q.toFloat());var f=u.year();return u._year=f+q,t.correctDateValue(u),u},addMonths:function(n,q,r){var u;u=checkExists(r)&&r!==!0?n:n.clone();checkExists(q.toFloat)&&(q=q.toFloat());var e=u._month+q,f=e%12;u._month=f>=0?Math.abs(f):12+f;q=Math.floor(e/12);var o=u.year();return u._year=o+q,t.correctDateValue(u),u},addDays:function(n,q,r){var u,f,e,o;u=checkExists(r)&&r!==!0?n:n.clone();checkExists(q.toFloat)&&(q=q.toFloat());var h=q/365,l=h>0;if(h=l?Math.floor(h):Math.ceil(h),h!==0)if(f=u._year,l)for(o=0;o<=h;o++){if(e=u._month<2&&t.isLeapYear(f)||u._month>2&&t.isLeapYear(f+1)||u._month===2&&u._day<29&&t.isLeapYear(f)?366:365,e>q)break;q=q-e;f++;u._year=f;t.correctDateValue(u)}else for(o=h;o<=0;o--){if(e=u._month>2&&t.isLeapYear(f)||u._month<2&&t.isLeapYear(f-1)||u._month===2&&(u._day===29||t.isLeapYear(f-1))?366:365,e>-q)break;q=q+e;f--;u._year=f;t.correctDateValue(u)}var c=q/28;if(l=c>0,c=l?Math.floor(c):Math.ceil(c),c!==0){f=u._year;var s=u._month;if(l)for(o=0;o<=c;o++){if(e=t.daysInMonth(f,s),e>q)break;q=q-e;s===12?(s=1,f++):s++;u._month=s;u._year=f;q=q+t.correctDateValue(u)}else for(o=c;o<=0;o--){var a=s,y=f;if(a===1?(a=12,y--):a--,e=t.daysInMonth(y,a),e>-q)break;q=q+e;s=a;f=y;u._month=s;u._year=f;q=q+t.correctDateValue(u)}}for(var v=u._day+q,p=v-t.daysInMonth(u._year,u._month);p>0;)v=p,u._month===12?(u._month=1,u._year=u._year+1):u._month=u._month+1,p=v-t.daysInMonth(u._year,u._month);return u._day=v,t.correctDateValue(u),u},parseImpl:function(n,q){var f=null;if(n instanceof Date||n._type==="datetime")return new t(n.getFullYear(),n.getMonth()+1,n.getDate());if(n._type==="date")return n;if(n._type==="time")throw Resources.RuntimeMessages.TimeCouldNotParseMessage;var r=t.expressions.isodate.exec(n);if(checkExists(r))f=new t(r[1],r[2],r[3]);else{var e=SourceCode.Forms.Time.parseImpl(n,q,!1);if(checkExists(e))throw Resources.RuntimeMessages.TimeCouldNotParseMessage;var u=SCCultureHelper.Current()._checkDateIsZuluDate(n);if(u)return new t(u.getFullYear(),u.getMonth()+1,u.getDate())}return f},parse:function(n,q){var r=null;if(r=t.parseImpl(n,q),!checkExists(r)&&SCCultureHelper&&SCCultureHelper.Current()&&SCCultureHelper.Current().currentCultureName){var u=SCCultureHelper.Current().currentCultureName;checkExists(q)&&(u=q.cultureObject.Name);r=SCCultureHelper.Current().parseDateOnServer(n,u,"yyyy-MM-dd",!1);r!==null&&(r=t.parseImpl(r,q))}if(r===null)throw Resources.RuntimeMessages.DateCouldNotParseMessage;return r},zeroDate:function(){return t._zeroDate===null&&(t._zeroDate=new t(1970,1,1)),t._zeroDate}});var f={_year:0,_month:1,_day:1,_type:"date",_create:function(n,t,q){if(arguments.length===0){var r=new Date;n=r.getFullYear();t=r.getMonth()+1;q=r.getDate()}this.year(n,!0);this.month(t,!0);this.day(q,!0);this.validateDate()},year:function(n,t){if(checkExists(n)){var q=parseInt(n);if(isNaN(q))throw Resources.RuntimeMessages.DateInvalidPropertyMessage.format("year",n);this._year=q;t||this.validateDate()}else return this._year},month:function(n,t){if(checkExists(n)){var q=parseInt(n);if(isNaN(q)||q<1||q>12)throw Resources.RuntimeMessages.DateInvalidPropertyMessage.format("month",n);this._month=q;t||this.validateDate()}else return this._month},day:function(n,t){if(checkExists(n)){var q=parseInt(n);if(isNaN(q)||q<0||q>31)throw Resources.RuntimeMessages.DateInvalidPropertyMessage.format("day",n);this._day=q;t||this.validateDate()}else return this._day},validateDate:function(){if(isNaN(this._year))throw Resources.RuntimeMessages.DateInvalidPropertyMessage.format("year",this._year);if(isNaN(this._month)||this._month<1||this._month>12)throw Resources.RuntimeMessages.DateInvalidPropertyMessage.format("month",this._month);if(isNaN(this._day)||this._day<0||this._day>t.daysInMonth(this._year,this._month))throw Resources.RuntimeMessages.DateInvalidPropertyMessage.format("day",this._day);},getUTCFullYear:function(){return this.year()},getUTCMonth:function(){return this.month()-1},getUTCDate:function(){return this.day()},getFullYear:function(){return this.year()},getMonth:function(){return this.getUTCMonth()},getDate:function(){return this.day()},getDayOfYear:function(){for(var n=0,q=1;q<this._month;q++)n=n+t.daysInMonth(this._year,q);return n+this._day},getDay:function(){var q=this.getDayOfYear(),n=this._year-1,t=Math.floor(n/4),r=Math.floor(n/100),u=Math.floor(t/100);return(n+t-r+u+q)%7},getWeek:function(){return checkExists(SourceCode.Forms.Settings)&&checkExists(SourceCode.Forms.Settings.Compatibility)&&checkExists(SourceCode.Forms.Settings.Compatibility.DateWeekNumberLegacyLogic)&&SourceCode.Forms.Settings.Compatibility.DateWeekNumberLegacyLogic?Math.floor(this.getDayOfYear()/7)+1:this.getWeekNumber(0)},getWeekNumber:function(n){return n=n||0,Math.ceil((this.getDayOfYear()+new t(this.getFullYear(),1,1).getDay()-n)/7)},isLeapYear:function(){return t.isLeapYear(this._year)},setSafeUTCFullYear:function(n,t,r){n=parseInt(n);var f=checkExists(t)?parseInt(t)+1:this._month,e=q.daysInMonth(n,f),u=checkExists(r)?parseInt(r):this._day;return u>e&&(u=e),this.year(n),this.month(f),this.day(u),this},setUTCFullYear:function(n,t,q){this.year(n,!0);this.month(t+1,!0);this.day(q,!0);this.validateDate()},setSafeUTCMonth:function(n,q){n=parseInt(n)+1;var u=t.daysInMonth(this._year,n),r=checkExists(q)?parseInt(q):this._day;r>u&&(r=u);this.month(n);this.day(r)},setUTCMonth:function(n){return this.month(n+1)},setUTCDate:function(n){return this.day(n)},setFullYear:function(n,t,q){this.setSafeFullYear(n,t,q)},setSafeFullYear:function(n,t,q){return this.setSafeUTCFullYear(n,t,q)},setMonth:function(n){return this.month(n-1)},setSafeMonth:function(n,t){return this.setSafeUTCMonth(n,t)},setDate:function(n){return this.day(n)},increment:function(n){return t.addDays(this,n,!1),this},decrement:function(n){return t.addDays(this,-n,!1),this},add:function(n,t){var u=r.getResolutionIdentifier(n),q=null;switch(u){case"year":q=this.addYears;break;case"month":q=this.addMonths;break;case"day":q=this.addDays}if(!checkExists(q))throw Resources.RuntimeMessages.DateUnitNotSupportForAddition.format(n);return q.apply(this,[t])},addYears:function(n){return t.addYears(this,n)},addMonths:function(n){return t.addMonths(this,n)},addDays:function(n){return t.addDays(this,n)},compareTo:function(n){var q=this;return r.compareTo(t.keys,q,n)},equals:function(n){return this.compareTo(n)===0},clone:function(){return new t(this._year,this._month,this._day)},getTime:function(){return this.difference(t.zeroDate(),"day")*r.units.day},fractionalDifference:function(n,q){q=r.getResolutionIdentifier(q);var u=0,e=0;if(n=t.parse(n),checkExists(q)||(q="day"),q==="year"||q==="month"){var c=new Big(n._year),l=new Big(this._year),o=new Big(n._month),s=new Big(this._month),f=o.eq(2)&&n._day===t.daysInMonth(c,o)?new Big(30):new Big(n._day),h=s.eq(2)&&this._day===t.daysInMonth(l,s)?new Big(30):new Big(this._day);h.eq(31)&&f.lt(29)&&(h=new Big(30));f.eq(31)&&(f=new Big(30));u=l.minus(c).times(360).plus(s.minus(o).times(30)).plus(h.minus(f));e=q==="year"?u.div(360):u.div(30)}else u=this.difference(n,"day"),e=q==="day"?u:new Big(u).times(r.units.day).div(r.units[q]);return e},difference:function(n,q){q=r.getResolutionIdentifier(q);n=t.parse(n);var f=this._year-n._year,e=this._month-n._month,u=0;switch(q){case"year":u=f;break;case"month":u=f*12+e;break;case"day":u=SourceCode.Forms.DateHelper.getDayDifferenceBetweenTwoDates(this,n)}return u},toString:function(){return t.stringFormat.format(this._year.toString().zeroise(4),this._month.toString().zeroise(2),this._day.toString().zeroise(2))}};jQuery.extend(t.prototype,o,f);var u;SourceCode.Forms.Time=u=function(){this._create.apply(this,arguments)};n.extend(u,{keys:["_hours","_minutes","_seconds","_milliseconds"],range:[24,60,60,1e3],stringFormatSeconds:"{0}:{1}:{2}",stringFormatMilliseconds:"{0}:{1}:{2}.{3}",now:function(){return new u},expressions:{isoTime:/^\s*(\d{1,2}):(\d{1,2})(:(\d{1,2})(.(\d+\s*))?)?\s*$/},add:function(n,t,q){checkExists(q.toFloat)&&(q=q.toFloat());for(var r=n.clone();t>-1&&q!==0;){var e=r[u.keys[t]]+q,f=e%u.range[t];r[u.keys[t]]=f>=0?Math.abs(f):u.range[t]+f;q=Math.floor(e/u.range[t]);t--}return r},parseImpl:function(n,t,q){if(q=checkExists(q)?q:!0,n instanceof Date)return new u(n.getHours(),n.getMinutes(),n.getSeconds(),n.getMilliseconds());if(n._type==="time")return n;if(n._type==="date")return new SourceCode.Forms.Time(0,0,0,0);var s=null,h=!1,c=!1;t&&(checkExistsNotEmpty(t.cultureObject.DateTimeSettings.AMDesignator)&&n.contains(t.cultureObject.DateTimeSettings.AMDesignator)&&(c=!0,n=n.replace(t.cultureObject.DateTimeSettings.AMDesignator,"")),checkExistsNotEmpty(t.cultureObject.DateTimeSettings.PMDesignator)&&n.contains(t.cultureObject.DateTimeSettings.PMDesignator)&&(h=!0,n=n.replace(t.cultureObject.DateTimeSettings.PMDesignator,"")));var e=u.expressions.isoTime.exec(n);if(checkExists(e)){var r=e[6];checkExists(r)&&(r.length<2?r=r+"00":r.length<3?r=r+"0":r.length>3&&(r=r.substring(0,3)+"."+r.substring(3)));var f=e[1];h&&(f=parseInt(f,10),f<12&&(f=f+12));c&&f==12&&(f=f-12);s=new u(f,e[2],e[4],r)}else if(q===!0){var o=SCCultureHelper.Current()._checkDateIsZuluDate(n);if(o)return new u(o.getHours(),o.getMinutes(),o.getSeconds(),o.getMilliseconds())}return s},parse:function(n,t){var q=null;if(q=u.parseImpl(n,t),!checkExists(q)&&SCCultureHelper&&SCCultureHelper.Current()&&SCCultureHelper.Current().currentCultureName){var r=SCCultureHelper.Current().currentCultureName;checkExists(t)&&(r=t.cultureObject.Name);q=SCCultureHelper.Current().parseDateOnServer(n,r,"HH:mm:ss.FFFFFFF",!1);q!==null&&(q=u.parseImpl(q))}if(q===null)throw Resources.RuntimeMessages.TimeCouldNotParseMessage;return q}});var e={_hours:0,_minutes:0,_seconds:0,_milliseconds:0,_type:"time",_create:function(n,t,q,r){if(arguments.length===0){var u=new Date;n=u.getHours();t=u.getMinutes();q=u.getSeconds();r=u.getMilliseconds()}this.hours(n);this.minutes(t);this.seconds(q);this.milliseconds(r)},hours:function(n){if(checkExists(n)){var t=parseInt(n);if(isNaN(t)||t<0||t>23)throw Resources.RuntimeMessages.TimeInvalidPropertyMessage.format("hours",n);this._hours=t}else return this._hours},minutes:function(n){if(checkExists(n)){var t=parseInt(n);if(isNaN(t)||t<0||t>59)throw Resources.RuntimeMessages.TimeInvalidPropertyMessage.format("minutes",n);this._minutes=t}else return this._minutes},seconds:function(n){if(checkExists(n)){var t=parseInt(n);if(isNaN(t)||t<0||t>59)throw Resources.RuntimeMessages.TimeInvalidPropertyMessage.format("seconds",n);this._seconds=t}else return this._seconds},milliseconds:function(n){if(checkExists(n)){var t=parseInt(n);if(isNaN(t)||t<0||t>999)throw Resources.RuntimeMessages.TimeInvalidPropertyMessage.format("milliseconds",n);this._milliseconds=t}else return this._milliseconds},getUTCHours:function(){return this.hours()},getUTCMinutes:function(){return this.minutes()},getUTCSeconds:function(){return this.seconds()},getUTCMilliseconds:function(){return this.milliseconds()},getHours:function(){return this.hours()},getMinutes:function(){return this.minutes()},getSeconds:function(){return this.seconds()},getMilliseconds:function(){return this.milliseconds()},setUTCHours:function(n){return this.hours(n)},setUTCMinutes:function(n){return this.minutes(n)},setUTCSeconds:function(n){return this.seconds(n)},setUTCMilliseconds:function(n){return this.milliseconds(n)},setHours:function(n){return this.hours(n)},setMinutes:function(n){return this.minutes(n)},setSeconds:function(n){return this.seconds(n)},setMilliseconds:function(n){return this.milliseconds(n)},clearUTCTime:function(){return this._hours=0,this._minutes=0,this._seconds=0,this._milliseconds=0,this},clearTime:function(){return this._hours=0,this._minutes=0,this._seconds=0,this._milliseconds=0,this},compareTo:function(n){var t=this;return r.compareTo(u.keys,t,n)},equals:function(n){return this.compareTo(n)===0},toMilliseconds:function(){return this._hours*r.units.hour+this._minutes*r.units.minute+this._seconds*r.units.second+this._milliseconds},getTime:function(){return this.toMilliseconds()},add:function(n,t){var u=r.getResolutionIdentifier(n),q=null;switch(u){case"hour":q=this.addHours;break;case"minute":q=this.addMinutes;break;case"second":q=this.addSeconds;break;case"millisecond":q=this.addMilliseconds}if(!checkExists(q))throw Resources.RuntimeMessages.TimeUnitNotSupportForAddition.format(u);return q.apply(this,[t])},addTime:function(n){return u.add(this,3,n.toMilliseconds())},addHours:function(n){return u.add(this,0,n)},addMinutes:function(n){return u.add(this,1,n)},addSeconds:function(n){return u.add(this,2,n)},addMilliseconds:function(n){return u.add(this,3,n)},fractionalDifference:function(n,t){return t=r.getResolutionIdentifier(t),new Big(this.toMilliseconds()-n.toMilliseconds()).div(r.units[t])},difference:function(n,t){t=r.getResolutionIdentifier(t);var q=(this.toMilliseconds()-n.toMilliseconds())/r.units[t];return q<0?Math.ceil(q):Math.floor(q)},clone:function(){return new u(this._hours,this._minutes,this._seconds,this._milliseconds)},toString:function(){var t=[this._hours.toString().zeroise(2),this._minutes.toString().zeroise(2),this._seconds.toString().zeroise(2),this._milliseconds.toString().zeroise(3)],n=u.stringFormatSeconds;return this._milliseconds>0&&(n=u.stringFormatMilliseconds),n.format(t)}};jQuery.extend(u.prototype,o,e);var q;SourceCode.Forms.DateTime=q=function(){this._create.apply(this,arguments)};n.extend(q,t,{keys:["_year","_month","_day","_hours","_minutes","_seconds","_milliseconds"],range:[9999,12,31,24,60,60,1e3],stringFormat:"{0}-{1}-{2} {3}:{4}:{5}Z",localFormat:"{0}-{1}-{2}T{3}:{4}:{5}",_zeroDate:null,now:function(n){var t=new q;return checkExists(n)&&(t._timeZone=n),t},addTime:function(n,t,r,u){var f;for(checkExists(r.toFloat)&&(r=r.toFloat()),f=checkExists(u)&&u!==!0?n:n.clone();t>2&&r!==0;){var o=f[q.keys[t]]+r,e=o%q.range[t];f[q.keys[t]]=e>=0?Math.abs(e):q.range[t]+e;r=Math.floor(o/q.range[t]);t--}return r!==0&&(f=q.addDays(f,r,u)),f},convertTime:function(n,t){n.timeZone(t);var r=n.getTimeZoneOffset();q.addTime(n,4,r,!1);var u=n.getTimeZoneOffset()-r;u!==0&&q.addTime(n,4,u,!1)},parseImpl:function(n,t){var e=checkExists(t)&&checkExists(t.timeZone)?t.timeZone:null;if(n instanceof Date)return new q(n.getUTCFullYear(),n.getUTCMonth()+1,n.getUTCDate(),n.getUTCHours(),n.getUTCMinutes(),n.getSeconds(),n.getMilliseconds(),e);if(n._type==="datetime")return n;var o=n._type==="time"?n:SourceCode.Forms.Time.parseImpl(n,t,!1);if(checkExists(o))return SourceCode.Forms.DateTime.fromCurrentDateWithSFTime(o,e);if(!checkExistsNotEmpty(n)||n.length!==20||n.charAt(19)!=="Z")return null;var f=n.removeNBSpace().split(" ");if(f.length!==2||f[0].length!==10||f[1].length!==9)return null;var r=f[0].split("-");if(r.length!==3||r[0].length!==4||r[1].length!==2||r[2].length!==2||!r[0].isNumeric()||!r[1].isNumeric()||!r[2].isNumeric())return null;var s=r[0].toInt(),h=r[1].toInt(),c=r[2].toInt(),u=f[1].substr(0,8).split(":");if(u.length!==3||u[0].length!==2||u[1].length!==2||u[2].length!==2||!u[0].isNumeric()||!u[1].isNumeric()||!u[2].isNumeric())return null;var l=u[0].toInt(),a=u[1].toInt(),v=u[2].toInt();return new q(s,h,c,l,a,v,0,e)},parse:function(n,t){var r=null;if(r=q.parseImpl(n,t),!checkExists(r)&&SCCultureHelper&&SCCultureHelper.Current()&&SCCultureHelper.Current().currentCultureName){var u=SCCultureHelper.Current().currentCultureName;checkExists(t)&&checkExists(t.cultureObject)&&(u=t.cultureObject.Name);r=SCCultureHelper.Current().parseDateOnServer(n,u,"u",!1);r!==null&&(r=q.parseImpl(r,t),checkExists(t)&&checkExists(t.timeZone)&&q.addTime(r,4,r.getTimeZoneOffset(),!1))}if(r===null)throw Resources.RuntimeMessages.DateTimeCouldNotParseMessage;return r},fromCurrentDateWithSFTime:function(n,t){var r=new q,u=new q(r._year,r._month,r._day,n.getUTCHours(),n.getUTCMinutes(),n.getSeconds(),n.getMilliseconds(),t);return checkExists(t)&&q.addTime(u,4,u.getTimeZoneOffset(),!1),u},zeroDate:function(){return q._zeroDate===null&&(q._zeroDate=new q(1970,1,1,0,0,0,0)),q._zeroDate}});var h={_timeZone:"",_type:"datetime",_create:function(n,t,q,r,u,f,e,o){if(arguments.length===0){var s=new Date;n=s.getUTCFullYear();t=s.getUTCMonth()+1;q=s.getUTCDate();r=s.getUTCHours();u=s.getUTCMinutes();f=s.getSeconds();e=s.getMilliseconds()}this.year(n,!0);this.month(t,!0);this.day(q,!0);this.hours(r);this.minutes(u);this.seconds(f);this.milliseconds(e);this.timeZone(o);this.validateDate()},timeZone:function(n){if(checkExists(n))this._timeZone=n;else return this._timeZone},localDate:function(){var n=this,t=this.getTimeZoneOffset();return t!==0?(n=this.clone(),n._timeZone=null,n.addMinutes(0-t)):n},getTimeZoneOffset:function(){return checkExistsNotEmpty(this._timeZone)?SCCultureHelper.Current().getTimeZoneOffset(this,this._timeZone):0},getFullYear:function(){return this.localDate().year()},getMonth:function(){return this.localDate().getUTCMonth()},getDate:function(){return this.localDate().getUTCDate()},getHours:function(){return this.localDate().getUTCHours()},getMinutes:function(){return this.localDate().getUTCMinutes()},getDayOfYear:function(){var n=this.localDate();return f.getDayOfYear.apply(n,arguments)},getDay:function(){var n=this.localDate();return f.getDay.apply(n,arguments)},setSafeFullYear:function(n,t,r){var e=this.getTimeZoneOffset();n=checkExists(n)?parseInt(n,10):this._year;t=checkExists(t)?parseInt(t,10):this._month;r=checkExists(r)?parseInt(r,10):this._day;var u=this.localDate();q.addYears(this,n-u._year,!1);q.addMonths(this,t+1-u._month,!1);q.addDays(this,r-u._day,!1);var f=this.getTimeZoneOffset()-e;return f!==0&&q.addTime(this,4,f,!1),this},setMonth:function(n){if(!checkExists(n))return this;var r=this.getTimeZoneOffset();n=parseInt(n,10);q.addMonths(this,n+1-this.localDate()._month,!1);var t=this.getTimeZoneOffset()-r;return t!==0&&q.addTime(this,4,t,!1),this},setSafeMonth:function(n,t){var u=this.getTimeZoneOffset();this.setSafeUTCFullYear(n,t);var r=this.getTimeZoneOffset()-u;return r!==0&&q.addTime(this,4,r,!1),r=this.getTimeZoneOffset()-u,r!==0&&q.addTime(this,4,r,!1),this},setDate:function(n){if(!checkExists(n))return this;var r=this.getTimeZoneOffset();n=parseInt(n,10);var u=this.localDate();q.addDays(this,n-u._day,!1);var t=this.getTimeZoneOffset()-r;return t!==0&&q.addTime(this,4,t,!1),this},setHours:function(n){if(!checkExists(n))return this;var r=this.getTimeZoneOffset();n=parseInt(n,10);var u=this.localDate();q.addTime(this,3,n-u._hours,!1);var t=this.getTimeZoneOffset()-r;return t!==0&&q.addTime(this,4,t,!1),this},setMinutes:function(n){if(!checkExists(n))return this;var r=this.getTimeZoneOffset();n=parseInt(n,10);q.addTime(this,4,n-this.localDate()._minutes,!1);var t=this.getTimeZoneOffset()-r;return t!==0&&q.addTime(this,4,t,!1),this},clearTime:function(){var n=this.localDate();if(n===this)return this.clearUTCTime();var u=this.getTimeZoneOffset();q.addTime(this,6,0-(n._hours*r.units.hour+n._minutes*r.units.minute+n._seconds*r.units.second+n._milliseconds),!1);var t=this.getTimeZoneOffset()-u;return t!==0&&q.addTime(this,4,t,!1),this},convertTime:function(n){checkExistsNotEmpty(n)&&q.convertTime(this,n)},increment:function(n){var f=this.getTimeZoneOffset(),t=this.localDate().clone();q.addDays(this,n,!1);var u=this.getTimeZoneOffset()-f;if(u!==0){var r=this.localDate(),e=t.year()==r.year()&&t.month()==r.month()&&t.day()===r.day();e&&q.addTime(this,4,u,!1)}return this},decrement:function(n){var r=this.getTimeZoneOffset();q.addDays(this,0-n,!1);var t=this.getTimeZoneOffset()-r;return t!==0&&q.addTime(this,4,t,!1),this},add:function(n,t){var u=r.getResolutionIdentifier(n),q=null;switch(u){case"year":q=this.addYears;break;case"month":q=this.addMonths;break;case"day":q=this.addDays;break;case"hour":q=this.addHours;break;case"minute":q=this.addMinutes;break;case"second":q=this.addSeconds;break;case"millisecond":q=this.addMilliseconds}if(!checkExists(q))throw Resources.RuntimeMessages.DateTimeUnitNotSupportForAddition.format(u);return q.apply(this,[t])},addHours:function(n){return q.addTime(this,3,n)},addMinutes:function(n){return q.addTime(this,4,n)},addSeconds:function(n){return q.addTime(this,5,n)},addMilliseconds:function(n){return q.addTime(this,6,n)},compareTo:function(n){var t=this;return r.compareTo(q.keys,t,n)},clone:function(){return new q(this._year,this._month,this._day,this._hours,this._minutes,this._seconds,this._milliseconds,this._timeZone)},getTime:function(){return this.difference(q.zeroDate(),"millisecond")},getLocalTime:function(){return this.localDate().getTime()},fractionalDifference:function(n,t){if(t=r.getResolutionIdentifier(t),t!=="year"&&t!=="month"&&t!=="day"){var q=f.fractionalDifference.apply(this,[n,"day"]),u=e.fractionalDifference.apply(this,arguments);return new Big(u).plus(q*r.units.day/r.units[t])}return f.fractionalDifference.apply(this,arguments)},difference:function(n,t){var q=0;if(t=r.getResolutionIdentifier(t),t!=="year"&&t!=="month"&&t!=="day"){q=f.difference.apply(this,[n,"day"]);var u=e.difference.apply(this,arguments);q=new Big(u).plus(q*r.units.day/r.units[t])}else q=f.difference.apply(this,arguments);return q},toString:function(n){return checkExists(n)||(n=q.stringFormat),n.format(this._year.toString().zeroise(4),this._month.toString().zeroise(2),this._day.toString().zeroise(2),this._hours.toString().zeroise(2),this._minutes.toString().zeroise(2),this._seconds.toString().zeroise(2),this._milliseconds.toString().zeroise(3))},toLocalString:function(){var n=this.localDate();return n.toString(q.localFormat)}};jQuery.extend(q.prototype,o,e,f,h);var s;SourceCode.Forms.Duration=s=function(){this._create.apply(this,arguments)};var c={_years:0,_months:0,_weeks:0,_days:0,_hours:0,_minutes:0,_seconds:0,_milliseconds:0,_orginalMilliseconds:0,_sign:"",_create:function(n){var s=0,t=0,q=0,u=0,f=0,e=0,o=Math.abs(n),h;n<0&&(this._sign="-");this._orginalMilliseconds=o;this._milliseconds=+o+e*r.units.second+f*r.units.minute+u*r.units.hour;this._days=+q+0;this._months=+t+0+s*12;this._milliseconds=o%1e3;e=Math.floor(o/1e3);this._seconds=e%60;f=Math.floor(e/60);this._minutes=f%60;u=Math.floor(f/60);this._hours=u%24;r.units.day;q+=Math.floor(u/24);h=Math.floor(this._daysToMonths(q));t+=h;q-=Math.ceil(this._monthsToDays(h));s=Math.floor(t/12);t%=12;this._days=q;this._months=t;this._years=s},_daysToMonths:function(n){return n*4800/146097},_monthsToDays:function(n){return n*146097/4800},toString:function(n,t){checkExists(n)||(n="FriendlyShortUnits");checkExists(t)||(t=SCCultureHelper.current.getCultureObject(SCCultureHelper.current.currentCultureName));var o=this._sign;if(o==="-"&&(o=t.NegativeSign),n==="TimeSpan"){var p=Math.floor(this._orginalMilliseconds/36e5);return o+p.toString().zeroise(2)+":"+this._minutes.toString().zeroise(2)+":"+this._seconds.toString().zeroise(2)}var u=" ",s,h,c,l,a,v,y,q=t.DateTimeSettings.ShortTimeUnitNames;function r(n,t){for(var q=0;q<n.length;q++)if(n[q].Name===t)return n[q].Text}switch(n){case"FriendlyLongUnits":q=t.DateTimeSettings.LongTimeUnitNames;s=u+(this._years==1?r(q,"Years_Singular"):r(q,"Years"));h=u+(this._months==1?r(q,"Months_Singular"):r(q,"Months"));c=u+(this._days==1?r(q,"Days_Singular"):r(q,"Days"));l=u+(this._hours==1?r(q,"Hours_Singular"):r(q,"Hours"));a=u+(this._minutes==1?r(q,"Minutes_Singular"):r(q,"Minutes"));v=u+(this._seconds==1?r(q,"Seconds_Singular"):r(q,"Seconds"));y=u+(this._milliseconds==1?r(q,"Milliseconds_Singular"):r(q,"Milliseconds"));break;case"FriendlyMediumUnits":q=t.DateTimeSettings.MediumTimeUnitNames;s=this._years==1?r(q,"Years_Singular"):r(q,"Years");h=this._months==1?r(q,"Months_Singular"):r(q,"Months");c=this._days==1?r(q,"Days_Singular"):r(q,"Days");l=this._hours==1?r(q,"Hours_Singular"):r(q,"Hours");a=this._minutes==1?r(q,"Minutes_Singular"):r(q,"Minutes");v=this._seconds==1?r(q,"Seconds_Singular"):r(q,"Seconds");y=this._milliseconds==1?r(q,"Milliseconds_Singular"):r(q,"Milliseconds");break;case"FriendlyShortUnits":default:q=t.DateTimeSettings.ShortTimeUnitNames;s=r(q,"Years");h=r(q,"Months");c=r(q,"Days");l=r(q,"Hours");a=r(q,"Minutes");v=r(q,"Seconds");y=r(q,"Milliseconds")}function e(n,t,q){n>0&&q.remainingDisplayCount>0&&(q.durationString+=n+t+u);q.durationString!==""&&q.remainingDisplayCount--}var f={durationString:"",remainingDisplayCount:2};return e(this._years,s,f),e(this._months,h,f),e(this._days,c,f),e(this._hours,l,f),e(this._minutes,a,f),e(this._seconds,v,f),e(this._milliseconds,y,f),o+f.durationString.trim()},formatDuration:function(n){n===undefined&&(n="ymmdhmis");var q=" ",t="";return this._years>0&&n.contains("y")?t+=this._years+r.getShortResolutionIdentifier("y")+q:this._months+=Math.floor(this._years*12),this._months>0&&n.contains("mm")?t+=this._months+r.getShortResolutionIdentifier("m")+q:this._days+=Math.floor(this._monthsToDays(this._months)),this._days>0&&n.contains("d")?t+=this._days+r.getShortResolutionIdentifier("d")+q:this._hours+=this._days*24,this._hours>0&&n.contains("h")?t+=this._hours+r.getShortResolutionIdentifier("h")+q:this._minutes+=this._days*3600,this._minutes>0&&n.contains("mi")?t+=this._minutes+r.getShortResolutionIdentifier("mi")+q:this._seconds+=this._minutes*60,this._seconds>0&&n.contains("s")?t+=this._seconds+r.getShortResolutionIdentifier("s")+q:this._milliseconds=this._seconds*1e3,this._milliseconds>0&&n.contains("f")&&(t+=this._seconds+r.getShortResolutionIdentifier("ms")+q),t}};jQuery.extend(s.prototype,c)})(jQuery);
/*!
 ~/Script/SourceCode.Forms.StyleHelper.js
*/
(function(n){(typeof SourceCode=="undefined"||SourceCode===null)&&(SourceCode={});(typeof SourceCode.Forms=="undefined"||SourceCode.Forms===null)&&(SourceCode.Forms={});SourceCode.Forms.StyleHelper={getPrimaryStyleNode:function(n){var t=n.selectSingleNode("Style[@IsDefault='True']");return t||(typeof n.ownerDocument!="undefined"?t=n.ownerDocument.createElement("Style"):typeof n.createElement!="undefined"&&(t=n.createElement("Style")),t.setAttribute("IsDefault","True"),n.appendChild(t)),t},getStyleByName:function(n,t){var q=n.selectSingleNode("Style[Name='{0}']".format(t));if(!q){var r=null;typeof n.ownerDocument!="undefined"?(r=n.ownerDocument,q=n.ownerDocument.createElement("Style")):typeof n.createElement!="undefined"&&(r=n,q=n.createElement("Style"));q=r.createElement("Style");var u=r.createElement("Name");u.appendChild(r.createTextNode(t));q.appendChild(u);n.appendChild(q)}return q},getMergedStyle:function(n,t){var q={toNode:t,fromNode:n,identifyingPath:"Styles/Style",identifyingAttributes:["IsDefault"],identifyingNodes:["Name"]};MergeXmlNodes(q)},getStylesDelta:function(n,t){var q={toNode:n,fromNode:t,identifyingPath:"Styles/Style",identifyingAttributes:["IsDefault"],identifyingNodes:["Name"]};return FindXmlDelta(q)},getStylesDeltas:function(n,t){for(var c=n.ownerDocument?n.ownerDocument:n,r=n.selectNodes(t),q=0;q<r.length;q++){var h=r[q].getAttribute("Type"),u=r[q].selectSingleNode("Styles");if(checkExists(u)){var e=SourceCode.Forms.Designers.Common.controlDefinitionsXml.selectSingleNode('Controls/Control[Name = "'+h+'"]/Styles'),o=SCStyleHelper.getStylesDelta(e,u);r[q].removeChild(u);checkExists(o)&&r[q].appendChild(o.cloneNode(!0))}for(var s=r[q].selectNodes("ConditionalStyles/ConditionalStyle/Styles"),f=0;f<s.length;f++)SCStyleHelper.getStylesDelta(e,s[f])}},getMergedStyles:function(n,t){for(var s=n.ownerDocument?n.ownerDocument:n,r=n.selectNodes(t),q=0;q<r.length;q++){var h=r[q].getAttribute("Type"),u=r[q].selectSingleNode("Styles");checkExists(u)||(u=s.createElement("Styles"),r[q].appendChild(u));var e=SourceCode.Forms.Designers.Common.controlDefinitionsXml.selectSingleNode('Controls/Control[Name = "'+h+'"]/Styles');SCStyleHelper.getMergedStyle(e,u);for(var o=r[q].selectNodes("ConditionalStyles/ConditionalStyle/Styles"),f=0;f<o.length;f++)SCStyleHelper.getMergedStyle(e,o[f])}},tempXml:function(){if(SCStyleHelper._temporaryXml)for(var n=SCStyleHelper._temporaryXml.documentElement,t=n.childNodes;t.length>0;)n.removeChild(t[0]);else SCStyleHelper._temporaryXml=parseXML("<Temp/>");return SCStyleHelper._temporaryXml},_getPropertyTypeStylesAjax:function(){if(checkExists(SCStyleHelper.propertyTypeStylesError)&&new Date-SCStyleHelper.propertyTypeStylesError<1e3)return null;checkExists(SCStyleHelper.propertyTypeStylesError)&&(SCStyleHelper.propertyTypeStylesError=null);n.ajax({data:{method:"getPropertyTypeStyles"},async:!1,dataType:"xml",url:applicationRoot+"Utilities/AJAXCall.ashx",error:function(n,t){popupManager.showError("<p>{0}<\/p><p>[{1}] {2} ({3}) <\/p>".format(Resources.RuntimeMessages.PropertyTypesFailedToLoad,n.status,n.statusText,t));SCStyleHelper.propertyTypeStylesError=new Date}.bind(this),success:function(n){SourceCode.Forms.ExceptionHandler.handleException(n)&&(SCStyleHelper.propertyTypeStylesError=new Date);SCStyleHelper.propertyTypeStyles=n}.bind(this)})},PropertyTypeStyles:function(){return checkExists(SCStyleHelper.propertyTypeStyles)||SCStyleHelper._getPropertyTypeStylesAjax(),SCStyleHelper.propertyTypeStyles}};typeof SCStyleHelper=="undefined"&&(SCStyleHelper=SourceCode.Forms.StyleHelper)})(jQuery);
/*!
 ~/Script/SourceCode.Forms.MenuHelper.js
*/
(typeof SourceCode=="undefined"||SourceCode===null)&&(SourceCode={});(typeof SourceCode.Forms=="undefined"||SourceCode.Forms===null)&&(SourceCode.Forms={});SourceCode.Forms.MenuHelper={getTopOfForm:function(n){var t=0;if(SourceCode.Forms.Browser.safarimobile||SourceCode.Forms.Browser.ipad){if(t=$("form")[0].getBoundingClientRect().top,$("div.runtime-form.theme-entry").length>0){var r=parseInt($("div.runtime-content").css("margin-top"));isNaN(r)||(t-=r)}SourceCode.Forms.Browser.ipad&&(t=n+t)}var u=!jQuery(".runtime-page .page")?jQuery(".runtime-form .form"):jQuery(".runtime-page .page"),q=parseInt(jQuery(u).css("padding-top"));return isNaN(q)&&(q=0),!!document.parentWindow==!0&&(q=0),t-q},getTopValue:function(n){var o=n.element,t=0;typeof n.popupContentHeight!="undefined"?t=n.popupContentHeight:typeof n.popupContent!="undefined"&&(t=n.popupContent.outerHeight());var v=typeof n.locationVertical!="undefined"?n.locationVertical:"bottom",s=typeof n.topClass!="undefined"?n.topClass:"",h=typeof n.bottomClass!="undefined"?n.bottomClass:"",c=typeof n.middleClass!="undefined"?n.middleClass:"",f=jQuery(document.body).scrollParent().scrollTop(),l=this.getTopOfForm(f),y=jQuery(!document.defaultView?document.parentWindow:document.defaultView),p=y.height(),q=o.offset().top,e=o.outerHeight(),w=p+f-q-e,a=q-f,r="";switch(v){case"top":r=t<a?"top":"bottom";break;case"bottom":r=t<w||t>a?"bottom":"top";break;case"middle":r="middle"}typeof n.popupContent!="undefined"&&(n.popupContent.removeClass(s),n.popupContent.removeClass(h),n.popupContent.removeClass(c));var u=0;switch(r){case"top":typeof n.popupContent!="undefined"&&n.popupContent.addClass(s);u=q-t-l;break;case"bottom":typeof n.popupContent!="undefined"&&n.popupContent.addClass(h);u=q+e-l;break;case"middle":typeof n.popupContent!="undefined"&&n.popupContent.addClass(c);u=q+e/2-t/2}return u},getPointerPosition:function(n){var q=n.element,t=0;typeof n.popupContentWidth!="undefined"?t=n.popupContentWidth:typeof n.popupContent!="undefined"&&(t=n.popupContent.outerWidth());var r=jQuery(document.body).scrollParent().scrollLeft(),o=jQuery(!document.defaultView?document.parentWindow:document.defaultView).width(),u=q.offset().left,f=q.outerWidth(),s=o+r-u-f,h=u-r;if(h<t/2||s<t/2){var e=f/2/t*100;return e<50?e:50}return 50},getLeftValue:function(n){var e=n.element,t=0;typeof n.popupContentWidth!="undefined"?t=n.popupContentWidth:typeof n.popupContent!="undefined"&&(t=n.popupContent.outerWidth());var a=typeof n.locationHorizontal!="undefined"?n.locationHorizontal:"left",o=typeof n.leftClass!="undefined"?n.leftClass:"",s=typeof n.rightClass!="undefined"?n.rightClass:"",h=typeof n.centerClass!="undefined"?n.centerClass:"",c=jQuery(document.body).scrollParent().scrollLeft(),v=jQuery(!document.defaultView?document.parentWindow:document.defaultView).width(),q=e.offset().left,f=e.outerWidth(),y=v+c-q-f,l=q-c,r="";switch(a){case"left":r=t<l?"left":"right";break;case"right":r=t<y||t>l?"right":"left";break;case"center":r="center"}typeof n.popupContent!="undefined"&&(n.popupContent.removeClass(o),n.popupContent.removeClass(s),n.popupContent.removeClass(h));var u=0;switch(r){case"left":typeof n.popupContent!="undefined"&&n.popupContent.addClass(o);u=q-t;break;case"right":typeof n.popupContent!="undefined"&&n.popupContent.addClass(s);u=q+f;break;case"center":typeof n.popupContent!="undefined"&&n.popupContent.addClass(h);u=q+f/2-t/2}return u}};
/*!
 ~/Script/SourceCode.Forms.Utilities.Performance.js
*/
(function(n){(typeof SourceCode=="undefined"||SourceCode===null)&&(SourceCode={});(typeof SourceCode.Forms=="undefined"||SourceCode.Forms===null)&&(SourceCode.Forms={});(typeof SourceCode.Forms.Utilities=="undefined"||SourceCode.Forms.Utilities===null)&&(SourceCode.Forms.Utilities={});var t=SourceCode.Forms.Utilities;function q(){this.functionQueued=!1;this.timeoutHandle=null;this.executionQueue=[];this.deferred=null}function r(){this.cachedContexts=null;this.cachedFunctions=null;this.cachedArgs=null;this.debounceFunctions=null;this.initialize=function(){this.cachedContexts=[];this.cachedFunctions=[];this.cachedArgs=["undefined"];this.debounceFunctions={}};this.initialize();this.debounce=function(t,r){if(typeof t!="function")throw"The first parameter when calling debounce should be a function.";typeof r=="undefined"&&(r={});var u=this._determineDebounceKey(t,r);(this.debounceFunctions[u]===null||typeof this.debounceFunctions[u]=="undefined")&&(this.debounceFunctions[u]=new q);this.debounceFunctions[u].deferred===null&&(this.debounceFunctions[u].deferred=n.Deferred());var f=this.debounceFunctions[u];if(f.functionQueued===!0&&r.requeue===!0&&(clearTimeout(f.timeoutHandle),f.timeoutHandle=null,f.functionQueued=!1),f.functionQueued===!1){var e=r.delay||0;f.functionQueued=!0;var o=this;f.timeoutHandle=setTimeout(function(){var n=t,q=checkExists(r.thisContext)?r.thisContext:this;n.apply(q,r.args);f.functionQueued=!1;f.deferred.resolve();o.debounceFunctions[u]=null},e)}return this.debounceFunctions[u].deferred.promise(this.debounceFunctions[u])};this._determineDebounceKey=function(n,t){typeof t.thisContext=="undefined"&&(t.thisContext=window.self);var f=!0;(typeof t.args=="undefined"||t.args===null||t.args.length===0)&&(f=!1);var r=this.cachedContexts.indexOf(t.thisContext);r===-1&&(this.cachedContexts.push(t.thisContext),r=this.cachedContexts.length-1);var u=this.cachedFunctions.indexOf(n);u===-1&&(this.cachedFunctions.push(n),u=this.cachedFunctions.length-1);var q=0;f&&(q=this.cachedArgs.indexOf(t.args),q===-1&&(this.cachedArgs.push(t.args),q=this.cachedArgs.length-1));return"{0}_{1}_{2}".format(r,u,q)}}t.performance=new r;t.FunctionManager=q})(jQuery);
/*!
 ~/Script/SourceCode.Forms.Utilities.Data.js
*/
(function(n){(typeof SourceCode=="undefined"||SourceCode===null)&&(SourceCode={});(typeof SourceCode.Forms=="undefined"||SourceCode.Forms===null)&&(SourceCode.Forms={});(typeof SourceCode.Forms.Utilities=="undefined"||SourceCode.Forms.Utilities===null)&&(SourceCode.Forms.Utilities={});var t=SourceCode.Forms.Utilities;function q(){this.smartObjectListMethodExecution=function(t){if(!checkExists(t)||!checkExists(t.smartObjectGuid)||!checkExists(t.methodName))throw"Mandatory options.smartObjectGuid and or options.methodName not specified";var q=n.Deferred();return t.method="SMARTOBJECTLISTMEHTODEXECUTION",n.ajax({cache:!1,data:n.param(t),dataType:"text",url:"Utilities/AJAXCall.ashx",success:function(n){if(typeof SourceCode.Forms.ExceptionHandler.isException=="function"&&SourceCode.Forms.ExceptionHandler.isException(n)){q.reject(n);return}try{var t=JSON.parse(n);q.resolve(t)}catch(r){q.reject(r)}},type:"POST"}),q.promise()}}t.Data=new q})(jQuery);
/*!
 ~/Script/CajaHtmlSanitizer.min.js
*/
/*!
Copyright 2017 SourceCode Technology Holdings, Inc

   Licensed under the Apache License, Version 2.0 (the "License");
   you may not use this file except in compliance with the License.
   You may obtain a copy of the License at

       http://www.apache.org/licenses/LICENSE-2.0

   Unless required by applicable law or agreed to in writing, software
   distributed under the License is distributed on an "AS IS" BASIS,
   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   See the License for the specific language governing permissions and
   limitations under the License.


Code Obtained from http://caja.appspot.com/html-css-sanitizer-minified.js
license available at: https://github.com/google/caja/blob/master/LICENSE.txt
*/
(function(){var c=void 0,n=!0,s=null,C=!1,J=["aliceblue,antiquewhite,aqua,aquamarine,azure,beige,bisque,black,blanchedalmond,blue,blueviolet,brown,burlywood,cadetblue,chartreuse,chocolate,coral,cornflowerblue,cornsilk,crimson,cyan,darkblue,darkcyan,darkgoldenrod,darkgray,darkgreen,darkkhaki,darkmagenta,darkolivegreen,darkorange,darkorchid,darkred,darksalmon,darkseagreen,darkslateblue,darkslategray,darkturquoise,darkviolet,deeppink,deepskyblue,dimgray,dodgerblue,firebrick,floralwhite,forestgreen,fuchsia,gainsboro,ghostwhite,gold,goldenrod,gray,green,greenyellow,honeydew,hotpink,indianred,indigo,ivory,khaki,lavender,lavenderblush,lawngreen,lemonchiffon,lightblue,lightcoral,lightcyan,lightgoldenrodyellow,lightgreen,lightgrey,lightpink,lightsalmon,lightseagreen,lightskyblue,lightslategray,lightsteelblue,lightyellow,lime,limegreen,linen,magenta,maroon,mediumaquamarine,mediumblue,mediumorchid,mediumpurple,mediumseagreen,mediumslateblue,mediumspringgreen,mediumturquoise,mediumvioletred,midnightblue,mintcream,mistyrose,moccasin,navajowhite,navy,oldlace,olive,olivedrab,orange,orangered,orchid,palegoldenrod,palegreen,paleturquoise,palevioletred,papayawhip,peachpuff,peru,pink,plum,powderblue,purple,red,rosybrown,royalblue,saddlebrown,salmon,sandybrown,seagreen,seashell,sienna,silver,skyblue,slateblue,slategray,snow,springgreen,steelblue,tan,teal,thistle,tomato,transparent,turquoise,violet,wheat,white,whitesmoke,yellow,yellowgreen".split(","),
"all-scroll,col-resize,crosshair,default,e-resize,hand,help,move,n-resize,ne-resize,no-drop,not-allowed,nw-resize,pointer,progress,row-resize,s-resize,se-resize,sw-resize,text,vertical-text,w-resize,wait".split(","),"armenian,decimal,decimal-leading-zero,disc,georgian,lower-alpha,lower-greek,lower-latin,lower-roman,square,upper-alpha,upper-latin,upper-roman".split(","),"100,200,300,400,500,600,700,800,900,bold,bolder,lighter".split(","),"block-level,inline-level,table-caption,table-cell,table-column,table-column-group,table-footer-group,table-header-group,table-row,table-row-group".split(","),
"condensed,expanded,extra-condensed,extra-expanded,narrower,semi-condensed,semi-expanded,ultra-condensed,ultra-expanded,wider".split(","),"inherit,inline,inline-block,inline-box,inline-flex,inline-grid,inline-list-item,inline-stack,inline-table,run-in".split(","),"behind,center-left,center-right,far-left,far-right,left-side,leftwards,right-side,rightwards".split(","),"large,larger,small,smaller,x-large,x-small,xx-large,xx-small".split(","),"dashed,dotted,double,groove,outset,ridge,solid".split(","),
"ease,ease-in,ease-in-out,ease-out,linear,step-end,step-start".split(","),"at,closest-corner,closest-side,ellipse,farthest-corner,farthest-side".split(","),"baseline,middle,sub,super,text-bottom,text-top".split(","),"caption,icon,menu,message-box,small-caption,status-bar".split(","),"fast,faster,slow,slower,x-fast,x-slow".split(","),["above","below","higher","level","lower"],["cursive","fantasy","monospace","sans-serif","serif"],["loud","silent","soft","x-loud","x-soft"],["no-repeat","repeat-x","repeat-y",
"round","space"],["blink","line-through","overline","underline"],["block","flex","grid","table"],["high","low","x-high","x-low"],["nowrap","pre","pre-line","pre-wrap"],["absolute","relative","static"],["alternate","alternate-reverse","reverse"],["border-box","content-box","padding-box"],["capitalize","lowercase","uppercase"],["child","female","male"],["=","opacity"],["backwards","forwards"],["bidi-override","embed"],["bottom","top"],["break-all","keep-all"],["clip","ellipsis"],["contain","cover"],
["continuous","digits"],["end","start"],["flat","preserve-3d"],["hide","show"],["horizontal","vertical"],["inside","outside"],["italic","oblique"],["left","right"],["ltr","rtl"],["no-content","no-display"],["paused","running"],["suppress","unrestricted"],["thick","thin"],[","],["/"],["all"],["always"],["auto"],["avoid"],["both"],["break-word"],["center"],["circle"],["code"],["collapse"],["contents"],["fixed"],["hidden"],["infinite"],["inset"],["invert"],["justify"],["list-item"],["local"],["medium"],
["mix"],["none"],["normal"],["once"],["repeat"],["scroll"],["separate"],["small-caps"],["spell-out"],["to"],["visible"]],L={animation:{cssPropBits:517,cssLitGroup:[J[10],J[24],J[29],J[45],J[48],J[54],J[63],J[71],J[72]],cssFns:["cubic-bezier()","steps()"]},"animation-delay":{cssPropBits:5,cssLitGroup:[J[48]],cssFns:[]},"animation-direction":{cssPropBits:0,cssLitGroup:[J[24],J[48],J[72]],cssFns:[]},"animation-duration":"animation-delay","animation-fill-mode":{cssPropBits:0,cssLitGroup:[J[29],J[48],
J[54],J[71]],cssFns:[]},"animation-iteration-count":{cssPropBits:5,cssLitGroup:[J[48],J[63]],cssFns:[]},"animation-name":{cssPropBits:512,cssLitGroup:[J[48],J[71]],cssFns:[]},"animation-play-state":{cssPropBits:0,cssLitGroup:[J[45],J[48]],cssFns:[]},"animation-timing-function":{cssPropBits:0,cssLitGroup:[J[10],J[48]],cssFns:["cubic-bezier()","steps()"]},appearance:{cssPropBits:0,cssLitGroup:[J[71]],cssFns:[]},azimuth:{cssPropBits:5,cssLitGroup:[J[7],J[42],J[56]],cssFns:[]},"backface-visibility":{cssPropBits:0,
cssLitGroup:[J[59],J[62],J[80]],cssFns:[]},background:{cssPropBits:23,cssLitGroup:[J[0],J[18],J[25],J[31],J[34],J[42],J[48],J[49],J[52],J[56],J[61],J[68],J[71],J[74],J[75]],cssFns:"image(),linear-gradient(),radial-gradient(),repeating-linear-gradient(),repeating-radial-gradient(),rgb(),rgba()".split(",")},"background-attachment":{cssPropBits:0,cssLitGroup:[J[48],J[61],J[68],J[75]],cssFns:[]},"background-color":{cssPropBits:2,cssLitGroup:[J[0]],cssFns:["rgb()","rgba()"]},"background-image":{cssPropBits:16,
cssLitGroup:[J[48],J[71]],cssFns:["image()","linear-gradient()","radial-gradient()","repeating-linear-gradient()","repeating-radial-gradient()"]},"background-position":{cssPropBits:5,cssLitGroup:[J[31],J[42],J[48],J[56]],cssFns:[]},"background-repeat":{cssPropBits:0,cssLitGroup:[J[18],J[48],J[74]],cssFns:[]},"background-size":{cssPropBits:5,cssLitGroup:[J[34],J[48],J[52]],cssFns:[]},border:{cssPropBits:7,cssLitGroup:[J[0],J[9],J[47],J[62],J[64],J[69],J[71]],cssFns:["rgb()","rgba()"]},"border-bottom":"border",
"border-bottom-color":"background-color","border-bottom-left-radius":{cssPropBits:5,cssFns:[]},"border-bottom-right-radius":"border-bottom-left-radius","border-bottom-style":{cssPropBits:0,cssLitGroup:[J[9],J[62],J[64],J[71]],cssFns:[]},"border-bottom-width":{cssPropBits:5,cssLitGroup:[J[47],J[69]],cssFns:[]},"border-collapse":{cssPropBits:0,cssLitGroup:[J[59],J[76]],cssFns:[]},"border-color":"background-color","border-left":"border","border-left-color":"background-color","border-left-style":"border-bottom-style",
"border-left-width":"border-bottom-width","border-radius":{cssPropBits:5,cssLitGroup:[J[49]],cssFns:[]},"border-right":"border","border-right-color":"background-color","border-right-style":"border-bottom-style","border-right-width":"border-bottom-width","border-spacing":"border-bottom-left-radius","border-style":"border-bottom-style","border-top":"border","border-top-color":"background-color","border-top-left-radius":"border-bottom-left-radius","border-top-right-radius":"border-bottom-left-radius",
"border-top-style":"border-bottom-style","border-top-width":"border-bottom-width","border-width":"border-bottom-width",bottom:{cssPropBits:5,cssLitGroup:[J[52]],cssFns:[]},box:{cssPropBits:0,cssLitGroup:[J[60],J[71],J[72]],cssFns:[]},"box-shadow":{cssPropBits:7,cssLitGroup:[J[0],J[48],J[64],J[71]],cssFns:["rgb()","rgba()"]},"box-sizing":{cssPropBits:0,cssLitGroup:[J[25]],cssFns:[]},"caption-side":{cssPropBits:0,cssLitGroup:[J[31]],cssFns:[]},clear:{cssPropBits:0,cssLitGroup:[J[42],J[54],J[71]],cssFns:[]},
clip:{cssPropBits:0,cssLitGroup:[J[52]],cssFns:["rect()"]},color:"background-color",content:{cssPropBits:8,cssLitGroup:[J[71],J[72]],cssFns:[]},cue:{cssPropBits:16,cssLitGroup:[J[71]],cssFns:[]},"cue-after":"cue","cue-before":"cue",cursor:{cssPropBits:16,cssLitGroup:[J[1],J[48],J[52]],cssFns:[]},direction:{cssPropBits:0,cssLitGroup:[J[43]],cssFns:[]},display:{cssPropBits:0,cssLitGroup:[J[4],J[6],J[20],J[52],J[67],J[71]],cssFns:[]},"display-extras":{cssPropBits:0,cssLitGroup:[J[67],J[71]],cssFns:[]},
"display-inside":{cssPropBits:0,cssLitGroup:[J[20],J[52]],cssFns:[]},"display-outside":{cssPropBits:0,cssLitGroup:[J[4],J[71]],cssFns:[]},elevation:{cssPropBits:5,cssLitGroup:[J[15]],cssFns:[]},"empty-cells":{cssPropBits:0,cssLitGroup:[J[38]],cssFns:[]},filter:{cssPropBits:0,cssFns:["alpha()"]},"float":{cssPropBits:0,cssLitGroup:[J[42],J[71]],cssFns:[]},font:{cssPropBits:73,cssLitGroup:[J[3],J[8],J[13],J[16],J[41],J[48],J[49],J[69],J[72],J[77]],cssFns:[]},"font-family":{cssPropBits:72,cssLitGroup:[J[16],
J[48]],cssFns:[]},"font-size":{cssPropBits:1,cssLitGroup:[J[8],J[69]],cssFns:[]},"font-stretch":{cssPropBits:0,cssLitGroup:[J[5],J[72]],cssFns:[]},"font-style":{cssPropBits:0,cssLitGroup:[J[41],J[72]],cssFns:[]},"font-variant":{cssPropBits:0,cssLitGroup:[J[72],J[77]],cssFns:[]},"font-weight":{cssPropBits:0,cssLitGroup:[J[3],J[72]],cssFns:[]},height:"bottom",left:"bottom","letter-spacing":{cssPropBits:5,cssLitGroup:[J[72]],cssFns:[]},"line-height":{cssPropBits:1,cssLitGroup:[J[72]],cssFns:[]},"list-style":{cssPropBits:16,
cssLitGroup:[J[2],J[40],J[57],J[71]],cssFns:["image()","linear-gradient()","radial-gradient()","repeating-linear-gradient()","repeating-radial-gradient()"]},"list-style-image":{cssPropBits:16,cssLitGroup:[J[71]],cssFns:["image()","linear-gradient()","radial-gradient()","repeating-linear-gradient()","repeating-radial-gradient()"]},"list-style-position":{cssPropBits:0,cssLitGroup:[J[40]],cssFns:[]},"list-style-type":{cssPropBits:0,cssLitGroup:[J[2],J[57],J[71]],cssFns:[]},margin:"bottom","margin-bottom":"bottom",
"margin-left":"bottom","margin-right":"bottom","margin-top":"bottom","max-height":{cssPropBits:1,cssLitGroup:[J[52],J[71]],cssFns:[]},"max-width":"max-height","min-height":{cssPropBits:1,cssLitGroup:[J[52]],cssFns:[]},"min-width":"min-height",opacity:{cssPropBits:1,cssFns:[]},outline:{cssPropBits:7,cssLitGroup:[J[0],J[9],J[47],J[62],J[64],J[65],J[69],J[71]],cssFns:["rgb()","rgba()"]},"outline-color":{cssPropBits:2,cssLitGroup:[J[0],J[65]],cssFns:["rgb()","rgba()"]},"outline-style":"border-bottom-style",
"outline-width":"border-bottom-width",overflow:{cssPropBits:0,cssLitGroup:[J[52],J[62],J[75],J[80]],cssFns:[]},"overflow-wrap":{cssPropBits:0,cssLitGroup:[J[55],J[72]],cssFns:[]},"overflow-x":{cssPropBits:0,cssLitGroup:[J[44],J[52],J[62],J[75],J[80]],cssFns:[]},"overflow-y":"overflow-x",padding:"opacity","padding-bottom":"opacity","padding-left":"opacity","padding-right":"opacity","padding-top":"opacity","page-break-after":{cssPropBits:0,cssLitGroup:[J[42],J[51],J[52],J[53]],cssFns:[]},"page-break-before":"page-break-after",
"page-break-inside":{cssPropBits:0,cssLitGroup:[J[52],J[53]],cssFns:[]},pause:"border-bottom-left-radius","pause-after":"border-bottom-left-radius","pause-before":"border-bottom-left-radius",perspective:{cssPropBits:5,cssLitGroup:[J[71]],cssFns:[]},"perspective-origin":{cssPropBits:5,cssLitGroup:[J[31],J[42],J[56]],cssFns:[]},pitch:{cssPropBits:5,cssLitGroup:[J[21],J[69]],cssFns:[]},"pitch-range":"border-bottom-left-radius","play-during":{cssPropBits:16,cssLitGroup:[J[52],J[70],J[71],J[74]],cssFns:[]},
position:{cssPropBits:0,cssLitGroup:[J[23]],cssFns:[]},quotes:{cssPropBits:8,cssLitGroup:[J[71]],cssFns:[]},resize:{cssPropBits:0,cssLitGroup:[J[39],J[54],J[71]],cssFns:[]},richness:"border-bottom-left-radius",right:"bottom",speak:{cssPropBits:0,cssLitGroup:[J[71],J[72],J[78]],cssFns:[]},"speak-header":{cssPropBits:0,cssLitGroup:[J[51],J[73]],cssFns:[]},"speak-numeral":{cssPropBits:0,cssLitGroup:[J[35]],cssFns:[]},"speak-punctuation":{cssPropBits:0,cssLitGroup:[J[58],J[71]],cssFns:[]},"speech-rate":{cssPropBits:5,
cssLitGroup:[J[14],J[69]],cssFns:[]},stress:"border-bottom-left-radius","table-layout":{cssPropBits:0,cssLitGroup:[J[52],J[61]],cssFns:[]},"text-align":{cssPropBits:0,cssLitGroup:[J[42],J[56],J[66]],cssFns:[]},"text-decoration":{cssPropBits:0,cssLitGroup:[J[19],J[71]],cssFns:[]},"text-indent":"border-bottom-left-radius","text-overflow":{cssPropBits:8,cssLitGroup:[J[33]],cssFns:[]},"text-shadow":"box-shadow","text-transform":{cssPropBits:0,cssLitGroup:[J[26],J[71]],cssFns:[]},"text-wrap":{cssPropBits:0,
cssLitGroup:[J[46],J[71],J[72]],cssFns:[]},top:"bottom",transform:{cssPropBits:0,cssLitGroup:[J[71]],cssFns:"matrix(),perspective(),rotate(),rotate3d(),rotatex(),rotatey(),rotatez(),scale(),scale3d(),scalex(),scaley(),scalez(),skew(),skewx(),skewy(),translate(),translate3d(),translatex(),translatey(),translatez()".split(",")},"transform-origin":"perspective-origin","transform-style":{cssPropBits:0,cssLitGroup:[J[37]],cssFns:[]},transition:{cssPropBits:1029,cssLitGroup:[J[10],J[48],J[50],J[71]],cssFns:["cubic-bezier()",
"steps()"]},"transition-delay":"animation-delay","transition-duration":"animation-delay","transition-property":{cssPropBits:1024,cssLitGroup:[J[48],J[50]],cssFns:[]},"transition-timing-function":"animation-timing-function","unicode-bidi":{cssPropBits:0,cssLitGroup:[J[30],J[72]],cssFns:[]},"vertical-align":{cssPropBits:5,cssLitGroup:[J[12],J[31]],cssFns:[]},visibility:"backface-visibility","voice-family":{cssPropBits:8,cssLitGroup:[J[27],J[48]],cssFns:[]},volume:{cssPropBits:1,cssLitGroup:[J[17],J[69]],
cssFns:[]},"white-space":{cssPropBits:0,cssLitGroup:[J[22],J[72]],cssFns:[]},width:"min-height","word-break":{cssPropBits:0,cssLitGroup:[J[32],J[72]],cssFns:[]},"word-spacing":"letter-spacing","word-wrap":"overflow-wrap","z-index":"bottom",zoom:"line-height","cubic-bezier()":"animation-delay","steps()":{cssPropBits:5,cssLitGroup:[J[36],J[48]],cssFns:[]},"image()":{cssPropBits:18,cssLitGroup:[J[0],J[48]],cssFns:["rgb()","rgba()"]},"linear-gradient()":{cssPropBits:7,cssLitGroup:[J[0],J[31],J[42],J[48],
J[79]],cssFns:["rgb()","rgba()"]},"radial-gradient()":{cssPropBits:7,cssLitGroup:[J[0],J[11],J[31],J[42],J[48],J[56],J[57]],cssFns:["rgb()","rgba()"]},"repeating-linear-gradient()":"linear-gradient()","repeating-radial-gradient()":"radial-gradient()","rgb()":{cssPropBits:1,cssLitGroup:[J[48]],cssFns:[]},"rgba()":"rgb()","rect()":{cssPropBits:5,cssLitGroup:[J[48],J[52]],cssFns:[]},"alpha()":{cssPropBits:1,cssLitGroup:[J[28]],cssFns:[]},"matrix()":"animation-delay","perspective()":"border-bottom-left-radius",
"rotate()":"border-bottom-left-radius","rotate3d()":"animation-delay","rotatex()":"border-bottom-left-radius","rotatey()":"border-bottom-left-radius","rotatez()":"border-bottom-left-radius","scale()":"animation-delay","scale3d()":"animation-delay","scalex()":"border-bottom-left-radius","scaley()":"border-bottom-left-radius","scalez()":"border-bottom-left-radius","skew()":"animation-delay","skewx()":"border-bottom-left-radius","skewy()":"border-bottom-left-radius","translate()":"animation-delay","translate3d()":"animation-delay",
"translatex()":"border-bottom-left-radius","translatey()":"border-bottom-left-radius","translatez()":"border-bottom-left-radius"},O;for(O in L)"string"===typeof L[O]&&Object.hasOwnProperty.call(L,O)&&(L[O]=L[L[O]]);"undefined"!==typeof window&&(window.cssSchema=L);var U,X;
(function(){function g(a){var b=parseInt(a.substring(1),16);return 65535<b?(b-=65536,String.fromCharCode(55296+(b>>10),56320+(b&1023))):b==b?String.fromCharCode(b):" ">a[1]?"":a[1]}function w(a,b){return'"'+a.replace(/[\u0000-\u001f\\\"<>]/g,b)+'"'}function M(a){return E[a]||(E[a]="\\"+a.charCodeAt(0).toString(16)+" ")}function x(a){return e[a]||(e[a]=("\u0010">a?"%0":"%")+a.charCodeAt(0).toString(16))}var E={"\\":"\\\\"},e={"\\":"%5c"},v=RegExp("\\uFEFF|U[+][0-9A-F?]{1,6}(?:-[0-9A-F]{1,6})?|url[(][\\t\\n\\f ]*(?:\"(?:'|[^'\"\\n\\f\\\\]|\\\\[\\s\\S])*\"|'(?:\"|[^'\"\\n\\f\\\\]|\\\\[\\s\\S])*'|(?:[\\t\\x21\\x23-\\x26\\x28-\\x5b\\x5d-\\x7e]|[\\u0080-\\ud7ff\\ue000-\\ufffd]|[\\ud800-\\udbff][\\udc00-\\udfff]|\\\\(?:[0-9a-fA-F]{1,6}[\\t\\n\\f ]?|[\\u0020-\\u007e\\u0080-\\ud7ff\\ue000\\ufffd]|[\\ud800-\\udbff][\\udc00-\\udfff]))*)[\\t\\n\\f ]*[)]|(?!url[(])-?(?:[a-zA-Z_]|[\\u0080-\\ud7ff\\ue000-\\ufffd]|[\\ud800-\\udbff][\\udc00-\\udfff]|\\\\(?:[0-9a-fA-F]{1,6}[\\t\\n\\f ]?|[\\u0020-\\u007e\\u0080-\\ud7ff\\ue000\\ufffd]|[\\ud800-\\udbff][\\udc00-\\udfff]))(?:[a-zA-Z0-9_-]|[\\u0080-\\ud7ff\\ue000-\\ufffd]|[\\ud800-\\udbff][\\udc00-\\udfff]|\\\\(?:[0-9a-fA-F]{1,6}[\\t\\n\\f ]?|[\\u0020-\\u007e\\u0080-\\ud7ff\\ue000\\ufffd]|[\\ud800-\\udbff][\\udc00-\\udfff]))*[(]|(?:@?-?(?:[a-zA-Z_]|[\\u0080-\\ud7ff\\ue000-\\ufffd]|[\\ud800-\\udbff][\\udc00-\\udfff]|\\\\(?:[0-9a-fA-F]{1,6}[\\t\\n\\f ]?|[\\u0020-\\u007e\\u0080-\\ud7ff\\ue000\\ufffd]|[\\ud800-\\udbff][\\udc00-\\udfff]))|#)(?:[a-zA-Z0-9_-]|[\\u0080-\\ud7ff\\ue000-\\ufffd]|[\\ud800-\\udbff][\\udc00-\\udfff]|\\\\(?:[0-9a-fA-F]{1,6}[\\t\\n\\f ]?|[\\u0020-\\u007e\\u0080-\\ud7ff\\ue000\\ufffd]|[\\ud800-\\udbff][\\udc00-\\udfff]))*|\"(?:'|[^'\"\\n\\f\\\\]|\\\\[\\s\\S])*\"|'(?:\"|[^'\"\\n\\f\\\\]|\\\\[\\s\\S])*'|[-+]?(?:[0-9]+(?:[.][0-9]+)?|[.][0-9]+)(?:%|-?(?:[a-zA-Z_]|[\\u0080-\\ud7ff\\ue000-\\ufffd]|[\\ud800-\\udbff][\\udc00-\\udfff]|\\\\(?:[0-9a-fA-F]{1,6}[\\t\\n\\f ]?|[\\u0020-\\u007e\\u0080-\\ud7ff\\ue000\\ufffd]|[\\ud800-\\udbff][\\udc00-\\udfff]))(?:[a-zA-Z0-9_-]|[\\u0080-\\ud7ff\\ue000-\\ufffd]|[\\ud800-\\udbff][\\udc00-\\udfff]|\\\\(?:[0-9a-fA-F]{1,6}[\\t\\n\\f ]?|[\\u0020-\\u007e\\u0080-\\ud7ff\\ue000\\ufffd]|[\\ud800-\\udbff][\\udc00-\\udfff]))*)?|<\!--|--\>|[\\t\\n\\f ]+|/(?:[*][^*]*[*]+(?:[^/][^*]*[*]+)*/|/[^\\n\\f]*)|[~|^$*]=|[^\"'\\\\/]|/(?![/*])","gi"),
f=RegExp("\\\\(?:(?:[0-9a-fA-F]{1,6}[\\t\\n\\f ]?|[\\u0020-\\u007e\\u0080-\\ud7ff\\ue000\\ufffd]|[\\ud800-\\udbff][\\udc00-\\udfff])|[\\n\\f])","g"),a=RegExp("^url\\([\\t\\n\\f ]*[\"']?|[\"']?[\\t\\n\\f ]*\\)$","gi");X=function(a){return a.replace(f,g)};U=function(f){for(var f=("\uffff"+f).replace(/^\uffff/,""),f=f.replace(/\r\n?/g,"\n"),f=f.match(v)||[],b=0,h=" ",d=0,y=f.length;d<y;++d){var l=X(f[d]),V=l.length,g=l.charCodeAt(0),l=34==g||39==g?w(l.substring(1,V-1),M):47==g&&1<V||"\\"==l||"--\>"==
l||"<\!--"==l||"\ufeff"==l||32>=g?" ":/url\(/i.test(l)?"url("+w(l.replace(a,""),x)+")":l;if(h!=l||" "!=l)f[b++]=h=l}f.length=b;return f}})();"undefined"!==typeof window&&(window.lexCss=U,window.decodeCss=X);var Y=function(){function g(d){d=(""+d).match(i);return!d?s:new e(v(d[1]),v(d[2]),v(d[3]),v(d[4]),v(d[5]),v(d[6]),v(d[7]))}function w(d,a){return"string"==typeof d?encodeURI(d).replace(a,M):s}function M(d){d=d.charCodeAt(0);return"%"+"0123456789ABCDEF".charAt(d>>4&15)+"0123456789ABCDEF".charAt(d&15)}function x(d){if(d===s)return s;for(var d=d.replace(/(^|\/)\.(?:\/|$)/g,"$1").replace(/\/{2,}/g,"/"),a=f,h;(h=d.replace(a,"$1"))!=d;d=h);return d}function E(d,h){var f=d.T(),b=h.K();b?f.ga(h.j):b=h.X();
b?f.da(h.n):b=h.Y();b?f.ea(h.k):b=h.$();var g=h.g,i=x(g);if(b)f.ca(h.V()),i=i&&i.replace(a,"");else if(b=!!g){if(47!==i.charCodeAt(0))var i=x(f.g||"").replace(a,""),e=i.lastIndexOf("/")+1,i=x((e?i.substring(0,e):"")+x(g)).replace(a,"")}else i=i&&i.replace(a,""),i!==g&&f.G(i);b?f.G(i):b=h.aa();b?f.O(h.l):b=h.Z();b&&f.fa(h.o);return f}function e(d,a,h,f,b,g,i){this.j=d;this.n=a;this.k=h;this.h=f;this.g=b;this.l=g;this.o=i}function v(d){return"string"==typeof d&&0<d.length?d:s}var f=RegExp(/(\/|^)(?:[^./][^/]*|\.{2,}(?:[^./][^/]*)|\.{3,}[^/]*)\/\.\.(?:\/|$)/),
a=/^(?:\.\.\/)*(?:\.\.$)?/;e.prototype.toString=function(){var d=[];s!==this.j&&d.push(this.j,":");s!==this.k&&(d.push("//"),s!==this.n&&d.push(this.n,"@"),d.push(this.k),s!==this.h&&d.push(":",this.h.toString()));s!==this.g&&d.push(this.g);s!==this.l&&d.push("?",this.l);s!==this.o&&d.push("#",this.o);return d.join("")};e.prototype.T=function(){return new e(this.j,this.n,this.k,this.h,this.g,this.l,this.o)};e.prototype.W=function(){return this.j&&decodeURIComponent(this.j).toLowerCase()};e.prototype.ga=
function(d){this.j=d?d:s};e.prototype.K=function(){return s!==this.j};e.prototype.da=function(d){this.n=d?d:s};e.prototype.X=function(){return s!==this.n};e.prototype.ea=function(d){this.k=d?d:s;this.G(this.g)};e.prototype.Y=function(){return s!==this.k};e.prototype.V=function(){return this.h&&decodeURIComponent(this.h)};e.prototype.ca=function(d){if(d){d=Number(d);if(d!==(d&65535))throw Error("Bad port number "+d);this.h=""+d}else this.h=s};e.prototype.$=function(){return s!==this.h};e.prototype.U=
function(){return this.g&&decodeURIComponent(this.g)};e.prototype.G=function(d){d?(d=""+d,this.g=!this.k||/^\//.test(d)?d:"/"+d):this.g=s};e.prototype.O=function(d){this.l=d?d:s};e.prototype.aa=function(){return s!==this.l};e.prototype.ba=function(d){if("object"===typeof d&&!(d instanceof Array)&&(d instanceof Object||"[object Array]"!==Object.prototype.toString.call(d))){var a=[],h=-1,f;for(f in d){var b=d[f];"string"===typeof b&&(a[++h]=f,a[++h]=b)}d=a}for(var a=[],h="",g=0;g<d.length;)f=d[g++],
b=d[g++],a.push(h,encodeURIComponent(f.toString())),h="&",b&&a.push("=",encodeURIComponent(b.toString()));this.l=a.join("")};e.prototype.fa=function(d){this.o=d?d:s};e.prototype.Z=function(){return s!==this.o};var i=/^(?:([^:/?#]+):)?(?:\/\/(?:([^/?#]*)@)?([^/?#:@]*)(?::([0-9]+))?)?([^?#]+)?(?:\?([^#]*))?(?:#(.*))?$/,b=/[#\/\?@]/g,h=/[\#\?]/g;e.parse=g;e.create=function(d,a,f,g,i,Q,N){d=new e(w(d,b),w(a,b),"string"==typeof f?encodeURIComponent(f):s,0<g?g.toString():s,w(i,h),s,"string"==typeof N?encodeURIComponent(N):
s);Q&&("string"===typeof Q?d.O(Q.replace(/[^?&=0-9A-Za-z_\-~.%]/g,M)):d.ba(Q));return d};e.N=E;e.ma=x;e.ha={ua:function(d){return/\.html$/.test(g(d).U())?"text/html":"application/javascript"},N:function(d,a){return d?E(g(d),g(a)).toString():""+a}};return e}();"undefined"!==typeof window&&(window.URI=Y);var aa=c,ba=c,da=c,Z=c;
(function(){function g(a){return"string"===typeof a?'url("'+a.replace(e,w)+'")':'url("about:blank")'}function w(a){return v[a]}function M(a,d){return a?Y.ha.N(a,d):d}function x(h,d,b){if(!b)return s;var g=(""+h).match(f);return g&&(!g[1]||a.test(g[1]))?b(h,d):s}function E(a){return a.replace(/^-(?:apple|css|epub|khtml|moz|mso?|o|rim|wap|webkit|xv)-(?=[a-z])/,"")}var e=/[\n\f\r\"\'()*<>]/g,v={"\n":"%0a","\u000c":"%0c","\r":"%0d",'"':"%22","'":"%27","(":"%28",")":"%29","*":"%2a","<":"%3c",">":"%3e"},
f=/^(?:([^:/?# ]+):)?/,a=/^(?:https?|geo|mailto|sms|tel)$/i;aa=function(){var a={};return function y(f,b,i,e,N){var f=E(f),u=L[f];if(!u||"object"!==typeof u)b.length=0;else{for(var k=u.cssPropBits,q=k&80,B=k&1536,F=NaN,r=0,o=0;r<b.length;++r){var j=b[r].toLowerCase(),I=j.charCodeAt(0),R,v,P,S,D,w;if(32===I)j="";else if(34===I)j=16===q?i?g(x(M(e,X(b[r].substring(1,j.length-1))),f,i)):"":k&8&&!(q&q-1)?j:"";else if("inherit"!==j){if(D=u.cssLitGroup){var G;if(!(G=u.cssLitMap)){G={};for(var K=D.length;0<=
--K;)for(var A=D[K],T=A.length;0<=--T;)G[A[T]]=a;G=u.cssLitMap=G}D=G}else D=a;if(!(w=D,w[E(j)]===a))if(35===I&&/^#(?:[0-9a-f]{3}){1,2}$/.test(j))j=k&2?j:"";else if(48<=I&&57>=I)j=k&1?j:"";else if(R=j.charCodeAt(1),v=j.charCodeAt(2),P=48<=R&&57>=R,S=48<=v&&57>=v,43===I&&(P||46===R&&S))j=k&1?(P?"":"0")+j.substring(1):"";else if(45===I&&(P||46===R&&S))j=k&4?(P?"-":"-0")+j.substring(1):k&1?"0":"";else if(46===I&&P)j=k&1?"0"+j:"";else if('url("'===j.substring(0,5))j=i&&k&16?g(x(M(e,b[r].substring(5,j.length-
2)),f,i)):"";else if("("===j.charAt(j.length-1))a:{D=b;G=r;j=1;K=G+1;for(I=D.length;K<I&&j;)A=D[K++],j+=")"===A?-1:/^[^"']*\($/.test(A);if(!j){j=D[G].toLowerCase();I=E(j);D=D.splice(G,K-G,"");G=u.cssFns;K=0;for(A=G.length;K<A;++K)if(G[K].substring(0,I.length)==I){D[0]=D[D.length-1]="";y(G[K],D,i,e);j=j+D.join(" ")+")";break a}}j=""}else j=B&&/^-?[a-z_][\w\-]*$/.test(j)&&!/__$/.test(j)?N&&512===B?b[r]+N:1024===B&&L[j]&&"number"===typeof L[j].oa?j:"":/^\w+$/.test(j)&&64===q&&k&8?F+1===o?(b[F]=b[F].substring(0,
b[F].length-1)+" "+j+'"',""):(F=o,'"'+j+'"'):""}j&&(b[o++]=j)}1===o&&'url("about:blank")'===b[0]&&(o=0);b.length=o}}}();var i=RegExp("^(active|after|before|blank|checked|default|disabled|drop|empty|enabled|first|first-child|first-letter|first-line|first-of-type|fullscreen|focus|hover|in-range|indeterminate|invalid|last-child|last-of-type|left|link|only-child|only-of-type|optional|out-of-range|placeholder-shown|read-only|read-write|required|right|root|scope|user-error|valid|visited)$"),b={};b[">"]=
b["+"]=b["~"]=b;ba=function(a,d,f){function g(k,r){function o(b,f,g){var y,e,k,l,o,m=n;y="";if(b<f)if(o=a[b],"*"===o)++b,y=o;else if(/^[a-zA-Z]/.test(o)&&(e=x(o.toLowerCase(),[])))"tagName"in e&&(o=e.tagName),++b,y=o;for(l=k=e="";m&&b<f;++b)if(o=a[b],"#"===o.charAt(0))/^#_|__$|[^\w#:\-]/.test(o)?m=C:e+=o+v;else if("."===o)++b<f&&/^[0-9A-Za-z:_\-]+$/.test(o=a[b])&&!/^_|__$/.test(o)?e+="."+o:m=C;else if(b+1<f&&"["===a[b]){++b;var H=a[b++].toLowerCase();o=$.m[y+"::"+H];o!==+o&&(o=$.m["*::"+H]);var W;
d.ia?(W=d.ia(y,H),"string"!==typeof W&&(m=C,W=H),m&&o!==+o&&(o=$.d.NONE)):(W=H,o!==+o&&(m=C));var p=H="",ca=C;/^[~^$*|]?=$/.test(a[b])&&(H=a[b++],p=a[b++],/^[0-9A-Za-z:_\-]+$/.test(p)?p='"'+p+'"':"]"===p&&(p='""',--b),/^"([^\"\\]|\\.)*"$/.test(p)||(m=C),(ca="i"===a[b])&&++b);"]"!==a[b]&&(++b,m=C);switch(o){case $.d.CLASSES:case $.d.LOCAL_NAME:case $.d.NONE:break;case $.d.GLOBAL_NAME:case $.d.ID:case $.d.IDREF:("="===H||"~="===H||"$="===H)&&'""'!=p&&!ca?p='"'+p.substring(1,p.length-1)+v+'"':"|="===
H||""===H||(m=C);break;case $.d.URI:case $.d.URI_FRAGMENT:""!==H&&(m=C);break;default:m=C}m&&(k+="["+W.replace(/[^\w-]/g,"\\$&")+H+p+(ca?" i]":"]"))}else if(b<f&&":"===a[b])if(o=a[++b],i.test(o))l+=":"+o;else break;else break;b!==f&&(m=C);m&&(b=(y+e).replace(/[^ .*#\w-]/g,"\\$&")+k+l+g)&&j.push(b);return m}" "===a[k]&&++k;r-1!==k&&" "===a[r]&&--r;for(var j=[],l=k,q=n,u=k;q&&u<r;++u){var B=a[u];if(b[B]===b||" "===B)o(l,u,B)?l=u+1:q=C}o(l,r,"")||(q=C);return q?(j.length&&(l=j.join(""),e!==s&&(l="."+
e+" "+l),N.push(l)),n):!f||f(a.slice(k,r))}var e=d.na,v=d.L,x=d.Aa,N=[],u=0,k,q=0,B;for(k=0;k<a.length;++k)if(B=a[k],"("==B||"["==B?(++q,n):")"==B||"]"==B?(q&&--q,n):!(" "==a[k]&&(q||b[a[k-1]]===b||b[a[k+1]]===b)))a[u++]=a[k];a.length=u;u=a.length;for(k=q=0;k<u;++k)if(","===a[k]){if(!g(q,k))return s;q=k+1}return!g(q,u)?s:N};(function(){var a=/^\w/,d=RegExp("^(?:(?:(?:(?:only|not) )?(?:all|aural|braille|embossed|handheld|print|projection|screen|speech|tty|tv)|\\( (?:(?:min-|max-)?(?:(?:device-)?(?:aspect-ratio|height|width)|color(?:-index)?|monochrome|orientation|resolution)|grid|hover|luminosity|pointer|scan|script) (?:: -?(?:[a-z]\\w+(?:-\\w+)*|\\d+(?: / \\d+|(?:\\.\\d+)?(?:p[cxt]|[cem]m|in|dpi|dppx|dpcm|%)?)) )?\\))(?: and ?\\( (?:(?:min-|max-)?(?:(?:device-)?(?:aspect-ratio|height|width)|color(?:-index)?|monochrome|orientation|resolution)|grid|hover|luminosity|pointer|scan|script) (?:: -?(?:[a-z]\\w+(?:-\\w+)*|\\d+(?: / \\d+|(?:\\.\\d+)?(?:p[cxt]|[cem]m|in|dpi|dppx|dpcm|%)?)) )?\\))*)(?: , (?:(?:(?:(?:only|not) )?(?:all|aural|braille|embossed|handheld|print|projection|screen|speech|tty|tv)|\\( (?:(?:min-|max-)?(?:(?:device-)?(?:aspect-ratio|height|width)|color(?:-index)?|monochrome|orientation|resolution)|grid|hover|luminosity|pointer|scan|script) (?:: -?(?:[a-z]\\w+(?:-\\w+)*|\\d+(?: / \\d+|(?:\\.\\d+)?(?:p[cxt]|[cem]m|in|dpi|dppx|dpcm|%)?)) )?\\))(?: and ?\\( (?:(?:min-|max-)?(?:(?:device-)?(?:aspect-ratio|height|width)|color(?:-index)?|monochrome|orientation|resolution)|grid|hover|luminosity|pointer|scan|script) (?:: -?(?:[a-z]\\w+(?:-\\w+)*|\\d+(?: / \\d+|(?:\\.\\d+)?(?:p[cxt]|[cem]m|in|dpi|dppx|dpcm|%)?)) )?\\))*))*$",
"i");Z=function(b){for(var b=b.slice(),f=b.length,g=0,i=0;i<f;++i){var e=b[i];" "!=e&&(b[g++]=e)}b.length=g;b=b.join(" ");return b=!b.length?"":!d.test(b)?"not all":a.test(b)?b:"not all , "+b}})();(function(){function a(b){var d=/^\s*[']([^']*)[']\s*$/,f=/^\s*url\s*[(]["]([^"]*)["][)]\s*$/,g=/^\s*url\s*[(][']([^']*)['][)]\s*$/,h=/^\s*url\s*[(]([^)]*)[)]\s*$/,i;return(i=/^\s*["]([^"]*)["]\s*$/.exec(b))||(i=d.exec(b))||(i=f.exec(b))||(i=g.exec(b))||(i=h.exec(b))?i[1]:s}function b(f,g,i,e,v,w,u){function k(){r=
F.length&&F[F.length-1]===s}var q=c,B=u||[0],F=[],r=C;fa(g,{startStylesheet:function(){q=[]},endStylesheet:function(){},startAtrule:function(g,j){if(r)g=s;else if("@media"===g)q.push("@media"," ",Z(j));else if("@keyframes"===g||"@-webkit-keyframes"===g){var k=j[0];1===j.length&&!/__$|[^\w\-]/.test(k)?(q.push(g," ",k+i.L),g="@keyframes"):g=s}else if("@import"===g&&0<j.length)if(g=s,"function"===typeof w){var l=Z(j.slice(1));if("not all"!==l){++B[0];var u=[];q.push(u);var E=x(M(f,a(j[0])),function(a){var f=
b(E,a.qa,i,e,v,w,B);--B[0];a=l?{toString:function(){return"@media "+l+" {"+f.result+"}"}}:f.result;u[0]=a;w(a,!!B[0])},v)}}else window.console&&window.console.log("@import "+j.join(" ")+" elided");r=!g;F.push(g)},endAtrule:function(){F.pop();r||q.push(";");k()},startBlock:function(){r||q.push("{")},endBlock:function(){r||(q.push("}"),r=n)},startRuleset:function(a){if(!r){var b=c;"@keyframes"===F[F.length-1]?(b=a.join(" ").match(/^ *(?:from|to|\d+(?:\.\d+)?%) *(?:, *(?:from|to|\d+(?:\.\d+)?%) *)*$/i),
r=!b,b&&(b=b[0].replace(/ +/g,""))):(a=ba(a,i),!a||!a.length?r=n:b=a.join(", "));r||q.push(b,"{")}F.push(s)},endRuleset:function(){F.pop();r||q.push("}");k()},declaration:function(a,b){if(!r){var d=C,g=b.length;2<=g&&"!"===b[g-2]&&"important"===b[g-1].toLowerCase()&&(d=n,b.length-=2);aa(a,b,e,f,i.L);b.length&&q.push(a,":",b.join(" "),d?" !important;":";")}}});return{result:{toString:function(){return q.join("")}},va:!!B[0]}}da=function(a,f,g,i){return b(a,f,g,i,c,c).result.toString()}})()})();
"undefined"!==typeof window&&(window.sanitizeCssProperty=aa,window.sanitizeCssSelectorList=ba,window.sanitizeStylesheet=da,window.sanitizeMediaQuery=Z);var fa,ga;
(function(){function g(f,a,g,b,h){for(var d=a++;a<g&&"{"!==f[a]&&";"!==f[a];)++a;if(a<g&&(h||";"===f[a])){var h=d+1,e=a;h<g&&" "===f[h]&&++h;e>h&&" "===f[e-1]&&--e;b.startAtrule&&b.startAtrule(f[d].toLowerCase(),f.slice(h,e));a="{"===f[a]?w(f,a,g,b):a+1;b.endAtrule&&b.endAtrule()}return a}function w(f,a,i,b){++a;for(b.startBlock&&b.startBlock();a<i;){var h=f[a].charAt(0);if("}"==h){++a;break}a=" "===h||";"===h?a+1:"@"===h?g(f,a,i,b,C):"{"===h?w(f,a,i,b):M(f,a,i,b)}b.endBlock&&b.endBlock();return a}
function M(f,a,g,b){var h=a,d=x(f,a,g,n);if(0>d)return d=~d,d===h?d+1:d;var y=f[d];if("{"!==y)return d===h?d+1:d;a=d+1;d>h&&" "===f[d-1]&&--d;for(b.startRuleset&&b.startRuleset(f.slice(h,d));a<g;){y=f[a];if("}"===y){++a;break}a=" "===y?a+1:e(f,a,g,b)}b.endRuleset&&b.endRuleset();return a}function x(f,a,g,b){for(var h,d=[],e=-1;a<g;++a)if(h=f[a].charAt(0),"["===h||"("===h)d[++e]=h;else if("]"===h&&"["===d[e]||")"===h&&"("===d[e])--e;else if("{"===h||"}"===h||";"===h||"@"===h||":"===h&&!b)break;0<=
e&&(a=~(a+1));return a}function E(f,a,g){for(;a<g&&";"!==f[a]&&"}"!==f[a];)++a;return a<g&&";"===f[a]?a+1:a}function e(f,a,g,b){var h=f[a++];if(!v.test(h))return E(f,a,g);a<g&&" "===f[a]&&++a;if(a==g||":"!==f[a])return E(f,a,g);++a;a<g&&" "===f[a]&&++a;var d=x(f,a,g,C);if(0>d)d=~d;else{for(var e=[],l=0,w=a;w<d;++w)a=f[w]," "!==a&&(e[l++]=a);if(d<g){do{a=f[d];if(";"===a||"}"===a)break;l=0}while(++d<g);";"===a&&++d}l&&b.declaration&&b.declaration(h.toLowerCase(),e)}return d}fa=function(f,a){var e=U(f);
a.startStylesheet&&a.startStylesheet();for(var b=0,h=e.length;b<h;)b=" "===e[b]?b+1:b<h?"@"===e[b].charAt(0)?g(e,b,h,a,n):M(e,b,h,a):b;a.endStylesheet&&a.endStylesheet()};var v=/^-?[a-z]/i;ga=function(g,a){for(var i=U(g),b=0,h=i.length;b<h;)b=" "!==i[b]?e(i,b,h,a):b+1}})();"undefined"!==typeof window&&(window.parseCssStylesheet=fa,window.parseCssDeclarations=ga);var $={d:{NONE:0,URI:1,URI_FRAGMENT:11,SCRIPT:2,STYLE:3,HTML:12,ID:4,IDREF:5,IDREFS:6,GLOBAL_NAME:7,LOCAL_NAME:8,CLASSES:9,FRAME_TARGET:10,MEDIA_QUERY:13}};$.atype=$.d;
$.m={"*::class":9,"*::dir":0,"*::draggable":0,"*::hidden":0,"*::id":4,"*::inert":0,"*::itemprop":0,"*::itemref":6,"*::itemscope":0,"*::lang":0,"*::onblur":2,"*::onchange":2,"*::onclick":2,"*::ondblclick":2,"*::onerror":2,"*::onfocus":2,"*::onkeydown":2,"*::onkeypress":2,"*::onkeyup":2,"*::onload":2,"*::onmousedown":2,"*::onmousemove":2,"*::onmouseout":2,"*::onmouseover":2,"*::onmouseup":2,"*::onreset":2,"*::onscroll":2,"*::onselect":2,"*::onsubmit":2,"*::ontouchcancel":2,"*::ontouchend":2,"*::ontouchenter":2,
"*::ontouchleave":2,"*::ontouchmove":2,"*::ontouchstart":2,"*::onunload":2,"*::spellcheck":0,"*::style":3,"*::tabindex":0,"*::title":0,"*::translate":0,"a::accesskey":0,"a::coords":0,"a::href":1,"a::hreflang":0,"a::name":7,"a::onblur":2,"a::onfocus":2,"a::shape":0,"a::target":10,"a::type":0,"area::accesskey":0,"area::alt":0,"area::coords":0,"area::href":1,"area::nohref":0,"area::onblur":2,"area::onfocus":2,"area::shape":0,"area::target":10,"audio::controls":0,"audio::loop":0,"audio::mediagroup":5,
"audio::muted":0,"audio::preload":0,"audio::src":1,"bdo::dir":0,"blockquote::cite":1,"br::clear":0,"button::accesskey":0,"button::disabled":0,"button::name":8,"button::onblur":2,"button::onfocus":2,"button::type":0,"button::value":0,"canvas::height":0,"canvas::width":0,"caption::align":0,"col::align":0,"col::char":0,"col::charoff":0,"col::span":0,"col::valign":0,"col::width":0,"colgroup::align":0,"colgroup::char":0,"colgroup::charoff":0,"colgroup::span":0,"colgroup::valign":0,"colgroup::width":0,
"command::checked":0,"command::command":5,"command::disabled":0,"command::icon":1,"command::label":0,"command::radiogroup":0,"command::type":0,"data::value":0,"del::cite":1,"del::datetime":0,"details::open":0,"dir::compact":0,"div::align":0,"dl::compact":0,"fieldset::disabled":0,"font::color":0,"font::face":0,"font::size":0,"form::accept":0,"form::action":1,"form::autocomplete":0,"form::enctype":0,"form::method":0,"form::name":7,"form::novalidate":0,"form::onreset":2,"form::onsubmit":2,"form::target":10,
"h1::align":0,"h2::align":0,"h3::align":0,"h4::align":0,"h5::align":0,"h6::align":0,"hr::align":0,"hr::noshade":0,"hr::size":0,"hr::width":0,"iframe::align":0,"iframe::frameborder":0,"iframe::height":0,"iframe::marginheight":0,"iframe::marginwidth":0,"iframe::width":0,"img::align":0,"img::alt":0,"img::border":0,"img::height":0,"img::hspace":0,"img::ismap":0,"img::name":7,"img::src":1,"img::usemap":11,"img::vspace":0,"img::width":0,"input::accept":0,"input::accesskey":0,"input::align":0,"input::alt":0,
"input::autocomplete":0,"input::checked":0,"input::disabled":0,"input::inputmode":0,"input::ismap":0,"input::list":5,"input::max":0,"input::maxlength":0,"input::min":0,"input::multiple":0,"input::name":8,"input::onblur":2,"input::onchange":2,"input::onfocus":2,"input::onselect":2,"input::pattern":0,"input::placeholder":0,"input::readonly":0,"input::required":0,"input::size":0,"input::src":1,"input::step":0,"input::type":0,"input::usemap":11,"input::value":0,"ins::cite":1,"ins::datetime":0,"label::accesskey":0,
"label::for":5,"label::onblur":2,"label::onfocus":2,"legend::accesskey":0,"legend::align":0,"li::type":0,"li::value":0,"map::name":7,"menu::compact":0,"menu::label":0,"menu::type":0,"meter::high":0,"meter::low":0,"meter::max":0,"meter::min":0,"meter::optimum":0,"meter::value":0,"ol::compact":0,"ol::reversed":0,"ol::start":0,"ol::type":0,"optgroup::disabled":0,"optgroup::label":0,"option::disabled":0,"option::label":0,"option::selected":0,"option::value":0,"output::for":6,"output::name":8,"p::align":0,
"pre::width":0,"progress::max":0,"progress::min":0,"progress::value":0,"q::cite":1,"select::autocomplete":0,"select::disabled":0,"select::multiple":0,"select::name":8,"select::onblur":2,"select::onchange":2,"select::onfocus":2,"select::required":0,"select::size":0,"source::type":0,"table::align":0,"table::bgcolor":0,"table::border":0,"table::cellpadding":0,"table::cellspacing":0,"table::frame":0,"table::rules":0,"table::summary":0,"table::width":0,"tbody::align":0,"tbody::char":0,"tbody::charoff":0,
"tbody::valign":0,"td::abbr":0,"td::align":0,"td::axis":0,"td::bgcolor":0,"td::char":0,"td::charoff":0,"td::colspan":0,"td::headers":6,"td::height":0,"td::nowrap":0,"td::rowspan":0,"td::scope":0,"td::valign":0,"td::width":0,"textarea::accesskey":0,"textarea::autocomplete":0,"textarea::cols":0,"textarea::disabled":0,"textarea::inputmode":0,"textarea::name":8,"textarea::onblur":2,"textarea::onchange":2,"textarea::onfocus":2,"textarea::onselect":2,"textarea::placeholder":0,"textarea::readonly":0,"textarea::required":0,
"textarea::rows":0,"textarea::wrap":0,"tfoot::align":0,"tfoot::char":0,"tfoot::charoff":0,"tfoot::valign":0,"th::abbr":0,"th::align":0,"th::axis":0,"th::bgcolor":0,"th::char":0,"th::charoff":0,"th::colspan":0,"th::headers":6,"th::height":0,"th::nowrap":0,"th::rowspan":0,"th::scope":0,"th::valign":0,"th::width":0,"thead::align":0,"thead::char":0,"thead::charoff":0,"thead::valign":0,"tr::align":0,"tr::bgcolor":0,"tr::char":0,"tr::charoff":0,"tr::valign":0,"track::default":0,"track::kind":0,"track::label":0,
"track::srclang":0,"ul::compact":0,"ul::type":0,"video::controls":0,"video::height":0,"video::loop":0,"video::mediagroup":5,"video::muted":0,"video::poster":1,"video::preload":0,"video::src":1,"video::width":0};$.ATTRIBS=$.m;$.c={OPTIONAL_ENDTAG:1,EMPTY:2,CDATA:4,RCDATA:8,UNSAFE:16,FOLDABLE:32,SCRIPT:64,STYLE:128,VIRTUALIZED:256};$.eflags=$.c;
$.f={a:0,abbr:0,acronym:0,address:0,applet:272,area:2,article:0,aside:0,audio:0,b:0,base:274,basefont:274,bdi:0,bdo:0,big:0,blockquote:0,body:305,br:2,button:0,canvas:0,caption:0,center:0,cite:0,code:0,col:2,colgroup:1,command:2,data:0,datalist:0,dd:1,del:0,details:0,dfn:0,dialog:272,dir:0,div:0,dl:0,dt:1,em:0,fieldset:0,figcaption:0,figure:0,font:0,footer:0,form:0,frame:274,frameset:272,h1:0,h2:0,h3:0,h4:0,h5:0,h6:0,head:305,header:0,hgroup:0,hr:2,html:305,i:0,iframe:0,img:2,input:2,ins:0,isindex:274,
kbd:0,keygen:274,label:0,legend:0,li:1,link:274,map:0,mark:0,menu:0,meta:274,meter:0,nav:0,nobr:0,noembed:276,noframes:276,noscript:276,object:272,ol:0,optgroup:0,option:1,output:0,p:1,param:274,pre:0,progress:0,q:0,s:0,samp:0,script:84,section:0,select:0,small:0,source:2,span:0,strike:0,strong:0,style:148,sub:0,summary:0,sup:0,table:0,tbody:1,td:1,textarea:8,tfoot:1,th:1,thead:1,time:0,title:280,tr:1,track:2,tt:0,u:0,ul:0,"var":0,video:0,wbr:2};$.ELEMENTS=$.f;
$.Q={a:"HTMLAnchorElement",abbr:"HTMLElement",acronym:"HTMLElement",address:"HTMLElement",applet:"HTMLAppletElement",area:"HTMLAreaElement",article:"HTMLElement",aside:"HTMLElement",audio:"HTMLAudioElement",b:"HTMLElement",base:"HTMLBaseElement",basefont:"HTMLBaseFontElement",bdi:"HTMLElement",bdo:"HTMLElement",big:"HTMLElement",blockquote:"HTMLQuoteElement",body:"HTMLBodyElement",br:"HTMLBRElement",button:"HTMLButtonElement",canvas:"HTMLCanvasElement",caption:"HTMLTableCaptionElement",center:"HTMLElement",
cite:"HTMLElement",code:"HTMLElement",col:"HTMLTableColElement",colgroup:"HTMLTableColElement",command:"HTMLCommandElement",data:"HTMLElement",datalist:"HTMLDataListElement",dd:"HTMLElement",del:"HTMLModElement",details:"HTMLDetailsElement",dfn:"HTMLElement",dialog:"HTMLDialogElement",dir:"HTMLDirectoryElement",div:"HTMLDivElement",dl:"HTMLDListElement",dt:"HTMLElement",em:"HTMLElement",fieldset:"HTMLFieldSetElement",figcaption:"HTMLElement",figure:"HTMLElement",font:"HTMLFontElement",footer:"HTMLElement",
form:"HTMLFormElement",frame:"HTMLFrameElement",frameset:"HTMLFrameSetElement",h1:"HTMLHeadingElement",h2:"HTMLHeadingElement",h3:"HTMLHeadingElement",h4:"HTMLHeadingElement",h5:"HTMLHeadingElement",h6:"HTMLHeadingElement",head:"HTMLHeadElement",header:"HTMLElement",hgroup:"HTMLElement",hr:"HTMLHRElement",html:"HTMLHtmlElement",i:"HTMLElement",iframe:"HTMLIFrameElement",img:"HTMLImageElement",input:"HTMLInputElement",ins:"HTMLModElement",isindex:"HTMLUnknownElement",kbd:"HTMLElement",keygen:"HTMLKeygenElement",
label:"HTMLLabelElement",legend:"HTMLLegendElement",li:"HTMLLIElement",link:"HTMLLinkElement",map:"HTMLMapElement",mark:"HTMLElement",menu:"HTMLMenuElement",meta:"HTMLMetaElement",meter:"HTMLMeterElement",nav:"HTMLElement",nobr:"HTMLElement",noembed:"HTMLElement",noframes:"HTMLElement",noscript:"HTMLElement",object:"HTMLObjectElement",ol:"HTMLOListElement",optgroup:"HTMLOptGroupElement",option:"HTMLOptionElement",output:"HTMLOutputElement",p:"HTMLParagraphElement",param:"HTMLParamElement",pre:"HTMLPreElement",
progress:"HTMLProgressElement",q:"HTMLQuoteElement",s:"HTMLElement",samp:"HTMLElement",script:"HTMLScriptElement",section:"HTMLElement",select:"HTMLSelectElement",small:"HTMLElement",source:"HTMLSourceElement",span:"HTMLSpanElement",strike:"HTMLElement",strong:"HTMLElement",style:"HTMLStyleElement",sub:"HTMLElement",summary:"HTMLElement",sup:"HTMLElement",table:"HTMLTableElement",tbody:"HTMLTableSectionElement",td:"HTMLTableDataCellElement",textarea:"HTMLTextAreaElement",tfoot:"HTMLTableSectionElement",
th:"HTMLTableHeaderCellElement",thead:"HTMLTableSectionElement",time:"HTMLTimeElement",title:"HTMLTitleElement",tr:"HTMLTableRowElement",track:"HTMLTrackElement",tt:"HTMLElement",u:"HTMLElement",ul:"HTMLUListElement","var":"HTMLElement",video:"HTMLVideoElement",wbr:"HTMLElement"};$.ELEMENT_DOM_INTERFACES=$.Q;$.P={NOT_LOADED:0,SAME_DOCUMENT:1,NEW_DOCUMENT:2};$.ueffects=$.P;
$.J={"a::href":2,"area::href":2,"audio::src":1,"blockquote::cite":0,"command::icon":1,"del::cite":0,"form::action":2,"img::src":1,"input::src":1,"ins::cite":0,"q::cite":0,"video::poster":1,"video::src":1};$.URIEFFECTS=$.J;$.M={UNSANDBOXED:2,SANDBOXED:1,DATA:0};$.ltypes=$.M;$.I={"a::href":2,"area::href":2,"audio::src":2,"blockquote::cite":2,"command::icon":1,"del::cite":2,"form::action":2,"img::src":1,"input::src":1,"ins::cite":2,"q::cite":2,"video::poster":1,"video::src":2};$.LOADERTYPES=$.I;
"undefined"!==typeof window&&(window.html4=$);var ha=function(g){function w(a){if(k.hasOwnProperty(a))return k[a];var b=a.match(q);return b?String.fromCharCode(parseInt(b[1],10)):(b=a.match(B))?String.fromCharCode(parseInt(b[1],16)):r&&F.test(a)?(r.innerHTML="&"+a+";",b=r.textContent,k[a]=b):"&"+a+";"}function M(a,b){return w(b)}function x(a){return a.replace(j,M)}function E(a){return(""+a).replace(R,"&amp;").replace(P,"&lt;").replace(S,"&gt;").replace(D,"&#34;")}function e(a){return a.replace(ia,"&amp;$1").replace(P,"&lt;").replace(S,"&gt;")}
function v(b){var d={z:b.z||b.cdata,A:b.A||b.comment,B:b.B||b.endDoc,t:b.t||b.endTag,e:b.e||b.pcdata,F:b.F||b.rcdata,H:b.H||b.startDoc,w:b.w||b.startTag};return function(b,g){var f;var H=/(<\/|<\!--|<[!?]|[&<>])/g;f=b+"";if(G)f=f.split(H);else{for(var e=[],h=0,j;(j=H.exec(f))!==s;)e.push(f.substring(h,j.index)),e.push(j[0]),h=j.index+j[0].length;e.push(f.substring(h));f=e}a(d,f,0,{r:C,C:C},g)}}function f(b,d,g,f,t){return function(){a(b,d,g,f,t)}}function a(a,d,p,e,t){try{a.H&&0==p&&a.H(t);for(var h,
z,j,k=d.length;p<k;){var o=d[p++],l=d[p];switch(o){case "&":I.test(l)?(a.e&&a.e("&"+l,t,A,f(a,d,p,e,t)),p++):a.e&&a.e("&amp;",t,A,f(a,d,p,e,t));break;case "</":if(h=/^([-\w:]+)[^\'\"]*/.exec(l))if(h[0].length===l.length&&">"===d[p+1])p+=2,j=h[1].toLowerCase(),a.t&&a.t(j,t,A,f(a,d,p,e,t));else{var m=d,q=p,r=a,u=t,v=A,y=e,w=b(m,q);w?(r.t&&r.t(w.name,u,v,f(r,m,q,y,u)),p=w.next):p=m.length}else a.e&&a.e("&lt;/",t,A,f(a,d,p,e,t));break;case "<":if(h=/^([-\w:]+)\s*\/?/.exec(l))if(h[0].length===l.length&&
">"===d[p+1]){p+=2;j=h[1].toLowerCase();a.w&&a.w(j,[],t,A,f(a,d,p,e,t));var B=g.f[j];B&K&&(p=i(d,{name:j,next:p,c:B},a,t,A,e))}else{var m=d,q=a,r=t,u=A,v=e,x=b(m,p);x?(q.w&&q.w(x.name,x.R,r,u,f(q,m,x.next,v,r)),p=x.c&K?i(m,x,q,r,u,v):x.next):p=m.length}else a.e&&a.e("&lt;",t,A,f(a,d,p,e,t));break;case "<\!--":if(!e.C){for(z=p+1;z<k&&!(">"===d[z]&&/--$/.test(d[z-1]));z++);if(z<k){if(a.A){var D=d.slice(p,z).join("");a.A(D.substr(0,D.length-2),t,A,f(a,d,z+1,e,t))}p=z+1}else e.C=n}e.C&&a.e&&a.e("&lt;!--",
t,A,f(a,d,p,e,t));break;case "<!":if(/^\w/.test(l)){if(!e.r){for(z=p+1;z<k&&">"!==d[z];z++);z<k?p=z+1:e.r=n}e.r&&a.e&&a.e("&lt;!",t,A,f(a,d,p,e,t))}else a.e&&a.e("&lt;!",t,A,f(a,d,p,e,t));break;case "<?":if(!e.r){for(z=p+1;z<k&&">"!==d[z];z++);z<k?p=z+1:e.r=n}e.r&&a.e&&a.e("&lt;?",t,A,f(a,d,p,e,t));break;case ">":a.e&&a.e("&gt;",t,A,f(a,d,p,e,t));break;case "":break;default:a.e&&a.e(o,t,A,f(a,d,p,e,t))}}a.B&&a.B(t)}catch(E){if(E!==A)throw E;}}function i(a,b,d,h,t,j){var z=a.length;T.hasOwnProperty(b.name)||
(T[b.name]=RegExp("^"+b.name+"(?:[\\s\\/]|$)","i"));for(var i=T[b.name],k=b.next,l=b.next+1;l<z&&!("</"===a[l-1]&&i.test(a[l]));l++);l<z&&(l-=1);z=a.slice(k,l).join("");if(b.c&g.c.CDATA)d.z&&d.z(z,h,t,f(d,a,l,j,h));else if(b.c&g.c.RCDATA)d.F&&d.F(e(z),h,t,f(d,a,l,j,h));else throw Error("bug");return l}function b(a,b){var d=/^([-\w:]+)/.exec(a[b]),f={};f.name=d[1].toLowerCase();f.c=g.f[f.name];for(var e=a[b].substr(d[0].length),h=b+1,j=a.length;h<j&&">"!==a[h];h++)e+=a[h];if(!(j<=h)){for(var i=[];""!==
e;)if(d=ja.exec(e))if(d[4]&&!d[5]||d[6]&&!d[7]){for(var d=d[4]||d[6],l=C,e=[e,a[h++]];h<j;h++){if(l){if(">"===a[h])break}else 0<=a[h].indexOf(d)&&(l=n);e.push(a[h])}if(j<=h)break;e=e.join("")}else{var l=d[1].toLowerCase(),k;if(d[2]){k=d[3];var m=k.charCodeAt(0);if(34===m||39===m)k=k.substr(1,k.length-2);k=x(k.replace(o,""))}else k="";i.push(l,k);e=e.substr(d[0].length)}else e=e.replace(/^[\s\S][^a-z\s]*/,"");f.R=i;f.next=h+1;return f}}function h(a){function b(a,d){f||d.push(a)}var d,f;return v({startDoc:function(){d=
[];f=C},startTag:function(b,e,h){if(!f&&g.f.hasOwnProperty(b)){var j=g.f[b];if(!(j&g.c.FOLDABLE)){var k=a(b,e);if(k){if("object"!==typeof k)throw Error("tagPolicy did not return object (old API?)");if("attribs"in k)e=k.attribs;else throw Error("tagPolicy gave no attribs");var i;"tagName"in k?(i=k.tagName,k=g.f[i]):(i=b,k=j);if(j&g.c.OPTIONAL_ENDTAG){var l=d[d.length-1];l&&l.D===b&&(l.v!==i||b!==i)&&h.push("</",l.v,">")}j&g.c.EMPTY||d.push({D:b,v:i});h.push("<",i);b=0;for(l=e.length;b<l;b+=2){var m=
e[b],o=e[b+1];o!==s&&o!==c&&h.push(" ",m,'="',E(o),'"')}h.push(">");j&g.c.EMPTY&&!(k&g.c.EMPTY)&&h.push("</",i,">")}else f=!(j&g.c.EMPTY)}}},endTag:function(a,b){if(f)f=C;else if(g.f.hasOwnProperty(a)){var e=g.f[a];if(!(e&(g.c.EMPTY|g.c.FOLDABLE))){if(e&g.c.OPTIONAL_ENDTAG)for(e=d.length;0<=--e;){var h=d[e].D;if(h===a)break;if(!(g.f[h]&g.c.OPTIONAL_ENDTAG))return}else for(e=d.length;0<=--e&&d[e].D!==a;);if(!(0>e)){for(h=d.length;--h>e;){var j=d[h].v;g.f[j]&g.c.OPTIONAL_ENDTAG||b.push("</",j,">")}e<
d.length&&(a=d[e].v);d.length=e;b.push("</",a,">")}}}},pcdata:b,rcdata:b,cdata:b,endDoc:function(a){for(;d.length;d.length--)a.push("</",d[d.length-1].v,">")}})}function d(a,b,d,e,f){if(!f)return s;try{var g=Y.parse(""+a);if(g&&(!g.K()||ka.test(g.W()))){var h=f(g,b,d,e);return h?h.toString():s}}catch(j){}return s}function y(a,b,d,f,e){d||a(b+" removed",{S:"removed",tagName:b});if(f!==e){var g="changed";f&&!e?g="removed":!f&&e&&(g="added");a(b+"."+d+" "+g,{S:g,tagName:b,la:d,oldValue:f,newValue:e})}}
function l(a,b,d){b=b+"::"+d;if(a.hasOwnProperty(b))return a[b];b="*::"+d;if(a.hasOwnProperty(b))return a[b]}function V(a,b,f,e,h){for(var j=0;j<b.length;j+=2){var k=b[j],i=b[j+1],m=i,o=s,q;if((q=a+"::"+k,g.m.hasOwnProperty(q))||(q="*::"+k,g.m.hasOwnProperty(q)))o=g.m[q];if(o!==s)switch(o){case g.d.NONE:break;case g.d.SCRIPT:i=s;h&&y(h,a,k,m,i);break;case g.d.STYLE:if("undefined"===typeof N){i=s;h&&y(h,a,k,m,i);break}var r=[];N(i,{declaration:function(a,b){var e=a.toLowerCase();u(e,b,f?function(a){return d(a,
g.P.ja,g.M.ka,{TYPE:"CSS",CSS_PROP:e},f)}:s);b.length&&r.push(e+": "+b.join(" "))}});i=0<r.length?r.join(" ; "):s;h&&y(h,a,k,m,i);break;case g.d.ID:case g.d.IDREF:case g.d.IDREFS:case g.d.GLOBAL_NAME:case g.d.LOCAL_NAME:case g.d.CLASSES:i=e?e(i):i;h&&y(h,a,k,m,i);break;case g.d.URI:i=d(i,l(g.J,a,k),l(g.I,a,k),{TYPE:"MARKUP",XML_ATTR:k,XML_TAG:a},f);h&&y(h,a,k,m,i);break;case g.d.URI_FRAGMENT:i&&"#"===i.charAt(0)?(i=i.substring(1),i=e?e(i):i,i!==s&&i!==c&&(i="#"+i)):i=s;h&&y(h,a,k,m,i);break;default:i=
s,h&&y(h,a,k,m,i)}else i=s,h&&y(h,a,k,m,i);b[j+1]=i}return b}function ea(a,b,d){return function(e,f){if(g.f[e]&g.c.UNSAFE)d&&y(d,e,c,c,c);else return{attribs:V(e,f,a,b,d)}}}function Q(a,b){var d=[];h(b)(a,d);return d.join("")}var N,u;"undefined"!==typeof window&&(N=window.parseCssDeclarations,u=window.sanitizeCssProperty);var k={lt:"<",LT:"<",gt:">",GT:">",amp:"&",AMP:"&",quot:'"',apos:"'",nbsp:"\u00a0"},q=/^#(\d+)$/,B=/^#x([0-9A-Fa-f]+)$/,F=/^[A-Za-z][A-za-z0-9]+$/,r="undefined"!==typeof window&&
window.document?window.document.createElement("textarea"):s,o=/\0/g,j=/&(#[0-9]+|#[xX][0-9A-Fa-f]+|\w+);/g,I=/^(#[0-9]+|#[xX][0-9A-Fa-f]+|\w+);/,R=/&/g,ia=/&([^a-z#]|#(?:[^0-9x]|x(?:[^0-9a-f]|$)|$)|$)/gi,P=/[<]/g,S=/>/g,D=/\"/g,ja=/^\s*([-.:\w]+)(?:\s*(=)\s*((")[^"]*("|$)|(')[^']*('|$)|(?=[a-z][-\w]*\s*=)|[^"'\s]*))?/i,G=3==="a,b".split(/(,)/).length,K=g.c.CDATA|g.c.RCDATA,A={},T={},ka=/^(?:https?|geo|mailto|sms|tel)$/i,m={};m.pa=m.escapeAttrib=E;m.ra=m.makeHtmlSanitizer=h;m.sa=m.makeSaxParser=v;
m.ta=m.makeTagPolicy=ea;m.wa=m.normalizeRCData=e;m.xa=m.sanitize=function(a,b,d,e){return Q(a,ea(b,d,e))};m.ya=m.sanitizeAttribs=V;m.za=m.sanitizeWithPolicy=Q;m.Ba=m.unescapeEntities=x;return m}($),la=ha.sanitize;"undefined"!==typeof window&&(window.html=ha,window.html_sanitize=la);})();
;
/*!
 ~/RunTime/Script/Init.js
*/
var _runtimeScriptsLoaded=!0,runtimeParametersDefinition=null,_runtimeParameters=null,viewControllerDefinition=null,formBindingXml=null,runtimeNavigatedEvents=null,currentForm=null,collectionTables=[],emptyXmlDoc=null,xslFormatter=null,persistedActions=null,currentCulture=null,viewTableDefinitions=[],runtimePendingCallsBeforeInit=[],runtimePendingCallsAfterInit=[],runtimePaddingCacheValue,initPaddingUpdated=!1,runtimeFilterFields=[],_runtimePersistedHandlers=null,_runtimeInitSpinner=!1,_runtimeSpinnersCount=0,_runtimeLoadingFromDraft=!1,SourceCode=SourceCode?SourceCode:{};SourceCode.Forms=SourceCode.Forms?SourceCode.Forms:{};SourceCode.Forms.Runtime=SourceCode.Forms.Runtime?SourceCode.Forms.Runtime:{};function runtimeInitialize(){var r=getQueryStringParameterValue("_mode");if(checkExistsNotEmpty(r)&&(_runtimeMode=r),typeof _runtimeMode!="undefined"&&_runtimeMode==="offline"){_runtimeDraftInfo={};var t=getQueryStringParameterValue("_draftId");checkExistsNotEmpty(t)&&t.isValidGuid()&&(_runtimeDraftInfo.id=t)}typeof _runtimeDraftInfo!="undefined"&&_runtimeDraftInfo!==null&&typeof _runtimeDraftInfo.id!="undefined"&&_runtimeDraftInfo.id!==null&&_runtimeDraftInfo.id!==""&&(_runtimeLoadingFromDraft=!0);var u=SourceCode.Forms.Runtime.getRuntimeInstanceName();SourceCode.Forms.Runtime.setRuntimeDataProperty(u,"windowContextValid",!0);SourceCode.Forms.Runtime.setRuntimeDataProperty(u,"windowContext",window.self);var f=!1,n=document.getElementById("ErrorMessage");if(checkExists(n)){if(checkExists(n.value)&&n.value.length>0){f=!0;$("#__initialModalizer").remove();var q=n.value;SourceCode.Forms.ExceptionHandler.isAuthenticationException(q)?SourceCode.Forms.ExceptionHandler.handleAuthenticationException(q,null,function(){closeAuthLoginPopup()}):SourceCode.Forms.ExceptionHandler.handleException(q)}n.value=""}if(!f){SFRuntimeBrowserDetection();var e=jQuery("#FormId");if(e.length>0){currentForm=e[0].value.toLowerCase();PFEnd("PF","Load","");PFStart("K2 SmartForms - Runtime Web Client","Runtime Client Initialize",currentForm);ajaxCall=new AjaxCall;initializeParameters();SFLog({type:1,source:"Document ready",category:"Init",message:"Runtime Parameters Definition",data:runtimeParametersDefinition,humanateData:!1});viewControllerDefinition=$xml(__runtimeControllersDefinition);SFLog({type:1,source:"Document ready",category:"Init",message:"View Controller Definition",data:viewControllerDefinition,humanateData:!1});formBindingXml=$xml(__runtimeEventsDefinition);SFLog({type:1,source:"Document ready",category:"Init",message:"Events Definition",data:formBindingXml,humanateData:!1});initializeNavigatedEvents();SFLog({type:1,source:"Document ready",category:"Init",message:"NavigatedEvents Definitions",data:runtimeNavigatedEvents,humanateData:!1});var o=verifyEventHandling(currentForm,_runtimeCallerType,"Submit");o===!0&&SourceCode.Forms.Runtime.MobileBridge.sendToMobileDevice({methodName:"formHandlesSubmit"});currentCulture=$("#CurrentCulture").val();SCCultureHelper.createCurrent(_runtimeCulturesValue,currentCulture,_runtimeTimeZones);__runtimeIsAnonymous||loadPersistedViewParametersForUser();typeof Sys!="undefined"?Sys.Application._initialized?$(document).ready(initializeRuntimeForm):Sys.Application.add_load(function(){$(document).ready(initializeRuntimeForm)}):$(document).ready(initializeRuntimeForm);initPaddingUpdated||refreshFormPadding({});$("#form1").on("submit",function(){return!1});jQuery(document).on("keypress keyup keydown",function(n){if(!jQuery(n.target).is("input, textarea, select, *[contentEditable=true]")&&n.keyCode===8)return!1});jQuery(document).on("keydown",".popup, .popup input, .popup a, .popup div",function(n){n.keyCode===27&&popupManager.isAnyPopupShown()&&(n.stopPropagation(),popupManager.closeLast())});jQuery(".panel").panel();$(document).on("panelcollapse",".panel",function(){expandCollapseEvent(this.getAttribute("ID"),"Collapse");$(this).closest("#WorkflowStrip").length>0&&($(this).closest("#WorkflowStrip").height($(this).height()),$(this).closest("#WorkflowStrip").next(".theme-entry").length>0?$(this).closest("#WorkflowStrip").next(".theme-entry").css("top",$(this).height()+parseInt($(this).closest("#WorkflowStrip").attr("formborder"),10)+"px"):$(this).closest("#WorkflowStrip").prev(".theme-entry").css("bottom",$(this).height()+parseInt($(this).closest("#WorkflowStrip").attr("formborder"),10)+"px"))});$(document).on("panelexpand",".panel",function(){expandCollapseEvent(this.getAttribute("ID"),"Expand");$(this).closest("#WorkflowStrip").length>0&&($(this).closest("#WorkflowStrip").height(parseInt($(this).closest("#WorkflowStrip").attr("panelheight"),10)),$(this).closest("#WorkflowStrip").next(".theme-entry").length>0?$(this).closest("#WorkflowStrip").next(".theme-entry").css("top",$(this).height()+parseInt($(this).closest("#WorkflowStrip").attr("formborder"),10)+"px"):$(this).closest("#WorkflowStrip").prev(".theme-entry").css("bottom",$(this).height()+parseInt($(this).closest("#WorkflowStrip").attr("formborder"),10)+"px"))});jQuery("*[id$=_9afc3bff-abee-4066-93d6-c217cdf765f5]").addClass("workflow-view")}try{$("#__designerStatus",window.parent.document).length>0&&$("#__designerStatus",window.parent.document).text($("#__designerStatus",window.parent.document).text().replace("initializing","initialized"))}catch(s){}}}function initializeNavigatedEvents(){if(checkExistsNotEmpty(__runtimeNavigatedEvents))try{runtimeNavigatedEvents=$xml("<Events>"+__runtimeNavigatedEvents.htmlDecode()+"<\/Events>")}catch(n){SFLog({type:5,source:"initializeNavigatedEvents",category:"Init",message:"NavigatedEvents not in proper format",data:__runtimeNavigatedEvents,humanateData:!1});runtimeNavigatedEvents=null}}function expandCollapseEvent(n,t){if(checkExists(n)&&n.length>0&&checkExists(t)&&t.length>0){var q=new getMainTableViewInformation(n);if(checkExists(q)){var r=q.viewID,u=q.instanceID;handleEvent(r,"View",t,null,u)}}}function addRuntimePendingCalls(n,t){typeof t=="undefined"&&(t=!1);t&&_runtimeIsInitializing?(checkExists(runtimePendingCallsAfterInit)||(runtimePendingCallsAfterInit=[]),runtimePendingCallsAfterInit.push(n)):!t&&_runtimeIsRendering?(checkExists(runtimePendingCallsBeforeInit)||(runtimePendingCallsBeforeInit=[]),runtimePendingCallsBeforeInit.push(n)):n()}function refreshFormPadding(n){initPaddingUpdated||(initPaddingUpdated=!0);checkExists(n)||(n={});var y=checkExists(n.ignoreTabStyles)?n.ignoreTabStyles:!1,t=null;if(checkExists(n.panelID))t=jQuery("#{0}_{1}_internal".format(currentForm,n.panelID)),t.length===0&&(t=jQuery("#{0}_{1}_internal".format(_runtimeEmptyGuid,n.panelID)));else if(checkExists(n.controlID)){var r=jQuery("#{0}".format(n.controlID));if(r.length===0){var p=$find(n.controlID);checkExists(p)&&(r=jQuery($find(n.controlID).get_element()))}t=r.closest(".form")}checkExists(t)&&t.length!==0||(t=jQuery("body>form>div.runtime-content>div.runtime-form.theme-entry>div.form"));t.length===0&&(t=jQuery("body>form>div.runtime-content>div.runtime-form.theme-entry>div.tab-box>div.tab-box-body>div.tab-box-body-m>div.tab-box-body-m-c>div.tab-box-body-wrapper>div.scroll-wrapper>div.formpanel>div.form"));var q="";q=checkExists(n.newPadding)?n.newPadding:checkExists(runtimePaddingCacheValue)?runtimePaddingCacheValue:$(t[0]).css("padding-top");runtimePaddingCacheValue=q;var u=checkExists(q)&&q!==""?parseInt(q,10)/2+"px":"",w=checkExists(q)&&q!==""?parseInt(q,10)+"px":"",e=t.length,o=document.documentElement.getAttribute("dir")==="rtl"?["marginRight","marginLeft"]:["marginLeft","marginRight"],f=["marginTop","marginBottom"];function s(n,t,q,r,e){for(var d=n.length,g=[],ut=!0;d--;){var ft=$(n[d]);ft[0].style.display="";for(var et=ft.children(),ot=et.length,o=[];ot--;){for(var y=$(et[ot]),c=y[0],st=$(y.children()[0]),nt=st[0],p=st.children(),b=p.length,ht=!1;b--;)if(!$(p[b]).hasClass("hidden")&&p[b].style.display!=="none"&&p[b].style.visibility!=="collapse"&&p[b].style.visibility!=="hidden"){ht=!0;break}if(ht===!0){o.push({currentAreaItem:c,innerPanel:nt});c.style.display="";c.style[q[1]]=ut?"0px":u;c.style[q[0]]=u;var rt=u;t[0]===f[0]&&y.is(".formcontrol")&&(rt=w);nt.style[t[0]]=rt;nt.style[t[1]]=rt}else c.style.display="none",c.style.margin="",nt.style.margin=""}if(o.length>0){ut=!1;g.push(d);var l=o.length,tt=l;if(checkExists(e)&&e===!0){for(var a=0,qt=0,h=100;l--;){var ct=o[l].currentAreaItem;if(ct.className.indexOf("view")!==-1){var s=ct.getAttribute("data-width");checkExists(s)&&(s.indexOf("px")!==-1?(a+=parseInt(s.replace("px","")),qt++):s.indexOf("%")!==-1&&s!=="100%"&&(h-=parseInt(s.replace("%","")),qt++))}}for(a>0&&(a=a/(tt-qt)),h<1&&(h=100),h=h/(tt-qt),l=tt;l--;){var yt=o[l],y=yt.currentAreaItem,s=y.getAttribute("data-width");checkExists(s)&&s!=="100%"||(y.style.width=a>0?"calc({0}% - {1}px)".format(h,a):"{0}%".format(h))}}o[tt-1].innerPanel.style[t[0]]="0px";o[0].innerPanel.style[t[1]]="0px";o=[]}else n[d].style.display="none"}var v=g.length;if(v>0){for(var lt=$(n[g[v-1]]).children(),at=lt.length;at--;)lt[at].style[q[0]]="0px";if(checkExists(r)&&r===!0)for(var vt=v;vt--;){var k=$(n[g[vt]]);k[0].style.width=n.length!==v?100/v+"%":k.hasClass("col")&&checkExists(k.data("width"))&&k.data("width")!=="100%"?k.data("width"):100/v+"%"}}}while(e--){var h=$(t[e]),c=h.children(".row"),b=c.length,l=h.children(".col"),k=l.length;b>0?s(c,o,f,!1,!0):k>0&&s(l,f,o,!0,!1)}if(!checkExists(y)){var a=jQuery("body>form>div.runtime-content>div.runtime-form.theme-entry>div.tab-box>div.tab-box-body");if(a.length>0){var v=a[0].style.backgroundColor;v.length>0&&updateTabStyles(v)}}}function populateListFilterEvents(n,t){var g="Controllers/Controller[@TypeView='List']";checkExists(n)&&(g+="[@MainTable='"+n+"']");var y=$mn(viewControllerDefinition,g);if(y.length>0){checkExists(n)&&SFLog({type:1,source:"populateListFilterEvents",category:"Init",message:"List view events {0} with disabled set to {1}",parameters:[n,u]});for(var p=0;p<y.length;p++){var r=y[p],u=t;checkExists(u)||(u=r.getAttribute("IsEnabled")==="false"?!0:!1);var e=r.getAttribute("ID"),f=r.getAttribute("InstanceID"),o=checkExists(f)?f+"_"+e:_runtimeEmptyGuid+"_"+e;n=r.getAttribute("MainTable");var w=jQuery("#"+o+"_quickSearchBtn");if(w.length>0)if(u)u&&w.off("click");else w.on("click",null,f,quickSearchFilterClicked);var b=jQuery("#"+o+"_quickSearchTxt");if(b.length>0)if(u)b.off("keydown");else b.on("keydown",null,f,testForQuickSearchEnter);populateQuickSearchDropdown(e,f,o,u);var k=runtimeFilterFields[e];if(!checkExists(k)){var ut={viewID:e,instanceID:f,testVisible:!1,sorted:!0};k=returnFieldsForFiltering(ut);runtimeFilterFields[e]=k}var h=jQuery("#"+o+"_configFilter");if(h.length>0)if(u||__runtimeIsAnonymous)h.off("click"),h.addClass("disabled");else h.on("click",filterConfigClick);var s=jQuery("#"+o+"_selectedFilterDdl");if(s.length>0)if(u)s.off("change"),s.dropdown("disable");else{__runtimeIsAnonymous||populateFilters(o);s.on("change",null,f,quickSearchFilterClicked);s.dropdown("enable")}var nt=getViewProperty(r,"PageSize"),tt=!1;checkExists(nt)&&(document.getElementById(n).setAttribute("PageSize",nt),tt=!0);var c=getViewProperty(r,"ListEditable");checkExists(c)?(c=!0,checkExists(t)||adaptDependencyFields(e,f)):c=!1;var l=getViewProperty(r,"AlternateRows");l=checkExists(l)&&l.toLowerCase()==="true"?!0:!1;var d=getViewProperty(r,"ShowAddRow");d=checkExists(d)?!0:!1;var a=getViewProperty(r,"MultiSelectAllowed");a=checkExists(a)&&a.toUpperCase()==="TRUE"?!0:!1;var v=getViewProperty(r,"CellContentSelectAllowed");v=checkExists(v)&&v.toUpperCase()==="TRUE"?!0:!1;var q=jQuery("#"+n);q.grid({rowclick:listRowClick,rowdblclick:listRowDblClick,paging:tt,custompaging:doPaging,zebraStripes:l,disableInternalWidthSync:!0,multiselect:a,cellcontentselect:v});q.on("gridcollapse",function(){expandCollapseEvent(this.getAttribute("ID"),"Collapse")});q.on("gridexpand",function(){expandCollapseEvent(this.getAttribute("ID"),"Expand")});if(c){d&&(SFRGrid.execute({element:q,fn:"option",params:["actionrowclick",addListItemRow]}),SFRGrid.execute({element:q,fn:"option",params:["actionrow",!0]}));var qt=SFRGrid.execute({element:q,fn:"fetch",params:["edit-template-row"]});if(checkExists(qt))qt.on("keydown",null,n,testCancelList);SFRGrid.execute({element:q,fn:"option",params:["commitrowwithkey",commitListItemRow]})}if(q.attr("isdisabled",u),SFRGrid.execute({element:q,fn:"option",params:["canexpand",!1]}),SFRGrid.execute({element:q,fn:"runtimeSyncColumns"}),!_runtimeLoadingFromDraft)if(checkExists(t))viewTableDefinitions[n]=constructTableDefinition(r.getAttribute("ID"),q,q[0].getAttribute("QFValue"),q[0].getAttribute("QFName"),f),refreshTableData(n,q[0].getAttribute("PageNumber"));else{var rt=viewTableDefinitions[n];checkExists(rt)&&rt.length!==0||setTimeout(function(){viewTableDefinitions[n]=constructTableDefinition(r.getAttribute("ID"),q,q[0].getAttribute("QFValue"),q[0].getAttribute("QFName"),f)},0)}}}}function setFilterConfigIncludeFiles(n){if(runtimeFilterScripts.length>0){var t=SourceCode.Forms.Settings.Bundling.UseBundledFiles;$.addScript(runtimeFilterScripts.shift(),function(){setFilterConfigIncludeFiles(n)},t)}else setFilterConfigValue(n)}function filterConfigClick(n){var t=window.event?window.event:n,q=null;q=t.currentTarget?t.currentTarget:t.srcElement;setFilterConfigIncludeFiles(q.id)}function populateQuickSearchDropdown(n,t,q,r){var u=jQuery("#"+q+"_quickSearchDdl");if(u.length>0){var o=u[0].value;u.empty();u[0].options.add(new Option(Resources.Runtime.AllFields,"[All]"));var f=runtimeFilterFields[q];if(!checkExists(f)){var h={viewID:n,instanceID:t,testVisible:!0,sorted:!0};f=returnFieldsForFiltering(h);runtimeFilterFields[q]=f}for(var s=f.length;s--;){var e=f[s];checkExistsNotEmpty(e.getAttribute("PropertyType"))&&e.getAttribute("PropertyType").toLowerCase()!="datetime"&&e.getAttribute("DisplayName")!==""&&u[0].options.add(new Option(e.getAttribute("DisplayName"),e.getAttribute("ID")))}u.dropdown("refresh");checkExists(o)&&o.length>0&&u.dropdown("select",o);r===!1?u.dropdown("enable"):r===!0&&u.dropdown("disable")}}function refreshTableData(n,t){var q=new getMainTableViewInformation(n),r=q.viewID,u=q.instanceID,f=getCombinedHiddenPropertyCollection(r,null,null,t,!1,!0,null,null,null,u);removeSortingIndicators(n);rebuildTable(n,r,u,!1,!1,null,f,!0,t,!1)}function testForQuickSearchEnter(n){if(n.keyCode===13)return quickSearchFilterClicked(n),n.preventDefault(),n.stopPropagation(),!1}function handleInitializeEvents(){if(SFLog({type:2,source:"handleInitializeEvents",category:"Init",message:"Initialize actions"}),checkExistsNotEmpty(__runtimeNavigatedActions)){var r=SourceCode.Forms.Runtime.getMasterRuntimeWindow(),n=null;try{n=r.$xml("<Actions>"+__runtimeNavigatedActions.htmlDecode()+"<\/Actions>")}catch(c){SFLog({type:5,source:"handleInitializeEvents",category:"Init",message:"NavigatedAction not in proper format",data:__runtimeNavigatedActions,humanateData:!1})}if(checkExists(n)){var u=$sn(n,"Actions/Action[@Type='Execute'][@Method='Init']"),q=$mn(n,"Actions/Action");if(q.length>0){persistedActions=[];for(var t=0;t<q.length;t++)SFLog({type:1,source:"handleInitializeEvents",category:"Init",message:"Added initialize Action {0}",parameters:[t],data:q[t].cloneNode(!0)}),persistedActions.push(q[t].cloneNode(!0))}var f=$mn(n,"Actions/Handlers");if(f.length>0&&(_runtimePersistedHandlers=[],_runtimePersistedHandlers=constructHandlersForBehaviour(n.firstChild,_runtimePersistedHandlers,null,"Navigate")),checkExists(u)){if(checkExists(persistedActions)&&persistedActions.length>0||checkExists(_runtimePersistedHandlers)&&_runtimePersistedHandlers.length>0){var e=persistedActions;persistedActions=null;var o=_runtimePersistedHandlers;_runtimePersistedHandlers=null;var s=SourceCode.Forms.Runtime.getMasterRuntimeWindow(),h=new s.SourceCode.Forms.Runtime.BehaviourEvent({actions:e,isInit:!0,methodExecuted:"Init",handlers:o,windowToUse:window.self});h.executeBehaviour()}}else SFLog({type:1,source:"handleInitializeEvents",category:"Init",message:"Handle {0} initialize (Persisted) ",parameters:[_runtimeCallerType],data:currentForm,humanateData:!1}),handleEvent(currentForm,_runtimeCallerType,"Init",null,null,!0)}}else SFLog({type:1,source:"handleInitializeEvents",category:"Init",message:"Handle {0} initialize (Normal) ",parameters:[_runtimeCallerType],data:currentForm}),handleEvent(currentForm,_runtimeCallerType,"Init",null,null,!0)}function initializeRuntimeForm(){if($("#__initialModalizer").remove(),SourceCode.Forms.Runtime.determineMasterPopupManager(),populateListFilterEvents(),_runtimeIsRendering=!1,checkExists(runtimePendingCallsBeforeInit)){for(var n=0;n<runtimePendingCallsBeforeInit.length;n++)runtimePendingCallsBeforeInit[n]();runtimePendingCallsBeforeInit=[]}_runtimeSetPopupFirstFocus();evaluateSSREResults();handleInitializeEvents();_runtimeLoadingFromDraft&&SourceCode.Forms.Runtime.loadFromDraft()}function evaluateSSREResults(){if(typeof __runtimeSSREFC!="undefined"&&checkExistsNotEmpty(__runtimeSSREFC)){var e=JSON.parse(__runtimeSSREFC.htmlDecode()).FC;__runtimeSSREFC=null;for(var y=e.length,n=0;n<y;n++)PopulateView(e[n])}if(typeof __runtimeSSREF!="undefined"&&checkExistsNotEmpty(__runtimeSSREF)){var t=JSON.parse(__runtimeSSREF.htmlDecode()).V;if(__runtimeSSREF=null,t!=null)for(var o=Object.keys(t),q=0;q<o.length;q++)for(var s=o[q],h=t[s].F,c=Object.keys(h),n=0;n<c.length;n++){var l=c[n],p=h[l];setHiddenFieldValue(l,p,null,s,null,null,!1)}}if(typeof __runtimeSSREC!="undefined"&&checkExistsNotEmpty(__runtimeSSREC)){var r=JSON.parse(__runtimeSSREC.htmlDecode()).C;if(__runtimeSSREC=null,r!=null)for(var a=Object.keys(r),u=0;u<a.length;u++){var f=a[u],w=r[f],v=_runtimeControllerFindObject({controlID:f});if(checkExists(v)){var b=new PopulateObject(null,w,f);executeControlFunction(v,"SetValue",b)}}}if(typeof __runtimeSSREP!="undefined"&&checkExistsNotEmpty(__runtimeSSREP)){var k=JSON.parse(__runtimeSSREP.htmlDecode());__runtimeSSREP=null;applySSREProcessData(k)}}function applySSREProcessData(n){if(n!=null&&(previousActionXml=GetPreviousActionXml(n),checkExistsNotEmpty(previousActionXml))){var t=$xml(previousActionXml).documentElement;if(setWorkflowInformation(n),applyWorkflowViewInformation(t,n),n.ActionsControlID!=null){var q=getWorkflowActionCollection(n);populateListControlWithWorkflowProcessActions(n.ActionsControlID,q)}}}function loadPersistedViewParametersForUser(){if(!__runtimeIsAnonymous){var n="";typeof __persistedParametersDefinition!="undefined"&&(n=__persistedParametersDefinition);n.length>0&&setHiddenParameterCollection(n)}}function getWorkflowViewActionName(n){var q=jQuery("*[id$=_936c1d65-be60-8c5c-0de9-1db2018d94c0_DropDown]"),u="";if(q.length>0&&(u=q.dropdown("SelectedValue"),n)){var t={},r=q.next(".input-control");if(u.length===0){t.IsRequired=!0;t.Pattern=null;t.DataType=null;t.CurrentControlId=q.attr("id").replace("_DropDown","");t.Error=Resources.Runtime.RequiredValidationError;UtilitiesHelper.showValidationMessage(r,t);r.attr("title","Select an action to submit");return}t.IsRequired=null;t.Pattern=null;t.DataType=null;t.CurrentControlId=q.attr("id").replace("_DropDown","");t.Error="";UtilitiesHelper.showValidationMessage(r,t);r.attr("title","")}return u}function doWorkflowSubmit(n){var q=jQuery(n.target).closest("#WorkflowStrip").not(".drop-menu").data("WFInformation"),h=getWorkflowViewActionName(!0);if(checkExists(q)&&checkExists(h)&&h.length>0){var u=formBindingXml,r=null,y=!1,s=null;if(_runtimeCallerType==="Form"){if(checkExists(q.actionInstanceID)){var p=getViewDefinition(null,q.actionInstanceID);checkExists(p)&&(s=p.getAttribute("ID"))}checkExists(s)&&(y=verifyEventHandling(s,"View","WorkflowSubmit",q.actionInstanceID,!1))}var c=null;c=y?"Events/Event[@SourceID='"+s+"'][@InstanceID='"+q.actionInstanceID+"'][@SourceType='View'][Name/text()='WorkflowSubmit']":"Events/Event[@SourceID='"+currentForm+"'][@SourceType='"+_runtimeCallerType+"'][Name/text()='WorkflowSubmit']";r=$sn(u,c);!checkExists(r)&&checkExists(runtimeNavigatedEvents)&&(r=$sn(runtimeNavigatedEvents,c));var t;if(r){r=r.cloneNode(!0);for(var w=$mn(r,"Handlers/Handler"),l=0;l<w.length;l++){var b=w[l],a=!0,v=$mn(b,"Conditions/Condition");if(checkExists(v))for(var k=v.length;k--;)if(a=validateConditions(v[k]),a===!1)break;if(a===!0&&(t=$sn(b,"Actions/Action[@Type='ExecuteWorkflow'][@Method='ActionProcess']"),checkExists(t)))break}}else u=$xml("<Handlers><Handler><Actions><Action/><\/Actions><\/Handler><\/Handlers>"),t=$sn(u,"Handlers/Handler/Actions/Action"),t.setAttribute("Type","ExecuteWorkflow"),t.setAttribute("Method","ActionProcess"),t.setAttribute("ExecutionType","Synchronous"),t.setAttribute("ItemState","All");if(checkExists(t)){checkExists(q.WFAfterSubmitEventID)&&t.setAttribute("WFAfterSubmitEventID",q.WFAfterSubmitEventID);checkExists(q.WFMessage)&&t.setAttribute("WFMessage",q.WFMessage);checkExists(q.WFNavigateURL)&&t.setAttribute("WFNavigateURL",q.WFNavigateURL);var f=$sn(t,"Parameters");checkExists(f)||(f=u.createElement("Parameters"),t.appendChild(f));var e=$sn(f,"Parameter[@TargetID='ActionName'][@TargetType='WorkflowProcessProperty']");if(!checkExists(e)){e=u.createElement("Parameter");e.setAttribute("TargetID","ActionName");e.setAttribute("TargetType","WorkflowProcessProperty");f.appendChild(e);var d=u.createElement("SourceValue");d.appendChild(u.createTextNode(h));e.appendChild(d);e.setAttribute("SourceType","Value")}var o=$sn(f,"Parameter[@TargetID='SerialNumber'][@TargetType='WorkflowProcessProperty']");if(!checkExists(o)){o=u.createElement("Parameter");o.setAttribute("TargetID","SerialNumber");o.setAttribute("TargetType","WorkflowProcessProperty");f.appendChild(o);var g=u.createElement("SourceValue");g.appendChild(u.createTextNode(q.serialNumber));o.appendChild(g);o.setAttribute("SourceType","Value")}}if(r){var nt=constructHandlersForBehaviour(r,[],null,"User"),tt=SourceCode.Forms.Runtime.getMasterRuntimeWindow(),qt=new tt.SourceCode.Forms.Runtime.BehaviourEvent({handlers:nt,SourceID:currentForm,methodExecuted:"WorkflowSubmit",SourceType:_runtimeCallerType,SubformID:r.getAttribute("SubformID"),InstanceID:r.getAttribute("InstanceID"),TransferredID:r.getAttribute("TransferredID"),windowToUse:window.self});qt.executeBehaviour()}else checkExists(t)&&workflowAction(t)}};
/*!
 ~/RunTime/Script/Helper.js
*/
var viewXmlCache={},_runtimeControlTabIndexes=[],_runtimeListViewTabIndexes=[],_runtimeViewHeaderTabIndexes=[],_runtimeFilterTabIndexes=[],_runtimeFilterControlGroups=[],_runtimePopupControls=[],_runtimeActionRows=[],_runtimeActionRowTabIndexes=[],_runtimePopupWindows=[],_runtimeEmptyGuid="00000000-0000-0000-0000-000000000000",_runtimeAppleMobileRegex=/(Android|webOS|iPhone|iPad|iPod|BlackBerry|Mobile|IEMobile|Windows Phone|WebView)/i,_runtimeSafariRegex=/^((?!chrome|android|crios|fxios).)*safari/i,_runtimeLoopContextData={},_runtimeGridWidgets=[],_runtimeViewLoadingTimers={},_runtimeFieldsXmlHash={},_runtimeMainTableInfo={},_runtimeELJoinHash={},_runtimeControlInfoCache={},_runtimeExportToExcelData={},SourceCode=SourceCode?SourceCode:{};SourceCode.Forms=SourceCode.Forms?SourceCode.Forms:{};SourceCode.Forms.Runtime=SourceCode.Forms.Runtime?SourceCode.Forms.Runtime:{};SourceCode.Forms.Runtime.Grid=SourceCode.Forms.Runtime.Grid?SourceCode.Forms.Runtime.Grid:{};SourceCode.Forms.Runtime.Navigation=SourceCode.Forms.Runtime.Navigation?SourceCode.Forms.Runtime.Navigation:{};var SFR=SourceCode.Forms.Runtime,SFRGrid=SourceCode.Forms.Runtime.Grid;SourceCode.Forms.Runtime.getMasterRuntimeWindow=function(){if(checkExists(this._masterRuntimeWindow))return this._masterRuntimeWindow;var n=window,t=n.__runtimeFormLevel;try{while(checkExists(t)&&t>0&&checkExists(n.parent)&&n!==n.parent&&checkExists(n.parent.__runtimeFormLevel))n=n.parent,t=n.__runtimeFormLevel}catch(q){SFLog({type:5,source:"SourceCode.Forms.Runtime.getMasterRuntimeWindow",category:"Helper",message:"Get master runtime window error at level {0} on {1}".format(t,n.name),exception:q})}return this._masterRuntimeWindow=n,n};SourceCode.Forms.Runtime.determineMasterPopupManager=function(){try{var n=SourceCode.Forms.Runtime.getMasterRuntimeWindow();masterPopupManager=n.$.popupManager}catch(t){masterPopupManager=window.$.popupManager}};SourceCode.Forms.Runtime.getPopupIframeContentWindow=function(n){if(checkExists(n)&&n.length>0&&n.hasClass("navigated")===!1){var t=n[0].contentWindow;if(checkExists(t))return t}return null};SourceCode.Forms.Runtime.getRuntimeInstanceName=function(n){if(checkExists(n)){if(checkExists(n.__runtimeContextID)&&checkExists(n.__runtimeSubformID))return n.__runtimeContextID+"_"+n.__runtimeSubformID;var q=checkExists(n.controls)?n.controls.body:null;if(checkExists(q)){var r=q.find("iframe.runtime-popup"),t=SourceCode.Forms.Runtime.getPopupIframeContentWindow(r);if(t!==null)return t.__runtimeContextID+"_"+t.__runtimeSubformID}}else return __runtimeContextID+"_"+__runtimeSubformID;return""};SourceCode.Forms.Runtime.setRuntimeDataProperty=function(n,t,q){var r=SourceCode.Forms.Runtime.getMasterRuntimeWindow();checkExists(r.SourceCode.Forms.Runtime.RuntimeData)||(r.SourceCode.Forms.Runtime.RuntimeData={});r.SourceCode.Forms.Runtime.RuntimeData[n+"_"+t]=q};SourceCode.Forms.Runtime.getRuntimeDataProperty=function(n,t){var q=SourceCode.Forms.Runtime.getMasterRuntimeWindow();return checkExists(q.SourceCode.Forms.Runtime.RuntimeData)||(q.SourceCode.Forms.Runtime.RuntimeData={}),q.SourceCode.Forms.Runtime.RuntimeData[n+"_"+t]};SourceCode.Forms.Runtime.removeRuntimeDataProperty=function(n,t){var q=SourceCode.Forms.Runtime.getMasterRuntimeWindow();checkExists(q.SourceCode.Forms.Runtime.RuntimeData)&&delete q.SourceCode.Forms.Runtime.RuntimeData[n+"_"+t]};SourceCode.Forms.Runtime.getRuntimeDataKeys=function(n){var q=SourceCode.Forms.Runtime.getMasterRuntimeWindow();checkExists(q.SourceCode.Forms.Runtime.RuntimeData)||(q.SourceCode.Forms.Runtime.RuntimeData={});var r=[],u=q.SourceCode.Forms.Runtime.RuntimeData;for(var t in u)u.hasOwnProperty(t)&&(typeof n=="function"?n(t)===!0&&r.push(t):r.push(t));return r};SourceCode.Forms.Runtime.getAllPopupsWithRuntimeInstances=function(){var q=[];if(checkExists(masterPopupManager)&&checkExists(masterPopupManager.popUps)&&masterPopupManager.popUps.length>0)for(var t=0;t<masterPopupManager.popUps.length;t++){var n=masterPopupManager.popUps[t];if(checkExists(n.controls)&&checkExists(n.controls.body)){var r=n.controls.body.find("iframe.runtime-popup"),u=SourceCode.Forms.Runtime.getPopupIframeContentWindow(r);u!==null&&q.push(n)}}return q};SourceCode.Forms.Runtime.getTopNonClosingRuntimeInstancePopup=function(n){var q=null,f=SourceCode.Forms.Runtime.getAllPopupsWithRuntimeInstances(),e=f.length;if(e>0){var r=e-1,t=r;checkExists(n)&&(t=n-1,t>r&&(t=r));for(var u=t;!checkExists(q)&&u>-1;){var o=f[u];o.isClosing!==!0&&(q=o);u--}}return q};SourceCode.Forms.Runtime.Navigation.convertSubformNode=function(n,t,q,r){if(checkExists(t)&&(n.removeAttribute("SubformID"),n.setAttribute("TransferredID",t),n.nodeName!=="Function"||r)){var u=n.getAttribute("InstanceID");checkExists(u)&&n.setAttribute("OrigInstanceID",u);var f=n.getAttribute("SubformInstanceID");checkExists(f)?(n.removeAttribute("SubformInstanceID"),n.setAttribute("InstanceID",f)):n.removeAttribute("InstanceID")}checkExists(q)&&n.setAttribute("RuntimeContextID",q)};SourceCode.Forms.Runtime.Navigation.convertSourceSubformNode=function(n,t,q){if(checkExists(t)){n.removeAttribute("SourceSubFormID");n.setAttribute("SourceTransferredID",t);var r=n.getAttribute("SourceInstanceID");checkExists(r)&&n.setAttribute("SourceOrigInstanceID",r);var u=n.getAttribute("SourceSubFormInstanceID");checkExists(u)?(n.removeAttribute("SourceSubFormInstanceID"),n.setAttribute("SourceInstanceID",u)):n.removeAttribute("SourceInstanceID")}checkExists(q)&&n.setAttribute("SourceRuntimeContextID",q)};SourceCode.Forms.Runtime.Navigation.convertTargetSubformNode=function(n,t,q){if(checkExists(t)){n.removeAttribute("TargetSubFormID");n.setAttribute("TargetTransferredID",t);var r=n.getAttribute("TargetInstanceID");checkExists(r)&&n.setAttribute("TargetOrigInstanceID",r);var u=n.getAttribute("TargetSubFormInstanceID");checkExists(u)?(n.removeAttribute("TargetSubFormInstanceID"),n.setAttribute("TargetInstanceID",u)):n.removeAttribute("TargetInstanceID")}checkExists(q)&&n.setAttribute("TargetRuntimeContextID",q)};SourceCode.Forms.Runtime.Navigation.isBehaviorContextAction=function(n){var t=!1;if(checkExists(n)&&n.nodeName==="Action")switch(n.getAttribute("Type")){case"Navigate":case"Focus":case"Open":case"Popup":case"Prompt":case"ShowMessage":case"SendMail":case"Exit":case"Continue":t=!0;break;case"Close":checkExists(n.getAttribute("ViewID"))||checkExists(n.getAttribute("Method"))||(t=!0)}return t};SourceCode.Forms.Runtime.Grid.execute=function(n){if(typeof n=="undefined"||n===null)return null;var q=n.window||window,u=n.fn||null,f=n.params||[],t=null;if(typeof n.element!="undefined"&&n.element!==null)t=n.element;else if(typeof n.id!="undefined"&&n.id!==null){var e=q.document.getElementById(n.id);e!==null&&(t=q.jQuery(e))}if(t===null)return null;if(u!==null){var r=q._runtimeGridWidgets.indexOf(t[0].id)!==-1;if(r||(r=t.isWidget("grid"),r&&q._runtimeGridWidgets.push(t[0].id)),r)f.unshift(u);else return null}return t.grid.apply(t,f)};SourceCode.Forms.Runtime.getSerializedContextDraft=function(){var e=checkExists(document)?document.activeElement:null,q=checkExists(e)?jQuery(e):null;checkExists(q)&&q.trigger("blur");var t=SourceCode.Forms.Runtime.getMasterRuntimeWindow(),o="",n={},s=checkExists(t._runtimeDraftInfo)?t._runtimeDraftInfo:{},h=s.id,c=s.createdDate,l=getDateInCorrectFormat(new Date);n.id=checkExistsNotEmpty(h)?h:String.generateGuid();n.createdDate=checkExistsNotEmpty(c)?c:l;n.modifiedDate=l;n.contextType=t._runtimeCallerType;n.contextId=t.currentForm;n.contextName=checkExistsNotEmpty(t._runtimeArtifactName)?t._runtimeArtifactName.htmlDecode():"";n.contextDisplayName=checkExistsNotEmpty(t._runtimeArtifactDisplayName)?t._runtimeArtifactDisplayName.htmlDecode():"";n.contextCheckSum=t._runtimeArtifactVersion;n.contextModifiedDate=t._runtimeArtifactModifiedDateTime;n.data={views:[]};n.errors=[];var a=SFR._getSerializedGlobalVariablesData({windowToUse:t});if(a!==null&&(n.data.globals=a),checkExists(t.viewControllerDefinition)){for(var v=t.viewControllerDefinition.selectNodes("Controllers/Controller"),r=0;r<v.length;r++){var u=v[r],f=getNodeAttribute("TypeView",u,"").toUpperCase();if(f==="CAPTURE"||f==="LIST"){var y=SFR._getSerializedViewStateData({view:u,errors:n.errors});y!==null&&n.data.views.push(y)}else if(f===""){var p=SFR._getSerializedControlsStateData({controller:u,errors:n.errors});p!==null&&(n.data.controls=p)}}n.allControlsSupportDrafts=SFR._isAllControlsSupportDrafts({definition:t.viewControllerDefinition})}var w=SFR._getSerializedWorkflowStripData({windowToUse:t});return checkExists(w)&&(n.data.workflowStripData=w),n.data.views.length===0&&delete n.data.views,Object.keys(n.data).length===0&&delete n.data,n.errors.length===0&&delete n.errors,o=JSON.stringify(n),checkExists(q)&&q.trigger("focus"),o};SourceCode.Forms.Runtime._getSerializedGlobalVariablesData=function(n){var n=checkExists(n)?n:{},q=checkExists(n.windowToUse)?n.windowToUse:window,t={},u=SFR._getSerializedViewHiddenHash({windowToUse:q});u!==null&&(t.ViewHiddenHash=u);var f=SFR.Information.saveState();f!==null&&(t.Information=f);var e=SFR._getSerializedViewWriteStatus({windowToUse:q});e!==null&&(t.viewWriteStatus=e);_runtimeParameters!==null&&(t.Parameters=_runtimeParameters);for(var o=["_runtimeIsInitializing","_runtimeIdleState"],r=0;r<o.length;r++){var s=o[r],h=q[s];checkExists(h)&&(t[s]=h)}return Object.keys(t).length===0&&(t=null),t};SourceCode.Forms.Runtime._getSerializedViewHiddenHash=function(n){var n=checkExists(n)?n:{},u=checkExists(n.windowToUse)?n.windowToUse:window,t=u.getAllViewHiddenHashNames();if(!checkExists(t)||t.length===0)return null;for(var q={},r=0;r<t.length;r++){var f=t[r],e=u.ViewHiddenHash[f];q[f]=e}return Object.keys(q).length===0&&(q=null),q};SourceCode.Forms.Runtime._getSerializedViewWriteStatus=function(n){var n=checkExists(n)?n:{},u=checkExists(n.windowToUse)?n.windowToUse:window,t=u.getAllViewWriteStatusNames();if(!checkExists(t)||t.length===0)return null;for(var q={},r=0;r<t.length;r++){var f=t[r],e=u.viewWriteStatus[f];checkExists(e)&&(q[f]=e)}return Object.keys(q).length===0&&(q=null),q};SourceCode.Forms.Runtime._getSerializedXmlDocData=function(n){if(!checkExists(n)||!checkExists(n.xmlDoc))return null;var t=n.xmlDoc;return t.xml};SourceCode.Forms.Runtime._getSerializedWorkflowStripData=function(n){var t=null;if(!checkExists(n))return t;var q=checkExists(n.windowToUse)?n.windowToUse:window,r=q.jQuery("#WorkflowStrip").not(".drop-menu");if(r.length>0){t={};var u=r.data("WFInformation");checkExists(u)&&(t.data=u)}return checkExists(q.workflowInfo)&&(t.workflowInfo=q.workflowInfo),t};SourceCode.Forms.Runtime._getSerializedViewStateData=function(n){if(!checkExists(n)||!checkExists(n.view))return null;var t={},q=n.view;t.id=getNodeAttribute("ID",q,"");t.instanceId=getNodeAttribute("InstanceID",q,"");var f=getNodeAttribute("MainTable",q,""),r=$("#"+f);t.stateData=r.SFCAreaItem("saveState");t.stateData===r&&(t.stateData=null);var u=SFR._getSerializedControlsStateData({controller:q,errors:n.errors});return u!==null&&(t.controls=u),Object.keys(t).length===0&&(t=null),t};SourceCode.Forms.Runtime._getSerializedGridAttributes=function(n){if(!checkExists(n)||!checkExists(n.gridElement))return null;for(var t={},e=n.gridElement,r=["previousactionxml","actionxml","hasrowcount","pagenumber","hasmorepages","numberofpages","resetpagenumber","pagesize","orderbyresultname","orderby","orderdirection","paging","listrefreshed","maxcounter","isdisabled","qfname","qfvalue"],q=0;q<r.length;q++){var u=r[q],f=e[0].getAttribute(u);checkExists(f)&&(t[u]=f)}return Object.keys(t).length===0&&(t=null),t};SourceCode.Forms.Runtime._getSerializedControlsStateData=function(n){if(!checkExists(n)||!checkExists(n.controller))return null;for(var t=[],f=n.controller,r=f.selectNodes("Controls/Control[Properties/Property[(Name='SaveStateMethod') and (Value) and (Value!='')]]"),q=0;q<r.length;q++){var u=SFR._getSerializedControlStateData({control:r[q],errors:n.errors});checkExists(u)&&t.push(u)}return t.length===0&&(t=null),t};SourceCode.Forms.Runtime._getSerializedControlStateData=function(n){if(!checkExists(n)||!checkExists(n.control))return null;var q={},r=n.control,u=getNodeAttribute("ID",r,"");u!==""&&(q.id=u);var f=getNodeAttribute("Name",r,"");f!==""&&(q.name=f);var e=new PopulateObject(null,null,u),t=executeControlFunction(r,"SaveStateMethod",e);return checkExistsNotEmpty(t)&&(t instanceof SourceCode.Forms.Runtime.Drafts.DraftSaveException&&Array.isArray(n.errors)?n.errors.push(t):typeof t=="string"?q.stateData=JSON.parse(t):checkExists(t)&&(q.stateData=t)),(Object.keys(q).length===0||t instanceof SourceCode.Forms.Runtime.Drafts.DraftSaveException)&&(q=null),q};SourceCode.Forms.Runtime._isAllControlsSupportDrafts=function(n){if(!checkExists(n)&&!checkExists(n.definition))return null;for(var r=SourceCode.Forms.Runtime._getDraftsIgnoredControlTypes(),t=0,f="not(@Type='"+r[0]+"')",t=1;t<r.length;t++)f+=" and not(@Type='"+r[t]+"')";var q=n.definition.selectNodes("//Controls/Control["+f+"]");if(!checkExists(q)||q.length===0)return!0;var u=null,e=!0;for(t=0;t<q.length;t++)u=q[t].selectNodes("Properties/Property[(Name='SaveStateMethod') and (Value) and (Value!='')]"),checkExists(u)&&u.length!==0||(e=!1);return e};SourceCode.Forms.Runtime._getDraftsIgnoredControlTypes=function(){return["Table","ListTable","ToolbarTable","View","Panel","Area","AreaItem","Section","Column","Row","Cell","SourceCode-QA-SmartFormsTester-SmartFormsTester"]};SourceCode.Forms.Runtime.loadFromDraft=function(){if(checkExists(SourceCode.Forms.Runtime.MobileBridge)&&checkExists(SourceCode.Forms.Runtime.MobileBridge.sendToMobileDevice)){var n=SourceCode.Forms.Runtime.MobileBridge.sendToMobileDevice({methodName:"loadDraft",draftId:_runtimeDraftInfo.id});n.done(SFR.applyDraft)}else _runtimeLoadingFromDraft=!1};SourceCode.Forms.Runtime.applyDraft=function(n){var r=n.data;if(checkExistsNotEmpty(r)){var u=null;if(u=typeof r=="string"?JSON.parse(r):r,checkExists(u)){var t=SourceCode.Forms.Runtime.getMasterRuntimeWindow();t._runtimeDraftInfo.createdDate=u.createdDate;var q=u.data;checkExists(q)&&(SFR._applyGlobalsFromDraft({windowToUse:t,globals:q.globals}),SFR._applyViewsFromDraft({windowToUse:t,views:q.views}),SFR._applyControlsFromDraft({windowToUse:t,controls:q.controls}),SFR._applyWorkflowStripFromDraft({windowToUse:t,workflowStripData:q.workflowStripData}))}}_runtimeLoadingFromDraft=!1};SourceCode.Forms.Runtime._applyWorkflowStripFromDraft=function(n){if(checkExists(n)&&checkExists(n.workflowStripData)){var t=checkExists(n.windowToUse)?n.windowToUse:window,q=n.workflowStripData,r=t.jQuery("#WorkflowStrip").not(".drop-menu");r.length>0&&checkExists(q.data)&&(t.positionAndShowWorkflowStrip(q.data.workflowStrip),r.data("WFInformation",q.data),t.populateWorkflowStrip(q.data));checkExists(q.workflowInfo)&&!checkExists(t.workflowInfo)&&(t.workflowInfo=q.workflowInfo);var u=t.jQuery("*[id$=_6f1d43bf-a7fe-21ed-36ac-0d3bcb633bfb]");u.off("click").on("click",t.doWorkflowSubmit)}};SourceCode.Forms.Runtime._applyGlobalsFromDraft=function(n){if(checkExists(n)&&checkExists(n.globals)){var q=checkExists(n.windowToUse)?n.windowToUse:window,t=n.globals;SFR._applyViewHiddenHashFromDraft({windowToUse:q,globals:t});SFR.Information.loadState(t.Information);SFR._applyViewWriteStatusFromDraft({windowToUse:q,globals:t});SFR._applyParametersFromDraft({windowToUse:q,globals:t});SFR._applyGlobalFromDraft({windowToUse:q,globals:t,globalName:"_runtimeIsInitializing"});SFR._applyGlobalFromDraft({windowToUse:q,globals:t,globalName:"_runtimeIdleState"})}};SourceCode.Forms.Runtime._applyGlobalFromDraft=function(n){if(checkExists(n)&&checkExists(n.globals)&&checkExists(n.globalName)){var r=checkExists(n.windowToUse)?n.windowToUse:window,u=n.globals,t=n.globalName,q=u[t];checkExists(q)&&(r[t]=q)}};SourceCode.Forms.Runtime._applyViewHiddenHashFromDraft=function(n){if(checkExists(n)&&checkExists(n.globals)){var f=checkExists(n.windowToUse)?n.windowToUse:window,e=n.globals,t=e.ViewHiddenHash;if(checkExists(t))for(var r=Object.keys(t),q=0;q<r.length;q++){var u=r[q],o=t[u];f.ViewHiddenHash[u]=o}}};SourceCode.Forms.Runtime._applyViewWriteStatusFromDraft=function(n){if(checkExists(n)&&checkExists(n.globals)){var e=checkExists(n.windowToUse)?n.windowToUse:window,o=n.globals,t=o.viewWriteStatus;if(checkExists(t))for(var r=Object.keys(t),q=0;q<r.length;q++){var u=r[q],f=t[u];checkExists(f)&&(e.viewWriteStatus[u]=f)}}};SourceCode.Forms.Runtime._applyParametersFromDraft=function(n){if(checkExists(n)&&checkExists(n.globals)){var q=checkExists(n.windowToUse)?n.windowToUse:window,t=n.globals;checkExists(t.Parameters)&&(q._runtimeParameters=t.Parameters)}};SourceCode.Forms.Runtime._applyXmlDocFromDraft=function(n){if(!checkExists(n)||!checkExistsNotEmpty(n.xmlDoc))return null;var t=n.xmlDoc;return jQuery.parseXML(t)};SourceCode.Forms.Runtime._applyViewsFromDraft=function(n){if(checkExists(n)&&checkExists(n.views)&&n.views.length!==0)for(var r=checkExists(n.windowToUse)?n.windowToUse:window,q=n.views,t=0;t<q.length;t++)SFR._applyViewFromDraft({windowToUse:r,view:q[t]})};SourceCode.Forms.Runtime._applyViewFromDraft=function(n){if(checkExists(n)&&checkExists(n.view)&&checkExists(n.view.id)&&checkExists(n.view.instanceId)){var t=checkExists(n.windowToUse)?n.windowToUse:window,r=n.view.id,u=n.view.instanceId,f=t.returnCurrentViewXML(r,u),q=getNodeAttribute("MainTable",f,"");if(q!==""){var e=t.jQuery("#"+q);e.SFCAreaItem("loadState",n.view.stateData)}SFR._applyControlsFromDraft({windowToUse:t,viewId:n.view.id,instanceId:n.view.instanceId,controls:n.view.controls})}};SourceCode.Forms.Runtime._applyGridAttributesFromDraft=function(n){if(checkExists(n)&&checkExists(n.gridElement)&&checkExists(n.attributes)){for(var o=checkExists(n.windowToUse)?n.windowToUse:window,q=n.gridElement,t=n.attributes,u=["previousactionxml","actionxml","orderbyresultname","orderby","orderdirection","paging","listrefreshed","maxcounter","isdisabled","qfname","qfvalue"],r=0;r<u.length;r++){var f=u[r],e=t[f];checkExists(e)&&q[0].setAttribute(f,e)}checkExistsNotEmpty(t.pagesize)&&(checkExistsNotEmpty(t.pagenumber)?o.populatePagingControls(q[0],t.pagesize,t.pagenumber,t.numberofpages,t.hasmorepages,t.hasrowcount,t.resetpagenumber):q[0].setAttribute(pagesize,t.pagesize))}};SourceCode.Forms.Runtime._applyGridRowsFromDraft=function(n){if(checkExists(n)&&checkExists(n.gridId)&&checkExists(n.viewId)&&checkExists(n.instanceId)){var r=checkExists(n.windowToUse)?n.windowToUse:window,s=n.gridId,u=n.viewId,f=n.instanceId,t=r.getViewHiddenHash(u,f);if(checkExists(t)){for(var e=[],q=0;q<t.length;q++){var o=t[q];checkExistsNotEmpty(o.counter)&&e.push(o)}r.rebuildTable(s,u,f,!1,!1,!0,e,!0)}}};SourceCode.Forms.Runtime._applyControlsFromDraft=function(n){if(checkExists(n)&&checkExists(n.controls)&&n.controls.length!==0)for(var r=checkExists(n.windowToUse)?n.windowToUse:window,u=checkExistsNotEmpty(n.viewId)?n.viewId:null,f=checkExistsNotEmpty(n.instanceId)?n.instanceId:null,q=n.controls,t=0;t<q.length;t++)SFR._applyControlFromDraft({windowToUse:r,viewId:u,instanceId:f,control:q[t]})};SourceCode.Forms.Runtime._applyControlFromDraft=function(n){if(checkExists(n)&&checkExists(n.control)){var f=checkExists(n.windowToUse)?n.windowToUse:window,e=checkExistsNotEmpty(n.viewId)?n.viewId:null,o=checkExistsNotEmpty(n.instanceId)?n.instanceId:null,t=n.control,q=t.id;if(checkExistsNotEmpty(q)&&checkExists(t.stateData)){var s={xmlDoc:f.viewControllerDefinition,viewID:e,instanceID:o,controlID:q,propertySearch:"LoadStateMethod"},r=_runtimeControllerFindObject(s),u=SourceCode.Forms.Runtime._loadListingControlData({controlId:q,viewId:n.viewId,instanceId:n.instanceId});if(u&&(t.stateData.listingControlItemsInfo=u),checkExists(r)){var h=new PopulateObject(null,t.stateData,q);executeControlFunction(r,"LoadStateMethod",h)}}}};SourceCode.Forms.Runtime._loadListingControlData=function(n){var t=SourceCode.Forms.Runtime._loadListingControlDataFromFields(n);return t||(t=SourceCode.Forms.Runtime._loadListingControlDataFromWorkflowActions(n)),t};SourceCode.Forms.Runtime._loadListingControlDataFromFields=function(n){var r={parenttype:"Object",controlid:n.controlId,counter:!0},t=getHiddenPropertyCollection(n.viewId,n.instanceId,r);if(checkExists(t)&&t.length>0){var q=SourceCode.Forms.Runtime.Information.getControlBrokerHistory({viewId:n.viewId,instanceId:n.instanceId,controlId:n.controlId});if(checkExists(q))var u=filterListClientSide(q,t,{reverse:!1});return new PopulateObject(null,null,n.controlId,null,null,u)}return null};SourceCode.Forms.Runtime._loadListingControlDataFromWorkflowActions=function(n){var t=SourceCode.Forms.Runtime.Information.getControlWorkflowHistory({viewId:n.viewId,instanceId:n.instanceId,controlId:n.controlId});return checkExists(t)?new PopulateObject(null,null,n.controlId,null,null,t):null};function manageEnabledStateTabIndex(n){popuplateTabIndexCache(n);n.get_isEnabled()&&n.get_isParentEnabled()?n.set_tabIndex(n.specifiedTabIndex):n.set_tabIndex(-1)}function popuplateTabIndexCache(n){var t=n.get_tabIndex();n.specifiedTabIndex=t!==-1?t:n.specifiedTabIndex}function setTabIndexesToNone(){var b={},k=checkExists(masterPopupManager)&&checkExists(masterPopupManager.popUps)?masterPopupManager.popUps.length:0,v=viewControllerDefinition,n=window,d=!0;if(k>0){var s=masterPopupManager.popUps[k-1];s.element.find(".popup-header a").attr("tabindex","-1");_runtimePopupWindows.push(s.element);var y=s.element.find("iframe");if(y.length>0)n=y[0].contentWindow,v=y[0].contentWindow.viewControllerDefinition;else{var g=s.element.find("a, input, [tabindex][tabindex!=-1]");g.attr("tabindex","-1");_runtimePopupControls.push(g);d=!1}}if(checkExists(v)&&d){for(var h=$mn(v,"Controllers/Controller/Controls/Control"),q=h.length,c,t,r;q--;){t=h[q];r=t.getAttribute("ID");c=new PopulateObject(null,null,r,"TabIndex");var ut=n.executeControlFunction(t,"GetProperty",c);b[r]=ut}for(q=h.length;q--;)t=h[q],r=t.getAttribute("ID"),c=new PopulateObject(null,"-1",r,"TabIndex"),n.executeControlFunction(t,"SetProperty",c);for(var nt={},p=n.$(".grid .grid-body-content .grid-content-table"),ft=n.$(".grid .grid-body .grid-column-headers .grid-column-header-table"),u=0;u<p.length;u++)nt[u]=p[u].getAttribute("tabindex"),p[u].setAttribute("tabindex","-1");ft.attr("tabindex","-1");for(var tt={},w=n.$(".collapse-vertical, .expand-vertical"),f=0;f<w.length;f++)tt[f]=w[f].getAttribute("tabindex"),w[f].setAttribute("tabindex","-1");for(var qt={},l=n.$(".filterContainer").find("a, input, textarea, [tabindex][tabindex != -1]"),e=0;e<l.length;e++)qt[e]=l[e].getAttribute("tabindex"),l[e].setAttribute("tabindex",-1);for(var rt={},a=n.$("a.action-row"),o=0;o<a.length;o++)rt[o]=a[o].getAttribute("tabindex"),a[o].setAttribute("tabindex","-1");_runtimeActionRows.push(a);_runtimeActionRowTabIndexes.push(rt);_runtimeListViewTabIndexes.push(nt);_runtimeControlTabIndexes.push(b);_runtimeViewHeaderTabIndexes.push(tt);_runtimeFilterTabIndexes.push(qt);_runtimeFilterControlGroups.push(l)}}function restoreTabIndexes(){var s=_runtimePopupWindows.pop(),t=window,w=!0;if(checkExists(s)){var b=s.find("iframe");if(b.length>0)s.find(".popup-header a").removeAttr("tabindex"),t=b[0].contentWindow;else{var k=_runtimePopupControls.pop();checkExists(k)&&k.attr("tabindex",0);w=!1}}if(checkExists(t)&&checkExists(t.viewControllerDefinition)&&w){var h=$mn(t.viewControllerDefinition,"Controllers/Controller/Controls/Control"),d=h.length,g,c,l,nt=_runtimeControlTabIndexes.pop(),r=_runtimeListViewTabIndexes.pop(),tt=_runtimeViewHeaderTabIndexes.pop(),a=_runtimeFilterTabIndexes.pop(),qt=_runtimeActionRowTabIndexes.pop(),u=t.$(".grid .grid-body-content .grid-content-table"),v=t.$(".grid .grid-body .grid-column-headers .grid-column-header-table"),y=t.$(".collapse-vertical, .expand-vertical"),f=_runtimeFilterControlGroups.pop(),p=_runtimeActionRows.pop();if(checkExists(u)&&checkExists(v)&&checkExists(r))for(var n=0;n<u.length;n++)checkExists(u[n])&&checkExists(v[n])&&checkExists(r[n])&&(u[n].setAttribute("tabindex",r[n]),v[n].setAttribute("tabindex",r[n]));if(checkExists(y)&&checkExists(tt))for(var e=0;e<y.length;e++)y[e].setAttribute("tabindex",tt[e]);if(checkExists(p)&&checkExists(qt))for(var o=0;o<p.length;o++)p[o].setAttribute("tabindex",qt[o]);if(checkExists(f)&&checkExists(a))for(var q=0;q<f.length;q++)checkExists(a[q])?f[q].setAttribute("tabindex",a[q]):f[q].removeAttribute("tabindex");if(checkExists(nt)&&h.length>0)while(d--)c=h[d],l=c.getAttribute("ID"),tabIndex=nt[l],checkExists(tabIndex)&&(g=new PopulateObject(null,tabIndex,l,"TabIndex"),t.executeControlFunction(c,"SetProperty",g))}}function calculateFormTabIndex(n){return(n=parseInt(n,10),n===FORM_LEVEL_CONTROL)?FORM_LEVEL_CONTROL:!isNaN(n)&&n>0?FORM_LEVEL_INDEX_INCREMENT*(n-1)+FORM_LEVEL_INDEX_BASE:FORM_LOGICAL_MAX_TAB_INDEX}function calculateViewLevelTabIndex(n,t){if(t===-1)return t;if(n=parseInt(n,10),t=parseInt(t,10),isNaN(n)||n===0)n=CONTROL_LOGICAL_MAX_TAB_INDEX;else if(n===-1)return n;return!isNaN(t)&&n>0&&t===FORM_LEVEL_CONTROL?FORM_LEVEL_INDEX_BASE+FORM_LEVEL_INDEX_INCREMENT*(n-1)+CONTROL_LOGICAL_MAX_TAB_INDEX:t+n}function calculateTabIndex(n,t){var q=null;if(CALCULATED_TAB_INDEXES===!1){for(var f=$mn(viewControllerDefinition,"Controllers/Controller/Controls/Control"),r=null,u=null,e=null,o=null,s=f.length;s--;)r=f[s],u=r.getAttribute("ID"),q=calculateFormTabIndex(0),o=calculateViewLevelTabIndex(0,q),e=new PopulateObject(null,o,u,"TabIndex"),executeControlFunction(r,"SetProperty",e),SourceCode.Forms.Controls.Web.controlTabIndexHierarchy[u]=0;CALCULATED_TAB_INDEXES=!0}if(n.toLowerCase()==="none")n=-1;else{var h=SourceCode.Forms.Controls.Web.controlTabIndexHierarchy[t],c=n;q=calculateFormTabIndex(h);n=calculateViewLevelTabIndex(c,q)}return n}function getUserTabIndex(n,t){if(n=parseInt(n,10),n!==-1){var q=SourceCode.Forms.Controls.Web.controlTabIndexHierarchy[t];return n===CONTROL_LOGICAL_MAX_TAB_INDEX?0:q===FORM_LEVEL_CONTROL&&n>CONTROL_LOGICAL_MAX_TAB_INDEX?reverseCalculateFormTabIndex(n):n>CONTROL_LOGICAL_MAX_TAB_INDEX?reverseCalculateViewLevelTabIndex(q,n):n}return-1}function reverseCalculateFormTabIndex(n){var t=(n-CONTROL_LOGICAL_MAX_TAB_INDEX)/FORM_LEVEL_INDEX_INCREMENT;return t===CONTROL_LOGICAL_MAX_TAB_INDEX&&(t=0),t}function reverseCalculateViewLevelTabIndex(n,t){var q=0;return q=n===0?t-FORM_LOGICAL_MAX_TAB_INDEX:t-FORM_LEVEL_INDEX_INCREMENT*n,q===CONTROL_LOGICAL_MAX_TAB_INDEX&&(q=0),q}function returnCurrentViewXML(n,t){var u=n+"_",f=checkExistsNotEmpty(t)&&t!==_runtimeEmptyGuid;f&&(u+=t);var q=viewXmlCache[u];if(!checkExists(q)){var e="Controllers/Controller[@ID='"+n+"']";f&&(e+="[@InstanceID='"+t+"']");var r=$sn(viewControllerDefinition,e);!checkExists(r)&&f&&(r=$sn(viewControllerDefinition,"Controllers/Controller[@ID='"+n+"']"));checkExists(r)&&(q=r,viewXmlCache[u]=q)}return q}function getViewDefinition(n,t,q){var u=null;if(checkExists(q)||!checkExists(n)){var r="Controllers/Controller";checkExists(n)&&(r+="[@ID='"+n+"']");checkExists(t)&&t!==_runtimeEmptyGuid&&(r+="[@InstanceID='"+t+"']");checkExists(q)&&(r+="[Fields/Field[@DataSourceID='"+q+"']]");u=$sn(viewControllerDefinition,r)}else u=returnCurrentViewXML(n,t);return u}function persistViewFilterForUser(n,t){ajaxCall.persistRuntimeValues("persistViewFilter",n,t)}function persistViewParametersForUser(n,t){__runtimeIsAnonymous||(__persistedParametersDefinition=t,ajaxCall.persistRuntimeValues("persistViewParameters",n,t))}function _runtimeBusyControlView(n,t,q){var r=$sn(viewControllerDefinition,"Controllers/Controller[Controls/Control[@ID='{0}']]".format(n)),u=r.getAttribute("ID"),f=r.getAttribute("InstanceID");runtimeBusyView(u,t,q,f)}function runtimeBusyView(n,t,q,r){var u=getViewMainTable(n,r);if(checkExistsNotEmpty(u)&&(u=jQuery("#"+u),u.length>0)){if(q&&t){if(u[0].style.display==="none")return;var f=u.closest(".form");if(f.length>0){var e=f.parent();if(e.length>0&&e[0].style.display==="none")return}}showSpinner(u,n,q,t,r)}}function showSpinner(n,t,q,r,u){if(r){var e=getViewDefinition(t,u),o=getViewSpinnerDelay(e),s=doesViewHaveInitSpinner(e);o>0?_runtimeViewLoadingTimers[getViewInstanceIdentifier(t,u)]=setTimeout(function(){modalizeShowBusy(n,q,s)},o):modalizeShowBusy(n,q,s)}else{var f=getViewInstanceIdentifier(t,u);checkExists(_runtimeViewLoadingTimers)&&checkExists(_runtimeViewLoadingTimers[f])&&(clearTimeout(_runtimeViewLoadingTimers[f]),_runtimeViewLoadingTimers[f]=null);modalizeShowBusy(n,q,r)}}function getViewInstanceIdentifier(n,t){return checkExistsNotEmpty(n)||(n=_runtimeEmptyGuid),checkExistsNotEmpty(t)||(t=_runtimeEmptyGuid),n+t}function modalizeShowBusy(n,t,q){n.modalize(t).showBusy(q)}function doesViewHaveInitSpinner(n){if(_runtimeInitSpinner&&checkExists(n)){var t=n.selectSingleNode("Properties/Property[@Name='InitializeIndicatorMode']");if(checkExists(t)&&checkExists(t.text))return t.text.toUpperCase().indexOf("BUSY")!==-1}return!0}function getViewSpinnerDelay(n){if(_runtimeInitSpinner&&checkExists(n)){var t=n.selectSingleNode("Properties/Property[@Name='InitializeIndicatorDelay']");if(checkExists(t)&&checkExists(t.text)){var q=parseInt(t.text);if(q)return q}}return 0}function runtimeShowBusyOverlay(n){checkExists(n)||(n={});checkExists(n.extendedOptions)||(n.extendedOptions={});checkExists(n.windowToUse)||(n.windowToUse=window);checkExists(n.isInitSpinner)||(n.isInitSpinner=!1);checkExists(n.fixedPosition)||(n.fixedPosition=!0);checkExists(n.autoResize)||(n.autoResize=!0);n.windowToUse._runtimeSpinnersCount++;n.windowToUse._runtimeOverlayOpacity>-1&&n.windowToUse._runtimeOverlayOpacity<=1&&(n.extendedOptions.opacity=n.windowToUse._runtimeOverlayOpacity);n.id?(!n.windowToUse._runtimeInitSpinner||n.isInitSpinner)&&n.windowToUse.runtimeModalizer.show(n.showSpinner,n.targetFrame,n.id,n.fixedPosition,n.autoResize,n.extendedOptions):(!n.windowToUse._runtimeInitSpinner||n.isInitSpinner)&&n.windowToUse._runtimeSpinnersCount===1&&n.windowToUse.runtimeModalizer.show(n.showSpinner,n.targetFrame,n.id,n.fixedPosition,n.autoResize,n.extendedOptions)}function runtimeHideBusyOverlay(n){checkExists(n)||(n={});checkExists(n.windowToUse)||(n.windowToUse=window);n.windowToUse._runtimeSpinnersCount===1?setTimeout(function(){runtimeHideBusyOverlayInner(n)},50):runtimeHideBusyOverlayInner(n)}function runtimeHideBusyOverlayInner(n){n.windowToUse._runtimeSpinnersCount--;(n.windowToUse._runtimeSpinnersCount<0||n.forceHide===!0)&&(n.windowToUse._runtimeSpinnersCount=0);n.windowToUse._runtimeSpinnersCount===0&&n.windowToUse.runtimeModalizer.hide(n.id)}function getViewMainTable(n,t){var q="",r=getViewDefinition(n,t);return checkExists(r)&&(q=r.getAttribute("MainTable")),q}function getMainTableViewInformation(n){var r=n,t=_runtimeMainTableInfo[r];if(!t){t={};var q=$sn(viewControllerDefinition,"Controllers/Controller[@MainTable='"+n+"']"),u="",f=null;if(checkExists(q)){u=q.getAttribute("ID");f=q.getAttribute("InstanceID");for(var e=$mn(q,"Properties/Property"),o=e.length;o--;){var s=e[o],c=s.getAttribute("Name"),l=s.text;t[c]=l}var h=!1,a=$mn(q,"Controls/Control[(@FieldID) and (Properties/Property[Name/text()='SetValue'])][@ControlTemplate='edit'][@DataType='Image']");a.length>0&&(h=!0);t.clearThumbnailCache=h}t.viewID=u;t.instanceID=f;_runtimeMainTableInfo[r]=t}return t}function _runtimeIsMobile(){return _runtimeAppleMobileRegex.test(navigator.userAgent)}function openFile(n,t,q,r,u,f,e){if(checkExists(q)&&q!=="file")return constructFileSrc(n,t,q,r,u,f,null,null,e);var s=!_runtimeIsMobile(),h=constructFileSrc(n,t,q,r,u,f,s,null,e),o=h;s&&(o=document.getElementById("FileURL").value);o=FormatFileDownloadPathForAnonAccess(o,!0);o=SourceCode.Forms.XSRFHelper.appendAntiXSRFQueryStringParameter(o);s?framePosting("HiddenFileFrame",o,h,!1):_runtimeRedirect(o)}function constructExcelFileName(n){var u="Book1.xlsx";if(checkExists(n)){var f=n.selectSingleNode("ViewName");if(checkExists(f)){var e=f.text;if(checkExistsNotEmpty(e)){var t=new Date,h=t.getFullYear().toString(),o=t.getMonth()+1,q=o.toString();o<10&&(q="0"+q);var s=t.getDate(),r=s.toString();s<10&&(r="0"+r);u="{0}-{1}{2}{3}.xlsx".format(e,h,q,r)}}}return u}function generateDataForExcel(n){n=checkExists(n)?n:{};var q={},r=SFRGrid.execute({element:n.viewHtml,fn:"fetch",params:["columns"]});if(r.length>0){q.rows=[];var u={};u.cells=[];for(var t=0;t<r.length;t++)if(r[t].hidden!==!0){var o=r[t].display,s={display:o,datatype:"text"};u.cells.push(s)}q.rows.push(u)}if(n.rowsGridObjs.length>0){checkExists(q.rows)||(q.rows=[]);for(var t=0;t<n.rowsGridObjs.length;t++){var e=n.rowsGridObjs[t];if(e.length===r.length){var u={};u.cells=[];for(var f=0;f<e.length;f++)if(r[f].hidden!==!0){var o=e[f].display,c=e[f].value,l=e[f].fieldPropertyType,h=adjustCellDataForExcel(o,c,l),s={display:h.display,datatype:h.datatype};u.cells.push(s)}q.rows.push(u)}}}return q}function adjustCellDataForExcel(n,t,q){var r={display:n,datatype:q};switch(q){case"autonumber":case"number":case"decimal":case"yesno":r.display=t;break;case"date":case"datetime":case"time":r.display=SCCultureHelper.Current()._checkDateIsZuluDate(t)?t.replace(" ","T"):t}return r}function constructOpenXmlNotFoundErrorMessage(){var n="<a href='' onClick='openXmlNotFoundKbLinkClick()'>{0}<\/a>".format(Resources.RuntimeMessages.OpenXmlNotFoundKb);return Resources.RuntimeMessages.OpenXmlNotFound.format(n)}function openXmlNotFoundKbLinkClick(){HelpHelper.runHelp(7501)}var _runtimeRedirect=function(n){window.location=n},constructFileSrc=function(n,t,q,r,u,f,e,o,s){checkExists(f)||(f=!1);var h=document.getElementById("FileURL").value,c="",v=null,a=null;if(t.toLowerCase()==="path")checkExistsNotEmpty(s)?e?c+=setFrameVariable("_filerequestdata",s):(s=encodeURIComponent(s),s=h.length+n.length+s.length<=2048?"&_filerequestdata="+s:""):s="",h=n.indexOf(h)===-1?"{0}?_path={1}{2}".format(h,encodeURIComponent(n),s):n+s,c+=setFrameVariable("_path",n);else if(t.toLowerCase()==="control"){var b=_runtimeControllerFindObject({controlID:n});checkExists(b)&&(v=b.parentNode.parentNode.getAttribute("InstanceID"),a=returnFieldAttributeObject(b.getAttribute("FieldID"),v))}else t.toLowerCase()==="field"&&(a=returnFieldAttributeObject(n,v));if(checkExists(a)){var y=a.parentID,k=a.PropertyName,ot=a.viewID,d={parentid:y,counter:f,controlid:!1,join:!1},p="",g=getViewHiddenHash(ot,v);if(checkExists(g)){var qt=g.filter(__runtimeJsonFilterMatchingItems,d);if(qt.length===1){var nt=qt[0].fields;for(var tt in nt){var l=nt[tt].value;if(checkExistsNotEmpty(l)&&nt!==k){var w=reverseReplaceSpecialChars(l);w.startsWith("<collection")||w.startsWith("<a href=")||(p+="&"+tt+"="+encodeURIComponent(l),c+=setFrameVariable(tt,l))}}}d={parentid:y,controlid:!1,join:!1,parenttype:"Object",method:!0};var rt=g.filter(__runtimeJsonFilterMatchingItems,d);if(rt.length===1){var ut=rt[0].parameters;for(var ft in ut){var l=ut[ft].value,et="PARAMETER_"+ft;if(checkExistsNotEmpty(l)){var w=reverseReplaceSpecialChars(l);w.startsWith("<collection")||w.startsWith("<a href=")||(p+="&"+et+"="+encodeURIComponent(l),c+=setFrameVariable(et,l))}}}}p.length>0&&(h+="?_soid="+y+"&_returnproperty="+k+p,q==="image"&&checkExists(o)&&o&&(h+="&t="+(new Date).getTime()),c+=setFrameVariable("_soid",y),c+=setFrameVariable("_returnproperty",k))}return h.indexOf("?")>-1&&(checkExists(r)&&(h+="&_height="+r,c+=setFrameVariable("_height",r)),checkExists(u)&&(h+="&_width="+u,c+=setFrameVariable("_width",u)),checkExists(q)?(h.indexOf("controltype=")===-1&&(h+="&_controltype="+q),c+=setFrameVariable("_controltype",q)):(h+="&_controltype=file",c+=setFrameVariable("_controltype","file"))),e?c:h},FormatFileDownloadPathForAnonAccess=function(n,t){if(checkExistsNotEmpty(__runtimeAnonToken)&&checkExists(__runtimeAnonTokenName)){var r="{0}&{1}={2}";n.indexOf("?")===-1&&(r="{0}?{1}={2}");var q=__runtimeAnonToken;t&&(q=encodeURIComponent(q));n=r.format(n,__runtimeAnonTokenName,q)}return n},PopulateObject=function(n,t,q,r,u,f){return{Value:t,CurrentControlId:q,property:r,returnResult:u,FormId:currentForm,JsonData:f,presetXmlDocument:n,get XmlDocument(){var n=null;return checkExists(this.presetXmlDocument)?n=this.presetXmlDocument:checkExists(this.CurrentControlId)&&(n=_runtimeFieldsDataToXml({controlID:q})),n}}},_runtimeExtendObjectInfo=function(n){return{Value:n.Value,CurrentControlId:n.CurrentControlId,property:n.property,returnResult:n.returnResult,FormId:n.FormId,JsonData:n.JsonData}},parameterContext=function(n,t,q){this.ViewID=n;this.ObjectID=t;this.Method=q},getViewProperty=function(n,t){var r="Properties/Property[@Name='"+t+"']",q=$sn(n,r);return checkExists(q)?q.text:null},getWorkflowActionCollection=function(n){return n.Actions},returnDisplayPropertyFromTemplate=function(n){if(checkExists(n)&&n.indexOf("<Template>")===0){var t=$sn($xml(n),"Template/Item[@SourceType='ObjectProperty']");checkExists(t)&&(n=t.getAttribute("SourceID"))}return n},returnAllDisplayPropertiesFromTemplate=function(n){var t=[];if(n.indexOf("<Template>")===0){var q=$mn($xml(n),"Template/Item[@SourceType='ObjectProperty']");if(checkExists(q))for(var r=0;r<q.length;++r)t.push(q[r].getAttribute("SourceID"))}else t.push(n);return t},controlInformationObject=function(n){var t=_runtimeControlInfoCache[n];if(!t){t={};t.ID=n;var q=_runtimeControllerFindObject({controlID:n});if(!checkExists(q))return null;checkExists(q.parentNode)&&checkExists(q.parentNode.parentNode)&&(t.ViewID=q.parentNode.parentNode.getAttribute("ID"),t.InstanceID=q.parentNode.parentNode.getAttribute("InstanceID"));var e=q.getAttribute("FieldID");if(checkExists(q.getAttribute("ParentUsingField"))&&(t.ParentUsingField=q.getAttribute("ParentUsingField")),checkExists(e)){t.fieldID=e;var o=n.split("_")[0],r=returnFieldAttributeObject(e,o),f=r.PropertyName;if(checkExists(f)){if(t.contextID=r.contextID,t.contextType=r.contextType,t.ObjectID=r.parentID,t.contextType==="Primary")checkExistsNotEmpty(r.propertyType)&&(t.propertyType=r.propertyType.toLowerCase());else{var s=q.getAttribute("DataType");checkExists(s)&&(t.propertyType=s.toLowerCase())}var u=new dataSourceLookup({xmlDoc:viewControllerDefinition,sourceControlID:t.ID}).getDataSource();if(checkExists(u)){t.contextID=u.getAttribute("ContextID");t.contextType=u.getAttribute("ContextType");var h=u.getAttribute("DisplaySO");t.ObjectID=h?h:u.getAttribute("AssociationSO");f=returnDisplayPropertyFromTemplate(u.getAttribute("DisplayTemplate"));xpField="Controllers/Controller/Fields/Field[@ContextID='"+t.contextID+"'][@ContextType='"+t.contextType+"'][@ObjectID='"+t.ObjectID+"'][PropertyName/text()='"+f+"']";var c=$sn(viewControllerDefinition,xpField);checkExists(c)&&(r=returnFieldAttributeObject(c.getAttribute("ID"),o));t.isAssociation=!0}else t.isAssociation=!1;t.qualifiedName=t.ObjectID+"."+f;checkExists(r)&&(t.resultName=getQualifiedResultName(r))}}_runtimeControlInfoCache[n]=t}return t},getQualifiedResultName=function(n,t){var f=null,q,r,u=null;return t?(q=n.getAttribute("ContextID"),r=n.getAttribute("ContextType"),u=n.getAttribute("ObjectID")):(q=n.contextID,r=n.contextType,u=n.parentID),checkExists(r)&&checkExists(q)&&checkExists(u)&&(f=r+"_"+q+"_"+u),f},executeControlFunctionHash={};function executeControlFunction(n,t,q){var o=null;try{var f=q.CurrentControlId+"_"+t,r=executeControlFunctionHash[f];if(typeof r=="undefined"){var u=$sn(n,"Properties/Property[Name='"+t+"']/Value");if(u!=null){u=u.text;var r=evalFunction(u);executeControlFunctionHash[f]=r}else executeControlFunctionHash[f]=-1}typeof r=="function"?o=r(q):r===-1&&(q.functionExists=!1)}catch(e){if(checkExistsNotEmpty(e.message)){var s={type:5,source:"executeControlFunction",category:"Helper",message:Resources.RuntimeMessages.ErrorSettingControlProperty,parameters:[t,e.message],data:n,exception:e};SFLog(s)}}return o}function transformOriginalXMLForControl(n,t,q,r,u){if(!checkExists(t)){var f=getViewDefinition(n,r);if(checkExists(f)){var e=f.getAttribute("MainTable"),c=f.getAttribute("TypeView").toLowerCase();checkExists(e)&&e.length>0&&c==="list"&&(t=getLoopContextData({loopContextID:u,viewID:n,instanceID:r}).counter,checkExists(t)||(t=getViewSelectedCounter(e)))}}var s=null,h=null;if(checkExists(q)){var o=controlInformationObject(q);o.isAssociation&&(s=o.contextID,h=o.contextType)}return getCombinedHiddenPropertyCollection(n,null,null,null,!1,t,"viewid",s,h,r)}var replaceSpecialChars=function(n){return n.length>0&&(n=n.replaceAll("<","&lt;"),n=n.replaceAll(">","&gt;"),n=n.replace(newLineRegEx,"<br/>")),n},reverseReplaceSpecialChars=function(n){return n.length>0&&(n=n.replaceAll("&amp;lt;","<"),n=n.replaceAll("&amp;gt;",">"),n=n.htmlDecode().toString()),n};function removeSelectedRow(n){SFRGrid.execute({element:n,fn:"remove",params:["first-selected-row"]})}function returnSelectedRow(n){return SFRGrid.execute({element:n,fn:"fetch",params:["first-selected-row"]})}function returnViewRows(n,t){var q=null;t=checkExistsNotEmpty(t)?t.toUpperCase():"";switch(t){case"SELECTED":q=SFRGrid.execute({element:n,fn:"fetch",params:["selected-rows"]});break;case"UNSELECTED":q=SFRGrid.execute({element:n,fn:"fetch",params:["unselected-rows"]});break;default:q=SFRGrid.execute({element:n,fn:"fetch",params:["rows"]})}return q}function returnSelectedCounter(n){return n[0].getAttribute("selectedCounter")}function returnSelectedIndex(n){return n[0].getAttribute("selectedIndex")}function returnRowFromCounter(n,t){var u=null;if(checkExistsNotEmpty(t)){var e=t.toString(),q=SFRGrid.execute({element:n,fn:"fetch",params:["rows"]});if(checkExists(q))for(var r=0;r<q.length;r++){var f=jQuery(q[r]);if(f.children("td").metadata().counter.toString()===e){u=f;break}}}return u}var getViewSelectedCounter=function(n){var q=null,t=returnSelectedRow(jQuery("#"+n));return checkExists(t)&&t.length>0&&(q=t.children("td").metadata().counter),q},getViewRowCounters=function(n,t){var u=[],q=returnViewRows(jQuery("#"+n),t);if(checkExists(q))for(var r=0;r<q.length;r++){var f=jQuery(q[r]),e=f.children("td").metadata().counter;u.push(e)}return u};function getLoopContextData(n){var q={};if(!checkExistsNotEmpty(n.viewID)&&checkExists(n.mainTable)){var r=new getMainTableViewInformation(n.mainTable.attr("id"));n.viewID=r.viewID;n.instanceID=r.instanceID}if(checkExistsNotEmpty(n.viewID)&&checkExists(n.loopContextID)&&checkExists(_runtimeLoopContextData[n.loopContextID])){var t=n.viewID;checkExistsNotEmpty(n.instanceID)||(n.instanceID=_runtimeEmptyGuid);t+="_"+n.instanceID;checkExistsNotEmpty(n.controlID)&&(t+="_"+getNonInstanceSpecificControlID(n.controlID));checkExists(_runtimeLoopContextData[n.loopContextID][t])&&(q=_runtimeLoopContextData[n.loopContextID][t])}return q}function framePosting(n,t,q,r){if(checkExists(r)&&r===!0){if(typeof __runtimeFormLevel!="undefined"&&__runtimeFormLevel!=null&&__runtimeFormLevel!="0")try{checkExists(window.frameElement)&&n==="_self"&&$(window.frameElement).addClass("navigated")}catch(p){}if(t.indexOf("http")!==0&&(t="http://"+t),n==="modal")if(window.showModalDialog)window.showModalDialog(t,"",q);else{for(var f="",l=q.split(";"),a=[{OrigProp:"dialogwidth",RepProp:"width",ParseNumber:!0},{OrigProp:"dialogheight",RepProp:"height",ParseNumber:!0}],h=0;h<l.length;h++){var e=l[h].split(":");if(e.length>1){for(var v=!1,c=0;c<a.length;c++){var o=a[c];if(e[0].toUpperCase().indexOf(o.OrigProp.toUpperCase())!==-1){v=!0;var y=parseInt(e[1]);o.ParseNumber&&!isNaN(y)?f+=",{0}={1}".format(o.RepProp,y):o.ParseNumber||(f+=",{0}={1}".format(o.RepProp,e[1]))}}v||(f+=",{0}={1}".format(e[0],e[1]))}}f=f+",menubar=0,toolbar=0";window.open(prepareUrlToNavigate(t),n,f.substring(1))}else window.open(prepareUrlToNavigate(t),n)}else{var s=n;$(document.documentElement).hasClass("msie")||s!="_blank"||(s+=(new Date).getTime(),window.open(prepareUrlToNavigate(t),s));var u=jQuery("<form><\/form>");u.attr("method","POST");u.attr("action",t);u.attr("target",s);u.append(q);jQuery("body").append(u);u.trigger("submit");u.remove()}}function prepareUrlToNavigate(n){return n!=null&&SourceCode.Forms.Browser.msie&&(n=n.replace(/&/g,"&amp;")),n}function setFrameVariable(n,t){var r=jQuery("<wrapper><\/wrapper>"),q=jQuery("<input/>");return q.attr("ID",n),q.attr("name",n),q.attr("type","hidden"),q.attr("value",t),r.append(q),r.html()}function checkQuickSearch(n,t,q,r){if(n.length===0&&q)n="&nbsp;";else if(checkExists(t)&&t.length>0){t=replaceSpecialChars(t).toLowerCase();var u=replaceSpecialChars(n);u.length>0&&u.toLowerCase().indexOf(t)>-1?n=r?quickSearchHighlightTextNodes(u,t,r):wrapAround(u,t):r||(n=u)}return n}function quickSearchHighlightTextNodes(n,t,q){var u=!1,f=[];n=reverseReplaceSpecialChars(n);for(var o=jQuery("<div>"+n+"<\/div>"),r=o[0].firstChild;r;){if(r.nodeType===3){var e=r.nodeValue;e.length>0&&e.toLowerCase().indexOf(t)>-1&&($(r).before(wrapAround(e,t)),f.push(r),u=!0)}else r.nodeType===1&&r.innerHTML.length>0&&r.innerHTML.toLowerCase().indexOf(t)>-1&&(r.innerHTML=quickSearchHighlightTextNodes(r.innerHTML,t,q),u=!0);r=r.nextSibling}if(u){while(f.length>0)$(f.pop()).remove();n=o[0].innerHTML}return n}function wrapAround(n,t){var u=n.toLowerCase(),f=t,e="";if(u.indexOf(f)>-1){for(var s=u.length,h=f.length,r=u.indexOf(f),q=0;q<s;q++)if(q<r)e+=n.substring(q,r),q=r-1;else{for(var o="";r+h>q;)o+=n.charAt(q),q++;if(e+="<span class='wrapAround'>"+o+"<\/span>",r=u.indexOf(f,q),q--,r===-1){e+=n.substring(q+1);break}}return e}return n}function showRuntimeException(n){try{popupManager.showError(n)}catch(t){alert(n)}return!1}var resetDefaultControlValues=function(n,t,q){for(var l=returnCurrentViewXML(n,t),o=$mn(l,"Controls/Control[Properties[Property/Name/text()='SetValue'][Property/Name/text()='GetDefaultValue']][(@ControlTemplate='edit')]"),f=0;f<o.length;f++){var r=o[f],s=r.getAttribute("ExpressionID");if(checkExists(s))updateCalculatedControls(null,t,null,null,null,s,!0,q);else{var h=r.getAttribute("ID"),u=new PopulateObject(null,null,h),e=executeControlFunction(r,"GetDefaultValue",u);if(checkExists(e)&&e.length>0){u=new PopulateObject(null,e,h);executeControlFunction(r,"SetValue",u);var c=r.getAttribute("FieldID");if(checkExists(c)){var a=executeControlFunction(r,"GetValue",u);setHiddenFieldValue(c,a,null,t,null,null,!0,q)}}}}},randomFromTo=function(n,t){return Math.floor(Math.random()*(t-n+1)+n)},nthRoot=function(n,t){n=n.isWhole()?n.toInt():n.toFloat();t=t.isWhole()?t.toInt():t.toFloat();var r=t%2==1&&n<0;r&&(n=-n);var q=Math.pow(n,1/t);return t=Math.pow(q,t),Math.abs(n-t)<1&&n>0==t>0?r?-q:q:void 0};String.prototype.leftPad=function(n,t){for(var q=this;q.length<t;)q=n+q;return q};String.prototype.rightPad=function(n,t){for(var q=this;q.length<t;)q=q+n;return q};var getAverage=function(n){var t=Big(0),q=n.length;if(q>0){for(var r=0;r<q;r++)t=t.plus(returnNumericValue(n[r]));t=t.div(q)}return t},getMaximum=function(n){for(var r=runtimeAreAnyDateTypes(n),q=r?returnDateValue(n[0]):returnNumericValue(n[0]),u=0;u<n.length;u++){var t=n[u];t=r?returnDateValue(t):returnNumericValue(t);(r?runtimeDatesComparison([t,q])>0:t.gt(q))&&(q=t)}return q},getMinimum=function(n){for(var r=runtimeAreAnyDateTypes(n),q=r?returnDateValue(n[0]):returnNumericValue(n[0]),u=0;u<n.length;u++){var t=n[u];t=r?returnDateValue(t):returnNumericValue(t);(r?runtimeDatesComparison([t,q])<0:t.lt(q))&&(q=t)}return q},getSum=function(n){for(var t=returnNumericValue(0),q=0;q<n.length;q++)t=t.plus(returnNumericValue(n[q]));return t},joinString=function(n,t){var u="",q=0,r=_runtimeToString(n[q]);return t||(u=r,q=1,r=_runtimeToString(n[q])),jQuery.each(n,function(n,t){n>q&&(r+=u+_runtimeToString(t))}),r},insertTextInPosition=function(n,t,q){var r=n.substr(0,q),u=n.substr(q);return r.concat(t,u)},runtimeDatesComparison=function(n){if(n[0]=returnDateValue(n[0]),n[1]=returnDateValue(n[1]),n[0]._type===n[1]._type)return n[0].compareTo(n[1]);var t=null,q=null;return(t===null||q===null)&&(t=n[0].getLocalTime(),q=n[1].getLocalTime()),runtimeDatesCompareTo(t,q)},runtimeDatesCompareTo=function(n,t){checkExists(n.toFloat)&&(n=n.toFloat());checkExists(t.toFloat)&&(t=t.toFloat());var q=n>t;if(q===!0)q=1;else{var r=n===t;q=r?0:-1}return q},addDateCalculator=function(n,t,q){return checkExists(n)?addDateCalculatorInternal(n,t,q):null},addDateCalculatorInternal=function(n,t,q){if(n._type==="date"||n._type==="time")return n.add(t,q);Date.$units={ms:1,second:1e3,minute:6e4,hour:36e5,day:864e5,week:6084e5,month:26784e5,year:31536e6};var u=Date.$units[t||"day"],r=n.getTimezoneOffset();return n.setTime(returnNumericValue(n.getTime()).plus(q.times(u)).toString()),r!==n.getTimezoneOffset()&&n.setTime(n.getTime()+(n.getTimezoneOffset()-r)*6e4),n},dateStartEndCalculator=function(n,t,q){return checkExists(n)?dateStartEndCalculatorInternal(n,t,q):null},dateStartEndCalculatorInternal=function(n,t,q){if(q)switch(t){case"month":n.setDate(1);break;case"quarter":var u=n.getMonth(),f=Math.floor(u/3+1),e=(f-1)*3;n.setFullYear(n.getFullYear(),e,1);break;case"week":var r=n.getDay(),o=n.getDate()-r+(r===0?-6:1);n.setDate(1);n.increment(o-1);break;case"year":n.setFullYear(n.getFullYear(),0,1)}else switch(t){case"month":n.setDate(Date.daysInMonth(n.getMonth(),n.getFullYear()));break;case"quarter":var s=n.getMonth(),h=Math.floor(s/3+1),c=h*3-1;n.setFullYear(n.getFullYear(),c,1);n.setDate(Date.daysInMonth(n.getMonth(),n.getFullYear()));break;case"week":var l=n.getDay(),a=n.getDate()-l+7;n.setDate(1);n.increment(a-1);break;case"year":n.setFullYear(n.getFullYear(),11,31)}return n};function returnNumericValue(n){if(n instanceof Big)return n;var t,f=typeof n;switch(f){case"number":return Big(n);case"boolean":return Big(n?1:0);case"string":n.length===0&&(n=0);try{t=Big(n)}catch(e){}if(isNaN(t)||!checkExists(t)){var r=returnDateValue(n);if(runtimeIsDateType(r))try{t=Big(r.getTime())}catch(e){}if(isNaN(t)||!checkExists(t)){var q=n.toLowerCase();q==="1"||q==="true"||q==="yes"?t=Big(1):(q==="0"||q==="false"||q==="no")&&(t=Big(0))}}break;case"object":var u=returnDateValue(n);if(runtimeIsDateType(u))try{t=Big(u.getTime())}catch(e){}}if(isNaN(t)||!checkExists(t))throw'"'+n.toString()+'" is not numeric.';else return t}function returnBooleanValue(n){if(checkExists(n)){var t=n.toString().toLowerCase();return t==="true"||t==="1"||t==="yes"?!0:!1}}function returnDateValue(n,t){if(!checkExistsNotEmpty(n))return null;if(!checkExists(t)){if(runtimeIsDateType(n))return n;t="datetime"}return SCCultureHelper.Current()._convertDateStringToObj({dataType:t,value:n})}function runtimeIsDateType(n){return checkExists(n)&&(n instanceof Date||n._type==="date"||n._type==="time")}function runtimeAreAnyDateTypes(n){for(var q=n.length,t=!1;q--&&!t;)t=runtimeIsDateType(n[q]);return t}function getDateInCorrectFormat(n){return checkExists(n)?SourceCode.Forms.CultureHelper.prototype._convertDateObjToString(n):null}function getStartOfDay(n){if(!checkExists(n))return null;return getDateInCorrectFormat(n.clearTime())}var tabRegEx=/\t/g,spaceRegex=/ /g,ltRegEx=/</g,gtRegex=/>/g,singleQuoteRegex=/'/g,doubleQuoteRegex=/\"/g;function getActualControlID(n){var t=n.split("_");return t.length>2&&(n="{0}_{1}".format(t)),n}function getNonInstanceSpecificControlID(n){if(checkExistsNotEmpty(n)){var t=n.split("_");t.length>1&&(n=t[1])}return n}function getInstanceSpecificControlID(n,t){var q=null;if(checkExistsNotEmpty(t)){var r=n,u=t;checkExistsNotEmpty(n)||(r=_runtimeEmptyGuid);var f=t.split("_");f.length>1&&(u=f[1]);q=r+"_"+u}return q}function getLoopContextID(n){var t=null;return checkExists(n)&&(t=n.getAttribute("LoopID")),t}function addLoopContextData(n){if(checkExists(n)||(n={}),checkExists(n.currentNode)&&checkExistsNotEmpty(n.viewID)&&(checkExistsNotEmpty(n.counterToAdd)||checkExistsNotEmpty(n.itemToAdd))){var t=getLoopContextID(n.currentNode);checkExistsNotEmpty(t)||(t=String.generateGuid(),n.currentNode.setAttribute("LoopID",t));checkExists(_runtimeLoopContextData[t])||(_runtimeLoopContextData[t]={});var q=n.viewID;checkExistsNotEmpty(n.instanceID)||(n.instanceID=_runtimeEmptyGuid);q+="_"+n.instanceID;checkExistsNotEmpty(n.controlID)&&(q+="_"+getNonInstanceSpecificControlID(n.controlID));checkExists(_runtimeLoopContextData[t][q])||(_runtimeLoopContextData[t][q]={});checkExistsNotEmpty(n.counterToAdd)&&(_runtimeLoopContextData[t][q].counter=n.counterToAdd);checkExistsNotEmpty(n.itemToAdd)&&(_runtimeLoopContextData[t][q].item=n.itemToAdd)}}function copyLoopContextData(n){if(checkExists(n)||(n={}),checkExists(n.currentNode)&&checkExistsNotEmpty(n.loopContextIdToCopyFrom)){var t=getLoopContextID(n.currentNode);checkExistsNotEmpty(t)||(t=String.generateGuid(),n.currentNode.setAttribute("LoopID",t));checkExists(_runtimeLoopContextData[t])||(_runtimeLoopContextData[t]={});var r=_runtimeLoopContextData[n.loopContextIdToCopyFrom];for(var q in r)checkExists(_runtimeLoopContextData[t][q])||(_runtimeLoopContextData[t][q]={}),_runtimeLoopContextData[t][q]=jQuery.extend(!0,{},_runtimeLoopContextData[t][q],r[q])}}function removeLoopContextData(n){checkExists(n)||(n={});checkExists(n.loopContextID)&&checkExists(_runtimeLoopContextData[n.loopContextID])&&delete _runtimeLoopContextData[n.loopContextID]}function getExportToExcelData(n){var t={};if(n=checkExists(n)?n:{},checkExistsNotEmpty(n.viewId)){n.instanceId=checkExistsNotEmpty(n.instanceId)?n.instanceId:_runtimeEmptyGuid;var q=n.viewId+"_"+n.instanceId;t=checkExists(_runtimeExportToExcelData[q])?_runtimeExportToExcelData[q]:{}}return t}function setExportToExcelData(n){if(n=checkExists(n)?n:{},checkExistsNotEmpty(n.viewId)&&checkExists(n.data)){n.instanceId=checkExistsNotEmpty(n.instanceId)?n.instanceId:_runtimeEmptyGuid;var t=n.viewId+"_"+n.instanceId;_runtimeExportToExcelData[t]=n.data}}function removeExportToExcelData(n){if(n=checkExists(n)?n:{},checkExistsNotEmpty(n.viewId)){n.instanceId=checkExistsNotEmpty(n.instanceId)?n.instanceId:_runtimeEmptyGuid;var t=n.viewId+"_"+n.instanceId;checkExists(_runtimeExportToExcelData[t])&&delete _runtimeExportToExcelData[t]}}function returnInstanceXP(n,t,q,r,u){var f="";return checkExists(n)&&(r?f+="[":t&&(f=" and "),q?(u||(f+="(not (@SourceInstanceID) or "),f+="@SourceInstanceID='"+n+"'",u||(f+=")")):(u||(f+="(not (@InstanceID) or "),f+="@InstanceID='"+n+"'",u||(f+=")")),r&&(f+="]")),f}function SFRuntimeBrowserDetection(){var t=navigator.userAgent.toLowerCase(),n=$(document.documentElement),q=parseInt((/msie (\d+)/.exec(t)||[])[1]);if(isNaN(q)&&(q=parseInt((/trident\/.*; rv:(\d+)/.exec(t)||[])[1])),q>0&&(n.addClass("msie"),n.addClass("ie"+q.toString()),!!document.documentMode)){var r=parseInt(document.documentMode,10);n.addClass("ie-document-mode-"+r.toString());evalCommon("SourceCode.Forms.Settings.Compatibility.LegacyBrowserSupport")!==null&&SourceCode.Forms.Settings.Compatibility.LegacyBrowserSupport&&r<9&&SFLog({type:4,category:"Helper",source:"SFRuntimeBrowserDetection",message:"The attached page targets IE document mode 8 (or earlier), or is running in IE8 (or earlier). Some APIs and features may not be available. Errors are to be expected. See the K2 smartforms Compatibility Matrix (http://k2.com/help/K2forSP/WebPart/MoreInfo) for more."})}!window.opera&&t.indexOf(" opr/")===-1||(n.addClass("opera"),t.indexOf("webkit")&&n.addClass("webkit"));!window.chrome||t.indexOf("chrome")===-1||t.indexOf(" opr/")!==-1||n.addClass("webkit chrome");(typeof InstallTrigger!="undefined"||t.indexOf("firefox")!==-1)&&n.addClass("mozilla firefox");_runtimeSafariRegex.test(t)&&n.addClass("webkit safari");_runtimeAppleMobileRegex.test(navigator.userAgent)&&n.addClass("mobile");SourceCode.Forms.BorderBox.featureDetectionRun||SourceCode.Forms.BorderBox.runFeatureDetection();SourceCode.Forms.BorderBox.nativeBorderBoxSupport||n.addClass("no-border-box-support")}function SFRuntimeHash(){this._hash={}}$.extend(SFRuntimeHash.prototype,{_getObject:function(n,t){var q=this._hash;if(typeof n=="object"&&checkExists(n)&&n.constructor===Array){q=this._hash;for(var s=n.length,o=!1,u=0;u<s;u++){var r=n[u];if(o===!0)q[r]={},q=q[r];else{var f=q[r];if(typeof f=="undefined")if(t===!0)q[r]={},q=q[r],o=!0;else{q=f;break}else q=f}}}else{var e=q[n];typeof e=="undefined"&&(q[n]={},e=q[n]);q=e}return q},get:function(n){var t=this._getObject(n);if(typeof t!="undefined"&&typeof t.value!="undefined")return t.value},tryGet:function(n,t){var q=this._getObject(n);return typeof q!="undefined"&&typeof q.value!="undefined"?(t.value=q.value,!0):!1},add:function(n,t){this._getObject(n,!0).value=t},remove:function(n){var t=this._getObject(n);typeof t!="undefined"&&typeof t.value!="undefined"&&delete t.value},clear:function(){this._hash={}}});function _runtimeSetPopupFirstFocus(){if(checkExists(__runtimeFormLevel)){var n=parseInt(__runtimeFormLevel,10);if(n>0){$("a, input[type!='hidden'], textarea, [tabindex][tabindex!='-1']").first().trigger("focus");$("body").on("focus.runtime",function(){$("body").off("focus.runtime");$("a, input[type!='hidden'], textarea, [tabindex][tabindex!='-1']").first().trigger("focus")})}}}var dataSourceLookup=function(n){this.initialize(n)},_dataSourceLookupPrototype={options:{xmlDoc:null,selectMultiple:!1,includeControllers:!0,includeController:!0,controllerID:null,instanceXP:null,instanceID:null,sourceControlID:null,controlID:null,contextID:null,contextType:null,originalContextID:null,associationSO:null,displaySO:null,originalProperty:null,controlDisplayTemplate:null,notRootSO:null,isComposite:null,parentControlID:null,parentControlExists:null,parentControlNotEquals:null,extendedXpath:null},initialize:function(n){this.options=jQuery.extend({},this.options,n)},constructAssociationXPath:function(){var n="";return this.options.includeControllers&&(n+="Controllers/"),this.options.includeController&&(n+="Controller",this.options.controllerID&&(n+="[@ID='"+this.options.controllerID+"']"),this.options.instanceXP&&(n+=this.options.instanceXP),this.options.instanceID&&(n+="[@InstanceID='"+this.options.instanceID+"']"),n+="/"),n+="Associations/Association",this.options.sourceControlID&&(n+=this.options.sourceControlID===!0?"[(@SourceControlID)]":"[@SourceControlID='"+this.options.sourceControlID+"']"),this.options.controlID&&(n+="[@ControlID='"+this.options.controlID+"']"),this.options.contextID&&(n+="[@ContextID='"+this.options.contextID+"']"),this.options.contextType&&(n+="[@ContextType='"+this.options.contextType+"']"),this.options.originalContextID&&(n+="[@OriginalContextID='"+this.options.originalContextID+"']"),this.options.associationSO&&(n+="[@AssociationSO='"+this.options.associationSO+"']"),this.options.displaySO&&(n+="[@DisplaySO='"+this.options.displaySO+"']"),this.options.originalProperty&&(n+="[@OriginalProperty='"+this.options.originalProperty+"']"),checkExists(this.options.controlDisplayTemplate)&&(n+=this.options.controlDisplayTemplate===!0?"[(@ControlDisplayTemplate)]":this.options.controlDisplayTemplate===!1?"[not(@ControlDisplayTemplate)]":"[@ControlDisplayTemplate='"+this.options.controlDisplayTemplate+"']"),this.options.notRootSO&&(n+="[not(@RootSO)]"),checkExists(this.options.isComposite)&&(n+=this.options.isComposite===!0?"[(@IsComposite)]":this.options.isComposite===!1?"[not(@IsComposite)]":"[@IsComposite='"+this.options.isComposite+"']"),this.options.parentControlID&&(n+="[@ParentControlID='"+this.options.parentControlID+"']"),this.options.parentControlExists&&(n+="[(@ParentControl)]"),this.options.parentControlNotEquals&&(n+="[@ParentControl != '"+this.options.parentControlNotEquals+"']"),this.options.extendedXpath&&(n+=this.options.extendedXpath),n},getDataSource:function(){var n=null;if(checkExists(this.options.xmlDoc)){var t=this.constructAssociationXPath();n=this.options.selectMultiple===!0?$mn(this.options.xmlDoc,t):$sn(this.options.xmlDoc,t)}return n}};jQuery.extend(dataSourceLookup.prototype,_dataSourceLookupPrototype);var _runtimeNodeCache=new SFRuntimeHash,_runtimeControllersXpath="Controllers{0}/",_runtimeControllerXpath="{0}Controller{1}{2}",_runtimeControlXpath="Controls/Control[@ID='{3}']",_runtimeFieldsXpath="Fields/Field[@ID='{3}']",_runtimeExpressionXpath="{0}Expressions/Expression{1}[@ID='{2}']",_runtimeValidationGroupXpath="{0}ValidationGroups/ValidationGroup{1}[@ID='{2}']",_runtimeFormParameterXpath="Parameters/FormParameters/FormParameter[@Name='{0}']",_runtimeViewParameterXpath="Parameters/Controller{0}/ViewParameters/ViewParameter[@Name='{1}']";function _runtimeControllerFindObject(n){var o=n.xmlDoc,v=n.propertySearch,q=n.instanceID;q===_runtimeEmptyGuid&&(q=null);var h=n.viewID,c=n.controlID,y=n.fieldID,p=n.expressionID,l=n.formID,w=n.groupID,b=n.viewParameter,k=n.formParameter,nt=n.dataSourceID,d=n.includeControllers;new SFRuntimeHash;var t="controller",r=[];typeof c!="undefined"&&c!==null?(t="control",r=[t,c]):typeof y!="undefined"&&y!==null?(t="field",r=[t,l,h,q,y]):typeof p!="undefined"&&p!==null?(t="expression",r=[t,l,q,p]):typeof w!="undefined"&&w!==null?(t="validationgroup",r=[t,w]):typeof k!="undefined"&&k!==null?(t="formparameter",r=[t,k]):typeof b!="undefined"&&b!==null?(t="viewparameter",r=[t,b,q]):r=[t,h,q];var u=_runtimeNodeCache.get(r);if(typeof u=="undefined"||u===null){var f="",e="",g="",qt="",s="";if(typeof o=="undefined"||o===null?t==="formparameter"||t==="viewparameter"?o=runtimeParametersDefinition:(o=viewControllerDefinition,d=!0):checkExists(d)||(d=o.childNodes[0].tagName==="Controllers"),typeof q!="undefined"&&q!==null)e="[@InstanceID='"+q+"']";else if(t==="control"){var rt=c.split("_");if(rt.length===2){var a=rt[0];typeof a!="undefined"&&a!==null&&a!==""&&a!==_runtimeEmptyGuid&&(e="[@InstanceID='"+a+"']")}}typeof h!="undefined"&&h!==null&&(g="[@ID='"+h+"']");typeof l!="undefined"&&l!==null&&(qt="[@FormID='"+l+"']");var tt=_runtimeControllerXpath+"/";if(d===!0||t==="Expression")s=_runtimeControllersXpath.format(qt);else{var ut=o.childNodes[0].tagName==="Controller";ut||t!=="control"&&t!=="field"||(tt="")}switch(t){case"control":f=(tt+_runtimeControlXpath).format(s,g,e,c);break;case"field":f=(tt+_runtimeFieldsXpath).format(s,g,e,y);break;case"expression":f=_runtimeExpressionXpath.format(s,e,p);break;case"validationgroup":f=_runtimeValidationGroupXpath.format(s,e,w);break;case"formparameter":f=_runtimeFormParameterXpath.format(k);break;case"viewparameter":f=_runtimeViewParameterXpath.format(e,b);break;default:f=_runtimeControllerXpath.format(s,g,e);typeof nt!="undefined"&&nt!==null&&(f+="[Fields/Field[@DataSourceID='"+nt+"']]")}u=o.selectSingleNode(f);_runtimeNodeCache.add(r,u)}if(t==="control"&&typeof v!="undefined"&&v!==null&&v!==""&&typeof u!="undefined"&&u!==null){var ft=$sn(u,"Properties[Property/Name='{0}']".format(v));ft||(u=null)}return u}var _runtimeFieldsDataToXml=function(n){var t=null;if(checkExistsNotEmpty(n.controlID)){var q=_runtimeControllerFindObject({controlID:n.controlID});if(checkExists(q)){var s=q.parentNode.parentNode.getAttribute("ID"),h=q.parentNode.parentNode.getAttribute("InstanceID"),f=n.controlID,e=_runtimeFieldsXmlHash[f];if(e)t=e;else{var r=$xml("<collection/>"),o=getViewHiddenHash(s,h);if(checkExists(o)){var c={controlid:n.controlID},u=o.filter(__runtimeJsonFilterMatchingItems,c);checkExists(u)&&u.length>0&&(_runtimeTransformFieldsToXml(r,u),_runtimeFieldsXmlHash[f]=r)}t=r}}}return t},_runtimeTransformFieldsToXml=function(n,t){for(var c=0;c<t.length;c++){var r=t[c],u=n.createElement("object");n.documentElement.appendChild(u);for(var q in r)q!=="fields"&&q!=="joins"&&q!=="ignoreFields"&&q!=="ignoreState"&&q!=="controlid"&&u.setAttribute(q,r[q]);var e=n.createElement("fields");u.appendChild(e);for(var o in r.fields){var f=n.createElement("field");f.setAttribute("name",o);e.appendChild(f);var s=n.createElement("value");s.appendChild(n.createTextNode(r.fields[o].value));f.appendChild(s)}if(checkExists(r.joins))for(var l=0;l<r.joins.length;l++){var h=r.joins[l],u=n.createElement("object");n.documentElement.appendChild(u);for(var q in h)q!=="fields"&&q!=="joins"&&q!=="ignoreFields"&&q!=="ignoreState"&&q!=="controlid"&&u.setAttribute(q,h[q]);u.setAttribute("join","true");var e=n.createElement("fields");u.appendChild(e);for(var o in h.fields){var f=n.createElement("field");f.setAttribute("name",o);e.appendChild(f);var s=n.createElement("value");s.appendChild(n.createTextNode(h.fields[o].value));f.appendChild(s)}}}},_runtimeTransformXmlFieldsToObject=function(n){var t={};if(checkExists(n)){for(var r=0;r<n.attributes.length;r++){var u=n.attributes[r];u.specified&&(t[u.name]=u.value)}var f=$mn(n,"fields/field"),q=f.length;for(q>0&&(t.fields={});q--;){var o=f[q].getAttribute("name"),e=$sn(f[q],"value");checkExists(e)&&(t.fields[o]={value:e.text})}}return t},_runtimeTransformXmlCollectionToJson=function(n){for(var q=[],r=$mn(n,"object"),t=0;t<r.length;t++)q.push(_runtimeTransformXmlFieldsToObject(r[t]));return q};function GetPreviousActionXml(n){var q="";if(checkExists(n)){var r=n.PreviousActionID;if(checkExistsNotEmpty(r)){var e=n.ViewID,o=n.InstanceID,u="";checkExistsNotEmpty(e)&&(u=returnInstanceXP(o,!1,!1,!0,!1));var f="//Action[@ID='"+r+"']"+u+"",t=null;checkExists(runtimeNavigatedEvents)&&(t=$mn(runtimeNavigatedEvents,f));checkExists(formBindingXml)&&(t==null||t.length===0)&&(t=$mn(formBindingXml,f));t!=null&&t.length>0&&(q=t[0].xml)}}return q};
/*!
 ~/RunTime/Script/Events.js
*/
var eventsCancelled=!1,_runtimePresetControls=[],_runtimePostInitEvents=[],_environmentFieldCache={},_runtimeErrorObjects=[],_runtimeLastUnhandledErrorID=null,_runtimeInitializeIndicatorTimeout=null,_runtimeIsInitializing=!0,_runtimeIsRendering=!0,_runtimeConditionalStylingBeingApplied=!1,_runtimeAJAXExecutionCount=0,_runtimeBehaviourExecutionCount=0,_runtimeExecBehaviorIds=[],_runtimeIdleState=!1,_runtimeLatestSerialNumber=null,_runtimeLatestWorkflowActivityName=null,_runtimeLatestWorkflowActivityDisplayName=null,_runtimeLatestWorkflowActionName=null,_runtimeLatestSerialNumberWarnings=[],SourceCode=SourceCode?SourceCode:{};SourceCode.Forms=SourceCode.Forms?SourceCode.Forms:{};SourceCode.Forms.Runtime=SourceCode.Forms.Runtime?SourceCode.Forms.Runtime:{};function raiseEvent(n,t,q,r){if(!_runtimeLoadingFromDraft){var u=function(){attemptSetItemsComplete(t.toLowerCase(),n,q.toLowerCase());testForPanelColumnSyncing(t.toLowerCase(),n,q.toLowerCase());handleEvent(n,t,q,null,r)};_runtimeIsRendering===!0?addRuntimePendingCalls(u,!1):u()}}function verifyEventHandling(n,t,q,r,u){var o=!1;if(checkExists(formBindingXml)){var s=returnInstanceXP(r,!1,!1,!0,!1),e="Events/Event[@SourceID='"+n+"'][@SourceType='"+t+"'][Name/text()="+q.xpathValueEncode()+"][@Type='User']"+s+"[@IsEnabled='true']/Handlers/Handler",f;checkExists(runtimeNavigatedEvents)?(f=$mn(runtimeNavigatedEvents,e),f.length===0&&(f=$mn(formBindingXml,e))):f=$mn(formBindingXml,e);o=examineHandlerContentForEventHandling(f,u)}return o}function examineHandlerContentForEventHandling(n,t){var u=!1;if(n.length>0){if(!checkExists(n.concat)){for(var s=[],r=0;r<n.length;r++)s.push(n[r]);n=s}for(var f=!1,r=0;r<n.length;r++){var q=n[r],a=q.getAttribute("Type");if(a==="foreach"){var v=transformForEachHandlertoIfs(q);n=n.concat(v)}else{if(t){var e=$mn(q,"Conditions/Condition");if(checkExists(e)){var h=getLoopContextID(q),o=e.length;if(o>0){var c=q.getAttribute("OriginalEventType");for(checkExists(c)&&c!=="System"&&fireExpressions(!0);o--;)if(f=validateConditions(e[o],null,h),f===!0)break}else f=!0;removeLoopContextData({loopContextID:h})}}if(f===!0||!t){var y=$mn(q,"Actions/Action[@Type!='Handler']");if(y.length>0){u=!0;break}else{var l=$mn(q,"Actions/Action[@Type='Handler']/Handlers/Handler");if(l.length>0&&(u=examineHandlerContentForEventHandling(l,t),u===!0))break}}}}}return u}function transformForEachHandlertoIfs(n){var e=[];if(checkExists(n)){var t=$sn(n,"Function");if(checkExists(t)&&t.childNodes.length>0){var h=t.childNodes[0].tagName,o=evalFunction(h);if(checkExists(o)){var r=o(t);if(checkExists(r)&&r.length>0)for(var c=t.getAttribute("InstanceID"),s=getLoopContextID(n),l=checkExistsNotEmpty(s),f=0;f<r.length;f++){var u=r[f],a=u.counter,v=u.viewID,y=u.controlID,q=n.cloneNode(!0);l&&(q.removeAttribute("LoopID"),copyLoopContextData({currentNode:q,loopContextIdToCopyFrom:s}));q.setAttribute("Type","if");addLoopContextData({currentNode:q,counterToAdd:a,itemToAdd:u.item,viewID:v,instanceID:c,controlID:y});e.push(q)}}}}return e}function handleEvent(n,t,q,r,u,f,e,o,s,h,c,l){if(!_runtimeLoadingFromDraft&&eventsCancelled!==!0){SFLog({type:3,source:"handleEvent",category:"Events",message:"{2} event fired from {1} - {0}",parameters:[n,t,q]});var b="Events/Event[@SourceID='"+n+"'][@SourceType='"+t+"'][Name/text()="+q.xpathValueEncode()+"]";checkExists(o)&&o===!0||(b+="[not(@SubformID)]");checkExists(u)&&(b+="[@InstanceID='"+u+"']");checkExists(c)&&(b+="[@DefinitionID='"+c+"']");for(var v=[],tt=$mn(formBindingXml,b),k=[],y=[],d=null,p="",nt=0;nt<tt.length;)d=tt[nt],p=d.getAttribute("Type"),typeof p!="undefined"&&p!==null&&p!==""&&(p==="System"?k.push(d):p==="User"&&y.push(d)),nt++;for(var qt=k.length;qt--;)v=constructHandlersForBehaviour(k[qt],v,o,"System",l);var w=[];checkExists(runtimeNavigatedEvents)&&(w=$mn(runtimeNavigatedEvents,b+"[@Type='User']"));for(var rt=w.length;rt--;)v=constructHandlersForBehaviour(w[rt],v,o,"Navigate",l);if(w.length===0)for(var ut=y.length;ut--;)v=constructHandlersForBehaviour(y[ut],v,o,"User",l);else y=[];var a=k.length>0?k[0]:w.length>0?w[0]:y.length>0?y[0]:null;if(q==="Init"&&v.length>0&&checkExists(a)&&(t==="View"||t==="Form")){var st=function(){handleEvent(n,t,"PostInit",null,a.getAttribute("InstanceID"),null,null,null,null,null,null,l)};_runtimePostInitEvents.push(st)}var ft=SourceCode.Forms.Runtime.getMasterRuntimeWindow(),g=null;v.length>0&&(g=ft.jQuery.Deferred());var et=!1;if(checkExists(a)){var ot=a.getAttribute("SingleSpinner");checkExists(ot)&&ot.toUpperCase()==="TRUE"&&(et=!0)}var ht={methodExecuted:q,handlers:v,SourceID:n,SourceType:t,SubformID:a?a.getAttribute("SubformID"):null,InstanceID:a?a.getAttribute("InstanceID"):null,TransferredID:a?a.getAttribute("TransferredID"):null,IsAsync:r,isInit:f,parentBehaviour:e,popup:s,closeOptions:h,closeEvent:o,deferred:g,singleSpinner:et,windowToUse:window.self},ct=new ft.SourceCode.Forms.Runtime.BehaviourEvent(ht);return ct.executeBehaviour(),g?g.promise():void 0}}function constructHandlersForBehaviour(n,t,q,r,u){if(eventsCancelled!==!0){for(var s=$mn(n,"Handlers/Handler"),e=0;e<s.length;e++){var f=s[e].cloneNode(!0),c=f.getAttribute("Type");if(copyLoopContextData({currentNode:f,loopContextIdToCopyFrom:u}),c==="foreach"&&q)for(var h=transformForEachHandlertoIfs(f),o=0;o<h.length;o++){var l=constructHandlerPartsForBehaviour(h[o],q,r);t.push(l)}else f=constructHandlerPartsForBehaviour(f,q,r),t.push(f)}return t}}function constructHandlerPartsForBehaviour(n,t,q){if(t)for(var f=getLoopContextID(n),u=$mn(n,"Actions/Action[Parameters/Parameter]"),r=0;r<u.length;r++)populateParameterValuesForNavigation(u[r],!0,!0,!1,!0,f);return checkExists(q)&&n.setAttribute("OriginalEventType",q),n}(function(){SourceCode.Forms.Runtime.BehaviourEvent=function(n){this.initialize(n)};var n={windowToUse:null,runtimeInstanceName:null,initialize:function(n){this.id=String.generateGuid();this.options=jQuery.extend({},n);this.actions=this.options.actions?this.options.actions:[];this.SourceID=this.options.SourceID?this.options.SourceID:"";this.SourceType=this.options.SourceType?this.options.SourceType:"";this.InstanceID=this.options.InstanceID?this.options.InstanceID:null;this.SubformID=this.options.SubformID?this.options.SubformID:null;this.TransferredID=this.options.TransferredID?this.options.TransferredID:null;this.IsAsync=checkExists(this.options.IsAsync)?this.options.IsAsync:!0;this.isExecuting=!1;this.xmlPackage=[];this.hasSingleExecution=!1;this.isInit=checkExists(this.options.isInit)?this.options.isInit:!1;this.parentBehaviour=checkExists(this.options.parentBehaviour)?this.options.parentBehaviour:null;this.handlers=this.options.handlers?this.options.handlers:[];this.previousHandlerResult=checkExists(this.options.previousHandlerResult)?this.options.previousHandlerResult:!0;this.methodExecuted=this.options.methodExecuted?this.options.methodExecuted:"";this.popup=this.options.popup?this.options.popup:null;this.closeOptions=this.options.closeOptions;this.closeEvent=this.options.closeEvent;this.errorHandler=null;this.deferred=this.options.deferred?this.options.deferred:null;this.parentHandlers=[];this.previousActions=[];this.singleSpinner=checkExists(this.options.singleSpinner)?this.options.singleSpinner:!1;this.windowToUse=this.options.windowToUse?this.options.windowToUse:window.self;this.runtimeInstanceName=this.windowToUse.SourceCode.Forms.Runtime.getRuntimeInstanceName();this.batchedActions=[]},showRuntimeInitSpinner:function(){this.windowToUse._runtimeInitializeOverlay&&(checkExists(this.windowToUse._runtimeInitializeIndicatorDelay)&&this.windowToUse._runtimeInitializeIndicatorDelay>0?this.windowToUse._runtimeInitializeIndicatorTimeout=setTimeout(function(){checkExists(this.windowToUse.popupManager)&&checkExists(this.windowToUse.popupManager.popUps)&&this.windowToUse.popupManager.popUps.length!==0||this.windowToUse.runtimeShowBusyOverlay({isInitSpinner:!0,showSpinner:this.windowToUse._runtimeInitializeBusyIndicator})}.bind(this),this.windowToUse._runtimeInitializeIndicatorDelay):this.windowToUse.runtimeShowBusyOverlay({isInitSpinner:!0,showSpinner:this.windowToUse._runtimeInitializeBusyIndicator}));this.windowToUse._runtimeInitSpinner=!0},hideRuntimeInitSpinner:function(){hideRuntimeInitSpinnerForWindow(this.windowToUse)},executeBehaviour:function(){if(!_runtimeLoadingFromDraft){var t=SourceCode.Forms.Runtime.getRuntimeDataProperty(this.runtimeInstanceName,"windowContextValid")===!0,n=null;for(this.singleSpinner&&runtimeShowBusyOverlay({showSpinner:!0}),updateExecutionTracker(null,1,this.id);!this.isExecuting;){if(t=SourceCode.Forms.Runtime.getRuntimeDataProperty(this.runtimeInstanceName,"windowContextValid")===!0,(this.stopped||!t)&&(this.actions=[],this.handlers=[],this.parentHandlers=[],this.previousActions=[],this.stopped&&(this.parentBehaviour!=null&&(this.parentBehaviour.stopped=!0),this.openBehaviour!=null&&(this.openBehaviour.stopped=!0)),t||SFLog({type:5,source:"executeBehaviour",category:"Events",message:"Context invalid on window {0}, {1} event stopped executing".format(this.runtimeInstanceName,this.SourceID)})),this.actions.length>0){this.isInit&&typeof this.windowToUse._runtimeInitSpinner!="undefined"&&this.windowToUse._runtimeInitSpinner===!1&&(this.windowToUse.jQuery("#__runtimeStatus").text("initializing"),this.showRuntimeInitSpinner());this.isExecuting=!0;n=this.actions.shift();var nt=n.getAttribute("SubformID");checkExistsNotEmptyGuid(nt)&&(n=populateSubformContext(n,nt));var o=this.windowToUse.getWindowToUse(n),e=n.getAttribute("ExecutionType");if(this.singleExecution=!1,this.otherSingleActions=!1,this.nextParallelAction=!1,this.actions.length>0)switch(this.actions[0].getAttribute("ExecutionType")){case"Single":this.otherSingleActions=!0;break;case"Parallel":this.nextParallelAction=!0}if(e==="Single"){if(this.singleExecution=!0,checkExists(this.xmlPackage)&&this.xmlPackage.length>0)for(var ht=this.xmlPackage.length,u=0;u<ht;u++)if(this.xmlPackage[u].smartobject&&this.xmlPackage[u].smartobject.results&&this.xmlPackage[u].metadata.typeofview!=="List")for(var a=this.xmlPackage[u].smartobject.results,s=0;s<a.length;s++)if(a[s].targetType=="ViewField"){var ct=n.getAttribute("InstanceID"),lt=a[s].targetID;setHiddenFieldValue(lt,"",null,ct)}var h=o.executeAction(n,this.methodExecuted,!0,null,this.windowToUse);checkExistsNotEmpty(h)&&!h.always&&(this.xmlPackage=this.xmlPackage.concat(h),this.batchedActions=extendBatchedActions(this.batchedActions,h,n));this.otherSingleActions===!0?this.isExecuting=!1:this.singleExecution===!0&&this.otherSingleActions===!1&&(this.xmlPackage.length>0?(this.windowToUse.sendPacket(this.xmlPackage,this,this.batchedActions),this.xmlPackage=[],this.batchedActions=[]):(this.singleExecution=!1,this.isExecuting=!1))}else if(this.singleExecution)this.actions.push(n.cloneNode(!0));else if(e==="Asynchronous"||e==="Parallel"){if(e==="Asynchronous"){var f=this;$.when(o.executeAction(n,f.methodExecuted,!1,null,f.windowToUse)).fail(function(){f.handleError.apply(f,arguments)});this.isExecuting=!1}else if(e==="Parallel")if(checkExists(this.parallelActions)||(this.parallelActions=[]),this.parallelActions.push(o.executeAction(n,this.methodExecuted,!1)),!this.nextParallelAction&&this.parallelActions!=null&&this.parallelActions.length>0){var f=this;$.when.apply($,this.parallelActions).done(function(){parallelActionsDone(f)}).fail(function(){parallelActionsFailed.apply(f,arguments)});break}else this.isExecuting=!1}else o.executeAction(n,this.methodExecuted,!1,this,this.windowToUse)}else if(this.actions.length===0&&this.handlers.length>0){var q=this.handlers.shift(),r=q.getAttribute("Type");if(r==="error")while(this.handlers.length>0&&r==="error")q=this.handlers.shift(),r=q.getAttribute("Type");if(r==="foreach"){var at=this.windowToUse.transformForEachHandlertoIfs(q);this.handlers=at.concat(this.handlers)}if(r==="if"||r==="always"||this.previousHandlerResult===!1&&r==="else"){var v=getLoopContextID(q),c=!0,tt=[],y=$mn(q,"Conditions/Condition");if(checkExists(y)){var p=y.length;if(p>0){var l=q.getAttribute("OriginalEventType");for(checkExists(l)&&l!=="System"&&this.windowToUse.fireExpressions(!0);p--;){var vt=y[p].cloneNode(!0);if(c=this.windowToUse.validateConditions(vt,null,v,this),c===!1)break}}}if(c===!0){var qt=$mn(q,"Actions/Action"),rt=qt.length;if(rt>0)for(var w=0;w<rt;w++){var b=qt[w].cloneNode(!0),l=q.getAttribute("OriginalEventType");checkExists(l)&&b.setAttribute("OriginalEventType",l);this.windowToUse.copyLoopContextData({currentNode:b,loopContextIdToCopyFrom:v});tt.push(b)}}this.wfConditionError?this.wfConditionError=null:this.actions=tt;this.previousHandlerResult=c;this.windowToUse.removeLoopContextData({loopContextID:v})}this.isExecuting=!1}else if(this.actions.length===0&&this.handlers.length===0&&this.parentHandlers!=null&&this.parentHandlers.length>0)this.previousHandlerResult=!0,this.evaluateContinueParentHandlers?(this.parentHandlers=[],this.previousActions=[]):(this.handlers=this.parentHandlers.pop(),this.actions=this.previousActions.pop()),this.isExecuting=!1;else if(t&&this.isInit&&this.actions.length===0&&this.handlers.length===0&&(this.windowToUse.persistedActions!==null&&this.windowToUse.persistedActions.length>0||this.windowToUse._runtimePersistedHandlers!==null&&this.windowToUse._runtimePersistedHandlers.length>0)){var k=this.windowToUse.persistedActions;k!==null&&k.length>0&&(this.actions=k);var d=this.windowToUse._runtimePersistedHandlers;d!==null&&d.length>0&&(this.handlers=d);this.windowToUse.persistedActions=null;this.windowToUse._runtimePersistedHandlers=null;this.previousHandlerResult=!0;this.isExecuting=!1}else if(this.actions.length===0&&this.parentBehaviour!=null){var ut=this.parentBehaviour;ut.isExecuting=!1;this.parentBehaviour=null;ut.executeBehaviour()}else if(this.actions.length===0&&this.openBehaviour!=null){var ft=this.openBehaviour;ft.isExecuting=!1;this.openBehaviour=null;ft.executeBehaviour()}else if(t&&this.isInit&&this.windowToUse._runtimeIsInitializing){if(this.windowToUse._runtimeIsInitializing=!1,this.windowToUse.runtimePendingCallsAfterInit!=null){for(var g=0;g<this.windowToUse.runtimePendingCallsAfterInit.length;g++)this.windowToUse.runtimePendingCallsAfterInit[g]();this.windowToUse.runtimePendingCallsAfterInit=[]}this.hideRuntimeInitSpinner();this.windowToUse.jQuery("#__runtimeStatus").text("initialized");this.windowToUse.PFSuccess("K2 SmartForms - Runtime Web Client","Runtime Client Initialize",this.windowToUse.currentForm.toLowerCase());this.isExecuting=!1}else if(t&&this.windowToUse._runtimePresetControls.length===0&&!this.windowToUse._runtimeIsInitializing&&this.windowToUse._runtimePostInitEvents.length>0)this.windowToUse.executePostInits(),this.isExecuting=!1;else if(this.popup!=null){t=!1;var et=SourceCode.Forms.Runtime.getRuntimeInstanceName(this.popup);SourceCode.Forms.Runtime.removeRuntimeDataProperty(et,"windowContextValid");SourceCode.Forms.Runtime.removeRuntimeDataProperty(et,"windowContext");completePopupClosing(this.popup,this.closeOptions);this.popup=null}else this.deferred!=null&&(this.deferred.resolve(),this.deferred=null);if(!(this.actions.length>0)&&(this.actions.length!==0||!(this.handlers.length>0))&&(this.actions.length!==0||this.handlers.length!==0||this.parentHandlers==null||!(this.parentHandlers.length>0))&&(this.actions.length!==0||this.parentBehaviour==null)&&(this.actions.length!==0||this.openBehaviour==null)&&this.popup==null&&this.deferred==null&&(!t||!(this.isInit&&this.actions.length===0&&this.handlers.length===0&&this.windowToUse.persistedActions!=null&&this.windowToUse.persistedActions.length>0||this.isInit&&this.actions.length===0&&this.handlers.length===0&&this.windowToUse._runtimePersistedHandlers!=null&&this.windowToUse._runtimePersistedHandlers.length>0||this.isInit&&this.windowToUse._runtimeIsInitializing)))break}if(t=SourceCode.Forms.Runtime.getRuntimeDataProperty(this.runtimeInstanceName,"windowContextValid")===!0,this.isExecuting||updateExecutionTracker(null,-1,this.id),t&&this.singleSpinner&&!this.isExecuting){var ot=!0;if(checkExists(n)){var st=n.getAttribute("OldType");checkExists(st)&&st==="Navigate"&&(ot=!1)}ot&&this.windowToUse.runtimeHideBusyOverlay()}}},handleError:function(){if(this.errorType=arguments[0],this.errorArguments=arguments,checkExists(this.parallelActions)&&this.parallelActions.length>0&&(this.parallelActions=null),checkExists(this.errorType)){var a=[],tt=!1,q=this.errorID;if(checkExists(q))this.errorID=null;else{q=String.generateGuid();var n={category:this.errorType};switch(this.errorType){case"custom":n=arguments[1];break;case"ajax":n.message=Resources.Runtime.AjaxError;n.detail="["+arguments[1].status+"] "+arguments[1].statusText+" ("+arguments[2]+")";break;case"exc":case"auth":var u=arguments[1].documentElement,s=u.selectSingleNode("DisplayMessage");checkExists(s)||(s=u.selectSingleNode("Message"));checkExists(s)&&(n.message=s.text);var qt=u.selectSingleNode("Type");checkExists(qt)&&(n.type=qt.text);var st=u.getAttribute("ExtendedDetail")==="T";if(st){var rt=u.selectSingleNode("StackTrace");rt&&(n.detail=rt.text)}break;case"wf":n.message=Resources.Runtime.WorkflowNotExecuted;break;case"email":n.message=Resources.RuntimeMessages.ErrorEmailNotSent;break;case"noxml":n.message=arguments[2];n.detail=arguments[3];break;case"itemref":n.message=Resources.RuntimeMessages.WorkflowItemReferenceNotFound;break;case"openxmlnotfound":n.message=constructOpenXmlNotFoundErrorMessage()}var ut=SourceCode.Forms.Runtime.getMasterRuntimeWindow();ut._runtimeErrorObjects[q]=n}var v=this.wfVariableLoading||this.wfConditionError;if(checkExists(this.actions)&&this.actions.length>0){var h=this.actions.shift(),ht=getLoopContextID(h),ct=h.getAttribute("Type");ct==="Handler"&&(checkExists(this.handlers)&&(this.parentHandlers.push(this.handlers),this.previousActions.push(this.actions),this.actions=[]),this.handlers=constructHandlersForBehaviour(h,[],this.closeEvent,h.getAttribute("OriginalEventType"),ht))}if(checkExists(this.handlers)&&this.handlers.length>0){for(var t=this.handlers.shift(),c=t.getAttribute("Type");c!=="error"&&this.handlers.length>0;)t=this.handlers.shift(),c=t.getAttribute("Type");while(c==="error"&&!checkExists(this.errorHandler)){var y=!0,ft=$mn(t,"//*[@SourceType='SystemVariable']"),p=ft.length;if(p>0)while(p--)ft[p].setAttribute("SourceErrorID",q);var w=$mn(t,"Conditions/Condition");if(checkExists(w)){var b=w.length;if(b>0){var l=t.getAttribute("OriginalEventType");for(checkExists(l)&&l!=="System"&&this.windowToUse.fireExpressions(!0);b--;)if(y=this.windowToUse.validateConditions(w[b],null,null,this),y===!1)break}}if(y===!0){this.errorHandler=t;var f=$mn(t,"Actions/Action");if(f.length>0)for(var e=0;e<f.length;e++){f[e].getAttribute("Type")==="Continue"&&(tt=!0);f[e].getAttribute("Type")==="Handler"&&(this.evaluateContinueParentHandlers=!0);var et=f[e].cloneNode(!0),l=t.getAttribute("OriginalEventType");checkExists(l)&&et.setAttribute("OriginalEventType",l);a.push(et)}}else if(this.handlers.length>0)t=this.handlers.shift(),c=t.getAttribute("Type");else break}}if(a.length>0)this.errorSource={sourceID:this.SourceID,instanceID:this.InstanceID,sourceType:this.SourceType},this.actions=a,this.previousHandlerResult=!0,tt||this.evaluateContinueParentHandlers||(this.handlers=[]),this.errorHandler=null,v?(this.wfConditionError=!0,this.wfVariableLoading=null):(this.isExecuting=!1,this.executeBehaviour());else if(checkExists(this.parentHandlers)&&this.parentHandlers.length>0)this.handlers=this.parentHandlers.pop(),this.actions=this.previousActions.pop(),this.handleError.apply(this,arguments);else{if(this.popup!=null&&this.closeEvent){windowContextValid=!1;var ot=SourceCode.Forms.Runtime.getRuntimeInstanceName(this.popup);SourceCode.Forms.Runtime.removeRuntimeDataProperty(ot,"windowContextValid");SourceCode.Forms.Runtime.removeRuntimeDataProperty(ot,"windowContext");completePopupClosing(this.popup,this.closeOptions);this.popup=null}if(checkExists(this.parentBehaviour))this.parentBehaviour.wfConditionError=v,this.parentBehaviour.errorSource={sourceID:this.SourceID,instanceID:this.InstanceID,sourceType:this.SourceType},this.parentBehaviour.errorID=q,this.parentBehaviour.handleError.apply(this.parentBehaviour,arguments);else if(checkExists(this.openBehaviour))this.openBehaviour.wfConditionError=v,this.openBehaviour.errorSource={sourceID:this.SourceID,instanceID:this.InstanceID,sourceType:this.SourceType},this.openBehaviour.errorID=q,this.openBehaviour.handleError.apply(this.openBehaviour,arguments);else{updateExecutionTracker(null,-1,this.id);this.isInit&&this.windowToUse._runtimeIsInitializing&&this.windowToUse._runtimeInitSpinner&&this.hideRuntimeInitSpinner();var k,d,g;checkExists(this.errorSource)?(k=this.errorSource.sourceID,d=this.errorSource.instanceID,g=this.errorSource.sourceType):(k=this.SourceID,d=this.InstanceID,g=this.SourceType);var o=this.windowToUse.findErrorEvent(k,g,d);if(checkExists(o)){var nt=this.windowToUse;SourceCode.Forms.Settings.BubbleErrorsToBaseContext===!0&&(nt=o.windowToUse);nt._runtimeLastUnhandledErrorID=q;nt.handleEvent(o.sourceID,o.sourceType,"OnError",null,o.instanceID,null,null,null,null,null,null,arguments[5])}else switch(this.errorType){case"ajax":handleAJAXError(arguments[1],arguments[2],arguments[3],arguments[4]);break;case"auth":SourceCode.Forms.ExceptionHandler.handleAuthenticationException(arguments[1]);break;case"exc":SourceCode.Forms.ExceptionHandler.handleException(arguments[1]);break;case"wf":masterPopupManager.showWarning(Resources.Runtime.WorkflowNotExecuted);break;case"email":masterPopupManager.showError(Resources.RuntimeMessages.ErrorEmailNotSent);break;case"custom":var r=arguments[1],lt=checkExists(r.type)?r.type:"",at=checkExists(r.detail)?r.detail:"",vt=checkExists(r.message)?r.message:"",yt={showHeaderButtons:!0,headerText:lt,message:at,title:vt,type:"error"};masterPopupManager.showMessage(yt);break;case"noxml":var ut=SourceCode.Forms.Runtime.getMasterRuntimeWindow();this.showErrorPopupOptionsForNoXml(ut._runtimeErrorObjects[q]);break;case"redirect":handleRedirectError(arguments[4]);break;case"itemref":masterPopupManager.showError(Resources.RuntimeMessages.WorkflowItemReferenceNotFound);break;case"openxmlnotfound":masterPopupManager.showError(constructOpenXmlNotFoundErrorMessage())}}}}},showErrorPopupOptionsForNoXml:function(n){var t=checkExists(n.message)?n.message.toString():"",q=checkExists(n.detail)?n.detail.toString().htmlEncode():"";if(t.toLowerCase()==="parsererror")options={headerText:Resources.MessageBox.Error,message:Resources.RuntimeMessages.ErrorInvalidCharsInXml.format(this.SourceType),messageDetail:q,showHeaderButtons:!1,type:"error",draggable:!0,resizable:!0,width:400,height:150},masterPopupManager.showExtendedMessage(options);else{var r="{0}<br /><br >{1} ({2})".format(Resources.Runtime.AjaxError,q,t);masterPopupManager.showError(r)}}};jQuery.extend(SourceCode.Forms.Runtime.BehaviourEvent.prototype,n)})();function hideRuntimeInitSpinnerForWindow(n){checkExists(n)||(n=window.self);n._runtimeInitSpinner&&(n._runtimeInitializeOverlay&&(checkExists(n._runtimeInitializeIndicatorTimeout)&&(clearTimeout(n._runtimeInitializeIndicatorTimeout),n._runtimeInitializeIndicatorTimeout=null),n.runtimeHideBusyOverlay()),n._runtimeInitSpinner=!1)}var parallelActionsDone=function(n){checkExists(n)&&(checkExists(n.parallelActions)&&n.parallelActions.length>0&&(n.parallelActions=null),n.isExecuting=!1,n.executeBehaviour())},parallelActionsFailed=function(){checkExists(this.handleError)&&this.handleError.apply(this,arguments)};function findErrorEvent(n,t,q,r){var c=window,a=null,u=!1,f=!0,e="OnError",o="View",s="Form";if(r===!0)if(_runtimeCallerType===o){t=o;var h="Controllers/Controller",l=$sn(viewControllerDefinition,h);checkExists(l)&&(n=l.getAttribute("ID"),u=verifyEventHandling(n,t,e,q,f))}else t=s,n=currentForm,u=verifyEventHandling(n,t,e,q,f);else if(checkExists(n)||checkExists(t)){if(u=verifyEventHandling(n,t,e,q,f),!u&&t!==o&&t!==s){var h=null;if(_runtimeCallerType===o?h="Controllers/Controller":checkExists(q)&&(h="Controllers/Controller[@InstanceID='{0}']".format(q)),checkExists(h)){var l=$sn(viewControllerDefinition,h);l&&(n=l.getAttribute("ID"),n!==_runtimeEmptyGuid&&(t=o,u=verifyEventHandling(n,t,e,q,f)))}}u||t===s||_runtimeCallerType!==s||(t=s,n=currentForm,q=null,u=verifyEventHandling(n,t,e,q,f));u||SourceCode.Forms.Settings.BubbleErrorsToBaseContext!==!0||(c=SourceCode.Forms.Runtime.getMasterRuntimeWindow(),c!=window&&(a=c.findErrorEvent(null,null,null,!0)))}else t=_runtimeCallerType,n=currentForm,q=null,u=verifyEventHandling(n,t,e,q,f);return u&&(a={sourceID:n,instanceID:q,sourceType:t,windowToUse:c}),a}function testForPanelColumnSyncing(n,t,q){if(n==="control"&&q==="onfocus"){var r=t.split("_")[1],u=$sn(viewControllerDefinition,"Controllers/Controller[@PanelID='"+r+"']");checkExists(u)&&syncColumnWidthsOnPanel(r)}}function attemptSetItemsComplete(n,t,q){n==="control"&&q==="onsetitemscompleted"&&_runtimePresetControls.length>0&&_runtimePresetControls.indexOf(t)>-1&&_runtimePresetControls.splice(_runtimePresetControls.indexOf(t),1)}function executePostInits(){if(_runtimePostInitEvents.length>0){var t=_runtimePostInitEvents;_runtimePostInitEvents=[];for(var n=0;n<t.length;n++)t[n]()}}function dataTransferAction(n,t,q){for(var f=getLoopContextID(n),c=n.getAttribute("ViewID"),l=n.getAttribute("InstanceID"),e=n.getAttribute("ControlID"),r=$mn(n,"Parameters/Parameter"),u=r.length;u--;){var o=returnSourceValue({item:r[u],context:e,loopContextID:f,behaviour:q}),s=r[u].getAttribute("SourceType"),h=r[u].getAttribute("SourceID");updateTargetWithValue(n,q,r[u],window.self,h,s,o,t)}listRefreshCache.length>0&&updateAllListDisplays(f);endActionExecution({loopContextID:f,behaviour:q})}function updateTargetWithValue(n,t,q,r,u,f,e){var v=getLoopContextID(n),h=q.getAttribute("TargetSubFormID");checkExistsNotEmptyGuid(h)?q=populateSubformContext(q,h):h=q.getAttribute("TargetTransferredID");var s=q.getAttribute("TargetInstanceID"),y=q.getAttribute("TargetRuntimeContextID"),c=n.getAttribute("ViewID"),b=n.getAttribute("ControlID"),dt=q.getAttribute("TargetType"),o=q.getAttribute("TargetID"),ft=q.getAttribute("TargetPath"),et=checkExists(s)?"[@InstanceID='"+s+"']":"";switch(dt){case"Control":var ot={controlID:o,instanceID:s,transferredID:h,runtimeContextID:y,isDestination:!0},l=findCorrectInstanceForDataTransfer(ot);if(checkExists(l)){var k=l.result;if(checkExists(k)){c=l.ViewID;r=l.WindowToUse;var st=k.getAttribute("ControlTemplate");if(checkExists(st)&&st==="header"){var ht=k.parentNode.parentNode.getAttribute("MainTable");if(checkExists(ht))for(var g=jQuery("#"+ht).find("."+o),nt=g.length;nt--;)$(g[nt]).text(e),g[nt].setAttribute("title",e)}else{var gt=new PopulateObject(null,e,o);r.executeControlFunction(k,"SetValue",gt)}}}break;case"ViewField":var ot={fieldID:o,instanceID:s,transferredID:h,runtimeContextID:y,isDestination:!0},l=findCorrectInstanceForDataTransfer(ot);if(checkExists(l)){var nq=l.result;if(!checkExists(nq))return;c=l.ViewID;r=l.WindowToUse;var ct=!0;if(f==="Control"){var lt=u.split("_")[1],tt,tq;if(e){if(typeof e=="string"&&e.startsWith("<collection")){var tq=!0,d=$xml(e),qt=$sn(d,"collection").getAttribute("Type");if(checkExists(qt))if(qt==="Complex")r.setHiddenPropertyCollection(c,d,lt,null,null,s),e=$sn(d,baseCollectionXPath+"/fields/field[@isValue='true']/value").text;else if(qt==="Composite"){var at=returnFieldAttributeObject(o,s);checkExists(at)&&at.propertyType.toUpperCase()==="MULTIVALUE"?tt=!1:(tt=!0,e=_runtimeTransformXmlCollectionToJson(d.documentElement))}}if(!tq||tt)try{var a=new dataSourceLookup({xmlDoc:r.viewControllerDefinition,controllerID:c,instanceXP:et,controlID:lt}).getDataSource();if(checkExists(a)){var p=a.getAttribute("IsComposite");if(checkExists(p)&&(p=p.toLowerCase()),checkExists(p)&&p==="true"){var vt=a.getAttribute("ContextID"),yt=a.getAttribute("ContextType"),qq=e.length;qq===0?r.removeHiddenPropertyCollection(c,null,null,null,u,null,yt,s,vt):r.setHiddenPropertyCollection(c,e,u,vt,yt,s);ct=!1}else{var rq=a.getAttribute("ValueProperty"),uq=a.getAttribute("AssociationSO"),fq=a.getAttribute("ContextID"),eq=a.getAttribute("ContextType"),pt=$sn(r.viewControllerDefinition,"Controllers/Controller[@ID='"+c+"']"+et+"/Fields/Field[@ContextID='"+fq+"'][@ContextType='"+eq+"'][@ObjectID='"+uq+"'][@ObjectType='Object'][PropertyName/text()='"+rq+"']");checkExists(pt)&&r.setHiddenFieldValue(pt.getAttribute("ID"),e,null,s,u,f,null,v)}}}catch(sq){}}}ct&&r.setHiddenFieldValue(o,e,null,s,u,f,null,v)}break;case"ViewProperty":var oq={viewID:c,currentAction:n,target:o,sourceValue:e,targetTransferredID:h,targetRuntimeContextID:y,loopContextID:v};updateViewProperty(oq);break;case"ControlProperty":checkExistsNotEmpty(o)&&(o=o.toLowerCase());checkExists(ft)&&(b=ft);checkExists(b)&&(o==="controlexpression"&&(e=deriveControlExpressionFromValue(b,q,e,s,h)),SetControlProperty(b,o,e,h,y,!1,v));break;case"PanelProperty":var wt=n.getAttribute("PanelID");if(checkExists(wt)&&o.toLowerCase()==="display"){var bt=_runtimeEmptyGuid+"_"+wt;switch(e.toLowerCase()){case"show":SetControlProperty(bt,"isvisible",!0,h,y,!0);break;case"hide":SetControlProperty(bt,"isvisible",!1,h,y,!0)}}break;case"FormProperty":switch(o.toLowerCase()){case"wfstripdisplay":var w=jQuery(".workflow_panel"),kt=jQuery(".workflow-form-panel");if(w){w=w[0];switch(e.toLowerCase()){case"show":w.style.display="block";kt.addClass("with-workflow-strip");break;case"hide":w.style.display="none";kt.removeClass("with-workflow-strip")}}break;case"wfstripbuttons":var rt=document.getElementById("workflow_button_panel");if(rt)switch(e.toLowerCase()){case"show":rt.style.display="inline-block";break;case"hide":rt.style.display="none"}break;case"wfstripdropdown":var ut=document.getElementById("workflow_dropdown_submit_panel");if(ut)switch(e.toLowerCase()){case"show":ut.style.display="inline";break;case"hide":ut.style.display="none"}}break;case"FormParameter":setFormParameterValue(o,e,v);break;case"ViewParameter":setViewParameterValue(o,e,s,v)}}function updateViewProperty(n){var r=n.viewID,q=n.currentAction,t=n.target,u=n.sourceValue,o=n.targetTransferredID,s=n.targetRuntimeContextID,h=n.loopContextID;if(checkExists(r)&&checkExists(q)){var f=q.getAttribute("InstanceID");if(checkExistsNotEmpty(t)&&(t=t.toLowerCase()),checkExists(f))currentControlID=_runtimeEmptyGuid+"_"+f,SetControlProperty(currentControlID,t,u,o,s,!1,h);else{windowToUse=getWindowToUse(q);var e=windowToUse.getViewDefinition(r,null);if(checkExists(e)){var c=e.getAttribute("MainTable");windowToUse.$("#"+c).SFCAreaItem("option",t,u)}}}}function deriveControlExpressionFromValue(n,t,q,r,u){var f=$sn(t,"SourceValue[count(Source)=1]/Source[@SourceType='Expression']");if(checkExists(f)||t.getAttribute("SourceType")!=="Expression"||(f=t),checkExists(f)){var e=f.getAttribute("SourceID"),o=f.getAttribute("SourceInstanceID");if(q=e,checkExists(o)&&r!==o){var s=null,h=null;checkExists(r)?checkExists(r)&&(s=$sn(viewControllerDefinition,"Controllers/Expressions/Expression[@ID='"+e+"']"+returnInstanceXP(r,!1,!1,!0,!0)),checkExists(s)||(h=$sn(viewControllerDefinition,"Controllers/Expressions/Expression"+returnInstanceXP(r,!1,!1,!0,!0)+"[count(Item)=1]/Item[@SourceType='Expression'][@SourceID='"+e+"']"+returnInstanceXP(o,!1,!0,!0,!0)))):(s=$sn(viewControllerDefinition,"Controllers/Expressions/Expression[@ID='"+e+"'][not(@InstanceID)]"),checkExists(s)||(h=$sn(viewControllerDefinition,"Controllers/Expressions/Expression[not(@InstanceID)][count(Item)=1]/Item[@SourceType='Expression'][@SourceID='"+e+"']"+returnInstanceXP(o,!1,!0,!0,!0))));checkExists(s)||(q=checkExists(h)?h.parentNode.getAttribute("ID"):createPseudoExpressionForControlProperties(r,q,"Expression",o))}}else{var c=t.getAttribute("TargetSubFormID");if(checkExists(c)&&u!==c){var l=$sn(t,"SourceValue/Source[@SourceType='Value']");checkExists(l)&&(q=createPseudoExpressionForControlProperties(r,q,"Value"))}}return q}function createPseudoExpressionForControlProperties(n,t,q,r){var u=viewControllerDefinition.createElement("Expression");u.setAttribute("pseudo","true");checkExists(n)&&u.setAttribute("InstanceID",n);var e=String.generateGuid();u.setAttribute("ID",e);var f=viewControllerDefinition.createElement("Item");if(f.setAttribute("SourceType",q),q==="Expression")f.setAttribute("SourceID",t);else if(q==="Value"){var o=viewControllerDefinition.createElement("SourceValue");f.appendChild(o);var s=viewControllerDefinition.createTextNode(t);o.appendChild(s)}checkExists(r)&&f.setAttribute("SourceInstanceID",r);u.appendChild(f);var h=$sn(viewControllerDefinition,"Controllers/Expressions");return h.appendChild(u),e}var listRefreshCache=[];function updateControlPropertyDefinition(n,t,q,r){if(!checkExists(n))return!1;var u={};u.viewId=n.parentNode.parentNode.getAttribute("ID");u.instanceId=n.parentNode.parentNode.getAttribute("InstanceID");u.controlId=n.getAttribute("ID");u.propertyName=t.toLowerCase();u.value=q;var f=SourceCode.Forms.Runtime.Information.getControlPropertyHistory(u);checkExists(f)||(f=$sn(n,"Properties/Property[translate(Name/text(), 'ABCDEFGHIJKLMNOPQRSTUVWXYZ', 'abcdefghijklmnopqrstuvwxyz')='"+u.propertyName+"']/Value"),checkExists(f)&&(f=f.text));var e=!0,o=f!==q;if(!o){var s={controlID:u.controlId,propertyName:u.propertyName,currentControl:n,ignoreXML:!0};q!=returnControlPropertyValue(s)?o=!0:e=!1}return o&&(SourceCode.Forms.Runtime.Information.setControlPropertyHistory(u),_runtimeControlInfoCache[u.controlId]=null),e&&checkExists(q)&&updateSpecialControlProperties({currentControl:n,propertyName:u.propertyName,propertyValue:q,loopContextID:r,instanceId:u.instanceId}),e}function updateSpecialControlProperties(n){var e=n.propertyName,t=n.propertyValue,o=n.loopContextID,s=n.skipAction,r=n.instanceId,h=n.controlId,q=checkExists(n.currentControl)?n.currentControl:_runtimeControllerFindObject({controlID:h});function u(n,t,q){var r=!1;return q.length>0?(n.setAttribute(t,q),r=!0):(n.removeAttribute(t),r=!1),r}if(checkExists(t)&&checkExists(q))switch(e.toLowerCase()){case"field":u(q,"FieldID",t);break;case"controlexpression":if(u(q,"ExpressionID",t)&&!s){var r=checkExists(r)?r:q.parentNode.parentNode.getAttribute("InstanceID"),c="Controllers/Expressions/Expression[@ID='"+t+"']"+returnInstanceXP(r,!1,!1,!0,!1),f=$sn(viewControllerDefinition,c);checkExists(f)&&refreshAllRelatedExpressions(t,f,r,null,null,o);fireExpressions()}break;case"datatype":u(q,"DataType",t);break;case"parentusingfield":u(q,"ParentUsingField",t)}}function updateListControlStates(n,t,q,r){var w=n.getAttribute("ControlTemplate"),h=n.parentNode.parentNode.getAttribute("MainTable"),u;if(checkExists(w)&&checkExists(h)){var f=jQuery("#"+h);switch(w){case"display":listRefreshCache.push(h);break;case"header":u=f.find("."+t);for(var c=u.length,g=r==="false"?"none":"",nt=r==="false"?!1:!0;c--;)if(q==="isvisible")u[c].style.display=g;else if(q==="isenabled"){var tt=u[c].className.replace(t,"").replace("grid-column-header-text","").trim();SFRGrid.execute({element:f,fn:"update",params:["column",tt,{sortable:nt}]})}break;case"none":if(q==="isvisible"){var qt=r==="false"?"hide":"unhide";SFRGrid.execute({element:f,fn:qt,params:["column",t]});var l=n.parentNode.parentNode.getAttribute("ID"),a=n.parentNode.parentNode.getAttribute("InstanceID"),b=checkExists(a)?a+"_"+l:_runtimeEmptyGuid+"_"+l;runtimeFilterFields[b]=null;populateQuickSearchDropdown(l,a,b)}else if(q==="isenabled"){u=f.find("."+t);for(var o=u.length;o--;)if(u.eq(o).hasClass("grid-content-cell-wrapper")&&u[o].children.length>0){for(var k=u.eq(o).find("*[id]"),s=[],d=k.length;d--;){var v=k[d].id;if(checkExists(v)&&v.length>0){var e=getActualControlID(v);s.indexOf(e)<0&&s.push(e)}}while(s.length>0){var e=s.pop(),y=_runtimeControllerFindObject({controlID:e,propertySearch:"SetProperty"});if(checkExists(y)){var p=new PopulateObject(null,r,e,"isparentenabled"),rt=updateControlPropertyDefinition(n,p.property,p.Value);rt&&(executeControlFunction(y,"SetProperty",p),updateListControlStates(y,e,"isparentenabled",r))}}}var ut=r==="false"?!1:!0;SFRGrid.execute({element:f,fn:"update",params:["column",t,{sortable:ut}]})}}}else q.toLowerCase()==="isvisible"&&refreshFormPadding({controlID:t})}function updateAllListDisplays(n){if(listRefreshCache.length>0)for(listRefreshCache=listRefreshCache.filter(function(n,t){return listRefreshCache.indexOf(n)===t});listRefreshCache.length>0;){var t=listRefreshCache.pop();simpleListCache.length>0&&simpleListCache.indexOf(t)>-1&&simpleListCache.splice(simpleListCache.indexOf(t),1);updateListDisplay(t,null,n)}if(simpleListCache.length>0)for(simpleListCache=simpleListCache.filter(function(n,t){return simpleListCache.indexOf(n)===t});simpleListCache.length>0;)updateListDisplay(simpleListCache.pop(),!0,n)}function updateListDisplay(n,t,q){if(checkExists(n)&&n.length>0){var o=new getMainTableViewInformation(n),u=o.viewID,f=o.instanceID,e=jQuery("#"+n);if(e.length>0){var r=e[0],s=r.getAttribute("PageNumber");if(!checkExists(t)||t===!1){var h=null,c=null;checkExists(r.getAttribute("QFName"))&&r.getAttribute("QFName").length>0&&(h=r.getAttribute("QFName"),c=r.getAttribute("QFValue"));viewTableDefinitions[n]=constructTableDefinition(u,e,c,h,f)}var l=getCombinedHiddenPropertyCollection(u,null,null,s,null,!0,null,null,null,f);rebuildTable(n,u,f,!1,!1,!0,l,!0,s,q,!1)}}}function getWindowToUse(n,t){var q=window.self;if(checkExists(t)&&t.runtimeInstanceName!=="_"){var r=SourceCode.Forms.Runtime.getRuntimeDataProperty(t.runtimeInstanceName,"windowContextValid");r&&(q=SourceCode.Forms.Runtime.getRuntimeDataProperty(t.runtimeInstanceName,"windowContext"))}if(SourceCode.Forms.Runtime.Navigation.isBehaviorContextAction(n))return q;var u=n.getAttribute("TransferredID"),f=n.getAttribute("ViewID"),e=n.getAttribute("FormID"),o=n.getAttribute("GroupID"),s=n.getAttribute("OriginalLevel"),h=n.getAttribute("RuntimeContextID"),c=n.getAttribute("InstanceID"),l={viewID:f,instanceID:c,formID:e,transferredID:u,groupID:o,originalLevel:s,runtimeContextID:h,isDestination:!0},a=q.findCorrectInstanceForDataTransfer(l);return a.WindowToUse}function findCorrectInstanceForDataTransfer(n){var f={formID:n.formID,viewID:n.viewID,instanceID:n.instanceID,controlID:n.controlID,fieldID:n.fieldID,expressionID:n.expressionID,groupID:n.groupID,formParameter:n.formParameter,viewParameter:n.viewParameter,dataSourceID:n.dataSourceID},q=__runtimeSubformID,r=__runtimeContextID;checkExists(n.transferredID)&&checkExists(n.runtimeContextID)&&(q=n.transferredID,r=n.runtimeContextID);var u=r+"_"+q,e=SourceCode.Forms.Runtime.getRuntimeDataProperty(u,"windowContextValid"),t={WindowToUse:window.self,result:null};return e===!0&&(t.WindowToUse=SourceCode.Forms.Runtime.getRuntimeDataProperty(u,"windowContext"),checkExists(t.WindowToUse)&&typeof t.WindowToUse._runtimeControllerFindObject=="function"&&(t.result=t.WindowToUse._runtimeControllerFindObject(f),n.isDestination===!0&&checkExists(t.result)&&checkExists(t.result.parentNode)&&checkExists(t.result.parentNode.parentNode)&&typeof t.result.parentNode.parentNode.getAttribute!="undefined"&&(t.ViewID=t.result.parentNode.parentNode.getAttribute("ID"),t.InstanceID=t.result.parentNode.parentNode.getAttribute("InstanceID"))),checkExists(t.WindowToUse)&&checkExists(t.result)||(t=findCorrectInstanceForDataTransferFallback(n))),t}function findCorrectInstanceForDataTransferFallback(n){var l=n.isDestination,s=n.transferredID,y=n.isParent,h=n.originalLevel,u={formID:n.formID,viewID:n.viewID,instanceID:n.instanceID,controlID:n.controlID,fieldID:n.fieldID,expressionID:n.expressionID,groupID:n.groupID,formParameter:n.formParameter,viewParameter:n.viewParameter,dataSourceID:n.dataSourceID},q=window.self,t=null,a=SourceCode.Forms.Runtime.getMasterRuntimeWindow(),e=parseInt(__runtimeFormLevel,10),r=SourceCode.Forms.Runtime.getAllPopupsWithRuntimeInstances();if(checkExistsNotEmpty(s)){if(l!==!0&&r.length>0)for(var c=r.length,v=e;v<c;v++){var f=getPopupWindowOnLevel(q,v,r);if(f.__runtimeSubformID===s&&typeof f._runtimeControllerFindObject=="function"&&(t=f._runtimeControllerFindObject(u),checkExists(t))){q=f;break}}checkExists(t)||__runtimeSubformID!==s||(t=_runtimeControllerFindObject(u))}if(!checkExists(t)&&e>0&&checkExists(h)&&parseInt(h,10)<e&&(q=a,e>1&&h>=1&&(q=getPopupWindowOnLevel(q,h-1,r)),n.runSearch!==!1&&typeof q._runtimeControllerFindObject=="function"&&(t=q._runtimeControllerFindObject(u))),n.runSearch===!1||checkExists(t)||(q=window.self,typeof q._runtimeControllerFindObject=="function"&&(t=q._runtimeControllerFindObject(u))),n.runSearch!==!1&&!checkExists(t)&&(e>1&&(checkExists(s)&&l||y)&&(q=getPopupWindowOnLevel(q,e-2,r),typeof q._runtimeControllerFindObject=="function"&&(t=q._runtimeControllerFindObject(u))),checkExists(t)||q!=a&&(q=a,typeof q._runtimeControllerFindObject=="function"&&(t=q._runtimeControllerFindObject(u))),!checkExists(t)&&r.length>0)){for(var c=r.length,f=q;c>0&&!checkExists(t);){var f=getPopupWindowOnLevel(q,c-1,r,!0);typeof f._runtimeControllerFindObject=="function"&&(t=f._runtimeControllerFindObject(u));c--}checkExists(t)&&(q=f)}var o={};return o.WindowToUse=q,l&&checkExists(t)&&checkExists(t.parentNode)&&checkExists(t.parentNode.parentNode)&&typeof t.parentNode.parentNode.getAttribute!="undefined"&&(o.ViewID=t.parentNode.parentNode.getAttribute("ID"),o.InstanceID=t.parentNode.parentNode.getAttribute("InstanceID")),o.result=t,o}function getPopupWindowOnLevel(n,t,q,r){var u=n;if(checkExists(q)||(q=SourceCode.Forms.Runtime.getAllPopupsWithRuntimeInstances()),q.length>0&&q.length>t){var f=q[t];if(!r||!f.isClosing){var e=f.controls.body;if(checkExists(e)){var o=e.find("iframe.runtime-popup");u=SourceCode.Forms.Runtime.getPopupIframeContentWindow(o)}}}return u}function calculateAction(n,t,q){var r=getLoopContextID(n);if(checkExists(q)){var u=q.InstanceID;switch(q.SourceType){case"Form":u=_runtimeEmptyGuid;updateCalculatedControlsForSource(u,!0,r);break;case"View":updateCalculatedControlsForSource(u,!0,r);break;case"Control":var f=q.SourceID;if(f){var e=_runtimeControllerFindObject({controlID:f});calculateControlAction(e,f,r)}}q.isExecuting=!1}removeLoopContextData({loopContextID:r})}function calculateControlAction(n,t,q){if(checkExists(n)){var r=n.parentNode.parentNode.getAttribute("InstanceID");updateCalculatedControls(n,r,null,null,null,null,null,q);for(var u=new dataSourceLookup({xmlDoc:viewControllerDefinition,selectMultiple:!0,sourceControlID:t}).getDataSource(),f=u.length;f--;)for(var e=u[f],h=e.getAttribute("ContextType"),c=e.getAttribute("ContextID"),l="Controllers/Controller"+returnInstanceXP(r,!1,!1,!0,!1)+"/Fields/Field[@ContextID='"+c+"'][@ContextType='"+h+"']",o=$mn(viewControllerDefinition,l),s=o.length;s--;){var a=o[s].getAttribute("ID");updateCalculatedControls(null,r,"ViewField",a,null,null,null,q)}}}function validateAction(n,t,q){var h=getLoopContextID(n),v=n.getAttribute("GroupID"),c=n.getAttribute("ControlID"),p=n.getAttribute("ExpressionID"),l=n.getAttribute("Message"),f=n.getAttribute("MessageLocation"),tt=n.getAttribute("IgnoreInvisibleControls"),qt=n.getAttribute("IgnoreDisabledControls"),rt=n.getAttribute("IgnoreReadOnlyControls"),e=!1,u="",r;if(checkExists(v)&&v.length>0){var y=n.getAttribute("InstanceID"),w="";typeof y!="undefined"&&y!==null&&(w="[@InstanceID='"+y+"']");var ut=_runtimeValidationGroupXpath.format("Controllers/",w,v),a=$sn(viewControllerDefinition,ut);if(checkExists(a)){l=a.getAttribute("Message");var b=$sn(a,"Condition");if(checkExists(b)){var ft=b.firstChild,et=evaluateExpression(ft,null,null,!0,null,null,h);if(et!==!0){e=!0;var ot=l.length>0?l:locValidationExpresssionsFailed;masterPopupManager.showWarning(ot)}}if(!e){var o=$mn(a,"ValidationGroupControls/ValidationGroupControl"),st=o.length;if(st>0)for(var s=0;s<o.length;s++){var k=o[s].getAttribute("ControlID"),d=o[s].getAttribute("IsRequired"),g={controlID:k,forValidation:!0},ht=getControlValue(g),ct=$sn(o[s],"Condition");r=validateControl(k,ht,f,d,ct,null,tt,qt,rt,h);checkExists(r)&&r.Error&&(f==="Popup"&&(u+=checkExists(r.Pattern)?"- <b>"+r.Name+"<\/b> "+r.Pattern+"<br/>":"",u+=checkExists(r.DataType)?"- <b>"+r.Name+"<\/b> "+r.DataType+"<br/>":"",u+=checkExists(r.RequiredError)?"- <b>"+r.Name+"<\/b> "+r.RequiredError+"<br/>":""),e=!0)}}}}else if(checkExists(c)&&c.length>0){checkExists(f)||(f="Control");var d="false",g={controlID:c,forValidation:!0},lt=getControlValue(g),nt=null;checkExists(p)&&(nt=$sn(viewControllerDefinition,"Controllers/Expressions/Expression[@ID='"+p+"']"));r=validateControl(c,lt,f,d,nt,l,null,null,null,h);checkExists(r)&&r.Error&&(f==="Popup"&&(u+=checkExists(r.Pattern)?"- <b>"+r.Name+"<\/b> "+r.Pattern+"<br/>":"",u+=checkExists(r.DataType)?"- <b>"+r.Name+"<\/b> "+r.DataType+"<br/>":"",u+=checkExists(r.RequiredError)?"- <b>"+r.Name+"<\/b> "+r.RequiredError+"<br/>":""),e=!0)}if(e){if(u.length>0&&f==="Popup"){u="<b>"+Resources.RuntimeMessages.ValidationWarningMessage+"<\/b><br/><br/>"+u;var at={showHeaderButtons:!0,headerText:Resources.RuntimeMessages.ValidationWarnings,message:u,height:250,width:450,type:"warning",cssClass:"validation-message"};masterPopupManager.showMessage(at)}checkExists(q)&&(q.actions=[],q.previousHandlerResult=!1)}endActionExecution({loopContextID:h,behaviour:q})}function validateControl(n,t,q,r,u,f,e,o,s,h){var l=_runtimeControllerFindObject({controlID:n}),p=null,w=!1;if(r=checkExists(r)&&r.length>0&&r.toLowerCase()==="true",checkExists(l)){var a=!0,b=checkExists(l.getAttribute("PanelID"))?l.getAttribute("PanelID"):l.parentNode.parentNode.getAttribute("PanelID"),ut=l.parentNode.parentNode.getAttribute("ID"),ft=l.parentNode.parentNode.getAttribute("MainTable"),v=null,c=null;if(a&&checkExists(s)&&s.toLowerCase()==="true"&&(v=new PopulateObject(null,null,n,"IsReadOnly"),c=executeControlFunction(l,"GetProperty",v),checkExists(c)&&c===!0?a=!1:(v=new PopulateObject(null,null,n,"IsParentReadOnly"),c=executeControlFunction(l,"GetProperty",v),checkExists(c)&&c===!0&&(a=!1))),a&&checkExists(o)&&o.toLowerCase()==="true"&&(v=new PopulateObject(null,null,n,"IsEnabled"),c=executeControlFunction(l,"GetProperty",v),checkExists(c)&&c===!1?a=!1:(v=new PopulateObject(null,null,n,"IsParentEnabled"),c=executeControlFunction(l,"GetProperty",v),checkExists(c)&&c===!1&&(a=!1)),a&&checkExists(b)&&b.length>0&&(c=testPanelProperty(b,"IsEnabled"),checkExists(c)&&c===!1&&(a=!1))),checkExists(e)&&e.toLowerCase()==="true"){v=new PopulateObject(null,null,n,"IsVisible");c=executeControlFunction(l,"GetProperty",v);checkExists(c)&&c===!1&&(a=!1);a&&(v=new PopulateObject(null,null,n,"IsParentVisible"),c=executeControlFunction(l,"GetProperty",v),checkExists(c)&&c===!1&&(a=!1));a&&checkExists(ut)&&ut.length>0&&(c=testViewProperty(ft,"IsVisible"),checkExists(c)&&c===!1&&(a=!1));a&&checkExists(b)&&b.length>0&&(c=testPanelProperty(b,"IsVisible"),checkExists(c)&&c===!1&&(a=!1));var ct=l.getAttribute("ControlTemplate");if(a&&ct==="edit"){var lt=jQuery("#"+ft)[0].getAttribute("editable");if(lt!=="true"&&(a=!1),a){var et=jQuery(".grid *[id*="+n+"]").first().closest("td");et.length>0&&(a=!et.hasClass("hidden"))}}}if(a===!1)return null;var nt=l.getAttribute("ID"),at=l.getAttribute("Name"),tt="",qt="",rt="",y=checkExists(l.selectSingleNode("Properties/Property[Name='DataType']/Value"))?l.selectSingleNode("Properties/Property[Name='DataType']/Value").text:null,k=null,ot=function(){if(!checkExists(k)){var q={controlID:nt,propertyName:"ValidationPattern",currentControl:l},n=returnControlPropertyValue(q);if(checkExists(n)&&n.length>0){var t=$sn(viewControllerDefinition,"Controllers/ValidationPatterns/ValidationPattern[@ID='"+n+"']");if(checkExists(t)){var r=t.getAttribute("Message");k={regex:new RegExp(t.text),message:checkExists(d)&&d.length>0?d:r}}}}return k};if(checkExists(t)&&t.toString().length>0){if(checkExists(y)&&y.toLowerCase()==="multivalue"){var st=tryParseXML(t);checkExists(st)&&checkExists(st.selectSingleNode("collection/object/fields/field/value"))||(t="")}if(checkExists(u)){var vt=u.firstChild,yt=evaluateExpression(vt,null,null,!0,null,null,h);yt!==!0&&(w=!0,tt=locValidationExpresssionsFailed)}var pt={controlID:nt,propertyName:"ValidationMessage",currentControl:l},d=returnControlPropertyValue(pt);if(ot(),checkExists(k)){var wt=k.regex.test(t.toString());wt!==!0&&(w=!0,tt=k.message)}if(!w){var bt=controlInformationObject(nt);if(y=bt.propertyType,typeof t=="string"&&t.startsWith("<collection")?y="xml":typeof t=="object"&&(y="xml"),checkExists(y)&&y.length>0){var g=!1;switch(y.toLowerCase()){case"number":case"decimal":case"autonumber":(typeof t=="number"||t.isNumeric()||t.isFloat()||!isNaN(t))&&(g=!0);break;case"yesno":switch(t.toLowerCase()){case"true":case"false":case"yes":case"no":case"0":case"1":g=!0}break;case"datetime":var ht=Date.parse(t);ht.toString().toLowerCase()!=="nan"&&ht.toString().toLowerCase()!=="invalid date"&&(g=!0);break;case"guid":case"autoguid":t.isValidGuid()&&(g=!0);break;default:g=!0}g||(rt=checkExists(d)&&d.length>0?d:Resources.Runtime.DataTypeValidationError.format(y==="guid"?y.toUpperCase():y),w=!0)}}}else r&&(qt=Resources.Runtime.RequiredValidationError,w=!0);p={Name:at,IsRequired:qt.length>0?!0:null,Pattern:tt.length>0?tt:null,DataType:rt.length>0?rt:null,CurrentControlId:nt,Error:w,IgnoreInvisible:e,IgnoreDisabled:o,IgnoreReadOnly:s,ValidationSettings:{isRequired:r,requiredMessage:Resources.Runtime.RequiredValidationError,GetPatternObject:ot}};switch(q){case"Popup":p.Name=l.getAttribute("Name");p.RequiredError=qt.length>0?qt:null;p.IsPopup=!0;break;case"Control":p.IsPopup=!1}executeControlFunction(l,"ValidationMethod",p)}return p}function testPanelProperty(n,t){var q=!0,r=$find(currentForm);if(checkExists(r)){var u=_runtimeEmptyGuid+"_"+n;switch(t){case"IsVisible":q=r.get_isVisible(u);break;case"IsEnabled":q=r.get_isEnabled(u)}}return q}function testViewProperty(n,t){var r=!0;if(t==="IsVisible"){r=null;var q=jQuery("#"+n),u=q.data("SFCWidgetName");checkExists(u)&&(r=q[u]("option","isVisible"));!checkExists(r)&&checkExists(q)&&q.length===1&&(r=q[0].style.display!=="none"&&!q.hasClass("hidden"))}return r}function promptAction(n,t,q){var f=getLoopContextID(n),e=n.getAttribute("Heading").xmlDecode(),r=n.getAttribute("Message").xmlDecode(),s=n.getAttribute("PromptType"),u;switch(s){case"Alert":u={onClose:function(){removeLoopContextData({loopContextID:f});continuePromptingBehaviour(q,!1)},headerText:e,message:r};masterPopupManager.showNotification(u);break;case"Confirmation":var o=n.getAttribute("MessageIsLiteral");checkExists(o)&&o.toString().toLowerCase()!=="true"&&(r=r.htmlEncode());u={headerText:e,height:165,message:r,onAccept:function(){removeLoopContextData({loopContextID:f});continuePromptingBehaviour(q,!0)},onCancel:function(){cancelPromptingBehaviour(q,t,!0,f)}};masterPopupManager.showConfirmation(u)}}function continuePromptingBehaviour(n,t){t&&masterPopupManager.closeLast();checkExists(n)&&(n.isExecuting=!1,n.executeBehaviour())}function cancelPromptingBehaviour(n,t,q,r){if(checkExists(n)&&t.toLowerCase().startsWith("listitem")&&n.SourceType.toLowerCase()==="view"){var u=getViewMainTable(n.options.SourceID,n.options.InstanceID);checkExistsNotEmpty(u)&&(u=jQuery("#"+u),cancelItemChanges(u,null,r))}q&&masterPopupManager.closeLast();removeLoopContextData({loopContextID:r});checkExists(n)&&(n.actions=[],n.previousHandlerResult=!1,n.isExecuting=!1,n.executeBehaviour())}function addMetadata(n,t,q){return checkExists(q)&&(q=q.toString(),checkExistsNotEmpty(q)&&(n[t]=q)),n}function workflowAction(n,t,q,r){var rt=getLoopContextID(n),l=n.getAttribute("Method");if(l.length>0){var ar=$xml("<brokerpackage><\/brokerpackage>"),nt={},a=nt.Process={},f=nt.metadata={};f=addMetadata(f,"method",l);f=addMetadata(f,"shareduser",getFormParameterValue("shareduser"));f=addMetadata(f,"manageduser",getFormParameterValue("manageduser"));var st="true";if(l.toLowerCase()==="loadprocess")if(r===!1)st="false";else{var uq=n.getAttribute("WorkflowAllocate");checkExists(uq)&&(st=uq)}_runtimeMode==="offline"&&(st="false");f=addMetadata(f,"allocated",st);var ut=n.getAttribute("ProcessName");checkExists(ut)&&(a.Name=ut);var ht="",y=a.ProcessInstance={},ft=a.ActivityInstanceDestination={},pq=a.EventInstance={},bt=$mn(n,"Parameters/Parameter"),fq=$mn(n,"Results/Result"),kt=fq.length;if(kt>0){for(var eq=[];kt--;){var tt=fq[kt],wq=tt.getAttribute("TargetID"),bq=tt.getAttribute("TargetInstanceID"),kq=tt.getAttribute("TargetType"),dq=tt.getAttribute("SourceType"),gq=tt.getAttribute("SourceID"),nr=tt.getAttribute("SourceInstanceID"),oq="",sq={targetID:wq,targetType:kq,sourceType:dq,sourceID:gq,sourceInstanceID:nr,targetInstanceID:bq};checkExistsNotEmpty(oq)&&(sq.sourceValue=oq);eq.push(sq)}a.Results=eq}for(var dt=bt.length;dt--;){var s=bt[dt],hq=s.getAttribute("TargetType"),p=s.getAttribute("TargetID"),tr=s.getAttribute("TargetPath");if(hq==="ProcessItemReference"&&s.getAttribute("SourceType")==="ViewSource"&&(l.toLowerCase()==="startprocess"||l.toLowerCase()==="actionprocess")){var ct=s.getAttribute("SourceSubFormID");checkExistsNotEmptyGuid(ct)?s=populateSubformContext(s,ct):ct=s.getAttribute("SourceTransferredID");var qr=s.getAttribute("SourceRuntimeContextID"),gt=s.getAttribute("SourceID"),w=s.getAttribute("SourceInstanceID"),rr={instanceID:w,dataSourceID:gt,transferredID:ct,runtimeContextID:qr},ur=findCorrectInstanceForDataTransfer(rr),v=ur.WindowToUse,b=v.getViewDefinition(null,w,gt);if(checkExists(b)){var et=b.getAttribute("ID"),fr=b.getAttribute("TypeView").toLowerCase(),nq=$sn(b,"Fields/Field[@DataSourceID='"+gt+"']"),tq=nq.getAttribute("ObjectID"),lt=nq.getAttribute("ContextID"),ot=nq.getAttribute("ContextType"),er=b.getAttribute("MainTable"),qt=null,cq=getViewProperty(b,"ListEditable");fr==="list"&&(checkExistsNotEmpty(cq)||(qt=v.getLoopContextData({loopContextID:rt,viewID:et,instanceID:w}).counter,checkExists(qt)||(qt=v.getViewSelectedCounter(er))));var at=[],k=null;if(ot.toLowerCase()==="association"){var qq=new v.dataSourceLookup({xmlDoc:b,includeControllers:!1,includeController:!1,contextID:lt,contextType:ot}).getDataSource();if(checkExists(qq)){k=qq.getAttribute("SourceControlID");var or={controlID:k},lq=v.getControlValue(or);if(checkExistsNotEmpty(lq))for(var sr=qq.getAttribute("ValueProperty"),vt=v.getCombinedHiddenPropertyCollection(et,tq,null,null,k,qt,null,lt,ot,w),hr=vt.length,e=0;e<hr;e++)if(vt[e].fields[sr].value===lq){at.push(vt[e]);qt=vt[e].counter;break}}}else k=!1,at=v.getCombinedHiddenPropertyCollection(et,tq,null,null,k,qt,null,lt,ot,w);var rq=[],e=at.length;if(e>0){for(var yt=[];e--;){var cr=checkExistsNotEmpty(cq)?null:!1,d=jsonCopyAndExtendObject(at[e],cr);delete d.pagenumber;yt.unshift(d)}rq.push({collection:yt})}var aq=v.getHiddenParameterCollection(et);if(e=aq.length,e>0){for(var yt=[];e--;){var d=jsonCopyAndExtendObject(aq[e],!1);delete d.method;d.fields=d.parameters;delete d.parameters;yt.unshift(d)}rq.push({collection:yt})}var pt=y.itemReferences;checkExists(pt)||(pt=y.itemReferences=[]);var h=pt[p];checkExists(h)||(h={},h.name=p,pt.push(h));h.objectid=tq;h.viewid=et;checkExistsNotEmpty(k)&&(h.controlid=k.toString());h.contextid=lt;h.contexttype=ot;checkExistsNotEmpty(w)&&(h.instanceid=w);h.collections=rq}else{checkExists(t)?t.handleError("itemref",null,null,null,null,rt):masterPopupManager.showError(Resources.RuntimeMessages.WorkflowItemReferenceNotFound);return}}else{var o="",g,c=bt[dt].cloneNode(!0);if(checkExists(q)&&q===!0&&c.getAttribute("SourceType")==="Value"&&checkExists($sn(c,"SourceValue/*[@SourceType='ViewField']")))g=determineMultiValueMapping(c,rt,t,a),g.length===1&&typeof g[0]=="string"?(o=g[0],g=null):o=g.length===0?null:g;else if(o=returnSourceValue({item:c,customProcessData:a,loopContextID:rt,behaviour:t}),checkExists(q)&&q===!0&&!checkExistsNotEmpty(o)&&c.getAttribute("SourceType")=="ViewField"){o=[];var lr={sourceType:c.getAttribute("SourceType"),sourceId:c.getAttribute("SourceID"),sourcePath:c.getAttribute("SourcePath"),sourceInstanceID:c.getAttribute("SourceInstanceID"),sourceSubFormID:c.getAttribute("SourceSubFormID")};o.push(lr)}if(checkExists(o)){var u={target:p,processNode:a,targetPath:tr,sourceValue:o};switch(hq){case"WorkflowProcessProperty":y[p]=o;p==="SerialNumber"&&(ht=o);break;case"WorkflowActivityProperty":ft[p]=o;break;case"WorkflowEventProperty":pq[p]=o;break;case"WorkflowProcessDataField":u.instanceXP="ProcessInstance";u.fieldsXP="DataFields";u.fieldXP="DataField";u.instance=y;y=setWorkflowField(u);break;case"WorkflowActivityDataField":u.instanceXP="ActivityInstanceDestination";u.fieldsXP="DataFields";u.fieldXP="DataField";u.instance=ft;ft=setWorkflowField(u);break;case"WorkflowProcessXmlField":u.instanceXP="ProcessInstance";u.fieldsXP="XMLFields";u.fieldXP="XMLField";u.instance=y;y=setWorkflowField(u);break;case"WorkflowActivityXmlField":u.instanceXP="ActivityInstanceDestination";u.fieldsXP="XMLFields";u.fieldXP="XMLField";u.instance=ft;ft=setWorkflowField(u)}}}}if(l.toLowerCase()==="loadprocess"){var vq="processname",wt="";if(checkExists(ht)&&ht.length>0&&(vq="sn",wt=ht),checkExists(ut)&&ut.length>0&&(wt=ut),f=addMetadata(f,"type",vq),f=addMetadata(f,"value",wt),checkExists(q)&&q===!0)return nt;if(wt.length>0){var yq=[nt];return sendPacket(yq,t,[n],r)}masterPopupManager.showWarning(Resources.RuntimeMessages.WorkflowNotLoaded)}else if(l.toLowerCase()==="actionprocess"||l.toLowerCase()==="startprocess"){if(checkExists(q)&&q===!0)return nt;var yq=[nt];return sendPacket(yq,t,[n])}}else endActionExecution({loopContextID:rt,behaviour:t})}function setWorkflowField(n){n=checkExists(n)?n:{};var q=n.processNode,t=n.instance[n.fieldsXP];return checkExists(t)||(t=n.instance[n.fieldsXP]={}),t[n.target]=checkExists(n.targetPath)?n.sourceValue:n.sourceValue,n.instance}function PrepareNavigationTransferredEvents(n,t,q,r,u,f){var a=null,v=!1;checkExists(n)&&n.nodeType===1&&(checkExists(a)&&(a=n.parentNode,a.removeChild(n)),n=n.xml,v=!0);for(var h=$xml("<r>"+n+"<\/r>"),e=$mn(h,"//Event[not(@SubformID)][not(@RuntimeContextID)][not(@TransferredID)] | //Action[not(@SubformID)][not(@RuntimeContextID)][not(@TransferredID)]"),o=0;o<e.length;o++){var s=e[o];SourceCode.Forms.Runtime.Navigation.isBehaviorContextAction(s)||(s.setAttribute("RuntimeContextID",r),s.setAttribute("TransferredID",u))}e=$mn(h,"//*[@SubformID]");for(var o=0;o<e.length;o++){var s=e[o],c=s.getAttribute("SubformID");c===t&&(SourceCode.Forms.Runtime.Navigation.isBehaviorContextAction(s)||SourceCode.Forms.Runtime.Navigation.convertSubformNode(s,c,q,f))}e=$mn(h,'//Parameter[not(@SourceSubFormID)][not(@SourceRuntimeContextID)][not(@SourceTransferredID)][not(@SourceType = "Value")] | //Result[not(@SourceSubFormID)][not(@SourceRuntimeContextID)][not(@SourceTransferredID)][not(@SourceType = "Value")] | //Source[not(@SourceSubFormID)][not(@SourceRuntimeContextID)][not(@SourceTransferredID)][not(@SourceType = "Value")] | //Condition//Item[not(@SourceSubFormID)][not(@SourceRuntimeContextID)][not(@SourceTransferredID)][not(@SourceType = "Value")]');for(var o=0;o<e.length;o++){var s=e[o];s.setAttribute("SourceRuntimeContextID",r);s.setAttribute("SourceTransferredID",u)}e=$mn(h,"//Parameter[not(@TargetSubFormID)][not(@TargetRuntimeContextID)][not(@TargetTransferredID)] | //Result[not(@TargetSubFormID)][not(@TargetRuntimeContextID)][not(@TargetTransferredID)]");for(var o=0;o<e.length;o++){var s=e[o];s.setAttribute("TargetRuntimeContextID",r);s.setAttribute("TargetTransferredID",u)}e=$mn(h,"//Action//*[@SourceSubFormID]");for(var o=0;o<e.length;o++){var s=e[o],c=s.getAttribute("SourceSubFormID");c===t&&SourceCode.Forms.Runtime.Navigation.convertSourceSubformNode(s,c,q)}e=$mn(h,"//*[@TargetSubFormID]");for(var o=0;o<e.length;o++){var s=e[o],c=s.getAttribute("TargetSubFormID");c===t&&SourceCode.Forms.Runtime.Navigation.convertTargetSubformNode(s,c,q)}e=$mn(h,"//Condition//Item[@SourceType!='Value'][not(@SourceSubFormID)][not(@SourceOriginalLevel)]");for(var l=0;l<e.length;l++){var w=e[l];w.setAttribute("SourceOriginalLevel",__runtimeFormLevel)}if(v===!1){for(var y="",l=0;l<h.documentElement.childNodes.length;l++)y+=h.documentElement.childNodes[l].xml;return y}var p=h.documentElement.childNodes[0].cloneNode(!0);return checkExists(a)&&a.appendChild(p),p}function getWindowToNavigateTo(){var n=null,t=null,q=parseInt(window.__runtimeFormLevel,10);if(q>0&&(t=SourceCode.Forms.Runtime.getTopNonClosingRuntimeInstancePopup(q)),checkExists(t)){var r=t.controls.body.find("iframe.runtime-popup");n=SourceCode.Forms.Runtime.getPopupIframeContentWindow(r)}return checkExists(n)||(n=SourceCode.Forms.Runtime.getMasterRuntimeWindow()),n}function IsViewAction(n){return getNodeAttribute("FormID",n,null,checkExistsNotEmptyGuid)===null}function navigateAction(n,t,q,r,u,f){var e=getWindowToNavigateTo(),w=getLoopContextID(n),o="",bq=n.getAttribute("ID"),st=n.getAttribute("FormID"),ht=n.getAttribute("ViewID"),dt=getNodeAttribute("OrigInstanceID",n,n.getAttribute("InstanceID"),checkExists),gt=n.getAttribute("Url"),ct=getNodeAttribute("SubformID",n,n.getAttribute("TransferredID"),checkExists),d="_self",tt=!1;checkExists(r)||(r="");var g=!1;(n.getAttribute("Type")==="Open"||n.getAttribute("OldType")==="Open"||n.getAttribute("Type")==="Popup"||n.getAttribute("OldType")==="Popup")&&(g=!0);var nq=$sn(n,"Target");if(checkExists(nq)&&(d=returnSourceValue({item:nq,loopContextID:w,behaviour:q}),checkExists(d)&&d.length!==0||(d="_self")),checkExists(st))(n.getAttribute("Type")==="Focus"||n.getAttribute("OldType")==="Focus")&&n.removeAttribute("FormID"),o=n.getAttribute("VanityURL")?e.document.getElementById("CurrentURL").value.replace("View.aspx","Form.aspx").replace("Form.aspx",n.getAttribute("VanityURL"))+"?":e.document.getElementById("CurrentURL").value.replace("View.aspx","Form.aspx")+"?_ID="+st,e._debug&&(o+="&_debug="+e._debug);else if(checkExists(gt)){if(o=gt,!checkExists(u)){var lt=$mn(n,"Parameters/Parameter");if(checkExists(lt)&&lt.length>0){for(var tq=o,nt="",l=[],qq=lt.length;qq--;){var pt=lt[qq],kq=pt.getAttribute("TargetType"),at=pt.getAttribute("TargetID"),c=returnSourceValue({item:pt,loopContextID:w,behaviour:q});if(at!==""){if(at==="baseurl"){tq=c;continue}if(c.length>0&&kq==="Value"){var s,qt;switch(at.toLowerCase()){case"browsernavigatedialogwidth":s=parseInt(c,10);isNaN(s)||(qt=c.match(/^(\d*)(px|%)?$/),qt[2]&&qt[2]==="%"?l.push("dialogWidth: "+e.screen.availWidth*s/100+"px"):l.push("dialogWidth: "+s+"px"));break;case"browsernavigatedialogheight":s=parseInt(c,10);isNaN(s)||(qt=c.match(/^(\d*)(px|%)?$/),qt[2]&&qt[2]==="%"?l.push("dialogHeight: "+e.screen.availHeight*s/100+"px"):l.push("dialogHeight: "+s+"px"));break;case"browsernavigatedialogleft":s=parseInt(c,10);isNaN(s)||l.push("dialogLeft: "+s+"px");break;case"browsernavigatedialogtop":s=parseInt(c,10);isNaN(s)||l.push("dialogTop: "+s+"px");break;case"browsernavigatedialogresizable":l.push("resizable: "+c);break;case"browsernavigatedialogcenter":l.push("center: "+c);break;case"browsernavigatedialogstatus":l.push("status: "+c);break;default:nt.length>0&&(nt+="&");nt+=at+"="+c}}}}if(nt.length>0&&(nt="?"+nt),o=tq+nt,l.length>0&&(r=l.join(";")),!o.test(stringRegularExpressions.isValidURL)){var dq=o.htmlEncode(),rq={headerText:Resources.RuntimeMessages.InvalidURLWarningHeader,message:Resources.RuntimeMessages.InvalidURLWarningText.format(dq),onAccept:function(){masterPopupManager.closeLast();try{checkExists(e.frameElement)&&$(e.frameElement).addClass("navigated")}catch(n){}e.framePosting(d,o,r,u)}};masterPopupManager.showConfirmation(rq);return}}u=!0}}else if(checkExists(ht)){o=e.document.getElementById("CurrentURL").value.replace("Form.aspx","View.aspx")+"?_ID="+ht;tt=!0;e._debug&&(o+="&_debug="+e._debug);var uq=getFormParameterValue("shareduser");checkExistsNotEmpty(uq)&&(o+="&shareduser="+uq);var fq=getFormParameterValue("manageduser");checkExistsNotEmpty(fq)&&(o+="&manageduser="+fq)}e._runtimeMode!=null&&e._runtimeMode.toUpperCase()==="OFFLINE"&&(o+=o.indexOf("?")>0?"&":"?",o+="_mode=offline");var b="",vt=String.generateGuid(),rt=null,gq=SourceCode.Forms.Runtime.getRuntimeDataKeys(function(n){return n.indexOf("_windowContext")+14===n.length}).length-1;if(!u){if(t){var eq=populateParameterValuesForNavigation(n,!0,!g,tt,!1,w,q);checkExistsNotEmpty(eq)&&(o+=eq);populateFilterValuesForNavigation(n,!0,tt,null,w,!g,q);b=n.xml}if(checkExists(q)){if(q.actions.length>0)while(q.actions.length>0){var yt=q.actions.shift(),oq=getLoopContextID(yt);populateParameterValuesForNavigation(yt,!0,!g,tt,!0,oq,q);populateFilterValuesForNavigation(yt,!0,tt,null,oq,!g,q);b+=yt.xml}q.handlers.length>0&&(b+=extractHandlerLogicForNavigation(q.handlers,tt,n.getAttribute("OriginalEventType"),q.closeEvent,!g,q))}if(b.length>0&&(b=PrepareNavigationTransferredEvents(b,ct,vt,__runtimeContextID,__runtimeSubformID,IsViewAction(n)),r+=setFrameVariable("_Actions",b),checkExistsNotEmpty(b))){var sq=b.toUpperCase();sq.indexOf('WORKFLOWSTRIPLOCATION="TOP"')>-1?rt="top":sq.indexOf('WORKFLOWSTRIPLOCATION="BOTTOM"')>-1&&(rt="bottom")}}if(g){e.jQuery("#Theme").length>0&&(r+=setFrameVariable("_THEME",e.jQuery("#Theme").val()));e.jQuery("#StyleProfile").length>0&&(r+=setFrameVariable("_STYLEPROFILE",e.jQuery("#StyleProfile").val()));var wt=n.getAttribute("Heading").xmlDecode(),k=9,hq="id-runtime-dialog";if(checkExists(ht)&&(k=8),checkExists(st)||checkExists(ht)){hq+=checkExists(st)?" sub-form":" sub-view";var ut=extractNavigatedEvents(ct,dt,null);if(ut.length>0&&(ut=PrepareNavigationTransferredEvents(ut,ct,vt,__runtimeContextID,__runtimeSubformID,IsViewAction(n)),checkExistsNotEmpty(ut))){r+=setFrameVariable("_NavigateEvents",ut);var bt=ut.toUpperCase();bt.indexOf('WORKFLOWSTRIPLOCATION="TOP"')>-1?rt="top":bt.indexOf('WORKFLOWSTRIPLOCATION="BOTTOM"')>-1&&(rt="bottom");var nr=bt.indexOf("<NAME>SERVERPRERENDER<\/NAME>");nr>-1&&(r+=setFrameVariable("_NAVIGATEDSERVEREVENTS","true"))}}var cq=SourceCode.Forms.Runtime.getRuntimeInstanceName({__runtimeContextID:vt,__runtimeSubformID:ct});SourceCode.Forms.Runtime.setRuntimeDataProperty(cq,"windowContextValid",!1);SourceCode.Forms.Runtime.setRuntimeDataProperty(cq,"windowContext",null);var lq=gq+1;r+=setFrameVariable("_ActionID",bq);r+=setFrameVariable("_Level",lq);r+=setFrameVariable("_RuntimeContextID",vt);r+=setFrameVariable("_ParentRuntimeContextID",__runtimeContextID);r+=setFrameVariable("_SubformID",ct);r+=setFrameVariable("_ParentSubformID",__runtimeSubformID);checkExistsNotEmpty(rt)&&(r+=setFrameVariable("_RENDERWORKFLOWSTRIP",rt));var kt=n.getAttribute("ID")+"_"+lq.toString(),ft=SourceCode.Forms.Runtime.getMasterRuntimeWindow(),aq=jQuery(ft),a=0,v=0,vq=n.getAttribute("PopupSize"),y=n.getAttribute("SubformWidth"),p=n.getAttribute("SubformHeight"),h=n.getAttribute("SubformVerticalAlign"),et=aq.height(),ot=aq.width();if(checkExists(vq)){var yq=vq.toLowerCase();yq==="small"?(a=200,v=400):(yq==="medium"&&(k=5),a=Math.floor(et/10*k),v=Math.floor(ot/10*k))}if(v===0&&checkExists(y)){if(y.contains("<Source"))y=ft.returnSourceValue({item:parseXML("<Item><SourceValue>{0}<\/SourceValue><\/Item>".format(y)).documentElement,loopContextID:w});else{var tr=parseXML("<width>{0}<\/width>".format(y)).documentElement;y=tr.text.trim()}v=y.replace(stringRegularExpressions.unitDimention,"").isNumeric()?y.contains("%")?Math.floor(ot*parseFloat(y)/100):parseFloat(y):Math.floor(ot/10*k)}if(checkExists(h)){if(h.contains("<Source"))h=ft.returnSourceValue({item:parseXML("<Item><SourceValue>{0}<\/SourceValue><\/Item>".format(h)).documentElement,loopContextID:w});else{var qr=parseXML("<verticalAlign>{0}<\/verticalAlign>".format(h)).documentElement;h=qr.text.trim()}if(checkExistsNotEmpty(h))switch(h.toLowerCase()){case"middle":case"auto":h=h.toLowerCase();break;default:h=null}else h=null}if(a===0&&checkExists(p)){if(p.contains("<Source"))p=ft.returnSourceValue({item:parseXML("<Item><SourceValue>{0}<\/SourceValue><\/Item>".format(p)).documentElement,loopContextID:w});else{var rr=parseXML("<height>{0}<\/height>".format(p)).documentElement;p=rr.text.trim()}a=p.replace(stringRegularExpressions.unitDimention,"").isNumeric()?p.contains("%")?Math.floor(et*parseFloat(p)/100):parseFloat(p):Math.floor(et/10*k)}v===0&&(v=Math.floor(ot/10*k));a===0&&(a=Math.floor(et/10*k));v<70&&(v=70);a<70&&(a=70);v>ot&&(v=ot);a>et&&(a=et);wt=translateComplexSourceValue(wt,w,q);var pq=(new Date).getTime().toString();kt+="_"+pq;var ur=jQuery("<iframe class='runtime-popup' name='"+kt+"' frameborder='0' style='height:100%; width:100%; margin: 0px;'><\/iframe>"),rq={id:"PopupWin_"+pq,headerText:wt,content:ur,height:a,width:v,subformVerticalAlign:h,showHeaderButtons:!0,draggable:!0,maximizable:!0,cancelClose:!0,onShow:function(n){n.element.find(".popup-body-content > .scroll-wrapper").removeClass("scroll-wrapper").addClass("wrapper")},onClose:ft.subformPopupOnClose,subformContext:{loopContextID:w,formID:st,viewID:ht,actionInstanceID:dt,openBehaviour:q,closeBehaviour:f},removeContent:!0,cssClass:hq};ft.popupManager.showPopup(rq);e.framePosting(kt,o,r,u)}else{var wq=parseInt(e.__runtimeFormLevel,10);wq>0&&(r+=setFrameVariable("_Level",wq),checkExistsNotEmpty(__runtimeSubformID)&&(r+=setFrameVariable("_SubformID",__runtimeSubformID)));e.framePosting(d,o,r,u);checkExists(q)&&d!=="_self"&&(q.isExecuting=!1)}}function extractNavigatedEvents(n,t,q){var f="";checkExistsNotEmptyGuid(n)&&(f="@SubformID='"+n+"'");checkExistsNotEmpty(t)&&(f+=" and @InstanceID='"+t+"'");var e="";if(f.length>0){var v="Events/Event["+f+"]",u=$mn(formBindingXml,v);if(checkExists(runtimeNavigatedEvents)&&__runtimeSubformID!==n){var o=$mn(runtimeNavigatedEvents,v);if(o.length>0){for(var s=[],r=0;r<o.length;r++)s.push(o[r]);for(var r=0;r<u.length;r++)s.push(u[r]);u=s}}var h=u.length;if(h>0)while(h--){var y=u[h];if(e+=y.xml,checkExistsNotEmptyGuid(n)){var c=y.selectNodes(".//Action[(@Type='Open' or @Type='Popup') and @SubformID and not(@SubformID='"+n+"')]");q=checkExists(q)?q:[];for(var r=0;r<c.length;r++){var l=c[r].getAttribute("SubformID"),a=c[r].getAttribute("InstanceID");q.indexOf(l)!==-1||checkExistsNotEmptyGuid(a)&&a!==t||(q.push(l),e+=extractNavigatedEvents(l,a,q))}}}}return e}function translateComplexSourceValue(n,t,q){if(!checkExists(n))return"";var e=n.toString().trim(),r=e;if(r.length>0&&r.contains("<Source"))try{var s=parseXML("<Item><SourceValue>{0}<\/SourceValue><\/Item>".format(r)).documentElement;r=returnSourceValue({item:s,loopContextID:t,behaviour:q})}catch(h){try{r=e;for(var u=r.indexOf('<Source SourceType="Value">');u!==-1;){var f=r.indexOf("<\/Source>",u);if(f>-1&&f>u){u=u+27;var c=f-u,o=r.substr(u,c);r=r.replace(o,o.xmlEncode());u=r.indexOf('<Source SourceType="Value">',f)}else break}var l=parseXML("<Item><SourceValue>{0}<\/SourceValue><\/Item>".format(r)).documentElement;r=returnSourceValue({item:l,loopContextID:t,behaviour:q}).xmlDecode()}catch(a){r="";SFLog({type:1,source:"translateComplexSourceValue",category:"Events",message:a.message})}SFLog({type:1,source:"translateComplexSourceValue",category:"Events",message:h.message})}return r}function subformPopupOnClose(n,t){var q=n.options.subformContext;n.hide();try{var r=this.content[0].contentWindow.document.activeElement;r&&r.nodeName.toLowerCase()!=="body"&&r.blur()}catch(u){SFLog({type:4,source:"navigateAction",category:"Events",message:Resources.RuntimeMessages.WarningActiveElementNotFound})}removeLoopContextData({loopContextID:q.loopContextID});checkExists(q.closeBehaviour)?continuePromptingBehaviour(q.closeBehaviour):subformClosed(q,n,t)}function extractHandlerLogicForNavigation(n,t,q,r,u,f){var e="";if(n.length>0){for(e+="<Handlers>";n.length>0;){var s=n.shift(),h=getLoopContextID(s),d=s.getAttribute("Type");e+="<Handler Type='"+d+"' ";checkExists(q)&&(e+="OriginalEventType='"+q+"' ");e+=">";var a=$mn(s,"Conditions/Condition"),v=a.length;if(v>0){e+="<Conditions>";for(var c=0;c<v;c++){var y=a[c].cloneNode(!0);populateFilterValuesForNavigation(y,!0,!1,".//Item[@SourceType!='Value'] | .//Source[@SourceType!='Value']",h,u,f);e+=y.xml}e+="<\/Conditions>"}var p=$mn(s,"Actions/Action"),w=p.length;if(w>0){e+="<Actions>";for(var l=0;l<w;l++){var o=p[l].cloneNode(!0),g=o.getAttribute("Type");if(g==="Handler"){var b=constructHandlersForBehaviour(o,[],r,q,h);b.length>0&&(e+="<Action Type='Handler' ",checkExists(q)&&(e+="OriginalEventType='"+q+"'"),e+=">",e+=extractHandlerLogicForNavigation(b,t,q,r,u,f),e+="<\/Action>")}else checkExists(o.getAttribute("OriginalEventType"))||o.setAttribute("OriginalEventType",q),populateParameterValuesForNavigation(o,!0,u,t,!0,h,f),populateFilterValuesForNavigation(o,!0,t,null,h,u,f),e+=o.xml}e+="<\/Actions>"}var k=$sn(s,"Function");if(checkExists(k)){var nt=k.cloneNode(!0);e+=nt.xml}e+="<\/Handler>"}e+="<\/Handlers>"}return e}function populateParameterValuesForNavigation(n,t,q,r,u,f,e){for(var o=$mn(n,"Parameters/Parameter"),l=$xml(n.xml),a="",h,s=o.length;s--;){var v=o[s].getAttribute("TargetType");if(v!=="FormParameter"&&v!=="ViewParameter"||u){if(t){var y=$sn(o[s],"SourceValue"),b=o[s].getAttribute("SourceInstanceID");if(checkExists(y))replaceSourceValueForNavigation(l,y,b,f,q,e);else if(q){if(h=returnSourceValue({item:o[s],loopContextID:f,behaviour:e}),h.length>0){var p=l.createElement("SourceValue");p.appendChild(l.createTextNode(h));o[s].appendChild(p)}}else checkExists(o[s].getAttribute("SourceSubformID"))||checkExists(o[s].getAttribute("SourceOriginalLevel"))||o[s].setAttribute("SourceOriginalLevel",__runtimeFormLevel)}}else{var w=o[s].getAttribute("TargetID");if(h=returnSourceValue({item:o[s],loopContextID:f,behaviour:e}),checkExists(h)&&(a+="&"+w+"="+encodeURIComponent(h)),t){var c=o[s].parentNode;c.removeChild(o[s]);c.childNodes.length===0&&c.parentNode.removeChild(c)}}}return t&&checkExists(r)&&r===!0&&(checkExists(n.getAttribute("FormID"))||n.removeAttribute("InstanceID")),a}function replaceSourceValueForNavigation(n,t,q,r,u,f){var o=$mn(t,"Source");if(o.length===0&&(o=$mn(t,"Item")),o.length>0)for(var s=0;s<o.length;s++){var e=o[s];if(e.getAttribute("SourceType")!=="Value")if(u){var c=returnSourceValue({item:e,loopContextID:r,behaviour:f});if(checkExistsNotEmpty(c)){var h=n.createElement("Source");h.setAttribute("SourceType","Value");h.appendChild(n.createTextNode(c));t.replaceChild(h,e)}}else checkExists(e.getAttribute("SourceSubformID"))||checkExists(e.getAttribute("SourceOriginalLevel"))||e.setAttribute("SourceOriginalLevel",__runtimeFormLevel)}return t}function populateFilterValuesForNavigation(n,t,q,r,u,f,e){if(t){var h=".//Item/SourceValue/Item";checkExists(r)&&r.length>0&&(h=r);var s=$mn(n,h),o=s.length;if(o>0)for(var c=$xml(n.xml);o--;){if(f){var l=returnSourceValue({item:s[o],loopContextID:u,behaviour:e});if(l.length>0){var a=c.createElement("SourceValue");a.appendChild(c.createTextNode(l));s[o].appendChild(a)}}checkExists(s[o].getAttribute("SourceSubformID"))||checkExists(s[o].getAttribute("SourceOriginalLevel"))||s[o].setAttribute("SourceOriginalLevel",__runtimeFormLevel)}checkExists(q)&&q===!0&&(checkExists(n.getAttribute("FormID"))||n.removeAttribute("InstanceID"))}return n}function subformClosed(n,t,q){var c=n.formID,l=n.viewID,h=n.actionInstanceID,e=n.openBehaviour,r=n.behaviour;checkExists(e)&&checkExists(r)?r.openBehaviour=e:checkExists(e)&&!checkExists(r)&&(r=e);var o=SourceCode.Forms.Runtime.getMasterRuntimeWindow();if(t&&t.controls&&t.controls.body){var v=t.controls.body.find("iframe");o=SourceCode.Forms.Runtime.getPopupIframeContentWindow(v)}var s=!0;try{var u=null,f=null;if(checkExists(c)?(u="Form",f=c):checkExists(l)&&(u="View",f=l),checkExists(u)){var y=o.verifyEventHandling(f,u,"Closed",h);if(y)return s=!1,o.handleEvent(f,u,"Closed",null,h,null,r,!0,t,q);if(checkExists(t)&&checkExists(r)){if(checkExists(r.popup))return s=!1,o.handleEvent(f,u,"Closed",null,h,null,r,!0,t,q);s=!1;r.popup=t;r.closeEvent=!0;checkExists(r.openBehaviour)&&checkExists(r.openBehaviour.windowToUse)&&(!checkExists(r.handlers)||r.handlers.length===0)&&(!checkExists(r.actions)||r.actions.length===0)&&(r.windowToUse=r.openBehaviour.windowToUse);r.isExecuting=!1;r.executeBehaviour()}}}catch(p){var w={type:5,source:"subformClosed",category:"Events",message:Resources.RuntimeMessages.ErrorSubformClosed,exception:p};SFLog(w)}finally{if(s&&checkExists(t)){var a=SourceCode.Forms.Runtime.getRuntimeInstanceName(t);SourceCode.Forms.Runtime.removeRuntimeDataProperty(a,"windowContextValid");SourceCode.Forms.Runtime.removeRuntimeDataProperty(a,"windowContext");t.closed(q)}}}function focusAction(n,t,q){var o=getLoopContextID(n),u=n.getAttribute("ViewID"),r=n.getAttribute("PanelID"),f=n.getAttribute("FormID"),s=n.getAttribute("InstanceID");if(checkExists(f))f.toLowerCase()===currentForm&&n.setAttribute("OldType","Focus"),navigateAction(n,!0);else{if(!checkExists(r)&&checkExists(u)){var e=getViewDefinition(u,s);checkExists(e)&&(r=e.getAttribute("PanelID"))}checkExists(r)&&showSpecificPanel(r)}endActionExecution({loopContextID:o,behaviour:q})}function showSpecificPanel(n){var t=$find(currentForm);t&&t.set_active(_runtimeEmptyGuid+"_"+n)}function SetControlProperty(n,t,q,r,u,f,e){var tt={controlID:n,transferredID:r,runtimeContextID:u,isDestination:!0},c=findCorrectInstanceForDataTransfer(tt);if(checkExists(c)){var o=c.result;if(checkExists(o)){var l=o.getAttribute("ControlTemplate"),h=c.WindowToUse;t==="tabindex"&&q!==-1&&(q=calculateTabIndex(q,n));var a=new h.PopulateObject(null,q,n,t),qt=h.updateControlPropertyDefinition(o,a.property,a.Value,e);if(qt){if(checkExists($sn(o,"Properties/Property[Name/text()='SetProperty']"))&&h.executeControlFunction(o,"SetProperty",a),t==="timezone"){var k=$sn(o,"Properties/Styles"),d=StyleHelper.getDefaultStyleNode(k),s=d.selectSingleNode("Format");if(s===null){var rt=new PopulateObject(null,null,n,"Format"),g=h.executeControlFunction(o,"GetProperty",rt);checkExistsNotEmpty(g)&&(s=parseXML(g),checkExists(s)&&(s=s.documentElement.cloneNode(!0)));checkExists(s)?d.appendChild(s):s=k.ownerDocument.createElement("Format")}checkExists(s)&&s.setAttribute("TimeZone",q)}if(!f)if(t.toLowerCase()==="isvisible"||t.toLowerCase()==="isenabled")h.updateListControlStates(o,n,t,q.toString());else if(checkExists(l)&&l==="header"&&t.toLowerCase()==="text"){var v=o.parentNode.parentNode.getAttribute("MainTable");if(checkExists(v)){for(var y=jQuery("#"+v+" .grid-column-header-text."+n),p=y.length;p--;)y[p].innerHTML=q,y[p].setAttribute("title",q);var w=o.parentNode.parentNode.getAttribute("ID"),b=o.parentNode.parentNode.getAttribute("InstanceID"),nt=checkExists(b)?b+"_"+w:_runtimeEmptyGuid+"_"+w;runtimeFilterFields[nt]=null;populateQuickSearchDropdown(w,b,nt)}}else if(l==="display"){var ut=o.parentNode.parentNode,v=ut.getAttribute("MainTable");listRefreshCache.push(v);setTimeout(function(){updateAllListDisplays()})}}}}}function syncColumnWidthsOnPanel(n){refreshFormPadding({panelID:n});for(var t=$mn(viewControllerDefinition,"Controllers/Controller[@PanelID='"+n+"'][@TypeView='List']"),q=t.length;q--;){var r=jQuery("#"+t[q].getAttribute("MainTable"));r.is(":visible")&&SFRGrid.execute({element:r,fn:"runtimeSyncColumns"})}}function setFormProperty(n){var n=checkExists(n)?n:{};if(checkExistsNotEmpty(n.formId)&&checkExistsNotEmpty(n.propertyName)){var t="{0}_{1}".format(_runtimeEmptyGuid,n.formId),r="Controllers/Controller[@TypeView='']/Controls/Control[@ID='{0}']".format(t),q=viewControllerDefinition.selectSingleNode(r);if(checkExists(q)){var u=new PopulateObject(null,n.propertyValue,t,n.propertyName);executeControlFunction(q,"SetProperty",u)}}}function executeAction(n,t,q,r,u){var o=getLoopContextID(n),e=n.getAttribute("Type"),s=n.getAttribute("ItemState"),f=null;checkExists(q)||(q=!1);SFLog({type:1,source:"executeAction",category:"Events",message:"{0} action",parameters:[e],data:n});var h=n.getAttribute("OriginalEventType");checkExists(h)&&h!=="System"&&fireExpressions(!0);switch(e){case"Transfer":dataTransferAction(n,t,r);break;case"PopulateControl":executePopulateControlAction(n);checkExists(r)&&(r.isExecuting=!1);break;case"List":f=listExecutionAction(n,t,q,r);break;case"Focus":focusAction(n,t,r);break;case"Calculate":calculateAction(n,t,r);break;case"ExecuteWorkflow":if(checkExists(q)&&q===!0)f=workflowAction(n,r,q);else return workflowAction(n,r,q);case"Navigate":navigateSimpleAction(n,r);break;case"Prompt":var v=SourceCode.Forms.Runtime.getMasterRuntimeWindow();v.promptAction(n,t,r);break;case"Validate":validateAction(n,t,r);break;case"Open":openAction(n,r);break;case"Popup":popupTypeExecution({behaviour:r,currentAction:n});break;case"Close":checkExists(n.getAttribute("CloseTarget"))&&n.getAttribute("CloseTarget")!=="Browser"?executeEventAction(n,t,e,q,null,r,null,u):closeAction(n);break;case"Disable":setFormProperty({formId:n.getAttribute("FormID"),propertyName:"hasDisableOverlay",propertyValue:!0});endActionExecution({loopContextID:o,behaviour:r});break;case"Enable":setFormProperty({formId:n.getAttribute("FormID"),propertyName:"hasDisableOverlay",propertyValue:!1});eventsCancelled=!1;endActionExecution({loopContextID:o,behaviour:r});break;case"SendMail":return mailAction(n,r);case"ShowMessage":var c=window,l=n.getAttribute("MessageLocation");checkExists(l)&&l==="Popup"&&(c=SourceCode.Forms.Runtime.getMasterRuntimeWindow());c.messageAction(n,r,t,window);break;case"ExecuteSharePoint":executeSharePointAction(n,r);break;case"ApplyStyle":applyStyleAction(n,r);break;case"ExecuteControl":ControlMethodExecuteAction(n,r);break;case"Continue":continueBehaviour(r);break;case"Exit":exitBehaviour(r);break;case"Handler":if(checkExists(r)){var a=constructHandlersForBehaviour(n,[],r.closeEvent,n.getAttribute("OriginalEventType"),o);a.length>0&&(checkExists(r.handlers)&&(r.parentHandlers.push(r.handlers),r.previousActions.push(r.actions),r.actions=[]),r.handlers=a);r.isExecuting=!1}removeLoopContextData({loopContextID:o});break;default:if(checkExists(s)&&s!=="All")f=executeCollectiveListMethod(n,t,e,q,s,r);else if(checkExists(q)&&q===!0)f=executeEventAction(n,t,e,q,null,r,null,u);else return executeEventAction(n,t,e,q,null,r,null,u)}if(q===!0)return typeof f!="undefined"&&f!==null?f:null}function executePopulateControlAction(n){var q=n.getAttribute("ObjectID"),t=n.getAttribute("ControlID"),r=n.getAttribute("ViewID"),u=n.getAttribute("InstanceID"),k=getLoopContextID(n),d=returnCurrentViewXML(r,u),s="Primary_"+q+"_"+q;if(checkExists(t)){var h=new dataSourceLookup({xmlDoc:d,includeControllers:!1,includeController:!1,sourceControlID:t,isComposite:null}).getDataSource();checkExists(h)&&(s=h.getAttribute("ContextType")+"_"+h.getAttribute("ContextID")+"_"+q)}var c=parseXML("<Filters/>"),l=n.childNodes,f;if(checkExists(l)&&l.length>0&&(f=l[0]),checkExists(f)&&checkExists(f.childNodes)){var g=window.self,nt=inspectAndReplaceFilterXml(f.childNodes[0],c,s,g,k);c.documentElement.appendChild(nt)}var tt={parenttype:"Object",controlid:t,counter:!0},a=getHiddenPropertyCollection(r,u,tt);if(!checkExists(a))throw"unable to find hidden view fields for view with Id: "+r+" and instance with Id: "+u;var e=_runtimeControllerFindObject({controlID:t,propertySearch:"SetItems"});if(checkExists(e)){var o=new PopulateObject(null,null,t),v={smartobject:{guid:q,resultName:s,method:{filter:c.xml}}};o.brokerPackageXML=[v];var y=executeControlFunction(e,"SettingItems",o);if(modalizeView=o.modalizeView!==!1,skipExecution=o.skipExecution===!0,skipExecution===!0){setTimeout(function(){typeof behaviour!="undefined"&&checkExists(behaviour)&&(behaviour.isExecuting=!1,behaviour.executeBehaviour())},0);return}if(checkExists(y))for(var p=0;p<y.length;p++){var w=filterListClientSide(y[p],a,{reverse:!1}),b=new PopulateObject(null,null,t,null,null,w);executeControlFunction(e,"SetItems",b)}else{var w=filterListClientSide(v,a,{reverse:!1}),b=new PopulateObject(null,null,t,null,null,w);executeControlFunction(e,"SetItems",b)}SourceCode.Forms.Runtime.Information.setControlBrokerHistory({viewId:r,instanceId:u,controlId:t,value:v})}}function executeEventAction(n,t,q,r,u,f,e,o){var c=getLoopContextID(n),l=n.getAttribute("EventID"),a=n.getAttribute("InstanceID");if(checkExists(o)||(o=window.self),checkExists(l)){var b=checkExists(a)?"[@InstanceID='"+a+"']":"",v="Events/Event[@DefinitionID='"+l+"']"+b,s=null,h=null,p=null;if(checkExists(runtimeNavigatedEvents)&&(s=$sn(runtimeNavigatedEvents,v)),s===null&&checkExists(formBindingXml)&&(s=$sn(formBindingXml,v)),s===null){var y=locateEventInfoOnWindow(v);y&&(p=y.windowToUse,h=y.event)}if(s)return handleEvent(s.getAttribute("SourceID"),s.getAttribute("SourceType"),$sn(s,"Name").text,null,a,null,f,null,null,null,l,c);if(checkExists(h))return p.handleEvent(h.getAttribute("SourceID"),h.getAttribute("SourceType"),$sn(h,"Name").text,null,a,null,f,null,null,null,l,c);removeLoopContextData({loopContextID:c});checkExists(f)&&(f.isExecuting=!1,f.executeBehaviour())}else{var w=n.getAttribute("Method");if(checkExists(w))return executeEventActionOnWindow(n,t,q,r,u,f,e,o,w);q==="Close"?closeTypeExecution(f):endActionExecution({loopContextID:c,behaviour:f})}}function executeEventActionOnWindow(n,t,q,r,u,f,e,o,s){var y=getLoopContextID(n),h=n.getAttribute("ViewID"),b=n.getAttribute("InstanceID"),d=n.getAttribute("ControlID"),k=null,pt=null,st="Capture",dq="",gq=null;checkExists(h)&&(k=returnCurrentViewXML(h,b),checkExists(k)&&(pt=k.getAttribute("MainTable"),st=k.getAttribute("TypeView"),dq=returnInstanceXP(k.getAttribute("InstanceID"),!1,!1,!0,!1),gq=k.getAttribute("ContextID")));var a=n.getAttribute("ObjectID");if(!checkExists(a)){var gu=checkExistsNotEmpty(pt)?$("#"+pt):null;switch(s){case"OnError":return q==="Close"&&closeTypeExecution(f),executeErrorMethod(n,f);case"Clear":return clearViewControls(h,k,!0,b,null,n,!0),st==="List"&&clearTable(pt,h,b,!0,null,null,y),handleEvent(h,"View",s,null,b,null,null,null,null,null,null,y),q==="Close"?closeTypeExecution(f):endActionExecution({loopContextID:y,behaviour:f}),null;case"ListRefresh":return q==="Close"&&closeTypeExecution(f),refreshList(h,null,b,f),null;case"Init":case"PostInit":var rt=null,ut=null;if(checkExists(h))rt=h,ut="View";else if(checkExists(n.getAttribute("FormID"))){var nf=n.getAttribute("FormID");rt=nf;ut="Form"}return(q==="Close"&&closeTypeExecution(f),checkExists(rt)&&checkExists(ut))?(dataTransferAction(n,s),handleEvent(rt,ut,s,null,b,null,f,null,null,null,null,y)):null;case"Collapse":case"Expand":var tf={viewID:h,currentAction:n,target:"isexpanded",sourceValue:s==="Expand",loopContextID:y};return updateViewProperty(tf),q==="Close"?closeTypeExecution(f):endActionExecution({loopContextID:y,behaviour:f}),null;case"ListExportExcel":if(typeof __runtimeOpenXmlAssemblyFound=="undefined"||__runtimeOpenXmlAssemblyFound.toString().toUpperCase()!=="FALSE"){var qf={viewXml:k,viewHtml:gu,currentAction:n,actionType:q,rowCounter:u,originalWindow:o,specifiedResultName:e,behaviour:f};executeListExportExcel(qf)}else checkExists(f)?f.handleError("openxmlnotfound",null,null,null,null,y):masterPopupManager.showError(constructOpenXmlNotFoundErrorMessage());return null;case"Submit":var rt=null,ut=null,br=n.getAttribute("FormID");if(checkExistsNotEmpty(br)?(rt=br,ut="Form"):(rt=currentForm,ut=_runtimeCallerType),q==="Close"&&closeTypeExecution(f),checkExistsNotEmpty(rt)&&checkExistsNotEmpty(ut)){var rf=window,uf=function(){handleEvent(rt,ut,s,null,b,null,f,null,null,null,null,y)},ff=SourceCode.Forms.Runtime.getMasterRuntimeWindow();return ff.SourceCode.Forms.Runtime.MobileBridge.startFormSubmit().done(function(){uf.apply(rf,[])})}return null}}!checkExists(a)&&checkExists(k)&&(a=k.getAttribute("ContextID"));for(var kr=!0,qq=!1,ft="";ft.length===0;){if(!checkExists(a)){ft="emptySO";break}var wt="Primary_"+a+"_"+a;if(checkExistsNotEmptyGuid(gq)&&checkExistsNotEmptyGuid(a)&&gq!==a&&(wt="External_"+a+"_"+a),checkExists(d)){var dr=null;e&&(dr="True");var nr=new dataSourceLookup({xmlDoc:k,includeControllers:!1,includeController:!1,sourceControlID:d,isComposite:dr}).getDataSource();checkExists(nr)&&(wt=nr.getAttribute("ContextType")+"_"+nr.getAttribute("ContextID")+"_"+a)}for(var c={guid:a,resultName:wt,method:{name:s}},cq=o,gr=null,nt=[],ef=[],tt=[],nu=$mn(n,"Parameters/Parameter"),tu=nu.length;tu--;){var v=nu[tu],ht=v.getAttribute("SourceID"),qt=v.getAttribute("TargetID"),rq=v.getAttribute("IsRequired"),bt=!1,et=v.getAttribute("SourceType"),kt=v.getAttribute("TargetType"),tr=v.getAttribute("SourceInstanceID"),lq=v.getAttribute("TargetInstanceID"),qr=$sn(v,"ActualValue"),l=$sn(v,"SourceValue");if(checkExists(qr)&&(gr=qr.text),(checkExists(l)&&et!=="Value"||checkExists(qr))&&t==="OnChange"){var of="Events/Event[@SourceType='Control'][Name/text()='OnChange']/Handlers/Handler/Actions/Action/Parameters/Parameter[@SourceID='"+ht+"'][@SourceType='"+et+"'][@TargetID='"+qt+"'][@TargetType='"+kt+"'][(ActualValue) or (SourceValue)]",uq=$sn(formBindingXml,of),dt,gt;checkExists(uq)&&(dt=$sn(uq,"SourceValue"),gt=$sn(uq,"ActualValue"),checkExists(dt)&&uq.removeChild(dt),checkExists(gt)&&uq.removeChild(gt));dt=$sn(v,"SourceValue");gt=$sn(v,"ActualValue");checkExists(dt)&&v.removeChild(dt);checkExists(gt)&&v.removeChild(gt)}var aq=null;et==="MethodParameter"&&(aq=new parameterContext(h,a,s));var nq=u;checkExists(nq)&&et==="ViewField"&&checkExists(lq)&&checkExists(tr)&&lq!==tr&&(nq=null);l=cq.returnSourceValue({item:v,counter:nq,context:aq,specifiedResultName:e,returnNulls:!0,loopContextID:y,behaviour:f});var qu=!1;if(checkExists(l)&&l.length!==0||(checkExists(l)||(qu=!0,l=""),bt=!0),st==="List"&&!checkExists(w)){var ct=$sn(v,"PreviousValue");qu&&checkExists(ct)?(l=ct.text,bt=!1):(checkExists(ct)&&v.removeChild(ct),ct=v.ownerDocument.createElement("PreviousValue"),ct.appendChild(v.ownerDocument.createTextNode(l)),v.appendChild(ct))}if(et==="MethodParameter"&&rq==="true"){var ru=[ht,l,rq];tt.push(ru)}if(rq==="true"&&(l.length===0||!checkExists(l)||bt===!0))switch(et){case"ViewField":var uu=returnFieldAttributeObject(ht,tr);checkExistsNotEmpty(uu.name)?nt.push(uu.name):kt==="ObjectProperty"||kt==="MethodParameter"?nt.push(qt):nt.push(ht+" (missing)");break;case"MethodParameter":l="";ef.push(ht);break;case"Control":var fu=_runtimeControllerFindObject({controlID:ht});fu?nt.push(fu.getAttribute("Name")):kt==="ObjectProperty"||kt==="MethodParameter"?nt.push(qt):nt.push(ht+" (missing)")}switch(kt){case"ObjectProperty":var fq={},p=v.cloneNode(!0),vq=!1;if(et==="Value"&&checkExists(r)&&r===!0&&$sn(p,"SourceValue")){var lt=$mn(p,"SourceValue/*[@SourceType='ViewField']");if(lt.length>0){for(var eu=!1,at=0;at<lt.length;at++){var yq=returnFieldAttributeObject(lt[at].getAttribute("SourceID"),lt[at].getAttribute("SourceInstanceID"));if(checkExists(yq)&&(yq.instanceID==p.getAttribute("TargetInstanceID")||checkExists(h)&&yq.viewID==h||checkExists(a)&&yq.parentID==a||(eu=!0)),eu){var ou=nq;checkExists(nq)&&checkExists(lq)&&checkExists(lt[at].getAttribute("SourceInstanceID"))&&lq!==lt[at].getAttribute("SourceInstanceID")&&(ou=null);var su=cq.returnSourceValue({item:lt[at],counter:ou,context:aq,specifiedResultName:e,returnNulls:!0,loopContextID:y,behaviour:f});if(!checkExists(su)||su.length===0){vq=!0;bt=!0;break}}}vq&&(fq.multipleValues=determineMultiValueMapping(p,y,f,null,nq,aq,e,!0))}}bt?((et==="ViewField"&&checkExists(r)&&r===!0||vq===!0)&&(nt.pop(),fq.parameter={sourceType:p.getAttribute("SourceType"),sourceId:p.getAttribute("SourceID"),sourcePath:p.getAttribute("SourcePath"),sourceInstanceID:p.getAttribute("SourceInstanceID"),sourceSubFormID:p.getAttribute("SourceSubFormID"),targetType:p.getAttribute("TargetType"),targetId:p.getAttribute("TargetID"),targetPath:p.getAttribute("TargetPath"),targetInstanceID:p.getAttribute("TargetInstanceID"),targetSubFormID:p.getAttribute("TargetSubFormID")}),vq||(fq.cleared=bt.toString())):fq.value=l;checkExists(c.properties)||(c.properties={});c.properties[qt]=fq;break;case"MethodParameter":if(checkExists(l)&&l.length!==0)setHiddenJSONValue(a,"Object",h,null,null,null,s,null,null,null,qt,"MethodParameter",l);else{var pq=n.getAttribute("ParametersEvaluated");if(pq!=="true"){var hu=!0,cu=tt.length;if(cu>0)for(var rr=0;rr<cu;rr++)if(tt[rr][0]===qt){hu=!1;break}if(hu&&rq==="true"){l=getHiddenParameter(h,a,qt,s);var ru=[qt,l,rq];tt.push(ru)}}}checkExistsNotEmpty(l)&&(checkExists(c.parameters)||(c.parameters={}),c.parameters[qt]={value:l})}}var ur=!0;if(nt.length>0)warnOfEmptyFields(nt),ur=!1;else if(tt.length>0){var pq=n.getAttribute("ParametersEvaluated");pq==="false"&&tt.length>0||!checkExists(pq)?(promptForSOParameters(s,tt,h,a,n,u,q,r,f,b),ur=!1):pq==="true"&&tt.length===0&&n.removeAttribute("ParametersEvaluated")}else tt.length===0&&n.removeAttribute("ParametersEvaluated");if(ur===!1){ft="emptyRequiredValues";break}var w,fr=$mn(n,"Results/Result"),er=fr.length;if(er>0){for(var or=[];er--;){var vt=fr[er],sr=vt.getAttribute("TargetID"),sf=vt.getAttribute("TargetInstanceID"),lu=vt.getAttribute("TargetType"),wq=vt.getAttribute("SourceType"),hf=vt.getAttribute("SourceID"),cf=vt.getAttribute("SourceInstanceID"),hr="";if(wq==="Value"){var l=$sn(vt,"SourceValue");checkExists(l)&&checkExistsNotEmpty(l.xml)&&(hr=l.xml)}checkExists(sr)&&lu==="Control"&&wq!=="ObjectProperty"&&wq!=="Value"&&(w=sr);var au={targetID:sr,targetType:lu,sourceType:wq,sourceID:hf,sourceInstanceID:cf,targetInstanceID:sf};checkExistsNotEmpty(hr)&&(au.sourceValue=hr);or.push(au)}or.length>0&&(c.results=or)}var cr=!1;if(checkExists(h)){var bq=null;if(!checkExists(u)&&checkExists(d)?bq="[@SourceControlID='"+d+"' and (@DisplaySO)][not(@IsComposite)]":st!=="Capture"?cr=!0:checkExists(u)||checkExists(d)||(bq="[(@ParentControlID) or (@IsComposite)]"),checkExists(bq)){var lf=$sn(viewControllerDefinition,"Controllers/Controller[@ID='"+h+"']"+dq+"/Associations/Association[not(@RootSO)]"+bq);checkExists(lf)&&(cr=!0)}}if(cr){var vu=null;checkExists(d)||(vu=a);var yu=null;st==="Capture"||checkExists(d)||(yu=!0);var af=new dataSourceLookup({xmlDoc:viewControllerDefinition,selectMultiple:!0,controllerID:h,instanceXP:dq,notRootSO:!0,sourceControlID:d,originalContextID:vu,controlDisplayTemplate:yu}).getDataSource();buildAssociationsForPackage(af,c)}var kf=c.method.name,eq=$sn(n,"Filter");if(eq&&eq.hasChildNodes()){eq=eq.cloneNode(!0);var lr=$xml("<Filters/>"),pu=inspectAndReplaceFilterXml(eq.childNodes[0],lr,wt,cq,y);pu.hasChildNodes()&&(lr.documentElement.appendChild(pu),c.method.filter=lr.xml)}var ar=$sn(n,"Order");ar&&ar.hasChildNodes()&&inspectAndReplaceSortingXml(ar.childNodes[0].cloneNode(!0),c,wt);var tq="",ot="",vr="",yr="",oq=null;if(st!=="List"||checkExists(w)||checkExists(d)){if(checkExists(w)||(w=n.getAttribute("ControlID")),checkExists(w)){var yf=checkExists(c.method.sorters)&&c.method.sorters.length>0;try{if(!yf){var yt=new dataSourceLookup({xmlDoc:k,includeControllers:!1,includeController:!1,sourceControlID:w}).getDataSource();if(checkExists(yt)&&(ot=yt.getAttribute("DisplayTemplate"),checkExists(ot))){ot=returnDisplayPropertyFromTemplate(ot);yr="ascending";var pf=yt.getAttribute("DisplaySO")?yt.getAttribute("DisplaySO"):yt.getAttribute("AssociationSO");vr=yt.getAttribute("ContextType")+"_"+yt.getAttribute("ContextID")+"_"+pf}}}catch(df){}}}else{var vf=buildFilterForPackage(h,pt,c,b,wt,cq,y);if(vf===!1){ft="filterFailed";break}var g=document.getElementById(pt);if(checkExists(g)){ot=g.getAttribute("OrderBy");vr=g.getAttribute("OrderByResultName");yr=g.getAttribute("OrderDirection");var sq=getExportToExcelData({viewId:h,instanceId:b});if(sq.busyExporting!==!0){if(oq=g.getAttribute("PageSize"),checkExists(oq)&&oq.length>0){var wu=g.getAttribute("Paging");wu&&wu!=="false"||g.removeAttribute("PageNumber");g.removeAttribute("Paging");tq=g.getAttribute("PageNumber");checkExists(tq)&&tq.length!==0||(tq="1")}}else checkExistsNotEmpty(sq.pageSize)&&(oq=sq.pageSize.toString()),checkExistsNotEmpty(sq.pageNumber)&&(tq=sq.pageNumber.toString());var hq=n.xml;q==="Close"&&(hq=n.cloneNode(!0),hq.setAttribute("Type","Execute"),hq=hq.xml);g.setAttribute("previousactionxml",hq)}}var bu=!1;if(checkExists(d)&&!w){var ku=n.getAttribute("ItemState");bu=!checkExists(ku)||ku.toUpperCase()!=="ALL";w=d}checkExists(ot)&&ot.length>0&&constructSortingStructure(c,ot,vr,yr);var wf=buildMetadataObject(h,s,st,w,gr,u,tq,oq,b,a);checkExists(c)&&(c={smartobject:c,metadata:wf});var pr=[c];if(checkExists(w)&&!bu){var du=_runtimeControllerFindObject({controlID:w,propertySearch:"SettingItems"});if(checkExists(du)&&(fr.length>0||q==="PopulateControl")){_runtimePresetControls.push(w);var kq=new PopulateObject(null,null,w,null,null,c);kq.brokerPackageXML=pr;var wr=executeControlFunction(du,"SettingItems",kq);wr&&Array.isArray(wr)&&(pr=wr);kr=kq.modalizeView!==!1;qq=kq.skipExecution===!0}}ft="passed";break}if(ft==="emptyRequiredValues"||ft==="filterFailed")return null;if(q==="Close"&&closeTypeExecution(f),ft=="emptySO"&&(qq=!0),checkExists(c)>0&&qq===!1&&SFLog({type:1,source:"executeEventActionOnWindow",category:"Events",message:"Smartobject executing {0}",parameters:[s],data:c}),checkExists(r)&&r===!0)return qq===!0?"":(checkExists(c)&&checkExists(h)&&runtimeBusyView(h,!0,!0,b),c);if(qq===!0){setTimeout(function(){removeLoopContextData({loopContextID:y});checkExists(f)&&(f.isExecuting=!1,f.executeBehaviour())},0);return}return checkExists(h)&&kr&&runtimeBusyView(h,!0,!0,b),sendPacket(pr,f,[n])}function buildAssociationsForPackage(n,t){if(checkExists(n)){var u=n.length;if(u==0)return;for(t.associations=[];u--;){var r={},q=n[u];checkExistsNotEmpty(q.getAttribute("AssociationMethod"))&&(r.AssociationMethod=q.getAttribute("AssociationMethod"));checkExistsNotEmpty(q.getAttribute("ValueProperty"))&&(r.ValueProperty=q.getAttribute("ValueProperty"));checkExistsNotEmpty(q.getAttribute("DisplayTemplate"))&&(r.DisplayTemplate=q.getAttribute("DisplayTemplate"));checkExistsNotEmpty(q.getAttribute("AssociationSO"))&&(r.AssociationSO=q.getAttribute("AssociationSO"));checkExistsNotEmpty(q.getAttribute("AssociatedJoinProperty"))&&(r.AssociatedJoinProperty=q.getAttribute("AssociatedJoinProperty"));checkExistsNotEmpty(q.getAttribute("DisplaySO"))&&(r.DisplaySO=q.getAttribute("DisplaySO"));checkExistsNotEmpty(q.getAttribute("DisplayMethod"))&&(r.DisplayMethod=q.getAttribute("DisplayMethod"));checkExistsNotEmpty(q.getAttribute("DisplayJoinProperty"))&&(r.DisplayJoinProperty=q.getAttribute("DisplayJoinProperty"));checkExistsNotEmpty(q.getAttribute("IsComposite"))&&(r.IsComposite=q.getAttribute("IsComposite"));checkExistsNotEmpty(q.getAttribute("ParentControlID"))&&(r.ParentControlID=q.getAttribute("ParentControlID"));checkExistsNotEmpty(q.getAttribute("ParentJoinProperty"))&&(r.ParentJoinProperty=q.getAttribute("ParentJoinProperty"));checkExistsNotEmpty(q.getAttribute("ChildJoinProperty"))&&(r.ChildJoinProperty=q.getAttribute("ChildJoinProperty"));checkExistsNotEmpty(q.getAttribute("ContextID"))&&(r.ContextID=q.getAttribute("ContextID"));checkExistsNotEmpty(q.getAttribute("ContextType"))&&(r.ContextType=q.getAttribute("ContextType"));checkExistsNotEmpty(q.getAttribute("OriginalProperty"))&&(r.OriginalProperty=q.getAttribute("OriginalProperty"));checkExistsNotEmpty(q.getAttribute("OriginalContextID"))&&(r.OriginalContextID=q.getAttribute("OriginalContextID"));checkExistsNotEmpty(q.getAttribute("OriginalContextType"))&&(r.OriginalContextType=q.getAttribute("OriginalContextType"));checkExistsNotEmpty(q.getAttribute("SourceControlID"))&&(r.SourceControlID=q.getAttribute("SourceControlID"));checkExistsNotEmpty(q.getAttribute("ControlID"))&&(r.ControlID=q.getAttribute("ControlID"));checkExistsNotEmpty(q.getAttribute("FilterProperty"))&&(r.FilterProperty=q.getAttribute("FilterProperty"));t.associations.push(r)}}}function determineMultiValueMapping(n,t,q,r,u,f,e,o,s){var c=[],l=$mn(n,"SourceValue/Source");if(l.length===0&&(l=$mn(n,"SourceValue/Item")),l.length>0)for(var a=0;a<l.length;a++){var h=l[a],y=u;checkExists(u)&&checkExists(s)&&checkExists(h.getAttribute("SourceInstanceID"))&&s!==h.getAttribute("SourceInstanceID")&&(y=null);var v=returnSourceValue({item:h,customProcessData:r,counter:y,context:f,specifiedResultName:e,returnNulls:o,loopContextID:t,behaviour:q});if(checkExistsNotEmpty(v)){var p=c[c.length-1];typeof p=="string"?c[c.length-1]=p.concat(v):c.push(v)}else{var w={sourceType:h.getAttribute("SourceType"),sourceId:h.getAttribute("SourceID"),sourcePath:h.getAttribute("SourcePath"),sourceInstanceID:h.getAttribute("SourceInstanceID"),sourceSubFormID:h.getAttribute("SourceSubFormID")};c.push(w)}}return c}function executeCollectiveListMethod(n,t,q,r,u,f){var v=getLoopContextID(n),y=[],c=n.getAttribute("ViewID"),l=n.getAttribute("InstanceID"),a=null,o=null,b=getViewDefinition(c,l);if(checkExists(b)&&(o=b.getAttribute("MainTable"),a=b.getAttribute("ContextID"),checkExists(o)&&o.length>0)){var g=jQuery("#"+o);g[0].getAttribute("editable")==="true"&&attemptItemChanges(g,c,l,v,u)}var e=n.getAttribute("ObjectID"),k=n.getAttribute("ControlID");if((!checkExists(e)||e.length===0)&&(e=a,!checkExists(e)||e.length===0))return executeEventAction(n.cloneNode(!0),t,q);var s={parentid:e,parenttype:"Object",counter:!0,contexttype:"Primary",state:u},nt=null;if(checkExists(k)&&(s={parentid:e,parenttype:"Object",state:u,controlid:k,counter:!0},u.toLowerCase()==="unchanged"?s={parentid:e,parenttype:"Object",state:u,counter:!0}:nt=!0),u.toLowerCase()==="selected"){var p=getLoopContextData({loopContextID:v,viewID:c,instanceID:l}).counter;!checkExists(p)&&checkExists(o)&&o.length>0&&(p=getViewSelectedCounter(o));s=checkExists(p)?{parentid:e,parenttype:"Object",counter:p,contexttype:"Primary"}:null}if(checkExists(s)){var h=getHiddenPropertyCollection(c,l,s),w=h.length;if(checkExists(h)&&w!==0||!checkExists(a)||a===e||checkExists(k)||u.toLowerCase()==="selected"||(s={parentid:a,parenttype:"Object",state:u,contexttype:"Primary",counter:!0},h=getHiddenPropertyCollection(c,l,s),w=h.length),checkExists(h)&&w>0){for(var qt=w,d=0;d<qt;d++){var rt=h[d].counter,tt=executeEventAction(n.cloneNode(!0),t,q,!0,rt,null,nt);checkExists(tt)&&y.push(tt)}if(checkExists(r)&&r===!0)return y;var ut=extendBatchedActions([],y,n);sendPacket(y,f,ut)}else{if(checkExists(r)&&r===!0)return"";endActionExecution({loopContextID:v,behaviour:f})}}else{if(checkExists(r)&&r===!0)return"";endActionExecution({loopContextID:v,behaviour:f})}}function extendBatchedActions(n,t,q){if(checkExists(n)||(n=[]),checkExists(q)&&checkExists(t)){var r=0;if(typeof t=="string"){var u=new RegExp("<brokerpackage>","gi");r=t.match(u).length}else if(checkExists(t.xml)){var f=$mn(t,"//brokerpackage");r=f.length}else r=t.length,checkExists(r)||(r=1);if(r>0)for(var e=q.cloneNode(!0);r--;)n.push(e)}return n}function buildMetadataObject(n,t,q,r,u,f,e,o,s,h){var c={};return checkExistsNotEmpty(n)&&(c.id=n),checkExistsNotEmpty(t)&&(c.methodexecuted=t),checkExistsNotEmpty(q)&&(c.typeofview=q),checkExistsNotEmpty(u)&&(c.actualvalue=u),checkExistsNotEmpty(f)&&(c.rowcounter=f),checkExistsNotEmpty(r)&&(c.idofcontrol=r),checkExistsNotEmpty(e)&&(c.pagenumber=e),checkExistsNotEmpty(o)&&(c.pagesize=o),checkExistsNotEmpty(s)&&(c.instanceid=s),checkExists(h)&&h.length>0&&(c.objectid=h),c}function navigateSimpleAction(n,t){if(checkExists(n.getAttribute("Url"))||checkExists(n.getAttribute("FormID"))){n.setAttribute("OldType","Navigate");checkExists(n.getAttribute("Method"))&&n.getAttribute("Method").length>0?n.setAttribute("Type","Execute"):n.setAttribute("Type","Transfer");navigateAction(n,!0,t);return}}function openAction(n,t){n.setAttribute("OldType","Open");checkExists(n.getAttribute("Method"))&&n.getAttribute("Method").length>0?n.setAttribute("Type","Execute"):n.setAttribute("Type","Transfer");navigateAction(n,!0,t);return}function closeAction(n){var h=n.getAttribute("FormID"),u=parseInt(__runtimeFormLevel,10),t=SourceCode.Forms.Runtime.getMasterRuntimeWindow();if(checkExists(h)){var q=$mn(n,"Parameters/Parameter"),f=$xml(n.xml);if(q.length>0)for(var c=getLoopContextID(n),r=0;r<q.length;r++){var e=returnSourceValue({item:q[r],loopContextID:c});if(checkExistsNotEmpty(e)){var o=f.createElement("SourceValue");o.appendChild(f.createTextNode(e));q[r].appendChild(o)}}var s=t;u>1&&(s=getPopupWindowOnLevel(t,parseInt(u,10)-1));s.dataTransferAction(n);t.popupManager.closeLast()}else u>0&&t.popupManager.closeLast(),checkExists(t.dialogArguments)||checkExists(t.opener)?(t.close(),t.closed===!1&&SourceCode.Forms.Runtime.MobileBridge.inMobileAppContext()&&(t.location="about:blank")):t.location="about:blank"}function getSourceFieldValue(n,t,q,r,u,f,e){var s="",w=t,h=returnFieldAttributeObject(n,r);if(h){var d=h.viewType.toLowerCase();if(d==="list"){if(!checkExists(t)){var a=h.mainTable;checkExists(a)&&document.getElementById(a).getAttribute("editable")!=="true"&&(t=getLoopContextData({loopContextID:e,viewID:h.viewID,instanceID:h.instanceID}).counter,checkExists(t)||(t=getViewSelectedCounter(a)))}}else checkExists(t)&&h.contextType!=="External"&&(t=null);s=getHiddenFieldValue(n,t,null,q,h.instanceID,e)}if(checkExists(s)||u){if(checkExists(s)&&s.length>0&&f){var c=h.propertyType,o=s,l;switch(c.toLowerCase()){case"file":case"image":var v=null;if(o.startsWith("<collection>")){var g=baseCollectionXPath+"/fields/field[@name='FileName']/value";l=$xml(o);var nt=$sn(l,g).text;o=nt;v=$sn(l,baseCollectionXPath+"/fields/field[@name='FilePath']/value")}if(o.length>0){valuetext=o;var y;if(y=v?constructFileSrc(v.text,"path",c.toLowerCase(),100,100,t):constructFileSrc(n,"field",c.toLowerCase(),100,100,t),c.toLowerCase()==="image"){var b="";checkExists(w)&&(b="' counter='"+w);o="<img class='fileImage' alt='"+o+"' title='"+o+"' src='"+y+b+"' />"}else o="<a path='"+y+"' class='fileImage'>"+o+"<\/a>"}break;case"hyperlink":if(o=reverseReplaceSpecialChars(o),o=o.startsWith("<a")?"<value>"+o+"<\/value>":textNode.xml,o.length>0){valuetext=o;l=$xml(o);o="";var p=$sn(l,"value/a");if(checkExists(p)){var k=p.getAttribute("href");o=p.text;o.length===0&&(o=k);o="<a target='_blank' href='"+k.htmlEncode()+"'>"+o.htmlEncode()+"<\/a>"}}break;case"date":case"time":case"datetime":o=returnDateValue(s,c.toLowerCase())}s!==o&&(s=o)}}else s="";return s}function getControlFieldValue(n,t,q,r){var u=null;if(checkExistsNotEmpty(n)){var e=getViewDefinition(null,t);if(checkExists(e)){var o=e.getAttribute("ID"),f=getLoopContextData({loopContextID:r,viewID:o,instanceID:t,controlID:q});if(checkExists(f.item))switch(n.toUpperCase()){case"ISDEFAULTSTATICFIELD":u=checkExists(f.item.isDefault)?f.item.isDefault:!1;break;case"VALUESTATICFIELD":u=f.item.value;break;case"DISPLAYSTATICFIELD":u=f.item.display}}}return checkExists(u)||(u=""),u}function clearViewControls(n,t,q,r,u,f,e,o){var b=getLoopContextID(f),h="Controls/Control[Properties/Property/Name/text()='SetValue']";if(o&&(h+="[(@ControlTemplate='edit' or @ControlTemplate='display')]"),u&&(h+="[(@FieldID)]"),checkExists(f)){var v=!0,c=$mn(f,"Results/Result[@TargetType='ViewField']"),s=c.length;if(s>0)for(v=!1;s--;)setHiddenFieldValue(c[s].getAttribute("TargetID"),"",null,r,null,null,null,b);if(c=$mn(f,"Results/Result[@TargetType='Control']"),s=c.length,s>0){for(v=!1,h+="[";s--;)h+="(@ID='"+c[s].getAttribute("TargetID")+"')",s>0&&(h+=" or ");h+="]"}v&&removeHiddenPropertyCollection(n,null,null,null,!1,!1,null,r)}if(checkExists(t))for(var k=$mn(t,h),y=0;y<k.length;y++){var l=k[y],a=l.getAttribute("ID"),p=new PopulateObject(null,"",a);if(checkExists(e)&&e===!0&&checkExists($sn(l,"Properties/Property[Name/text()='GetDefaultValue']"))){var w=executeControlFunction(l,"GetDefaultValue",p);checkExists(w)&&w.length>0&&(p=new PopulateObject(null,w,a))}executeControlFunction(l,"SetValue",p);q===!0&&(startClearingDependantParentValues(a),handleEvent(a,"Control","Init",null,r,null,null,null,null,null,null,b))}}function warnOfEmptyFields(n){hideRuntimeInitSpinnerForWindow(window.self);for(var t=Resources.Runtime.FieldsRequiredInfo+"<br>",q=0;q<n.length;q++)t+="- "+n[q]+"<br>";try{masterPopupManager.showError(t)}catch(r){alert(t)}finally{SFLog({type:5,source:"warnOfEmptyFields",category:"Events",message:Resources.RuntimeMessages.ErrorEmptyFields,parameters:[t]})}}function promptForSOParameters(n,t,q,r,u,f,e,o,s,h){for(var l=r+"_"+q+"_"+n,b=jQuery('<div class="parameterPrompt" id="parameterPrompt_'+l+'"><\/div>'),v="txt_param_"+l+"_",c=0;c<t.length;c++){var k=t[c].pop(),y=t[c].pop(),p=t[c].pop();if(checkExists(p)){var d=SCFormField.html({label:p,required:k==="true",forid:v+c.toString()}),g=jQuery(d).appendTo(b),nt=SCTextbox.html({id:v+c.toString()}),tt=jQuery(nt).appendTo(g.children(".form-field-element-wrapper")).textbox(),a=jQuery(".input-control",tt);a.attr("parameter",p);a.attr("method",n);a.attr("viewID",q);a.attr("ObjectID",r);a.attr("IsRequired",k);checkExists(y)&&y.length>0&&(a[0].value=y)}}var qt=[{type:"help",click:function(){HelpHelper.runHelp(7e3)}},{text:Resources.Runtime.OK,click:function(){closeParameterPromptAndExecuteEventAction(u,n,e,o,f,s,q,l)}},{id:"cancelParameterButton_"+l,text:Resources.Runtime.Cancel}],rt={id:"requiredParameters_"+l,buttons:qt,headerText:Resources.Runtime.ValuesRequired,info:Resources.Runtime.ParametersRequiredInfo.format(n),height:300,width:400,content:b,closeWith:"cancelParameterButton_"+l,onClose:function(n,t){n.closed(t);_runtimeInitSpinner?hideRuntimeInitSpinnerForWindow(window.self):runtimeBusyView(q,!1,!1,h)},removeContent:!0,cssClass:"id-required-parameters"};masterPopupManager.showPopup(rt);var w=document.getElementById(v+"0");w&&(jQuery(w).trigger("focus"),w.focus())}function closeParameterPromptAndExecuteEventAction(n,t,q,r,u,f,e,o){var s=constructParameterCache(t,e,o);s===!0&&(masterPopupManager.closeLast(),n.setAttribute("ParametersEvaluated","true"),executeEventAction(n,t,q,r,u,f))}function constructParameterCache(n,t,q){for(var f="",e=jQuery("#parameterPrompt_"+q+" input"),o=!0,h=e.length,u=0;u<h;u++){var r=e[u];checkExists(r.value)&&r.value.length!==0?setHiddenJSONValue(r.getAttribute("ObjectID"),"Object",r.getAttribute("viewID"),null,null,null,r.getAttribute("method"),null,null,null,r.getAttribute("parameter"),"MethodParameter",r.value):r.getAttribute("IsRequired")==="true"&&(o=!1)}var s=getHiddenParameterCollectionXml(t);return checkExists(s)&&(f=s.xml),persistViewParametersForUser(t,f),o}function popupTypeExecution(n){var t=!1;n.currentAction.setAttribute("OldType","Popup");t=!0;checkExists(n.currentAction.getAttribute("Method"))&&n.currentAction.getAttribute("Method").length>0?n.currentAction.setAttribute("Type","Execute"):n.currentAction.setAttribute("Type","Transfer");navigateAction(n.currentAction,t,n.behaviour)}function closeTypeExecution(n){var t=SourceCode.Forms.Runtime.getTopNonClosingRuntimeInstancePopup();if(checkExists(t)){var q=SourceCode.Forms.Runtime.getMasterRuntimeWindow(),r=q.popupManager;if(checkExists(t.options)&&checkExists(t.options.subformContext)){var u=t.options.subformContext;checkExists(n)&&(u.behaviour=n)}r.closeSpecific(t)}else checkExists(n)&&(n.isExecuting=!1)}function endActionExecution(n){removeLoopContextData({loopContextID:n.loopContextID});checkExists(n.behaviour)&&(n.behaviour.isExecuting=!1)}function evaluateExpression(n,t,q,r,u,f,e,o){var s=null;try{s=evaluateExpressionInternal(n,t,q,r,u,f,e,o)}catch(h){SFLog({type:5,source:"evaluateExpression",category:"Events",message:"Expression evaluation error: {0}",parameters:[h.message],data:n,exception:h});s=null}return s}function evaluateExpressionInternal(n,t,q,r,u,f,e,o){var s=null;if(n.tagName==="Item")s=returnItemValue(n,t,q,u,e,o);else{var l=n.childNodes,d=[],y=l.length,g=!1;if(n.tagName==="If"){if(y>=2){var tt=evaluateExpressionInternal(l[0],t,q,!0,u,f,e,o);tt===!0?s=evaluateExpressionInternal(l[1],t,q,!0,u,f,e,o):y>2&&(s=evaluateExpressionInternal(l[2],t,q,!0,u,f,e,o))}}else if(n.tagName.startsWith("List")){for(var p=n.childNodes.length,a=[],w=0;w<p;w++){var v=viewControllerDefinition.createElement("Expression");checkExists(u)&&v.setAttribute("InstanceID",u);checkExists(f)&&v.setAttribute("ID",f);v.appendChild(n.childNodes[w].cloneNode(!0));s=n.tagName==="ListAverage"&&p>1?evaluateSummaryFields(v,"Sum",u,e):evaluateSummaryFields(v,n.tagName.replace("List",""),u,e);a.push(s)}if(p>1)switch(n.tagName){case"ListCount":case"ListSum":s=getSum(a);break;case"ListAverage":s=getAverage(a);break;case"ListMinimum":s=getMinimum(a);break;case"ListMaximum":s=getMaximum(a)}}else{for(var b=0;b<y;b++){var h=l[b];h.tagName==="Bracket"&&(h=h.firstChild);var c=null;if(h.tagName!=="Item")c=evaluateExpressionInternal(h,t,q,!0,u,f,e,o);else{var qt=n.tagName==="IsBlank"||n.tagName==="IsNotBlank";c=returnItemValue(h,t,null,u,e,o,qt)}if(n.tagName==="Equals"||n.tagName==="NotEquals"||n.tagName==="IsBlank"||n.tagName==="IsNotBlank"||checkExists(c))d.push(c);else{g=!0;s=null;break}var k=!1;switch(n.tagName){case"And":k=returnBooleanValue(c)===!1;break;case"Or":k=returnBooleanValue(c)===!0}if(k)break}g||(s=calculateExpressionValue(n.tagName,d))}}if(_runtimeConditionalStylingBeingApplied===!1&&r===!1&&checkExists(n.parentNode)&&n.parentNode.tagName==="Expression"){var nt=n.parentNode.getAttribute("ID");checkExists(nt)&&updateControlStylesUsingConditionalExpression(nt,q)}return s}function calculateExpressionValue(n,t){var q=null,r;switch(n){case"Bracket":q=t[0];break;case"Plus":q=getSum(t);break;case"Minus":q=returnNumericValue(t[0]);for(var u=1;u<t.length;u++)q=q.minus(returnNumericValue(t[u]));break;case"Multiply":q=returnNumericValue(t[0]);for(var u=1;u<t.length;u++)q=q.times(returnNumericValue(t[u]));break;case"Divide":q=returnNumericValue(t[0]);for(var u=1;u<t.length;u++){var f=returnNumericValue(t[u]);q=f!==0&&f.toString()!=="0"?q.div(f):0}break;case"Modulus":q=returnNumericValue(t[0]);for(var u=1;u<t.length;u++){var f=returnNumericValue(t[u]);q=f!==0&&f.toString()!=="0"?q.mod(f):0}break;case"Absolute":q=returnNumericValue(t[0]).abs();break;case"Average":q=getAverage(t);break;case"FormatNumber":q=SCCultureHelper.current.applyFormatToSmartObjectValue(currentCulture,"number",t[1],t[0],SourceCode.Forms.Settings.Formatting.DoNotHandleInvariantPointAsGroupSeparator);break;case"Maximum":q=getMaximum(t);break;case"Minimum":q=getMinimum(t);break;case"Power":var o=returnNumericValue(t[0]),e=returnNumericValue(t[1]);q=e.isWhole()?o.pow(e.toInt()):Math.pow(o.isWhole()?o.toInt():o.toFloat(),e.isWhole()?e.toInt():e.toFloat());break;case"Random":q=randomFromTo(0,returnNumericValue(t[0]));break;case"Root":q=nthRoot(returnNumericValue(t[0]),returnNumericValue(t[1]));break;case"RoundDown":q=roundValue("down",returnNumericValue(t[0]),returnNumericValue(t[1]));break;case"RoundUp":q=roundValue("up",returnNumericValue(t[0]),returnNumericValue(t[1]));break;case"Round":q=roundValue("round",returnNumericValue(t[0]),returnNumericValue(t[1]));break;case"SquareRoot":q=returnNumericValue(t[0]).sqrt();break;case"Square":q=returnNumericValue(t[0]).pow(2);break;case"Sum":q=getSum(t);break;case"Equals":q=typeof t[0]=="boolean"||typeof t[1]=="boolean"?returnBooleanValue(t[0])===returnBooleanValue(t[1]):t[0]===null||t[1]===null?t[0]===null&&t[1]===null:runtimeAreAnyDateTypes(t)?runtimeDatesComparison(t)===0:typeof t[0]=="string"||typeof t[1]=="string"||typeof t[0]=="object"||typeof t[1]=="object"?t[0].toString().toLowerCase()===t[1].toString().toLowerCase():t[0]==t[1];break;case"NotEquals":q=typeof t[0]=="boolean"||typeof t[1]=="boolean"?returnBooleanValue(t[0])!==returnBooleanValue(t[1]):t[0]===null||t[1]===null?!(t[0]===null&&t[1]===null):t[0]===""&&typeof t[1]!="string"||t[1]===""&&typeof t[0]!="string"?!0:runtimeAreAnyDateTypes(t)?runtimeDatesComparison(t)!==0:typeof t[0]=="string"||typeof t[1]=="string"||typeof t[0]=="object"||typeof t[1]=="object"?t[0].toString().toLowerCase()!==t[1].toString().toLowerCase():t[0]!=t[1];break;case"GreaterThan":q=runtimeAreAnyDateTypes(t)?runtimeDatesComparison(t)>0:returnNumericValue(t[0]).gt(returnNumericValue(t[1]));break;case"LessThan":q=runtimeAreAnyDateTypes(t)?runtimeDatesComparison(t)<0:returnNumericValue(t[0]).lt(returnNumericValue(t[1]));break;case"GreaterThanEquals":q=runtimeAreAnyDateTypes(t)?runtimeDatesComparison(t)>=0:returnNumericValue(t[0]).gte(returnNumericValue(t[1]));break;case"LessThanEquals":q=runtimeAreAnyDateTypes(t)?runtimeDatesComparison(t)<=0:returnNumericValue(t[0]).lte(returnNumericValue(t[1]));break;case"Not":q=!returnBooleanValue(t[0]);break;case"And":q=t[0];for(var u=1;u<t.length;u++)q=returnBooleanValue(q)&&returnBooleanValue(t[u]);break;case"Or":q=t[0];for(var u=1;u<t.length;u++)q=returnBooleanValue(q)||returnBooleanValue(t[u]);break;case"Xor":q=t[0];for(var u=1;u<t.length;u++){var a=returnBooleanValue(t[u]);q=(returnBooleanValue(q)||returnBooleanValue(a))&&!(returnBooleanValue(q)&&returnBooleanValue(a))}break;case"False":case"No":q=!1;break;case"True":case"Yes":q=!0;break;case"Length":q=_runtimeToString(t[0]).length;break;case"Contains":q=_runtimeToString(t[0]).toLowerCase().contains(_runtimeToString(t[1]).toLowerCase());break;case"StartsWith":q=_runtimeToString(t[0]).toLowerCase().indexOf(_runtimeToString(t[1]).toLowerCase())===0;break;case"EndsWith":var s=_runtimeToString(t[0]).toLowerCase(),h=_runtimeToString(t[1]).toLowerCase();q=!1;s===h?q=!0:s.length>h.length&&s.lastIndexOf(h)+h.length===s.length&&(q=!0);break;case"IsBlank":q=!checkExistsNotEmpty(t[0]);break;case"IsNotBlank":q=checkExistsNotEmpty(t[0]);break;case"Find":q=_runtimeToString(t[0]).toLowerCase().indexOf(_runtimeToString(t[1]).toLowerCase())+1;break;case"Hyperlink":var c=_runtimeToString(t[1]),l=_runtimeToString(t[0]);l===""&&c!==""&&(l=c);l!==""&&c!==""&&(q="<a href='"+c.htmlEncode()+"'>"+l.htmlEncode()+"<\/a>");break;case"Insert":q=insertTextInPosition(_runtimeToString(t[0]),_runtimeToString(t[1]),t[2]);break;case"Join":q=joinString(t,!1);break;case"Concatenate":q=joinString(t,!0);break;case"Left":q=_runtimeToString(t[0]).substr(0,t[1]);break;case"Mid":q=_runtimeToString(t[0]).substr(t[1],t[2]);break;case"PadLeft":q=_runtimeToString(t[0]).leftPad(_runtimeToString(t[1]),_runtimeToString(t[2]));break;case"PadRight":q=_runtimeToString(t[0]).rightPad(_runtimeToString(t[1]),_runtimeToString(t[2]));break;case"Proper":q=_runtimeToString(t[0]).capitalize();break;case"Replace":q=_runtimeToString(t[1]).length>0?_runtimeToString(t[0]).replaceAll(_runtimeToString(t[1]),_runtimeToString(t[2])):_runtimeToString(t[0]);break;case"Right":var p=_runtimeToString(t[0]).length-parseInt(t[1],10);q=_runtimeToString(t[0]).substr(p);break;case"Split":q=_runtimeToString(t[0]).split(_runtimeToString(t[1]));break;case"ToLower":q=_runtimeToString(t[0]).toLowerCase();break;case"ToUpper":q=_runtimeToString(t[0]).toUpperCase();break;case"Trim":q=_runtimeToString(t[0]).trim();break;case"UrlDecode":q=decodeURIComponent(_runtimeToString(t[0]));break;case"UrlEncode":q=encodeURIComponent(_runtimeToString(t[0]));break;case"HtmlEncode":q=_runtimeToString(t[0]).htmlEncode();break;case"HtmlDecode":q=_runtimeToString(t[0]).htmlDecode();break;case"XmlEncode":q=_runtimeToString(t[0]).xmlEncode();break;case"XmlDecode":q=_runtimeToString(t[0]).xmlDecode();break;case"Matches":q=t[0].test(t[1]);break;case"NotMatches":q=!t[0].test(t[1]);break;case"AddDays":q=addDateCalculator(returnDateValue(t[0]),"day",returnNumericValue(t[1]));break;case"AddHours":q=addDateCalculator(returnDateValue(t[0]),"hour",returnNumericValue(t[1]));break;case"AddMinutes":q=addDateCalculator(returnDateValue(t[0]),"minute",returnNumericValue(t[1]));break;case"AddSeconds":q=addDateCalculator(returnDateValue(t[0]),"second",returnNumericValue(t[1]));break;case"SubtractDays":q=addDateCalculator(returnDateValue(t[0]),"day",returnNumericValue(t[1]).negate());break;case"SubtractHours":q=addDateCalculator(returnDateValue(t[0]),"hour",returnNumericValue(t[1]).negate());break;case"SubtractMinutes":q=addDateCalculator(returnDateValue(t[0]),"minute",returnNumericValue(t[1]).negate());break;case"SubtractSeconds":q=addDateCalculator(returnDateValue(t[0]),"second",returnNumericValue(t[1]).negate());break;case"DayDifference":var v=returnDateValue(t[0]),y=returnDateValue(t[1]);checkExists(v)&&checkExists(y)&&(q=v.clearTime().difference(y.clearTime(),"day"));break;case"DateTimeDifference":var w=t[0],b=returnDateValue(t[1]),k=returnDateValue(t[2]);q=b.fractionalDifference(k,w);break;case"Day":r=returnDateValue(t[0]);q=checkExists(r)?r.getDate():null;break;case"FormatDateTime":q=SCCultureHelper.current.applyFormatToSmartObjectValue(currentCulture,"datetime",t[1],t[0]);break;case"Month":r=returnDateValue(t[0]);q=checkExists(r)?returnNumericValue(r.getMonth()).plus(1):null;break;case"Now":q=new Date;break;case"Today":r=new Date;q=getStartOfDay(r);break;case"Tomorrow":r=new Date;q=getStartOfDay(addDateCalculatorInternal(r,"day",returnNumericValue(1)));break;case"Yesterday":r=new Date;q=getStartOfDay(addDateCalculatorInternal(r,"day",returnNumericValue(-1)));break;case"WeekNumber":r=returnDateValue(t[0]);q=checkExists(r)?r.getWeek():null;break;case"Weekday":if(r=returnDateValue(t[0]),checkExists(r)){var d=r.getDay()+1;q=Date.parseDay(d)}break;case"Year":r=returnDateValue(t[0]);q=checkExists(r)?r.getFullYear():null;break;case"Quarter":if(r=returnDateValue(t[0]),checkExists(r)){var g=r.getMonth(),nt=g/3+1;q=Math.floor(nt)}break;case"StartOfMonth":q=dateStartEndCalculator(returnDateValue(t[0]),"month",!0);break;case"StartOfQuarter":q=dateStartEndCalculator(returnDateValue(t[0]),"quarter",!0);break;case"StartOfWeek":q=dateStartEndCalculator(returnDateValue(t[0]),"week",!0);break;case"StartOfYear":q=dateStartEndCalculator(returnDateValue(t[0]),"year",!0);break;case"EndOfMonth":q=dateStartEndCalculator(returnDateValue(t[0]),"month",!1);break;case"EndOfQuarter":q=dateStartEndCalculator(returnDateValue(t[0]),"quarter",!1);break;case"EndOfWeek":q=dateStartEndCalculator(returnDateValue(t[0]),"week",!1);break;case"EndOfYear":q=dateStartEndCalculator(returnDateValue(t[0]),"year",!1);break;case"ToBool":q=returnBooleanValue(t[0]);break;case"ToTime":q=returnDateValue(t[0],"time");break;case"ToTimeFromNumber":q=new SourceCode.Forms.Duration(returnNumericValue(t[0]).toInt()).toString();break;case"ToDateOnly":q=returnDateValue(t[0],"date");break;case"ToDate":q=returnDateValue(t[0],"datetime");break;case"ToDateTime":q=Date.fromSFDateAndSFTime(returnDateValue(t[0],"date"),returnDateValue(t[1],"time"));break;case"ToDecimal":q=checkExists(t[1])&&t[1]!==""?roundValue("round",returnNumericValue(t[0]),returnNumericValue(t[1])):returnNumericValue(t[0]);break;case"ToNumber":q=returnNumericValue(t[0]).round(0);break;case"ToString":q=_runtimeToString(t[0])}return q}function _runtimeToString(n){var t=n;return runtimeIsDateType(n)?t=getDateInCorrectFormat(n):checkExists(n)&&(t=n.toString()),t}function updateControlStylesUsingConditionalExpression(n,t){var f=[n,t],q=_runtimeRelatedExpressionsCache.get(f);if(!checkExists(q)){var e=["controlsWithConditonalStyles"],r=_runtimeRelatedExpressionsCache.get(e);checkExists(r)||(r=$mn(viewControllerDefinition,"Controllers/Controller/Controls/Control[Properties/Property/Name/text()='SetProperty'][Properties/ConditionalStyles/ConditionalStyle[Condition]]"),_runtimeRelatedExpressionsCache.add(e,r));var u=r.length;for(q=[];u--;){var o=r[u];if(!checkExists(t)||o.getAttribute("ID")!==t){var c=r[u].selectSingleNode("Properties[ConditionalStyles/ConditionalStyle[Condition[((.//@SourceType='Expression') and .//@SourceID='"+n+"')]]]");checkExists(c)&&q.push(o)}}_runtimeRelatedExpressionsCache.add(f,q)}for(var u=q.length,s=[];u--;){var h=q[u].getAttribute("ID");s.indexOf(h<0)&&(s.push(h),applyConstructedStyle(q[u]))}}function roundValue(n,t,q){var r=t;switch(n){case"up":r=returnNumericValue(t).ceiling(returnNumericValue(q).toInt());break;case"down":r=returnNumericValue(t).floor(returnNumericValue(q).toInt());break;case"round":r=returnNumericValue(t).round(returnNumericValue(q).toInt())}return r}function returnItemValue(n,t,q,r,u,f,e){var v=n.getAttribute("SourceType"),l=n.getAttribute("SourceID"),c=n.getAttribute("DataType"),s=n.getAttribute("SourceInstanceID");checkExists(r)&&!checkExists(s)&&(s=r,n.setAttribute("SourceInstanceID",s));var o="";switch(v){case"Expression":var h=$sn(n,"Expression");if(checkExists(h)||(h=$sn(viewControllerDefinition,"Controllers/Expressions/Expression[@ID='"+l+"']"+returnInstanceXP(s,!1,!1,!0))),checkExists(h)){var y=h.firstChild;o=evaluateExpression(y,t,q,null,s,h.getAttribute("ID"),u,f)}break;case"ValidationPattern":var a=$sn(viewControllerDefinition,"Controllers/ValidationPatterns/ValidationPattern[@ID='"+l+"']");a&&(o=a.text);break;default:o=returnSourceValue({item:n,counter:t,context:q,returnAccordingToType:!0,loopContextID:u,behaviour:f})}if(c==="Unknown"&&n.selectNodes("SourceValue/Item").length==1&&(c=n.selectSingleNode("SourceValue/Item").getAttribute("DataType")),checkExists(c))switch(c.toLowerCase()){case"boolean":o=returnBooleanValue(o);break;case"datetime":o=returnDateValue(o);break;case"number":e||(o=returnNumericValue(o))}return o}function returnControlPropertyValue(n){var u=n.controlID,r=n.propertyName,h=n.ignoreXML,q=n.currentControl;checkExists(q)||(q=_runtimeControllerFindObject({controlID:u}));var t=null,f=!0;if(checkExists(q)){var c=$sn(q,"Properties/Property[Name/text()='GetProperty']");if(checkExists(c)){var l=new PopulateObject(null,null,u,r);t=executeControlFunction(q,"GetProperty",l);typeof t!="undefined"&&(f=!1)}if(f){if(!h){var e=$sn(q,"Properties/Property[translate(Name/text(), 'ABCDEFGHIJKLMNOPQRSTUVWXYZ', 'abcdefghijklmnopqrstuvwxyz')='"+r.toLowerCase()+"']/Value");checkExists(e)&&(t=e.text)}if(!checkExists(t))switch(r.toLowerCase()){case"field":t=q.getAttribute("FieldID");break;case"expression":t=q.getAttribute("ExpressionID");break;case"datatype":t=q.getAttribute("DataType");break;case"styles":var o=$sn(q,"Properties/Styles");checkExists(o)&&(t=o.xml);break;case"conditionalstyles":var s=$sn(q,"Properties/ConditionalStyles");checkExists(s)&&(t=s.xml)}}checkExists(t)&&(r.toLowerCase()==="tabindex"&&(t=getUserTabIndex(t,u)),t=t.toString())}return t}function validateConditions(n,t,q,r){var f=!0,e=$sn(n,"Properties/Property[@Name='SerialNumber']/Value");if(checkExists(e)){var h=$sn(e,"Source"),l=checkExists(h)?returnSourceValue({item:h,counter:t,loopContextID:q,behaviour:r}):e.text;var u=SourceCode.Forms.Runtime.getMasterRuntimeWindow();if(u._runtimeLatestSerialNumber=l,!checkExistsNotEmpty(u._runtimeLatestSerialNumber)||u._runtimeLatestSerialNumberWarnings.contains(u._runtimeLatestSerialNumber))return u._runtimeLatestSerialNumber=null,!1}for(var c=n.childNodes,o=0;o<c.length;o++){var s=c[o];if(checkExists(s)&&s.nodeName!=="Properties"&&(f=evaluateExpression(s,t,null,!0,null,null,q,r)),!f)break}return f===!0}function getSystemVariableValue(n,t){var q=null;switch(n){case"currentdate":q=new Date;t||(q=getDateInCorrectFormat(q));break;case"currentdateonly":SourceCode.Forms.Settings.Compatibility.UseDateTimeForCurrentDateSystemVariable===!0?(q=new Date,q=q.toISOString(),q=q.substr(0,q.indexOf("T"))+" 00:00:00Z"):(q=new SourceCode.Forms.Date,t||(q=getDateInCorrectFormat(q)));break;case"currenttime":q=new SourceCode.Forms.Time;t||(q=getDateInCorrectFormat(q));break;case"screenwidth":q=window.screen.width;break;case"screenheight":q=window.screen.height;break;case"browserplatform":q=navigator.platform;break;case"browseruseragent":q=navigator.userAgent;break;case"browserculture":q=currentCulture;break;case"currentuser":q=SourceCode.Forms.Settings.User.FQN;break;case"currentuserfqn":q=SourceCode.Forms.Settings.User.FQN;break;case"currentuseremail":q=SourceCode.Forms.Settings.User.Email;break;case"currentuserdisplayname":q=SourceCode.Forms.Settings.User.DisplayName;break;case"currentusermanagerid":q=SourceCode.Forms.Settings.User.Manager;break;case"currentuserdescription":q=SourceCode.Forms.Settings.User.Description;break;case"currentusername":q=SourceCode.Forms.Settings.User.Name;break;case"culture":q=SourceCode.Forms.Settings.Culture;break;case"currenttheme":q="";var r=$("#CurrentTheme").val();r&&(q=r);break;case"rendermode":q=_runtimeMode;break;default:var u="Controllers/SystemVariables/"+n;q=$sn(viewControllerDefinition,u);checkExists(q)&&(q=q.text)}return q}function getControlValue(n){var o=n.controlID,s=n.returnNulls,c=n.returnAccordingToType,l=n.forValidation,r=n.controlNode;checkExists(r)||(r=_runtimeControllerFindObject({controlID:o,instanceID:n.instanceID}));var q="";if(checkExists(r)){var e=new PopulateObject(null,null,o);l===!0&&(e.ForValidation=!0);q=executeControlFunction(r,"GetValue",e);s||e.functionExists!==!1||(q="")}else s&&(q=null);if(checkExists(q)&&q.length>0&&c){var f=r.getAttribute("DataType");if(checkExists(f)){var t=q;switch(f.toLowerCase()){case"file":case"image":var u=null;if(t.startsWith("<collection>")){var a=baseCollectionXPath+"/fields/field[@name='FileName']/value",h=$xml(t),v=$sn(h,a).text;t=v;u=$sn(h,baseCollectionXPath+"/fields/field[@name='FilePath']/value")}if(t.length>0)if(valuetext=t,f.toLowerCase()==="image")t=u?"<img class='fileImage' alt='"+t+"' title='"+t+"' src='"+constructFileSrc(u.text,"path","image",100,100)+"'/>":"<img class='fileImage' alt='"+t+"' title='"+t+"' src='"+constructFileSrc(FieldID,"field","image",100,100)+"' />";else{var y=t;t="<a ";t+=u?" path='"+constructFileSrc(u.text,"path","file",100,100):" path='"+constructFileSrc(FieldID,"field","file",100,100);t+="' class='fileImage'>"+y+"<\/a>"}break;case"date":case"time":case"datetime":t=returnDateValue(q,f.toLowerCase())}q!==t&&(q=t)}}return q}function getEnvironmentFieldValue(n){var q=_environmentFieldCache[n],t=null;if(q&&checkExists(SourceCode.Forms.Settings.Cache)&&checkExists(SourceCode.Forms.Settings.Cache.EnvironmentFieldDuration)){var r=new Date,u=q.timestamp,f=(r-u)/1e3;f>SourceCode.Forms.Settings.Cache.EnvironmentFieldDuration?_environmentFieldCache[n]=null:t=q.value}return checkExists(t)||(t=ajaxCall.getEnvironmentFieldValue(n),_environmentFieldCache[n]={value:t,timestamp:new Date}),t}function initializeParameters(){_runtimeParameters={formParameters:{},viewControllers:{}};runtimeParametersDefinition=$xml(__runtimeParametersDefinition);for(var q=runtimeParametersDefinition.selectNodes("/Parameters/FormParameters/FormParameter"),t=0;t<q.length;t++){var n=q[t],f=n.getAttribute("ID"),r=n.getAttribute("Name"),e=n.getAttribute("Type"),o=n.text.htmlDecode().toString();_runtimeParameters.formParameters[r]={ID:f,Name:r,Type:e,Value:o}}for(var s=runtimeParametersDefinition.selectNodes("/Parameters/Controller"),u=0;u<s.length;u++){var h=s[u],c=h.getAttribute("InstanceID"),l={};_runtimeParameters.viewControllers[checkExistsNotEmpty(c)?c:""]=l;for(var q=h.selectNodes("ViewParameters/ViewParameter"),t=0;t<q.length;t++){var n=q[t],f=n.getAttribute("ID"),r=n.getAttribute("Name"),e=n.getAttribute("Type"),o=n.text.htmlDecode().toString();l[r]={ID:f,Name:r,Type:e,Value:o}}}}function getFormParameterValue(n,t){var q=null,r=_runtimeParameters.formParameters[n.toLowerCase()];if(checkExists(r)){var u=r.Type;q=r.Value;switch(u){case"boolean":q=returnBooleanValue(q);break;case"datetime":q.length>0&&(q=returnDateValue(q),t||(q=getDateInCorrectFormat(q)))}}return q}function getViewParameterValue(n,t,q){var r=null;t=checkExistsNotEmpty(t)?t:"";var u=null;if(checkExists(_runtimeParameters)&&checkExists(_runtimeParameters.viewControllers)&&(u=checkExists(_runtimeParameters.viewControllers[t])?_runtimeParameters.viewControllers[t]:_runtimeParameters.viewControllers[""]),checkExists(u)){var f=u[n.toLowerCase()];if(checkExists(f)){var e=f.Type;if(r=f.Value,checkExists(r)&&checkExists(e))switch(e){case"boolean":r=returnBooleanValue(r);break;case"datetime":r.length>0&&(r=returnDateValue(r),q||(r=getDateInCorrectFormat(r)))}}}return r}function setFormParameterValue(n,t,q){var r=_runtimeParameters.formParameters[n.toLowerCase()];if(checkExists(r)){var f=verifyParameterChange(r,t);if(r.Value=t,f){updateCalculatedControls(null,null,"FormParameter",n,null,null,null,q);var u=r.ID;if(checkExists(u))raiseEvent(u,"FormParameter","OnChange")}}}function setViewParameterValue(n,t,q,r){var u=null;if(checkExists(_runtimeParameters)&&checkExists(_runtimeParameters.viewControllers)&&(checkExistsNotEmpty(q)&&checkExists(_runtimeParameters.viewControllers[q])?u=_runtimeParameters.viewControllers[q]:(u=_runtimeParameters.viewControllers[""],q=null)),checkExists(u)){var f=u[n.toLowerCase()];if(checkExists(f)){var o=verifyParameterChange(f,t);if(f.Value=t,o){updateCalculatedControls(null,q,"ViewParameter",n,null,null,null,r);var e=f.ID;if(checkExists(e))raiseEvent(e,"ViewParameter","OnChange",q)}}}}function verifyParameterChange(n,t){var r=!1,u=n.Type,q=n.Value;if(t=t?t.toString():"",q!==t)switch(u){case"boolean":returnBooleanValue(q)!==returnBooleanValue(t)&&(r=!0);break;case"datetime":try{q.length>0&&(q=returnDateValue(q),q=getDateInCorrectFormat(q));t.length>0&&(t=returnDateValue(t),t=getDateInCorrectFormat(t))}catch(f){}q!==t&&(r=!0);break;default:r=!0}return r}function populateSubformContext(n,t){if(SourceCode.Forms.Runtime.Navigation.isBehaviorContextAction(n))return n;var u=SourceCode.Forms.Runtime.getRuntimeDataKeys(function(n){return n.indexOf(t)!==-1&&n.indexOf("_windowContext")+14===n.length});if(__runtimeSubformID===t&&u.length===1)n=PrepareNavigationTransferredEvents(n,__runtimeSubformID,__runtimeContextID,__runtimeParentContextID,__runtimeParentSubformID);else if(u.length===1){var r=SourceCode.Forms.Runtime.getRuntimeDataProperty(u[0].replace("_windowContext",""),"windowContext");checkExists(r)&&(n=PrepareNavigationTransferredEvents(n,r.__runtimeSubformID,r.__runtimeContextID,r.__runtimeParentContextID,r.__runtimeParentSubformID))}else if(u.length>1){for(var q,f=0;f<u.length;f++){var r=SourceCode.Forms.Runtime.getRuntimeDataProperty(u[f].replace("_windowContext",""),"windowContext");(!checkExists(q)||r.__runtimeFormLevel>q.__runtimeFormLevel)&&(q=r)}checkExists(q)&&(n=PrepareNavigationTransferredEvents(n,q.__runtimeSubformID,q.__runtimeContextID,q.__runtimeParentContextID,q.__runtimeParentSubformID))}else SourceCode.Forms.Runtime.Navigation.convertSubformNode(n,n.getAttribute("SubformID")),SourceCode.Forms.Runtime.Navigation.convertSourceSubformNode(n,n.getAttribute("SourceSubFormID")),SourceCode.Forms.Runtime.Navigation.convertTargetSubformNode(n,n.getAttribute("TargetSubFormID"));return n}function returnSourceValue(n){var u=n.item,y=n.counter,o=n.context,w=n.specifiedResultName,p=n.returnNulls,s=n.returnAccordingToType,d=n.customProcessData,h=n.loopContextID,b=n.behaviour,e=n.encodeTokenValues,k=u.getAttribute("SourceSubFormID");checkExistsNotEmptyGuid(k)&&(u=populateSubformContext(u,k));k=u.getAttribute("SourceTransferredID");var a=u.getAttribute("SourceInstanceID"),yt=u.getAttribute("SourceOriginalLevel"),pt=u.getAttribute("SourceRuntimeContextID"),q=u.getAttribute("SourceID"),g=u.getAttribute("SourceType"),v=u.getAttribute("SourcePath"),nq=u.getAttribute("TargetType"),nt=!0;typeof n.isLiteral!="undefined"&&n.isLiteral!=null&&(nt=n.isLiteral);nt&&typeof n.isLiteral!="undefined"||(e=!1);var t=null;if(checkExists($sn(u,"SourceValue"))){var tt=$mn(u,"SourceValue/*");if(tt.length>0){t="";for(var qt=0;qt<tt.length;qt++){var ft=returnSourceValue({item:tt[qt],counter:y,context:o,specifiedResultName:w,returnNulls:p,returnAccordingToType:s,customProcessData:d,loopContextID:h,behaviour:b,encodeTokenValues:e,isLiteral:!0});if(checkExists(ft))t+=ft;else if(p)return null}if(t.length===0&&p)return null}else{t=$sn(u,"SourceValue").text;var rt=$sn(u,"SourceValue/a");if(rt){var c="",et=rt.getAttribute("href");c=rt.text;c.length===0&&(c=et);c="<a target='_blank' href='"+et.htmlEncode()+"'>"+c.htmlEncode()+"<\/a>";c.length>0&&(t=c)}}}else{var f={instanceID:a,transferredID:k,originalLevel:yt,runtimeContextID:pt},r=n.instanceObj;if(!checkExists(r))switch(g){case"Control":f.controlID=q;r=findCorrectInstanceForDataTransfer(f);break;case"ViewField":f.fieldID=q;r=findCorrectInstanceForDataTransfer(f);break;case"ControlField":f.controlID=v;r=findCorrectInstanceForDataTransfer(f);break;case"ControlProperty":checkExists(v)&&(o=v);checkExistsNotEmpty(o)&&(f.controlID=o,r=findCorrectInstanceForDataTransfer(f));break;case"MethodParameter":checkExists(o)&&checkExists(o.ViewID)&&checkExists(o.ObjectID)&&checkExists(o.Method)&&(f.viewID=o.ViewID,r=findCorrectInstanceForDataTransfer(f));break;case"FormParameter":(!checkExistsNotEmpty(q)||q.isValidGuid())&&(q=u.text);checkExistsNotEmpty(q)&&(f.formParameter=q.toLowerCase(),r=findCorrectInstanceForDataTransfer(f));break;case"ViewParameter":(!checkExistsNotEmpty(q)||q.isValidGuid())&&(q=u.text);checkExistsNotEmpty(q)&&(f.viewParameter=q.toLowerCase(),r=findCorrectInstanceForDataTransfer(f),!checkExists(r.result)&&checkExists(f.instanceID)&&(f.instanceID=null,r=findCorrectInstanceForDataTransfer(f)));break;case"Expression":f.expressionID=q;r=findCorrectInstanceForDataTransfer(f);break;case"ViewSource":break;default:r=findCorrectInstanceForDataTransfer(f)}if(checkExists(r)&&r.WindowToUse!==window.self)t=r.WindowToUse.returnSourceValue({item:u,counter:y,context:o,specifiedResultName:w,returnNulls:p,returnAccordingToType:s,loopContextID:h,behaviour:b,instanceObj:r,encodeTokenValues:e,isLiteral:!0});else if(checkExists(r))switch(g){case"Value":t=u.text;break;case"Control":var ot="",st="FALSE",ut=null,l=r.result;if(checkExists(l)){ut=$sn(l,"Properties/Property[Name='Field']/Value");var ht=l.getAttribute("ControlTemplate");if(checkExistsNotEmpty(ht)){ot=ht.toUpperCase();var ct=l.parentNode.parentNode.getAttribute("MainTable");if(checkExistsNotEmpty(ct)){var lt=document.getElementById(ct);if(checkExists(lt)){var at=lt.getAttribute("editable");checkExistsNotEmpty(at)&&(st=at.toUpperCase())}}}if(checkExists(ut)&&st==="FALSE"&&ot==="EDIT"&&(t=getSourceFieldValue(ut.text,y,w,a,!0,s,h)),!checkExists(t)){var wt={controlID:q,instanceID:a,returnNulls:!0,returnAccordingToType:s,controlNode:l};t=getControlValue(wt)}e===!0&&checkExistsNotEmpty(t)&&(t=t.toString().htmlEncode())}break;case"ViewField":var bt=r.result;checkExists(bt)&&(t=getSourceFieldValue(q,y,w,a,!0,s,h),e===!0&&checkExistsNotEmpty(t)&&(t=t.toString().htmlEncode()));break;case"ControlField":var l=r.result;checkExists(l)&&(t=getControlFieldValue(q,a,v,h),e===!0&&checkExistsNotEmpty(t)&&(t=t.toString().htmlEncode()));break;case"SystemVariable":checkExists(q)&&(q=q.toLowerCase(),t=q.startsWith("error")?getErrorObjectValues(u,b):q.startsWith("currentworkflow")?resolveCurrentWorkflowVariables(q,b):getSystemVariableValue(q,s),e===!0&&checkExistsNotEmpty(t)&&(t=t.toString().htmlEncode()));break;case"ControlProperty":var l=r.result;if(checkExists(l)){var kt={controlID:o,propertyName:q};t=returnControlPropertyValue(kt);e===!0&&checkExistsNotEmpty(t)&&(t=t.toString().htmlEncode())}break;case"MethodParameter":var dt=r.result;checkExists(dt)&&(t=getHiddenParameter(o.ViewID,o.ObjectID,q,o.Method),e===!0&&checkExistsNotEmpty(t)&&(t=t.toString().htmlEncode()));break;case"FormParameter":var gt=r.result;checkExists(gt)&&(t=getFormParameterValue(q,s),e===!0&&checkExistsNotEmpty(t)&&(t=t.toString().htmlEncode()));break;case"ViewParameter":checkExists(r.result)&&(t=getViewParameterValue(q,a,s),e===!0&&checkExistsNotEmpty(t)&&(t=t.toString().htmlEncode()));break;case"Expression":var vt=r.result;checkExists(vt)&&(t=returnCalculatedValue(null,vt,y,null,h),e===!0&&checkExistsNotEmpty(t)&&(t=t.toString().htmlEncode()));break;case"EnvironmentField":t=getEnvironmentFieldValue(q);e===!0&&checkExistsNotEmpty(t)&&(t=t.toString().htmlEncode());break;case"WorkflowActivity":t=q;break;default:(checkExists(d)||checkExists(workflowInfo))&&(t=getCurrentWorkflowInformation(d,u,h,e),checkExists(t)||(t="<Item SourceType='"+g+"' SourceID='"+q+"' SourcePath='"+(checkExists(v)?v:"")+"' />"))}}return!checkExists(t)||s||Array.isArray(t)?checkExists(t)||p||(t=""):t=t.toString(),nt||e||(t=t.htmlEncode()),t}function getErrorObjectValues(n,t){var q=n.getAttribute("SourceErrorID"),r=null;if(!checkExists(q)&&checkExists(_runtimeLastUnhandledErrorID)&&(q=_runtimeLastUnhandledErrorID),!checkExists(q)&&checkExists(t)&&checkExists(t.windowToUse)&&t.windowToUse!=window&&(q=t.windowToUse._runtimeLastUnhandledErrorID),checkExists(q)){var f=SourceCode.Forms.Runtime.getMasterRuntimeWindow(),u=f._runtimeErrorObjects[q];if(checkExists(u)){var e=n.getAttribute("SourceID");switch(e.toLowerCase()){case"error":r=u.message;break;case"errorcategory":r=u.category;break;case"errormessage":r=u.message;break;case"errordetail":r=u.detail;break;case"errortype":r=u.type}}}return r}function getCurrentWorkflowInformation(n,t,q,r){return getCurrentWorkflowInformationDetails(n,t.getAttribute("SourceType"),t.getAttribute("SourceID"),t.getAttribute("SourcePath"),t,q,r)}function getCurrentWorkflowInformationDetails(n,t,q,r,u,f,e){var o=null;if(!checkExists(n)&&checkExists(workflowInfo)&&(n=workflowInfo[0]),checkExists(n)){checkExists(r)||(r="");var s=null;switch(t){case"WorkflowProcessDataField":o=n.ProcessInstance.DataFields[q];checkExists(o)&&e===!0&&(o=o.htmlEncode());break;case"WorkflowActivityDataField":o=n.ActivityInstanceDestination.DataFields[q];checkExists(o)&&e===!0&&(o=o.htmlEncode());break;case"WorkflowProcessProperty":s=n.ProcessInstance;checkExists(s)&&(q.startsWith("Originator")&&(s=s.Originator,q=q==="Originator"?"FQN":q.replace("Originator","")),o=s[q],e===!0&&checkExists(o)&&(o=o.toString().htmlEncode()));break;case"WorkflowActivityProperty":s=n.ActivityInstanceDestination;checkExists(s)&&(o=s[q],e===!0&&checkExists(o)&&(o=o.toString().htmlEncode()));break;case"WorkflowEventProperty":s=n.EventInstance;checkExists(s)&&(o=s[q],e===!0&&checkExists(o)&&(o=o.toString().htmlEncode()));break;case"WorkflowProcessXmlField":o=n.ProcessInstance.XMLFields[q];break;case"WorkflowActivityXmlField":o=n.ActivityInstanceDestination.XMLFields[q];break;case"Value":if(checkExists(u)&&$sn(u,"SourceValue")){var h=$mn(u,"SourceValue/Source");if(h.length>0){o="";for(var c=0;c<h.length;c++){var l=getCurrentWorkflowInformation(n,h[c],f,e);checkExists(l)&&(o+=l)}}else o=$sn(u,"SourceValue").text,e===!0&&checkExists(o)&&(o=o.toString().htmlEncode())}break;case"ProcessItemReference":var a=$xml(n.ProcessInstance.XMLFields.ItemReferences);checkExists(a)&&(o=$sn(a,"itemReferences/itemReference[@name='"+q+"']"));break;default:checkExists(u)&&(o=returnSourceValue({item:u,loopContextID:f,encodeTokenValues:e}))}}return o}function resolveCurrentWorkflowVariables(n,t){var r=null,f=null,e=null;switch(n){case"currentworkflowactivityname":f="WorkflowActivityProperty";e="FullName";break;case"currentworkflowactivitydisplayname":f="WorkflowActivityProperty";e="DisplayName";break;case"currentworkflowactionname":r=getWorkflowViewActionName(!1)}var q=SourceCode.Forms.Runtime.getMasterRuntimeWindow();if(!checkExists(r)&&checkExists(q._runtimeLatestSerialNumber)&&!q._runtimeLatestSerialNumberWarnings.contains(q._runtimeLatestSerialNumber)){var u=!1;if(checkExists(workflowInfo)){u=!0;for(var c=workflowInfo.length;c--;)if(workflowInfo[c].ProcessInstance.SerialNumber===q._runtimeLatestSerialNumber){u=!1;break}}else u=!0;if(u){var l=$xml('<Action Type="ExecuteWorkflow" ExecutionType="Synchronous" Method="LoadProcess" OriginalEventType="System"><Parameters><Parameter SourceType="Value" TargetID="SerialNumber" TargetType="WorkflowProcessProperty"><SourceValue>'+q._runtimeLatestSerialNumber+"<\/SourceValue><\/Parameter><\/Parameters><\/Action>").documentElement;checkExists(t)||(t=new q.SourceCode.Forms.Runtime.BehaviourEvent({windowToUse:window.self}));t.wfVariableLoading=!0;workflowAction(l,t,null,!1)}if(checkExists(workflowInfo)&&checkExists(f)&&checkExists(e)){for(var s=null,h=workflowInfo.length;h--;)if(workflowInfo[h].ProcessInstance.SerialNumber===q._runtimeLatestSerialNumber){s=workflowInfo[h];break}checkExists(s)&&(r=getCurrentWorkflowInformationDetails(s,f,e))}!checkExists(r)&&u&&q._runtimeLatestSerialNumberWarnings.push(_runtimeLatestSerialNumber)}if(checkExists(r)){var o=!1;switch(n){case"currentworkflowactivityname":q._runtimeLatestWorkflowActivityName!=r&&(q._runtimeLatestWorkflowActivityName=r,o=!0);break;case"currentworkflowactivitydisplayname":q._runtimeLatestWorkflowActivityDisplayName!=r&&(q._runtimeLatestWorkflowActivityDisplayName=r,o=!0);break;case"currentworkflowactionname":q._runtimeLatestWorkflowActionName!=r&&(q._runtimeLatestWorkflowActionName=r,o=!0)}o&&updateCalculatedControls(null,null,"SystemVariable",n)}return r}function mailAction(n,t){for(var f=getLoopContextID(n),q=$xml("<mailmessage/>"),e=$sn(q,"mailmessage"),o=$mn(n,"Parameters/Parameter"),s=o.length;s--;){var r=o[s],c=r.getAttribute("TargetType"),h=r.getAttribute("TargetID"),u=null;h.toLowerCase()==="attachment"?setAttachmentValues(q,e,r,f):(u=returnSourceValue({item:r,loopContextID:f,behaviour:t}),checkExists(u)&&c==="MailProperty"&&constructPropertyNode(q,e,h.toLowerCase(),u))}return ajaxCall.sendEmailBehaviour(q.xml,n,t)}function exportListToExcel(n){n=checkExists(n)?n:{};var f={viewHtml:n.viewHtml,rowsGridObjs:n.rowsGridObjs},q=generateDataForExcel(f),t=document.getElementById("FileURL").value;if(checkExists(q)&&checkExistsNotEmpty(t)){var r=constructExcelFileName(n.viewXml);t=FormatFileDownloadPathForAnonAccess(t,!0);t=SourceCode.Forms.XSRFHelper.appendAntiXSRFQueryStringParameter(t);var e=/(iPhone|iPad|iPod)/i.test(navigator.userAgent),o=navigator.userAgent.indexOf("Mobilies")>=0;if(e||o){var u=setFrameVariable("_listxlsxdata",JSON.stringify(q));u+=setFrameVariable("_xlsxfilename",constructExcelFileName(n.viewXml));framePosting("HiddenFileFrame",t,u,!1)}else{var u={_listxlsxdata:JSON.stringify(q),_xlsxfilename:r};_runtimeAjaxCall("POST",t,null,u,"blob").done(function(n){if(typeof navigator.msSaveBlob=="function")navigator.msSaveBlob(n,r);else{var q=window.URL.createObjectURL(n),t=document.createElement("a");t.href=q;t.download=r;t.style.display="none";$("body").append(t);t.click();t.remove();window.URL.revokeObjectURL(q)}})}}handleEvent(n.viewId,"View","ListExportExcel",null,n.instanceId,null,null,null,null,null,null,n.loopContextId)}function executeListExportExcel(n){n=checkExists(n)?n:{};var g=n.viewXml.getAttribute("ContextID"),e=n.currentAction.getAttribute("ViewID"),l=n.currentAction.getAttribute("InstanceID"),o=getLoopContextID(n.currentAction),r=!1,u=0,a=n.viewHtml[0].getAttribute("pagesize");if(checkExistsNotEmpty(a)){var v=parseInt(a,10);isNaN(v)||(u=v,r=!0)}var f={viewId:e,smoId:g,rowCounter:n.rowCounter,windowToUse:n.originalWindow,specifiedResultName:n.specifiedResultName,loopContextId:o,behaviour:n.behaviour},t=!1,q=0,y=n.currentAction.selectSingleNode("Parameters/Parameter[@TargetID='RowLimit']");if(checkExists(y)){f.param=y;var p=getExportExcelParameterValue(f);if(checkExistsNotEmpty(p)){var w=parseInt(p,10);isNaN(w)||(q=w,t=!0)}}var s="true",b=n.currentAction.selectSingleNode("Parameters/Parameter[@TargetID='AllPages']");if(checkExists(b)){f.param=b;var k=getExportExcelParameterValue(f);checkExistsNotEmpty(k)&&(s=k)}var d=!0;if(checkExistsNotEmpty(s)&&s.toUpperCase()==="TRUE"&&r&&(!t||q>u)&&(d=!1),d){var h={returnType:"objects",startIndex:0,endIndex:u};t||r?t&&(!r||q<u)&&(h.endIndex=q):delete h.endIndex;var nt={element:n.viewHtml,fn:"fetch",params:["subset-rows",h]},tt=SFRGrid.execute(nt),qt={viewHtml:n.viewHtml,viewXml:n.viewXml,rowsGridObjs:tt,viewId:e,instanceId:l,loopContextId:o};exportListToExcel(qt);n.actionType==="Close"?closeTypeExecution(n.behaviour):endActionExecution({loopContextID:o,behaviour:n.behaviour})}else{n.actionType==="Close"&&closeTypeExecution(n.behaviour);var c={viewHtml:n.viewHtml,viewId:e,instanceId:l,behaviour:n.behaviour};t&&(c.pageSize=q,c.pageNumber=1);refreshListForExportToExcel(c)}}function getExportExcelParameterValue(n){n=checkExists(n)?n:{};var q=n.param.getAttribute("SourceType"),r=n.param.getAttribute("SourceInstanceID"),u=n.param.getAttribute("TargetInstanceID"),f=null;q==="MethodParameter"&&(f=new parameterContext(n.viewId,n.smoId,"ListExportExcel"));var t=n.rowCounter;return checkExists(t)&&q==="ViewField"&&checkExists(u)&&checkExists(r)&&u!==r&&(t=null),n.windowToUse.returnSourceValue({item:n.param,counter:t,context:f,specifiedResultName:n.specifiedResultName,returnNulls:!0,loopContextID:n.loopContextId,behaviour:n.behaviour})}function setAttachmentValues(n,t,q,r){for(var e=$mn(q,"SourceValue/Source"),o=e.length;o--;){var f=e[o],s=f.getAttribute("SourceType").toLowerCase(),h=f.getAttribute("SourceID"),u=returnSourceValue({item:f,loopContextID:r});if(s==="viewfield"&&u.indexOf("<collection>")===-1){var c=f.getAttribute("SourceInstanceID");u=getFieldValueForEmail(h,c,r)}u.length>0&&(u.indexOf("<collection>")>-1||u.indexOf("<FileLoad>")>-1)&&constructPropertyNode(n,t,"attachment",u)}}function getFieldValueForEmail(n,t,q){var e="";if(checkExists(n)){var r=returnFieldAttributeObject(n,t);if(checkExists(r)){var c=r.viewType.toLowerCase(),u=null,o=r.viewID;if(c==="list"){var l=r.mainTable;u=getLoopContextData({loopContextID:q,viewID:o,instanceID:r.instanceID}).counter;checkExists(u)||(u=getViewSelectedCounter(l))}var a=r.parentID,v=r.PropertyName,s=r.propertyType;if(s.toLowerCase()==="file"||s.toLowerCase()==="image"){var y=getCombinedHiddenPropertyCollection(o,a,"Object",null,null,u,null,null,null,r.instanceID),h=$xml("<collection/>");_runtimeTransformFieldsToXml(h,y);var f="<FileLoad>";f+="<ReturnProperty>"+v+"<\/ReturnProperty>";f+=h.xml;f+="<\/FileLoad>";e=f}}}return e}function constructPropertyNode(n,t,q,r){if(checkExists(r)&&(r=r.toString()),checkExists(r)&&r.length>0){var u=n.createElement(q);u.appendChild(n.createTextNode(r));t.appendChild(u)}return t}function messageAction(n,t,q,r){var f=getLoopContextID(n),rt=n.getAttribute("MessageLocation"),a=$mn(n,"Parameters/Parameter"),v,c,u;if(checkExists(r)||(r=window),checkExists(rt)&&rt==="Popup"){var ut,ft,d,y,p;d="";for(var g="message",et="small",w="runtime-message",e=!0,ot=a.length;ot--;){var s=a[ot];if(v=s.getAttribute("TargetType"),c=s.getAttribute("TargetID"),v==="MessageProperty")switch(c.toLowerCase()){case"title":u=r.returnSourceValue({item:s,loopContextID:f,encodeTokenValues:!1,behaviour:t});checkExistsNotEmpty(u)&&(ut=u);break;case"heading":e=!0;var b=n.getAttribute("HeadingIsLiteral");checkExistsNotEmpty(b)&&(e=b.toUpperCase()!=="FALSE");u=r.returnSourceValue({item:s,loopContextID:f,encodeTokenValues:SourceCode.Forms.Settings.EncodeMessageAction,behaviour:t,isLiteral:e});checkExistsNotEmpty(u)&&(ft=u);break;case"body":e=!0;var k=n.getAttribute("BodyIsLiteral");checkExistsNotEmpty(k)&&(e=k.toUpperCase()!=="FALSE");u=r.returnSourceValue({item:s,loopContextID:f,encodeTokenValues:SourceCode.Forms.Settings.EncodeMessageAction,behaviour:t,isLiteral:e,returnAccordingToType:!0});checkExistsNotEmpty(u)&&(d=u.replaceAll("\n","<br/>"));break;case"size":u=r.returnSourceValue({item:s,loopContextID:f,encodeTokenValues:!1,behaviour:t});checkExistsNotEmpty(u)&&(et=u);break;case"type":u=r.returnSourceValue({item:s,loopContextID:f,encodeTokenValues:!1,behaviour:t});checkExistsNotEmpty(u)&&(g=u)}}switch(et.toLowerCase()){case"small":y=240;p=320;w+=" size-small";break;case"medium":y=360;p=640;w+=" size-medium";break;case"large":y=450;p=800;w+=" size-large"}var nt=!1,h={showHeaderButtons:!0,headerText:ut,message:d,title:ft,height:y,width:p,type:g,cssClass:w},l;switch(g.toLowerCase()){case"confirmation":l={onAccept:function(){removeLoopContextData({loopContextID:f});continuePromptingBehaviour(t,!0)},onCancel:function(){cancelPromptingBehaviour(t,q,!0,f)},cancelClose:nt};masterPopupManager.showConfirmation(jQuery.extend(h,l));break;case"none":h=$.extend(h,{onClose:function(){removeLoopContextData({loopContextID:f});continuePromptingBehaviour(t,!1)},showHeaderButtons:!1,type:null,onShow:function(n){n.element.find(".popup-body-content > .scroll-wrapper").addClass("no-left-panel");var t=n.element.find("a.fileImage, img.fileImage");if(t.length>0)t.on("click",openFileImageMessage)}});l={onClose:function(){removeLoopContextData({loopContextID:f});continuePromptingBehaviour(t,!1)},cancelClose:nt};masterPopupManager.showMessage(h);break;default:l={onClose:function(){removeLoopContextData({loopContextID:f});continuePromptingBehaviour(t,!1)},cancelClose:nt};h=$.extend(h,{onShow:function(n){var t=n.element.find("a.fileImage, img.fileImage");if(t.length>0)t.on("click",openFileImageMessage)}});masterPopupManager.showMessage(jQuery.extend(h,l))}}else{var tt=$xml("<message/>"),ht=$sn(tt,"message"),ct=document.getElementById("CurrentURL").value.replace("View.aspx","Message.aspx").replace("Form.aspx","Message.aspx");n.setAttribute("Url",ct);n.setAttribute("Type","Navigate");for(var st=a.length;st--;){var qt=a[st];v=qt.getAttribute("TargetType");c=qt.getAttribute("TargetID");var e=!0;if(v==="MessageProperty"){var o={item:qt,loopContextID:f,behaviour:t};switch(c.toLowerCase()){case"title":o.encodeTokenValues=!1;break;case"heading":var b=n.getAttribute("HeadingIsLiteral");checkExistsNotEmpty(b)&&(e=b.toUpperCase()!=="FALSE");o.encodeTokenValues=SourceCode.Forms.Settings.EncodeMessageAction;o.isLiteral=e;break;case"body":var k=n.getAttribute("BodyIsLiteral");checkExistsNotEmpty(k)&&(e=k.toUpperCase()!=="FALSE");o.returnAccordingToType=!0;o.encodeTokenValues=SourceCode.Forms.Settings.EncodeMessageAction;o.isLiteral=e;break;default:o.returnAccordingToType=!0}u=returnSourceValue(o);constructPropertyNode(tt,ht,c.toLowerCase(),u)}}postData=setFrameVariable("message",tt.xml);navigateAction(n,!1,null,postData,!1,t)}}function openFileImageMessage(n){var t=n.target?n.target:n.srcElement,u=t.tagName,q="";switch(u.toUpperCase()){case"IMG":q=t.src.replace("&_controltype=image","&_controltype=file");break;case"A":q=t.getAttribute("path")}var r=document.getElementById("HiddenFileFrame");r.style.display="";r.style.display="none";r.src=q}function executeSharePointAction(n,t){var q=getLoopContextID(n),r=n.getAttribute("Method");switch(r){case"SPCloseDialog":checkExists(document.parentWindow.parent)&&document.parentWindow.parent.closeDialog();break;case"SPCloseDialogAndRefresh":checkExists(document.parentWindow.parent)&&document.parentWindow.parent.closeDialogAndRefreshList()}endActionExecution({loopContextID:q,behaviour:t})}var _runtimeRelatedExpressionsCache=new SFRuntimeHash,_runtimeRelatedControlsCache=new SFRuntimeHash;function applyStyleAction(n,t){var k=getLoopContextID(n);if(checkExists(t)){var f=t.SourceID,v=t.SourceType,d=t.SourceInstanceID;if(v==="Control"){var q=_runtimeRelatedControlsCache.get(f);if(!checkExists(q)){q=[];var r=_runtimeControllerFindObject({controlID:f});if(checkExists(r)){var g=$sn(r,"Properties[Property/Name/text()='SetProperty'][(Styles/Style) or (ConditionalStyles)]");g||(r=null)}if(checkExists(r)){var e=f,y=["controlsWithConditonalStyles"],u=_runtimeRelatedExpressionsCache.get(y);checkExists(u)||(u=$mn(viewControllerDefinition,"Controllers/Controller/Controls/Control[Properties/Property/Name/text()='SetProperty'][Properties/ConditionalStyles/ConditionalStyle[Condition]]"),_runtimeRelatedExpressionsCache.add(y,u));var h=new SFRuntimeHash,p=r.getAttribute("FieldID"),c="Properties[ConditionalStyles/ConditionalStyle[Condition[.//@SourceType='Control' and .//@SourceID='"+e+"'";checkExists(p)&&(c+=" or .//@SourceType='ViewField' and .//@SourceID='"+p+"'");c+="]]]";h.add(e);q.push(e);for(var o=u.length;o--;){var l=u[o],a=l.getAttribute("ID");if(!h.get(a)){var nt=l.selectSingleNode(c);checkExists(nt)&&(q.push(a),h.add(a))}}}_runtimeRelatedControlsCache.add(e,q)}for(var o=q.length;o--;){var l=_runtimeControllerFindObject({controlID:q[o]});applyConstructedStyle(l)}}else{var s;switch(v){case"View":s="Controllers/Controller[@ID='"+f+"']"+returnInstanceXP(d,!1,!1,!0,!1)+"/Controls/Control[Properties/Property/Name/text()='SetProperty'][(Properties/Styles/Style/*) or (Properties/ConditionalStyles)]";break;case"Form":s="Controllers/Controller/Controls/Control[Properties/Property[Name/text()='SetProperty'][Value/text()!='updateFormProperty']][(Properties/Styles/Style/*) or (Properties/ConditionalStyles)]"}if(checkExists(s))for(var w=$mn(viewControllerDefinition,s),b=w.length;b--;)applyConstructedStyle(w[b])}t.isExecuting=!1}removeLoopContextData({loopContextID:k})}var _runtimeControlBaseStyleCache={},_runtimeControlConditionalStyleCache={};function applyConstructedStyle(n,t){var r=null,e=n.getAttribute("ID"),u=_runtimeControlBaseStyleCache[e];checkExists(u)?r=u:(r=$sn(n,"Properties/Styles"),_runtimeControlBaseStyleCache[e]=r);var f=null;u=_runtimeControlConditionalStyleCache[e];checkExists(u)?f=u:(f=$mn(n,"Properties/ConditionalStyles/ConditionalStyle"),_runtimeControlConditionalStyleCache[e]=f);var q=checkExists(r)?$xml(r.xml):null,h=[],o=f.length;if(o>0){for(_runtimeConditionalStylingBeingApplied=!0,fireExpressions(!0);o--;){var s=f[o],a=$sn(s,"Condition"),v=validateConditions(a,t);v===!0&&(checkExists(q)?h.push($sn(s,"Styles").cloneNode(!0)):q=$xml($sn(s,"Styles").xml))}q=combineStyles(q,h);_runtimeConditionalStylingBeingApplied=!1}if(checkExists(q)){if(t)return q;var c=new PopulateObject(null,q.xml,n.getAttribute("ID"),"Style");executeControlFunction(n,"SetProperty",c);var l=$sn(q,"Styles/Style/Format");if(checkExists(l)){var c=new PopulateObject(null,l.xml,n.getAttribute("ID"),"format");executeControlFunction(n,"SetProperty",c)}}}function combineStyles(n,t){for(var q=t.length;q--;){var r=t[q];if(checkExists(r)){var u={fromNode:r,toNode:n,overideValue:!0};MergeXmlNodes(u)}}return n}function updateWFMargins(n){var t=jQuery("#WorkflowStrip");if(t.length>0){var q=t.css("margin-top"),r=t.css("margin-bottom");if((!checkExists(q)||parseInt(q,10)===0||q.toString().toLowerCase()==="auto")&&checkExists(r)&&parseInt(r,10)>0&&r.toString().toLowerCase()!=="auto")t[0].style.marginBottom=n,t[0].style.marginTop="0px";else if((!checkExists(r)||parseInt(r,10)===0||r.toString().toLowerCase()==="auto")&&checkExists(q)&&parseInt(q,10)>0&&q.toString().toLowerCase()!=="auto"){var u=jQuery(".theme-entry .tabs-top.tab-box .tab-box-body");u.length>0&&(n=parseInt(n,10)+parseInt(u.css("top"),10)+"px",jQuery(".runtime-form.theme-entry")[0].style.marginBottom=n);t[0].style.marginTop=n;t[0].style.marginBottom="0px"}}}function updateTabStyles(n){for(var r=jQuery(".theme-entry>.tab-box"),u=r.find(".tab-box-body"),f=u.length;f--;)u[f].style.backgroundColor=n;for(var t=r.find("ul.tab-box-tabs a.tab span.tab-wrapper"),q=t.length;q--;)t[q].style.backgroundColor=n,t[q].style.borderColor=n}function ControlMethodExecuteAction(n,t){var a=getLoopContextID(n),q=n.getAttribute("ControlID"),w=n.getAttribute("Method"),y=window.self,e,o,c;if(checkExists(q)){var l=_runtimeControllerFindObject({controlID:q,propertySearch:"ExecuteMethod"});if(checkExists(l)){for(var p={},r=$mn(n,"Parameters/Parameter"),u=r.length;u--;){var b=r[u].getAttribute("TargetType"),k=r[u].getAttribute("TargetID");o=r[u].getAttribute("SourceType");c=r[u].getAttribute("SourceID");e=returnSourceValue({item:r[u],context:q,loopContextID:a,behaviour:t});switch(b){case"ControlMethodParameter":p[k]=e;break;case"ControlProperty":updateTargetWithValue(n,t,r[u],y,c,o,e)}}var f={CurrentControlId:q,methodName:w,methodParameters:p};if(SourceCode.Forms.Browser.msie&&SourceCode.Forms.Browser.version<=8)f.CurrentControlID=q;else try{Object.defineProperty(f,"CurrentControlID",{get:function(){var n={type:4,source:"executeControlFunction",category:"Helper",message:Resources.RuntimeMessages.WarningExecutingControlMethod,parameters:[f.methodName],data:l};return SFLog(n),this.CurrentControlId},set:function(n){this.CurrentControlId=n}})}catch(d){f.CurrentControlID=q}var v=null;if(f.methodName==="Focus"&&document.readyState!=="complete")$(window).on("load",function(){window.setTimeout(function(){executeControlFunction(l,"ExecuteMethod",f,!0)},0)});else v=executeControlFunction(l,"ExecuteMethod",f,!0);if(checkExists(v))for(var s=$mn(n,"Results/Result"),h=s.length;h--;)o=s[h].getAttribute("SourceType"),c=s[h].getAttribute("SourceID"),e=o==="ControlMethodResult"?v:returnSourceValue({item:s[h],context:q,loopContextID:a,behaviour:t}),checkExists(e)&&updateTargetWithValue(n,t,s[h],y,c,o,e)}}endActionExecution({loopContextID:a,behaviour:t})}function continueBehaviour(n){checkExists(n)&&(n.evaluateContinueParentHandlers&&(n.evaluateContinueParentHandlers=!1),n.actions=[],n.previousHandlerResult=!0,n.isExecuting=!1)}function exitBehaviour(n){checkExists(n)&&(n.stopped=!0,n.isExecuting=!1)}function executeErrorMethod(n,t){for(var f=getLoopContextID(n),r=null,q={category:"custom"},e=$mn(n,"Parameters/Parameter"),o=e.length;o--;){var s=e[o].getAttribute("TargetID"),u=returnSourceValue({item:e[o],loopContextID:f,behaviour:t});switch(s.toLowerCase()){case"error":q.message=u;break;case"errorcategory":q.category=u;break;case"errormessage":q.message=u;break;case"errordetail":q.detail=u;break;case"errortype":q.type=u}}return checkExists(t)||(r=$.Deferred()),checkExists(t)?t.handleError("custom",q,null,null,null,f):r&&r.reject("custom",q,null,null,null,f),r?r.promise():void 0}function updateExecutionTracker(n,t,q){typeof n!="undefined"&&n!==null?_runtimeAJAXExecutionCount=_runtimeAJAXExecutionCount+n:typeof t!="undefined"&&t!==null&&typeof q=="string"&&(t>0&&_runtimeExecBehaviorIds.indexOf(q)===-1?(_runtimeExecBehaviorIds.push(q),_runtimeBehaviourExecutionCount=_runtimeBehaviourExecutionCount+t):t<0&&_runtimeExecBehaviorIds.indexOf(q)>-1&&(_runtimeExecBehaviorIds.splice(_runtimeExecBehaviorIds.indexOf(q),1),_runtimeBehaviourExecutionCount=_runtimeBehaviourExecutionCount+t));!_runtimeIdleState||_runtimeAJAXExecutionCount===0&&_runtimeBehaviourExecutionCount===0&&(!checkExists(_runtimePostInitEvents)||_runtimePostInitEvents.length===0)&&(!checkExists(_runtimePresetControls)||_runtimePresetControls.length===0)||(_runtimeIdleState=!1);setTimeout(function(){_runtimeAJAXExecutionCount!==0||_runtimeBehaviourExecutionCount!==0||checkExists(_runtimePostInitEvents)&&_runtimePostInitEvents.length!==0||checkExists(_runtimePresetControls)&&_runtimePresetControls.length!==0?_runtimeIdleState&&(_runtimeIdleState=!1):_runtimeIdleState||(typeof _runtimeNotifyMobileAppNativeBridgeFunction=="function"&&(_runtimeNotifyMobileAppNativeBridgeFunction(),_runtimeNotifyMobileAppNativeBridgeFunction=null),_runtimeIdleState=!0)}.bind(this),0)}function completePopupClosing(n,t){setTimeout(function(){n.closed(t)},0)};
/*!
 ~/RunTime/Script/Fields.js
*/
var hiddenValueArray=[],viewWriteStatus=[],ViewHiddenHash={},baseCollectionXPath="collection/object",fieldObjectInfoCache={};function setHiddenFieldValue(n,t,q,r,u,f,e,o){var s=returnFieldAttributeObject(n,r);if(checkExists(s)){var c=null;if(checkExists(q)&&(c="Changed"),setHiddenJSONValue(s.parentID,s.parentType,s.viewID,q,c,null,null,s.contextID,s.contextType,null,s.PropertyName,s.fieldType,t,s.instanceID),!e){var l="Controllers/Controller"+s.instanceXP+"/Controls/Control[(@FieldID='"+n+"') and (Properties/Property[Name/text()='SetValue']) and (not(@ControlTemplate) or (@ControlTemplate='edit'))]";checkExists(u)&&checkExists(f)&&f.toLowerCase()==="control"&&u.length>0&&(l+="[@ID!='"+u+"']");var a=$mn(viewControllerDefinition,l),h=a.length;for(h==0&&updateCalculatedControls(null,s.instanceID,"ViewField",n,null,null,null,o);h--;){var v=a[h],y=v.getAttribute("ID"),p=new PopulateObject(null,t,y,null,null);executeControlFunction(v,"SetValue",p)}}}}function setHiddenJSONValue(n,t,q,r,u,f,e,o,s,h,c,l,a,v){var y={};if(checkExists(n)&&(y.parentid=n),checkExists(t)&&(y.parenttype=t),checkExists(r)&&(y.counter=r,checkExists(u)&&(y.state=u)),checkExists(f)&&(y.controlid=f),checkExists(e)&&(y.method=!0,checkExists(c)&&l==="MethodParameter")){y.parameters={};var p={};checkExists(a)&&a.length!==0?(p.value=a,delete p.cleared):p.cleared=!0;y.parameters[c]=p}if(checkExists(o)&&(y.contextid=o),checkExists(s)&&(y.contexttype=s),checkExists(h)&&(y.pagenumber=h),checkExists(c)&&l!=="MethodParameter"){y.fields={};var w={};checkExists(a)&&a.length!==0?(w.value=a,delete w.cleared):w.cleared=!0;y.fields[c]=w}pushHiddenValue(q,v,y)}function _runtimeSetControlFields(n,t,q){var r=controlInformationObject(t);if(checkExists(r)){var u=r.ViewID,f=r.InstanceID;updateHiddenPropertyCollection({viewID:u,instanceID:f,controlID:t,brokerData:n,identifierField:q})}}function updateHiddenPropertyCollection(n){checkExists(n.brokerData)&&n.brokerData.length>0?setHiddenPropertyCollection(n.viewID,n.brokerData,n.controlID,null,null,n.instanceID):(checkExists(n.removeCounter)||(n.removeCounter=!0),removeHiddenPropertyCollection(n.viewID,n.parentID,n.parentType,n.pageNumber,n.controlID,n.includeCounter,n.contextType,n.instanceID,n.contextID,n.removeCounter))}function setHiddenPropertyCollection(n,t,q,r,u,f){if(checkExists(t)){if(checkExistsNotEmpty(q)&&checkExists(_runtimeFieldsXmlHash)&&delete _runtimeFieldsXmlHash[q],checkExistsNotEmpty(q)&&checkExists(_runtimeELJoinHash)){var s=returnHashName(n,f);delete _runtimeELJoinHash[s]}var o=t.length;if(o!==0){var e={};for(checkExists(q)&&(e.controlid=q),checkExists(r)&&(e.contextid=r),checkExists(u)&&(e.contexttype=u);o--;){var h=t[o];setHiddenValueAttributes(h,e)}pushHiddenValue(n,f,t)}}}function setHiddenParameterCollection(n){for(var o=$xml(n),f=$mn(o,baseCollectionXPath),e=f.length;e--;)for(var t=f[e],s=t.getAttribute("viewid"),h=t.getAttribute("parentid"),c=t.getAttribute("parenttype"),q=$mn(t,"fields/field"),r=q.length;r--;){var l=q[r].getAttribute("name"),u=$sn(q[r],"value");checkExists(u)&&checkExistsNotEmpty(u.text)&&setHiddenJSONValue(h,c,s,null,null,null,!0,null,null,null,l,"MethodParameter",u.text,null)}}function setHiddenValueAttributes(n,t){checkExists(t)||(t={});checkExists(t.controlid)&&(n.controlid=t.controlid);n.state||(n.state="Unchanged");checkExists(t.contextID)&&checkExists(t.contextType)&&!n.contextid&&!n.contexttype&&(n.contextid=t.contextID,n.contexttype=t.contextType)}var returnFieldAttributeObject=function(n,t){var u=t;checkExistsNotEmpty(u)||(u=_runtimeEmptyGuid);var e=u+"_"+n,q=fieldObjectInfoCache[e];if(!q){if(q={},!checkExists(viewControllerDefinition))return null;var f=checkExists(t)?"[@InstanceID='"+t+"']":"",r=$sn(viewControllerDefinition,"Controllers/Controller"+f+"/Fields/Field[@ID='"+n+"']");if(!checkExists(r)&&checkExists(t)&&(r=$sn(viewControllerDefinition,"Controllers/Controller/Fields/Field[@ID='"+n+"']"),checkExists(r)&&(SFLog({type:1,source:"getHiddenFieldValue",category:"Fields",message:"Instance [{0}] for field [{1}] did not match",parameters:[t,n]}),t=null,f="")),!checkExists(r))return null;if(q.fieldID=n,q.instanceXP=f,q.instanceID=t,q.viewID=r.parentNode.parentNode.getAttribute("ID"),q.viewType=r.parentNode.parentNode.getAttribute("TypeView"),q.mainTable=r.parentNode.parentNode.getAttribute("MainTable"),q.parentID=r.getAttribute("ObjectID"),q.parentType=r.getAttribute("ObjectType"),q.PropertyName=checkExists($sn(r,"PropertyName"))?$sn(r,"PropertyName").text:"",q.propertyType=checkExists($sn(r,"PropertyType"))?$sn(r,"PropertyType").text:"",q.contextID=r.getAttribute("ContextID"),q.contextType=r.getAttribute("ContextType"),q.fieldType=checkExists($sn(r,"FieldType"))?$sn(r,"FieldType").text:"",q.name=checkExists($sn(r,"Name"))?$sn(r,"Name").text:"",q.association=new dataSourceLookup({xmlDoc:viewControllerDefinition,associationSO:q.parentID,contextID:q.contextID,instanceID:q.instanceID}).getDataSource(),q.parentIdIsAssocSO=!1,q.parentIdIsDisplaySO=!1,checkExists(q.association)?q.parentIdIsAssocSO=!0:(q.association=new dataSourceLookup({xmlDoc:viewControllerDefinition,displaySO:q.parentID,contextID:q.contextID,instanceID:q.instanceID}).getDataSource(),checkExists(q.association)&&(q.parentIdIsDisplaySO=!0)),q.isComposite="false",q.sourceControlIDAttr="",q.parentIdIsAssocSO||q.parentIdIsDisplaySO){var o=q.association.getAttribute("IsComposite");checkExistsNotEmpty(o)&&(q.isComposite=o.toLowerCase());q.sourceControlIDAttr=q.association.getAttribute("SourceControlID")}fieldObjectInfoCache[e]=q}return q};function getHiddenFieldValue(n,t,q,r,u,f,e){var a={},c=null,o=returnFieldAttributeObject(n,u);if(!checkExists(o))return"";checkExists(e)||(e=!1);var ht=t,rt=!1,v=!1,h=null;if((o.isComposite==="false"&&o.parentIdIsAssocSO||o.parentIdIsDisplaySO)&&checkExistsNotEmpty(o.sourceControlIDAttr)){var b=getLoopContextData({loopContextID:f,viewID:o.viewID,instanceID:o.instanceID,controlID:o.sourceControlIDAttr});checkExists(b)&&checkExists(b.item)&&(t=b.counter,h=b.item,checkExistsNotEmpty(t)?rt=!0:t=ht)}var ut="";if(checkExists(h)&&checkExists(h.fields)){var ft=h.fields[o.PropertyName];checkExists(ft)&&(c=GetPropertyValue(ft,q))}else{h=getViewHiddenHash(o.viewID,o.instanceID);var et=!0;if(checkExists(h)){if(checkExists(t)||(t=!1),rt===!0&&(o.parentIdIsAssocSO||o.parentIdIsDisplaySO)&&o.isComposite==="false"&&typeof t!="boolean"&&!e&&checkExistsNotEmpty(o.sourceControlIDAttr)&&(v=o.sourceControlIDAttr),o.isComposite==="true"&&(o.parentIdIsAssocSO&&r===!0||o.parentIdIsDisplaySO)&&(o.contextType=o.association.getAttribute("ContextType"),v=!0),o.isComposite!=="true"&&checkExists(h)&&checkExists(o.association)&&(o.contextType==="Association"||o.contextType==="External")){var p=o.association.getAttribute("ValueProperty");v=o.association.getAttribute("SourceControlID");var s,d={contextid:o.contextID,parentid:o.parentID,parenttype:o.parentType,counter:!1},y=h.filter(__runtimeJsonFilterMatchingItems,d);if(y.length==1?s=y[0].fields[p].value:!checkExists(s)&&checkExistsNotEmpty(v)&&(d={controlid:v},y=y.filter(__runtimeJsonFilterMatchingItems,d),y.length==1&&(s=y[0].fields[p].value)),s&&s.startsWith("<collection Type='Complex'>")){ut=baseCollectionXPath+"[@parentid='"+o.parentID+"']/fields/field[@name='"+o.PropertyName+"']/value";var ot=$sn($xml(s),ut);checkExists(ot)&&(c=ot.text)}if(!c&&checkExistsNotEmpty(s)){et=!1;var g=[];if(s.startsWith("<collection")){var ct=baseCollectionXPath+"/fields/field/value",st=$mn($xml(s),ct);st.length===1&&(s=st[0].text)}var lt={parentid:o.parentID,parenttype:o.parentType,controlid:v};g=h.filter(__runtimeJsonFilterMatchingItems,lt);var nt=g.length;for(nt===0&&o.PropertyName===p&&(c=s);nt--;){var k=g[nt];if(checkExists(k)&&checkExists(k.fields[p])&&k.fields[p].value==s){var tt=k.fields[o.PropertyName];if(checkExists(tt)){c=q?tt.cleared===!0:tt.value;break}}}}}if(et){o.contextType==="Association"||o.contextType==="External"?(a={counter:t},o.isComposite==="true"?(a.parentid=o.parentID,a.parenttype=o.parentType):o.contextType==="Association"&&o.viewType==="List"&&(a.contexttype="Primary")):a={parentid:o.parentID,parenttype:o.parentType,counter:t,contextid:o.contextID,contexttype:o.contextType};var w=h.filter(__runtimeJsonFilterMatchingItems,a);if(w.length===1){var l;if(checkExists(w[0].joins)&&(o.contextType==="Association"||o.contextType==="External")){var at={parentid:o.parentID,parenttype:o.parentType,contextid:o.contextID,contexttype:o.contextType},qt=w[0].joins.filter(__runtimeJsonFilterMatchingItems,at);qt!=null&&qt.length>0&&(l=qt[0].fields[o.PropertyName])}else l=w[0].fields[o.PropertyName];checkExists(l)||(l=GetAssociationProperty(h,o,w));checkExists(l)&&(l.cleared=!checkExistsNotEmpty(l.value),c=GetPropertyValue(l,q))}}}}return q&&!checkExists(c)&&(c=""),c}function GetAssociationProperty(n,t,q){var o;if(checkExistsNotEmpty(q)&&q.length===1&&checkExists(t.association)&&(t.contextType==="Association"||t.contextType==="External")){var f=t.association.getAttribute("OriginalProperty"),e=t.association.getAttribute("ValueProperty");if(checkExistsNotEmpty(f)&&checkExistsNotEmpty(e)&&checkExists(q[0].fields[f])){var h=q[0].fields[f].value,c={parentid:t.parentID,parenttype:t.parentType,contextid:t.contextID,contexttype:t.contextType},u=n.filter(__runtimeJsonFilterMatchingItems,c);if(u!=null&&u.length>0)for(var s=u.length;s--;){var r=u[s];if(checkExists(r)&&checkExists(r.fields[e])&&checkExists(r.fields)&&checkExists(t.PropertyName)&&r.fields[e].value===h){o=r.fields[t.PropertyName];break}}}}return o}function GetPropertyValue(n,t){return t?n.cleared===!0:n.value}function getCombinedHiddenPropertyCollection(n,t,q,r,u,f,e,o,s,h){var c={parentid:t,parenttype:q,controlid:u,pagenumber:r,counter:f,contextid:o,contexttype:s};return getHiddenPropertyCollection(n,h,c)}function getHiddenPropertyCollection(n,t,q){var r=[],u=getViewHiddenHash(n,t);return u.length>0&&(r=u.filter(__runtimeJsonFilterMatchingItems,q)),r}function getHiddenParameter(n,t,q){var s={parentid:t,parenttype:"Object",method:!0},f=null,e=getViewHiddenHash(n,null);if(e.length>0)for(var r=e.filter(__runtimeJsonFilterMatchingItems,s),u=r.length;u--;)if(r[u].parameters){var o=r[u].parameters[q];if(checkExists(o)){f=o.value;break}}return f}function getHiddenParameterCollection(n){return getHiddenPropertyCollection(n,null,{parenttype:"Object",method:!0})}function getHiddenParameterCollectionXml(n){var u=getHiddenPropertyCollection(n,null,{parenttype:"Object",method:!0}),q=u.length;if(q>0){for(var t=$xml("<collection/>");q--;){var e=u[q].parameters;if(checkExists(e)){var r=t.createElement("object");r.setAttribute("parentid",u[q].parentid);r.setAttribute("parenttype","Object");r.setAttribute("viewid",n);var o=t.createElement("fields");for(var s in e){var f=t.createElement("field");f.setAttribute("name",s);f.setAttribute("type","MethodParameter");var h=t.createElement("value");h.appendChild(t.createTextNode(u[q].parameters[s].value));f.appendChild(h);o.appendChild(f)}r.appendChild(o);t.documentElement.appendChild(r)}}return t}}function removeHiddenPropertyCollection(n,t,q,r,u,f,e,o,s,h){var v=!0;v=f===!1?null:f;h===!0&&(v=!1);var l=returnHashName(n,o),c=ViewHiddenHash[l];if(c&&c.length>0){var p=c.length;viewWriteStatus[l]=!0;var w={parentid:t,parenttype:q,counter:v,controlid:u,pagenumber:r,contexttype:e,method:!1,contextid:s},y=c.filter(__runtimeJsonFilterMatchingItems,w),a=y.length;if(a===0){viewWriteStatus[l]=!1;return}if(a===p)ViewHiddenHash[l]=[];else{while(a--){var b=y[a];c.splice(c.indexOf(b),1)}ViewHiddenHash[l]=c}viewWriteStatus[l]=!1}}function removeHiddenPropertyCollectionItem(n,t,q,r){var s=null,c=!0;checkExists(q)?s="Primary":(q=!1,c=!1);var f=returnHashName(n,r),u=ViewHiddenHash[f];if(u&&u.length>0){var v=u.length;viewWriteStatus[f]=!0;var l={counter:q,controlid:t,contexttype:s},h=u.filter(__runtimeJsonFilterMatchingItems,l),e=h.length;if(e>0){while(e--){var o=h[e],a=o.state;switch(a){case"Added":u.splice(u.indexOf(o),1);break;default:o.state="Removed"}}ViewHiddenHash[f]=u}viewWriteStatus[f]=!1}}function writeHiddens(n){if(hiddenValueArray[n].length>0){var t=ViewHiddenHash[n];for(checkExists(t)||(t=[]);hiddenValueArray[n].length>0;){viewWriteStatus[n]=!0;var q=hiddenValueArray[n].shift();if(isOfType("Array",q))if(t.length>0)while(q.length>0){var r=q.shift();t=manipulateHiddenValues(t,r)}else t=q;else isOfType("Object",q)&&(checkExists(q.fields)||checkExists(q.parameters))&&(t=manipulateHiddenValues(t,q));viewWriteStatus[n]=!1}ViewHiddenHash[n]=t}}function manipulateHiddenValues(n,t){var q=[];if(n.length>0&&(t.ignoreFields=!0,t.ignoreState=!0,checkExists(t.counter)||(t.counter=!1),q=n.filter(__runtimeJsonFilterMatchingItems,t)),t.counter===!1&&delete t.counter,delete t.ignoreFields,delete t.ignoreState,q.length===1){var u=jsonExtendObject(q[0],t);u===!0&&n.splice(n.indexOf(q[0]),1)}else{var r=t.state;checkExists(r)?r==="Changed"&&(t.state="Added"):t.state="Added";n.push(t)}return n}function pushHiddenValue(n,t,q){var r=returnHashName(n,t);checkExists(hiddenValueArray[r])||(hiddenValueArray[r]=[]);hiddenValueArray[r].push(q);viewWriteStatus[r]||writeHiddens(r)}function returnHashName(n,t){var q="_"+(checkExistsNotEmpty(t)?t:_runtimeEmptyGuid);var r=getExportToExcelData({viewId:n,instanceId:t});return r.busyExporting===!0&&(q+="_xlsx"),n+q}function getViewHiddenHash(n,t){var q=returnHashName(n,t);return checkExists(ViewHiddenHash[q])||(ViewHiddenHash[q]=[]),ViewHiddenHash[q]}function getAllViewHiddenHashNames(){return Object.keys(ViewHiddenHash)}function getAllViewWriteStatusNames(){return Object.keys(viewWriteStatus)}function verifyRecordsForPage(n,t,q){var u={pagenumber:t},r=getViewHiddenHash(n,q);if(r.length>0){var f=r.filter(__runtimeJsonFilterMatchingItems,u);return f.length}return 0}function getViewItemsCollectionViewDef(n){var t=window,q=_runtimeControllerFindObject(n);return!checkExists(q)&&(n.transferredID=__runtimeParentSubformID,n.runtimeContextID=__runtimeParentContextID,t=findCorrectInstanceForDataTransfer(n).WindowToUse,t!==window.self)?t.getViewItemsCollectionViewDef(n):{viewDef:q,windowToUse:t}}function ViewItemsCollection(n){var e=[],q=null;if(checkExists(n)&&(q=$mn(n,"*/Item[(@SourceType) and (@SourceID)]")),checkExists(q)&&q.length>0){var u=n.getAttribute("InstanceID"),o=evaluateFunctionParameters(q),r=o.VIEW,s=o.ITEMSTATE;if(checkExistsNotEmpty(r)){var f={instanceID:u,viewID:r},t=getViewItemsCollectionViewDef(f);checkExists(t.viewDef)||(f={instanceID:null,viewID:r},t=getViewItemsCollectionViewDef(f),checkExists(t.viewDef)&&(u=null));checkExists(t.viewDef)&&(e=t.windowToUse.getViewItemsCollectionFunctionResults(t.viewDef,r,u,s))}}return e}function getViewItemsCollectionFunctionResults(n,t,q,r){var c=[],e=n.getAttribute("MainTable"),v=n.getAttribute("ContextID");if(checkExists(e)&&e.length>0){var l=jQuery("#"+e);l[0].getAttribute("editable")==="true"&&attemptItemChanges(l,t,q)}var s=getViewHiddenHash(t,q);if(checkExists(s)&&s.length>0){var u={parentid:v,parenttype:"Object",state:r,contexttype:"Primary",counter:!0};if(checkExistsNotEmpty(r)){var a=r.toUpperCase();switch(a){case"SELECTED":case"UNSELECTED":var h=getViewRowCounters(e,a);checkExists(h)&&h.length>0?(u.counters=h,delete u.counter,delete u.state):u=null;break;case"UNCHANGED":delete u.contexttype}}if(checkExists(u)){var f=s.filter(__runtimeJsonFilterMatchingItems,u);if(checkExists(f)&&f.length>0)for(var y=f.length,o=0;o<y;o++)c.push({viewID:t,item:f[o],counter:f[o].counter})}}return c}function ControlItemsCollection(n){var c=[],q=null;if(checkExists(n)&&(q=$mn(n,"*/Item[(@SourceType) and (@SourceID)]")),checkExists(q)&&q.length>0){var o=n.getAttribute("InstanceID"),s=evaluateFunctionParameters(q),r=s.VIEW,l=s.CONTROL,w=s.ITEMSTATE;if(checkExistsNotEmpty(r)){var u=getInstanceSpecificControlID(o,l);if(checkExistsNotEmpty(u)){var f={instanceID:o,viewID:r},a=_runtimeControllerFindObject(f);if(checkExists(a)){var y=$sn(a,"Controls/Control[@ID='"+u+"'][Properties/Property/Name/text()='GetItems']");if(checkExists(y)){var b=getCombinedHiddenPropertyCollection(r,null,"Object",null,u,!0,null,null,null,o),k=new PopulateObject(null,w,u,null,null,b),t=executeControlFunction(y,"GetItems",k);if(checkExists(t)){var p=t.length;if(p>0)for(var d=t[0].xml!==null&&typeof t[0].xml!="undefined",h=0;h<p;h++){var e=t[h];d&&(e=_runtimeTransformXmlFieldsToObject(e));c.push({viewID:r,controlID:l,item:e,counter:e.counter})}}}}else{f.transferredID=__runtimeParentSubformID;f.runtimeContextID=__runtimeParentContextID;var v=findCorrectInstanceForDataTransfer(f).WindowToUse;if(v!==window.self)return v.ControlItemsCollection(n)}}}}return c}function evaluateFunctionParameters(n){for(var t={},q=n.length;q--;){var r=n[q],u=r.getAttribute("SourceType").toUpperCase(),f=r.getAttribute("SourceID");t[u]=f}return t}var jsonCompareItemToObject=function(n,t){var r=!0,u=t.ignoreFields,f=t.ignoreState;for(var q in t){switch(q){case"ignoreFields":case"ignoreState":case"join":case"name":case"joins":case"instanceid":r=!0;break;case"fields":u?r=!0:Object.keys(n.fields).length>0&&Object.keys(t.fields).length>0&&(r=jsonCompareItemToObject(n.fields,t.fields));break;case"parameters":u?r=!0:Object.keys(n.parameters).length>0&&Object.keys(t.parameters).length>0&&(r=jsonCompareItemToObject(n.parameters,t.parameters));break;case"state":f?r=!0:t[q]==="All"?r=n[q]!=="Removed":t[q]!==n[q]&&(r=!1);break;case"counters":var e=t[q];r=e.indexOf(n.counter)>-1?!0:!1;break;default:q==="joins"&&u?r=!0:t[q]!==null&&typeof t[q]!="undefined"&&(t[q]===!0?r=n[q]!=null&&typeof n[q]!="undefined":t[q]===!1?r=n[q]===null||typeof n[q]=="undefined":t[q]!==n[q]&&(r=!1))}if(r===!1)break}return r},jsonExtendObject=function(n,t){var f=!1;for(var q in t)if(q==="fields")checkExists(n.fields)||(n.fields={}),result=jsonExtendObject(n.fields,t.fields);else if(q==="parameters")checkExists(n.parameters)||(n.parameters={}),result=jsonExtendObject(n.parameters,t.parameters);else if(q==="joins")checkExists(n.joins)||(n.joins=[]),result=jsonExtendObject(n.joins,t.joins);else if(q==="state"&&checkExistsNotEmpty(n.counter)&&checkExistsNotEmpty(t.counter)){var r=t.state,u=n.state;if(checkExists(r))if(checkExists(u))if(u==="Added"&&r==="Removed"){f=!0;break}else if(u==="Removed"&&r==="Unchanged"){f=!0;break}else n.state=u==="Added"&&r==="Changed"?"Added":r;else n.state=r}else n[q]=t[q];return f},jsonCopyAndExtendObject=function(n,t){var q={};for(var r in n)switch(r){case"fields":q.fields={};jsonExtendObject(q.fields,n.fields);break;case"parameters":q.parameters={};jsonExtendObject(q.parameters,n.parameters);break;case"joins":q.joins=[];jsonExtendObject(q.joins,n.joins);break;default:q[r]=n[r]}return t!==null&&typeof t!="undefined"&&(t===!1?delete q.counter:q.counter=t),q},__runtimeJsonFilterMatchingItems=function(n){return jsonCompareItemToObject(n,this)},isOfType=function(n,t){var q=Object.prototype.toString.call(t).slice(8,-1);return t!==undefined&&t!==null&&q===n};
/*!
 ~/RunTime/Script/Information.js
*/
(function(n){if((typeof SourceCode=="undefined"||SourceCode===null)&&(SourceCode={}),(typeof SourceCode.Forms=="undefined"||SourceCode.Forms===null)&&(SourceCode.Forms={}),(typeof SourceCode.Forms.Runtime=="undefined"||SourceCode.Forms.Runtime===null)&&(SourceCode.Forms.Runtime={}),typeof SourceCode.Forms.Runtime.Information=="undefined"||SourceCode.Forms.Runtime.Information===null){var t=function(){this._contextHashes={}};t.prototype={getContextHash:function(n){var t=returnHashName(n.viewId,n.instanceId);return this._contextHashes[t]},ensureContextHash:function(n){var t=this.getContextHash(n);return checkExists(t)||(t={},n.value=t,this.setContextHash(n)),t},setContextHash:function(n){var t=returnHashName(n.viewId,n.instanceId);this._contextHashes[t]=n.value},ensureControlBrokerHistory:function(n){var t=this.ensureContextHash({viewId:n.viewId,instanceId:n.instanceId});return checkExists(t.ControlBrokerHistory)||(t.ControlBrokerHistory={}),t.ControlBrokerHistory},getControlBrokerHistory:function(n){var q=null,t=this.getContextHash({viewId:n.viewId,instanceId:n.instanceId});return checkExists(t)&&checkExists(t.ControlBrokerHistory)&&(q=t.ControlBrokerHistory[n.controlId]),q},setControlBrokerHistory:function(n){var t=this.ensureControlBrokerHistory({viewId:n.viewId,instanceId:n.instanceId});t[n.controlId]=n.value},ensureControlWorkflowHistory:function(n){var t=this.ensureContextHash({viewId:n.viewId,instanceId:n.instanceId});return checkExists(t.ControlWorkflowHistory)||(t.ControlWorkflowHistory={}),t.ControlWorkflowHistory},getControlWorkflowHistory:function(n){var q=null,t=this.getContextHash({viewId:n.viewId,instanceId:n.instanceId});return checkExists(t)&&checkExists(t.ControlWorkflowHistory)&&(q=t.ControlWorkflowHistory[n.controlId]),q},setControlWorkflowHistory:function(n){var t=this.ensureControlWorkflowHistory({viewId:n.viewId,instanceId:n.instanceId});t[n.controlId]=n.value},ensureControlPropertyHistory:function(n){var t=this.ensureContextHash({viewId:n.viewId,instanceId:n.instanceId});return checkExists(t.ControlPropertyHistory)||(t.ControlPropertyHistory={}),checkExists(t.ControlPropertyHistory[n.controlId])||(t.ControlPropertyHistory[n.controlId]={}),t.ControlPropertyHistory[n.controlId]},getControlPropertyHistory:function(n){var q=null,t=this.getContextHash({viewId:n.viewId,instanceId:n.instanceId});return checkExists(t)&&checkExists(t.ControlPropertyHistory)&&checkExists(t.ControlPropertyHistory[n.controlId])&&(q=t.ControlPropertyHistory[n.controlId][n.propertyName]),q},setControlPropertyHistory:function(n){var t=this.ensureControlPropertyHistory({viewId:n.viewId,instanceId:n.instanceId,controlId:n.controlId});t[n.propertyName]=n.value},saveState:function(){return n.extend({},this._contextHashes,!0)},loadState:function(n){typeof n=="string"&&(n=JSON.parse(n));for(var r in n){var t=n[r];if(checkExists(t.ControlPropertyHistory))for(var q in t.ControlPropertyHistory){var u=t.ControlPropertyHistory[q];["field","controlexpression","datatype","parentusingfield"].forEach(function(n){var t=u[n];checkExists(t)&&updateSpecialControlProperties({controlId:q,propertyName:n,propertyValue:t,skipAction:!0})})}}this._contextHashes=n},reset:function(){this._contextHashes={}}};SourceCode.Forms.Runtime.Information=new t}})(jQuery);
/*!
 ~/RunTime/Script/AJAX.js
*/
var ajaxCall=null,workflowInfo=null;function AjaxCall(){var t=jQuery("#AjaxURL"),q="AjaxCall.ashx";if(t.length>0&&(q=t[0].value),this.ajaxUrlValue=q,cachedEnvironmentFields=[],typeof __runtimeAnonToken!="undefined"&&checkExistsNotEmpty(__runtimeAnonToken)){var n={};n.headers={};n.headers[__runtimeAnonTokenName]=__runtimeAnonToken;SourceCode.Forms.XSRFHelper.setAntiXSRFTokenInHeaderCollection(n.headers);jQuery.ajaxSetup(n)}}function handleAJAXError(n,t,q,r){checkExists(r)&&_runtimeNotifyControlsAndViewsOfFailure({brokerPackages:r,returnData:q});runtimeHideBusyOverlay({forceHide:!0});popupManager.showError(Resources.Runtime.AjaxError+"<br/><br/>["+n.status+"] "+n.statusText+" ("+t+")")}function redirectUserForAuthentication(){popupManager.closeLast();SourceCode.Forms.SessionManagement.renewclaimssession()}function handleRedirectError(n){if(checkExists(n)&&_runtimeNotifyControlsAndViewsOfFailure({brokerPackages:n,returnData:""}),runtimeHideBusyOverlay({forceHide:!0}),SourceCode.Forms.Settings.Session.DisableAjaxReAuthenticate){var t="<a href='' onClick='javascript:window.location.reload();'>{0}<\/a>".format(Resources.RuntimeMessages.ReloadFormDisplay);t=Resources.RuntimeMessages.ReloadFormLink.format(t);var r="{0}<br/><br/>{1}".format(Resources.RuntimeMessages.RedirectPageMessage,t);popupManager.showError(r)}else{var q="<a href='#' onClick='javascript:redirectUserForAuthentication();'>{0}<\/a>".format(Resources.RuntimeMessages.ReAuthenticateUserLink);q=Resources.RuntimeMessages.ReAuthenticateUserMessage.format(q);var r="{0}<br/><br/>{1}".format(Resources.RuntimeMessages.ReAuthenticatePageMessage,q);popupManager.showError(r)}}AjaxCall.prototype.persistRuntimeValues=function(n,t,q){SFLog({type:1,source:"persistRuntimeValues",category:"AJAX",message:"Saving runtime values for {0} ({1})",parameters:[t,n],data:q});jQuery.ajax({url:this.ajaxUrlValue,dataType:"xml",type:"POST",global:!1,data:{method:n,viewID:t,persistedValues:encodeURIComponent(q)}})};var _runtimePauseAjax=!1,_runtimeRetryAjaxQueue=[],_runtimeContinueAjaxQueue=[],_runtimeNativeAjax=!0;AjaxCall.prototype.executeRuntimeBehaviour=function(n){var r=JSON.stringify(n.brokerPackagesJson);if(SFLog({type:3,source:"executeRuntimeBehaviour",category:"AJAX",message:"AJAX method execution",data:r}),checkExists(n.behaviour)||checkExists(n.deferred)||(n.deferred=$.Deferred()),n.modalizeWorkflowView){var u=jQuery("*[id$=_9afc3bff-abee-4066-93d6-c217cdf765f5]");u.length>0&&u[0].style.display!=="none"&&u.modalize(!0,null,null,null,null,{addToElement:!0})}var t=null;checkExists(n.credentials)&&(t={},t["X-K2-2AUTH"]=JSON.stringify(n.credentials));var f=SourceCode.Forms.Runtime.getMasterRuntimeWindow();f.updateExecutionTracker(1);var q=!0;checkExists(n.runAsync)&&(q=n.runAsync);var e;return e=_runtimeNativeAjax&&q?_runtimeAjaxCall("POST",this.ajaxUrlValue,t,r):jQuery.ajax({url:this.ajaxUrlValue,dataType:"json",type:"POST",global:!1,headers:t,async:q,data:r}),e.done(function(t,r,u){if(typeof _runtimeScriptsLoaded!="undefined"){var f=u;if(checkExists(u.getResponseHeader)&&(f=u.getResponseHeader("Content-Type")),t==null){t=$.parseXML('<Exception Title="{0}"><Message Name="Message">{1}<\/Message><\/Exception>'.format(Resources.MessageBox.Error,Resources.Runtime.AjaxNetworkError));handleFailRuntimeBehaviourResult(n,t,"503",Resources.Runtime.AjaxNetworkError,f);return}var e={initialRetry:n.initialRetry,data:t,behaviour:n.behaviour,deferred:n.deferred,brokerPackages:n.brokerPackages,brokerPackagesJson:n.brokerPackagesJson,batchedActions:n.batchedActions,hasViewID:n.hasViewID,textStatus:r,responseContentType:f,runAsync:q};handleDoneRuntimeBehaviourResult(e)}}).fail(function(t,q,r,u){if(typeof _runtimeScriptsLoaded!="undefined"){if(checkExists(t.getResponseHeader)){u=t.getResponseHeader("Content-Type");try{t=$.parseXML(t.responseText)}catch(f){t=null}}t==null&&(t=$.parseXML('<Exception Title="{0}"><Message Name="Message">{1}<\/Message><\/Exception>'.format(Resources.MessageBox.Error,Resources.Runtime.AjaxNetworkError)),q="503");handleFailRuntimeBehaviourResult(n,t,q,r,u)}}).always(function(){this.updateExecutionTracker(-1)}.bind(f)),checkExists(n)&&checkExists(n.deferred)?n.deferred.promise():void 0};var _runtimeAjaxCall_initialized=!1,_runtimeAjaxCall_additionalHeaders=null;function _runtimeAjaxCallInitialize(){checkExists(_runtimeNativeAjax)&&_runtimeAjaxCall&&(_runtimeAjaxCall_additionalHeaders={},typeof __runtimeAnonToken!="undefined"&&checkExistsNotEmpty(__runtimeAnonToken)&&(_runtimeAjaxCall_additionalHeaders[__runtimeAnonTokenName]=__runtimeAnonToken));_runtimeAjaxCall_initialized=!0}function _runtimeAjaxCall(n,t,q,r,u){_runtimeAjaxCall_initialized||_runtimeAjaxCallInitialize();var s=$.Deferred(),f=new XMLHttpRequest;if(f.open(n,t,!0),_runtimeAjaxCall_additionalHeaders)for(var e in _runtimeAjaxCall_additionalHeaders)_runtimeAjaxCall_additionalHeaders.hasOwnProperty(e)&&f.setRequestHeader(e,_runtimeAjaxCall_additionalHeaders[e]);if(q)for(var e in q)q.hasOwnProperty(e)&&f.setRequestHeader(e,q[e]);if(SourceCode.Forms.XSRFHelper.setAntiXSRFHeader(f),f.onload=function(){if(typeof _runtimeScriptsLoaded!="undefined"){var t=f.getResponseHeader("Content-Type"),n=null;t=checkExistsNotEmpty(t)?t.toUpperCase():"";checkExistsNotEmpty(u)&&u.toLowerCase()==="blob"?n=f.response:t.contains("APPLICATION/JSON")?n=JSON.parse(f.responseText):t.contains("TEXT/HTML")||(supportsActiveX()?(n=tryParseXML(f.responseText),n.selectNodes("*").length===0&&(n=null)):n=f.responseXML);f.status==200?s.resolve(n,"",t):s.reject(n,f.statusText,null,t)}},f.onerror=function(){if(typeof _runtimeScriptsLoaded!="undefined"){var n=parseXML('<Exception Title="'+Resources.MessageBox.Error+'"><Message Name="Message">'+Resources.Runtime.AjaxNetworkError+"<\/Message><\/Exception>");s.reject(n,"503",null,"")}},n==="POST"){f.setRequestHeader("Accept","application/xml, text/xml, */*, application/json; q=0.01");var o="";if(r)if(typeof r=="string")f.setRequestHeader("Content-Type","application/json"),o=r;else{f.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8");for(var h in r)r.hasOwnProperty(h)&&(o.length>0&&(o+="&"),o+=encodeURIComponent(h)+"="+encodeURIComponent(r[h]))}checkExistsNotEmpty(u)&&u.toLowerCase()==="blob"&&(f.responseType=u);f.send(o)}else f.send();return s}function _runtimeNotifyControlsAndViewsOfFailure(n){n=checkExists(n)?n:{};n.brokerPackages=checkExists(n.brokerPackages)?n.brokerPackages:[];for(var q=n.brokerPackages.length,r=new SFRuntimeHash;q--;){var t=n.brokerPackages[q];_runtimeNotifySetItemControlsOfFailurePerPackage({brokerPackage:t,tempHash:r,returnData:n.returnData});checkExistsNotEmpty(t.viewID)&&runtimeBusyView(t.viewID,!1,!1,t.instanceID)}r=null}function _runtimeNotifySetItemControlsOfFailurePerPackage(n){if(checkExists(n.brokerPackage.controlID)){var t=[n.brokerPackage.controlID,n.brokerPackage.viewID,n.brokerPackage.instanceID];if(!n.tempHash.get(t)){var q=_runtimeControllerFindObject({controlID:n.brokerPackage.controlID,instanceID:n.brokerPackage.instanceID,viewID:n.brokerPackage.viewID});if(q){var r={error:!0,message:"Server ajax execution failed",CurrentControlId:n.brokerPackage.controlID};try{executeControlFunction(q,"SetItems",r)}catch(u){SFLog({type:3,source:"_runtimeNotifySetItemControlsOfFailurePerPackage",category:"AJAX",message:"Error on setitems on control {0} with error result".format(n.brokerPackage.controlID),data:n.returnData})}}n.tempHash.add(t,!0)}}}function handleResultError(n){n=checkExists(n)?n:{};var t=null;checkExists(n.batchedActions)&&n.batchedActions.length===1&&(t=getLoopContextID(n.batchedActions[0]));checkExists(n.behaviour)?n.behaviour.handleError(n.errorType,n.data,n.status,n.error,n.brokerPackages,t):checkExists(n.deferred)&&n.deferred.reject(n.errorType,n.data,n.status,n.error,n.brokerPackages,t)}function isWorkflowResultError(n){if(n===null||typeof n=="undefined"||n.packageValues===null||typeof n.packageValues=="undefined"||n.packageValues.c===null||typeof n.packageValues.c=="undefined")return{isError:!1};var t=n.packageValues.c.length;if(t>0)while(t--){var q,u,f=null,r="";if(checkExists(n.brokerPackages)&&t<n.brokerPackages.length&&(q=n.brokerPackages[t]),checkExists(n.batchedActions)&&t<n.batchedActions.length&&(u=n.batchedActions[t]),checkExists(q)&&checkExistsNotEmpty(q.method)&&(r=q.method.toUpperCase()),r==="STARTPROCESS"||r==="ACTIONPROCESS"){f=n.packageValues.c[t];var e=f.WorkflowMethodResult;if(e==="false")return{isError:!0,action:u,data:e}}}return{isError:!1}}function handleDoneRuntimeBehaviourResult(n){if(n.responseContentType=checkExistsNotEmpty(n.responseContentType)?n.responseContentType.toUpperCase():"",n.responseContentType.contains("TEXT/HTML")){var r={batchedActions:n.batchedActions,behaviour:n.behaviour,deferred:n.deferred,errorType:"redirect",brokerPackages:n.brokerPackages};handleResultError(r)}else if(_runtimePauseAjax&&n.initialRetry===!0){_runtimePauseAjax=!1;_runtimeRetryAjaxQueue.shift();var t=_runtimeRetryAjaxQueue,q=_runtimeContinueAjaxQueue;for(_runtimeRetryAjaxQueue=[],_runtimeContinueAjaxQueue=[];t.length>0;)ajaxCall.executeRuntimeBehaviour(t.shift());for(continueHandleRuntimeBehaviourResult({data:n.data,behaviour:n.behaviour,deferred:n.deferred,brokerPackages:n.brokerPackages,brokerPackagesJson:n.brokerPackagesJson,batchedActions:n.batchedActions,hasViewID:n.hasViewID,runAsync:n.runAsync});q.length>0;)continueHandleRuntimeBehaviourResult(q.shift())}else continueHandleRuntimeBehaviourResult({data:n.data,behaviour:n.behaviour,deferred:n.deferred,brokerPackages:n.brokerPackages,brokerPackagesJson:n.brokerPackagesJson,batchedActions:n.batchedActions,hasViewID:n.hasViewID,runAsync:n.runAsync})}function handleFailRuntimeBehaviourResult(n,t,q,r,u){var f={batchedActions:n.batchedActions,behaviour:n.behaviour,deferred:n.deferred,errorType:"exc",data:t,status:q,error:r,brokerPackages:n.brokerPackages,brokerPackagesJson:n.brokerPackagesJson};if(_runtimePauseAjax){if(SourceCode.Forms.ExceptionHandler.isAuthenticationException(t)&&n.initialRetry===!0){SourceCode.Forms.ExceptionHandler.handleAuthenticationException(t,n,function(){closeAuthLoginPopup(f)});return}_runtimeRetryAjaxQueue.push(n)}else{if(u=checkExistsNotEmpty(u)?u.toUpperCase():"",u.contains("TEXT/HTML"))f.errorType="redirect";else if(checkExists(t)){if(SourceCode.Forms.ExceptionHandler.isAuthenticationException(t)){_runtimePauseAjax=!0;_runtimeRetryAjaxQueue.push(n);runtimeHideBusyOverlay({forceHide:!0});hideAllBusyForResult(n.brokerPackages);_runtimeNotifyControlsAndViewsOfFailure({brokerPackages:n.brokerPackages,returnData:t});SourceCode.Forms.ExceptionHandler.handleAuthenticationException(t,n,function(){closeAuthLoginPopup(f)});return}if(SourceCode.Forms.ExceptionHandler.isException(t))runtimeHideBusyOverlay({forceHide:!0}),hideAllBusyForResult(n.brokerPackages),SFLog({type:5,source:"handleFailRuntimeBehaviourResult",category:"AJAX",message:"Error on AJAX execution",data:t}),_runtimeNotifyControlsAndViewsOfFailure({brokerPackages:n.brokerPackages,returnData:t});else{var e=isWorkflowResultError({packageValues:t,brokerPackages:n.brokerPackages,batchedActions:n.batchedActions});e.isError?(runtimeHideBusyOverlay({forceHide:!0}),f.batchedActions=[e.action],f.errorType="wf"):f.errorType="ajax"}}else f.errorType="noxml";handleResultError(f)}}function closeAuthLoginPopup(n){_runtimePauseAjax=!1;_runtimeRetryAjaxQueue=[];_runtimeContinueAjaxQueue=[];handleResultError(n)}function continueHandleRuntimeBehaviourResult(n){if(_runtimePauseAjax)_runtimeContinueAjaxQueue.push(n);else{SFLog({type:3,source:"continueHandleRuntimeBehaviourResult",category:"AJAX",message:"AJAX execution complete",data:n.data});var e=n.data.c,t=e.length;n.hasViewID===!1&&runtimeHideBusyOverlay();var c=!0,o=[];if(t>0){for(var q={};t--;){var r,a,s=null,u=null,f="";if(checkExists(n.brokerPackages)&&t<n.brokerPackages.length&&(r=n.brokerPackages[t],a=n.brokerPackagesJson[t]),checkExists(n.batchedActions)&&t<n.batchedActions.length&&(u=n.batchedActions[t],s=getLoopContextID(u)),checkExists(r)&&checkExistsNotEmpty(r.method)&&(f=r.method.toUpperCase()),f==="STARTPROCESS"||f==="ACTIONPROCESS"){if(q=continueHandleWorkflowResult(e[t],n.behaviour,u,n.deferred),typeof _runtimeScriptsLoaded=="undefined")return;c&&!q.shouldExecuteBehaviour&&(c=!1);n.behaviour=q.behaviour;checkExists(q.postBatchFunction)&&o.push([q.postBatchFunction,q.functionThis,q.functionParameters]);f==="ACTIONPROCESS"&&checkExists(n.brokerPackagesJson)&&checkExists(n.brokerPackagesJson[t])&&checkExists(n.brokerPackagesJson[t].Process)&&checkExists(n.brokerPackagesJson[t].Process.ProcessInstance)&&SourceCode.Forms.Runtime.MobileBridge.sendToMobileDevice({methodName:"taskActioned",serialNumber:n.brokerPackagesJson[t].Process.ProcessInstance.SerialNumber,actionName:n.brokerPackagesJson[t].Process.ProcessInstance.ActionName})}else if(f==="LOADPROCESS")n.behaviour=continueHandleProcessInformationResult(e[t],u,n.behaviour,n.deferred);else{var v=window.self;checkExists(n.behaviour)&&(v=getWindowToUse(u,n.behaviour));v.PopulateView(e[t],null,null,s,r,a)}}if(collectionTables.length>0){checkExists(n.behaviour)&&(n.behaviour.hasSingleExecution=!1);var s=null;checkExists(n.batchedActions)&&n.batchedActions.length===1&&(s=getLoopContextID(n.batchedActions[0]));buildCollectionTables(s)}}else hideAllBusyForResult(n.brokerPackages);if(o.length>0)for(var h=[];o.length>0;)h=o.shift(),h[0].apply(h[1],h[2]);if(checkExists(n.batchedActions))for(var l=0;l<n.batchedActions.length;l++)removeLoopContextData({loopContextID:getLoopContextID(n.batchedActions[l])});checkExists(n.behaviour)&&n.runAsync!==!1?(n.behaviour.isExecuting=!1,c&&n.behaviour.executeBehaviour()):checkExists(n.deferred)&&n.deferred.resolve(n.data)}}function hideAllBusyForResult(n){for(var r=n.length,q=new SFRuntimeHash;r--;){var t=n[r],u=[t.viewID,t.instanceID];q.get(u)||(runtimeBusyView(t.viewID,!1,!1,t.instanceID),q.add(u,!0))}q=null}function sendPacket(n,t,q,r){for(var c=[],o=!1,s=!1,l=n.length;l--;){var a=n[l],u=a.smartobject,f=a.metadata,e={controlID:f.idofcontrol,instanceID:f.instanceid};checkExists(u)&&(e.resultMappings=u.results);var h=checkExists(u)?u.method.name:f.method;checkExists(h)&&(e.method=h,s||h.toUpperCase()!=="ACTIONPROCESS"||(s=!0));var v=f.id;checkExists(v)&&(e.viewID=v,o=!0);c.unshift(e)}o||runtimeShowBusyOverlay({showSpinner:!0});var y={brokerPackages:c,behaviour:t,hasViewID:o,modalizeWorkflowView:s,brokerPackagesJson:n,batchedActions:q,runAsync:r};return ajaxCall.executeRuntimeBehaviour(y)}function continueHandleWorkflowResult(n,t,q){var r={behaviour:t,shouldExecuteBehaviour:!0},e=getLoopContextID(q);SFLog({type:3,source:"continueHandleWorkflowResult",category:"AJAX",message:"AJAX execution complete",data:n});jQuery("*[id$=_6f1d43bf-a7fe-21ed-36ac-0d3bcb633bfb]").is(":focus")&&jQuery("*[id$=_6f1d43bf-a7fe-21ed-36ac-0d3bcb633bfb]")[0].blur();var p=q.getAttribute("Method"),c=q.getAttribute("ViewID"),l=q.getAttribute("InstanceID");if(p.toLowerCase()==="actionprocess"){r.behaviour=mapWorkflowResults(q,workflowInfo,r.behaviour);var o=q.getAttribute("WFAfterSubmitEventID"),s=q.getAttribute("WFAfterSubmitInstanceID"),a=q.getAttribute("WFMessage"),v=q.getAttribute("WFNavigateURL");if(checkExists(o)){var w=checkExists(s)?"[@InstanceID='"+s+"']":"",b="Events/Event[@DefinitionID='"+o+"']"+w,h=locateEventInfoOnWindow(b),u=null,y=null;if(checkExists(h)&&(u=h.event,y=h.windowToUse),checkExists(u))return y.handleEvent(u.getAttribute("SourceID"),u.getAttribute("SourceType"),$sn(u,"Name").text,null,s,null,null,o,null,null,null,e),r.shouldExecuteBehaviour=!1,r}else{if(checkExists(v))return r.shouldExecuteBehaviour=!1,r.postBatchFunction=framePosting,r.functionThis=this,r.functionParameters=["_self",v,""],r;if(checkExists(a)){var k={message:a};popupManager.showNotification(k)}}executeWorkflowActionedEvent(e,c,l)}else{var f;checkExists(n)&&checkExists(n.collection)&&n.collection.length>0&&(f=n.collection[0]);checkExists(f)&&(setWorkflowInformation(f),r.behaviour=mapWorkflowResults(q,f,r.behaviour));checkExists(r.behaviour)&&checkExists(SourceCode.Forms.Settings.Compatibility)&&checkExists(SourceCode.Forms.Settings.Compatibility.WorflowActionedGlobalEvent)&&SourceCode.Forms.Settings.Compatibility.WorflowActionedGlobalEvent&&executeWorkflowActionedEvent(e,c,l)}return r}function locateEventInfoOnWindow(n){var r=window.self,t=$sn(formBindingXml,n);if(!checkExists(t)&&(checkExists(runtimeNavigatedEvents)&&(t=$sn(runtimeNavigatedEvents,n)),!checkExists(t))){var o=parseInt(__runtimeFormLevel,10);if(o>0){var e=SourceCode.Forms.Runtime.getMasterRuntimeWindow();if(t=$sn(e.formBindingXml,n),checkExists(t))r=e;else{var u=SourceCode.Forms.Runtime.getAllPopupsWithRuntimeInstances();if(u.length>0){for(var f=u.length,q=r;f>0&&!checkExists(t);)q=getPopupWindowOnLevel(r,f-1,u,!0),checkExists(q)&&(checkExists(q.formBindingXml)&&(t=$sn(q.formBindingXml,n)),checkExists(q.runtimeNavigatedEvents)&&!checkExists(t)&&(t=$sn(q.runtimeNavigatedEvents,n))),f--;checkExists(t)&&(r=q)}}}}return{windowToUse:r,event:t}}function executeWorkflowActionedEvent(n,t,q){var r=!1;if(_runtimeCallerType==="Form"){if(checkExists(q)&&!checkExists(t)){var u=getViewDefinition(null,q);checkExists(u)&&(t=u.getAttribute("ID"))}checkExists(t)&&(r=verifyEventHandling(t,"View","WorkflowActioned",q,!1))}r?handleEvent(t,"View","WorkflowActioned",!1,q,null,null,null,null,null,null,n):handleEvent(currentForm,_runtimeCallerType,"WorkflowActioned",!1,null,null,null,null,null,null,null,n)}function setWorkflowInformation(n){if(checkExists(workflowInfo)||(workflowInfo=[]),checkExists(n)){for(var q=n.ProcessInstance,r=q.SerialNumber,t=workflowInfo.length;t--;)if(workflowInfo[t].ProcessInstance.SerialNumber===r){workflowInfo.splice(t,1);break}workflowInfo.push(n)}}function continueHandleProcessInformationResult(n,t,q){var u=getLoopContextID(t);SFLog({type:3,source:"continueHandleProcessInformationResult",category:"AJAX",message:"AJAX execution complete",data:n});var r=n.collection[0];return setWorkflowInformation(r),applyWorkflowViewInformation(t,r,u),mapWorkflowResults(t,r,q)}function applyWorkflowViewInformation(n,t,q){var r={},s=n.getAttribute("WorkflowStripLocation");r.workflowStrip=s;var h=jQuery("*[id$=_9afc3bff-abee-4066-93d6-c217cdf765f5]"),a=n.getAttribute("InstanceID");if(h.length>0){positionAndShowWorkflowStrip(s);h.modalize(!1);var v=getCurrentWorkflowInformationDetails(t,"WorkflowProcessProperty","SerialNumber",null,null,q),c=jQuery("*[id$=_6f1d43bf-a7fe-21ed-36ac-0d3bcb633bfb]");if(c.length>0){var y=n.getAttribute("WFAfterSubmitEventID"),p=n.getAttribute("WFMessage"),w=n.getAttribute("WFNavigateURL");r.serialNumber=v;r.actionInstanceID=a;r.WFAfterSubmitEventID=y;r.WFMessage=p;r.WFNavigateURL=w;c.off("click").on("click",doWorkflowSubmit)}var f=[],e={index:0,text:"",value:"",className:"",selected:!0,disabled:""};f.push(e);var o=t.Actions;if(checkExists(o))for(var u=0;u<o.length;u++){var l=o[u].Name;e={index:u+1,text:l,value:l,className:"",selected:!1,disabled:""};f.push(e)}r.actionItems=f;r.folio=getCurrentWorkflowInformationDetails(t,"WorkflowProcessProperty","Folio",null,null,q);r.activity=getCurrentWorkflowInformationDetails(t,"WorkflowActivityProperty","DisplayName",null,null,q);checkExistsNotEmpty(r.activity)||(r.activity=getCurrentWorkflowInformationDetails(t,"WorkflowActivityProperty","Name",null,null,q));r.instruction=getCurrentWorkflowInformationDetails(t,"WorkflowEventProperty","Instruction",null,null,q);checkExistsNotEmpty(r.instruction)||(r.instruction=getCurrentWorkflowInformationDetails(t,"WorkflowActivityProperty","Description",null,null,q));populateWorkflowStrip(r);jQuery("#WorkflowStrip").not(".drop-menu").data("WFInformation",r)}}function populateWorkflowStrip(n){if(Array.isArray(n.actionItems)){var r=jQuery("*[id$=_936c1d65-be60-8c5c-0de9-1db2018d94c0_DropDown]");if(r.length>0){r.dropdown().dropdown("prepareForRefresh");r.off("change").on("change",null,function(){updateCalculatedControls(null,null,"SystemVariable","currentworkflowactionname")});r.dropdown("option","items",n.actionItems);r.dropdown("refresh")}}var q=jQuery("*[id$=3100a332-25fc-7771-94fb-40f52ad4c3eb]").attr("id"),t=new PopulateObject(null,!0,q,"isreadonly");SourceCode.Forms.Controls.Web.TextBox.setProperty(t);n.folio&&(t=new PopulateObject(null,n.folio,q),SourceCode.Forms.Controls.Web.TextBox.setValue(t));q=jQuery("*[id$=_67c81e3b-3c56-738c-e998-43ed91aaa2ec]").attr("id");t=new PopulateObject(null,!0,q,"isreadonly");SourceCode.Forms.Controls.Web.TextBox.setProperty(t);n.activity&&(t=new PopulateObject(null,n.activity,q),SourceCode.Forms.Controls.Web.TextBox.setValue(t));q=jQuery("*[id*=_6cf482ae-fc16-5b47-1992-48906344bf8b]").attr("id").replace("_TextArea","");t=new PopulateObject(null,!0,q,"isreadonly");UtilitiesBehaviour.setControlPropertyOrStyle(t);checkExists(n.instruction)&&(t=new PopulateObject(null,n.instruction,q),UtilitiesBehaviour.setSimpleValue(t))}function positionAndShowWorkflowStrip(n){if(checkExists(n)){var t=jQuery("#WorkflowStrip").not(".drop-menu"),r=jQuery(".runtime-form.theme-entry"),q=jQuery(".runtime-content").css("margin-top");if(t.find(".dropdown-box").addClass("workflow-entry"),r.length>0)if(n.toLowerCase()==="bottom"){t.insertAfter(r).css("display","");var u=jQuery(".theme-entry .tabs-top.tab-box .tab-box-body");u.length>0&&(q=parseInt(q,10)+parseInt(u.css("top"),10)+"px",r[0].style.marginBottom=q);t[0].style.marginTop=q;t[0].style.marginBottom="0px"}else n.toLowerCase()==="top"&&(t.insertBefore(r).css("display",""),t[0].style.marginBottom=q,t[0].style.marginTop="0px");else n.toLowerCase()==="bottom"?(t.next()&&t.insertAfter(t.next()),t.css({display:"","margin-top":"5px","margin-bottom":"0px"})):n.toLowerCase()==="top"&&(t.prev()&&t.insertBefore(t.prev()),t.css({display:"","margin-bottom":"5px","margin-top":"0px"}))}}function mapWorkflowResults(n,t,q){for(var a=getLoopContextID(n),v=$mn(n,"Results/Result"),s=0;s<v.length;s++){var r=v[s],e=r.getAttribute("TargetSubFormID");checkExistsNotEmptyGuid(e)?r=populateSubformContext(r,e):e=r.getAttribute("TargetTransferredID");var h=r.getAttribute("TargetInstanceID"),p=r.getAttribute("TargetRuntimeContextID"),w=r.getAttribute("TargetType"),f=r.getAttribute("TargetID"),o=r.getAttribute("SourceType"),c=r.getAttribute("SourceID"),u=null;if(o==="Result"?c.toLowerCase()==="getworkflowactions"&&(u=getWorkflowActionCollection(t)):u=getCurrentWorkflowInformation(t,r,a),checkExists(u))switch(w){case"Control":if(o==="Result")c.toLowerCase()==="getworkflowactions"&&populateListControlWithWorkflowProcessActions(f,u);else{var b={controlID:f,instanceID:h,transferredID:e,runtimeContextID:p,isDestination:!0},l=findCorrectInstanceForDataTransfer(b);if(checkExists(l)){var y=l.result;if(checkExists(y)){windowToUse=l.WindowToUse;var k=new PopulateObject(null,u,f);windowToUse.executeControlFunction(y,"SetValue",k)}}}break;case"ViewField":setHiddenFieldValue(f,u,null,h,null,null,null,a);break;case"ViewSource":o==="ProcessItemReference"&&(q=transformItemReferenceForExecution(f,h,u,q));break;default:updateTargetWithValue(n,q,r,window.self,c,o,u,q.methodExecuted)}}return q}function populateListControlWithWorkflowProcessActions(n,t){var q=_runtimeControllerFindObject({controlID:n,propertySearch:"SetItems"});if(checkExists(q)){var u=new PopulateObject(null,null,n,null,null,t);executeControlFunction(q,"SetItems",u);var r={viewId:null,instanceId:null,controlId:n,value:t};checkExists(q.parentNode)&&checkExists(q.parentNode.parentNode)&&(r.viewId=q.parentNode.parentNode.getAttribute("ID"),r.instanceId=q.parentNode.parentNode.getAttribute("InstanceID"));SourceCode.Forms.Runtime.Information.setControlWorkflowHistory(r)}}function transformItemReferenceForExecution(n,t,q,r){var v=getViewDefinition(null,t,n);if(checkExists(v)){var y=v.getAttribute("ID"),p=$sn(v,"Fields/Field[@DataSourceID='"+n+"']"),w=p.getAttribute("ObjectID"),et=p.getAttribute("ContextID"),ot=p.getAttribute("ContextType");if(checkExists(q)){var h=$sn(q,"settings/method/methodName");if(checkExists(h)){h=h.text;var u=$xml("<Action><Parameters/><\/Action>"),f=$sn(u,"Action");f.setAttribute("ViewID",y);checkExists(t)&&f.setAttribute("InstanceID",t);f.setAttribute("Method",h);f.setAttribute("ObjectID",w);f.setAttribute("Type","Execute");f.setAttribute("ExecutionType","Synchronous");var st=$sn(f,"Parameters"),b=$mn(q,"items/item"),k=b.length,d=!1,g,nt;k>1&&(d=!0,g=u.createElement("Filter"),f.appendChild(g),nt=u.createElement("Filter"),g.appendChild(nt));for(var l=nt,a=l,c=0;c<k;c++){var ht=$mn(b[c],"properties/property"),e=ht.length;if(d){if(c<k-1){var ct=u.createElement("Or");a.appendChild(ct);a=ct}if(e>1){var lt=u.createElement("And");a.appendChild(lt);l=lt}else l=a}while(e--){var at=ht[e],tt=at.getAttribute("name"),qt=at.text;if(d){var rt=u.createElement("Equals");l.appendChild(rt);var ut=u.createElement("Item");ut.setAttribute("SourceType","ObjectProperty");ut.setAttribute("SourceID",tt);rt.appendChild(ut);var ft=u.createElement("Item");ft.setAttribute("SourceType","Value");var yt=u.createElement("SourceValue");ft.appendChild(yt);yt.appendChild(u.createTextNode(qt));rt.appendChild(ft)}else{setHiddenJSONValue(w,"Object",y,null,null,null,null,null,et,ot,null,tt,"ObjectProperty",qt,!1,t);var o=u.createElement("Parameter");o.setAttribute("SourceID","Value");o.setAttribute("SourceType","Value");o.setAttribute("TargetID",tt);o.setAttribute("TargetType","ObjectProperty");var vt=u.createElement("SourceValue"),gt=u.createCDATASection(qt);vt.appendChild(gt);o.appendChild(vt);st.appendChild(o)}}var pt=$mn(b[c],"parameters/parameter");for(e=pt.length;e--;){var wt=pt[e],bt=wt.getAttribute("name"),kt=wt.text;setHiddenJSONValue(w,"Object",y,null,null,null,h,et,ot,null,bt,"MethodParameter",kt);var s=u.createElement("Parameter");s.setAttribute("SourceID","Value");s.setAttribute("SourceType","Value");s.setAttribute("TargetID",bt);s.setAttribute("TargetType","MethodParameter");var dt=u.createElement("SourceValue"),nq=u.createCDATASection(kt);dt.appendChild(nq);s.appendChild(dt);st.appendChild(s)}}if(!checkExists(r)){var tq=SourceCode.Forms.Runtime.getMasterRuntimeWindow();r=new tq.SourceCode.Forms.Runtime.BehaviourEvent({handlers:[],SourceID:currentForm,methodExecuted:"ItemRef",SourceType:_runtimeCallerType,InstanceID:t})}r.actions.unshift(f)}}}return r}AjaxCall.prototype.sendEmailBehaviour=function(n,t,q){SFLog({type:1,source:"sendEmailBehaviour",category:"AJAX",message:"Sending email",data:n});var r=null;checkExists(q)||(r=$.Deferred());var u=SourceCode.Forms.Runtime.getMasterRuntimeWindow();u.updateExecutionTracker(1);var f;return f=_runtimeNativeAjax?_runtimeAjaxCall("POST",this.ajaxUrlValue,{},{method:"sendmail",mailmessage:encodeURIComponent(n)}):jQuery.ajax({url:this.ajaxUrlValue,dataType:"xml",type:"POST",global:!1,data:{method:"sendmail",mailmessage:encodeURIComponent(n)}}),f.done(function(n){typeof _runtimeScriptsLoaded!="undefined"&&handleMailingResult(n,t,q,r)}).fail(function(u,f,e){if(typeof _runtimeScriptsLoaded!="undefined"){_runtimeNativeAjax||(u=u.responseXML);var o={message:n,currentAction:t,behaviour:q,deferred:r};u==null&&(u=parseXML('<Exception Title="'+Resources.MessageBox.Error+'"><Message Name="Message">'+Resources.Runtime.AjaxNetworkError+"<\/Message><\/Exception>"),f="503");handleFailMailingResult(o,u,f,e)}}).always(function(){this.updateExecutionTracker(-1)}.bind(u)),r?r.promise():void 0};function handleMailingResult(n,t,q,r){SFLog({type:1,source:"handleMailingResult",category:"AJAX",message:"AJAX execution complete",data:n});removeLoopContextData({loopContextID:getLoopContextID(t)});setTimeout(function(){checkExists(q)&&(q.isExecuting=!1,q.executeBehaviour())},0);r&&r.resolve(n)}function handleFailMailingResult(n,t,q,r){var u={batchedActions:[n.currentAction],behaviour:n.behaviour,deferred:n.deferred,errorType:"ajax",data:t,status:q,error:r};SourceCode.Forms.ExceptionHandler.isAuthenticationException(t)?u.errorType="auth":SourceCode.Forms.ExceptionHandler.isException(t)?(SFLog({type:5,source:"handleMailingResult",category:"AJAX",message:"Error on AJAX execution",data:t}),u.errorType="exc"):t.xml.toLowerCase().trim()!=="<true>value<\/true>"&&(SFLog({type:5,source:"handleMailingResult",category:"AJAX",message:Resources.RuntimeMessages.ErrorEmailNotSent,data:n.currentAction}),u.errorType="email");handleResultError(u)}AjaxCall.prototype.getEnvironmentFieldValue=function(n){var t=null;SFLog({type:1,source:"getEnvironmentFieldValue",category:"AJAX",message:"Getting environment field's value from server",data:"Field Id: {0}".format(n)});var q=SourceCode.Forms.Runtime.getMasterRuntimeWindow();return q.updateExecutionTracker(1),jQuery.ajax({data:{method:"getEnvironmentFieldValue",FieldId:n},global:!1,async:!1,dataType:"text",url:this.ajaxUrlValue,type:"POST"}).done(function(n){typeof _runtimeScriptsLoaded!="undefined"&&(t=n)}).always(function(){this.updateExecutionTracker(-1)}.bind(q)),t};
/*!
 ~/RunTime/Script/Populate.js
*/
var newLineRegEx=/(\r\n|\r|\n)/g;function PopulateView(n,t,q,r,u,f){var h=n.metadata,c=h.rowcounter,ht=h.methodexecuted,y=h.idofcontrol,w=h.pagesize,l=h.pagenumber,b=h.compositeresult,ct=h.fieldbehaviorignoreresults,rt=checkExistsNotEmpty(l);checkExists(t)||(t=h.id);checkExists(q)||(q=h.instanceid,q===""&&(q=null));var p=null,k=null;if(checkExists(t)&&t.length>0){var a=getViewDefinition(t,q);if(checkExists(a)){q=a.getAttribute("InstanceID");p=a.getAttribute("MainTable");var o=document.getElementById(p),ut=jQuery(o),wt=getExportToExcelData({viewId:t,instanceId:q});if(wt.busyExporting===!0){var bt={jsonObj:n,viewId:t,instanceId:q,viewDef:a,tableElem:o,pageNumber:h.pagenumber},kt=getTableRowsForExportToExcel(bt),dt={viewHtml:ut,viewXml:a,rowsGridObjs:kt,viewId:t,instanceId:q,loopContextId:r};exportListToExcel(dt)}else{k=a.getAttribute("TypeView");var ft=a.getAttribute("ContextID"),g=null,nt=!1;k!=="List"||checkExists(y)||(g=getLoopContextData({loopContextID:r,viewID:t,instanceID:q}).counter,checkExists(g)||(g=getViewSelectedCounter(p)),checkExists(c)&&(g=c),nt=!0,o.getAttribute("editable")==="true"&&cancelItemChanges(ut,null,r));var e=null,v=null,lt=null,st=null,s=n.collection.slice(0);if(checkExists(s)&&s.length>0){var tt=s[0];checkExists(tt)&&(e=tt.parentid,v=tt.parenttype,lt=tt.contextid,st=tt.contexttype)}var d=n.MethodTypeExecuted,at=!0;if(checkExists(d)){switch(d){case"ToXmlList()":if(nt&&!checkExists(y)){var et=o.getAttribute("previousactionxml");n.PreviousActionID==null||checkExistsNotEmpty(et)||(et=GetPreviousActionXml(n));checkExistsNotEmpty(et)&&o.setAttribute("actionxml",et);var ot=n.RecordsAffected,vt=n.HasMorePages,yt=n.HasRowCount,gt=rt?!0:null;if(removeHiddenPropertyCollection(t,e,v,gt,!1,null,null,q),checkExists(ot)){if(ot=parseInt(ot,10),ot===0){var pt=document.getElementById(p+"_footer_aggrRow");pt&&(pt.style.display="none");runtimeBusyView(t,!1,!1,q);checkExists(w)&&rt&&parseInt(l,10)>1?doPaging("previous",l,ut,!1,r):(clearTable(p,t,q,!0,null,null,r),checkExists(w)&&populatePagingControls(o,w,1,1,!1,yt));handleEvent(t,"View",ht,null,q,null,null,null,null,null,null,r);o.getAttribute("listrefreshed")&&(o.removeAttribute("listrefreshed"),handleEvent(t,"View","ListRefresh",null,q,null,null,null,null,null,null,r));return}if(checkExists(w)&&rt){var qt=n.NumberOfPages;checkExists(qt)?qt=parseInt(qt,10):vt==="false"&&(qt=l);var nq=n.ResetPageNumber;populatePagingControls(o,w,l,qt,vt,yt,nq)}}}break;case"read":removeHiddenPropertyCollection(t,e,v,null,!1,!1,st,q);break;case"create":case"update":if(k==="Capture"&&checkExists(c)&&checkExists(b)&&b.length>0)removeHiddenPropertyCollection(t,e,v,null,b,!0,null,q);else if(k==="List"&&checkExists(e)&&checkExists(ft)&&e.toLowerCase()!==ft.toLowerCase()){checkExists(t)&&t.length>0&&runtimeBusyView(t,!1,!1,q);return}break;case"delete":if(at=!1,k==="List"){if(checkExists(e)&&checkExists(ft)&&e.toLowerCase()!==ft.toLowerCase()){checkExists(t)&&t.length>0&&runtimeBusyView(t,!1,!1,q);return}checkExists(w)&&rt?(removeHiddenPropertyCollection(t,null,null,null,!1,null,null,q),doPaging(l,l,ut,null,r)):(removeHiddenPropertyCollection(t,e,v,null,!1,g,null,q),n=null,checkExists(c)||(n=getCombinedHiddenPropertyCollection(t,null,null,null,null,null,null,null,null,q)))}else k==="Capture"&&(checkExists(c)?checkExists(b)&&b.length>0&&removeHiddenPropertyCollection(t,e,v,null,b,!0,null,q):(removeHiddenPropertyCollection(t,e,v,null,!1,c,null,q),clearViewControls(t,a,!1,q,null,null,!0),n=getCombinedHiddenPropertyCollection(t,null,null,null,null,null,null,null,null,q)))}checkExists(y)?checkExists(ct)&&ct==="true"||(removeHiddenPropertyCollection(t,e,v,null,y,null,st,q,lt),setHiddenPropertyCollection(t,s,y,null,null,q)):nt&&d==="ToXmlList()"?setHiddenPropertyCollection(t,s,null,null,null,q):!nt&&d!=="ToXmlList()"&&(d!=="delete"||checkExists(c))&&setHiddenPropertyCollection(t,s,null,null,null,q)}if(checkExists(n)&&checkExists(n.collection))if(s=n.collection.slice(0),nt&&!checkExists(y))checkExists(c)?(checkExists(n)&&setHiddenPropertyCollection(t,s,null,null,null,q),collectionTables.push(p)):rebuildTable(p,t,q,!1,!1,null,s,!0,l,r,at);else if(!checkExists(u)||checkExists(u.resultMappings)||d!=="ToXmlList()"||!checkExists(u.controlID)){(checkExists(s)&&s.length>0||checkExists(y))&&PopulateBoundControls(n,n,q,t,r,f);var tq=checkExists(u)&&checkExistsNotEmpty(u.controlID);tq||updateCalculatedControlsForSource(q,!1,r)}checkExists(t)&&t.length>0&&runtimeBusyView(t,!1,!1,q);loadPersistedViewParametersForUser();handleEvent(t,"View",ht,null,q,null,null,null,null,null,null,r);o.getAttribute("listrefreshed")&&(o.removeAttribute("listrefreshed"),handleEvent(t,"View","ListRefresh",null,q,null,null,null,null,null,null,r))}}}else mapExecutionResultsToControls(n,r)}function getTableRowsForExportToExcel(n){var e=[];if(n=checkExists(n)?n:{},checkExistsNotEmpty(n.viewId)&&checkExists(n.viewDef)){var t=n.jsonObj.collection.slice(0);if(checkExistsNotEmpty(n.jsonObj.MethodTypeExecuted)&&(n.tableElem.setAttribute("actionxml",n.tableElem.getAttribute("previousactionxml")),removeHiddenPropertyCollection(n.viewId,null,null,null,null,null,null,n.instanceID),setHiddenPropertyCollection(n.viewId,t,null,null,null,n.instanceId)),checkExists(n.jsonObj)&&checkExists(n.jsonObj.collection)){t=n.jsonObj.collection.slice(0);var o=n.viewDef.getAttribute("MainTable");clearDisplayValueCache(o);var q=jQuery("#"+o);if(checkExists(q)&&q.length>0){var h={controlid:!1,method:!1,contexttype:"Primary",pagenumber:n.pageNumber,ignoreState:!0},r=t.filter(__runtimeJsonFilterMatchingItems,h);if(r.length>0)for(var c=viewTableDefinitions[q[0].id],u=0;u<r.length;u++){var f=r[u],l=f.counter,s=f.state;if(!checkExistsNotEmpty(s)||s.toLowerCase()!=="removed"){var a=populateTableRowFromDefinition(c,l,n.instanceId,f);e.push(a)}}}}removeHiddenPropertyCollection(n.viewId,null,null,null,null,null,null,n.instanceID);removeExportToExcelData({viewId:n.viewId,instanceId:n.instanceId});checkExistsNotEmpty(n.viewId)&&runtimeBusyView(n.viewId,!1,!1,n.instanceId)}return e}function buildCollectionTables(n){for(collectionTables=collectionTables.filter(function(n,t){return collectionTables.indexOf(n)===t});collectionTables.length>0;){var t=collectionTables.pop(),r=new getMainTableViewInformation(t),u=r.viewID,f=r.instanceID,o=getCombinedHiddenPropertyCollection(u,null,null,null,!1,!0,null,null,null,f);removeSortingIndicators(t);rebuildTable(t,u,f,!1,!1,null,o,!0,null,n,!1);var q=$("#"+t),e=q[0].getAttribute("singleEdit");if(checkExists(e)){switch(e){case"add":addListItemRow(q,"override",n);break;case"edit":editListItemRow(q,n,"override")}q[0].removeAttribute("singleEdit")}}}function PopulateBoundControls(n,t,q,r,u,f){if(checkExists(n)){var l=t.metadata,e=l.idofcontrol,a=l.actualvalue;if(checkExists(e)){n=t;var h=_runtimeControllerFindObject({controlID:e});if(h){var o=!1,c=new PopulateObject(null,null,e,null,null,n);if(o=executeControlFunction(h,"SetItems",c),checkExists(f)){var b={viewId:r,instanceId:q,controlId:e,value:f};SourceCode.Forms.Runtime.Information.setControlBrokerHistory(b)}checkExists(o)&&o===!1&&startClearingDependantValues(e,n);checkExists(a)&&(c=new PopulateObject(null,a,e,null,!0,n),o=executeControlFunction(h,"SetValue",c))}}else{var k=mapExecutionResultsToControls(t,u);if(checkExists(r)&&r.length>0){var s=returnCurrentViewXML(r,q);if(!k)for(var v=$mn(s,"Controls/Control[(@FieldID)][not(Properties/Property[Name/text()='IsComposite'])]"),y=v.length;y--;){var d=v[y].getAttribute("ID");populateControl(d,r,s,null,n,null,q,!1,u)}for(var p=new dataSourceLookup({xmlDoc:s,includeControllers:!1,includeController:!1,selectMultiple:!0,sourceControlID:!0,isComposite:"True"}).getDataSource(),w=p.length;w--;){var g=p[w].getAttribute("SourceControlID");populateControl(g,r,s,null,n,null,q,!0,u)}}}}}function mapExecutionResultsToControls(n,t){var f=n.results;if(!checkExists(f))return!1;var s=f.length;if(s>0){for(var e=0;e<s;e++){var q=f[e],l=q.TargetType,u=q.TargetID,h=q.TargetInstanceID,a=q.SourceType,r=checkExistsNotEmpty(q.Value)?q.Value:"";if(a==="Value"&&checkExistsNotEmpty(r)&&r.startsWith("<SourceValue")){var v=$xml("<Item>"+r+"<\/Item>"),c=v.documentElement;for(var o in q)o!=="Value"&&c.setAttribute(o,q[o]);r=returnSourceValue({item:c,loopContextID:t})}switch(l){case"Control":populateControl(u,null,null,r,n,null,null,t);break;case"ViewField":setHiddenFieldValue(u,r,null,h,null,null,null,t);break;case"FormParameter":setFormParameterValue(u,r,t);break;case"ViewParameter":setViewParameterValue(u,r,h,t)}}return!0}return!1}function populateControl(n,t,q,r,u,f,e,o,s){var h=_runtimeControllerFindObject({controlID:n,xmlDoc:q,includeControllers:!1});if(checkExists(h)&&!checkExistsNotEmpty(q)){var l=h.parentNode.parentNode;l&&(t=l.getAttribute("ID"),e=l.getAttribute("InstanceID"),q=l)}if(!checkExists(r)&&checkExists(h)){var v=h.getAttribute("FieldID");if(checkExists(o)||(o=$sn(h,"Properties/Property[Name/text()='IsComposite']/Value"),o=o?o.text.toLowerCase()==="true":!1),o&&checkExistsNotEmpty(v)){var p=returnFieldAttributeObject(v,e);p.propertyType.toUpperCase()==="MULTIVALUE"&&(o=!1)}o||(r=getHiddenFieldValue(v,null,null,null,e,s,null))}var c;if(checkExists(r)){var w=new dataSourceLookup({xmlDoc:q,sourceControlID:n,isComposite:!1,includeControllers:!1,includeController:!1}).getDataSource();if(c=new PopulateObject(null,r,n,null,!0,u),w){var a=[];a.push({objInfo:c,currentControl:h});startLoadingDependantValues(n,r,null,e,a,s);for(var b=a.length;b--;)execution=a.pop(),executeControlFunction(execution.currentControl,"SetValue",execution.objInfo)}else executeControlFunction(h,"SetValue",c)}else if(o===!0){var y=u.collection[0].joins;checkExists(y)||(r="");c=new PopulateObject(null,r,n,null,!0,y);executeControlFunction(h,"SetValue",c)}}function clearTable(n,t,q,r,u,f,e){checkExists(u)||(u=!0);checkExists(n.id)&&(n=n.id);var o=jQuery("#"+n);SFRGrid.execute({element:o,fn:"clear",params:[f]});SFRGrid.execute({element:o,fn:"option",params:["canexpand",!1]});SFRGrid.execute({element:o,fn:"option",params:["customsort",null]});o[0].setAttribute("maxcounter",0);r&&setTimeout(function(){buildAggregations(o,t,null,q,e)},0);u===!0&&SFRGrid.execute({element:o,fn:"runtimeSyncColumns"})}function BuildTable(n,t,q,r,u,f){if(checkExists(t)&&checkExists(n)){checkExists(n.id)&&(n=n.id);var e=jQuery("#"+n);if(checkExists(e)&&e.length>0){var l=getMainTableViewInformation(n),h=l.viewID,s=l.instanceID,b=e[0].getAttribute("PageNumber"),k={controlid:!1,method:!1,contexttype:"Primary",pagenumber:b,ignoreState:!0},a=t.filter(__runtimeJsonFilterMatchingItems,k),v=a.length;if(v>0){SFRGrid.execute({element:e,fn:"option",params:["canexpand",!0]});var c=e[0].getAttribute("NumberOfPages"),y=e[0].getAttribute("HasMorePages");checkExists(c)&&c.length>0&&parseInt(c,10)>1||checkExists(y)&&y==="true"?SFRGrid.execute({element:e,fn:"option",params:["customsort",gridCustomSorting]}):SFRGrid.execute({element:e,fn:"option",params:["customsort",null]});var o=viewTableDefinitions[e[0].id];if(!checkExists(o)||o.length===0){var p,w;checkExists(e[0].getAttribute("QFName"))&&e[0].getAttribute("QFName").length>0&&(p=e[0].getAttribute("QFName"),w=e[0].getAttribute("QFValue"));o=constructTableDefinition(h,e,w,p,s);viewTableDefinitions[e[0].id]=o}buildTableRows(e,v,o,s,r,a,f)}else q&&runtimeBusyView(h,!1,!1,s);setTimeout(function(){buildAggregations(e,h,q,s,u)},0)}}}function buildTableRows(n,t,q,r,u,f,e){for(var o=0,s=0,l=[];s<t;){var h=f[s],a=h.counter,v=parseInt(a,10);v>o&&(o=v);var y=h.state;if(!checkExists(y)||y.toLowerCase()!=="removed"){var w=populateTableRowFromDefinition(q,a,r,h);l.push(w)}++s}viewTableDefinitions[n[0].id]=q;SFRGrid.execute({element:n,fn:"add",params:["rows",l]});var c=n.find("a.fileImage, img.fileImage");c.on("click",openFileImage);c.on("focus",function(){$(this).addClass("focus")});c.on("blur",function(){$(this).removeClass("focus")});n[0].setAttribute("maxcounter",o);SFRGrid.execute({element:n,fn:"zebra"});var p=n[0].getAttribute("PageNumber"),b=n[0].getAttribute("numberofpages");if(checkExists(u)&&u===!0&&(!checkExists(p)||parseInt(p,10)===1&&parseInt(b,10)===1)&&SFRGrid.execute({element:n,fn:"sort"}),checkExists(e)&&e==!0){n.grid("deselect");var k=n.find("tr.highlighted");k.each(function(){$(this).removeClass("highlighted")})}SourceCode.Forms.Layout.checkAndFixView(n);window.setTimeout(function(){SFRGrid.execute({element:n,fn:"runtimeSyncColumns"})},5)}function buildAggregations(n,t,q,r,u){updateControlsUsingSummaries(r,u);SFRGrid.execute({element:n,fn:"option",params:["canexpand",!0]});q&&runtimeBusyView(t,!1,!1,r)}function openFileImage(n){var t=n.target?n.target:n.srcElement,f=t.tagName;switch(f.toUpperCase()){case"A":case"IMG":var q=t.getAttribute("controlID"),r=t.getAttribute("relativePath"),u=t.getAttribute("counter"),e=t.getAttribute("fileRequestData");checkExists(q)&&(checkExists(r)?openFile(r,"path",null,null,null,u,e):openFile(q,"control",null,null,null,u))}}function listRowClick(n,t){this.clickManager=this.clickManager||new ClickManager;this.clickManager.click(n,t,function(n){var t=n.parents(".grid");if(t.attr("isdisabled")!=="true"){var q=new getMainTableViewInformation(t[0].id),r=q.viewID,u=q.instanceID;t[0].getAttribute("editable")==="true"&&(t[0].removeAttribute("singleEdit"),attemptItemChanges(t,r,u));handleEvent(r,"View","ListClick",null,u)}})}function listRowDblClick(n,t){this.clickManager=this.clickManager||new ClickManager;this.clickManager.dblClick(n,t,function(n){var t=n.parents(".grid");if(t.attr("isdisabled")!=="true"){var q=new getMainTableViewInformation(t[0].id),r=q.viewID,u=q.instanceID;t[0].getAttribute("editable")==="true"&&(t[0].removeAttribute("singleEdit"),attemptItemChanges(t,r,u));handleEvent(r,"View","ListDoubleClick",null,u)}})}var constructTableDefinition=function(n,t,q,r,u){var g=checkExists(u)?"[@InstanceID='"+u+"']":"";if(g.length>0){var gt=$sn(viewControllerDefinition,"Controllers/Controller[@ID='"+n+"']"+g);checkExists(gt)||(SFLog({type:1,source:"constructTableDefinition",category:"Populate",message:"Instance [{0}] for view [{1}] did not match",parameters:[u,n]}),u=null,g="")}for(var ft=[],p=returnCurrentViewXML(n,u),et=SFRGrid.execute({element:t,fn:"fetch",params:["display-template-row"]}),ot=checkExists(et)?et.find("td .grid-content-cell-wrapper"):[],st=SFRGrid.execute({element:t,fn:"fetch",params:["columns"]}),nt=ot.length;nt--;){var ht=ot[nt].children[0],f=null;if(checkExists(ht)){var c=ht.getAttribute("ID");if(checkExists(c)&&c.length>0){c=getActualControlID(c);var s=$sn(p,"Controls/Control[@ID='"+c+"']");if(checkExists(s)){if(checkExists(s.getAttribute("ExpressionID"))){f={};f.isExpression=!0;f.controlNode=s;f.controlID=c;f.fieldID=s.getAttribute("FieldID");f.instanceID=u;var ct=s.getAttribute("DataType");f.fieldPropertyType=checkExists(ct)?ct.toLowerCase():"text"}else if(checkExists(s.getAttribute("FieldID"))){var o=returnFieldAttributeObject(s.getAttribute("FieldID"),u);if(checkExists(o)){f={};f.fieldID=o.fieldID;f.currentColumn=c;f.fieldSOID=o.parentID;f.fieldPropertyName=o.PropertyName;f.valueProperty=null;f.fieldPropertyType=o.propertyType.toLowerCase();f.fieldType=o.fieldType;f.completeName=getQualifiedResultName(o)+"."+o.PropertyName.toLowerCase();var h=new dataSourceLookup({xmlDoc:p,includeControllers:!1,includeController:!1,controllerID:n,sourceControlID:c,originalProperty:f.fieldPropertyName}).getDataSource();if(checkExists(h)){f.isAssociation=!0;f.originalSOID=h.getAttribute("AssociationSO");f.displayTemplate=h.getAttribute("DisplayTemplate");checkExists(f.displayTemplate)&&(f.displayValueCache={});f.displayTemplate.startsWith("<Template>")&&(f.isXmlDisplayTemplate=!0);f.originalPropertyName=h.getAttribute("OriginalProperty");f.valueProperty=h.getAttribute("ValueProperty");var lt=h.getAttribute("ContextID"),at=h.getAttribute("ContextType");f.contextID=lt;f.contextType=at;f.actualDisplayProperty=returnDisplayPropertyFromTemplate(f.displayTemplate);var b=null;h.getAttribute("DisplaySO")?(f.displaySOID=h.getAttribute("DisplaySO"),f.displayMethod=h.getAttribute("DisplayMethod"),f.displayJoinProperty=h.getAttribute("DisplayJoinProperty"),f.associatedJoinProperty=h.getAttribute("AssociatedJoinProperty"),b=$sn(p,"Fields/Field[@ContextID='"+f.contextID+"'][@ContextType='"+f.contextType+"'][@ObjectID='"+f.displaySOID+"'][PropertyName/text()='"+f.actualDisplayProperty+"']")):b=$sn(p,"Fields/Field[@ContextID='"+f.contextID+"'][@ContextType='"+f.contextType+"'][@ObjectID='"+f.originalSOID+"'][PropertyName/text()='"+f.actualDisplayProperty+"'][@ContextType='"+at+"'][@ContextID='"+lt+"']");b&&(o=returnFieldAttributeObject(b.getAttribute("ID"),u),checkExists(o)&&(f.fieldPropertyType=o.propertyType.toLowerCase(),f.fieldType=o.fieldType,f.completeName=getQualifiedResultName(o)+"."+o.PropertyName.toLowerCase()))}q&&(f.completeName.toLowerCase()===r.toLowerCase()||(r.startsWith("[All]")||r.startsWith("[AllDisplay]"))&&r.indexOf(f.completeName.toLowerCase())>0)&&(f.quickSearchValue=q)}}else if(checkExists($sn(s,"Properties/Property[Name/text()='GetDefaultValue']"))){f={};var nq=new PopulateObject(null,null,c),tq=executeControlFunction(s,"GetDefaultValue",nq);f.text=tq;var vt=s.getAttribute("DataType");f.fieldPropertyType=checkExists(vt)?vt.toLowerCase():"text";f.currentColumn=c;f.textNode=null;f.isDefault=!0}if(checkExists(f)){var e={controlID:c,currentControl:s};e.propertyName="IsVisible";f.isVisible=returnControlPropertyValue(e);e.propertyName="IsEnabled";var yt=returnControlPropertyValue(e);e.propertyName="IsParentEnabled";var k=returnControlPropertyValue(e);e.propertyName="WrapText";var pt=returnControlPropertyValue(e);e.propertyName="LiteralVal";var wt=returnControlPropertyValue(e);e.propertyName="ToolTip";var tt=returnControlPropertyValue(e);checkExists(tt)&&tt!==""&&(f.toolTip=tt);e.propertyName="SanitizeHtml";var bt=returnControlPropertyValue(e);f.wrapText=checkExists(pt)&&pt.toString().toLowerCase()==="true";f.literalVal=checkExists(wt)&&wt.toString().toLowerCase()==="true";f.sanitizeHtml=checkExists(bt)&&bt.toString().toLowerCase()==="true";e.propertyName="TextStyle";f.textStyle=returnControlPropertyValue(e);e.propertyName="Width";var l=returnControlPropertyValue(e);checkExists(l)&&(l=l.toString().toLowerCase().trim(),l.length>0&&(l.indexOf("px")<0&&l.indexOf("%")<0&&(l+="px"),l+=";",f.wrapWidth=l));e.propertyName="Target";f.target=returnControlPropertyValue(e);var a=32,v=32;if(f.fieldPropertyType==="image"){e.propertyName="ThumbnailSize";var qq=returnControlPropertyValue(e);switch(qq){case"verysmall":a=16;v=16;break;case"small":a=32;v=32;break;case"medium":a=48;v=48;break;case"large":a=64;v=64;break;case"verylarge":a=128;v=128;break;case"custom":e.propertyName="CustomThumbnailHeight";a=parseInt(returnControlPropertyValue(e),10);e.propertyName="CustomThumbnailWidth";v=parseInt(returnControlPropertyValue(e),10);checkExists(v)&&checkExists(a)||(a=70,v=70)}f.height=a;f.width=v}var y=s.cloneNode(!0),w=$sn(y,"Properties/Styles"),rq=$sn(y,"Properties/ConditionalStyles"),qt=checkExists(st)?st[nt]:null;if(checkExists(qt)&&qt.name.length>0){var kt=qt.name,rt=_runtimeControllerFindObject({xmlDoc:p,includeControllers:!1,controlID:kt,viewID:n,instanceID:u}),ut=$sn(rt,"Properties/Styles[Style[node()]]");if(checkExists(rt)&&checkExists(ut))if(checkExists(w)){var dt=[];dt.push(w.cloneNode(!0));var uq=combineStyles($xml(ut.xml),dt);$sn(y,"Properties").replaceChild($sn(uq,"Styles"),w)}else $sn(y,"Properties").appendChild(ut.cloneNode(!0));var d={controlID:kt,currentControl:rt};d.propertyName="ImageClass";f.icon=returnControlPropertyValue(d);checkExists(k)||(d.propertyName="IsEnabled",k=returnControlPropertyValue(d));checkExists(f.icon)&&f.icon.toLowerCase()==="none"&&(f.icon=null)}w=$sn(y,"Properties/Styles[Style[node()]]");(checkExists(yt)&&yt.toLowerCase()==="false"||checkExists(k)&&k.toLowerCase()==="false")&&(f.isDisabled=!0);(checkExists(w)||checkExists(rq))&&(f.style=y)}}}}ft.push(f)}return ft},populateTableRowFromDefinition=function(n,t,q,r){for(var a=[],v=checkExists(n)?n.length:0;v--;){var f=n[v],s={},y=!1;if(checkExists(f)){var u={},o={currentCounter:t,fieldProperties:f};if(f.isExpression){var k=_runtimeControllerFindObject({controlID:f.controlID});u.text=returnCalculationResultForControl(k,t,q);checkExists(u.text)&&(u.valueText=u.text.toString(),checkExists(f.fieldID)&&setHiddenFieldValue(f.fieldID,u.valueText,t,q,null,null,!0));o.textInfo=u;o.onlyUseValueText=!0;o.textNode=null}else if(f.isDefault)u.text=f.text,o.textInfo=u,o.onlyUseText=!0,o.textNode=f.textNode;else{var d=f.fieldPropertyName,g=f.isAssociation,e=null;if(checkExists(r)&&(e=r.fields[d]),checkExists(e)){var h=f.displayTemplate,nt=f.isXmlDisplayTemplate;if(checkExists(h)){var p=e.value,l=f.displayValueCache[p];if(checkExists(l))e=l.textNode,u.text=l.text;else if(g&&r.joins!=null&&r.joins.length>0){var w=f.originalSOID,b=f.displaySOID;b&&(w=b);var tt={parentid:w,contextid:f.contextID,contexttype:f.contextType},c=r.joins.filter(__runtimeJsonFilterMatchingItems,tt);if(c.length>0){var qt=f.actualDisplayProperty;if(e=c[0].fields[qt],!checkExists(e)){var rt=f.valueProperty;e=c[0].fields[rt]}checkExists(e)&&(checkExists(h)&&nt?u.text=UtilitiesHelper.setDisplayTemplateValueFromJson(h,c[0].fields):(checkExists(h)&&checkExists(c[0].fields[h])&&(e=c[0].fields[h]),u.text=e.value),f.displayValueCache[p]={textNode:e,text:u.text})}}}else u.text=e.value;o.textInfo=u;o.textNode=e}}checkExists(o.textInfo)&&(u=new returnStyledColumTextAccordingToType(o));checkExists(f.literalVal)&&(y=f.literalVal);checkExistsNotEmpty(u.text)||(u.text="",u.valueText="",u.displayText="");checkExists(f.icon)&&checkExistsNotEmpty(u.valueText)&&(u.icon=f.icon);checkExistsNotEmpty(f.fieldPropertyType)&&(u.fieldPropertyType=f.fieldPropertyType);s={html:u.text,value:u.valueText,display:u.displayText,counter:t,isLiteral:y};checkExists(u.icon)&&(s.icon=u.icon);checkExists(u.alignment)&&(s.align=u.alignment.text.toLowerCase());checkExistsNotEmpty(u.fieldPropertyType)&&(s.fieldPropertyType=u.fieldPropertyType)}else s={html:"",value:"",display:"",counter:t};a.push(s)}return a};function applyTableLabelStyleAndFormatting(n,t,q){if(checkExists(n.style)||checkExists(n.isDisabled)){var r=n.applyStylesElement;checkExists(r)||(r=document.createElement("div"),n.styleElementString&&(n.applyStylesElement=r));r.innerHTML=t.text;var u=r.children[0];if(checkExists(u)){if(checkExists(n.style)){checkExists(n.hasConditionalStyles)||(n.hasConditionalStyles=checkExists($sn(n.style,"Properties/ConditionalStyles/ConditionalStyle")),checkExists(n.hasConditionalFormat)||(n.hasConditionalFormat=n.hasConditionalStyles?checkExists($sn(n.style,"Properties/ConditionalStyles/ConditionalStyle/Styles/Style/Format")):!1),checkExists(n.hasConditionalAlign)||(n.hasConditionalAlign=n.hasConditionalStyles?checkExists($sn(n.style,"Properties/ConditionalStyles/ConditionalStyle/Styles/Style/Text/Align")):!1));n.columnStyles=applyConstructedStyle(n.style,q);checkExists(n.columnStyles)&&(n.hasConditionalFormat||n.columnFormatVerified||(n.columnFormat=$sn(n.columnStyles,"Styles/Style/Format"),n.columnFormatVerified=!0),n.hasConditionalAlign||n.columnAlignVerified||(n.columnAlign=$sn(n.columnStyles,"Styles/Style/Text/Align"),n.columnAlignVerified=!0));var f=null;if(f=n.hasConditionalStyles?applyConstructedStyle(n.style,q):n.columnStyles,$chk(f)){var s=n.hasConditionalStyles?f.selectSingleNode("Styles/Style/Format"):n.columnFormat;var e=jQuery(u),l={border:e,background:e,margin:e,padding:e,font:e};if(StyleHelper.setStyles(l,f.xml),checkExists(s)){var h="";checkExists(t.valueText)&&(h=t.valueText);var a={formatXmlString:s.xml,value:h,ignoreDates:!0,doSimpleReplace:!0,dataType:n.fieldPropertyType},v=SCCultureHelper.current.getEditableValue(a),y={formatXmlString:s.xml,elementToStyle:u,value:v,valueIsEditableValue:!0,dataType:n.fieldPropertyType},o=SCCultureHelper.current.applyFormatToControlValue(y);if(checkExistsNotEmpty(n.toolTip)||(t.displayText=o),u.innerHTML=o,checkExists(n.quickSearchValue)&&checkExists(n.fieldPropertyType)&&n.fieldPropertyType!=="file"&&n.fieldPropertyType!=="image"&&n.fieldPropertyType!=="hyperlink"&&n.fieldPropertyType!=="multivalue"){var c=replaceSpecialChars(o),p=replaceSpecialChars(n.quickSearchValue).toLowerCase();c.length>0&&c.toLowerCase().indexOf(p)>-1&&(u.innerHTML=checkQuickSearch(o,n.quickSearchValue,!0,n.literalVal))}}t.alignment=null;t.alignment=n.hasConditionalAlign?$sn(f,"Styles/Style/Text/Align"):n.columnAlign;t.text=r.innerHTML}}checkExists(n.isDisabled)&&(r=jQuery("<div>"+t.text+"<\/div>"),r[0].children[0].style.color="#cccccc",t.text=r[0].innerHTML)}}return t}function returnStyledColumTextAccordingToType(n){if(!(n&&n.textInfo&&n.fieldProperties))throw"returnStyledColumTextAccordingToType invoked with incorrect or missing parameters";var t=n.textInfo.text,c=n.textInfo.valueText;n.onlyUseText===!0?c=t:n.onlyUseValueText===!0&&(t=c);this.displayText=t;var nt=n.textNode,q=n.fieldProperties,a=q.quickSearchValue,v=n.currentCounter,r=n.textInfo;if(checkExists(t)&&t.trim().length>0){var y=n.fieldProperties.wrapText?"-wrap":"",tt=n.fieldProperties.literalVal,lt=n.fieldProperties.sanitizeHtml,at=n.fieldProperties.textStyle,k=n.fieldProperties.wrapWidth?" width: "+n.fieldProperties.wrapWidth:"",qt=n.fieldProperties.fieldPropertyType,e=null,p=SourceCode.Forms.Controls.Web.Utilities.TextStyleHelper.getTextStyleMetaData(at);checkExistsNotEmpty(p.className)&&(p.className+=" ");var ot="<"+p.tagName+" style='display: inline-block;"+k+"' class='"+p.className+"runtime-list-item{0}'>{1}<\/"+p.tagName+">";switch(qt){case"file":case"image":var u=null,f=null,d=null,vt=qt.toLowerCase()==="image";if(t.startsWith("<collection>")){var yt=baseCollectionXPath+"/fields/field[@name='FileName']/value";e=$xml(t);var st=$sn(e,yt).text;t=st;this.displayText=st;u=$sn(e,baseCollectionXPath+"/fields/field[@name='FilePath']/value");var pt=SourceCode.Forms.Runtime.MobileBridge.inMobileAppContext();pt&&checkExists(u)&&!checkExistsNotEmpty(u.text)&&(d=$sn(e,baseCollectionXPath+"/fields/field[@name='FileDataURL']/value"));f=$sn(e,baseCollectionXPath+"/fields/field[@name='FileRequestData']/value");checkExists(f)&&(f=f.text)}if(t.length>0){c=t;var rt="'  controlID='"+q.currentColumn;checkExists(q.isDisabled)&&(rt="");var l="";if(q.height&&(l+="height:"+q.height+"px;"),q.width&&(l+="width:"+q.width+"px;"),l.length>0&&(l=" style='"+l+"' "),vt){var ut=!1;if(checkExists(q.clearThumbnailCache)&&(ut=q.clearThumbnailCache),t="<img tabindex='0' class='fileImage static' alt='"+t.htmlEncode()+"' title='"+t.htmlEncode()+"' counter='"+v+rt+"' "+l,u&&u.text){var w=constructFileSrc(u.text,"path","image",q.height,q.width,v,null,ut,f);w=FormatFileDownloadPathForAnonAccess(w,!0);w=SourceCode.Forms.XSRFHelper.appendAntiXSRFQueryStringParameter(w);f=checkExists(f)?"fileRequestData='"+f+"'":"";t+=" relativePath='"+u.text.htmlEncode()+"' "+f+' src="'+w.htmlEncode()+'"/>'}else{var g="";checkExists(d)&&checkExistsNotEmpty(d.text)?(g=d.text,t+=' src="'+g.htmlEncode()+'" />'):(g=constructFileSrc(q.currentColumn,"control","image",q.height,q.width,v,null,ut),u=FormatFileDownloadPathForAnonAccess(g,!0),u=SourceCode.Forms.XSRFHelper.appendAntiXSRFQueryStringParameter(u),t+=' src="'+u.htmlEncode()+'" />')}}else{var s=a;checkExists(s)&&(s=s.htmlEncode());var ht=checkQuickSearch(t.htmlEncode(),s,null,!1);checkExists(q.isDisabled)?t="<span style='display: inline-block;color:#cccccc;"+k+"'  class='runtime-list-item"+y+"' >"+ht+"<\/span>":(f=checkExists(f)?"' fileRequestData='"+f:"",t="<a href='javascript:void(0);' tabindex='0' counter='"+v+rt+f,u&&(t+="' relativePath='"+u.text.htmlEncode()),t+="' class='fileImage static'>"+ht+"<\/a>")}}break;case"hyperlink":var b=t.trim();if(b.startsWith("<a")&&(t="<value>"+t+"<\/value>"),checkExistsNotEmpty(t)){b=t.trim();b.startsWith("<value")||(b.startsWith("<a")||(t="<a tabindex='0' class='hyperlink static' href='{0}'>{0}<\/a>".format(t.htmlEncode())),t="<value>"+t+"<\/value>");c=t;e=$xml(t);t="";var ft=$sn(e,"value/a");if(checkExists(ft)){var ct=ft.getAttribute("href");t=ft.text;t.length===0&&(t=ct);t===Resources.RuntimeMessages.SpecifyHyperlinkText&&(t="");this.displayText=t;var s=a;checkExists(s)&&(s=s.htmlEncode());t=checkQuickSearch(t.htmlEncode(),s);var wt=checkExists(q.target)?q.target:"_blank";t=checkExists(q.isDisabled)?"<span style='display: inline-block;color:#cccccc;"+k+"' class='runtime-list-item"+y+"' >"+t+"<\/span>":"<span class='runtime-list-item"+y+"' style='display: inline-block;"+k+"' ><a tabindex='0' class='hyperlink static' target='"+wt+"' href='"+ct.htmlEncode()+"'>"+t+"<\/a><\/span>"}else t=b}break;case"multivalue":while(t.startsWith("&lt;"))t=t.xmlDecode();if(t.startsWith("<collection>")||t==="<collection/>"?t="<value>"+t+"<\/value>":checkExists(nt)&&nt.xml&&(t=nt.xml),t.length>0){if(c=t,t.startsWith("<value>")){e=$xml(t);this.displayText="";var bt="value/"+baseCollectionXPath+"/fields/field",o=$mn(e,bt);if(checkExists(o)&&o.length>0)for(var h=0;h<o.length;h++){var et=$sn(o[h],"value").text;et=checkQuickSearch(et,a);this.displayText+=et;h+1<o.length&&(this.displayText+=", ")}else{o=$sn(e,"value").text.split(";");for(var h=0;h<o.length;h++)this.displayText+=o[h],h+1<o.length&&(this.displayText+=", ")}}else this.displayText=t;t=ot.format(y,this.displayText)}break;default:tt===!0&&lt===!0&&qt=="text"&&(t=html_sanitize(t,function(n){return n},function(n){return n}),this.displayText=html_sanitize(this.displayText,function(n){return n},function(n){return n}));c=t;checkExists(a)&&t.length>0?t=checkQuickSearch(t,a,!0,tt):tt===!1&&(t=t.htmlEncode());q.styleElementString=ot}}return!checkExistsNotEmpty(t)||checkExists(q.isVisible)&&q.isVisible==="false"?r.text="":(r.text=checkExists(q.styleElementString)?q.styleElementString:t,r.valueText=c,r.displayText=this.displayText,r=applyTableLabelStyleAndFormatting(q,r,v),r.text=r.text.format(y,t)),this.text=r.text,this.valueText=checkExists(r.valueText)?r.valueText.htmlEncode().xpathEncodeBackslash():null,this.alignment=r.alignment,this.displayText=checkExists(r.displayText)?r.displayText:"",checkExists(q.toolTip)&&(this.displayText=q.toolTip),this}function rebuildTable(n,t,q,r,u,f,e,o,s,h,c){for(var l=simpleListCache.indexOf(n);l>-1;)simpleListCache.splice(l,1),l=simpleListCache.indexOf(n);for(var a=listRefreshCache.indexOf(n);a>-1;)listRefreshCache.splice(a,1),a=listRefreshCache.indexOf(n);clearDisplayValueCache(n);clearTable(n,t,q,r,u,f,h);BuildTable(n,e,o,f,h,c)}function clearDisplayValueCache(n){var t=viewTableDefinitions[n];if(checkExists(t)){for(var r=t.length;r--;){var q=t[r];checkExists(q)&&checkExists(q.displayValueCache)&&(q.displayValueCache={})}viewTableDefinitions[n]=t}};
/*!
 ~/RunTime/Script/Filter.js
*/
function quickSearchFilterClicked(n){if(!_runtimeLoadingFromDraft){var t=n.data;BuildFilterEventAction(n.target.id,null,t)}}function BuildFilterEventAction(n,t,q){var r=n.split("_")[1];refreshList(r,t,q)}function refreshList(n,t,q,r){var o=null,u=null,e=getViewDefinition(n,q);if(checkExistsNotEmpty(e)){var s=e.getAttribute("MainTable");if(checkExistsNotEmpty(s)&&(u=document.getElementById(s),checkExists(u))){if(t)u.setAttribute("Paging","true");else{var h=e.getAttribute("ContextID"),c=e.getAttribute("ContextType");removeHiddenPropertyCollection(n,h,"Primary",null,!1,!0,c,q,h,!1);u.removeAttribute("PageNumber");u.removeAttribute("HasMorePages");u.removeAttribute("NumberOfPages");u.removeAttribute("OrderByResultName");u.removeAttribute("OrderBy");removeSortingIndicators(u.id);u.setAttribute("Paging","false")}o=u.getAttribute("actionxml")}}if(checkExists(o)){u.setAttribute("listrefreshed","true");var f=$sn($xml(o),"Action");if(checkExists(f.getAttribute("InstanceID"))&&!checkExists(q)?f.removeAttribute("InstanceID"):!checkExists(f.getAttribute("InstanceID"))&&checkExists(q)&&f.setAttribute("InstanceID",q),checkExists(r))executeAction(f,"ListRefresh",null,r);else{var l=SourceCode.Forms.Runtime.getMasterRuntimeWindow(),a=new l.SourceCode.Forms.Runtime.BehaviourEvent({actions:[f],methodExecuted:"ListRefresh",SourceID:n,SourceType:"View",InstanceID:q,windowToUse:window.self});a.executeBehaviour()}}else checkExists(r)&&(r.isExecuting=!1)}function refreshListForExportToExcel(n){n=checkExists(n)?n:{};var q=null,r=n.viewHtml[0];if(checkExists(r)&&(q=r.getAttribute("actionxml")),checkExists(q)){var u={viewId:n.viewId,instanceId:n.instanceId,data:{busyExporting:!0,pageSize:n.pageSize,pageNumber:n.pageNumber}};setExportToExcelData(u);var t=$sn($xml(q),"Action");if(checkExists(t.getAttribute("InstanceID"))&&!checkExists(n.instanceId)?t.removeAttribute("InstanceID"):!checkExists(t.getAttribute("InstanceID"))&&checkExists(n.instanceId)&&t.setAttribute("InstanceID",n.instanceId),checkExists(n.behaviour))executeAction(t,"ListRefresh",null,n.behaviour);else{var f=SourceCode.Forms.Runtime.getMasterRuntimeWindow(),e=new f.SourceCode.Forms.Runtime.BehaviourEvent({actions:[t],methodExecuted:"ListRefresh",SourceID:n.viewId,SourceType:"View",InstanceID:n.instanceId,windowToUse:window});e.executeBehaviour()}}else checkExists(n.behaviour)&&(n.behaviour.isExecuting=!1)}function buildFilterForPackage(n,t,q,r,u,f,e){var p;p=checkExistsNotEmpty(q.method.filter)?$xml(q.method.filter):$xml("<Filters/>");var w=checkExists(r)?r+"_":_runtimeEmptyGuid+"_",d=document.getElementById(w+n+"_quickSearchDdl"),g=document.getElementById(w+n+"_quickSearchTxt"),nt=document.getElementById(w+n+"_selectedFilterDdl"),h="",s="",c="",l=$sn(p,"Filters"),o=document.getElementById(t);if(checkExists(g)&&(s=g.value),checkExists(d)&&(h=$(d).dropdown("SelectedValue")),checkExists(nt)&&(c=$(nt).dropdown("SelectedValue")),s.length>0)if(h!=="[All]"&&h!=="[AllDisplay]"){var a=returnFieldAttributeObject(h,r);if(checkExists(a)){var b=a.propertyType,v=a.PropertyName,rt=a.name;v=getQualifiedResultName(a)+"."+v;var y=!1;switch(b.toLowerCase()){case"number":case"autonumber":s.isNumeric()&&(y=!0);break;case"decimal":s.isFloat()&&(y=!0);break;case"yesno":switch(s.toLowerCase()){case"true":case"false":case"yes":case"no":case"0":case"1":y=!0}break;default:y=!0}if(y){var ut=buildQuickFilterXML(b,v,s,p);l.appendChild(ut);checkExists(o)&&(o.setAttribute("QFName",v),o.setAttribute("QFValue",s),viewTableDefinitions[o.id]=constructTableDefinition(n,jQuery(o),s,v,r,!0))}else{var ft=Resources.RuntimeMessages.QuickSearchTypeMismatch.replace("{0}",rt).replace("{1}",b);return showRuntimeException(ft),!1}}}else(h==="[All]"||h==="[AllDisplay]")&&constructInclusiveFilter(n,p,l,s,r,h);else if(checkExists(o)){var tt=o.getAttribute("QFName"),qt=o.getAttribute("QFValue");checkExists(tt)&&tt.length>0&&checkExists(qt)&&qt.length>0&&(o.setAttribute("QFName",""),o.setAttribute("QFValue",""),viewTableDefinitions[t]=constructTableDefinition(n,jQuery(o),null,null,r,!0))}if(checkExists(c)&&c.length>0){var k=returnConstructedFilterXML(c,n,u,f,e);k&&k.hasChildNodes()&&l.appendChild(k.cloneNode(!0));returnConstructedSortingXML(c,n,u,q)}l.childNodes.length>0&&(q.method.filter=l.xml)}function filterListClientSide(n,t,q){var y=checkExists(q)&&checkExists(q.filterXmlXPath)?q.filterXmlXPath:"Filter",h,c;n.metadata&&(h=n.metadata.pagenumber,c=n.metadata.pagesize);var l=checkExists(h)?parseInt(h,10):null,o=checkExists(c)?c:null,v,e=n.smartobject.method.filter,r=t;if(checkExists(e)){typeof e=="string"&&(e=$xml(e));var a=$mn(e.documentElement,y);checkExists(a)&&a.length>0&&(v=a[0].childNodes,r=filterBasedOnAllOperators(t,{currentBrokerOperatorNodes:v}))}var s={collection:[]},f=0,u=r.length;if(checkExists(o)&&!isNaN(o)&&checkExists(l)&&!isNaN(l)&&(u=l*o,f=u-o,u=u<r.length?u:r.length,f=f>=0?f:0,u>=r.length&&(u=r.length,s.HasMorePages=!1)),checkExists(r)&&r.length>0)if(checkExists(q)&&q.reverse===!0)for(k=u-1;k>=f;k--)s.collection.push(r[k]);else for(k=f;k<u;k++)s.collection.push(r[k]);return s}function filterBasedOnAllOperators(n,t){if(!checkExists(n))throw"dataFields array is null";if(!checkExists(t.currentBrokerOperatorNodes))throw"currentBrokerOperatorNodes not specified";var h=t.combinationOperation;checkExistsNotEmpty(h)||(h="and");for(var r=[],u=[],c=!1,q=0;q<t.currentBrokerOperatorNodes.length;q++){var l=t.currentBrokerOperatorNodes[q].nodeName,f=l.toLowerCase();if(f==="and"||f==="or")h=f,u=filterBasedOnAllOperators(n,{currentBrokerOperatorNodes:t.currentBrokerOperatorNodes[q].childNodes,combinationOperation:f});else{var e,o=$sn(t.currentBrokerOperatorNodes[q],"Item[@SourceType ='ObjectProperty']"),a=$sn(t.currentBrokerOperatorNodes[q],"Item[@SourceType ='Value']"),v="";if(checkExists(a)&&(v=returnItemValue(a)),checkExistsNotEmpty(o)&&checkExistsNotEmpty(o.text))e=o.text;else{var s=o.getAttribute("SourceID");if(checkExistsNotEmpty(s)&&s.contains(".")&&(e=s.substr(s.indexOf(".")+1)),!checkExistsNotEmpty(e))throw"No object property specified. Please recreate the rule.";}u=filterForSingleOperator(n,{objectProperty:e,value:v,operation:l})}c?r=mergeFilterResultSets(r,u,t.combinationOperation):(r=u,c=!0)}return r}function mergeFilterResultSets(n,t,q){checkExists(q)&&(q=q.toLowerCase());var o=[];if(q==="and")for(var h=0;h<n.length;h++)for(var c=n[h].counter,s=0;s<t.length;s++){var l=t[s].counter;if(c===l){o.push(t.splice(s,1)[0]);break}}else if(q==="or")for(var r=null,u=null;n.length>0||t.length>0||checkExists(r)||checkExists(u);){checkExists(r)||(r=n.shift());checkExists(u)||(u=t.shift());var f=-1,e=-1;if(checkExists(r)&&(f=r.counter),checkExists(u)&&(e=u.counter),f!==-1&&e!==-1){if(f=parseInt(f),e=parseInt(e),f===NaN||e===NaN)throw"Counter is NaN. Result from server is corrupt.";f<e?(o.push(r),r=null):e<f?(o.push(u),u=null):f===e&&(o.push(r),r=null,u=null)}else f===-1?(o.push(u),u=null):(o.push(r),r=null)}return o}function filterForSingleOperator(n,t){if(!checkExists(n))throw"dataFields array is null";if(!checkExists(t.value))throw"No value specified";if(!checkExists(t.objectProperty))throw"No objectProperty specified";if(!checkExists(t.operation))throw"No operation specified";for(var r=[],q=0;q<n.length;q++){var u=n[q].fields[t.objectProperty],f=checkExists(u)?u.value:"",e=calculateExpressionValue(t.operation,[f,t.value]);e&&r.push(n[q])}return r}function constructInclusiveFilter(n,t,q,r,u,f){var s=null;switch(f){case"[AllDisplay]":var b={viewID:n,instanceID:u,testVisible:!0,sorted:!0};s=returnFieldsForFiltering(b);break;case"[All]":var k=checkExists(u)?u+"_"+n:_runtimeEmptyGuid+"_"+n;s=runtimeFilterFields[k]}if(checkExists(s))for(var y=s.length;y--;){var c=s[y],p=$sn(c,"PropertyType").text,h=$sn(c,"PropertyName").text,e=!1;switch(p.toLowerCase()){case"number":case"autonumber":r.isNumeric()&&(e=!0);break;case"decimal":(r.isNumeric()||r.isFloat())&&(e=!0);break;case"yesno":switch(r.toLowerCase()){case"true":case"false":case"yes":case"no":case"0":case"1":e=!0}break;case"datetime":break;case"file":case"image":e=!0;break;default:e=!0}if(checkExists(q)&&e){h=getQualifiedResultName(c,!0)+"."+h;f+=h.toLowerCase()+"|";var w=buildQuickFilterXML(p,h,r,t),l=$sn(q,"Filter[@Type='QuickFilter']");if(checkExists(l)){var a=t.createElement("or");a.appendChild(l.childNodes[0]);a.appendChild(w.childNodes[0]);l.appendChild(a)}else q.appendChild(w)}}var v=getViewMainTable(n,u);if(checkExistsNotEmpty(v)){var o=document.getElementById(v);if(checkExists(o)){var d=o.getAttribute("QFName"),g=o.getAttribute("QFValue");o.setAttribute("QFName",f);o.setAttribute("QFValue",r);(f!==d||r!==g)&&(viewTableDefinitions[v]=constructTableDefinition(n,jQuery(o),r,f,u,!0))}}}var _runtimeFieldCellsHash=new SFRuntimeHash;function returnFieldsForFiltering(n){var f=[],h=n.viewID,c=n.instanceID,t=n.viewDefinition;if(!checkExists(t)&&(t=returnCurrentViewXML(h,c),!checkExists(t)))return f;var st=n.testVisible,ht=n.sorted,e=$mn(t,"Controls/Control[(@FieldID)][@ControlTemplate='display']"),o=e.length,l=null;if(o>0){var v=e[0].parentNode.parentNode,g=v.getAttribute("MainTable");checkExists(c)||(c=v.getAttribute("InstanceID"));checkExists(h)||(h=v.getAttribute("ID"));checkExists(g)&&(l=jQuery(document.getElementById(g)))}while(o--){var y=e[o].getAttribute("ID"),nt=e[o].getAttribute("FieldID"),ct=e[o].getAttribute("ColumnIndex"),tt=!0,p=-1;if(st===!0){var qt=[h,c,nt],r=_runtimeFieldCellsHash.get(qt);if(!checkExists(r)){var a=jQuery(document.getElementById(y));a.length===0&&l!==null&&l.length>0&&(a=l.find(".grid-display-templates-table .grid-content-cell-wrapper").find("*[id*="+y+"]").first());a.length!==0&&(r=a.closest("td"));_runtimeFieldCellsHash.add(qt,r)}checkExists(r)&&r.length>0&&(tt=!r.hasClass("hidden"),p=r.index())}if(tt){var lt="Fields/Field[@ID='"+nt+"']",u=$sn(t,lt);if(checkExists(u)){var at=$sn(u,"PropertyName").text,rt=$sn(u,"PropertyType").text,w="",vt="Controls/Control[(@ColumnIndex='"+ct+"')][@ControlTemplate='header']/Properties/Property[Name/text()='Text']/Value",b=$sn(t,vt);checkExists(b)&&b.text.length>0&&(w=b.text);var ut=new dataSourceLookup({xmlDoc:t,includeControllers:!1,includeController:!1,selectMultiple:!0,sourceControlID:y,originalProperty:at,controlDisplayTemplate:"true"}).getDataSource(),k=ut.length;if(k>0)while(k--)for(var s=ut[k],yt=s.getAttribute("AssociationSO"),pt=s.getAttribute("DisplayTemplate"),wt=s.getAttribute("ContextID"),bt=s.getAttribute("ContextType"),d=returnAllDisplayPropertiesFromTemplate(pt),ft=d.length;ft--;){var et=d[ft],ot=s.getAttribute("DisplaySO"),q=null;if(q=ot?$sn(t,"Fields/Field[@ObjectID='"+ot+"'][PropertyName/text()='"+et+"']"):$sn(t,"Fields/Field[@ObjectID='"+yt+"'][PropertyName/text()='"+et+"'][@ContextType='"+bt+"'][@ContextID='"+wt+"']"),checkExists(q)){if(d.length===1)q.setAttribute("DisplayName",w);else{var kt=$sn(q,"Name").text.replace("."," ");q.setAttribute("DisplayName",kt)}q.setAttribute("ColumnIndex",p);q.setAttribute("PropertyType",rt);f.push(q)}}else u.setAttribute("DisplayName",w),u.setAttribute("ColumnIndex",p),u.setAttribute("PropertyType",rt),f.push(u)}}}return ht&&f.sort(function(n,t){var q=parseInt(n.getAttribute("ColumnIndex"),10),r=parseInt(t.getAttribute("ColumnIndex"),10);return q===r?0:q>r?-1:1}),f}function returnConstructedFilterXML(n,t,q,r,u){var f=$xml(__persistedFiltersDefinition),e="Views/View[@ID="+t.xpathValueEncode()+"]/ViewFilterCriteria/FilterCriteria[@name="+n.xpathValueEncode()+"]/Filter",o=$sn(f,e);return inspectAndReplaceFilterXml(o,f,q,r,u)}function returnConstructedSortingXML(n,t,q,r){var f=$xml(__persistedFiltersDefinition),e="Views/View[@ID="+t.xpathValueEncode()+"]/ViewFilterCriteria/FilterCriteria[@name="+n.xpathValueEncode()+"]/Sorters",u=$sn(f,e);checkExists(u)&&inspectAndReplaceSortingXml(u,r,q)}function constructSortingStructure(n,t,q,r){var u,f;if(checkExists(n)&&checkExists(n.method)&&(u=n.method.sorters),checkExists(u)){var o={OrderBy:t,OrderByResultName:q};f=u.filter(__runtimeJsonFilterMatchingItems,o)}else u=[];if(checkExists(f)&&f.length!==0){var e=f[0];if(u.length>1){var s=u.indexOf(e);u.splice(s,1);u.unshift(e)}e.Direction=r}else f={},f.OrderBy=t,f.OrderByResultName=q,f.Direction=r,u.unshift(f);checkExists(n)&&checkExists(n.method)&&(n.method.sorters=u)}function inspectAndReplaceFilterXml(n,t,q,r,u){var h=null,f=null,e=0;if(checkExists(n)){for(h=".//Item[@SourceType='ObjectProperty'][not(@FullSourceID)]",f=$mn(n,h),e=f.length;e--;){var w=f[e].getAttribute("SourceID");if(w.indexOf(q+".")===-1){var rt=q+"."+w;f[e].setAttribute("SourceID",rt);f[e].setAttribute("SourceType","ObjectProperty");f[e].setAttribute("FullSourceID","true")}}for(h=".//Item[@SourceType='Value'][(SourceValue/Item) or (OriginalValue/SourceValue)]",f=$mn(n,h),e=f.length;e--;){var a=null,b=!0,v=$sn(f[e],"OriginalValue");checkExists(v)||(v=f[e],b=!1);a=r.returnSourceValue({item:v,returnNulls:!0,loopContextID:u});var ut=!1;if(checkExists(a)||(ut=!0,a=""),b)f[e].removeChild($sn(f[e],"SourceValue"));else{var k=t.createElement("OriginalValue");f[e].appendChild(k);k.appendChild($sn(v,"SourceValue"))}var d=t.createElement("SourceValue");f[e].appendChild(d);var ft=t.createTextNode(a);d.appendChild(ft)}for(h=".//Item[@SourceType='ViewField']",f=$mn(n,h),e=f.length;e--;){var et=f[e].getAttribute("SourceID"),y=$sn(viewControllerDefinition,"Controllers/Controller/Fields/Field[@ID='"+et+"']");if(checkExists(y)){var ot=$sn(y,"PropertyName").text,g=getQualifiedResultName(y,!0),o=f[e].parentNode,c,nt=!1;if(g!==q){var p=r.returnSourceValue({item:f[e],loopContextID:u});if(checkExists(p)&&p!==""){nt=!0;c=t.createElement("Item");c.setAttribute("SourceType","Value");c.setAttribute("DataType",checkExists(f[e].getAttribute("DataType"))?f[e].getAttribute("DataType"):"Text");var tt=t.createElement("SourceValue");c.appendChild(tt);var st=t.createTextNode(p);tt.appendChild(st);o.replaceChild(c,f[e])}}if(!nt){var ht=g+"."+ot;f[e].setAttribute("SourceID",ht);f[e].setAttribute("SourceType","ObjectProperty");f[e].setAttribute("FullSourceID","true");c=f[e].cloneNode(!0);o.replaceChild(c,f[e])}if(o.tagName==="SourceValue"&&o.childNodes.length===1){while(o.tagName!=="Item")o=o.parentNode;o.tagName==="Item"&&o.getAttribute("SourceType")==="Value"&&o.parentNode.replaceChild(c,o)}}}for(h=".//Item[(@SourceType='SystemVariable') or (@SourceType='Control') or (@SourceType='ViewParameter') or (@SourceType='FormParameter') or (@SourceType='Expression') or (@SourceType='ControlProperty') or (@SourceType='EnvironmentField')]",f=$mn(n,h),e=f.length;e--;){var ct=returnSourceValue({item:f[e],loopContextID:u}),s=f[e].parentNode,l=t.createElement("Item");l.setAttribute("SourceType","Value");l.setAttribute("DataType",checkExists(f[e].getAttribute("DataType"))?f[e].getAttribute("DataType"):"Text");var qt=t.createElement("SourceValue");l.appendChild(qt);var lt=t.createTextNode(ct);if(qt.appendChild(lt),s.replaceChild(l,f[e]),s.tagName==="SourceValue"&&s.childNodes.length===1){while(s.tagName!=="Item")s=s.parentNode;s.tagName==="Item"&&s.getAttribute("SourceType")==="Value"&&s.parentNode.replaceChild(l,s)}}}return n}function inspectAndReplaceSortingXml(n,t,q){if(checkExists(n)){for(var f=".//Sorter[@SourceType='ViewField']",r=$mn(n,f),u=r.length;u--;){var l=r[u].getAttribute("SourceID"),o=returnFieldAttributeObject(l),a=o.PropertyName,s=getQualifiedResultName(o);r[u].setAttribute("OrderByResultName",s);r[u].setAttribute("OrderBy",a)}for(f=".//Sorter[@SourceType='ObjectProperty']",r=$mn(n,f),u=r.length;u--;){var v=r[u].getAttribute("SourceID");r[u].setAttribute("OrderByResultName",q);r[u].setAttribute("OrderBy",v)}for(var h=$mn(n,"Sorter"),c=h.length;c--;){var e=h[c],y=e.getAttribute("OrderBy"),s=e.getAttribute("OrderByResultName"),p=e.getAttribute("Direction");constructSortingStructure(t,y,s,p)}}}function buildQuickFilterXML(n,t,q,r){var f=null;if(q!==""){var u="";switch(n.toLowerCase()){case"number":case"decimal":case"autonumber":case"yesno":u="equals";break;default:u="contains"}f=FilterBuildLeftRight(t,q,u,r)}return f}function FilterBuildLeftRight(n,t,q,r){var u=r.createElement("Filter");u.setAttribute("Type","QuickFilter");var f=r.createElement(q);u.appendChild(f);var e=r.createElement("Item");e.setAttribute("SourceType","ObjectProperty");e.setAttribute("SourceID",n);f.appendChild(e);var o=r.createElement("Item");o.setAttribute("SourceType","Value");var s=r.createElement("SourceValue");return o.appendChild(s),s.appendChild(r.createTextNode(t)),f.appendChild(o),u}function populatePagingControls(n,t,q,r,u,f,e){var s=n.id;checkExists(q)&&n.setAttribute("PageNumber",q);checkExists(t)&&n.setAttribute("PageSize",t);var o=jQuery("#"+s);checkExists(q)&&SFRGrid.execute({element:o,fn:"option",params:["page",q]});var h=f==="true";SFRGrid.execute({element:o,fn:"option",params:["hasrowcount",h]});n.setAttribute("HasRowCount",h.toString());checkExists(u)?(n.setAttribute("HasMorePages",u),SFRGrid.execute({element:o,fn:"option",params:["hasmorepages",u==="true"]})):SFRGrid.execute({element:o,fn:"option",params:["hasmorepages",!0]});checkExists(r)&&(n.setAttribute("NumberOfPages",r),SFRGrid.execute({element:o,fn:"option",params:["totalpages",r]}));e==="true"&&jQuery("#"+s+"_pagingtxtbox").val(q)}function doPaging(n,t,q,r,u){var f=t,e=q[0],h=e.getAttribute("ID"),c=e.getAttribute("NumberOfPages");switch(n){case"start":case"first":f=1;break;case"previous":f--;break;case"next":f++;break;case"end":case"last":f=c;break;default:f=n}var v=e.getAttribute("PageNumber");if(v!==f.toString()){var l=new getMainTableViewInformation(h),s=l.viewID,o=l.instanceID,y=checkExists(o)?o:_runtimeEmptyGuid,a=y+"_"+s+"_quickSearchBtn";if(q.grid("deselect"),checkExists(f)&&f.toString().length>0){e.setAttribute("PageNumber",f);var p=verifyRecordsForPage(s,f.toString(),o);if(p===0)BuildFilterEventAction(a,!0,o);else if(parseInt(f,10)!==parseInt(t,10)){var w=e.getAttribute("PageSize"),b=r!==!1?"true":"false",k=e.getAttribute("HasRowCount"),d=getCombinedHiddenPropertyCollection(s,null,null,f.toString(),null,null,null,null,null,o);populatePagingControls(e,w,f,c,b,k);rebuildTable(h,s,o,!1,!1,null,d,!0,f,u,!1)}}else SFRGrid.execute({element:q,fn:"option",params:["page",1]}),e.setAttribute("PageNumber",1),BuildFilterEventAction(a,!0,o)}}function removeSortingIndicators(n){jQuery("#"+n).find(".grid-column-header-table").children("tbody").children("tr").children("td").children(".grid-column-header-cell").removeClass("asc").removeClass("desc")}function gridCustomSorting(n,t,q){if(checkExists(q)){var s=SFRGrid.execute({element:q,fn:"fetch",params:["display-template-row"]}),f=checkExists(s)?s.find("td .grid-content-cell-wrapper")[n].children[0].getAttribute("ID"):"";f=getActualControlID(f);var r=q[0],h=new getMainTableViewInformation(r.id),c=h.viewID,l=h.instanceID,o=checkExistsNotEmpty(f)?controlInformationObject(f):null;if(checkExists(o)){var v=o.qualifiedName;runtimeBusyView(c,!0,!0,l);var y=t?"descending":"ascending",e=r.getAttribute("PageSize");checkExists(e)&&e.length>0&&(r.setAttribute("OrderByResultName",o.resultName),r.setAttribute("OrderBy",v.split(".")[1]),r.setAttribute("OrderDirection",y));var u=r.getAttribute("NumberOfPages"),a=r.getAttribute("HasMorePages");u=checkExists(u)&&u.toString().length>0?parseInt(u,10):1;checkExists(e)&&e.length>0&&(u>1||checkExists(a)&&a==="true")&&(r.removeAttribute("PageNumber"),r.removeAttribute("HasMorePages"),r.removeAttribute("NumberOfPages"),removeHiddenPropertyCollection(c,null,null,null,!1,null,null,l),doPaging("start",1,q))}}};
/*!
 ~/RunTime/Script/List.js
*/
function listExecutionAction(n,t,q,r){var f=getLoopContextID(n),e="",o=n.getAttribute("ViewID"),s=n.getAttribute("InstanceID");if(checkExists(o)&&(e=getViewMainTable(o,s)),e.length>0){var u=jQuery("#"+e);checkExists(u[0].getAttribute("editable"))||u[0].setAttribute("editable","false");var h=n.getAttribute("Method");switch(h){case"AddItem":addListItemRow(u,null,f);break;case"EditItem":editListItemRow(u,f);break;case"RemoveItem":removeListItemRow(u,f);break;case"AcceptItem":acceptItemChanges(u,f);break;case"CancelItem":cancelItemChanges(u,null,f)}}endActionExecution({loopContextID:f,behaviour:r})}function setListAttributes(n,t,q,r){var s={},u=n[0];if(u.setAttribute("editable",t),t==="true"){var o="",f="";if(q==="add"){f=returnNewMaxCounter(u);var h=SFRGrid.execute({element:n,fn:"fetch",params:["rows"]});o=checkExists(h)?h.length+1:1}else{f=getLoopContextData({loopContextID:r,mainTable:n}).counter;var e=null;if(checkExistsNotEmpty(f))e=returnRowFromCounter(n,f),checkExists(e)&&(o=e[0].rowIndex);else{var e=returnSelectedRow(n);checkExists(e)&&e.length>0?(o=e[0].rowIndex,f=e.children("td").metadata().counter):f=""}}s.selectedCounter=f;s.selectedIndex=o;u.setAttribute("selectedCounter",f);u.setAttribute("selectedIndex",o);u.setAttribute("actionType",q);u.setAttribute("changingrow",t);SFRGrid.execute({element:n,fn:"option",params:["sorting",!1]})}else u.removeAttribute("selectedCounter"),u.removeAttribute("selectedIndex"),u.removeAttribute("actionType"),SFRGrid.execute({element:n,fn:"commit"}),SFRGrid.execute({element:n,fn:"option",params:["sorting",!0]});return s}function addListItemRow(){var n,t,q;if(n=arguments[0].closest(".grid"),n.length>0&&n.attr("isdisabled")!=="true"&&n[0].getAttribute("changingrow")!=="true"){var e=arguments[1],r=new getMainTableViewInformation(n.attr("id"));t=r.viewID;q=r.instanceID;var u=r.ListEditable;if(e!=="override"&&checkExists(u)&&u==="single"&&n[0].setAttribute("singleEdit","add"),attemptItemChanges(n,t,q,arguments[2]),checkExists(n[0].getAttribute("editable"))||n[0].setAttribute("editable","false"),n[0].getAttribute("editable")==="false"){clearListItemRow(t,q);setListAttributes(n,"true","add");var f=jQuery(n);SFRGrid.execute({element:f,fn:"edit",params:["new"]});SFRGrid.execute({element:f,fn:"runtimeSyncColumns"});resetDefaultControlValues(t,q,arguments[2]);n[0].setAttribute("changingrow","false")}handleEvent(t,"View","ListRowAdded",null,q,null,null,null,null,null,null,arguments[2])}}function editListItemRow(n,t,q){if(n.length>0&&n[0].getAttribute("changingrow")!=="true"){var r=new getMainTableViewInformation(n.attr("id")),u=r.viewID,f=r.instanceID,e=r.ListEditable;if(q!=="override"&&checkExists(e)&&e==="single"&&n[0].setAttribute("singleEdit","edit"),attemptItemChanges(n,u,f,t),n[0].getAttribute("editable")==="false"){var o=setListAttributes(n,"true","update",t),s=o.selectedCounter,h=o.selectedIndex;s!==""?(SFRGrid.execute({element:jQuery(n),fn:"edit",params:[h]}),transferListItemData(s,u,f,t)):setListAttributes(n,"false",null);n[0].setAttribute("changingrow","false")}}}function commitListItemRow(n){var t=n.closest(".grid");if(t.length>0&&t.attr("isdisabled")!=="true"){var q=new getMainTableViewInformation(t.attr("id")),r=q.viewID,u=q.instanceID;attemptItemChanges(t,r,u)}}function acceptItemChanges(n,t){var f=!0;if(n.length>0){var e=n.attr("id"),u=new getMainTableViewInformation(e),q=u.viewID,r=u.instanceID,s=n[0].getAttribute("editable"),h=n[0].getAttribute("actionType");if(s==="true"){var o=returnSelectedCounter(n);switch(h){case"add":case"update":if(f=copyHiddenListValuesBetweenCounters(q,r,o,null),!f){var c=u.clearThumbnailCache;populateListRowWithData(n,q,r,c)}break;case"remove":var l=returnSelectedRow(n);checkExists(l)&&(removeSelectedRow(n),removeHiddenPropertyCollectionItem(q,!1,o,r))}}clearListItemRow(q,r);setListAttributes(n,"false",null);updateGridAfterChanges(e,t);setTimeout(function(){buildAggregations(n,q,null,r,t)},0)}}function updateGridAfterChanges(n,t){editableListCache.indexOf(n)>-1&&(editableListCache=editableListCache.filter(function(n,t){return editableListCache.indexOf(n)===t}),editableListCache.splice(editableListCache.indexOf(n),1),updateListDisplay(n,!0,t))}function testCancelList(n){if(n.keyCode===27){var t=jQuery("#"+n.data);$("div.tooltip.validation").hide();n.target.tagName.toLowerCase()==="input"&&n.target.blur();var u=t[0].getAttribute("actionType"),q=SFRGrid.execute({element:t,fn:"getActionRow"});if(cancelItemChanges(t),u==="add"&&checkExists(q)&&q.length>0)q.trigger("focus");else{var r=SFRGrid.execute({element:t,fn:"getContentTable"});checkExists(r)&&r.trigger("focus")}}}function cancelItemChanges(n,t,q){if(n.length>0){var r=n.attr("id"),u=new getMainTableViewInformation(r);viewID=u.viewID;instanceID=u.instanceID;clearListItemRow(viewID,instanceID);setListAttributes(n,"false",null);checkExists(t)&&t===!1||updateGridAfterChanges(r,q)}}function removeListItemRow(n,t){if(n.length>0){var q=n[0];if(q.getAttribute("editable")==="false"){setListAttributes(n,"true","remove",t);var r=new getMainTableViewInformation(q.getAttribute("ID"));viewID=r.viewID;instanceID=r.instanceID;attemptItemChanges(n,viewID,instanceID,t);q.setAttribute("changingrow","false")}}}function transferListItemData(n,t,q,r){copyHiddenListValuesBetweenCounters(t,q,!1,n);for(var o=returnCurrentViewXML(t,q),c=$mn(o,"Controls/Control[Properties/Property/Name/text()='SetValue'][(@ControlTemplate='edit')]"),l=c.length,s={};l--;){var f=c[l],u=f.getAttribute("ID");if(!checkExists(s[u])){var h=returnListItemValue(f,u,n,o,q,r);if(checkExists(h)){var y=$sn(o,"Associations/Association[@SourceControlID='"+u+"'][not (@IsComposite)]"),a=new PopulateObject(null,h,u,null,!0);if(checkExists(y)){var e=[];e.push({objInfo:a,currentControl:f});startLoadingListDependantValues(u,t,h,n,q,e,r);for(var v=e.length;v--;)execution=e[v],executeControlFunction(execution.currentControl,"SetValue",execution.objInfo),s[execution.objInfo.CurrentControlId]=!0}else executeControlFunction(f,"SetValue",a),s[u]=!0}}}}function clearListItemRow(n,t){var q=returnCurrentViewXML(n,t);clearViewControls(n,q,!1,t,!0,null,!0,!0);removeHiddenPropertyCollectionItem(n,!1,!1,t)}function attemptItemChanges(n,t,q,r,u){if(n[0].getAttribute("editable")==="true"){var f=n[0].getAttribute("actionType");checkExists(u)&&u!=="Added"&&u!=="Removed"&&u!=="Changed"&&(u=null);switch(f){case"add":checkExists(u)&&u!=="Added"||handleEvent(t,"View","ListItemAdded",null,q,null,null,null,null,null,null,r);break;case"update":checkExists(u)&&u!=="Changed"&&u!=="Added"||handleEvent(t,"View","ListItemChanged",null,q,null,null,null,null,null,null,r);break;case"remove":checkExists(u)&&u!=="Removed"||handleEvent(t,"View","ListItemRemoved",null,q,null,null,null,null,null,null,r)}}}function returnNewMaxCounter(n){var t=0;return checkExists(n.getAttribute("maxcounter"))&&(t=parseInt(n.getAttribute("maxcounter"),10)+1),n.setAttribute("maxcounter",t),t}function populateListRowWithData(n,t,q,r){if(n.length>0){var o=returnSelectedCounter(n),u=viewTableDefinitions[n[0].id];if(!checkExists(u)||u.length===0){var s=null,h=null;checkExists(n[0].getAttribute("QFName"))&&n[0].getAttribute("QFName").length>0&&(s=n[0].getAttribute("QFName"),h=n[0].getAttribute("QFValue"));u=constructTableDefinition(t,n,h,s,q);viewTableDefinitions[n[0].id]=u}var c=returnSelectedIndex(n);if(r)for(var f=0;f<u.length;f++)checkExists(u[f])&&u[f].fieldPropertyName==="Image"&&(u[f].clearThumbnailCache=!0);var l=getViewHiddenHash(t,q),a={controlid:!1,contexttype:"Primary",ignoreState:!0,counter:o},v=l.filter(__runtimeJsonFilterMatchingItems,a),y=populateTableRowFromDefinition(u,o,q,v[0]),p=n[0].getAttribute("actionType");SFRGrid.execute({element:n,fn:p,params:["row",y,n.is(":visible"),c]});var e=n.find("a.fileImage, img.fileImage");if(e.length>0){e.on("click",openFileImage);e.on("focus",function(){$(this).addClass("hide-browser-highlight active")});e.on("blur",function(){$(this).removeClass("hide-browser-highlight active")})}}}function returnListItemValue(n,t,q,r,u,f){var e=null;return checkExists(n.getAttribute("FieldID"))?e=getHiddenFieldValue(n.getAttribute("FieldID"),q,null,null,u,f,null):checkExists(n.getAttribute("ExpressionID"))&&(e=returnCalculationResultForControl(n,q,u,f)),e}function copyHiddenListValuesBetweenCounters(n,t,q,r){var o=!0,s=!1;r!=null&&(s=r);var tt={counter:s,controlid:!1,contexttype:"Primary",ignoreFields:!0,ignoreState:!0},a=getViewHiddenHash(n,t);if(a.length>0){var p=a.filter(__runtimeJsonFilterMatchingItems,tt);if(p.length>0){var f=jsonCopyAndExtendObject(p[0],q),h=f.fields;if(checkExists(h))for(var w in h)checkExistsNotEmpty(h[w].value)&&(o&&(o=!1),h[w].cleared=!1);if(s===!1&&!o){var b=determineJoinsForEditableList(n,t,a);f.state="Changed";var v=b.length;if(v>0)for(f.joins=[];v--;){var u=b[v],l=h[u.fieldPropertyName],y=[];if(checkExists(l)&&!l.cleared){y=u.controlData;for(var k=y.length,d=null,g=null;k--;){var e=y[k];if(checkExists(e.controlid)){e.controlid!==g&&(d=getControlValue({controlID:e.controlid}),g=e.controlid);var qt=d,nt=e.fields[u.valueProperty];if(checkExists(nt)&&nt.value===qt){var c=jsonCopyAndExtendObject(e);delete c.state;delete c.controlid;delete c.counter;c.contextid=u.contextID;f.joins.push(c);break}}}}else if(checkExists(l)&&l.cleared){var rt={parentid:u.parentID,contextid:u.contextID,contexttype:u.contextType,fields:{}};f.joins.push(rt)}}}(s!==!1||o)&&s===!1||pushHiddenValue(n,t,f)}}return o}function determineJoinsForEditableList(n,t,q){var y=returnHashName(n,t),u=_runtimeELJoinHash[y];if(!u){u=[];var g=returnCurrentViewXML(n,t),f=[],p=new dataSourceLookup({xmlDoc:g,includeControllers:!1,includeController:!1,selectMultiple:!0,controlDisplayTemplate:!1}).getDataSource(),c=p.length;if(c>0){while(c--){var nt=controlInformationObject(p[c].getAttribute("SourceControlID"));f.push(nt)}var h=getViewMainTable(n,t);if(checkExists(h)){var e=viewTableDefinitions[h];if(!checkExists(e)||e.length===0){var s=jQuery("#"+h),w,b;checkExists(s[0].getAttribute("QFName"))&&s[0].getAttribute("QFName").length>0&&(w=s[0].getAttribute("QFName"),b=s[0].getAttribute("QFValue"));e=constructTableDefinition(n,s,b,w,t);viewTableDefinitions[h]=e}for(var k=e.length;k--;){var r=e[k];if(checkExists(r)&&r.isAssociation===!0){var qt=r.fieldPropertyName,l=r.originalSOID;r.displaySOID&&(l=r.displaySOID);var d=!0;if(r.fieldID)for(var o=0;o<f.length;o++)if(f[o].fieldID==r.fieldID||r.originalSOID!=r.displaySOID&&f[o].ParentUsingField==r.fieldID){d=f[o].ID;f.splice(o,1);break}var a={counter:!0,contexttype:r.contextType,parentid:l,controlid:d},v=q.filter(__runtimeJsonFilterMatchingItems,a);v.length===0&&(a.counter=!1,v=q.filter(__runtimeJsonFilterMatchingItems,a));var tt={fieldPropertyName:r.fieldPropertyName,valueProperty:r.valueProperty,contextID:r.contextID,contextType:r.contextType,parentID:l,controlData:v};u.push(tt)}}}}_runtimeELJoinHash[y]=u}if(u)return u}function startLoadingListDependantValues(n,t,q,r,u,f,e){var o=new dataSourceLookup({xmlDoc:viewControllerDefinition,sourceControlID:n,parentControlExists:!0}).getDataSource();if(checkExists(o)){var l=o.getAttribute("ParentJoinProperty"),a=o.getAttribute("ParentControlID"),y=q,p=o.getAttribute("ChildJoinProperty"),w=o.getAttribute("AssociationSO"),k=o.getAttribute("ValueProperty");if(checkExists(q)){var b={counter:r,controlid:!1},v=getHiddenPropertyCollection(t,u,b);if(v.length>0){var s,h=v[0].joins;if(h==null)s=getListParentControlValue(a,t,u,r,f,e);else for(var c=0;c<h.length;c++)if(h[c].parentid!==w&&h[c].fields[l]){s=h[c].fields[l].value;break}s&&(getActionsWithControlAsResult(n,l,s,y,p,u),setParentControlValue(a,s,u,r,f,e))}}}}function getListParentControlValue(n,t,q,r,u,f){var o=null,e=returnCurrentViewXML(t,q);if(e!=null){var s=$sn(e,"Controls/Control[Properties/Property/Name/text()='SetValue'][(@ControlTemplate='edit')][(@FieldID)][@ID='"+n+"']");s!=null&&(o=returnListItemValue(s,n,r,e,q,f))}return o}function adaptDependencyFields(n,t){var u="Controllers/Controller[@ID='"+n+"']",o=n+"_",l=checkExistsNotEmpty(t)&&t!==_runtimeEmptyGuid;if(l&&(o+=t,u+="[@InstanceID='"+t+"']"),viewXmlCache[o]=null,checkExists(viewControllerDefinition))for(var e=$mn(viewControllerDefinition,u+"/Associations/Association[(@ParentControlID and @SourceControlID)][not (@IsComposite)]"),f=0;f<e.length;f++){var s=e[f].getAttribute("ParentControlID"),a=e[f].getAttribute("SourceControlID"),r=$sn(viewControllerDefinition,u+"/Controls/Control[@ID='"+s+"'][@FieldID]"),h=$sn(viewControllerDefinition,u+"/Controls/Control[@ID='"+a+"'][@FieldID]");if(checkExists(r)&&checkExists(h)&&r.getAttribute("FieldID")===h.getAttribute("FieldID")){var q={};q.viewId=n;q.instanceId=t;q.controlId=s;var c=r.getAttribute("FieldID");r.setAttribute("ParentUsingField",c);q.propertyName="parentusingfield";q.value=c;SourceCode.Forms.Runtime.Information.setControlPropertyHistory(q);r.removeAttribute("FieldID");q.propertyName="field";q.value="";SourceCode.Forms.Runtime.Information.setControlPropertyHistory(q)}}};
/*!
 ~/RunTime/Script/Depend.js
*/
var actionExecutionArray=[];function startLoadingDependantValues(n,t,q,r,u,f){var e=new dataSourceLookup({xmlDoc:viewControllerDefinition,sourceControlID:n,parentControlExists:!0}).getDataSource();if(checkExists(e)){var h=e.getAttribute("ParentJoinProperty"),s=e.getAttribute("ParentControlID"),c=t,l=e.getAttribute("ChildJoinProperty"),a=_runtimeControllerFindObject({controlID:s}),o=getHiddenFieldValue(a.getAttribute("FieldID"),null,null,null,r,f,!0);o&&(getActionsWithControlAsResult(n,h,o,c,l,r),setParentControlValue(s,o,r,null,u,f))}}function setParentControlValue(n,t,q,r,u,f){var e=_runtimeControllerFindObject({controlID:n,propertySearch:"SetValue"});if(checkExists(e)){var o=new PopulateObject(null,t,n,null,!0);u.push({objInfo:o,currentControl:e});startLoadingDependantValues(n,t,r,q,u,f)}}function getActionsWithControlAsResult(n,t,q,r,u,f){var h=checkExists(f)?"[@TargetInstanceID='"+f+"']":"",c="Events/Event[@SourceType='Control'][Name/text()='OnChange']/Handlers/Handler/Actions/Action[Results/Result[@TargetID='"+n+"'][@TargetType='Control']"+h+"]",o=$mn(formBindingXml,c);if(o.length>0){for(var s=0;s<o.length;s++){var e=[];e.push(o[s]);e.push(t);e.push(q);e.push(u);e.push(r);actionExecutionArray.push(e)}inspectResultActions()}}function inspectResultActions(){while(actionExecutionArray.length>0){var q=actionExecutionArray.shift(),s=q.shift(),v=q.shift(),h=q.shift(),c=q.shift(),r=q.shift(),n=$mn(s,"Parameters/Parameter");if(n.length>0)for(var t=0;t<n.length;t++){var l=n[t].getAttribute("TargetID"),a=n[t].getAttribute("TargetType");if(a.toLowerCase()==="objectproperty"&&l.toLowerCase()===c.toLowerCase()){var u=$sn(n[t],"SourceValue"),f=$sn(n[t],"ActualValue");checkExists(u)&&n[t].removeChild(u);checkExists(f)&&n[t].removeChild(f);var e=viewControllerDefinition.createElement("SourceValue");if(e.appendChild(viewControllerDefinition.createTextNode(h)),n[t].appendChild(e),r.length>0){var o=viewControllerDefinition.createElement("ActualValue");o.appendChild(viewControllerDefinition.createTextNode(r));n[t].appendChild(o)}}}}}function startClearingDependantValues(n,t){var q=new dataSourceLookup({xmlDoc:viewControllerDefinition,parentControlID:n}).getDataSource();if(checkExists(q)||(q=new dataSourceLookup({xmlDoc:viewControllerDefinition,sourceControlID:n}).getDataSource()),checkExists(q)){var r=q.getAttribute("SourceControlID"),u=_runtimeControllerFindObject({controlID:n,propertySearch:"SetItems"});if(checkExists(u)){var f=new PopulateObject(null,"0",n,null,null,t);executeControlFunction(u,"SetItems",f);r!==n&&startClearingDependantValues(r,t)}}}function startClearingDependantParentValues(n,t){checkExists(t)||(t=[]);var u=new dataSourceLookup({xmlDoc:viewControllerDefinition,sourceControlID:n,parentControlExists:!0}).getDataSource();if(checkExists(u)){var q=u.getAttribute("ParentControlID");if(currentControl=_runtimeControllerFindObject({controlID:n,propertySearch:"SetItems"}),checkExists(currentControl)){var r=new PopulateObject(null,"0",n,null,null,t);executeControlFunction(currentControl,"SetItems",r);currentControl=_runtimeControllerFindObject({controlID:q,propertySearch:"SetValue"});checkExists(currentControl)&&(r=new PopulateObject(null,"0",q,null,!0,t),executeControlFunction(currentControl,"SetValue",r),startClearingDependantParentValues(q,t))}}};
/*!
 ~/RunTime/Script/Calculations.js
*/
var editableListCache=[],simpleListCache=[],evaluatingExpressions=[],expressionBusy=!1,expressionHash=new SFRuntimeHash,_runtimeUpdateCalculatedControlsHash=new SFRuntimeHash;function updateCalculatedControls(n,t,q,r,u,f,e,o){var a=null,c="",v=null,w="";checkExists(t)&&(w=t);checkExists(n)?(c="control",v=n.getAttribute("ID"),a=v):checkExists(q)&&checkExists(r)?(c="source",a=q+"_"+r):checkExists(f)&&(c="expression",a=f);var b=[c,w,a];if(c!=""){var s=_runtimeUpdateCalculatedControlsHash.get(b);if(!checkExists(s)){s=[];var k="Controllers/Expressions/Expression",h="",l="";switch(c){case"control":h+=".//Item[(@SourceType='Control' and @SourceID ='"+v+"')";l+=".//Item[(@SourceType='Control' and @SourceID ='"+v+"')";var y=n.getAttribute("FieldID");checkExists(y)&&(h+=" or (@SourceType='ViewField' and @SourceID ='"+y+"'"+returnInstanceXP(t,!0,!0,!1,!0)+")",l+=" or (@SourceType='ViewField' and @SourceID ='"+y+"'"+returnInstanceXP(t,!0,!0,!1,!1)+")");h+="]";l+="]";break;case"source":h+=".//Item[@SourceType='"+q+"' and translate(@SourceID, 'ABCDEFGHIJKLMNOPQRSTUVWXYZ', 'abcdefghijklmnopqrstuvwxyz') = '"+r.toLowerCase()+"'"+returnInstanceXP(t,!0,!0,!1,!0)+"]";l+=".//Item[@SourceType='"+q+"' and translate(@SourceID, 'ABCDEFGHIJKLMNOPQRSTUVWXYZ', 'abcdefghijklmnopqrstuvwxyz') = '"+r.toLowerCase()+"'"+returnInstanceXP(t,!0,!0,!1,!1)+"]";break;case"expression":h+="@ID='"+f+"'";l+="@ID='"+f+"'"}k+=checkExists(t)?"[(@InstanceID='"+t+"' and ("+l+")) or ("+h+")]":"["+h+"]";s=$mn(viewControllerDefinition,k);_runtimeUpdateCalculatedControlsHash.add(b,s)}for(var p=s.length;p--;)refreshAllRelatedExpressions(s[p].getAttribute("ID"),s[p],t,u,e,o);fireExpressions()}}function fireExpressions(n){evaluatingExpressions.length>0&&(n?(expressionBusy=!0,runAllRelatedExpressions()):expressionBusy||(expressionBusy=!0,setTimeout(function(){runAllRelatedExpressions()},0)))}function refreshAllRelatedExpressions(n,t,q,r,u,f){checkExistsNotEmpty(f)||(f=_runtimeEmptyGuid);var e=[n,q,f];if(!expressionHash.get(e)){expressionHash.add(e,!0);var o={ExpressionID:n,Expression:t,InstanceID:q,isInit:r,editRowOnly:u,loopContextID:f};evaluatingExpressions.push(o)}}function runAllRelatedExpressions(){var q=!1;if(evaluatingExpressions.length>0){while(evaluatingExpressions.length>0&&!q){q=!0;var n=evaluatingExpressions.shift(),r=n.ExpressionID,s=n.Expression,u=n.InstanceID,h=n.isInit,c=n.editRowOnly,t=n.loopContextID,l=[r,u,t];expressionHash.remove(l);t===_runtimeEmptyGuid&&(t=null);var f="Controllers/Controller"+returnInstanceXP(u,!1,!1,!0)+"/Controls/Control[@ExpressionID='"+r+"'][Properties/Property/Name/text()='SetValue']";c&&(f+="[(@ControlTemplate='edit')]");for(var e=$mn(viewControllerDefinition,f),o=e.length;o--;)updateControlWithCalculatedResults(e[o],s,null,h,t);updateCalculatedControls(null,u,"Expression",r,null,null,null,t);q=!1}simpleListCache.length>0&&updateAllListDisplays(t)}expressionBusy=!1}function updateCalculatedControlsForSource(n,t,q){var f=returnInstanceXP(n,!1,!1,!0),e="Controllers/Expressions/Expression"+f,u=$mn(viewControllerDefinition,e),r=u.length;if(r>0)while(r--){var o=u[r].getAttribute("ID");updateCalculatedControls(null,n,null,null,t,o,null,q)}}function updateControlWithCalculatedResults(n,t,q,r,u){var e=n.getAttribute("ID");if(verifyRecalculationBasedOnTemplate(n,r)===!0){var f=returnCalculatedValue(e,t,null,null,u);if(checkExists(f)){f=f.toString();var o=new PopulateObject(null,f,e);executeControlFunction(n,"SetValue",o)}}}function returnCalculationResultForControl(n,t,q,r){var u=n.getAttribute("ExpressionID"),f="Controllers/Expressions/Expression[@ID='"+u+"']"+returnInstanceXP(q,!1,!1,!0),e=$sn(viewControllerDefinition,f);return returnCalculatedValue(n.getAttribute("ID"),e,t,null,r)}function returnCalculatedValue(n,t,q,r,u,f){var o=!1;checkExists(f)&&f.preserveType===!0&&(o=!0);var e=null;if(r){var s=t.getAttribute("InstanceID");return evaluateSummaryFields(t,r,s,u)}return e=returnCalculatedItemValue(t,q,n,u),runtimeIsDateType(e)&&o===!1&&(e=getDateInCorrectFormat(e)),e}function returnSummaryResults(n,t){var q=null,u=n.length;switch(t){case"SUM":q=getSum(n);break;case"AVG":case"AVERAGE":q=getAverage(n);break;case"COUNT":q=u;break;case"MIN":case"MINIMUM":q=getMinimum(n);break;case"MAX":case"MAXIMUM":q=getMaximum(n)}if(checkExists(q))if(runtimeIsDateType(q))q=getDateInCorrectFormat(q);else{var r=q.toString();r.length===0?q=0:(r.isNumeric()||r.isFloat())&&(q=r.toFloat())}return q}function returnCalculatedItemValue(n,t,q,r){var u=0,f=n.getAttribute("InstanceID");if(n.tagName==="Expression"){var e=n.firstChild,o=n.getAttribute("ID");u=evaluateExpression(e,t,q,!1,f,o,r)}else n.tagName!=="Item"&&(n.childNodes.length>0&&n.childNodes[0].tagName==="Item"?n=n.childNodes[0]:n.parentNode.tagName==="Item"&&(n=n.parentNode),u=returnItemValue(n,t,q,f,r));return u}function evaluateSummaryFields(n,t,q,r){var f=0,h=n.firstChild.getAttribute("SourceType"),u;switch(h){case"Control":u="Controllers/Controller[Controls/Control[@ID='"+n.firstChild.getAttribute("SourceID")+"']]";break;case"ViewField":u="Controllers/Controller"+returnInstanceXP(q,!1,!1,!0)+"[Fields/Field[@ID='"+n.firstChild.getAttribute("SourceID")+"']]";break;case"Value":f=t==="Count"?1:$sn(n.firstChild,"SourceValue").text}if(checkExists(u)&&u.length>0){var e=$sn(viewControllerDefinition,u);if(checkExists(e)){var w=e.getAttribute("MainTable"),b=e.getAttribute("TypeView"),o=SFRGrid.execute({id:w,fn:"fetch",params:["rows"]}),k=checkExists(o)?o.length:0;if(h==="Control"){var c=_runtimeControllerFindObject({controlID:n.firstChild.getAttribute("SourceID")}),l=c.getAttribute("FieldID"),a=c.getAttribute("ExpressionID");checkExists(l)?(n.firstChild.setAttribute("SourceType","ViewField"),n.firstChild.setAttribute("SourceID",l)):checkExists(a)&&(n.firstChild.setAttribute("SourceType","Expression"),n.firstChild.setAttribute("SourceID",a))}var s=k;if(b.toLowerCase()==="list"&&s>0){for(var v=[];s--;){var y=jQuery(jQuery(o[s]).children("td")[0]).metadata().counter;if(checkExists(y)){var p=returnCalculatedValue(null,n,y,null,r,{preserveType:!0});checkExists(p)&&v.push(p)}}f=returnSummaryResults(v,t.toUpperCase())}}}return f}function updateControlsUsingSummaries(n,t){var r=checkExists(n)?"//Item[@SourceInstanceID='"+n+"']":"",q="Controllers/Expressions/Expression[";q+="((.//ListSum"+r+") or (.//ListCount"+r+") or (.//ListAverage"+r+") or (.//ListMinimum"+r+") or (.//ListMaximum"+r+"))";checkExists(n)&&(q+=" or ("+returnInstanceXP(n,!1,!1,!1,!0),q+=" and ((.//ListSum) or (.//ListCount) or (.//ListAverage) or (.//ListMinimum) or (.//ListMaximum))",q+=")");q+="]";for(var u=$mn(viewControllerDefinition,q),f=u.length;f--;)refreshAllRelatedExpressions(u[f].getAttribute("ID"),u[f],n,null,null,t);fireExpressions()}function verifyRecalculationBasedOnTemplate(n,t){var f=!0,q=n.getAttribute("ControlTemplate"),r=n.parentNode.parentNode.getAttribute("MainTable");if(checkExists(q)&&checkExists(r)&&(q==="display"||q==="edit")){var e=document.getElementById(r);if(checkExists(e)){var u=e.getAttribute("editable");switch(q){case"display":f=!1;var o=e.getAttribute("maxcounter");checkExists(o)&&(checkExists(u)&&u!=="false"?editableListCache.push(r):simpleListCache.push(r));break;case"edit":checkExists(u)&&u!=="false"||t||(f=!1)}}}return f};
/*!
 ~/RunTime/Script/StyleProfileDesigner.js
*/
function applyStyleProfile(n,t,q){replaceStyleProfileStyle(n);replaceStyleProfileCss(t);replaceStyleProfileJs(q)}function replaceStyleProfileJs(n){Array.isArray(n)&&($("body").find(".external-js").remove(),n.forEach(n=>{n.isDisabled||$("body").append('<script type="text/javascript" src="'+decodeURIComponent(n.url)+'" class="external-js"><\/script>')}))}function replaceStyleProfileCss(n){Array.isArray(n)&&($("head").find(".external-css").remove(),n.forEach(n=>{n.isDisabled||$("head").append('<link rel="stylesheet" href="'+decodeURIComponent(n.url)+'" class="external-css" />')}))}function replaceStyleProfileStyle(n){if(n){let t=$("#style-profile-style");t.length>0?t.replaceWith('<style id="style-profile-style">'+n+"<\/style>"):$("head").append('<style id="style-profile-style">'+n+"<\/style>")}}function applySubformStyleProfile(n,t,q,r){for(var u=0;u<n.length;u++)typeof n[u].applyStyleProfile=="function"&&n[u].applyStyleProfile(t,q,r)}function applySubviewStyleProfile(n,t,q,r){for(var u=0;u<n.length;u++)typeof n[u].applyStyleProfile=="function"&&n[u].applyStyleProfile(t,q,r)};
/*!
 ~/Script/jquery.forms.controls.form.js
*/
(function(n){(typeof SourceCode=="undefined"||SourceCode===null)&&(SourceCode={});(typeof SourceCode.Forms=="undefined"||SourceCode.Forms===null)&&(SourceCode.Forms={});(typeof SourceCode.Forms.Controls=="undefined"||SourceCode.Forms.Controls===null)&&(SourceCode.Forms.Controls={});(typeof SourceCode.Forms.Controls.Form=="undefined"||SourceCode.Forms.Controls.Form===null)&&(SourceCode.Forms.Controls.Form={});function t(t){typeof addRuntimePendingCalls=="function"?addRuntimePendingCalls(t):n(document).ready(t)}t(function(){if(checkExists(SourceCode.Forms.Controls.Base)&&checkExists(SourceCode.Forms.Controls.Base.ControlType)){var t;SourceCode.Forms.Controls.Form=t=n.extend({},SourceCode.Forms.Controls.Base.ControlType,{_styleXPaths:{width:"Styles/Style/Width",backgroundColor:"Styles/Style/BackgroundColor",borderColor:"Styles/Style/Border/Default/Color",borderWidth:"Styles/Style/Border/Default/Width",borderStyle:"Styles/Style/Border/Default/Style",padding:"Styles/Style/Padding/Default"},_getInstance:function(t){var r=t.substr(37),q=n("#{0}, #{0}_tabbox".format(r))[0];return checkExists(q)?n(q):null},getProperty:function(n){var q=t._getInstance(n.CurrentControlId),r=q.SFCForm("option",n.property);if(r!==q)return r},setProperty:function(n){var q=t._getInstance(n.CurrentControlId);q.SFCForm("option",n.property,n.Value)},designerPropertyResolver:function(n){n.value=n.resolveDirection==="TO-PROPERTY-UI"?n.value==="OVERLAYBUSY"?"true":"false":n.value==="true"?"OVERLAYBUSY":"NONE"},saveState:function(n){var q=t._getInstance(n.CurrentControlId),r=q.SFCForm("saveState");if(r!==q)return r},loadState:function(n){var q=t._getInstance(n.CurrentControlId);q.SFCForm("loadState",n.Value)},manageControlEvent:function(n){EventUtil.manageControlEvent(n)}});n.widget("sfc.SFCForm",n.sfc.baseWidget,{options:{width:"",minWidth:"",maxWidth:"",id:"",baseId:"",previous:{},backgroundColor:"",canMapStyles:!0,isVisible:!0,hasDisableOverlay:!1,padding:"",style:parseXML(SourceCode.Forms.Controls.Base.emptyStylesNode),title:document.title},_create:function(){this.options.canMapStyles=!0;this.options.id=this.element[0].getAttribute("id");this.options.baseId=this.options.id.substring(0,this.options.id.indexOf("_"));this.options.controllerControlId="00000000-0000-0000-0000-000000000000_"+this.options.id;this.workflowStrip=n("#WorkflowStrip");this.workflowStripExists=this.workflowStrip.length>0;this.viewDefinitionControlPropertiesXPath="Controllers/Controller/Controls/Control[@ID='"+this.options.controllerControlId+"']/Properties";this.base._create.apply(this,arguments);this.element[0].style.display==="none"&&(this.options.isVisible=!1,SFLog({type:1,source:"SFCForm",category:"Init",message:"Form is hidden"}))},_setOption:function(q,r){if(typeof this._optionValueConverter=="function"&&(r=this._optionValueConverter(q,r)),typeof this._optionNameTransformer=="function"&&(q=this._optionNameTransformer(q)),typeof this.options.previous!="undefined"&&(this.options.previous[q]=this.options[q]),n.Widget.prototype._setOption.apply(this,arguments),q.toLowerCase()==="style"){if(this.options.canMapStyles===!0)this.options.canMapStyles=!1;else if(this.options.style!==this.options.previous.style&&this._checkStyleChanged()){var f=this.options.style.selectSingleNode(t._styleXPaths.width);checkExists(f)&&(this.options.width=f.text);var e=this.options.style.selectSingleNode(t._styleXPaths.backgroundColor);checkExists(e)&&(this.options.backgroundColor=e.text);var o=this.options.style.selectSingleNode(t._styleXPaths.borderColor);checkExists(o)&&(this.options.borderColor=o.text);var s=this.options.style.selectSingleNode(t._styleXPaths.borderWidth);checkExists(s)&&(this.options.borderWidth=s.text);var h=this.options.style.selectSingleNode(t._styleXPaths.borderStyle);checkExists(h)&&(this.options.borderStyle=h.text);var c=this.options.style.selectSingleNode(t._styleXPaths.padding);checkExists(c)&&(this.options.padding=c.text)}}else this.options.padding!==this.options.previous.padding&&(this._setStyleNodeValue(this.options.style,t._styleXPaths.padding,this.options.padding),this._setStyleNodeValue(viewControllerDefinition,this.viewDefinitionControlPropertiesXPath+t._styleXPaths.padding,this.options.padding)),this.options.width!==this.options.previous.width&&(this._setStyleNodeValue(this.options.style,t._styleXPaths.width,this.options.width),this._setStyleNodeValue(viewControllerDefinition,this.viewDefinitionControlPropertiesXPath+t._styleXPaths.width,this.options.width)),this.options.backgroundColor!==this.options.previous.backgroundColor&&(this._setStyleNodeValue(this.options.style,t._styleXPaths.backgroundColor,this.options.backgroundColor),this._setStyleNodeValue(viewControllerDefinition,this.viewDefinitionControlPropertiesXPath+t._styleXPaths.backgroundColor,this.options.backgroundColor)),this.options.borderColor!==this.options.previous.borderColor&&(this._setStyleNodeValue(this.options.style,t._styleXPaths.borderColor,this.options.borderColor),this._setStyleNodeValue(viewControllerDefinition,this.viewDefinitionControlPropertiesXPath+t._styleXPaths.borderColor,this.options.borderColor)),this.options.borderWidth!==this.options.previous.borderWidth&&(this._setStyleNodeValue(this.options.style,t._styleXPaths.borderWidth,this.options.borderWidth),this._setStyleNodeValue(viewControllerDefinition,this.viewDefinitionControlPropertiesXPath+t._styleXPaths.borderWidth,this.options.borderWidth));if(typeof this.options.previous=="undefined"||this.options.previous[q]!==this.options[q]){var u=!1;this.options.isEnabled!==!1&&this.options.isParentEnabled!==!1||this.options.disabled!==!1&&checkExists(this.options.disabled)?this.options.isEnabled!==!0||this.options.isParentEnabled!==!0||this.options.disabled!==!0&&checkExists(this.options.disabled)||(this.option("disabled",!1),u=!0):(this.option("disabled",!0),u=!0);this.options.setOptions?this.options.setOptionsOptionChanged=!0:(u||(this.options.previous.style=this.options.style,this.applyChanges()),typeof this.options.previous!="undefined"&&(this.options.previous[q]=this.options[q]))}return this},applyChanges:function(){if(this.options.title!==this.options.previous.title&&(document.title=checkExistsNotEmpty(this.options.title)?this.options.title:this._getControlName()),this.options.isVisible!==this.options.previous.isVisible&&(this._setAllChildControlsProperties("isParentVisible",this.options.isVisible,!0),this.options.isVisible===!1?this.element.hide():this.element.show()),this.options.isEnabled!==this.options.previous.isEnabled&&this._setAllChildControlsProperties("isParentEnabled",this.options.isEnabled,!0),this.options.hasDisableOverlay!==this.options.previous.hasDisableOverlay&&(this.options.hasDisableOverlay===!0?runtimeModalizer.show(!1,null,"formmodal",!0):runtimeModalizer.hide("formmodal")),this.options.isReadOnly!==this.options.previous.isReadOnly&&this._setAllChildControlsProperties("isParentReadOnly",this.options.isReadOnly),this.options.padding!==this.options.previous.padding){if(this.element.hasClass("tab-box"))for(var q=this.element.find(".form"),n=0;n<q.length;n++)q[n].style.padding=this._convertWidthValue(this.options.padding);else this.element[0].style.padding=this._convertWidthValue(this.options.padding);refreshFormPadding({newPadding:this.options.padding})}if(this.options.width!==this.options.previous.width&&(this.element.parent()[0].style.width=this._convertWidthValue(this.options.width),this.workflowStripExists&&(this.workflowStrip[0].style.width=this._convertWidthValue(this.options.width))),this.options.minWidth!==this.options.previous.minWidth&&(this.element.parent()[0].style.minWidth=this._convertWidthValue(this.options.minWidth),this.workflowStripExists&&(this.workflowStrip[0].style.minWidth=this.options.minWidth)),this.options.maxWidth!==this.options.previous.maxWidth&&(this.element.parent()[0].style.maxWidth=this._convertWidthValue(this.options.maxWidth),this.workflowStripExists&&(this.workflowStrip[0].style.maxWidth=this.options.maxWidth)),this.options.backgroundColor!==this.options.previous.backgroundColor)if(this.element.hasClass("tab-box"))for(var r=this.element.find("#{0}_tabbody, #{0}_tabPanel .tab-wrapper".format(this.options.baseId)),t=0;t<r.length;t++)r[t].style.backgroundColor=this.options.backgroundColor;else this.element[0].style.backgroundColor=this.options.backgroundColor;this.options.borderColor!==this.options.previous.borderColor&&(document.body.style.backgroundColor=this.options.borderColor);this.options.borderWidth!==this.options.previous.borderWidth&&(this.element.parent().parent()[0].style.margin=this._convertWidthValue(this.options.borderWidth));this.base.applyChanges.apply(this,arguments)},_getControlName:function(){var n=$sn(viewControllerDefinition,this.viewDefinitionControlPropertiesXPath+"/Property[Name = 'ControlName']/Value");return checkExists(n)?n.text:null},_convertWidthValue:function(n){return n.indexOf("px")>=0||n.indexOf("%")>=0?n:n+"px"},_setAllChildControlsProperties:function(n,t,q){for(var r=this._getFormControls(q),u=r.length;u--;){var f=r[u],e=f.getAttribute("ID");if(e!==this.options.controllerControlId){var o=new PopulateObject(null,t,e,n);executeControlFunction(f,"SetProperty",o)}}},_getFormControls:function(n){var t="Controllers/Controller/Controls/Control";return n===!0&&(t="Controllers/Controller[@TypeView='']/Controls/Control"),viewControllerDefinition.selectNodes(t)},_setStyleNodeValue:function(n,t,q){var r=n.selectSingleNode(t);if(checkExists(r)){r.childNodes.length>0&&r.removeChild(r.childNodes[0]);var u=n.createTextNode(q);r.appendChild(u)}},_optionValueConverter:function(n,t){n=n.toLowerCase();switch(n){case"isvisible":case"isparentvisible":case"isenabled":case"isparentenabled":case"hasdisableoverlay":case"canmapstyles":t=this._booleanConverter(t);break;case"styles":case"style":t=this._stylesConverter(t);break;default:t=this.base._optionValueConverter(n,t)}return t},_optionNameTransformer:function(n){var q=n.toLowerCase(),t=null;switch(q){case"padding":t="padding";break;case"width":t="width";break;case"style":t="style";break;case"minwidth":t="minWidth";break;case"maxwidth":t="maxWidth";break;case"backgroundcolor":t="backgroundColor";break;case"bordercolor":t="borderColor";break;case"borderwidth":t="borderWidth";break;case"hasdisableoverlay":t="hasDisableOverlay";break;case"canmapstyles":t="canMapStyles";break;default:t=this.base._optionNameTransformer(q)}return t},_isSerializableProperty:function(n,t){return{canMapStyles:!0,isVisible:!0,hasDisableOverlay:!0,isEnabled:!0,isReadOnly:!0,title:!0,width:!0,minWidth:!0,maxWidth:!0,padding:!0,borderWidth:!0,borderColor:!0,backgroundColor:!0,style:!0}[n]===!0||this.base._isSerializableProperty(n,t)},saveState:function(){var n=this.base.saveState.apply(this,arguments);return checkExists(n.style)&&delete n.style,checkExists(this.options.style)&&(n.style=this.options.style.xml),n}});n.sfc.SFCForm.prototype.base=n.sfc.baseWidget.prototype;n(".form, .tab-box.tabs-top").each(function(t,q){n(q).SFCForm()})}})})($);
/*!
 ~/Script/jquery.forms.controls.areaItem.js
*/
(function(n){(typeof SourceCode=="undefined"||SourceCode===null)&&(SourceCode={});(typeof SourceCode.Forms=="undefined"||SourceCode.Forms===null)&&(SourceCode.Forms={});(typeof SourceCode.Forms.Controls=="undefined"||SourceCode.Forms.Controls===null)&&(SourceCode.Forms.Controls={});(typeof SourceCode.Forms.Controls.AreaItem=="undefined"||SourceCode.Forms.Controls.AreaItem===null)&&(SourceCode.Forms.Controls.AreaItem={});function t(t){typeof addRuntimePendingCalls=="function"?addRuntimePendingCalls(t):n(document).ready(t)}t(function(){if(checkExists(SourceCode.Forms.Controls.Base)&&checkExists(SourceCode.Forms.Controls.Base.ControlType)){var t;SourceCode.Forms.Controls.AreaItem=t=n.extend({},SourceCode.Forms.Controls.Base.ControlType,{_getInstance:function(t){var r=t.split("_");t=r[r.length-1];checkExists(this._areaItemsHash)||(this._areaItemsHash=new SFRuntimeHash);var q=this._areaItemsHash.get(t);if(!checkExists(q)){if(q=n("[data-areaItemId='"+t+"']"),q.length===0)return null;this._areaItemsHash.add(t,q)}return q},getProperty:function(n){var q=t._getInstance(n.CurrentControlId),r=q.SFCAreaItem("option",n.property);if(r!==q)return r},setProperty:function(n){t._getInstance(n.CurrentControlId).SFCAreaItem("option",n.property,n.Value)},saveState:function(n){var q=t._getInstance(n.CurrentControlId),r=q.SFCAreaItem("saveState");if(r!==q)return r},loadState:function(n){t._getInstance(n.CurrentControlId).SFCAreaItem("loadState",n.Value)}});n.widget("sfc.SFCAreaItem",n.sfc.baseWidget,{options:{fullId:"",previous:{},isVisible:!0,isEnabled:!0,title:"",id:"",tabIndex:0,isCollapsible:!0,headerHtml:"",viewType:"item",headerSelector:"",headerTextSelector:"",controlName:"",defaultCollapsed:!1,width:null,height:null},_create:function(){this.options.fullId=this.element[0].getAttribute("id");var t=this.options.fullId.split("_");this.options.id=t[t.length-2];this.options.viewId=t[t.length-1];this.options.tabIndex=this.element[0].getAttribute("tabIndex");this.options.tabIndex===null&&(this.options.tabIndex=0);this.element.hasClass("panel")?(this.options.viewType="item",this.options.headerSelector=".panel-header",this.options.headerTextSelector=".panel-header-text",this.options.headerHtml='<div class="panel-header">\t\t\t\t\t\t\t\t\t<div class="panel-header-l">\t\t\t\t\t\t\t\t\t<\/div><div class="panel-header-c">\t\t\t\t\t\t\t\t\t\t<div class="panel-header-wrapper">\t\t\t\t\t\t\t\t\t\t\t<div class="panel-header-text"><span data-sf-title="{0}">{1}<\/span>\t\t\t\t\t\t\t\t\t\t\t<\/div><div class="panel-header-controls"> \t\t\t\t\t\t\t\t\t\t\t\t<a href="javascript:;" class="collapse-vertical" tabindex="'+this.options.tabIndex+'"><span><\/span><\/a> \t\t\t\t\t\t\t\t\t\t\t<\/div> \t\t\t\t\t\t\t\t\t\t<\/div> \t\t\t\t\t\t\t\t\t<\/div><div class="panel-header-r"> \t\t\t\t\t\t\t\t\t<\/div> \t\t\t\t\t\t\t\t<\/div>'):this.element.hasClass("grid")?(this.options.viewType="list",this.options.headerSelector=".grid-header",this.options.headerTextSelector=".grid-header-text",this.options.headerHtml='<div class="grid-header">\t\t\t\t\t\t\t\t\t\t\t\t\t<div class="grid-header-wrapper">\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div class="grid-header-text"><span data-sf-title="{0}">{1}<\/span>\t\t\t\t\t\t\t\t\t\t\t\t\t\t<\/div><div class="grid-header-controls">\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<a href="javascript:;" class="collapse-vertical" tabindex="'+this.options.tabIndex+'"><span><\/span><\/a>\t\t\t\t\t\t\t\t\t\t\t\t\t\t<\/div>\t\t\t\t\t\t\t\t\t\t\t\t\t<\/div>\t\t\t\t\t\t\t\t\t\t\t\t<\/div>'):this.options.viewType="unknown";var r=this.element.find(".collapse-vertical, .collapse-horizontal, .expand-vertical, .expand-horizontal");this.options.isCollapsible=r.length>0&&r[0].style.display!=="none";this.options.controlName=this.element[0].getAttribute("name");this.options.defaultCollapsed=this.element.hasClass("collapsed");this.options.isExpanded=!this.options.defaultCollapsed;this.options.isVisible=!this.element.hasClass("hidden");this.options.isEnabled=!this.element.hasClass("disabled");var q=this.element.find(".grid-header-text > span, .panel-header-text > span").eq(0),u="";checkExists(q)&&q.length>0&&(u=q[0].getAttribute("data-sf-title"));this.options.title=u;this.options.previous=n.extend({},this.options);this.base._create.apply(this,arguments);this._applyHeaderClickHandler()},_setOption:function(n,t){if(n.toLowerCase()==="display"){var q=t.toLowerCase();switch(q){case"show":n="isvisible";t=!0;break;case"hide":n="isvisible";t=!1;break;case"enable":n="isenabled";t=!0;break;case"disable":n="isenabled";t=!1;break;case"collapse":n="isexpanded";t=!1;break;case"expand":n="isexpanded";t=!0}}return this.base._setOption.apply(this,[n,t])},applyChanges:function(){var q;if(checkExists(this.options.filterdisplay)&&this.options.filterdisplay!==this.options.previous.filterdisplay&&this.options.viewType==="list"){var f=n("#"+this.options.fullId).grid("fetch","toolbars").length-1;if(f>-1){var u=n("#"+this.options.fullId).grid("fetch","toolbars")[0].children.length-1;switch(this.options.filterdisplay.toLowerCase()){case"show":n("#"+this.options.fullId).grid("unhide","toolbar",u);break;case"hide":n("#"+this.options.fullId).grid("hide","toolbar",u)}}}if(this.options.title!==this.options.previous.title){q=this.element.find(this.options.headerSelector).eq(0);var t="";this.options.title!==""?q.length===0?(q=this.element.prepend(this.options.headerHtml.format(this.options.title,this.options.title)),this.element.removeClass("without-header").addClass("with-header"),this.options.isCollapsible===!1&&this.element.find(".collapse-vertical, .collapse-horizontal").hide()):(t=q.find(".panel-header-text > span"),this.options.viewType==="list"&&(t=q.find(".grid-header-text > span")),checkExists(t)&&t.length>0&&(n(t[0]).text(this.options.title).show(),n(t[0]).attr("data-sf-title",this.options.title))):(t=q.find(".panel-header-text > span"),this.options.viewType==="list"&&(t=q.find(".grid-header-text > span")),checkExists(t)&&t.length>0&&(n(t[0]).text(this.options.title),n(t[0]).attr("data-sf-title",this.options.title)),this.options.isCollapsible===!1&&(this.element.find(this.options.headerSelector).eq(0).remove(),this.element.removeClass("with-header").addClass("without-header")))}if(this.options.isEnabled!==this.options.previous.isEnabled||this.options.isParentEnabled!==this.options.previous.isParentEnabled){var r=this.options.isEnabled===!0&&this.options.isParentEnabled===!0;this._setAllChildControlsProperties("isParentEnabled",r);r?this.element.find(".filterContainer").prop("disabled",!1).find("*").prop("disabled",!1).removeClass("disabled"):this.element.find(".filterContainer").prop("disabled",!0).find("*").prop("disabled",!0).addClass("disabled");this.options.viewType==="list"&&populateListFilterEvents(this.options.fullId,!r)}if(this.options.isCollapsible!==this.options.previous.isCollapsible)if(this.options.isCollapsible===!0){q=this.element.find(this.options.headerSelector).eq(0);q.length===0&&(q=this.element.prepend(this.options.headerHtml.format(this.options.title,this.options.title)),this.element.removeClass("without-header").addClass("with-header"));var e=this.element.find(".collapse-vertical, .collapse-horizontal, .expand-vertical, .expand-horizontal").show();this.options.isExpanded||e.removeClass("collapse-vertical").addClass("expand-vertical");this._applyHeaderClickHandler(q)}else this.options.title===""&&(this.element.find(this.options.headerSelector).eq(0).remove(),this.element.removeClass("with-header").addClass("without-header")),this.element.find(".collapse-vertical, .collapse-horizontal, .expand-vertical, .expand-horizontal").hide();this.options.isExpanded!==this.options.previous.isExpanded&&(this.options.defaultCollapsed=this.options.previous.defaultCollapsed=!this.options.isExpanded,this.options.previous.isExpanded=this.options.isExpanded,this.options.isExpanded===!0?this.options.viewType==="list"?this.element.grid("expand"):this.element.panel("expand"):this.options.viewType==="list"?this.element.grid("collapse"):this.element.panel("collapse"));this.options.defaultCollapsed!==this.options.previous.defaultCollapsed&&(this.options.isExpanded=this.options.previous.isExpanded=!this.options.defaultCollapsed,this.options.previous.defaultCollapsed=this.options.defaultCollapsed,this.options.defaultCollapsed===!0?this.options.viewType==="list"?this.element.grid("collapse",!1):this.element.panel("collapse",!1):this.options.viewType==="list"?this.element.grid("expand",!1):this.element.panel("expand",!1));this.base.applyChanges.apply(this,arguments);(this.options.isVisible!==this.options.previous.isVisible||this.options.isParentVisible!==this.options.previous.isParentVisible||this.options.defaultCollapsed!==this.options.previous.defaultCollapsed||this.options.isExpanded!==this.options.previous.isExpanded)&&(refreshFormPadding({panelID:this.options.fullId}),this.options.viewType==="list"&&(this.element.grid("runtimeSyncColumns"),this.element.grid("synccolumns")),this._setAllChildControlsProperties("isParentVisible",this.options.isVisible&&this.options.isParentVisible))},_applyHeaderClickHandler:function(t){if(checkExists(t)&&t.length!==0||(t=this.element.find(this.options.headerSelector).eq(0),t.length!==0)){var q=this;n("a",t).off("click").on("click",function(n){q.options.isExpanded===!0?q.options.isExpanded=!1:q.options.isExpanded===!1&&(q.options.isExpanded=!0);n.stopPropagation();q.applyChanges()})}},_optionValueConverter:function(n,t){n=n.toLowerCase();switch(n){case"defaultcollapsed":case"iscollapsible":t=this._booleanConverter(t);break;default:t=this.base._optionValueConverter(n,t)}return t},_optionNameTransformer:function(n){var q=n.toLowerCase(),t=null;switch(q){case"title":t="title";break;case"iscollapsible":t="isCollapsible";break;case"defaultcollapsed":t="defaultCollapsed";break;case"isexpanded":t="isExpanded";break;case"controlname":t="controlName";break;case"width":checkExists(this.element)&&(this.options.width=this.element.width());t="width";break;case"height":checkExists(this.element)&&(this.options.height=this.element.height());t="height";break;default:t=this.base._optionNameTransformer(q)}return t},_setAllChildControlsProperties:function(n,t){for(var q=this._getControls(),r=q.length;r--;){var u=q[r],f=u.getAttribute("ID"),e=new PopulateObject(null,t,f,n);executeControlFunction(u,"SetProperty",e)}},_getControls:function(){if(!checkExists(this.options.childControlNodes)){this.options.childControlNodes=[];var q=viewControllerDefinition.selectSingleNode("Controllers/Controller[@MainTable='{0}']".format(this.options.fullId)),p=q.getAttribute("TypeView").toUpperCase();if(p==="LIST")this.options.childControlNodes=q.selectNodes("Controls/Control");else{for(var o=this.element.find("table"),s=".SourceCode-Forms-Controls-Web-Table",l=this.element.find(s),r=0;r<l.length;r++)o.push(l[r]);for(var a=o.length;a--;){var h=o[a],c=n(h);if(c.parent().closest("table").length===0&&c.parent().closest(s).length===0){var u=h.id;if(u.indexOf("_Table")<0){var v=c.find("*[id]"),y=[];for(r=v.length;r--;){var f=v[r],w=n(f),e="";if(f.id.length>=73&&n(f).parent().closest(s).length===0&&(e=f.id.substring(0,73),y.indexOf(e)<0&&f.id.indexOf("rtSearchConfig")===-1&&f.id.indexOf("ClientState")===-1)){for(var t=w.parent().closest("table");t.length>0&&t[0].id!==u&&t[0].id.indexOf("_Table")!==73;)t=t.parent().closest("table");t.length>0&&t[0].id===u&&checkExistsNotEmpty(q.selectSingleNode("Controls/Control[@ID='{0}']".format(e)))&&(this.options.childControlNodes.push(q.selectSingleNode("Controls/Control[@ID='{0}']".format(e))),y.push(e))}}}else u=h.id.replace("_Table",""),checkExistsNotEmpty(q.selectSingleNode("Controls/Control[@ID='{0}']".format(u)))&&this.options.childControlNodes.push(q.selectSingleNode("Controls/Control[@ID='{0}']".format(u)))}}}}return this.options.childControlNodes},_isSerializableProperty:function(n,t){return{title:!0,isCollapsible:!0,defaultCollapsed:!0}[n]===!0||this.base._isSerializableProperty(n,t)},_getFilterControlPrefixId:function(){return(this.options.id!==""?this.options.id+"_":_runtimeEmptyGuid+"_")+this.options.viewId},_saveViewFilterToolbarStateData:function(){var t={},q=this._getFilterControlPrefixId();if(checkExists(this.options.viewId)){var r=document.getElementById(q+"_selectedFilterDdl");if(checkExists(r)){var u=n(r).dropdown().dropdown("SelectedValue");checkExistsNotEmpty(u)&&(t.selectedFilter=u)}var f=document.getElementById(q+"_quickSearchTxt");checkExists(f)&&(t.filterValue=f.value);var e=document.getElementById(q+"_quickSearchDdl");if(checkExists(e)){var o=n(e).dropdown().dropdown("SelectedValue");checkExistsNotEmpty(o)&&(t.fieldID=o)}}return Object.keys(t).length===0&&(t=null),t},_loadViewFilterToolbarStateData:function(t){if(checkExists(t)){var q=this._getFilterControlPrefixId();if(checkExists(t.selectedFilter)){var r=document.getElementById(q+"_selectedFilterDdl");checkExists(r)&&n(r).dropdown().dropdown("SelectedValue",t.selectedFilter)}if(checkExists(t.filterValue)){var u=document.getElementById(q+"_quickSearchTxt");checkExists(u)&&(u.value=t.filterValue)}if(checkExists(t.fieldID)){var f=document.getElementById(q+"_quickSearchDdl");checkExists(f)&&n(f).dropdown().dropdown("SelectedValue",t.fieldID)}}},loadState:function(n){var t={};for(name in n)this._isSerializableProperty(name,n)&&(t[name]=n[name]);this.option(t);this.options.viewType==="list"&&n.grid&&(SFRGrid.execute({element:this.element,fn:"loadState",params:[n.grid.stateData]}),SFR._applyGridAttributesFromDraft({windowToUse:window,gridElement:this.element,attributes:n.grid.attributes}),SFR._applyGridRowsFromDraft({windowToUse:window,gridId:this.options.fullId,viewId:this.options.viewId,instanceId:this.options.id}),this._loadViewFilterToolbarStateData(n.grid.filterToolbarData))},saveState:function(){var n=this._cloneSerializableOptions();if(this.options.viewType==="list"){n.grid={};n.grid.attributes=SFR._getSerializedGridAttributes({gridElement:this.element});n.grid.stateData=SFRGrid.execute({element:this.element,fn:"saveState"});var t=this._saveViewFilterToolbarStateData();checkExists(t)&&(n.grid.filterToolbarData=t)}return n}});n.sfc.SFCAreaItem.prototype.base=n.sfc.baseWidget.prototype;n(".view>.innerpanel>.panel, .view>.innerpanel>.grid, .runtime-content>.panel, .runtime-content>.grid").each(function(t,q){n(q).SFCAreaItem()})}})})($);
/*!
 ~/RunTime/Script/MobileBridge.js
*/
(function(n){if((typeof SourceCode=="undefined"||SourceCode===null)&&(SourceCode={}),(typeof SourceCode.Forms=="undefined"||SourceCode.Forms===null)&&(SourceCode.Forms={}),(typeof SourceCode.Forms.Runtime=="undefined"||SourceCode.Forms.Runtime===null)&&(SourceCode.Forms.Runtime={}),typeof SourceCode.Forms.Runtime.MobileBridge=="undefined"||SourceCode.Forms.Runtime.MobileBridge===null){var t={ControlSupportedMethods:"supportedMethods",Barcode:"barcode",AnnotateImage:"annotateImage",LoadDraft:"loadDraft",SaveDraft:"saveDraft",RenewSession:"renewSession",TaskActioned:"taskActioned",FormSubmit:"formSubmit",FormSubmitted:"formSubmitted",FormHandlesSubmit:"formHandlesSubmit",PerformSubmit:"performSubmit",DownloadFile:"downloadFile",GetAvailableMemory:"getAvailableMemory"},r="mobileBridgeFrame",q=function(){this._hasCheckedSupport=!1;this._hasRequestedSupportedMethods=!1;this._supportedMethods={};this._supportedMethodsDeferred={};this._mobileAppRequests=[];this._inMobileAppContext=navigator.userAgent.indexOf("Mobilies")>=0||location.href.indexOf("__Mobilies1d64e3af")>0;this._apiV1=navigator.userAgent.indexOf("Mobilies")>=0||location.href.indexOf("__Mobilies1d64e3af")>0;this._apiV2=navigator.userAgent.indexOf("Mobilies/2")>=0||location.href.indexOf("__Mobilies1d64e3af")>0};q.prototype={inMobileAppContext:function(){return this._inMobileAppContext},_isSupported:function(q){var r=this._supportedMethodsDeferred[q.methodName.toLowerCase()];return checkExists(r)||(r=this._supportedMethodsDeferred[q.methodName.toLowerCase()]=n.Deferred()),this._hasCheckedSupport?r.resolve(this._supportedMethodsInclude(q.methodName)):this.sendToMobileDevice({methodName:t.ControlSupportedMethods}).done(this._smartFormsSupportedControlMethods.bind(this)),r.promise()},isSupported:function(n){var t=SourceCode.Forms.Runtime.getMasterRuntimeWindow(),q=t.SourceCode.Forms.Runtime.MobileBridge;return q._isSupported(n)},_notifySupportedMethods:function(n){this._hasCheckedSupport=!0;var t=this;checkExists(n)&&n.length>0&&n.forEach(function(n){t._supportedMethods[n.toLowerCase()]=!0});Object.keys(this._supportedMethodsDeferred).forEach(function(n){t._supportedMethodsDeferred[n].resolve(t._supportedMethodsInclude(n))})},_supportedMethodsInclude:function(n){return this._supportedMethods[n.toLowerCase()]===!0},_generateCorrelationId:function(){return"".generateGuid()},_addRequest:function(n,t){t.correlationId=this._generateCorrelationId();var q=n.indexOf("?")>0?"&":"?";return n=n+q+"correlationId="+t.correlationId,this._mobileAppRequests.push(t),n},_createMobileRequestIframe:function(t,q){var r=n("<iframe id='"+t+"' src='"+q+"' style='display:none;width:0;height:0'><\/iframe>");return r.appendTo(n("body")),r},_attemptMobileRequest:function(n,t){this._inMobileAppContext===!0?this._createMobileRequestIframe(r+t.correlationId,n):this.sendToSmartFormsRuntime({correlationId:t.correlationId,data:{},error:{notInMobileAppContext:!0}})},_submitMobileRequest:function(n,t){n=this._addRequest(n,t);this._attemptMobileRequest(n,t)},_getRequestData:function(n){if(checkExists(n.correlationId)){for(var t=this._mobileAppRequests.length;t--;){var q=this._mobileAppRequests[t];if(q.correlationId===n.correlationId){n.request=q;this._mobileAppRequests.splice(t,1);break}}checkExists(n.request)||SFLog({type:5,source:"MobileBridge",category:"Events",message:Resources.RuntimeMessages.MobileRequestNotFound,parameters:[n.correlationId]})}},sendToMobileDevice:function(n){var t=SourceCode.Forms.Runtime.getMasterRuntimeWindow();return t.SourceCode.Forms.Runtime.MobileBridge._sendToMobileDevice(n)},_sendToMobileDevice:function(q){q.deferred=n.Deferred();switch(q.methodName){case t.LoadDraft:this._mobileLoadDraft(q);break;case t.ControlSupportedMethods:this._mobileSupportedMethods(q);break;case t.RenewSession:this._mobileRenewRequest(q);break;case t.TaskActioned:this._mobileTaskActioned(q);break;case t.Barcode:case t.AnnotateImage:case t.FormSubmit:case t.FormSubmitted:case t.FormHandlesSubmit:case t.DownloadFile:case t.GetAvailableMemory:default:this._mobileSimpleRequest(q)}return q.deferred.promise()},startFormSubmit:function(){var n=SourceCode.Forms.Runtime.getMasterRuntimeWindow();return this.sendToMobileDevice({methodName:t.FormSubmit}).done(function(){n._runtimeNotifyMobileAppNativeBridgeFunction=function(){this.SourceCode.Forms.Runtime.MobileBridge.sendToMobileDevice({methodName:t.FormSubmitted})}.bind(n);n._runtimeIdleState=!1})},getAvailableMemory:function(){var n=jQuery.Deferred();if(this.inMobileAppContext()&&this._apiV2){var t=this.sendToMobileDevice({methodName:"getAvailableMemory"});t.done(function(t){n.resolve(t)}.bind(this));t.fail(function(t){n.reject(t)}.bind(this))}else n.reject("Not Supported");return n},_mobileLoadDraft:function(n){var t="https://device.{0}?draftId={1}".format(n.methodName,n.draftId);this._submitMobileRequest(t,n)},_mobileSupportedMethods:function(n){if(!this._hasRequestedSupportedMethods){this._hasRequestedSupportedMethods=!0;var t="https://device.{0}".format(n.methodName);this._submitMobileRequest(t,n)}},_mobileTaskActioned:function(n){var t="https://device.{0}?serialNumber={1}&actionName={2}".format(n.methodName,n.serialNumber,n.actionName);this._submitMobileRequest(t,n)},_mobileSimpleRequest:function(n){var t="https://device.{0}".format(n.methodName);this._submitMobileRequest(t,n)},_mobileRenewRequest:function(n){var t="https://device.{0}?url={1}".format(n.methodName,encodeURIComponent(n.url));this._submitMobileRequest(t,n)},sendToSmartFormsRuntime:function(n){if(checkExists(n)){var q=this.sendToSmartFormsRuntimeInternal(n);if(!checkExists(q))for(var u=window.frames,t,r=0;r<u.length&&!checkExists(q);r++)try{t=u[r].window;checkExists(t)&&checkExists(t.SourceCode)&&checkExists(t.SourceCode.Forms)&&(q=t.SourceCode.Forms.Runtime.MobileBridge.sendToSmartFormsRuntime(n))}catch(f){}return q}},sendToSmartFormsRuntimeInternal:function(q){if(checkExists(q)){this._getRequestData(q);var f;if(checkExists(q.request))f=checkExists(q.request.methodName)?q.request.methodName:null,n("#"+r+q.correlationId).remove(),q.request.deferred.resolve(q);else if(checkExists(q.methodName))f=q.methodName;else return;var u;switch(f){case t.SaveDraft:u=this._smartFormsSaveDraft(q);break;case t.DownloadFile:u=this._getDownloadFileData(q);break;case t.PerformSubmit:u=this._performSubmit(q)}return u}},_smartFormsSupportedControlMethods:function(n){this._notifySupportedMethods(n.data)},_smartFormsSaveDraft:function(n){var t=SourceCode.Forms.Runtime.getSerializedContextDraft();if(checkExists(n.callback))n.callback.call(n.callbackInstance,t);else return t},_performSubmit:function(n){var t=!1;if(checkExistsNotEmpty(currentForm)&&checkExistsNotEmpty(_runtimeCallerType)&&(t=verifyEventHandling(currentForm,_runtimeCallerType,"Submit"),t&&this.startFormSubmit().done(function(){handleEvent(currentForm,_runtimeCallerType,"Submit",null,null,null,null,null,null,null,null,null)})),checkExists(n.callback))n.callback.call(n.callbackInstance,t);else return t},_getDownloadFileData:function(n){if(checkExists(n.request)&&typeof n.request.callback=="function"){var t=n.request.callback();if(checkExists(n.callback))n.callback.call(n.callbackInstance,t);else return t}},reset:function(){SourceCode.Forms.Runtime.MobileBridge=new q}};SourceCode.Forms.Runtime.MobileBridge=new q}})(jQuery);
/*!
 ~/RunTime/Script/Drafts.js
*/
(function(){(typeof SourceCode=="undefined"||SourceCode===null)&&(SourceCode={});(typeof SourceCode.Forms=="undefined"||SourceCode.Forms===null)&&(SourceCode.Forms={});(typeof SourceCode.Forms.Runtime=="undefined"||SourceCode.Forms.Runtime===null)&&(SourceCode.Forms.Runtime={});(typeof SourceCode.Forms.Runtime.Drafts=="undefined"||SourceCode.Forms.Runtime.Drafts===null)&&(SourceCode.Forms.Runtime.Drafts={});var n=function(n,t){this.type=n;this.messages=Array.isArray(t)?t:[]};SourceCode.Forms.Runtime.Drafts.DraftSaveException=n;SourceCode.Forms.Runtime.Drafts.DraftSaveExceptions={AttachmentTooLarge:"AttachmentTooLarge",AttachmentNotSupported:"AttachmentNotSupported"}})(jQuery);
/*!
 ~/Script/jquery.forms.utilities.embed.js
*/
(function(n){n.extend({addScripts:function(t,q,r){var u;if(u=Array.isArray(t)?t.slice(0):[],!u.length)typeof q=="function"&&q();else{n.addScript(u.shift(),function(){n.addScripts(u,q,r)},r);return}},addScript:function(n,t,q){var f=SourceCode.Forms.Settings.Version,s=SourceCode.Forms.Settings.Bundling.UseBundledFiles;if(typeof n!="string"&&(n=null),typeof t!="function"&&(t=null),typeof q!="boolean"&&(q=!1),!s||q){var u=document.getElementsByTagName("head")[0],e=jQuery(u).find('script[src^="'+n+'"]'),h=jQuery(u).find('script[src^="'+applicationRoot+n+'"]');if(e.length===0&&h.length===0){var r=document.createElement("script");n.indexOf(applicationRoot)===-1&&n.toUpperCase().indexOf("HTTP")!=0&&(n=applicationRoot+n);r.src=n.indexOf("?")===-1?n+"?_v="+f:n+"&_v="+f;r.type="text/javascript";var o=!1;r.onload=r.onreadystatechange=function(){o||this.readyState&&this.readyState!=="loaded"&&this.readyState!=="complete"||(o=!0,t&&t(this),r.onload=r.onreadystatechange=null)};u.appendChild(r)}else t&&t(e[0])}else t&&t(this);return undefined},addExternalFiles:function(n){let t=n.filter(n=>n.type.toLocaleUpperCase()==="CSS");this.addExternalStylesheets(t)},addExternalStylesheets:function(t){Array.isArray(t)&&(n("head").find(".external-css").remove(),t.forEach(t=>{t.isDisabled||n("head").append('<link rel="stylesheet" href="'+decodeURIComponent(t.url)+'" class="external-css" />')}))},addStylesheet:function(t,q,r,u){var o=SourceCode.Forms.Settings.Version,c=SourceCode.Forms.Settings.Bundling.UseBundledFiles;if(typeof t!="string"&&(t=null),n.isPlainObject(q)||(q=null),typeof r!="function"&&(r=null),typeof u!="boolean"&&(u=!1),u=!0,!c||u){var e=document.getElementsByTagName("head")[0];checkExists(t)&&t.indexOf("$staticBundle$")>=0&&(t=t.replace("$staticBundle$",SourceCode.Forms.Settings.Bundling.StaticBundlePathPrefix));var s=jQuery(e).find('link[href^="'+t+'"]'),l=jQuery(e).find('link[href^="'+applicationRoot+t+'"]');if(s.length===0&&l.length===0){var f=document.createElement("link");t.indexOf(applicationRoot)===-1&&t.toUpperCase().indexOf("HTTP")!=0&&(t=applicationRoot+t);t.indexOf("?")===-1?f.setAttribute("href",t+"?_v="+o):f.setAttribute("href",t+"&_v="+o);f.setAttribute("rel","stylesheet");f.setAttribute("type","text/css");q&&(q.id&&f.setAttribute("id",q.id),q.media&&f.setAttribute("media",q.media),q.title&&f.setAttribute("title",q.title));var h=!1;f.onload=f.onreadystatechange=function(){h||this.readyState&&this.readyState!=="loaded"&&this.readyState!=="complete"||(h=!0,r&&r(this),n("body").trigger("SF-theme-changed"),f.onload=f.onreadystatechange=null)};e.appendChild(f)}else r&&r(s[0])}else r&&r(this);return undefined}});n.switchstyle=function(t){var q=n("link[rel*=style][id='"+t+"']"),r=n("link[rel*=style][id^='"+t+"/']");q.prop("disabled",!1);r.prop("disabled",!1);setTimeout(function(){n("link[rel*=style][id]").each(function(){this.getAttribute("id")!==t&&this.getAttribute("id").indexOf(t+"/",0)!==0&&n(this).prop("disabled",!0)});(q.length>0||r.length>0)&&n("body").trigger("SF-theme-changed")},250)};n.nostyle=function(){n("link[rel*=style][id]").each(function(){n(this).prop("disabled",!0)})};n.removestyle=function(t){n("link[rel*=style][id^='"+t+"']").remove()};n.removeAllStylesForIdWithExclusion=function(t,q){var r="link[rel*=style][id^='"+t+"']";checkExistsNotEmpty(q)&&(r=r+"[id!='"+q+"']");n(r).remove()};n.enablestyle=function(t){n("body").trigger("SF-theme-changed");n("link[rel*=style][id='"+t+"']").prop("disabled",!1);n("link[rel*=style][id^='"+t+"/']").prop("disabled",!1)};n.disablestyle=function(t){n("link[rel*=style][id='"+t+"']").prop("disabled",!0);n("link[rel*=style][id^='"+t+"/']").prop("disabled",!1)}})(jQuery);
/*!
 ~/Script/SourceCode.Forms.Login.js
*/
$(document).ready(function(){var n=$("#SignInButton");if(n.length>0){if(navigator.userAgent.toLowerCase().indexOf("msie 9")===-1){$(".input-control.text-input .input-control-watermark").remove();var t=$("#UserName"),q=$("#Password");t.attr("placeholder",Resources.CommonLabels.UserNameWatermark);q.attr("placeholder",Resources.CommonLabels.PasswordWatermark)}$(".username-input").trigger("focus").trigger("select");var r=$("form");n.on("click",function(){if(!n.hasClass("disabled")&&validateLoginForm()){var t=$("form");n.addClass("loading");t[0].submit()}});$("#UserName, #Password").on("keypress keyup keydown",function(t){switch(t.keyCode){case 13:validateLoginForm()&&(n.addClass("loading"),r[0].submit())}})}});function validateLoginForm(){var n=$("#UserName"),t=$("#Password");return n.val()!==""&&t.val()!==""?!0:($(".stsPasswordPlaceHolder").text(Resources.CommonPhrases.MissingUsernameAndPassword),n.toggleClass("invalid",n.val()===""),t.toggleClass("invalid",t.val()===""),!1)}function enableDisabledLoginButton(){var n=$("#SignInButton");$("#UserName").val()!==""&&$("#Password").val()!==""?(n.removeClass("disabled"),n.removeAttr("tabindex")):(n.addClass("disabled"),n.attr("tabindex","-1"))}function showServerSideValidationMessage(n){$(".stsPasswordPlaceHolder").html(n)};
/*!
 ~/Script/SourceCode.Forms.Calendar.js
*/
Calendar=function(n){this.lastDateOnScreen=null;this.firstDateOnScreen=null;this.selectedDay=null;this.selectedHours=null;this.selectedMinutes=null;this.selectedSeconds=null;this.calendarContentType=null;this.currentDate=null;this.element=null;this.calendarPopup=null;this.popupOverCalendar=!1;this.contentElement=null;this.titleElement=null;this.selectedElement=null;this.clickButtonCount=0;this.calendarUpdateObjects=[];this.currentCalendarUpdateObject=null;this.useValidation=checkExists(n)?n:!0;this.allowAnimation=!0;this.keyPressEventAdded=!1;this._initialize()};Calendar.prototype={_initialize:function(){this.selectedDay=null;this.selectedHours=null;this.selectedMinutes=null;this.selectedSeconds=null;this._drawBasicCalendarOutline();this.mode="day";this.leftKey=37;this.upKey=38;this.rightKey=39;this.downKey=40;this.enterKey=13;this.escKey=27;this.spaceKey=32;this.tabKey=9;this.previousSelectedDay=this.selectedDay},addCalendarUpdateObject:function(n,t,q){if(!this.hasCalendarUpdateObject(n,t)){var r=this.getCalendarUpdateObject(n,t),f=checkExists(r);f||(r=new CalendarUpdateObject(n,t,q,this));r.button.off(".calupdateobjectevents");r.textbox.off(".calupdateobjectevents");r.button.on("click.calupdateobjectevents",[this,r],this._popupCalendarOnClick);r.button.on("keydown.calupdateobjectevents",[this,r],this._popupCalendarOnKeyPress);r.textbox.on("change.calupdateobjectevents",[this,r],this._changeTextBox);if(SourceCode.Forms.Browser.msie){r.textbox.on("focus.msie-change.calupdateobjectevents",function(){$(this).data("before",$(this).val())});r.textbox.on("keydown.msie-change.calupdateobjectevents",function(n){n.which===13&&$(this).val()!==$(this).data("before")&&($(this).trigger("change"),$(this).removeData("before"))});r.textbox.on("blur.msie-change.calupdateobjectevents",function(){$(this).removeData("before")})}if(!this.keyPressEventAdded){var u=r.topCalendarEl.find(".today-title");if(u.length>0){u.off(".calupdateobjectevents");u.on("focus.calupdateobjectevents",{currentCalendar:r},this._onTopCalendarItemFocus);u.on("blur.calupdateobjectevents",{currentCalendar:r},this._onTopCalendarItemBlur)}this.element.off(".calupdateobjectevents");this.element.on("keydown.calupdateobjectevents",{context:this},this._onKeyPressGeneral);this.keyPressEventAdded=!0}f||this.calendarUpdateObjects.push(r)}},_setWithoutChange:function(n,t){n.textbox.val()!==t&&(n.textbox.off("change"),n.textbox.val(t),setTimeout(function(){n.textbox.on("change",[this,n],this._changeTextBox)}.bind(this),40))},updateDisplayValue:function(n,t,q){this._formatObject=null;var r=n.textbox,u=checkExists(t)?t:r.data("calendarDate");if(checkExistsNotEmpty(u)){var f={formatXmlString:r.data("format"),elementToStyle:r,value:u,formattingError:!1,dataType:r.data("dataType")};u=SCCultureHelper.Current().applyFormatToControlValue(f);r.data("calendarDate",f.value);this.isValidDate(r,!f.formattingError);this._setWithoutChange(n,u);checkExistsNotEmpty(q)&&q!==!1||n.textbox.trigger("focus")}else checkExists(u)&&this.setCurrentDate(r,"")},getCalendarUpdateObject:function(n,t){var r=null;checkExistsNotEmpty(n)&&(n instanceof jQuery?n.length>0&&(r=n[0]):r=n);var u=null;checkExistsNotEmpty(t)&&(t instanceof jQuery?t.length>0&&(u=t[0]):u=t);for(var q=0;q<this.calendarUpdateObjects.length;q++){var f=null;checkExistsNotEmpty(this.calendarUpdateObjects[q].textbox)&&(this.calendarUpdateObjects[q].textbox instanceof jQuery?this.calendarUpdateObjects[q].textbox.length>0&&(f=this.calendarUpdateObjects[q].textbox[0]):f=this.calendarUpdateObjects[q].textbox);var e=null;if(checkExistsNotEmpty(this.calendarUpdateObjects[q].button)&&(this.calendarUpdateObjects[q].button instanceof jQuery?this.calendarUpdateObjects[q].button.length>0&&(e=this.calendarUpdateObjects[q].button[0]):e=this.calendarUpdateObjects[q].button),r!==null&&f===r||u!==null&&e===u)return this.calendarUpdateObjects[q]}return null},hasCalendarUpdateObject:function(n,t){for(var q=0;q<this.calendarUpdateObjects.length;q++)if(n!==null&&this.calendarUpdateObjects[q].textbox===n||t!==null&&this.calendarUpdateObjects[q].button===t)return!0;return!1},removeCalendarUpdateObject:function(n,t){for(var q=this.calendarUpdateObjects.length-1;q>=0;q--)if(n!==null&&this.calendarUpdateObjects[q].textbox===n||t!==null&&this.calendarUpdateObjects[q].button===t){this.calendarUpdateObjects[q].button.off();this.calendarUpdateObjects[q].textbox.off("change",this._changeTextBox);this.calendarUpdateObjects=this.calendarUpdateObjects.removeAt(q);break}},findCalendarUpdateObject:function(n,t){for(var q=0;q<this.calendarUpdateObjects.length;q++)if(n!==null&&this.calendarUpdateObjects[q].textbox.attr("id")===n.attr("id")||t!==null&&this.calendarUpdateObjects[q].button.attr("id")===t.attr("id"))return this.calendarUpdateObjects[q];return null},getCurrentDate:function(n){var q=jQuery(n),u=q.data("calendarDate"),f=this.currentCalendarUpdateObject,t=this.getCalendarUpdateObject(q,null);if(this.currentCalendarUpdateObject=t,t!==null&&checkExists(t.selectedDate)&&t.calendarPickerOptions.type==="timePicker"&&(!checkExists(q.data("dataType"))||q.data("dataType").toLowerCase()!=="time")){var r=this._convertDateStringToObject(u);t.selectedDate.setHours(r.getHours());t.selectedDate.setMinutes(r.getMinutes());t.selectedDate.setSeconds(r.getSeconds());t.selectedDate.setMilliseconds(r.getMilliseconds());u=this._convertDateObjToString(t.selectedDate)}return this.currentCalendarUpdateObject=f,u},isValidDate:function(n,t){var q=jQuery(n);if(typeof t!="undefined"&&t!==null){if(q.data("isValidDate",t),this.useValidation&&typeof UtilitiesBehaviour!="undefined"&&typeof Resources.RuntimeMessages!="undefined"){var u={CurrentControlId:q.attr("id").replace("_TextBox",""),Error:!t,Pattern:Resources.RuntimeMessages.InvalidDate};UtilitiesBehaviour.validateControl(u)}}else{var r=q.data("isValidDate");return typeof r=="undefined"||r===null?!0:r}},setCurrentDate:function(n,t){var q=jQuery(n),r=q.data("calendarDate");if(!r||r!==t||!this.isValidDate(n))if(t!==""&&t!==null){q.siblings(".input-control-watermark").hide();var u={formatXmlString:q.data("format"),elementToStyle:n,value:t,formattingError:!1,dataType:q.data("dataType")};if(q.val(SCCultureHelper.Current().applyFormatToControlValue(u)),this.isValidDate(n,!u.formattingError),r!==u.value){var f=this.getCalendarUpdateObject(q,null),e=this.currentCalendarUpdateObject;return this.currentCalendarUpdateObject=f,f===null||f.calendarPickerOptions.type!=="timePicker"||checkExists(q.data("dataType"))&&q.data("dataType").toLowerCase()==="time"||(f.selectedDate=this._convertDateStringToObject(t).clearTime()),q.data("calendarDate",u.value),this.currentCalendarUpdateObject=e,!0}}else{q.data("calendarDate","");q.val("");q.siblings(".input-control-watermark").show();this.isValidDate(n,!0);var o=!checkExists(r)&&t==="";if(r!==t&&!o)return!0}return!1},_drawBasicCalendarOutline:function(){this.element=jQuery("<div><\/div>");this.element[0].style.display="none";this.element.on("click",this,this._onClick);var n=jQuery("<div class='top-calendar'><\/div>");this.element.append(n);this.element.addClass("calendar-outline");var t=jQuery("<a class='top-calendar-left' href='javascript:void(0)'>&nbsp;<\/a>");n.append(t);this.titleElement=jQuery("<a class='today-title'  href='javascript:void(0)'><\/a>");n.append(this.titleElement);var q=jQuery("<a class='top-calendar-right' href='javascript:void(0)'>&nbsp;<\/a>");n.append(q);this.contentElement=jQuery("<div class='calendar-content-outside'><\/div>");this.contentPartsElement=jQuery("<div class='calendar-content'><\/div>");this.element.append(this.contentElement);this.contentElement.append(this.contentPartsElement);this.selectedElement=jQuery('<div class="today-text"><span class="today-text-label">'+Resources.CommonLabels.CommonFormLabel.format(Resources.CommonLabels.SelectedDateLabelText)+'<\/span><br /><span class="today-text-value"><\/span><\/div>');this.element.append(this.selectedElement)},_drawDayCalendar:function(n,t){checkExists(n)&&(checkExists(n._type)||!isNaN(n))||(n=new Date);var s=n.clone();n.clearTime();var q=n.clone();this.currentDate=n.clone();var h=this.formatObject(),f=h.cultureObject;switch(f.CalendarType){case"GregorianCalendar":var e=null;t&&(e=this._getParticularFormatForDate("D",this.selectedDay),this.selectedElement.children(".today-text-value").text(e));q.setDate(1);var o=parseInt(this._getParticularFormatForDate("dd",q),10);o!==1&&q.decrement(o);var r=checkExists(f.DateTimeSettings.FirstDayOfWeek)?parseInt(f.DateTimeSettings.FirstDayOfWeek,10):0;checkExists(this.currentCalendarUpdateObject.calendarPickerOptions)&&this.currentCalendarUpdateObject.calendarPickerOptions.firstDayOfWeek!=="7"&&(r=parseInt(this.currentCalendarUpdateObject.calendarPickerOptions.firstDayOfWeek,10));(r<0||r>6)&&(r=0);var u=q.getDay()-r;u<0&&(u=u+7);u===0&&(u=7);q.decrement(u);this.firstDateOnScreen=q.clone();this.contentPartsElement.empty();this.titleElement[0].innerHTML=this._getParticularFormatForDate("MMM yyyy",n);this._drawDayCalendarInternal(f,q,null,r);break;default:this._drawDayCalendarAjax(f,s,t,this.currentCalendarUpdateObject.calendarPickerOptions.firstDayOfWeek)}},_drawDayCalendarAjax:function(n,t,q,r){var u=function(text){var resultsObject=eval(text);q&&this.selectedElement.children(".today-text-value").text(resultsObject.dateString);this.titleElement.html(resultsObject.heading);var newDrawingDate=this._convertDateStringToObject(resultsObject.drawingDate);checkExistsNotEmpty(this.formatObject().timeZone)&&newDrawingDate.convertTime(this.formatObject().timeZone);this.firstDateOnScreen=newDrawingDate.clone();this._drawDayCalendarInternal(n,newDrawingDate,resultsObject.days)}.bind(this),f=SCCultureHelper.Current()._convertDateObjToLocalString(t.clearTime(),!0),e={method:"getCalendar",value:f,dataType:this.dataType?this.dataType:this.currentCalendarUpdateObject.textbox.data("dataType"),formatCultureName:n.Name,configuredFirstDayOfWeek:r},o={url:applicationRoot+"Runtime/CalendarAJAXCall.ashx",type:"GET",data:e,async:!1,dataType:"text",cache:!0},s=jQuery.ajax(o);return u(s.responseText)},_startFixBoxShadow:function(){checkExists(this.outline)||SourceCode.Forms.Browser.msie&&parseInt(SourceCode.Forms.Browser.version,10)<parseInt(11,10)&&(this.outline=$(".calendar-outline"),this.outline.length===0&&(this.outline=null));checkExists(this.outline)&&(this.outline[0].style.boxShadow="0px 0px")},_endFixBoxShadow:function(){checkExists(this.outline)&&(this.outline[0].style.boxShadow="")},_endFixBoxShadowTimeout:function(){checkExists(this.outline)&&setTimeout(this._endFixBoxShadow.bind(this),0)},_drawDayCalendarInternal:function(n,t,q,r){this._cleanUpParts();this.contentPartsElement.empty();this._startFixBoxShadow();for(var s=0,c=0,v=this.today(t._type),y=this.selectedDay.clone().clearTime(),e=0;e<7;e++){var l=jQuery("<div class='calendar-row week'><\/div>");this.contentPartsElement.append(l);for(var f=0;f<7;f++){var u=jQuery("<a><\/a>");if(u.attr("href","javascript:void(0)"),e===0){var h=jQuery("<span><\/span>");l.append(h);h.addClass("dayname");var o=f;checkExists(r)&&(o=f+r,o>6&&(o=o-7));checkExists(q)?h.html(q[c]):h.html(n.DateTimeSettings.ShortestDayNames[o])}else{l.append(u);var p=this._convertDateObjToString(t),a=checkExists(q)?q[c]:this._getParticularFormatForDate("dd",t);u.html(a);u.attr("calendarDate",p);u.data("calendarDate",p);u.addClass("day").addClass("xy_{0}_{1}".format(f,e-1));a>s?(u.addClass("not-of-current-month"),s=0):a<s&&u.addClass("not-of-current-month");y&&y.equals(t)&&u.addClass("selected");v&&v.equals(t)&&u.addClass("today");(e!==6||f!==6)&&t.increment(1).clearTime();s++}c++}}this.lastDateOnScreen=t.clone();this._endFixBoxShadowTimeout()},_drawMonthCalendar:function(){this._cleanUpParts();var e=this._getParticularFormatForDate("yyyy",this.currentDate);this.titleElement[0].innerHTML=e;var u=this.contentPartsElement;this.allowAnimation?(this.contentPartsElementNew=jQuery("<div class='calendar-content' style='display:none;'><\/div>"),this.contentElement.append(this.contentPartsElementNew),u=this.contentPartsElementNew):this.contentPartsElement.empty();for(var t=0,o=this.formatObject(),s=this.currentDate.getUTCFullYear(),q=0;q<3;q++){var f=jQuery("<div class='week calendar-row months'><\/div>");u.append(f);for(var r=0;r<4;r++){var n=jQuery("<a><\/a>");f.append(n);n.html(o.cultureObject.DateTimeSettings.ShortMonthNames[t]);n.attr("month",t);n.attr("year",s);n.attr("href","javascript:void(0)");n.addClass("month").addClass("xy_{0}_{1}".format(r,q));t++}}this.allowAnimation&&jQuery([this.contentPartsElementNew[0],this.contentPartsElement[0]]).toggle(100,this._afterAnimation.bind(this));this.currentCalendarUpdateObject.calendarContent=this.contentPartsElementNew},_cleanUpParts:function(){var n=this.contentElement.find(".calendar-content");n.length>1&&(n.remove(),this.contentPartsElement=jQuery("<div class='calendar-content' style='display:none;'><\/div>"),this.contentElement.append(this.contentPartsElement))},_afterAnimation:function(){if(this.contentPartsElementNew){var n=jQuery(this.contentPartsElementNew[0]);this.contentPartsElement.remove();this.contentPartsElement=null;this.contentPartsElementNew=null;this.contentPartsElement=n}},_drawYearCalendar:function(){this._cleanUpParts();var u=this._getParticularFormatForDate("yyyy",this.currentDate),n=parseInt((u+"").substring(0,3)+"0",10)-1,s=parseInt(u,10)-n,f=this.currentDate.getUTCFullYear()-s;this.titleElement[0].innerHTML=n+1+" - "+(n+10);var e=this.contentPartsElement;this.allowAnimation?(this.contentPartsElementNew=jQuery("<div class='calendar-content' style='display:none;'><\/div>"),this.contentElement.append(this.contentPartsElementNew),e=this.contentPartsElementNew):this.contentPartsElement.empty();for(var q=0;q<3;q++){var o=jQuery("<div class='week calendar-row years'><\/div>");e.append(o);for(var r=0;r<4;r++){var t=jQuery("<a><\/a>");o.append(t);t[0].innerHTML=n;t[0].setAttribute("name",f);t[0].setAttribute("href","javascript:void(0)");n++;f++;t.addClass("year").addClass("xy_{0}_{1}".format(r,q))}}this.allowAnimation&&jQuery([this.contentPartsElementNew[0],this.contentPartsElement[0]]).toggle(100,this._afterAnimation.bind(this));this.currentCalendarUpdateObject.calendarContent=this.contentPartsElementNew},_drawTimePicker:function(n,t,q,r){var k=0,d=0,u="",f={inputsLength:0,inputsInfo:[]},o={inputs:[]},e=[];if(checkExists(r)){var qt=this.currentCalendarUpdateObject.textbox.data("format"),c=this.formatObject();if(u=r.timeFormat==="hh:mm:ss"?"longtime":r.timeFormat==="hh:mm"?"shorttime":r.timeFormat==="hh"?"HH":r.timeFormat,u==="longtime"||u==="shorttime"){for(var v=c.cultureObject.DateTimePatterns,l=0;l<v.length;l++)if(u==="longtime"&&v[l].Symbol==="T"||u==="shorttime"&&v[l].Symbol==="t"){u=v[l].Value;break}u==="longtime"?u="HH:mm:ss":u==="shorttime"&&(u="HH:mm")}var a=!1;if(u.contains("hh"))if(f.inputsLength++,f.inputsInfo.push({maxInputLength:2,rightAlign:!0}),o.inputs.push({range:{min:0,max:11,step:1},displays:{"0":"12","1":"01","2":"02","3":"03","4":"04","5":"05","6":"06","7":"07","8":"08","9":"09"},defaultValue:"12",selectOnFocus:!0}),n===0)e.push("12");else if(n===12)e.push("12"),a=!0;else if(n>12){var g=n-12;e.push(g.toString());a=!0}else e.push(n.toString());else if(u.contains("HH"))f.inputsLength++,f.inputsInfo.push({maxInputLength:2,rightAlign:!0}),o.inputs.push({range:{min:0,max:23,step:1},displays:{"0":"00","1":"01","2":"02","3":"03","4":"04","5":"05","6":"06","7":"07","8":"08","9":"09"},defaultValue:"00",selectOnFocus:!0}),e.push(n.toString());else if(u.contains("h"))if(f.inputsLength++,f.inputsInfo.push({maxInputLength:2,rightAlign:!0}),o.inputs.push({range:{min:0,max:11,step:1},displays:{"0":"12"},defaultValue:"12",selectOnFocus:!0}),n===0)e.push("12");else if(n===12)e.push("12"),a=!0;else if(n>12){var g=n-12;e.push(g.toString());a=!0}else e.push(n.toString());else u.contains("H")&&(f.inputsLength++,f.inputsInfo.push({maxInputLength:2,rightAlign:!0}),o.inputs.push({range:{min:0,max:23,step:1},defaultValue:"0",selectOnFocus:!0}),e.push(n.toString()));if(u.contains("mm")&&(k=parseInt(r.minInterval),f.inputsLength++,f.inputsInfo.push({delimiterBeforeInput:":",maxInputLength:2,rightAlign:!0}),o.inputs.push({range:{min:0,max:59,step:k},displays:{"0":"00","1":"01","2":"02","3":"03","4":"04","5":"05","6":"06","7":"07","8":"08","9":"09"},defaultValue:"00",selectOnFocus:!0}),e.push(t.toString())),u.contains("ss")&&(d=parseInt(r.secInterval,10),f.inputsLength++,f.inputsInfo.push({delimiterBeforeInput:":",maxInputLength:2,rightAlign:!0}),o.inputs.push({range:{min:0,max:59,step:d},displays:{"0":"00","1":"01","2":"02","3":"03","4":"04","5":"05","6":"06","7":"07","8":"08","9":"09"},defaultValue:"00",selectOnFocus:!0}),e.push(q.toString())),u.contains("tt")){var y="AM",p="PM";checkExistsNotEmpty(c.cultureObject.DateTimeSettings.AMDesignator)&&checkExistsNotEmpty(c.cultureObject.DateTimeSettings.PMDesignator)&&(y=c.cultureObject.DateTimeSettings.AMDesignator,p=c.cultureObject.DateTimeSettings.PMDesignator);f.inputsLength++;o.inputs.push({values:[y,p],defaultValue:y,selectOnFocus:!0});a?e.push(p):e.push(y)}}var h=this.element.find(".timepicker-content"),s=null;if(h.length===0){h=jQuery("<div class='timepicker-content'><\/div>");this.element.append(h);var w=jQuery("<div class='timepicker-spinner-wrapper'><\/div>");w.append("<span class='timepicker-spinner-label'>"+Resources.CommonLabels.TimeText+"<\/span>");s=jQuery(SCSpinner.html(f));s.spinner(o);w.append(s);h.append(w);var b=jQuery("<div class='timepicker-buttons'><\/div>"),nt=jQuery("<a class='SFC SourceCode-Forms-Controls-Web-Button button timepicker-ok-button' href='javascript:'>"+Resources.WizardButtons.OKButtonText+"<\/a>").SFCButton(),tt=jQuery("<a class='SFC SourceCode-Forms-Controls-Web-Button button timepicker-cancel-button' href='javascript:'>"+Resources.WizardButtons.CancelButtonText+"<\/a>").SFCButton();nt.on("click",this._onOkClick.bind(this));tt.on("click",this._onCancelClick.bind(this));b.append(nt);b.append(tt);h.append(b)}else s=h.find(".spinner"),SCSpinner.editInputsHtml(s,f),s.spinner("option","inputs",o.inputs),s.spinner("reset");s.spinner("value",e)},_popupCalendarOnKeyPress:function(n){var t=n.data[0];(n.which===t.enterKey||n.which===t.spaceKey)&&(n.preventDefault(),n.stopPropagation(),t._popupCalendar(t,n.data[1]))},_popupCalendarOnClick:function(n){n.preventDefault();var t=n.data[0];document.activeElement!==n.data[1].button[0]&&$(n.data[1].button[0]).trigger("focus");t._popupCalendar(t,n.data[1])},_popupCalendar:function(n,t){if(n.element[0].style.display==="none"||n.currentCalendarUpdateObject!==t){this._formatObject=null;checkExists(n.calendarPopup)&&(n.calendarPopup.popupwindow("close"),n.calendarPopup=null);n._cleanUpParts();n.currentCalendarUpdateObject=t;var s=0;n.clickButtonCount=0;var q="id-calendar-control-popup";n.element[0].style.top===""&&(n.element[0].style.top="0px");n.element[0].style.left===""&&(n.element[0].style.left="0px");s=jQuery(document).height();jQuery(document).off("click.calendar",n.clickOnPage);jQuery(document).on("click.calendar",n,n.clickOnPage);if(n.dataType=t.textbox.data("dataType"),n.selectedDay=n.now(),n.mode="day",t){var u=t.textbox.data("calendarDate");if(u){var f=n._convertDateStringToObject(u);f&&(n.selectedDay=f)}}if(n.selectedHours=n.selectedDay.getHours(),n.selectedMinutes=n.selectedDay.getMinutes(),n.selectedSeconds=n.selectedDay.getSeconds(),n.calendarContentType="date",checkExists(t.calendarPickerOptions)&&checkExists(t.calendarPickerOptions.type))switch(t.calendarPickerOptions.type){case"datePicker":n.calendarContentType="date";q+=" type-date-only";break;case"timePicker":n.calendarContentType="time";q+=" type-time-only";break;case"dateTimePicker":n.calendarContentType="dateTime";q+=" type-date-time";n.element.off("dblclick.closeCalendar").on("dblclick.closeCalendar",this,this._onDblClick);t.isTimeFocused=!1}if(n.calendarContentType!=="time"&&n._drawDayCalendar(n.selectedDay.clone(),!0),n.element[0].style.display="block",n.element.find(".top-calendar")[0].style.display="block",n.element.find(".calendar-content-outside")[0].style.display="block",n.element.find(".today-text")[0].style.display="block",this.formatObject().cultureObject.CalendarType==="UmAlQuraCalendar"&&n.element.find(".today-title").addClass("disabled"),n.calendarContentType!=="date"&&(n._drawTimePicker(n.selectedHours,n.selectedMinutes,n.selectedSeconds,t.calendarPickerOptions),n.element.find(".timepicker-content")[0].style.display="block"),n.calendarContentType==="date"){var e=n.element.find(".timepicker-content");e.length>0&&(e[0].style.display="none")}else n.calendarContentType==="time"&&(n.element.find(".top-calendar")[0].style.display="none",n.element.find(".calendar-content-outside")[0].style.display="none",n.element.find(".today-text")[0].style.display="none");n.calendarPopup=popupManager.showPopup({centered:!1,content:n.element,draggable:!1,modal:!1,removeContent:!1,showContentOnly:!0,cssClass:q});n.calendarPopup.removeClass("dialog");n.calendarPopup.popupwindow("resize",n.element.outerWidth(!0),n.element.outerHeight(!0));var o={popupContent:n.element,element:n.currentCalendarUpdateObject.button},h=parseInt(SourceCode.Forms.MenuHelper.getTopValue(o)),r=parseInt(SourceCode.Forms.MenuHelper.getLeftValue(o));if(r<0&&(r=2),n.calendarPopup.popupwindow("move",r,h),(n.calendarContentType==="dateTime"||n.calendarContentType==="time")&&(t.timeContent=n.element.find(".timepicker-content"),t.spinnerWrapper=n.element.find(".spinner")),n.currentCalendarUpdateObject=t,n.calendarContentType!=="time"){var c=n.element.find(".day.selected");n._focusCalendarItem(c,t.calendarContent)}else n._focusTimeControls()}n.previousSelectedDay=n.selectedDay},_changeTextBox:function(n){var q=n.data[0],t=n.data[1],r=null;r=t.textbox[0].value;q.updateDisplayValue(t,r,!0);q.isValidDate(t.textbox)&&t.button.trigger("calendarChanged",[n,q,t])},now:function(){if(!checkExists(this.dataType)){var n=this.currentCalendarUpdateObject.textbox.data();checkExists(this.dataType)||(this.dataType=n.dataType)}return this.dataType==="date"?SourceCode.Forms.Date.now():this.dataType==="time"?SourceCode.Forms.Time.now():this.formatObject()&&checkExistsNotEmpty(this.formatObject().timeZone)?SourceCode.Forms.DateTime.now(this.formatObject().timeZone):new Date},today:function(){return this.now().clone().clearTime()},formatObject:function(){if(!checkExists(this._formatObject)){var n=this.currentCalendarUpdateObject.textbox.data();checkExistsNotEmpty(n.format)&&(this._formatObject=SCCultureHelper.Current().getFormatObject(n.format))}return this._formatObject},_convertDateStringToObject:function(n){if(checkExists(n)&&(n instanceof Date||n._type==="datetime"||n._type==="date"||n._type==="time"))return n;if(!checkExists(this.dataType)){var t=this.currentCalendarUpdateObject.textbox.data();checkExists(this.dataType)||(this.dataType=t.dataType)}return SCCultureHelper.Current()._convertDateStringToObj({dataType:this.dataType,value:n,formatObject:this.formatObject()})},_convertDateObjToString:function(n){return SCCultureHelper.Current()._convertDateObjToString(n)},_getParticularFormatForDate:function(n,t){return SCCultureHelper.Current().getParticularFormatForDate(this.formatObject(),n,t)},_onClick:function(n){var q=jQuery(n.target),t=n.data,h=t.currentCalendarUpdateObject.textbox.data("format");if(q.length>0){if(q.hasClass("day")){t.element.find(".selected").removeClass("selected");q.addClass("selected");var r=q.data("calendarDate");if(t.selectedDay=t._convertDateStringToObject(r),t.selectedHours=t.selectedDay.getHours(),t.selectedMinutes=t.selectedDay.getMinutes(),t.selectedSeconds=t.selectedDay.getSeconds(),t.calendarContentType==="date"){t.currentCalendarUpdateObject.textbox.data("calendarDate",r);t.updateDisplayValue(t.currentCalendarUpdateObject);t.currentCalendarUpdateObject.textbox[0].value===""?t.currentCalendarUpdateObject.textbox.siblings(".input-control-watermark").show():t.currentCalendarUpdateObject.textbox.siblings(".input-control-watermark").hide();t.element[0].style.display="none";t.calendarPopup.popupwindow("close");t.calendarPopup=null;jQuery(document).off("click.calendar",t.clickOnPage);t.currentCalendarUpdateObject.button.trigger("calendarChanged",[n,t,t.currentCalendarUpdateObject]);t.currentCalendarUpdateObject=null;return}r=t._getParticularFormatForDate("D",t.selectedDay);t.selectedElement.children(".today-text-value").text(r);t.currentCalendarUpdateObject.calendarContent.find(".selected").removeClass("selected");var u=$(q);t.selectedDay=u.attr("calendardate");checkExistsNotEmpty(t.selectedDay)&&(t.selectedDay=t._convertDateStringToObject(t.selectedDay));u.addClass("selected");t._focusCalendarItem(u)}else if(q.hasClass("month")){t.mode="day";t.currentDate.setSafeFullYear(q[0].getAttribute("year"),q[0].getAttribute("month"),t.selectedDay.getDate());var e=t._convertDateObjToString(t.currentDate);t._drawDayCalendar(t.currentDate);t.currentCalendarUpdateObject.calendarContent=t.element.find(".calendar-content");var o=t.currentCalendarUpdateObject.calendarContent.find(".day[calendardate='"+e+"']");t._focusCalendarItem(o)}else if(q.hasClass("year")){t.mode="month";t.currentDate.setSafeUTCFullYear(q[0].getAttribute("name"));t._drawMonthCalendar();var f=t.currentCalendarUpdateObject.calendarContent.find("a[month="+t.currentDate.getMonth()+"]");t._focusCalendarItem(f)}else if(q.hasClass("today-title")&&t.mode==="day"&&t.formatObject().cultureObject.CalendarType!=="UmAlQuraCalendar"){t.mode="month";t._drawMonthCalendar();var f=t.currentCalendarUpdateObject.calendarContent.find("a[month="+t.currentDate.getMonth()+"]");t._focusCalendarItem(f)}else if(q.hasClass("today-title")&&t.mode==="month"){t.mode="year";t._drawYearCalendar();var s=t.currentCalendarUpdateObject.calendarContent.find("a[name="+t.currentDate.getUTCFullYear()+"]");t._focusCalendarItem(s)}else q.hasClass("top-calendar-left")&&t.mode==="day"?t._drawDayCalendar(t.firstDateOnScreen.clone()):q.hasClass("top-calendar-right")&&t.mode==="day"?t._drawDayCalendar(t.lastDateOnScreen.clone()):q.hasClass("top-calendar-left")&&t.mode==="month"?(t.currentDate.setFullYear(t.currentDate.getFullYear()-1),t._drawMonthCalendar()):q.hasClass("top-calendar-right")&&t.mode==="month"?(t.currentDate.setFullYear(t.currentDate.getFullYear()+1),t._drawMonthCalendar()):q.hasClass("top-calendar-left")&&t.mode==="year"?(t.currentDate.setFullYear(t.currentDate.getFullYear()-10),t._drawYearCalendar()):q.hasClass("top-calendar-right")&&t.mode==="year"&&(t.currentDate.setFullYear(t.currentDate.getFullYear()+10),t._drawYearCalendar());t.currentCalendarUpdateObject.isTimeFocused=!1;switch(t.mode){case"day":t.calendarPopup.addClass("mode-day").removeClass("mode-month mode-year");break;case"month":t.calendarPopup.addClass("mode-month").removeClass("mode-day mode-year");break;case"year":t.calendarPopup.addClass("mode-year").removeClass("mode-day mode-month")}}n.stopPropagation()},_onDblClick:function(n){jQuery(n.target).hasClass("day")&&(n.stopPropagation(),n.data.element.find(".timepicker-ok-button").trigger("click"))},_onOkClick:function(n){var t=this,s=t.currentCalendarUpdateObject.textbox.data("format"),r=this.formatObject(),o=t.element.find(".day.selected"),u="";if(o.length>0&&(u=o.data("calendarDate"),t.selectedDay=t._convertDateStringToObject(u)),checkExistsNotEmpty(t.selectedDay)){t.selectedHours=0;t.selectedMinutes=0;t.selectedSeconds=0;var q=t.element.find(".spinner").spinner("value"),f="AM",e="PM";checkExistsNotEmpty(r.cultureObject.DateTimeSettings.AMDesignator)&&checkExistsNotEmpty(r.cultureObject.DateTimeSettings.AMDesignator)&&(f=r.cultureObject.DateTimeSettings.AMDesignator,e=r.cultureObject.DateTimeSettings.PMDesignator);t.selectedHours=q[q.length-1]===f?q[0]==="12"?0:parseInt(q[0]):q[q.length-1]===e?q[0]==="12"?parseInt(q[0]):parseInt(q[0])+12:parseInt(q[0]);checkExists(q[1])&&q[1]!==f&&q[1]!==e&&(t.selectedMinutes=parseInt(q[1]));checkExists(q[2])&&q[2]!==f&&q[2]!==e&&(t.selectedSeconds=parseInt(q[2]));t.selectedDay.setHours(t.selectedHours);t.selectedDay.setMinutes(t.selectedMinutes);t.selectedDay.setSeconds(t.selectedSeconds);u=t._convertDateObjToString(t.selectedDay);t.currentCalendarUpdateObject.textbox.data("calendarDate",u);t.updateDisplayValue(t.currentCalendarUpdateObject);t.currentCalendarUpdateObject.textbox[0].value===""?t.currentCalendarUpdateObject.textbox.siblings(".input-control-watermark").show():t.currentCalendarUpdateObject.textbox.siblings(".input-control-watermark").hide();t.element[0].style.display="none";t.calendarPopup.popupwindow("close");t.calendarPopup=null;jQuery(document).off("click.calendar",t.clickOnPage);t.currentCalendarUpdateObject.button.trigger("calendarChanged",[n,t,t.currentCalendarUpdateObject]);t.currentCalendarUpdateObject=null}n.stopPropagation()},_onCancelClick:function(n){this.element[0].style.display="none";this.calendarPopup.popupwindow("close");this.calendarPopup=null;this.currentCalendarUpdateObject=null;jQuery(document).off("click.calendar",this.clickOnPage);n.stopPropagation()},clickOnPage:function(n){var t=n.data,u=t.popupOverCalendar;if(checkExists(t.calendarPopup)){var q=t.calendarPopup.next();for(t.popupOverCalendar=q.hasClass("popup");q.length>0&&!t.popupOverCalendar;)q=q.next(),t.popupOverCalendar=q.hasClass("popup")}var f=t.popupOverCalendar;if(!f&&!u){var r=jQuery(n.target);r.hasClass("calender-control-button")||(r=r.closest(".calender-control-button"));r[0]===t.currentCalendarUpdateObject.button[0]&&t.clickButtonCount>=1||r[0]!==t.currentCalendarUpdateObject.button[0]?t.element[0].style.display!=="none"&&(t.element[0].style.display="none",t.calendarPopup.popupwindow("close"),t.calendarPopup=null):t.clickButtonCount++}},_onKeyPressGeneral:function(n){var t=n.data.context;switch(n.which){case t.downKey:case t.upKey:case t.leftKey:case t.rightKey:case t.escKey:case t.spaceKey:case t.tabKey:case t.enterKey:return t.currentCalendarUpdateObject.isTime?t._onKeyPressTime(n,t):t._onKeyPress(n,t),n.stopPropagation(),!1;default:return!0}},_onKeyPress:function(n,t){var q=t.currentCalendarUpdateObject,r=t.element;q.calendarOutsideEl=jQuery(n.target).closest(".calendar-outline");var y=q.calendarOutsideEl;q.calendarContent=q.calendarOutsideEl.find(".calendar-content");var e=q.calendarContent;q.topCalendarEl=q.calendarOutsideEl.find(".top-calendar");q.timeContent=q.calendarOutsideEl.find(".timepicker-content");q.spinnerWrapper=q.timeContent.find(".spinner");t._startFixBoxShadow();var s=null,f=null,u=null,h=null,c=null,l=!1,o=$(document.activeElement);q.isTime||(s=e.find(".selected"),f=e.find(".active"),f.length===0&&(f=s),u=q.topCalendarEl.find(".today-title").hasClass("active"),u&&(h=q.topCalendarEl.find(".today-title")),c=e.find(".day"),l=c.length>0,q.isDateTime&&(o.hasClass("input-control")||o.hasClass("spinner-text-input"))&&(q.isTimeFocused=!0));q.isTime||u||!l||checkExists(s)||t._focusFirstCalendarItem();switch(n.which){case t.enterKey:case t.spaceKey:u?q.topCalendarEl.find(".today-title").trigger("click"):q.isDateTime?q.isTimeFocused?(q.isTimeFocused=!1,o.hasClass("timepicker-ok-button")?o.trigger("click"):o.hasClass("timepicker-cancel-button")&&(r[0].style.display="none",t.calendarPopup.popupwindow("close"),t.calendarPopup=null)):n.which===t.enterKey?t._selectCalendarItem(r,!0):t._selectCalendarItem(r,!1):t._selectCalendarItem(r,!0);break;case t.escKey:if(u||t.mode!=="day")switch(t.mode){case"day":r[0].style.display="none";t.calendarPopup.popupwindow("close");q.isTimeFocused=!1;t.calendarPopup=null;break;case"month":case"year":if(f.length>0)t._selectCalendarItem(r,!1);else{n.preventDefault();var a="[month="+t.selectedDay.getMonth()+"]";return t.mode==="year"&&(a="[year="+t.selectedDay.getUTCFullYear()+"]"),t._focusCalendarItem(q.calendarContent.find(a)),t._selectCalendarItem(r,!1),!1}}else r[0].style.display="none",t.calendarPopup.popupwindow("close"),q.isTimeFocused=!1,t.calendarPopup=null;break;case t.upKey:case t.downKey:case t.leftKey:case t.rightKey:if(u)n.keyCode===t.downKey?t._focusActiveCalendarItem():(n.keyCode===t.leftKey||n.keyCode===t.rightKey)&&t._pageTopItems(n.keyCode);else if(q.isDateTime&&q.isTimeFocused)q.isTimeFocused&&t._moveBetweenTimeElements(q.timeContent,n.keyCode);else{var v=t._getElementForDirection(f,n.keyCode,e);checkExists(v)&&t._focusCalendarItem(v,e)}break;case t.tabKey:n.shiftKey?t._tabBackBetweenControls(u,q,h):t._tabForwardBetweenControls(u,q,h,f)}return t._endFixBoxShadow(),!1},_onKeyPressTime:function(n,t){var u=t.element,q=t.currentCalendarUpdateObject,r=$(document.activeElement);switch(n.which){case t.spaceKey:r.hasClass("timepicker-ok-button")?q.timeContent.find(".timepicker-ok-button").trigger("click"):r.hasClass("timepicker-cancel-button")&&q.timeContent.find(".timepicker-cancel-button").trigger("click");break;case t.enterKey:r.hasClass("timepicker-cancel-button")?q.timeContent.find(".timepicker-cancel-button").trigger("click"):q.timeContent.find(".timepicker-ok-button").trigger("click");break;case t.escKey:u[0].style.display="none";t.calendarPopup.popupwindow("close");t.calendarPopup=null;break;case t.upKey:case t.downKey:case t.leftKey:case t.rightKey:t._moveBetweenTimeElements(q.timeContent,n.keyCode);break;case t.tabKey:n.shiftKey?t._tabBackBetweenControls(!1,q,null):t._tabForwardBetweenControls(!1,q,null,null)}return!1},_onTopCalendarItemFocus:function(n){n.data.currentCalendar.topCalendarEl.find(".today-title").addClass("hide-browser-highlight").addClass("active");n.data.currentCalendar.isTopItemSelected=!0},_onTopCalendarItemBlur:function(n){n.data.currentCalendar.topCalendarEl.find(".today-title").removeClass("hide-browser-highlight").removeClass("active");n.data.currentCalendar.isTopItemSelected=!1},_focusCalendarItem:function(n){if(n.hasClass("day")){var r=n.attr("calendarDate"),u=this._convertDateStringToObject(r),f=this._getParticularFormatForDate("D",u);if(this.currentCalendarUpdateObject.calendarContent.closest(".calendar-outline").find(".today-text-value").text(f),n.hasClass("not-of-current-month")){for(var q=n[0].className.split(" "),t=0;t<q.length;t++)q[t].indexOf("xy_")===0&&(q[t].length===6&&q[t][5]==="0"?this._drawDayCalendar(this.firstDateOnScreen.clone()):this._drawDayCalendar(this.lastDateOnScreen.clone()));n=this.currentCalendarUpdateObject.calendarContent.find("[calendarDate='"+r+"']")}}this.currentCalendarUpdateObject.calendarContent.find(".active").removeClass("active");checkExists(n)?(n.addClass("active"),n.trigger("focus")):_this._focusFirstCalendarItem()},_focusFirstCalendarItem:function(){var q=this.currentCalendarUpdateObject,n=q.calendarContent;if(n.length>0){var t=null;t=this.mode==="day"?n.find(".day:not(.not-of-current-month)").first():n.find(".xy_0_0");checkExists(t)&&this._focusCalendarItem(t)}},_focusActiveCalendarItem:function(){var n=this.currentCalendarUpdateObject.calendarContent.find(".active").first();n.length>0?this._focusCalendarItem(n):this._focusFirstCalendarItem()},_selectCalendarItem:function(n,t){var q=this.currentCalendarUpdateObject;if(itemContainer=q.calendarContent,this.mode==="day"){var r=itemContainer.find(".day.active");r.trigger("click");q.isDateTime&&t&&q.timeContent.find(".timepicker-ok-button").trigger("click")}else{var u=itemContainer.find(".active"),f=q.textbox.data("format");(this.mode==="month"||this.mode==="year")&&u.trigger("click")}return!0},_focusTimeControls:function(){var n=$(this.currentCalendarUpdateObject.spinnerWrapper.find(".spinner-text-input")[0]);n.trigger("focus").trigger("select");this.currentCalendarUpdateObject.isTimeFocused=!0},_getElementForDirection:function(n,t,q){for(var e=n[0].className.split(" "),o=null,l=!1,f=0;f<e.length;f++)e[f].indexOf("xy_")===0?o=e[f].replace("xy_","").split("_"):e[f]==="day"&&(l=!0);if(o.length===2){var a=q.find("[class*='xy_']"),s=q.find("[class*='xy_0_']").length,h=0;a.length>0&&s>0&&(h=a.length/s);var u=parseInt(o[0]),r=parseInt(o[1]);switch(t){case this.leftKey:u--;break;case this.upKey:r--;break;case this.rightKey:u++;break;case this.downKey:r++}if(u<0?(u=h-1,r--):u>=h&&(u=0,r++),r<0){this._pageTopItems(this.leftKey);var c=parseInt(this.currentCalendarUpdateObject.calendarContent.find(".week").length,10);if(checkExists(c))if(l)for(r=c-2;q.find(".xy_"+u+"_"+r).hasClass("not-of-current-month");)r--;else r=c-1;else r=0}else if(r>=s)for(this._pageTopItems(this.rightKey),r=0;q.find(".xy_"+u+"_"+r).hasClass("not-of-current-month");)r++;var v=this.currentCalendarUpdateObject.calendarContent.find(".xy_"+u+"_"+r);return v.length>0?v:null}return null},_pageTopItems:function(n){var t=this.currentCalendarUpdateObject,h=t.calendarContent.find(".active");if(n===this.leftKey?t.topCalendarEl.find(".top-calendar-left").trigger("click"):n===this.rightKey&&t.topCalendarEl.find(".top-calendar-right").trigger("click"),t=this.currentCalendarUpdateObject,this.mode==="day"){var u=new Date(t.calendarOutsideEl.find(".today-text-value").text()),f=this._convertDateStringToObject(t.calendarContent.find(".day:not(.not-of-current-month)")[0].getAttribute("calendardate")),e=f.getMonth(),o=f.getFullYear(),r=u.getDate(),q=u,s=Date.daysInMonth(e,o);r>s&&(r=s);q.setDate(1);q.setFullYear(o);q.setMonth(e);q.setDate(r);var c=this._convertDateObjToString(q);t.calendarContent.find(".selected").removeClass("selected");t.calendarContent.find("[calendarDate='"+c+"']").addClass("active")}else if(this.mode==="month"){var l=t.calendarContent.find("a[month="+h[0].getAttribute("month")+"]");l.addClass("active")}},_tabBackBetweenControls:function(n,t){if(t.isTime)this._tabBackBetweenTimeControls(t);else if(n)t.isDateTime?(t.isTimeFocused=!0,t.timeContent.find(".timepicker-cancel-button").trigger("focus")):this._focusActiveCalendarItem();else if(t.isTimeFocused){if(t.isDateTime){var q=$(document.activeElement);q.attr("type")==="radio"?(t.isTimeFocused=!1,this._focusActiveCalendarItem()):this._tabBackBetweenTimeControls(t)}}else t.topCalendarEl.find(".today-title").trigger("focus")},_tabBackBetweenTimeControls:function(n){var q=$(document.activeElement);if(q.attr("type")==="text"){var t=n.timeContent.find(".spinner-text-input"),r=t.index(q);return r===0?(n.isTimeFocused=!1,this._focusActiveCalendarItem()):(t[r-1].focus(),t[r-1].select()),!1}if(q.hasClass("timepicker-ok-button")){var t=n.timeContent.find(".spinner-text-input"),u=t[t.length-1];u.focus();u.select()}else q.hasClass("timepicker-cancel-button")&&n.timeContent.find(".timepicker-ok-button").trigger("focus")},_tabForwardBetweenControls:function(n,t,q,r){n?(t.topCalendarEl.find(".today-title").trigger("blur"),r.length>0?this._focusActiveCalendarItem():this._focusFirstCalendarItem()):t.isDateTime&&!t.isTimeFocused&&r.length>0?this._focusTimeControls():t.isDateTime||t.isTime?this._tabForwardBetweenTimeControls(t):t.topCalendarEl.find(".today-title").trigger("focus")},_tabForwardBetweenTimeControls:function(n){var t=$(document.activeElement);if(t.attr("type")==="radio"){var u=n.spinnerWrapper.find(".spinner-text-input[inputindex='0']");u.trigger("focus").trigger("select")}else if(t.attr("type")==="text"){var q=n.timeContent.find(".spinner-text-input"),r=q.index(t);if(r===q.length-1){var f=n.timeContent.find(".timepicker-ok-button");t.removeClass("active");SourceCode.Forms.Browser.msie&&(document.selection?document.selection.empty():window.getSelection&&window.getSelection().removeAllRanges());f.trigger("focus")}else q[r+1].focus(),q[r+1].select()}else t.hasClass("timepicker-ok-button")?n.timeContent.find(".timepicker-cancel-button").trigger("focus"):t.hasClass("timepicker-cancel-button")&&(n.isTimeFocused=!1,n.topCalendarEl.find(".today-title").trigger("focus"))},_moveBetweenTimeElements:function(n,t){var f=$(document.activeElement);if(f.attr("type")==="radio"&&(t===this.rightKey||t===this.leftKey)){var q=n.find(".input-control-group.radio").find("label");if(q.length>1){var r=$(q[0]),e=$(q[1]),u=r.hasClass("checked");r.toggleClass("checked",!u);e.toggleClass("checked",u)}}}};CalendarUpdateObject=function(n,t,q,r){this.textbox=n?jQuery(n):null;this.button=jQuery(t);this.button.addClass("calender-control-button");this.calendarPickerOptions=q;var u=$(r.element);this.timeContent=null;this.spinnerWrapper=null;this.calendarOutsideEl=null;this.calendarContent=null;this.topCalendarEl=null;this.isDateTime=!1;this.isTime=!1;u.length>0&&(this.calendarOutsideEl=u.find(".calendar-content-outside"),this.calendarContent=checkExists(this.calendarOutsideEl)?this.calendarOutsideEl.find(".calendar-content"):null,this.topCalendarEl=u.find(".top-calendar"),checkExists(q)&&(this.isDateTime=q.type==="dateTimePicker",this.isTime=q.type==="timePicker"),(this.isDateTime||this.isTime)&&(this.timeContent=u?u.find(".timepicker-content"):null,this.spinnerWrapper=this.timeContent?this.timeContent.find(".spinner"):null));this.isTimeFocused=!1;this.selectedDate=null};
/*!
 ~/Script/native.Forms.window.js
*/
(function(n){var t={getWidth:function(){return this.webkit419?this.innerWidth:this.opera?document.body.clientWidth:document.documentElement.clientWidth},getHeight:function(){return this.webkit419?this.innerHeight:this.opera?document.body.clientHeight:document.documentElement.clientHeight},getScrollWidth:function(){return this.ie?Math.max(document.documentElement.offsetWidth,document.documentElement.scrollWidth):this.webkit?document.body.scrollWidth:document.documentElement.scrollWidth},getScrollHeight:function(){return this.ie?Math.max(document.documentElement.offsetHeight,document.documentElement.scrollHeight):this.webkit?document.body.scrollHeight:document.documentElement.scrollHeight},getScrollLeft:function(){return this.pageXOffset||document.documentElement.scrollLeft},getScrollTop:function(){return this.pageYOffset||document.documentElement.scrollTop},getSize:function(){return{size:{x:this.getWidth(),y:this.getHeight()},scrollSize:{x:this.getScrollWidth(),y:this.getScrollHeight()},scroll:{x:this.getScrollLeft(),y:this.getScrollTop()}}},getPosition:function(){return{x:0,y:0}}};n.extend(window.prototype,t)})(jQuery);
/*!
 ~/Script/jquery.Forms.utilities.compare.js
*/
(function(n){n.compare=function(t,q){var r,u;for(key in t)if(t.hasOwnProperty(key)&&q.hasOwnProperty(key)){if(r=t[key],u=q[key],r&&typeof r=="object"&&u&&typeof u=="object"){if(!n.compare(r,u))return!1}else if(r!==u)return!1}else return!1;for(key in q)if(t.hasOwnProperty(key)&&q.hasOwnProperty(key)){if(r=t[key],u=q[key],r&&typeof r=="object"&&u&&typeof u=="object"){if(!n.compare(u,r))return!1}else if(r!==u)return!1}else return!1;return!0}})(jQuery);
