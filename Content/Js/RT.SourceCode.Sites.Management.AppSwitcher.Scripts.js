/*!
 SourceCode.Forms.Controls.Web.ManagementControlPack.AppSwitcher.Resources.Script.AppSwitcherBehavior.js (Embedded resource)
*/
(function(n){n.widget("sfc.SFCAppSwitcher",{appSwitcherCommon:null,appSwitcherPopulate:null,pageNumber:1,pageSize:10,currentWorkspaceID:null,options:{serverControlType:"AppSwitcher"},_create:function(){this.appSwitcherCommon=new SourceCode.Forms.Controls.Web.Management.AppSwitcherCommon(this);this.appSwitcherPopulate=new SourceCode.Forms.Controls.Web.Management.AppSwitcherPopulate(this)},_showHide:function(){this.element.toggleClass("hidden")},applyChanges:function(){}})})(jQuery);
/*!
 SourceCode.Forms.Controls.Web.ManagementControlPack.AppSwitcher.Resources.Script.AppSwitcherCommon.js (Embedded resource)
*/
(typeof SourceCode=="undefined"||SourceCode===null)&&(SourceCode={});(typeof SourceCode.Forms=="undefined"||SourceCode.Forms===null)&&(SourceCode.Forms={});(typeof SourceCode.Forms.Controls=="undefined"||SourceCode.Forms.Controls===null)&&(SourceCode.Forms.Controls={});(typeof SourceCode.Forms.Controls.Web=="undefined"||SourceCode.Forms.Controls.Web===null)&&(SourceCode.Forms.Controls.Web={});(typeof SourceCode.Forms.Controls.Web.Management=="undefined"||SourceCode.Forms.Controls.Web.Management===null)&&(SourceCode.Forms.Controls.Web.Management={});SourceCode.Forms.Controls.Web.Management.AppSwitcherCommon=function(n){this.widget=n};SourceCode.Forms.Controls.Web.Management.AppSwitcherCommon.prototype={OnUrlChangeCallBack:null,OnItemChangeCallBack:null,OnAppSwitcherClose:null,OnAppSwitcherPopulate:null,showHide:function(){this.widget._showHide()}};
/*!
 SourceCode.Forms.Controls.Web.ManagementControlPack.AppSwitcher.Resources.Script.AppSwitcherPopulate.js (Embedded resource)
*/
SourceCode.Forms.Controls.Web.Management.AppSwitcherPopulate=function(n){this.widget=n;this.appSwitcherCommon=this.widget.appSwitcherCommon};SourceCode.Forms.Controls.Web.Management.AppSwitcherPopulate.prototype={hasItems:null,parentWidget:null,isPopulating:null,isPopulatingApps:null,isPopulatingStatic:null,isPopulatingWorkspaces:null,populate:function(n){this.widget.element.empty();this.hasItems=!1;this.parentWidget=n;this.removeEmptyMessage();checkExists(this.widget.options.AppsSource)&&this.populateApps();checkExists(this.widget.options.AppsStaticSource)&&this.populateStaticApps();checkExists(this.widget.options.AppsWorkspaceSource)&&this.populateWorkspaces()},setIsPopulating:function(){this.isPopulatingApps||this.isPopulatingStatic||this.isPopulatingWorkspaces?this.isPopulating=!0:(this.isPopulating=!1,checkExists(this.appSwitcherCommon.OnAppSwitcherPopulate)&&this.appSwitcherCommon.OnAppSwitcherPopulate())},removeEmptyMessage:function(){var n=this.widget.element.find(".appswitcher-main-list");n.find(".appswitcher-main-empty").html("");n.find(".appswitcher-main-empty").addClass("hidden")},createEmptyMessage:function(){var n=this.widget.element.find(".appswitcher-main-list");n.find(".appswitcher-main-empty").html("No Apps Available");n.find(".appswitcher-main-empty").removeClass("hidden")},generateStaticAppItemContent:function(n){var t=this.appswitcherAppsItem();return t=t.replace("{type}",n.IconClass.htmlEncode()),t=t.replace("{url}",n.Url.htmlEncode()),t=t.replace("{display}",n.Display.htmlEncode()),t.replace("{tooltip}",n.Tooltip==null?n.Display.htmlEncode():n.Tooltip.htmlEncode())},generateWorkspaceItemContent:function(n){var t=this.appswitcherAppsItem();return t=t.replace("{url}","/Workspace/#?workspaceID="+n.ID.htmlEncode()),t=t.replace("{tooltip}",n.Tooltip==null?n.Name.htmlEncode():n.Tooltip.htmlEncode()),t=t.replace("{type}","SystemApp"),t.replace("{display}",n.Name.htmlEncode())},loadMorePage:function(){var n=this;this.widget.element.find(".appswitcher-loadmorebtn").data("enabled")&&(this.widget.element.find(".appswitcher-loadmorebtn").data("enabled",!1),$.ajax({url:applicationRoot+"SourceCode.Forms.Controls.Web.ControlPack.AppSwitcherHandler.handle",data:{SmartObjectMethod:n.widget.options.AppsWorkspaceSource.SmartObjectMethod,SmartObjectId:n.widget.options.AppsWorkspaceSource.SmartObjectId,pageSize:n.widget.pageSize,pageNumber:n.widget.pageNumber,currentWorkspace:this.widget.currentWorkspaceID},type:"GET",success:n.populateWorkspacesSuccess.bind(n)}))},createCategoryTitle:function(n,t){var u=this,q=document.createElement("div"),r=document.createElement("div");if($(q).addClass("appswitcher-category-title-container"),$(r).addClass("appswitcher-category-title"),$(r).addClass("category-title-"+n),$(r).html(n),$(q).append(r),t){var f=document.createElement("div");$(f).addClass("appswitcher-main-close");$(q).append(f);$(f).on("click",function(){u.appSwitcherCommon.OnAppSwitcherClose&&u.appSwitcherCommon.OnAppSwitcherClose();u.widget._showHide()})}return q},populateApps:function(){var n=this.createCategoryTitle("SITES",!1),t=this.widget.element;$(t).prepend(n)},populateWorkspaces:function(){this.isPopulating=!0;this.isPopulatingWorkspaces=!0;var f=this.createCategoryTitle("WORKSPACES",!0),u=this.widget.element,n=this,t=document.createElement("div");$(t).addClass("hidden appswitcher-loadmorebtn");$(t).data("enabled",!1);$(t).text(this.parentWidget.navigationResources.LoadMore);var q=document.createElement("div");$(q).addClass("appswitcher-workspaces-container");var r=document.createElement("div");$(r).addClass("appswitcher-workspaces-list");$(q).append(r);$(q).append(t);$(u).prepend(q);$(t).on("click",this.loadMorePage.bind(n));$(u).prepend(f);$(r).append('<div class="ajaxLoader inner-modal"><\/div>');SourceCode.Forms.Controls.Web.ControlPack.Utils.SetSimpleScrollbar(r);$.ajax({url:applicationRoot+"SourceCode.Forms.Controls.Web.ControlPack.AppSwitcherHandler.handle",data:{SmartObjectMethod:this.widget.options.AppsWorkspaceSource.SmartObjectMethod,SmartObjectId:this.widget.options.AppsWorkspaceSource.SmartObjectId,pageSize:this.widget.pageSize,pageNumber:this.widget.pageNumber,currentWorkspace:this.widget.currentWorkspaceID},type:"GET",success:n.populateWorkspacesSuccess.bind(n),error:function(t){SourceCode.Forms.ExceptionHandler.handleException(parseXML(t.responseText));n.isPopulatingWorkspaces=!1;n.setIsPopulating()}})},populateWorkspacesSuccess:function(n){try{var t=this,o=t.widget.element.find(".appswitcher-workspaces-list"),r=o;r.find(".simplebar-content").length>0&&(r=r.find(".simplebar-content"));for(var a=$(".management .view .management-logo-container span.management-logo"),v=t.widget.element,q=JSON.parse(n),u=0;u<q.length;u++)if(t.hasItems=!0,!checkExists(q[u].IsDefault)||q[u].IsDefault||!checkExists(q[u].IsVisible)||q[u].IsVisible){var f=$(t.generateWorkspaceItemContent(q[u]));f.addClass("iconStateContainer");var e=f.find(".PART-AppDisplay"),y=e.text().length;if(y>30){var p=f.find(".PART-AppDisplay").text().substr(0,30),w=f.find(".PART-AppDisplay").text();e.text(p);r.append(f);var b=e.outerWidth();e.text(w);e[0].style.width=b.toString()+"px"}else r.append(f),e[0].style.width="auto"}if(q.length===0){t.widget.element.find(".category-title-WORKSPACES").parent().addClass("hidden");t.widget.element.find(".appswitcher-workspaces-container").addClass("hidden");var c=t.widget.element.find(".category-title-SITES");c.addClass("emptyworkspaces");var k=c.parent(),l=$('<div class="appswitcher-main-close"><\/div>');k.append(l);l.on("click",function(){t.appSwitcherCommon.OnAppSwitcherClose&&t.appSwitcherCommon.OnAppSwitcherClose();t.widget._showHide()})}var s=t.widget.element.find(".appswitcher-loadmorebtn");checkExists(q[0])&&checkExists(q[0].hasMorePages)&&q[0].hasMorePages?(s.removeClass("hidden"),s.data("enabled",!0)):(s.addClass("hidden"),s.data("enabled",!1));r.find(".PART-AppUrl").on("click",function(){var n=$(this).attr("data-selectedvalue");SourceCode.Forms.Controls.Web.Management.AppSwitcherCollapse(a,v);window.open(".."+n,"_blank")});r.find(".ajaxLoader").remove();t.hasItems||t.createEmptyMessage();t.widget.element.find(".appswitcher-loadmorebtn").data("enabled",!0);var h=SimpleBar.instances.get(o[0]);h||(h=SourceCode.Forms.Controls.Web.ControlPack.Utils.SetSimpleScrollbar(o[0]));window.setTimeout(function(){var n=r.height()-o.height();o.find(".simplebar-content-wrapper").animate({scrollTop:n},500)},250);h.recalculate();t.widget.pageNumber+=1;t.setIsPopulating()}catch(d){t.setIsPopulating()}finally{t.isPopulatingWorkspaces=!1}},populateStaticApps:function(){if(this.isPopulating=!0,this.isPopulatingStatic=!0,!checkExists(this.widget.options.AppsSource)){var t=this.createCategoryTitle("SITES",!1),q=this.widget.element;$(q).prepend(t)}var n=this;$.ajax({url:applicationRoot+"SourceCode.Forms.Controls.Web.ControlPack.AppSwitcherHandler.handle",data:{Method:"GETAUTHORIZEDSITES",CurrentApp:n.widget.options.CurrentApp},type:"GET",success:n.populateStaticAppsSuccess.bind(n),error:function(n){SourceCode.Forms.ExceptionHandler.handleException(parseXML(n.responseText));this.isPopulatingStatic=!1;this.setIsPopulating()}})},populateStaticAppsSuccess:function(n){var t=this,e=JSON.parse(n),r=$('<div class="appswitcher-main-list"><div class="appswitcher-main-empty hidden"><\/div><\/div>'),o=$(".management .view .management-logo-container span.management-logo"),s=t.widget.element;r.appendTo(t.widget.element);for(var u=this.widget.options.AppsStaticSource.AppsStaticItems,q=0;q<u.length;q++)if(t.IsAuthorized(e,u[q])){t.hasItems=!0;var f=t.generateStaticAppItemContent(u[q]);u[q].Url.substr(1).toLowerCase()===this.widget.options.CurrentApp.toLowerCase()&&(f=$(f).addClass("currentapp"));r.prepend(f)}r.find(".PART-AppUrl").on("click",function(){var n=$(this).attr("data-selectedvalue");SourceCode.Forms.Controls.Web.Management.AppSwitcherCollapse(o,s);window.open(".."+n,"_blank")});r.find(".ajaxLoader").remove();this.isPopulatingStatic=!1;this.setIsPopulating()},IsAuthorized:function(n,t){return t!=null?this.parentWidget.base._booleanConverter(n[t.Display]):!1},selectApp:function(n,t){var q=$(n).data("selectedvalue");checkExists(t.appSwitcherCommon.OnUrlChangeCallBack)&&this.appSwitcherCommon.OnUrlChangeCallBack(q)},selectItem:function(n,t){t.element.find(".appswitcher-workspace-item").removeClass("selected");$(n).find(".appswitcher-workspace-item").addClass("selected");t.element.find(".PART-WorkspaceUrl").removeClass("selected");$(n).addClass("selected");var q=$(n).data("workspacevalue");checkExists(t.appSwitcherCommon.OnItemChangeCallBack)&&this.appSwitcherCommon.OnItemChangeCallBack(q)},appswitcherAppsItem:function(){return'                                                                                                                        <div class="PART-AppUrl" data-selectedvalue="{url}" title="{tooltip}" href="javascript:void(0);">                           <div class="appswitcher-item">                                                                                              <div class="PART-AppIcon appswitcher-icon appswitcher-icon-{type}"><\/div>                                               <div class="PART-AppDisplay appswitcher-appdisplay">{display}<\/div>                                                 <\/div>                                                                                                              <\/div>'}};
