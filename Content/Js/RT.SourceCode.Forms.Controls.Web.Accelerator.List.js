/*!
 SourceCode.Forms.Controls.Web.Accelerator.ControlsBase.js (Embedded resource)
*/
(function(n){(typeof SourceCode=="undefined"||SourceCode===null)&&(SourceCode={});(typeof SourceCode.Forms=="undefined"||SourceCode.Forms===null)&&(SourceCode.Forms={});(typeof SourceCode.Forms.Controls=="undefined"||SourceCode.Forms.Controls===null)&&(SourceCode.Forms.Controls={});(typeof SourceCode.Forms.Controls.Web=="undefined"||SourceCode.Forms.Controls.Web===null)&&(SourceCode.Forms.Controls.Web={});(typeof SourceCode.Forms.Controls.Web.Accelerator=="undefined"||SourceCode.Forms.Controls.Web.Accelerator===null)&&(SourceCode.Forms.Controls.Web.Accelerator={});var t;SourceCode.Forms.Controls.Web.Accelerator.ControlsBase=t=n.extend({},SourceCode.Forms.Controls.Base.ControlType,{_getInstance:function(t){var q=n("#"+t);if(q.length==0)throw"'"+t+"'(Control) not found";else return q},_getWidgetName:function(n){var t=n.data("SFCWidgetName");return checkExists(t)||(t=n[0].getAttribute("data-widget"),n[t]()),t},_callWidget:function(n,q){return n[t._getWidgetName(n)].apply(n,q)},getProperty:function(q){var r=n(t._getInstance(q.CurrentControlId)),u=t._callWidget(r,["option",q.property]);return u===r?null:u},setProperty:function(q){var r=n(t._getInstance(q.CurrentControlId));return t._callWidget(r,["option",q.property,q.Value])},getValue:function(q){var r=n(t._getInstance(q.CurrentControlId));return t._getProperty(r,"value")},getDefaultValue:function(q){var r=n(t._getInstance(q.CurrentControlId)),u=t._getProperty(r,"defaultValue");return u===r?null:u},setValue:function(q){var r=n(t._getInstance(q.CurrentControlId));t._setProperty(r,"value",q.Value)},setValueWithOnSet:function(q){var r=n(t._getInstance(q.CurrentControlId)),u=t._setProperty(r,"value",q.Value);return raiseEvent(q.CurrentControlId,"Control","OnSet"),q.returnResult?t._getProperty(r,"settingItems")===!1?u:!1:void 0},execute:function(n){var q=t._getInstance(n.CurrentControlID),r=t._callWidget(q,["execute",n]);return r===q?null:r},validate:function(q){var r=n(t._getInstance(q.CurrentControlId));t._callWidget(r,["validate",q])},settingItems:function(q){var r=n(t._getInstance(q.CurrentControlId));t._setProperty(r,"settingItems",!0);q.modalizeView=!1},setItems:function(q){var r=n(t._getInstance(q.CurrentControlId));t._setProperty(r,"jsonData",q.JsonData)},setFixedListItems:function(n,q){var r=n.find(".SFC");t._setProperty(r,"fixedListItems",q)},_setProperty:function(n,q,r){return t._callWidget(n,["option",q,r])},_getProperty:function(n,q){return t._callWidget(n,["option",q])},setStyles:function(q,r){var u=n(q).find(".SFC");return t._setProperty(u,"styles",r)},setWidth:function(q,r){var u=n(q).find(".SFC");return SourceCode.Forms.Controls.Base.ControlType.setWidth(q,u,r,0),t._getWidgetName(u),u.outerWidth(!0)},setHeight:function(q,r,u){var f=n(q).find(".SFC");typeof r=="undefined"&&(r="375px");r=r.trim();var e=q.data().type;if(checkExists(e)||(e=q.attr("controltype")),!checkExists(e))return null;e=e.toLowerCase();var v=q.find(".resizewrapper :not(.controloverlay):not(.ui-resizable-handle)").first(),o=q.find(".resizewrapper"),s="100px";if(u){var c=parseXML(u);s=c.selectSingleNode('//Properties/Property[Name/text()="Height"]/Value')}if(r){r=parseFloat(r)+"px";q.length>0&&(q[0].style.height=r);o.each(function(){this.style.height="100%"});f[0].style.height=r;var l=f.outerHeight(!0);if(t._resizeWrappersToHeight(q,o,f,l),(!checkExists(s)||s.text==="")&&q.is(":visible")){var a=q.hasClass("form-control");if(a){var h=q.data("panel");checkExists(h)&&(h.equalizeWidths(),h.equalizeHeights())}}}else t._resizeWrappersToHeight(q,o,f,"auto");return t._getWidgetName(f),f.outerHeight(!0)},setTabIndex:function(n,q){var r=n.find(".SFC");t._setProperty(r,"tabIndex",q)},_resizeWrappersToHeight:function(n,t,q,r){q[0].style.height=r;var u=q.outerHeight(!0)+"px";t.each(function(){this.style.height=u});n.length>0&&(n[0].style.height=u)},createDefaultViewInitRule:function(n){var e=SourceCode.Forms.Designers.View.ViewDesigner,t=e.View.viewDefinitionXML,v=t.selectSingleNode("//View"),l=v.selectSingleNode("Events"),w=e._GetViewID(),q=!0,b=ControlResources.SourceCode.Forms.Controls.Web.ControlPack.Properties.ReportingCommon.ViewInitRule,st=v.selectSingleNode("Controls/Control[@ID='"+n.controlid+"']/Properties"),h=v.selectSingleNode("Controls/Control[@ID='"+n.controlid+"']/Properties/Property[Name='Dropped']");if(checkExists(h)){if(h.selectSingleNode("/Value").nodeValue==="true")return}else{h=t.createElement("Property");var k=t.createElement("Name"),d=t.createElement("Value");k.appendChild(t.createTextNode("Dropped"));d.appendChild(t.createTextNode("true"));h.appendChild(k);h.appendChild(d);st.appendChild(h)}$chk(l)==!1&&(l=t.createElement("Events"),v.appendChild(l),q=!1);var r=q?l.selectSingleNode("Event[(@SourceType='View') and (@SourceID='"+w+"') and (@Type='User') and (Name/text()='Init')]"):null;r==null&&(r=t.createElement("Event"),r.setAttribute("Type","User"),r.setAttribute("SourceType","View"),r.setAttribute("SourceID",w),r.setAttribute("ID",(new String).generateGuid()),r.setAttribute("DefinitionID",(new String).generateGuid()),l.appendChild(r),q=!1);var y=q?r.selectSingleNode("Name"):null;y==null&&(y=t.createElement("Name"),y.appendChild(t.createTextNode("Init")),r.appendChild(y));var u=q?r.selectSingleNode("Properties"):null;u==null&&(u=t.createElement("Properties"),r.appendChild(u),q=!1);var g=u.selectSingleNode("Property[Name='Location']");g!=null&&u.removeChild(g);u.appendChild(e._createEventingPropertyWithEncoding(t,"Location",e._GetViewName()));var nt=u.selectSingleNode("Property[Name='ViewID']");nt!=null&&u.removeChild(nt);u.appendChild(e._createEventingPropertyWithEncoding(t,"ViewID",w));var tt=u.selectSingleNode("Property[Name='RuleName']");tt!=null&&u.removeChild(tt);u.appendChild(e._createEventingPropertyWithEncoding(t,"RuleName",b));var qt=u.selectSingleNode("Property[Name='RuleFriendlyName']");qt!=null&&u.removeChild(qt);u.appendChild(e._createEventingPropertyWithEncoding(t,"RuleFriendlyName",b));var a=q?r.selectSingleNode("Handlers"):null;a==null&&(a=t.createElement("Handlers"),r.appendChild(a),q=!1);var o=q?a.selectSingleNode("Handler"):null;o==null&&(o=t.createElement("Handler"),o.setAttribute("ID",(new String).generateGuid()),o.setAttribute("DefinitionID",(new String).generateGuid()),a.appendChild(o),q=!1);var c=q?o.selectSingleNode("//Properties"):null;c==null&&(c=t.createElement("Properties"),o.appendChild(c),q=!1);var rt=q?c.selectSingleNode("Property[Name/text()='Location']"):null;rt!=null&&c.removeChild(rt);c.appendChild(e._createEventingPropertyWithEncoding(t,"Location","view"));var p=q?o.selectSingleNode("Actions"):null;p==null&&(p=t.createElement("Actions"),o.appendChild(p),q=!1);var s=q?r.selectSingleNode("Handlers/Handler/Actions/Action/Properties/Property[(Name/text()='ControlID') and (Value/text()='"+n.controlid+"')]"):null;s==null&&(s=t.createElement("Action"),s.setAttribute("Type","ExecuteControl"),s.setAttribute("DefinitionID",(new String).generateGuid()),s.setAttribute("ID",(new String).generateGuid()),s.setAttribute("ExecutionType","Synchronous"),p.appendChild(s),q=!1);var f=q?s.selectSingleNode("Properties"):null;f==null&&(f=t.createElement("Properties"),s.appendChild(f),q=!1);var ut=q?f.selectSingleNode("Property[Name/text()='Method']"):null;ut!=null&&f.removeChild(ut);f.appendChild(e._createEventingPropertyWithEncoding(t,"Method",n.refMethod));var ft=q?f.selectSingleNode("Property[Name/text()='ViewID']"):null;ft!=null&&f.removeChild(ft);f.appendChild(e._createEventingPropertyWithEncoding(t,"ViewID",e._GetViewID()));var et=q?f.selectSingleNode("Property[Name/text()='ControlID']"):null;et!=null&&f.removeChild(et);f.appendChild(e._createEventingPropertyWithEncoding(t,"ControlID",n.controlid));var ot=q?f.selectSingleNode("Property[Name/text()='Location']"):null;ot!=null&&f.removeChild(ot);f.appendChild(e._createEventingPropertyWithEncoding(t,"Location","View"))},createDefaultFormInitRule:function(t){var h=SourceCode.Forms.Designers.View.ViewDesigner,q=SourceCode.Forms.Designers.Form.definitionXml,c=q.selectSingleNode("//Form"),v=c.selectSingleNode("//Events"),b=c.getAttribute("ID"),u=!0,ft=ControlResources.SourceCode.Forms.Controls.Web.ControlPack.Properties.ReportingCommon.FormInitRule,et=c.selectSingleNode("Controls/Control[@ID='"+t.controlid+"']/Properties"),l=c.selectSingleNode("Controls/Control[@ID='"+t.controlid+"']/Properties/Property[Name='Dropped']");if(checkExists(l)){if(l.selectSingleNode("/Value").nodeValue==="true")return}else{l=q.createElement("Property");var k=q.createElement("Name"),d=q.createElement("Value");k.appendChild(q.createTextNode("Dropped"));d.appendChild(q.createTextNode("true"));l.appendChild(k);l.appendChild(d);et.appendChild(l)}$chk(v)==!1&&(v=q.createElement("Events"),c.appendChild(v),u=!1);var r=u?v.selectSingleNode("Event[(@SourceType='Form') and (@SourceID='"+b+"') and (@Type='User') and (Name/text()='Init')]"):null;r==null&&(r=q.createElement("Event"),r.setAttribute("Type","User"),r.setAttribute("SourceType","Form"),r.setAttribute("SourceID",b),r.setAttribute("ID",(new String).generateGuid()),r.setAttribute("DefinitionID",(new String).generateGuid()),v.appendChild(r),u=!1);var p=u?r.selectSingleNode("Name"):null;p==null&&(p=q.createElement("Name"),p.appendChild(q.createTextNode("Init")),r.appendChild(p));var e=u?r.selectSingleNode("Properties"):null;e==null&&(e=q.createElement("Properties"),r.appendChild(e),u=!1);var g=e.selectSingleNode("Property[Name='Location']");g!=null&&e.removeChild(g);e.appendChild(h._createEventingPropertyWithEncoding(q,"Location",n(c.selectSingleNode("//Name")).text()));var nt=e.selectSingleNode("Property[Name='RuleName']");nt!=null&&e.removeChild(nt);e.appendChild(h._createEventingPropertyWithEncoding(q,"RuleName",ft));var y=u?r.selectSingleNode("Handlers"):null;y==null&&(y=q.createElement("Handlers"),r.appendChild(y),u=!1);var o=u?y.selectSingleNode("Handler"):null;o==null&&(o=q.createElement("Handler"),o.setAttribute("ID",(new String).generateGuid()),o.setAttribute("DefinitionID",(new String).generateGuid()),y.appendChild(o),u=!1);var a=u?o.selectSingleNode("//Properties"):null;a==null&&(a=q.createElement("Properties"),o.appendChild(a),u=!1);var tt=u?a.selectSingleNode("Property[Name/text()='Location']"):null;tt!=null&&a.removeChild(tt);a.appendChild(h._createEventingPropertyWithEncoding(q,"Location","form"));var w=o.selectSingleNode("Actions");w==null&&(w=q.createElement("Actions"),o.appendChild(w));var s=r.selectSingleNode("Handlers/Handler/Actions/Action/Properties/Property[(Name/text()='ControlID') and (Value/text()='"+t.controlid+"')]");s==null&&(s=q.createElement("Action"),s.setAttribute("Type","ExecuteControl"),s.setAttribute("DefinitionID",(new String).generateGuid()),s.setAttribute("ID",(new String).generateGuid()),s.setAttribute("ExecutionType","Synchronous"),w.appendChild(s));var f=s.selectSingleNode("Properties");f==null&&(f=q.createElement("Properties"),s.appendChild(f),u=!1);var qt=f.selectSingleNode("Property[Name/text()='Method']");qt!=null&&f.removeChild(qt);f.appendChild(h._createEventingPropertyWithEncoding(q,"Method",t.refMethod));var rt=f.selectSingleNode("Property[Name/text()='ControlID']");rt!=null&&f.removeChild(rt);f.appendChild(h._createEventingPropertyWithEncoding(q,"ControlID",t.controlid));var ut=f.selectSingleNode("Property[Name/text()='Location']");ut!=null&&f.removeChild(ut);f.appendChild(h._createEventingPropertyWithEncoding(q,"Location","Form"))},escapeSpecialChar:function(n){return n.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39")},formatSpecialChar:function(n){return n.replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"')}});var q;(typeof SourceCode.Forms.Controls.Web.Utils=="undefined"||SourceCode.Forms.Controls.Web.Utils===null)&&(SourceCode.Forms.Controls.Web.Utils={});SourceCode.Forms.Controls.Web.Accelerator.ControlsBase.Utils=q={MSAjaxReady:function(t){n(document).ready(function(){typeof addRuntimePendingCalls!="undefined"&&addRuntimePendingCalls(t)})},GetStylePreviewControl:function(){return SourceCode.Forms.Designers[SourceCode.Forms.Designers.Common.getDefinitionNode().tagName].Styles._getSelectedControl()},SetRulesMethodForOnSet:function(n){EventUtil.manageControlEvent(n);var t=n.designerDefinition.documentElement.selectSingleNode("Views/View"),r=t.selectSingleNode("//Controls/Control[@ID='"+n.controlId+"']/Properties/Property[Name = 'DisplayField']/Value"),q;r&&(q=r.text);var u={Events:[{SourceType:"Control",SourceID:n.controlId,Type:"System",Name:"OnSet",Handlers:[{Actions:[{ExecutionType:"Asynchronous",Type:"Transfer",ControlID:n.controlId,ViewID:n.designer._GetViewID(),Parameters:[{SourceType:"ViewField",SourceID:q,TargetType:"ControlProperty",TargetID:"InitialDisplayValue"}]}]}]}]},f=!1;switch(n.eventType.toLowerCase()){case"remove":case"changecontrol":f=!0}checkExists(q)&&!f?EventUtil.ensureEventingPattern(t,u,{replaceExisting:!0}):EventUtil.removeEventingPattern(t,u,{removeMatched:!0})},UnitHelper:function(n,t,q,r){return t=typeof t!="undefined"?t:"100%",q=typeof q!="undefined"?q:!0,r=typeof r!="undefined"?r:"3276[0-7]|327[0-5][0-9]|32[0-6][0-9]{2}|3[0-1][0-9]{3}|[1-2][0-9]{4}|[1-9][0-9]{0,3}|[0-9]",typeof n=="undefined"||!1||n.Length===0?t:/(100|[0-9]{1,2})+%$/.test(n)?q?n:t:new RegExp("^({0})px$".format(r),"i").test(n)?n:new RegExp("^({0})$".format(r)).test(n)?n+"px":t},Utf8:{encode:function(n){n=n.replace(/\r\n/g,"\n");for(var q="",r=0;r<n.length;r++){var t=n.charCodeAt(r);t<128?q+=String.fromCharCode(t):t>127&&t<2048?(q+=String.fromCharCode(t>>6|192),q+=String.fromCharCode(t&63|128)):(q+=String.fromCharCode(t>>12|224),q+=String.fromCharCode(t>>6&63|128),q+=String.fromCharCode(t&63|128))}return q},decode:function(n){for(var r="",t=0,q=0,u=0;t<n.length;)q=n.charCodeAt(t),q<128?(r+=String.fromCharCode(q),t++):q>191&&q<224?(u=n.charCodeAt(t+1),r+=String.fromCharCode((q&31)<<6|u&63),t+=2):(u=n.charCodeAt(t+1),c3=n.charCodeAt(t+2),r+=String.fromCharCode((q&15)<<12|(u&63)<<6|c3&63),t+=3);return r}},Base64:{_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(n){var e="",o,t,r,h,c,s,u,f=0;for(n=q.Utf8.encode(n);f<n.length;)o=n.charCodeAt(f++),t=n.charCodeAt(f++),r=n.charCodeAt(f++),h=o>>2,c=(o&3)<<4|t>>4,s=(t&15)<<2|r>>6,u=r&63,isNaN(t)===!0?s=u=64:isNaN(r)===!0&&(u=64),e=e+q.Base64._keyStr.charAt(h)+q.Base64._keyStr.charAt(c)+q.Base64._keyStr.charAt(s)+q.Base64._keyStr.charAt(u);return e},decode:function(n){var t="",o,s,h,c,f,u,e,r=0;for(n=n.replace(/[^A-Za-z0-9\+\/\=]/g,"");r<n.length;)c=q.Base64._keyStr.indexOf(n.charAt(r++)),f=q.Base64._keyStr.indexOf(n.charAt(r++)),u=q.Base64._keyStr.indexOf(n.charAt(r++)),e=q.Base64._keyStr.indexOf(n.charAt(r++)),o=c<<2|f>>4,s=(f&15)<<4|u>>2,h=(u&3)<<6|e,t=t+String.fromCharCode(o),u!=64&&(t=t+String.fromCharCode(s)),e!=64&&(t=t+String.fromCharCode(h));return q.Utf8.decode(t)}},ConvertDisplayTemplateObjectsToXml:function(n){for(var r=parseXML("<Template/>"),u=0;u<n.length;++u){var t=r.createElement("Item"),q=n[u];q.type==="value"?q.text!==""&&(t.setAttribute("SourceType","Value"),t.appendChild(r.createElement("SourceValue")).appendChild(r.createTextNode(q.data))):(t.setAttribute("SourceType",q.data.SourceType),t.setAttribute("SourceID",q.data.SourceID),t.setAttribute("DataType",q.data.DataType));r.documentElement.appendChild(t)}return r.xml},LoadDisplayTemplateIntoTokenboxArray:function(n,t){var q;try{q=parseXML(t)}catch(e){}if(!!q&&!!q.documentElement&&!q.getElementsByTagName("parsererror").length){var r=q.selectNodes("Template/Item");if(r!==null)for(var u=0;u<r.length;u++){var f=n.selectSingleNode("Items/Item[@ItemType='ObjectProperty'][Name[text()='{0}']]/DisplayName".format(r[u].getAttribute("SourceID")));f!==null&&r[u].setAttribute("DisplayValue",f.text)}return transformXmlToTokenboxArray(q)}},SaveXmlValueToControlProperties:function(n,t,q,r){var u=q(n,r);if(u)var f=u.valueText,e=u.displayText},TreeNodeFilterHelper:{xsltFile:null,treeXml:null,rulesWizardTree:null,treeContainerElement:null,setXSLTFile:function(n){this.xsltFile=n.data().ref},setTreeContainerElement:function(n){this.treeContainerElement=n},loadWorkflowTree:function(t){var s=n(' \t\t\t\t\t<div class="processTree" class="scroll-wrapper"> \t\t\t\t\t\t<ul class="tree collapsed-root"> \t\t\t\t\t\t\t<li class="root"> \t\t\t\t\t\t\t\t<a href="javascript:void(0);">Root<\/a> \t\t\t\t\t\t\t<\/li> \t\t\t\t\t\t<\/ul> \t\t\t\t\t<\/div> \t\t\t\t\t<div id="formProcessDiv"><\/div>'),u=new XslTransform;u.importStylesheet(this.xsltFile);u.addParameter("WorkflowsResourceName","Workflows");for(var q=parseXML(u.transformToText(t)),f=[],e=q.selectNodes("/nodes/node/node"),r=0,o=e.length;r<o;r++)f.push(e[r]);var h=q.getElementsByTagName("node")[0];q.childNodes[0].removeChild(h);for(var r=0,o=f.length;r<o;r++)q.childNodes[0].appendChild(f[r]);this.rulesWizardTree=s.find(".tree").tree();var c=this.rulesWizardTree.tree("find","root");this.rulesWizardTree.tree("loadXML",q,c);this.treeContainerElement.empty().append(this.rulesWizardTree);var l=this.treeContainerElement.find(".root");l.removeClass("closed").addClass("open");this.treeXml=q;this.treeContainerElement.on("mouseup",function(t){var r=n(t.target);r.removeClass("hidden");for(var u=r.find(".hidden"),q=0,f=u.length;q<f;q++)n(u[q]).removeClass("hidden")})},filteredXML:function(n,t){for(var u=0,h=n.length;u<h;u++){var q=n[u].getAttribute("text"),s=q.length;if(q.toUpperCase().indexOf(t.toUpperCase())>-1){var f="",e=0;if(t!=null&&t!="")while(e<n[u].getAttribute("text").length){var r=q.toUpperCase().indexOf(t.toUpperCase());if(r>-1){var o=t.length,c=q.substring(r,r+o);r>0&&(f+=q.substring(0,r));f+="<div class='highlight'>"+c+"<\/div>";q=q.substring(r+o,s);e=r+o}else f+=q,e=s}else t!=null&&(f=q);n[u].setAttribute("text",decodeURI(f))}var l=n[u].selectNodes("node");this.filteredXML(l,t)}},filterOut:function(t){var o=n(t).val(),b=this.rulesWizardTree.tree().tree("find","root"),f=[],k=n(' \t\t\t\t\t<div class="processTree" class="scroll-wrapper"> \t\t\t\t\t\t<ul class="tree collapsed-root"> \t\t\t\t\t\t\t<li class="root"> \t\t\t\t\t\t\t\t<a href="javascript:;">Root<\/a> \t\t\t\t\t\t\t<\/li> \t\t\t\t\t\t<\/ul> \t\t\t\t\t<\/div> \t\t\t\t\t<div id="formProcessDiv"><\/div>');this.treeContainerElement.html("");var s=parseXML(this.treeXml.xml);this.rulesWizardTree=k.find(".tree").tree();var b=this.rulesWizardTree.tree("find","root");if(this.filteredXML(s.selectNodes("/nodes/node"),o),this.rulesWizardTree.tree("loadXML",s,b),o.length===0){this.treeContainerElement.append(this.temp);this.rulesWizardTree=this.treeContainerElement.find(".tree").tree();var h=this.treeContainerElement.find(".root");h.removeClass("closed").addClass("open")}else{this.treeContainerElement.html("");this.treeContainerElement.append(this.rulesWizardTree);var h=this.treeContainerElement.find(".root");h.removeClass("closed").addClass("open");for(var c=this.rulesWizardTree.find("li"),q=0,e=c.length;q<e;q++){var u=n(c[q]);u.hasClass("root")||u.removeClass("selected open").addClass("closed")}for(var l=this.rulesWizardTree.find("a"),d=o.toUpperCase(),q=0,e=l.length;q<e;q++){var u=n(l[q]);u.removeClass("selected open").addClass("closed");u.text().toUpperCase().indexOf(d)!==-1?(f.push(u),u.addClass("match")):u.removeClass("match")}if(f.length>0){for(var q=0,e=f.length;q<e;q++){var a=n(f[q]);f.length===1&&a.parent().addClass("selected");var r=a;for(r=r.parent(),r.addClass("closed").removeClass("open");!r.hasClass("root");)r=r.parent(),r.addClass("open"),r.removeClass("closed")}for(var v=this.rulesWizardTree.find("li.workflows.closed, li.workflow.closed"),q=0,e=v.length;q<e;q++){var y=n(v[q]);y.find(".match").length===0&&y.addClass("hidden")}}else this.treeContainerElement.html(""),this.treeContainerElement.append("<span>{0}<\/span>".format(ControlResources.SourceCode.Forms.Controls.Web.ControlPack.Properties.Resources.searchNoResult))}for(var p=this.treeContainerElement.find(".workflow, .workflows"),q=0,e=p.length;q<e;q++){var w=n(p[q]);w.html(w.html().replace(/&lt;/g,"<").replace(/&gt;/g,">"))}}}};var r;SourceCode.Forms.Controls.Web.Accelerator.ControlsBase.CultureHelper=r={formatCurrencyForCurrentCulture:function(n,t,q){return this._ensureCurrentCultureExists(),r.formatCurrencyForCulture(SCCultureHelper.current.cultureObject.Name,n,t,q)},formatCurrencyForCulture:function(n,t,q,r){var u={formatObject:SCCultureHelper.current.getFormatObject('<Format Type="Currency" Culture="{0}">C<\/Format>'.format(n)),value:t};return this._booleanConverter(q)===!1?u.formatObject.cultureObject.CurrencySymbol="":checkExists(r)&&(u.formatObject.cultureObject.CurrencySymbol=r),SCCultureHelper.current.applyFormatToString(u)},_ensureCurrentCultureExists:function(){checkExists(SCCultureHelper.current)||SCCultureHelper.Current();checkExists(SCCultureHelper.current.cultureObject)||SCCultureHelper.current.getCultureObject(SCCultureHelper.current.currentCultureName)},getCurrencyDetails:function(n,t){this._ensureCurrentCultureExists();checkExists(SCCultureHelper.current.cultureObject)||SCCultureHelper.current.getCultureObject(n,t)},_booleanConverter:function(n){return["true","yes","1"].contains((n+"").toLowerCase())}}})(jQuery);
/*!
 SourceCode.Forms.Controls.Web.Accelerator.Resources.JS.ListBehavior.js (Embedded resource)
*/
EventUtil106={manageControlEvent:function(n){if(EventUtil106._validateContextObject(n,"manageControlEvent"))switch(n.eventType.toLowerCase()){case"create":EventUtil106.onControlCreated(n);break;case"remove":EventUtil106.onControlRemoved(n);break;case"changecontrol":EventUtil106.onControlChanged(n);break;default:LogInternalErrorMessage(Resources.ExceptionHandler.ErrorInFunction.format("EventUtil106106.manageControlEvent",Resources.ExceptionHandler.UnkownEventType))}},onControlCreated:function(n){EventUtil106._validateContextObject(n,"onControlCreated")&&EventUtil106._createDefaultControlEvents(n)},onControlRemoved:function(n){EventUtil106._validateContextObject(n,"onControlCreated")&&(n.designerType.toLowerCase()=="view"?EventUtil106._removeViewControlRules(n):n.designerType.toLowerCase()=="form"&&EventUtil106._removeFormControlRules(n))},onControlChanged:function(n){if(EventUtil106._validateContextObject(n,"onControlCreated")){if(!checkExists(n.changeToControlType)){LogInternalErrorMessage("EventUtil106.js","onControlChanged",Resources.ExceptionHandler.InvalidOperation.format("context.changeToControlType"));return}n.designer._cleanupControlBehaviours(n.controlId,!0)}},_removeFormControlRules:function(n){EventUtil106._validateContextObject(n,"_removeFormControlRules")&&n.designer.removeControlEvents(n.controlId)},_removeViewControlRules:function(n){if(EventUtil106._validateContextObject(n,"_removeViewControlRules")){var t="<div id='{0}' />".format(n.controlId);checkExists(n.dataSource)&&checkExists(n.dataSource.id)&&(t="<div id='{0}' soid='{1}' propertytype='{2}' propertyid='{3}' itemtype='{4}' layouttype='{5}' references='{6}' />",t=t.format(n.controlId,n.dataSource.id,n.dataSource.propertyType,n.dataSource.propertyId,n.dataSource.itemType,n.dataSource.layouttype,n.dataSource.references));n.designer._cleanupControl(t,!0)}},_createDefaultControlEvents:function(n){EventUtil106._validateContextObject(n,"_createDefaultControlEvents")&&(n.designerType.toLowerCase()=="view"?EventUtil106._createDefaultViewControlEvents(n):n.designerType.toLowerCase()=="form"&&EventUtil106._createDefaultFormControlEvents(n))},_createDefaultViewControlEvents:function(n){if(EventUtil106._validateContextObject(n,"_createDefaultViewControlEvents")){var t={controlid:n.controlId,controltype:n.controlType,fieldid:n.fieldId,controlDefaultProperties:n.controlDefaultProperties};n.designer.createControlEvents(n.designerDefinition,t)}},_createDefaultFormControlEvents:function(n){if(EventUtil106._validateContextObject(n,"_createDefaultFormControlEvents")){var t=n.designerDefinition.selectSingleNode("//Forms/Form/Controls/Control[@ID='{0}']".format(n.controlId));t!=null&&n.designer.addControlEvents(t)}},_validateContextObject:function(n,t){var q=!0;return checkExists(n)||(LogInternalErrorMessage("EventUtil106.js",t,Resources.ExceptionHandler.InvalidOperation.format("context")),q=!1),checkExists(n.eventType)||(LogInternalErrorMessage("EventUtil106.js",t,Resources.ExceptionHandler.InvalidOperation.format("context.eventType")),q=!1),checkExists(n.controlId)||(LogInternalErrorMessage("EventUtil106.js",t,Resources.ExceptionHandler.InvalidOperation.format("context.controlId")),q=!1),checkExists(n.controlType)||(LogInternalErrorMessage("EventUtil106.js",t,Resources.ExceptionHandler.InvalidOperation.format("context.controlType")),q=!1),checkExists(n.designerType)||(LogInternalErrorMessage("EventUtil106.js",t,Resources.ExceptionHandler.InvalidOperation.format("context.designerType")),q=!1),checkExists(n.designer)||(LogInternalErrorMessage("EventUtil106.js",t,Resources.ExceptionHandler.InvalidOperation.format("context.designer")),q=!1),checkExists(n.designerDefinition)||(LogInternalErrorMessage("EventUtil106.js",t,Resources.ExceptionHandler.InvalidOperation.format("context.designerDefinition")),q=!1),q},createEvent:function(n,t,q,r,u){r.toLowerCase()=="view"?u=n.selectSingleNode("SourceCode.Forms/Views/View").getAttribute("ID"):r.toLowerCase()=="form"&&(u=n.selectSingleNode("SourceCode.Forms/Forms/Form").getAttribute("ID"));var f=n.createElement("Event");f.setAttribute("ID",(new String).generateGuid());f.setAttribute("DefinitionID",(new String).generateGuid());f.setAttribute("Type",q);f.setAttribute("SourceID",u);f.setAttribute("SourceType",r);var e=n.createElement("Name");return e.appendChild(n.createTextNode(t)),f.appendChild(e),f},addHandler:function(n,t,q){var u=t.selectSingleNode("Handlers");u==null&&(u=n.createElement("Handlers"),t.appendChild(u));var r=n.createElement("Handler");return r.setAttribute("ID",(new String).generateGuid()),r.setAttribute("DefinitionID",(new String).generateGuid()),r.setAttribute("Type",q),u.appendChild(r),r},addAction:function(n,t,q,r){var f=t.selectSingleNode("Actions");f==null&&(f=n.createElement("Actions"),t.appendChild(f));var u=n.createElement("Action");return u.setAttribute("ID",(new String).generateGuid()),u.setAttribute("DefinitionID",(new String).generateGuid()),u.setAttribute("Type",q),u.setAttribute("ExecutionType",r),f.appendChild(u),u},addParameter:function(n,t,q,r,u,f,e,o){var h=t.selectSingleNode("Parameters");h==null&&(h=n.createElement("Parameters"),t.appendChild(h));var s=n.createElement("Parameter");return s.setAttribute("SourceID",q),s.setAttribute("SourceType",r),s.setAttribute("SourcePath",u),s.setAttribute("TargetID",f),s.setAttribute("TargetType",e),o===undefined?s.setAttribute("IsRequired","False"):s.setAttribute("IsRequired",o?"True":"False"),h.appendChild(s),s},addResult:function(n,t,q,r,u,f,e,o){var h=t.selectSingleNode("Results");h==null&&(h=n.createElement("Results"),t.appendChild(h));var s=n.createElement("Result");if(s.setAttribute("SourceID",q),s.setAttribute("SourceType",r),s.setAttribute("TargetID",u),s.setAttribute("TargetType",f),e===undefined?s.setAttribute("IsRequired","False"):s.setAttribute("IsRequired",e?"True":"False"),checkExists(o)){var c=n.createElement("SourceValue");c.appendChild(n.createTextNode(o));s.appendChild(c)}return h.appendChild(s),s},getActionParameterFromTarget:function(n,t,q,r){if(n!=null&&checkExists(r)&&r)for(var f=n.selectNodes("Parameters/Parameter"),u=0;u<f.length;u++){var e=f[u],o=e.getAttribute("TargetID").toLowerCase(),s=e.getAttribute("TargetType");if(o===t.toLowerCase()&&s===q)return n}else return n.selectSingleNode("Parameters/Parameter[@TargetID='{0}' and @TargetType='{1}']".format(t,q));return null},getActionParameterFromSource:function(n,t,q,r,u){return n==null?null:n.selectSingleNode("Parameters/Parameter[@SourceID='{0}' and @SourceType='{1}' and @TargetID='{2}' and @TargetType='{3}']".format(t,q,r,u))},getEvent:function(n,t,q,r,u){var f=null;return t.toLowerCase()=="view"?f="SourceCode.Forms/Views/View/Events/Event[@SourceType='{0}' and @Type='{1}'][Name[text()='{2}']]".format(u,r,q):t.toLowerCase()=="form"&&(f="SourceCode.Forms/Forms/Form/States/State/Events/Event[@SourceType='{0}' and @Type='{1}'][Name[text()='{2}']]".format(u,r,q)),n.selectSingleNode(f)},getDesignerName:function(n,t){var q=null;t.toLowerCase()=="view"?q="SourceCode.Forms/Views/View/Name":t.toLowerCase()=="form"&&(q="SourceCode.Forms/Forms/Form/Name");var r=n.selectSingleNode(q);return r!=null?r.text:null},addProperty:function(n,t,q,r){var u=t.selectSingleNode("Properties");u==null&&(u=n.createElement("Properties"),t.appendChild(u));var f=n.createElement("Property"),e=n.createElement("Name");e.appendChild(n.createTextNode(q));var o=n.createElement("Value");return o.appendChild(n.createTextNode(r)),f.appendChild(e),f.appendChild(o),u.appendChild(f),f},updateProperty:function(n,t,q,r){var s=t.selectSingleNode("Properties");s==null&&(s=n.createElement("Properties"),t.appendChild(s));var u=t.selectSingleNode("Properties/Property[Name[text()='{0}']]".format(q)),f=null,e=null;if(u===null){u=n.createElement("Property");s.appendChild(u);var f=n.createElement("Name");f.appendChild(n.createTextNode(q));var e=n.createElement("Value");e.appendChild(n.createTextNode(r));var o=n.createElement("DisplayValue");o.appendChild(n.createTextNode(r));u.appendChild(f);u.appendChild(e);u.appendChild(o)}else f=u.selectSingleNode("Name"),f===null?(f=n.createElement("Name"),f.appendChild(n.createTextNode(q)),u.appendChild(f)):(f.removeChild(f.childNodes[0]),f.appendChild(n.createTextNode(q))),e=u.selectSingleNode("Value"),e===null?(e=n.createElement("Value"),e.appendChild(n.createTextNode(r)),u.appendChild(e)):(e.removeChild(e.childNodes[0]),e.appendChild(n.createTextNode(r))),o=u.selectSingleNode("DisplayValue"),o===null?(o=n.createElement("DisplayValue"),o.appendChild(n.createTextNode(r)),u.appendChild(o)):(o.removeChild(o.childNodes[0]),o.appendChild(n.createTextNode(r)));return u},eventsPlural:"Events",eventsSingle:"Event",ensureEventingPattern:function(n,t,q){if(checkExists(q)||(q={}),checkExists(t)){var r=t.Events;if(checkExists(r)&&typeof r=="object"&&r.constructor===Array){var u=n.selectSingleNode(this.eventsPlural);if(!u){var e=n.ownerDocument;checkExists(e)||(e=n,n=e.documentElement);u=e.createElement(this.eventsPlural);n.appendChild(u)}for(var o=0;o<r.length;o++){var s=r[o],y=this._buildEventXPath(this.eventsPlural,this.eventsSingle,s),f=n.selectSingleNode(y),h="".generateGuid(),c="".generateGuid(),l=!0;if(f)if(q.replaceExisting){var a=f.getAttribute("ID");checkExists(a)&&(c=a);var v=f.getAttribute("DefinitonID");checkExists(v)&&(h=v);f.parentNode.removeChild(f)}else q.isFirst=!0,this._ensureEventNode(u,this.eventsSingle,s,q),l=!1;l===!0&&(q.identifiers={},q.identifiers[this.eventsSingle]=[],q.identifiers[this.eventsSingle].push({ID:c,DefinitionID:h,IsReference:"False"}),this._buildEventNode(u,this.eventsSingle,s,q));r[o]=s}}}},_getChildName:function(n){var t="";switch(n){case"SourceValue":t="Source";break;case"Properties":t="Property";break;default:t=n.substring(0,n.length-1)}return t},_findCorrectNodeXpath:function(n,t,q){var f=n;for(var u in t)if(checkExists(u)&&u!=="_removeFromThisLevel"){var r=t[u];if(checkExists(r)){var o={};if(typeof r=="object"&&r.constructor!==Array&&checkExists(r._valueToSet)&&(o=r,r=r._valueToSet),typeof r!="object"&&r.constructor!==Array){if(!o._alwaysReplace&&!o._ignoreChanges){var y=this._isEventAttribute(u);f+=y?"[@{0}={1}]".format(u.toString(),r.toString().xpathValueEncode()):"[{0}={1}]".format(u.toString(),r.toString().xpathValueEncode())}}else if(typeof r=="object"&&r.constructor!==Array){var a={};f+="[";f+="Properties";for(var s in r){var e=r[s];typeof e=="object"&&checkExists(e._valueToSet)&&(a=e,e=e._valueToSet);a._alwaysReplace||o._ignoreChanges||(f+="[Property[Name={0}][Value={1}]]".format(s.toString().xpathValueEncode(),r[s].toString().xpathValueEncode()))}f+="]"}else if(r.constructor===Array&&!q.isFirst){for(var v=this._getChildName(u),h="",c=0;c<r.length;c++){var p=r[c],l=this._findCorrectNodeXpath(v,p,q);l!==""&&l!==v&&(h+="["+l+"]")}h!==""&&(f+="["+u+h+"]")}}}return f},_ensureEventNode:function(n,t,q,r){var u=[];if(checkExists(r.isFirst)||(r.isFirst=!0,u=n.selectNodes(t)),u=n.selectNodes(this._findCorrectNodeXpath(t,q,r)),r.isFirst=!1,u.length===0)return this._buildEventNode(n,t,q,r),q;u=u[0];for(var e in q)if(checkExists(e)&&e!=="_removeFromThisLevel"){var f=q[e];if(checkExists(f)){var l={};if(typeof f=="object"&&f.constructor!==Array&&checkExists(f._valueToSet)&&(l=f,f=f._valueToSet),typeof f!="object"&&f.constructor!==Array){var y;if(l._alwaysReplace&&!l._ignoreChanges)if(y=this._isEventAttribute(e),y)u.setAttribute(e.toString(),f.toString());else{var s=u.selectSingleNode(e.toString());if(s||(s=u.ownerDocument.createElement(e.toString()),s.appendChild(u.ownerDocument.createTextNode(f.toString())),u.appendChild(s)),s.text!==f.toString()){while(s.childNodes.length>0)s.removeChild(s.childNodes[0]);s.appendChild(u.ownerDocument.createTextNode(f.toString()))}}l._returnValue&&(y=this._isEventAttribute(e),q[e]=y?u.getAttribute(e.toString()):u.selectSingleNode(e.toString()).text)}else if(typeof f=="object"&&f.constructor!==Array){var w={},a=u.selectSingleNode("Properties");a||(a=u.ownerDocument.createElement("Properties"),u.appendChild(a));for(var p in f){var h=f[p];typeof h=="object"&&checkExists(h._valueToSet)&&(w=h,h=h._valueToSet);var c=a.selectSingleNode("Property[Name={0}]".format(p.toString().xpathValueEncode())),o=null;if(c){if(w._alwaysReplace&&!l._ignoreChanges)if(o=c.selectSingleNode("Value"),o){while(o.childNodes.length)o.removeChild(o.childNodes[0]);o.appendChild(u.ownerDocument.createTextNode(h))}else o=u.ownerDocument.createElement("Value"),o.appendChild(u.ownerDocument.createTextNode(h)),c.appendChild(o)}else{c=u.ownerDocument.createElement("Property");var k=u.ownerDocument.createElement("Name");k.appendChild(u.ownerDocument.createTextNode(p.toString()));c.appendChild(k);o=u.ownerDocument.createElement("Value");o.appendChild(u.ownerDocument.createTextNode(h));c.appendChild(o);a.appendChild(c)}w._returnValue&&o&&(f[p]=o.text)}}else if(f.constructor===Array){var v=u.selectSingleNode(e),d=!0;v||(v=u.ownerDocument.createElement(e),u.appendChild(v),d=!1);for(var g=this._getChildName(e),b=0;b<f.length;b++){var nt=f[b];d?this._ensureEventNode(v,g,nt,r):this._buildEventNode(v,g,nt,r)}}}}},removeEventingPattern:function(n,t,q){if(checkExists(q)||(q={}),checkExists(t)){var f=t.Events;if(checkExists(f))for(var e=0;e<f.length;e++){var o=f[e],s=this._buildEventXPath(this.eventsPlural,this.eventsSingle,o),r=n.selectSingleNode(s);if(r)if(q.removeAll||o._removeFromThisLevel){var u=r.parentNode;u.removeChild(r);u.childNodes.length===0&&u.parentNode.removeChild(u)}else this._removeEventingPattern(r.parentNode,this.eventsSingle,o,q)}}},_removeEventingPattern:function(n,t,q,r){var u=n.selectNodes(t);if(u.length!==0&&(u.length>1&&(u=n.selectNodes(this._findCorrectNodeXpath(t,q,r))),u.length!==0))if(u=u[0],q._removeFromThisLevel){var e=u,n=e.parentNode;for(n.removeChild(e);n.childNodes.length==0;)e=n,n=n.parentNode,n.removeChild(e)}else for(var f in q)if(checkExists(f)&&f!=="_removeFromThisLevel"){var o=q[f];if(checkExists(o)&&o.constructor===Array){var h=u.selectSingleNode(f);if(h)for(var c=this._getChildName(f),s=0;s<o.length;s++){var l=o[s];this._removeEventingPattern(h,c,l,r)}}}},_isEventAttribute:function(n){return!(n==="Name"||n==="Description"||n==="Value")},_buildEventXPath:function(n,t,q){var f=n+"/"+t,e=!1,o,u;for(var r in q)checkExists(r)&&r!=="_removeFromThisLevel"&&(e=this._isEventAttribute(r),o=e?"@"+r:r,u=q[r],checkExists(u)&&typeof u!="object"&&(f+="["+o.toString()+"="+u.toString().xpathValueEncode()+"]"));return f},_buildEventNode:function(n,t,q,r){var f=n.ownerDocument.createElement(t);if(checkExists(r.identifiers)){var s=r.identifiers[t];if(checkExists(s)&&s.length>0){s=s.shift();for(var a in s)f.setAttribute(a.toString(),s[a].toString())}}for(var e in q)if(checkExists(e)&&e!=="_removeFromThisLevel"){var v=this._isEventAttribute(e);if(v!=null){var u=q[e];if(checkExists(u)){var y={};if(typeof u=="object"&&u.constructor!==Array&&checkExists(u._valueToSet)&&(y=u,u=u._valueToSet),typeof u!="object"&&u.constructor!==Array){if(v)f.setAttribute(e.toString(),u.toString());else{var p=f.ownerDocument.createElement(e.toString());p.appendChild(f.ownerDocument.createTextNode(u.toString()));f.appendChild(p)}y._returnValue&&(q[e]=u.toString())}else if(typeof u=="object"&&u.constructor!==Array){var w=f.ownerDocument.createElement("Properties");for(var h in u){var o=u[h],b={};typeof o=="object"&&checkExists(o._valueToSet)&&(b=o,o=o._valueToSet);var c=f.ownerDocument.createElement("Property"),k=f.ownerDocument.createElement("Name");k.appendChild(f.ownerDocument.createTextNode(h.toString()));c.appendChild(k);var d=f.ownerDocument.createElement("Value");d.appendChild(f.ownerDocument.createTextNode(o));c.appendChild(d);w.appendChild(c);b._returnValue&&(u[h]=o)}f.appendChild(w)}else if(u.constructor===Array){var g=f.ownerDocument.createElement(e),nt=this._getChildName(e);u.length>0&&typeof u[0]=="object"&&checkExists(u[0]._skipSingular);for(var l=0;l<u.length;l++){var tt=u[l];this._buildEventNode(g,nt,tt,r)}f.appendChild(g)}}}}return n.appendChild(f),f},createDefaultViewInitRule:function(n){var f=SourceCode.Forms.Designers.View.ViewDesigner,t=f.View.viewDefinitionXML,v=t.selectSingleNode("//View"),l=v.selectSingleNode("Events"),w=f._GetViewID(),q=!0,et=v.selectSingleNode("Controls/Control[@ID='"+n.controlid+"']/Properties"),h=v.selectSingleNode("Controls/Control[@ID='"+n.controlid+"']/Properties/Property[Name='Dropped']");if(checkExists(h)){if(h.selectSingleNode("/Value").nodeValue==="true")return}else{h=t.createElement("Property");var b=t.createElement("Name"),k=t.createElement("Value");b.appendChild(t.createTextNode("Dropped"));k.appendChild(t.createTextNode("true"));h.appendChild(b);h.appendChild(k);et.appendChild(h)}$chk(l)==!1&&(l=t.createElement("Events"),v.appendChild(l),q=!1);var r=q?l.selectSingleNode("Event[(@SourceType='View') and (@SourceID='"+w+"') and (@Type='User') and (Name/text()='Init')]"):null;r==null&&(r=t.createElement("Event"),r.setAttribute("Type","User"),r.setAttribute("SourceType","View"),r.setAttribute("SourceID",w),r.setAttribute("ID",(new String).generateGuid()),r.setAttribute("DefinitionID",(new String).generateGuid()),l.appendChild(r),q=!1);var y=q?r.selectSingleNode("Name"):null;y==null&&(y=t.createElement("Name"),y.appendChild(t.createTextNode("Init")),r.appendChild(y));var e=q?r.selectSingleNode("Properties"):null;e==null&&(e=t.createElement("Properties"),r.appendChild(e),q=!1);var d=e.selectSingleNode("Property[Name='Location']");d!=null&&e.removeChild(d);e.appendChild(f._createEventingProperty(t,"Location",f._GetViewName()));var g=e.selectSingleNode("Property[Name='ViewID']");g!=null&&e.removeChild(g);e.appendChild(f._createEventingProperty(t,"ViewID",w));var nt=e.selectSingleNode("Property[Name='RuleName']");nt!=null&&e.removeChild(nt);e.appendChild(f._createEventingProperty(t,"RuleName","When the View executed Initialize"));var a=q?r.selectSingleNode("Handlers"):null;a==null&&(a=t.createElement("Handlers"),r.appendChild(a),q=!1);var o=q?a.selectSingleNode("Handler"):null;o==null&&(o=t.createElement("Handler"),o.setAttribute("ID",(new String).generateGuid()),o.setAttribute("DefinitionID",(new String).generateGuid()),a.appendChild(o),q=!1);var c=q?o.selectSingleNode("Properties"):null;c==null&&(c=t.createElement("Properties"),o.appendChild(c),q=!1);var tt=q?c.selectSingleNode("Property[Name/text()='Location']"):null;tt!=null&&c.removeChild(tt);c.appendChild(f._createEventingProperty(t,"Location","view"));var p=q?o.selectSingleNode("Actions"):null;p==null&&(p=t.createElement("Actions"),o.appendChild(p),q=!1);var s=q?r.selectSingleNode("Handlers/Handler/Actions/Action/Properties/Property[(Name/text()='ControlID') and (Value/text()='"+n.controlid+"')]"):null;s==null&&(s=t.createElement("Action"),s.setAttribute("Type","ExecuteControl"),s.setAttribute("DefinitionID",(new String).generateGuid()),s.setAttribute("ID",(new String).generateGuid()),s.setAttribute("ExecutionType","Synchronous"),p.appendChild(s),q=!1);var u=q?s.selectSingleNode("Properties"):null;u==null&&(u=t.createElement("Properties"),s.appendChild(u),q=!1);var qt=q?u.selectSingleNode("Property[Name/text()='Method']"):null;qt!=null&&u.removeChild(qt);u.appendChild(f._createEventingProperty(t,"Method",n.refMethod));var rt=q?u.selectSingleNode("Property[Name/text()='ViewID']"):null;rt!=null&&u.removeChild(rt);u.appendChild(f._createEventingProperty(t,"ViewID",f._GetViewID()));var ut=q?u.selectSingleNode("Property[Name/text()='ControlID']"):null;ut!=null&&u.removeChild(ut);u.appendChild(f._createEventingProperty(t,"ControlID",n.controlid));var ft=q?u.selectSingleNode("Property[Name/text()='Location']"):null;ft!=null&&u.removeChild(ft);u.appendChild(f._createEventingProperty(t,"Location","View"))}},function(n){var t;SourceCode.Forms.Controls.Web.Accelerator.List=t=n.extend({},SourceCode.Forms.Controls.Web.Accelerator.ControlsBase,{smartObjectProperties:{AssociationSO:"62f2d48f-a76b-41b0-b872-b64802814fd3",AssociationMethod:"Get",IdProperty:"Id",NameProperty:"Name",IconProperty:"Icon",VendorProperty:"Vendor"},page:1,setRulesMethod:function(n){if(n.eventType==="create"){var u=SourceCode.Forms.Designers.View.viewDefinitionXML,q=u.selectSingleNode("SourceCode.Forms/Views/View"),h=q.getAttribute("ID"),f=n.controlId,y=q.ownerDocument,e=q.selectSingleNode("Controls/Control[@ID='{0}']".format(n.controlId));EventUtil106.updateProperty(u,e,"DataSourceType","SmartObject");EventUtil106.updateProperty(u,e,"AssociationSO",t.smartObjectProperties.AssociationSO);EventUtil106.updateProperty(u,e,"AssociationMethod",t.smartObjectProperties.AssociationMethod);for(var c=q.selectNodes("Events/Event[(@Type='User') and (@SourceID='{0}')][Name[text()='Init']]/Handlers/Handler/Actions/Action[@Type='Execute'][Properties/Property[Name[text()='ControlID'] and Value[text()='{0}']]]".format(n.controlId)),r=null,o=0,a=c.length;o<a;o++){var s=c[o];r===null&&(r=s.parentNode.parentNode);s.parentNode.removeChild(s)}r!==null&&r.selectNodes("Actions/Action").length===0&&r.parentNode.removeChild(r);var l=q.selectSingleNode("Events/Event[(@SourceType='Control') and (@SourceID='{0}') and (@Type='User') and (Name/text()='Init')]".format(n.controlId));l!==null&&EventUtil106._removeEventingPattern(q,"Init",l,{});var v={Events:[{SourceType:"Control",SourceID:f,Type:"User",Name:"Init",Properties:{ViewID:h,RuleName:"When the Appit App List executed Initialize",Location:q.selectSingleNode("Name").text},Handlers:[{Properties:{HandlerName:"IfLogicalHandler",Location:"control"},Actions:[{Type:"Execute",ExecutionType:"Asynchronous",Properties:{Location:"Control",ControlID:f,Method:t.smartObjectProperties.AssociationMethod,ViewID:h,ObjectID:t.smartObjectProperties.AssociationSO},Results:[{SourceID:t.smartObjectProperties.AssociationSO,SourceType:"Result",TargetID:f,TargetType:"Control"}]}]}]}]};EventUtil106.ensureEventingPattern(q,v,{replaceExisting:!0})}EventUtil.manageControlEvent(n)},DisplayPropertyMethod:function(){return!1},getValue:function(q){var u=n("#"+q.CurrentControlId),r=t._getProperty(u,"selectedReceipts");return checkExists(r)&&r.length>0?JSON.stringify(r):null},settingItems:function(q){q.modalizeView=!1;var r=n("#"+q.CurrentControlId),g=t._getProperty(r,"startDate"),nt=t._getProperty(r,"endDate"),tt=t._getProperty(r,"accountsAssociationSO"),a=t._getProperty(r,"page"),v=t._getProperty(r,"pageSize"),y=t._getProperty(r,"vendor"),o=t._getProperty(r,"sorter"),s=t._getProperty(r,"order"),f=t._getProperty(r,"searchterm"),h=q.JsonData;brokerPackageParent=h.metadata;var p=t._getProperty(r,"grouping");brokerPackageParent.pagenumber=a.toString();brokerPackageParent.pagesize=v.toString();var u=h.smartobject,c=u.properties.VendorType,w=u.properties.VendorType.value,l=u.properties.ListTemplateId;checkExists(l)&&t._setProperty(r,"listtemplateid",l.value);checkExists(w)&&(c={});checkExists(c)||(u.properties.VendorType={});u.properties.VendorType.value=y.toString();var e=u.resultName,b=u.method.sorters,k=u.method.filter;if(checkExists(b)||o===""||(sortObj={},sortObj.Direction=s,sortObj.OrderBy="ListTemplateId",sortObj.OrderByResultName=e,p||(sortObj.Direction=s,sortObj.OrderBy=o,sortObj.OrderByResultName=e),u.method.sorters=[],u.method.sorters.push(sortObj)),!checkExists(k)){var d='<Filters><Filter><Or><Contains><Item SourceType="ObjectProperty" SourceID="{4}.Name" SourceName="Name" SourceDisplayName="Name" DataType="Text" FullSourceID="true"/><Item SourceType="Value" DataType="Unknown"><OriginalValue><SourceValue xml:space="preserve"><Item SourceType="Value" DataType="Text">{0}<\/Item><\/SourceValue><\/OriginalValue><SourceValue>{1}<\/SourceValue><\/Item><\/Contains><Contains><Item SourceType="ObjectProperty" SourceID="{5}.ListType" SourceName="List Type" SourceDisplayName="List Type" DataType="Text" FullSourceID="true"/><Item SourceType="Value" DataType="Unknown"><OriginalValue><SourceValue xml:space="preserve"><Item SourceType="Value" DataType="Text">{2}<\/Item><\/SourceValue><\/OriginalValue><SourceValue>{3}<\/SourceValue><\/Item><\/Contains><\/Or><\/Filter><\/Filters>'.format(f,f,f,f,e,e);u.method.filter=d.replace("\\","")}r.AppitAppList("enableModal",!0)},setEnabled:function(n,q){var r=n.find(".SFC.SourceCode-Forms-Controls-Web-Accelerator-List");t._setProperty(r,"isEnabled",q)},setReadOnly:function(n,q){var r=n.find(".SFC.SourceCode-Forms-Controls-Web-Accelerator-List");t._setProperty(r,"isReadOnly",q)},setStyles:function(n,q){var r=n.find(".SFC.SourceCode-Forms-Controls-Web-Accelerator-List");n.attr("id")==="StyleBuilderPreviewPanelContent"?(r.addClass("style-builder-preview"),r.AppitAppList(),r.AppitAppList("initStyleBuilderPreview",n,q)):n.hasClass("condtional-format-preview")===!0?(r.AppitAppList(),r.AppitAppList("initStyleBuilderPreview",n,q)):t._setProperty(r,"style",q)},setVisible:function(n,q){var r=n.find(".SFC.SourceCode-Forms-Controls-Web-Accelerator-List");t._setProperty(r,"isVisible",q);typeof q=="string"&&(q=q.toLowerCase()==="true");n.toggleClass("invisible",!q)},setHeight:function(n,q){var r=n.find(".SFC.SourceCode-Forms-Controls-Web-Accelerator-List");t._setProperty(r,"height",q)},setWidth:function(n,q){var r=n.find(".SFC.SourceCode-Forms-Controls-Web-Accelerator-List");t._setProperty(r,"width",q)},setValue:function(){},setValueWithOnSet:function(){},setUserFQN:function(n,q){var r=n.find(".SFC.SourceCode-Forms-Controls-Web-Accelerator-List");t._setProperty(r,"userFQN",q)},setLoggedInUserFQN:function(n,q){var r=n.find(".SFC.SourceCode-Forms-Controls-Web-Accelerator-List");t._setProperty(r,"loggedInUserFQN",q)},setShowHeader:function(n,q){var r=n.find(".SFC.SourceCode-Forms-Controls-Web-Accelerator-List");t._setProperty(r,"showHeader",q)},setSingleSelectionMode:function(n,q){var r=n.find(".SFC.SourceCode-Forms-Controls-Web-Accelerator-List");t._setProperty(r,"singleSelectionMode",q);s},execute:function(){}});n.widget("sfc.List",n.sfc.baseWidget,{_input:null,options:{previous:{},startDate:null,endDate:null,designtime:!0,preview:!1,runTime:!1,isEnabled:!1,data:"",height:"auto",isVisible:!0,waterMarkText:"No accelerators found",width:"100%",isHtml5:!0,userFQN:null,loggedInUserFQN:null,selectedReceipts:{},dataOptions:{},activeItemClaimed:!1,activeItemId:"",showHeader:!0,singleSelectionMode:!1,page:1,pages:!0,pageSize:10,startIndex:1,pagerformat:"{0} - {1}",vendor:1,sorter:"",listtemplateid:"",vendorType:"",appName:"",id:"",version:"",order:"Descending",grouping:!1,viewPartnerApps:!0,methodEncrypted:!0,perfPaging:!0,numPages:-1,jsonData:null},startIndex:1,endIndex:null,_create:function(){var t=this;t._setOptions();this.endIndex=this.options.pageSize;t.applyChanges();t.base._create.apply(t,arguments);t.addWaterMark();var q=this.element.find(".pagerContainerWrapper");q.addClass("hide");var r=this.element.find(".nextPageBtn");r.on("click",function(){var n=t.options.page+1;t.options.perfPaging?(t.options.page+=1,t.startIndex+=t.options.pageSize,t.endIndex+=t.options.pageSize,raiseEvent(t.element.prop("id"),"Control","Init")):n<=t.options.numPages&&(t.options.page+=1,t.startIndex+=t.options.pageSize,t.endIndex+=t.options.pageSize,raiseEvent(t.element.prop("id"),"Control","Init"))});var u=this.element.find(".prevPageBtn");u.on("click",function(){t.options.page-=1;t.startIndex-=t.options.pageSize;t.endIndex-=t.options.pageSize;raiseEvent(t.element.prop("id"),"Control","Init")});var f=this.element.find(".appTemps");f.on("click",function(){t.options.vendor!==1&&(t.element.find(".partnerApps").removeClass("selected"),n(this).addClass("selected"),t.options.page=1,t.startIndex=1,t.endIndex=t.options.pageSize,t.options.vendor=1,raiseEvent(t.element.prop("id"),"Control","Init"))});var e=this.element.find(".partnerApps");e.on("click",function(){t.options.vendor!==2&&(t.element.find(".appTemps").removeClass("selected"),n(this).addClass("selected"),t.options.page=1,t.startIndex=1,t.endIndex=t.options.pageSize,t.options.vendor=2,raiseEvent(t.element.prop("id"),"Control","Init"))});var o=this.element.find(".newestSort");o.on("click",function(){n(this).hasClass("sorted")?(t.options.order="Descending",n(this).removeClass("sorted")):(t.options.order="Ascending",n(this).addClass("sorted"));t.element.find(".nameSort").removeClass("selected");n(this).addClass("selected");t.options.sorter="CreatedDateUtc";raiseEvent(t.element.prop("id"),"Control","Init")});var s=this.element.find(".nameSort");s.on("click",function(){n(this).hasClass("sorted")?(t.options.order="Descending",n(this).removeClass("sorted")):(t.options.order="Ascending",n(this).addClass("sorted"));t.element.find(".newestSort").removeClass("selected");n(this).addClass("selected");t.options.sorter="Name";raiseEvent(t.element.prop("id"),"Control","Init")});var h=this.element.find("#soPropertyConfig_AssociationSOButton");h.on("click",function(){var n=t.element.find("#soPropertyConfig_AssociationSOTextBox");t.options.searchterm=n.val();t.options.page=1;t.startIndex=1;t.endIndex=t.options.pageSize;raiseEvent(t.element.prop("id"),"Control","Init")});var c=this.element.find("#soPropertyConfig_AssociationSOTextBox");c.on("keyup",function(q){q.which===13&&(t.options.searchterm=n(this).val(),t.options.page=1,t.startIndex=1,t.endIndex=t.options.pageSize,raiseEvent(t.element.prop("id"),"Control","Init"))});if(this.options.height!=="auto"){var l=parseInt(this.element.find(".paging-container").outerHeight()),a=parseInt(this.options.height.replace("px",""));this.element.find(".AppList-container").height(a-l+"px")}this.element.find(".lookup-box").lookupbox()},applyChanges:function(){var t=this;for(var q in t.options)q!=="previous"&&q!=="style"&&(t.options[q]!==t.options.previous[q]&&t._optionsChangers(q),q=="style"&&(typeof t.options.previous[q]=="undefined"||t.options[q].innerHTML!==t.options.previous[q].innerHTML)&&t._optionsChangers(q));t.options.previous=n.extend({},t.options)},_adjustHeight:function(){var n=this;n.element.css("height",n.options.height);setTimeout(function(){var q=n.element.find(".expensecontrol-header"),r=n.element.innerHeight(),u=q.outerHeight(),t=r-u;n.element.find(".AppitAppList-container").css("max-height",t);n.element.find(".AppitAppList-container").css("height",t)},0)},_optionsChangers:function(n){var t=this;switch(n){case"height":t.element[0].height=t.options.height;t.options.runTime||(t.element.closest(".controlwrapper").height(t.options.height),t.element.siblings().filter(".controloverlay").height(t.options.height));t._adjustHeight();break;case"width":t.element.css("width",this.options.width);break;case"style":var q=t.element.find("stylewrapper"),f={border:q,background:q,margin:q,padding:q,font:q,decoration:q,horizontalAlign:q};StyleHelper.setStyles(f,this.options.style);this.options.style.xml!==undefined?this.options.style.xml.indexOf("Border")<0&&q.css("border","none"):this.options.style.indexOf("Border")<0&&q.css("border","none");var e=this.element.find(".AppList-container");q.css("width",this.options.width);e.css("height",this.options.height);break;case"userFQN":if(checkExists(t.options.userFQN)&&t.options.userFQN.indexOf(":")>=0){var o=t.options.userFQN.indexOf(":");t.options.userFQN=t.options.userFQN.substring(o+1)}t.options.runTime===!0&&checkExists(t.options.userFQN)&&t.options.userFQN!=""&&t.options.creating===!1&&t.options.userFQN!=t._userFQNNotSetIdentifier&&raiseEvent(t.element.prop("id"),"Control","Init");case"jsonData":t.options.runTime===!0&&t._refreshData();break;case"grouping":t.options.runTime===!0&&raiseEvent(t.element.prop("id"),"Control","Init");break;case"viewPartnerApps":if(t.options.runTime===!0){var r=t.element.find(".viewType.partnerApps"),u=t.element.find(".titleDivider");t.options.viewPartnerApps?(u.removeClass("hide"),r.removeClass("hide")):(u.addClass("hide"),r.addClass("hide"))}break;case"showHeader":t._booleanConverter(t.options.showHeader)?t.element.find(".control-heading").show():t.element.find(".control-heading").hide();break;case"singleSelectionMode":t.options.singleSelectionMode=t._booleanConverter(t.options.singleSelectionMode)}},_optionNameTransformer:function(n){n=n.toLowerCase();switch(n){case"userfqn":n="userFQN";break;case"loggedinuserfqn":n="loggedInUserFQN";break;case"startdate":n="startDate";break;case"enddate":n="endDate";break;case"jsondata":n="jsonData";break;case"activeitemclaimed":n="activeItemClaimed";break;case"activeitemid":n="activeItemId";break;case"selectedreceipts":n="selectedReceipts";break;case"showheader":n="showHeader";break;case"singleselectionmode":n="singleSelectionMode";break;case"vendortype":n="vendorType";break;case"appname":n="appName";break;case"pagesize":n="pageSize";break;case"viewpartnerapps":n="viewPartnerApps";break;case"methodencrypted":n="methodEncrypted"}return n},_optionValueConverter:function(n,t){n=n.toLowerCase();switch(n){case"grouping":case"viewpartnerapps":t=this.base._booleanConverter(t);break;default:t=this.base._optionValueConverter(n,t)}return t},initStyleBuilderPreview:function(n,t){this.options.style=t;this.applyChanges()},_setEvents:function(){var t=this;t.element.find(".searchBox").on("keyup",function(){var u=this;t.element.find(".receiptbox-container").unhighlight();var q=t.element.find(".receiptbox-container").not(".filtered");if(checkExists(q)!==!1&&!(q.length<=0)){if(n(u).val().length>2){q.highlight(n(u).val());for(var r=0;r<q.length;r++){for(var e=n(q[r]).find("span"),o=!1,f=0;f<e.length;f++)e[f].text.toLowerCase().indexOf(n(u).val().toLowerCase())!=-1&&(o=!0);o?n(q[r]).show():n(q[r]).hide()}}else q.show();n(u).val().length>0?t.element.find(".clearSearch").css("visibility","visible"):t.element.find(".clearSearch").css("visibility","hidden")}});t.element.on("click",".clearSearch",function(q){q.preventDefault();n(this).css("visibility","hidden");t.element.find(".searchBox").val("").trigger("focus");var r=t.element.find(".receiptbox-container").not(".filtered");r.unhighlight();r.show()});t._setupFileEvents()},_setOptions:function(){var n=this;n.options.designtime=n.element.hasClass("designtime");n.options.preview=n.element.hasClass("preview");n.options.runTime=n.options.designtime===!1&&n.options.preview===!1;n.options.isEnabled=n.element.hasClass("disabled")===!1;(n.options.designtime===!0||n.options.preview===!0)&&n.element.parent().parent().css("height",n.element.css("height"))},_setupScroll:function(){SourceCode.Forms.Controls.Web.ControlPack.Utils.SetSimpleScrollbar(n(this.element).find(".AppitAppList-container")[0])},_setInitialDateRange:function(){if(this.options.runTime&&this.options.isEnabled){var t=moment().subtract(29,"days")._d,q=moment()._d;n(this.element).find(".dateRangeInput").expenseDateRangePicker("setRange",{start:t,end:q})}},_pluginSetupDateRangePicker:function(){var q=this.element,t=this;this.options.runTime&&this.options.isEnabled&&n(q).find(".dateRangeInput").expenseDateRangePicker({onChange:function(){var r=n(q).find(".dateRangeInput").expenseDateRangePicker("getRange");t.options.startDate=r.start;t.options.endDate=r.end;t.options.runTime===!0&&raiseEvent(t.element.prop("id"),"Control","Init")},onSelect:function(q){q.start!==null&&q.end!==null&&(t.options.startDate=q.start,t.options.endDate=q.end,n(t.element).find(".dateRangeInput").expenseDateRangePicker("setRange",{start:q.start,end:q.end}),n(t.element).find(".dateRangeInput").expenseDateRangePicker("close"))}})},_beginLoadThumbnails:function(t){var q=this;if(!(t.length<=0)){var u=t.reduce(function(n,t){return n+";"+t})+";";var r={};typeof __runtimeAnonToken!="undefined"&&checkExistsNotEmpty(__runtimeAnonToken)&&(r[__runtimeAnonTokenName]=__runtimeAnonToken);n.ajax({method:"POST",contentType:"application/json; charset=utf-8",url:applicationRoot+"SmartObjectImageStore.handler",dataType:"json",headers:r,data:JSON.stringify({SmartObjectId:q.options.associationso,SmartObjectMethod:q.options.associationmethod,IdProperty:"Id",NameProperty:"",ImageProperty:"Icon",MethodName:"getImagesById",methodEncrypted:q.options.methodEncrypted,SmartObjectParams:{VendorType:q.options.vendor,ListTemplateId:q.options.listtemplateid}})}).fail(function(n){popupManager.showError(n.responseText)}).done(function(t){for(var f in t){var r=t[f],e=q.element.find(".thumbNail_"+r.Id),u=n("<img/>");u.data().id=r.Id;u.data().path=r.Path;n(u).attr("src",r.Path).on("load",function(){q.element.find(".thumbNail_"+n(this).data().id).css("background-image","url('"+n(this).data().path+"')");q.element.find(".thumbNail_"+n(this).data().id).parent().find(".attachmentsLoader").remove();n(this).remove()})}})}},_onReceiptBoxClicked:function(n,t,q){var r=this;r.options.activeItemClaimed=checkExists(q)===!1?!1:q;r.options.activeItemId=t;raiseEvent(r.element.attr("id"),"Control","OnEdit")},_onReceiptBoxCheckboxChanged:function(t,q,r){var u=this;if(u.options.singleSelectionMode)for(var c=u.element.find(".receiptbox-container.selected"),f=0;f<c.length;f++){var l=n(c[f]),a=t.receiptBox("option","ID"),v=l.receiptBox("option","ID");a!==v&&l.receiptBox("option","selected",!1)}if(r){for(var e,f=0;f<u.options.selectedReceipts.length;f++)if(u.options.selectedReceipts[f].Id===q){e=u.options.selectedReceipts[f];break}var o=n(t).receiptBox("option","claimed"),h=n(t).receiptBox("option","claimId"),s=n(t).receiptBox("option","isSplit");o=checkExists(o)===!1?!1:u.base._booleanConverter(o);h=checkExists(h)===!1?!1:!0;s=checkExists(s)===!1?!1:u.base._booleanConverter(s);checkExists(e)===!1?(e={Id:q,isClaimed:o,hasClaimId:h,isSplit:s},u.options.selectedReceipts.push(e)):(e.isClaimed=o,e.hasClaimId=h,e.isSplit=s)}else for(var f=0;f<u.options.selectedReceipts.length;f++)u.options.selectedReceipts[f].Id===q&&u.options.selectedReceipts.splice(f,1);u.options.selectedReceipts.length>0?u.element.find(".delete-button").show("slide",{direction:"right"},75):u.element.find(".delete-button").hide("slide",{direction:"right"},75)},_onReceiptBoxStatusClicked:function(n){n.filterWidget("open")},enableModal:function(n){var t=this.element.find(".AppList-container");n?t.append('<div class="base0 ajaxLoader modal-element attachmentsLoader loaderMain"><\/div>'):t.find(".loaderMain").remove()},_refreshData:function(){var vt=this,qt=this.element.find(".AppList-container"),yt=this.options.grouping;if(this.options.height==="auto"&&qt.css("height","auto"),qt.empty(),checkExists(this.options.jsonData)){var rt=[],pt=checkExists(this.options.jsonData.HasMorePages);if(checkExists(this.options.jsonData.NumberOfPages)){var ut=this.options.jsonData.NumberOfPages;this.options.numPages=ut;this.options.page>=ut?this.element.find(".nextPageBtn").hide():this.element.find(".nextPageBtn").show();this.options.perfPaging=!1}else if(pt){var ft=this.base._booleanConverter(this.options.jsonData.HasMorePages);this.options.pages=ft;ft?this.element.find(".nextPageBtn").show():this.element.find(".nextPageBtn").hide();this.options.perfPaging=!0}this.options.page===1?this.element.find(".prevPageBtn").hide():this.element.find(".prevPageBtn").show();for(var t=vt.options.jsonData.collection,wt=[],o={},s=0;s<t.length;s++){wt.push(t[s]);var l=t[s].fields["ListType"].value;if(yt||(l=" "),!checkExists(o[l]))o[l]={Rows:[]};o[l].Rows.push(t[s])}var v=t.length,y=t.length,q=[];for(var p in o)q.push(p);var oq=function(n,t){return n-t},hq=function(n,t){return t-n};this.options.order.toLowerCase()==="ascending"&&this.options.sorter!==""?q.sort(function(n,t){return n>t?1:n<t?-1:0}):this.options.order.toLowerCase()==="descending"&&this.options.sorter!==""&&q.sort(function(n,t){return n<t?1:n>t?-1:0});for(var u=0;u<q.length;u++){var t=o[q[u]].Rows;v=t.length;var bt=Math.ceil(t.length/4),a=0,w=document.createElement("div"),f=q[u],h="",b=0;if(checkExistsNotEmpty(this.options.searchterm))while(b<q[u].length){var e=f.toLowerCase().indexOf(this.options.searchterm.toLowerCase());if(e>-1){var k=this.options.searchterm.length,kt=f.substring(e,e+k);e>0&&(h+=f.substring(0,e));h+="<span style='background-color:yellow;'>"+kt+"<\/span>";f=f.substring(e+k,q[u].length);b=e+k}else h+=f,b=q[u].length}else h=f;n(w).html(h);n(w).addClass("groupingDiv");this.element.find(".AppList-container").append(w);for(var et="",ot=0;ot<bt;ot++){var c=document.createElement("div");this.options.grouping&&n(c).addClass("groupingRow");n(c).addClass("outerRow");this.element.find(".AppList-container").append(c);for(var d=0;d<t.length;d++){if(a>3){a=0;t.splice(0,4);break}var r=t[d].fields,st=checkExists(r.Id)?r.Id.value:"",dt=checkExists(r.Name)?r.Name.value:"",gt=checkExists(r.Vendor)?r.Vendor.value:"",nq=checkExists(r.Version)?r.Version.value:"";rt.push(st.text);var tq=this.createThumbNail({Name:SourceCode.Forms.Controls.Web.Accelerator.ControlsBase.escapeSpecialChar(dt),Id:SourceCode.Forms.Controls.Web.Accelerator.ControlsBase.escapeSpecialChar(st),Vendor:SourceCode.Forms.Controls.Web.Accelerator.ControlsBase.escapeSpecialChar(gt),Version:SourceCode.Forms.Controls.Web.Accelerator.ControlsBase.escapeSpecialChar(nq),SearchTerm:this.options.searchterm});this.AddThumbNail(n(c),a,tq);a++}et=c}if(v%4>0){var g="",nt=v%4;nt=4-nt;for(var p=0;p<nt;p++){var tt=document.createElement("div");n(tt).addClass("outerWrapperThumbnail");n(et).append(tt);g=tt}n(g).addClass("last");var ht=document.createElement("div");n(ht).addClass("innerSpacerDiv");n(g).append(ht)}}this._beginLoadThumbnails(rt);this.enableModal(!1);var qq=this.element.find(".pagerCount"),ct=this.endIndex,lt=this.startIndex;y<this.options.pageSize&&(ct=this.startIndex+(y-1));var at=this.element.find(".pagerContainerWrapper");if(y<1?(lt=0,this.addWaterMark(),at.addClass("hide")):at.removeClass("hide"),qq.html(this.options.pagerformat.replace("{0}",lt).replace("{1}",ct)),this.options.vendor===1){var rq=this.element.find(".appTemps");rq.addClass("selected")}else{var uq=this.element.find(".partnerApps");uq.addClass("selected")}if(this.options.sorter==="Name"){var fq=this.element.find(".nameSort");fq.addClass("selected")}else if(this.options.sorter==="Newest"){var eq=this.element.find(".newestSort");eq.addClass("selected")}raiseEvent(this.element.attr("id"),"Control","Populated")}},addWaterMark:function(){var t=this.element.find(".AppList-container");this.options.height==="auto"&&t.css("height","200px");var u=t.outerHeight(),f=t.width(),r=document.createElement("div");n(r).addClass("waterMarkWrapper");var q=document.createElement("div");n(q).append(this.options.waterMarkText);n(q).addClass("waterMarkText");n(r).append(q);n(q).css("top",u/2);t.append(r)},createThumbNail:function(t){var q=t.Name,u="",e=0;if(checkExistsNotEmpty(t.SearchTerm))while(e<t.Name.length){var r=q.toLowerCase().indexOf(t.SearchTerm.toLowerCase());if(r>-1){var o=t.SearchTerm.length,s=q.substring(r,r+o);r>0&&(u+=q.substring(0,r));u+="<span style='background-color:yellow;'>"+s+"<\/span>";q=q.substring(r+o,t.Name.length);e=r+o}else u+=q,e=t.Name.length}else u=q;var f=n("<div class='outerWrapperThumbnail' title=\"{0}\"><div class='thumbnailimg thumbNail_{2}'><\/div><div class=\"thumbnailinfo\"><div class='thumbnailname'>{1}<\/div><span class='thumbnaildetails'>App Details<\/span><\/div><\/div>".format(t.Name,u,t.Id));return f.data().id=t.Id,f.data().name=t.Name,f.data().version=t.Version,f.data().vendor=t.Vendor,f},AddThumbNail:function(t,q,r){var u=this;t.append(r);q===3&&n(r).addClass("last");r.find(".thumbnailimg").append('<div class="base0 ajaxLoader modal-element attachmentsLoader"><\/div>');var f=r.find(".thumbnaildetails");f.on("click",function(n){u.options.vendorType=r.data().vendor;u.options.version=r.data().version;u.options.appName=r.data().name;u.options.id=r.data().id;u.options.value=r.data().id;raiseEvent(u.element.attr("id"),"Control","OnClick");n.stopPropagation()})},_statusChecked:function(t){var q=t.data.self;t.target.id==="status_{0}_All".format(q.element.attr("id"))&&(t.target.checked?q._checkAllStatus():q._checkNoneStatus());var e=q.filterCheckboxes.not(":checked");q.element.find(".filterIcon").toggleClass("activeFilters",e.length>0);for(var u=0;u<q.filterCheckboxes.length;u++){var f=n(q.filterCheckboxes[u]),r=f.is(":checked");switch(f.attr("id")){case"status_{0}_1".format(q.element.attr("id")):r?q.element.find(".Draft").closest(".receiptbox-container").toggleClass("filtered",!1).show():q.element.find(".Draft").closest(".receiptbox-container").toggleClass("filtered",!0).hide();break;case"status_{0}_2".format(q.element.attr("id")):r?q.element.find(".Submitted").closest(".receiptbox-container").toggleClass("filtered",!1).show():q.element.find(".Submitted").closest(".receiptbox-container").toggleClass("filtered",!0).hide();break;case"status_{0}_3".format(q.element.attr("id")):r?q.element.find(".Query").closest(".receiptbox-container").toggleClass("filtered",!1).show():q.element.find(".Query").closest(".receiptbox-container").toggleClass("filtered",!0).hide();break;case"status_{0}_4".format(q.element.attr("id")):r?q.element.find(".Cancelled").closest(".receiptbox-container").toggleClass("filtered",!1).show():q.element.find(".Cancelled").closest(".receiptbox-container").toggleClass("filtered",!0).hide();break;case"status_{0}_5".format(q.element.attr("id")):r?q.element.find(".Declined").closest(".receiptbox-container").toggleClass("filtered",!1).show():q.element.find(".Declined").closest(".receiptbox-container").toggleClass("filtered",!0).hide();break;case"status_{0}_6".format(q.element.attr("id")):r?q.element.find(".Processed").closest(".receiptbox-container").toggleClass("filtered",!1).show():q.element.find(".Processed").closest(".receiptbox-container").toggleClass("filtered",!0).hide()}}},_checkAllStatus:function(){for(var q=this,t=0;t<q.filterCheckboxes.length;t++)n(q.filterCheckboxes[t]).checkbox("check")},_checkNoneStatus:function(){for(var q=this,t=0;t<q.filterCheckboxes.length;t++)n(q.filterCheckboxes[t]).checkbox("uncheck")},_setupFileEvents:function(){var n=this,t=n.element.find(".upload-button");n._inputForm=n._createInputForm(n.options.isHtml5);n.options.isHtml5||(n._generateOldMethodFileForm(),n.element.find(".AppitAppList-dropbar").hide());t.on("click",function(){n._inputForm.find("input").trigger("click")})},_beginFileLoad:function(n){var t=this;n>0&&(t.options.imagesAwaitingProcessing=n)},_fileLoaded:function(t){var q=this;t.indexOf(",")>=0&&(t=t.substring(t.indexOf(",")+1,t.length));var r=ExpenseControlsUtil.NewGuid(),u=n("<div><\/div>");return q.element.find(".AppitAppList-container").prepend(u),u.receiptBox({Id:r,isHtml5:q.options.isHtml5,onClicked:q._onReceiptBoxClicked.bind(q),onCheckBoxChange:q._onReceiptBoxCheckboxChanged.bind(q),onStatusClicked:q._onReceiptBoxStatusClicked.bind(q),waitingForThumbnail:!1}),r},_endFileLoad:function(n){for(var u=this,r=[],q=0;q<n.length;q++){var t=n[q].fileContents;t.indexOf(",")>=0&&(t=t.substring(t.indexOf(",")+1,t.length));r.push({Id:n[q].Id,FileName:n[q].fileName,Base64FileContents:t})}u._doAjaxRequestForReceiptBoxes(r)},_doAjaxRequestForReceiptBoxes:function(t){var q=this,r=q.element.find(".receiptbox-container.receiptbox-processing"),u={UserFQN:q.options.userFQN,loggedInUserFQN:q.options.loggedInUserFQN,SmartObjectId:q.options.dataOptions.AssociationSO,SmartObjectReadReceiptsMethod:q.options.dataOptions.readReceiptsMethod,SmartObjectUploadMethod:q.options.dataOptions.uploadMethod,Requests:t};n.ajax({method:"POST",data:JSON.stringify(u),contentType:"application/json; charset=utf-8",url:"AppitAppList.handler",beforeSend:function(){r.receiptBox("doProgress",ControlResources.SourceCode.Appit.PortalControls.Properties.Common.Processing)},success:function(t){var e=q.element.find(".receiptbox-container.receiptbox-processing");if(SourceCode.Forms.ExceptionHandler.handleException(t)){e.remove();return}for(var o=JSON.parse(t),s=0;s<e.length;s++){for(var r=n(e[s]),u,f=0;f<o.length;f++)if(o[f].Id===r.receiptBox("option","Id")){u=o[f];break}checkExists(u)!=!1&&(r.receiptBox("option","Id",u.NewId),r.receiptBox("option","currencySymbol",u.CurrencySymbol),r.receiptBox("option","amount",u.Amount),r.receiptBox("option","merchant",u.Merchant),r.receiptBox("option","uploadDate",u.UploadDate),r.receiptBox("option","waitingForThumbnail",!1),r.receiptBox("option","receiptThumbUrl",u.Base64ThumbnailUrl),r.receiptBox("option","status",u.Status),r.receiptBox("option","isSplit",u.isSplit),r.receiptBox("endBusy"))}}})},_createInputForm:function(t){var u=this,r=n('<form class="file-input" method="post" action="/Runtime/Utilities/FileHandler.ashx" enctype="multipart/form-data" style="cursor: pointer;display:none;"><\/form>'),f=u.element.attr("id")+"_file-inputId",q=null;return q=SourceCode.Forms.Browser.msie?n('<input id="'+f+'" class="file-input" name="fileinput" type="file" accept="image/*"  size="20" style="cursor: pointer;" tabindex="-1" />'):n('<input id="'+f+'" class="file-input" name="fileinput" type="file" accept="image/*" size="0" style="height:1px; width:1px; cursor: pointer;" tabindex="-1" />'),t&&q.prop("multiple",!0),q.appendTo(r),u._fileInput=q,r.appendTo(n("body")),r},_generateOldMethodFileForm:function(){var t=this,r=t.element.attr("id")+"_imageform",q=n('<iframe class="file-input" id="'+r+'" name="'+r+'"><\/iframe>');t._inputForm.attr("target",r).detach().appendTo(q);q.appendTo(n("body"));t._fileInput.on("change.file-input",function(){t._uploadFile(q.get(0),q.find("form").get(0),q.find("input").get(0))});t.element.append(n("<canvas><\/canvas>"))},_uploadFile:function(t,q,r){var u=this,f=r.value;if(f=f.substring(f.lastIndexOf("\\")+1),f==""){popupManager.showWarning("Select an image to attach.");return}n(t).off("load").on("load",function(){u._onIframeUpdated(t,q,r)});q.submit();u._timeout&&(clearTimeout(u._timeout),u._timeout=null);this._timeout=setTimeout(function(){u._onIframeWaiting(t,q,r)},2e3)},_onIframeUpdated:function(t,q,r){var u=n(this);u._timeout&&(clearTimeout(u._timeout),u._timeout=null);try{var k=u._imgPanelEl;if(!t.contentDocument)return!1;var h=t.contentDocument.body,d=h.firstChild;if(!_preElem||!_preElem.innerHTML)return!1;if(_preElem.innerHTML=="Maximum request length exceeded.")throw"MaxSizeExceeded";else{var y=_preElem.innerHTML,e=y.split("|"),p=e[0],c=e[1],g=e[2],l=e[3],a=e[4],o=r.value;if(o=o.substring(o.lastIndexOf("\\")+1),c.indexOf("image")==-1){popupManager.showWarning("Incorrect file type selected. Select an image to attach.");n(t).off("load");return}var w=n("<img><\/img>").attr("src",p).addClass("temp-image"),f=u.element.find("canvas").get(0),s=f.getContext("2d");return f.width=a,f.height=l,s.fillStyle="#fff",s.FillRect(0,0,f.width,f.height),s.drawImage(w,0,0,a,l),u._endFileLoad([f.toDataUrl(c)]),h.innerHTML="",!0}}catch(v){if(v=="MaxSizeExceeded"){var b=jQuery(u.get_element()).attr("data-maximagesize");popupManager.showError(Resources.RuntimeMessages.ErrorMaxSizeExceededImage.replace("{0}",b))}else popupManager.showError(Resources.RuntimeMessages.ErrorFileUpload.concat(v.message));return!0}finally{n(t).off("load")}},_onIframeWaiting:function(n,t,q){var r=this;this._onIframeUpdated(n,t,q)||(this._timeout=setTimeout(function(){r._onIframeWaiting(n,t,q)},2e3))}});n.sfc.List.prototype.base=n.sfc.baseWidget.prototype}(jQuery);$(document).ready(function(){$(".SFC.SourceCode-Forms-Controls-Web-Accelerator-List").List()});
