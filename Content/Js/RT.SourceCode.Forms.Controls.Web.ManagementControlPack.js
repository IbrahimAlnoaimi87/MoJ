/*!
 SourceCode.Forms.Controls.Web.ManagementControlPack.AssetControl.Resources.Script.SimpleBar.js (Embedded resource)
*/
var SimpleBar=function(){"use strict";var a=function(n,t){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var q in t)Object.prototype.hasOwnProperty.call(t,q)&&(n[q]=t[q])},a(n,t)},v=!("undefined"==typeof window||!window.document||!window.document.createElement),ct="object"==typeof global&&global&&global.Object===Object&&global,lt="object"==typeof self&&self&&self.Object===Object&&self,b=ct||lt||Function("return this")(),s=b.Symbol,k=Object.prototype,at=k.hasOwnProperty,vt=k.toString,e=s?s.toStringTag:void 0,yt=Object.prototype.toString,d=s?s.toStringTag:void 0;function pt(n){return null==n?void 0===n?"[object Undefined]":"[object Null]":d&&d in Object(n)?function(n){var t=at.call(n,e),q=n[e];try{n[e]=void 0}catch(n){}var r=vt.call(n);return!0&&(t?n[e]=q:delete n[e]),r}(n):function(n){return yt.call(n)}(n)}var wt=/\s/,bt=/^\s+/;function kt(n){return n?n.slice(0,function(n){for(var t=n.length;t--&&wt.test(n.charAt(t)););return t}(n)+1).replace(bt,""):n}function h(n){var t=typeof n;return null!=n&&("object"==t||"function"==t)}var dt=/^[-+]0x[0-9a-f]+$/i,gt=/^0b[01]+$/i,nq=/^0o[0-7]+$/i,tq=parseInt;function g(n){if("number"==typeof n)return n;if(function(n){return"symbol"==typeof n||function(n){return null!=n&&"object"==typeof n}(n)&&"[object Symbol]"==pt(n)}(n))return NaN;if(h(n)){var t="function"==typeof n.valueOf?n.valueOf():n;n=h(t)?t+"":t}if("string"!=typeof n)return 0===n?n:+n;n=kt(n);var q=gt.test(n);return q||nq.test(n)?tq(n.slice(2),q?2:8):dt.test(n)?NaN:+n}var y=function(){return b.Date.now()},qq=Math.max,rq=Math.min;function c(n,t,q){var f,e,c,o,r,u,s=0,b=!1,l=!1,v=!0;if("function"!=typeof n)throw new TypeError("Expected a function");function p(t){var q=f,r=e;return f=e=void 0,s=t,o=n.apply(r,q)}function nt(n){return s=n,r=setTimeout(a,t),b?p(n):o}function k(n){var q=n-u;return void 0===u||q>=t||q<0||l&&n-s>=c}function a(){var n=y();if(k(n))return d(n);r=setTimeout(a,function(n){var q=t-(n-u);return l?rq(q,c-(n-s)):q}(n))}function d(n){return r=void 0,v&&f?p(n):(f=e=void 0,o)}function w(){var n=y(),q=k(n);if(f=arguments,e=this,u=n,q){if(void 0===r)return nt(u);if(l)return clearTimeout(r),r=setTimeout(a,t),p(u)}return void 0===r&&(r=setTimeout(a,t)),o}return t=g(t)||0,h(q)&&(b=!!q.leading,c=(l="maxWait"in q)?qq(g(q.maxWait)||0,t):c,v="trailing"in q?!!q.trailing:v),w.cancel=function(){void 0!==r&&clearTimeout(r);s=0;f=u=e=r=void 0},w.flush=function(){return void 0===r?o:d(y())},w}var f=function(){return f=Object.assign||function(n){for(var t,q=1,u=arguments.length;q<u;q++)for(var r in t=arguments[q])Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r]);return n},f.apply(this,arguments)},o=null,nt=null;function tt(){if(null===o){if("undefined"==typeof document)return o=0;var t=document.body,n=document.createElement("div");n.classList.add("simplebar-hide-scrollbar");t.appendChild(n);var q=n.getBoundingClientRect().right;t.removeChild(n);o=q}return o}function qt(n){return n&&n.ownerDocument&&n.ownerDocument.defaultView?n.ownerDocument.defaultView:window}function rt(n){return n&&n.ownerDocument?n.ownerDocument:document}v&&window.addEventListener("resize",function(){nt!==window.devicePixelRatio&&(nt=window.devicePixelRatio,o=null)});var ut=function(n){return Array.prototype.reduce.call(n,function(n,t){var r=t.name.match(/data-simplebar-(.+)/);if(r){var q=r[1].replace(/\W+(.)/g,function(n,t){return t.toUpperCase()});switch(t.value){case"true":n[q]=!0;break;case"false":n[q]=!1;break;case void 0:n[q]=!0;break;default:n[q]=t.value}}return n},{})};function ft(n,t){var q;n&&(q=n.classList).add.apply(q,t.split(" "))}function et(n,t){n&&t.split(" ").forEach(function(t){n.classList.remove(t)})}function ot(n){return".".concat(n.split(" ").join("."))}var uq=Object.freeze({__proto__:null,getElementWindow:qt,getElementDocument:rt,getOptions:ut,addClasses:ft,removeClasses:et,classNamesToQuery:ot}),q=qt,p=rt,fq=ut,r=ft,u=et,n=ot,l=function(){function t(n,e){void 0===e&&(e={});var o=this;if(this.removePreventClickId=null,this.minScrollbarWidth=20,this.stopScrollDelay=175,this.isScrolling=!1,this.isMouseEntering=!1,this.scrollXTicking=!1,this.scrollYTicking=!1,this.wrapperEl=null,this.contentWrapperEl=null,this.contentEl=null,this.offsetEl=null,this.maskEl=null,this.placeholderEl=null,this.heightAutoObserverWrapperEl=null,this.heightAutoObserverEl=null,this.rtlHelpers=null,this.scrollbarWidth=0,this.resizeObserver=null,this.mutationObserver=null,this.elStyles=null,this.isRtl=null,this.mouseX=0,this.mouseY=0,this.onMouseMove=function(){},this.onWindowResize=function(){},this.onStopScrolling=function(){},this.onMouseEntered=function(){},this.onScroll=function(){var n=q(o.el);o.scrollXTicking||(n.requestAnimationFrame(o.scrollX),o.scrollXTicking=!0);o.scrollYTicking||(n.requestAnimationFrame(o.scrollY),o.scrollYTicking=!0);o.isScrolling||(o.isScrolling=!0,r(o.el,o.classNames.scrolling));o.showScrollbar("x");o.showScrollbar("y");o.onStopScrolling()},this.scrollX=function(){o.axis.x.isOverflowing&&o.positionScrollbar("x");o.scrollXTicking=!1},this.scrollY=function(){o.axis.y.isOverflowing&&o.positionScrollbar("y");o.scrollYTicking=!1},this._onStopScrolling=function(){u(o.el,o.classNames.scrolling);o.options.autoHide&&(o.hideScrollbar("x"),o.hideScrollbar("y"));o.isScrolling=!1},this.onMouseEnter=function(){o.isMouseEntering||(r(o.el,o.classNames.mouseEntered),o.showScrollbar("x"),o.showScrollbar("y"),o.isMouseEntering=!0);o.onMouseEntered()},this._onMouseEntered=function(){u(o.el,o.classNames.mouseEntered);o.options.autoHide&&(o.hideScrollbar("x"),o.hideScrollbar("y"));o.isMouseEntering=!1},this._onMouseMove=function(n){o.mouseX=n.clientX;o.mouseY=n.clientY;(o.axis.x.isOverflowing||o.axis.x.forceVisible)&&o.onMouseMoveForAxis("x");(o.axis.y.isOverflowing||o.axis.y.forceVisible)&&o.onMouseMoveForAxis("y")},this.onMouseLeave=function(){o.onMouseMove.cancel();(o.axis.x.isOverflowing||o.axis.x.forceVisible)&&o.onMouseLeaveForAxis("x");(o.axis.y.isOverflowing||o.axis.y.forceVisible)&&o.onMouseLeaveForAxis("y");o.mouseX=-1;o.mouseY=-1},this._onWindowResize=function(){o.scrollbarWidth=o.getScrollbarWidth();o.hideNativeScrollbar()},this.onPointerEvent=function(n){var t,q;o.axis.x.track.el&&o.axis.y.track.el&&o.axis.x.scrollbar.el&&o.axis.y.scrollbar.el&&(o.axis.x.track.rect=o.axis.x.track.el.getBoundingClientRect(),o.axis.y.track.rect=o.axis.y.track.el.getBoundingClientRect(),(o.axis.x.isOverflowing||o.axis.x.forceVisible)&&(t=o.isWithinBounds(o.axis.x.track.rect)),(o.axis.y.isOverflowing||o.axis.y.forceVisible)&&(q=o.isWithinBounds(o.axis.y.track.rect)),(t||q)&&(n.stopPropagation(),"pointerdown"===n.type&&"touch"!==n.pointerType&&(t&&(o.axis.x.scrollbar.rect=o.axis.x.scrollbar.el.getBoundingClientRect(),o.isWithinBounds(o.axis.x.scrollbar.rect)?o.onDragStart(n,"x"):o.onTrackClick(n,"x")),q&&(o.axis.y.scrollbar.rect=o.axis.y.scrollbar.el.getBoundingClientRect(),o.isWithinBounds(o.axis.y.scrollbar.rect)?o.onDragStart(n,"y"):o.onTrackClick(n,"y")))))},this.drag=function(n){var r,u,f,e,s,h,c,l,a,v,y;if(o.draggedAxis&&o.contentWrapperEl){var p=o.axis[o.draggedAxis].track,k=null!==(u=null===(r=p.rect)||void 0===r?void 0:r[o.axis[o.draggedAxis].sizeAttr])&&void 0!==u?u:0,b=o.axis[o.draggedAxis].scrollbar,d=null!==(e=null===(f=o.contentWrapperEl)||void 0===f?void 0:f[o.axis[o.draggedAxis].scrollSizeAttr])&&void 0!==e?e:0,g=parseInt(null!==(h=null===(s=o.elStyles)||void 0===s?void 0:s[o.axis[o.draggedAxis].sizeAttr])&&void 0!==h?h:"0px",10);n.preventDefault();n.stopPropagation();var w=("y"===o.draggedAxis?n.pageY:n.pageX)-(null!==(l=null===(c=p.rect)||void 0===c?void 0:c[o.axis[o.draggedAxis].offsetAttr])&&void 0!==l?l:0)-o.axis[o.draggedAxis].dragOffset,q=(w="x"===o.draggedAxis&&o.isRtl?(null!==(v=null===(a=p.rect)||void 0===a?void 0:a[o.axis[o.draggedAxis].sizeAttr])&&void 0!==v?v:0)-b.size-w:w)/(k-b.size)*(d-g);"x"===o.draggedAxis&&o.isRtl&&(q=(null===(y=t.getRtlHelpers())||void 0===y?void 0:y.isScrollingToNegative)?-q:q);o.contentWrapperEl[o.axis[o.draggedAxis].scrollOffsetAttr]=q}},this.onEndDrag=function(n){var t=p(o.el),r=q(o.el);n.preventDefault();n.stopPropagation();u(o.el,o.classNames.dragging);t.removeEventListener("mousemove",o.drag,!0);t.removeEventListener("mouseup",o.onEndDrag,!0);o.removePreventClickId=r.setTimeout(function(){t.removeEventListener("click",o.preventClick,!0);t.removeEventListener("dblclick",o.preventClick,!0);o.removePreventClickId=null})},this.preventClick=function(n){n.preventDefault();n.stopPropagation()},this.el=n,this.options=f(f({},t.defaultOptions),e),this.classNames=f(f({},t.defaultOptions.classNames),e.classNames),this.axis={x:{scrollOffsetAttr:"scrollLeft",sizeAttr:"width",scrollSizeAttr:"scrollWidth",offsetSizeAttr:"offsetWidth",offsetAttr:"left",overflowAttr:"overflowX",dragOffset:0,isOverflowing:!0,forceVisible:!1,track:{size:null,el:null,rect:null,isVisible:!1},scrollbar:{size:null,el:null,rect:null,isVisible:!1}},y:{scrollOffsetAttr:"scrollTop",sizeAttr:"height",scrollSizeAttr:"scrollHeight",offsetSizeAttr:"offsetHeight",offsetAttr:"top",overflowAttr:"overflowY",dragOffset:0,isOverflowing:!0,forceVisible:!1,track:{size:null,el:null,rect:null,isVisible:!1},scrollbar:{size:null,el:null,rect:null,isVisible:!1}}},"object"!=typeof this.el||!this.el.nodeName)throw new Error("Argument passed to SimpleBar must be an HTML element instead of ".concat(this.el));this.onMouseMove=function(n,t,q){var r=!0,u=!0;if("function"!=typeof n)throw new TypeError("Expected a function");return h(q)&&(r="leading"in q?!!q.leading:r,u="trailing"in q?!!q.trailing:u),c(n,t,{leading:r,maxWait:t,trailing:u})}(this._onMouseMove,64);this.onWindowResize=c(this._onWindowResize,64,{leading:!0});this.onStopScrolling=c(this._onStopScrolling,this.stopScrollDelay);this.onMouseEntered=c(this._onMouseEntered,this.stopScrollDelay);this.init()}return t.getRtlHelpers=function(){if(t.rtlHelpers)return t.rtlHelpers;var r=document.createElement("div");r.innerHTML='<div class="simplebar-dummy-scrollbar-size"><div><\/div><\/div>';var n=r.firstElementChild,q=null==n?void 0:n.firstElementChild;if(!q)return null;document.body.appendChild(n);n.scrollLeft=0;var f=t.getOffset(n),u=t.getOffset(q);n.scrollLeft=-999;var e=t.getOffset(q);return document.body.removeChild(n),t.rtlHelpers={isScrollOriginAtZero:f.left!==u.left,isScrollingToNegative:u.left!==e.left},t.rtlHelpers},t.prototype.getScrollbarWidth=function(){try{return this.contentWrapperEl&&"none"===getComputedStyle(this.contentWrapperEl,"::-webkit-scrollbar").display||"scrollbarWidth"in document.documentElement.style||"-ms-overflow-style"in document.documentElement.style?0:tt()}catch(n){return tt()}},t.getOffset=function(n){var t=n.getBoundingClientRect(),r=p(n),u=q(n);return{top:t.top+(u.pageYOffset||r.documentElement.scrollTop),left:t.left+(u.pageXOffset||r.documentElement.scrollLeft)}},t.prototype.init=function(){v&&(this.initDOM(),this.rtlHelpers=t.getRtlHelpers(),this.scrollbarWidth=this.getScrollbarWidth(),this.recalculate(),this.initListeners())},t.prototype.initDOM=function(){var t,q;this.wrapperEl=this.el.querySelector(n(this.classNames.wrapper));this.contentWrapperEl=this.options.scrollableNode||this.el.querySelector(n(this.classNames.contentWrapper));this.contentEl=this.options.contentNode||this.el.querySelector(n(this.classNames.contentEl));this.offsetEl=this.el.querySelector(n(this.classNames.offset));this.maskEl=this.el.querySelector(n(this.classNames.mask));this.placeholderEl=this.findChild(this.wrapperEl,n(this.classNames.placeholder));this.heightAutoObserverWrapperEl=this.el.querySelector(n(this.classNames.heightAutoObserverWrapperEl));this.heightAutoObserverEl=this.el.querySelector(n(this.classNames.heightAutoObserverEl));this.axis.x.track.el=this.findChild(this.el,"".concat(n(this.classNames.track)).concat(n(this.classNames.horizontal)));this.axis.y.track.el=this.findChild(this.el,"".concat(n(this.classNames.track)).concat(n(this.classNames.vertical)));this.axis.x.scrollbar.el=(null===(t=this.axis.x.track.el)||void 0===t?void 0:t.querySelector(n(this.classNames.scrollbar)))||null;this.axis.y.scrollbar.el=(null===(q=this.axis.y.track.el)||void 0===q?void 0:q.querySelector(n(this.classNames.scrollbar)))||null;this.options.autoHide||(r(this.axis.x.scrollbar.el,this.classNames.visible),r(this.axis.y.scrollbar.el,this.classNames.visible))},t.prototype.initListeners=function(){var t,r=this,n=q(this.el);if(this.el.addEventListener("mouseenter",this.onMouseEnter),this.el.addEventListener("pointerdown",this.onPointerEvent,!0),this.el.addEventListener("mousemove",this.onMouseMove),this.el.addEventListener("mouseleave",this.onMouseLeave),null===(t=this.contentWrapperEl)||void 0===t||t.addEventListener("scroll",this.onScroll),n.addEventListener("resize",this.onWindowResize),this.contentEl){if(window.ResizeObserver){var u=!1,f=n.ResizeObserver||ResizeObserver;this.resizeObserver=new f(function(){u&&n.requestAnimationFrame(function(){r.recalculate()})});this.resizeObserver.observe(this.el);this.resizeObserver.observe(this.contentEl);n.requestAnimationFrame(function(){u=!0})}this.mutationObserver=new n.MutationObserver(function(){n.requestAnimationFrame(function(){r.recalculate()})});this.mutationObserver.observe(this.contentEl,{childList:!0,subtree:!0,characterData:!0})}},t.prototype.recalculate=function(){if(this.heightAutoObserverEl&&this.contentEl&&this.contentWrapperEl&&this.wrapperEl&&this.placeholderEl){var f=q(this.el);this.elStyles=f.getComputedStyle(this.el);this.isRtl="rtl"===this.elStyles.direction;var n=this.contentEl.offsetWidth,e=this.heightAutoObserverEl.offsetHeight<=1,o=this.heightAutoObserverEl.offsetWidth<=1||n>0,s=this.contentWrapperEl.offsetWidth,h=this.elStyles.overflowX,c=this.elStyles.overflowY;this.contentEl.style.padding="".concat(this.elStyles.paddingTop," ").concat(this.elStyles.paddingRight," ").concat(this.elStyles.paddingBottom," ").concat(this.elStyles.paddingLeft);this.wrapperEl.style.margin="-".concat(this.elStyles.paddingTop," -").concat(this.elStyles.paddingRight," -").concat(this.elStyles.paddingBottom," -").concat(this.elStyles.paddingLeft);var t=this.contentEl.scrollHeight,r=this.contentEl.scrollWidth;this.contentWrapperEl.style.height=e?"auto":"100%";this.placeholderEl.style.width=o?"".concat(n||r,"px"):"auto";this.placeholderEl.style.height="".concat(t,"px");var u=this.contentWrapperEl.offsetHeight;this.axis.x.isOverflowing=0!==n&&r>n;this.axis.y.isOverflowing=t>u;this.axis.x.isOverflowing="hidden"!==h&&this.axis.x.isOverflowing;this.axis.y.isOverflowing="hidden"!==c&&this.axis.y.isOverflowing;this.axis.x.forceVisible="x"===this.options.forceVisible||!0===this.options.forceVisible;this.axis.y.forceVisible="y"===this.options.forceVisible||!0===this.options.forceVisible;this.hideNativeScrollbar();var l=this.axis.x.isOverflowing?this.scrollbarWidth:0,a=this.axis.y.isOverflowing?this.scrollbarWidth:0;this.axis.x.isOverflowing=this.axis.x.isOverflowing&&r>s-a;this.axis.y.isOverflowing=this.axis.y.isOverflowing&&t>u-l;this.axis.x.scrollbar.size=this.getScrollbarSize("x");this.axis.y.scrollbar.size=this.getScrollbarSize("y");this.axis.x.scrollbar.el&&(this.axis.x.scrollbar.el.style.width="".concat(this.axis.x.scrollbar.size,"px"));this.axis.y.scrollbar.el&&(this.axis.y.scrollbar.el.style.height="".concat(this.axis.y.scrollbar.size,"px"));this.positionScrollbar("x");this.positionScrollbar("y");this.toggleTrackVisibility("x");this.toggleTrackVisibility("y")}},t.prototype.getScrollbarSize=function(n){var q,r;if(void 0===n&&(n="y"),!this.axis[n].isOverflowing||!this.contentEl)return 0;var t,f=this.contentEl[this.axis[n].scrollSizeAttr],u=null!==(r=null===(q=this.axis[n].track.el)||void 0===q?void 0:q[this.axis[n].offsetSizeAttr])&&void 0!==r?r:0,e=u/f;return t=Math.max(~~(e*u),this.options.scrollbarMinSize),this.options.scrollbarMaxSize&&(t=Math.min(t,this.options.scrollbarMaxSize)),t},t.prototype.positionScrollbar=function(n){var f,e,o;void 0===n&&(n="y");var u=this.axis[n].scrollbar;if(this.axis[n].isOverflowing&&this.contentWrapperEl&&u.el&&this.elStyles){var h=this.contentWrapperEl[this.axis[n].scrollSizeAttr],s=(null===(f=this.axis[n].track.el)||void 0===f?void 0:f[this.axis[n].offsetSizeAttr])||0,c=parseInt(this.elStyles[this.axis[n].sizeAttr],10),q=this.contentWrapperEl[this.axis[n].scrollOffsetAttr];q="x"===n&&this.isRtl&&(null===(e=t.getRtlHelpers())||void 0===e?void 0:e.isScrollOriginAtZero)?-q:q;"x"===n&&this.isRtl&&(q=(null===(o=t.getRtlHelpers())||void 0===o?void 0:o.isScrollingToNegative)?q:-q);var l=q/(h-c),r=~~((s-u.size)*l);r="x"===n&&this.isRtl?-r+(s-u.size):r;u.el.style.transform="x"===n?"translate3d(".concat(r,"px, 0, 0)"):"translate3d(0, ".concat(r,"px, 0)")}},t.prototype.toggleTrackVisibility=function(n){void 0===n&&(n="y");var t=this.axis[n].track.el,q=this.axis[n].scrollbar.el;t&&q&&this.contentWrapperEl&&(this.axis[n].isOverflowing||this.axis[n].forceVisible?(t.style.visibility="visible",this.contentWrapperEl.style[this.axis[n].overflowAttr]="scroll",this.el.classList.add("".concat(this.classNames.scrollable,"-").concat(n))):(t.style.visibility="hidden",this.contentWrapperEl.style[this.axis[n].overflowAttr]="hidden",this.el.classList.remove("".concat(this.classNames.scrollable,"-").concat(n))),q.style.display=this.axis[n].isOverflowing?"block":"none")},t.prototype.showScrollbar=function(n){void 0===n&&(n="y");this.axis[n].isOverflowing&&!this.axis[n].scrollbar.isVisible&&(r(this.axis[n].scrollbar.el,this.classNames.visible),this.axis[n].scrollbar.isVisible=!0)},t.prototype.hideScrollbar=function(n){void 0===n&&(n="y");this.axis[n].isOverflowing&&this.axis[n].scrollbar.isVisible&&(u(this.axis[n].scrollbar.el,this.classNames.visible),this.axis[n].scrollbar.isVisible=!1)},t.prototype.hideNativeScrollbar=function(){this.offsetEl&&(this.offsetEl.style[this.isRtl?"left":"right"]=this.axis.y.isOverflowing||this.axis.y.forceVisible?"-".concat(this.scrollbarWidth,"px"):"0px",this.offsetEl.style.bottom=this.axis.x.isOverflowing||this.axis.x.forceVisible?"-".concat(this.scrollbarWidth,"px"):"0px")},t.prototype.onMouseMoveForAxis=function(n){void 0===n&&(n="y");var t=this.axis[n];t.track.el&&t.scrollbar.el&&(t.track.rect=t.track.el.getBoundingClientRect(),t.scrollbar.rect=t.scrollbar.el.getBoundingClientRect(),this.isWithinBounds(t.track.rect)?(this.showScrollbar(n),r(t.track.el,this.classNames.hover),this.isWithinBounds(t.scrollbar.rect)?r(t.scrollbar.el,this.classNames.hover):u(t.scrollbar.el,this.classNames.hover)):(u(t.track.el,this.classNames.hover),this.options.autoHide&&this.hideScrollbar(n)))},t.prototype.onMouseLeaveForAxis=function(n){void 0===n&&(n="y");u(this.axis[n].track.el,this.classNames.hover);u(this.axis[n].scrollbar.el,this.classNames.hover);this.options.autoHide&&this.hideScrollbar(n)},t.prototype.onDragStart=function(n,t){var f;void 0===t&&(t="y");var u=p(this.el),e=q(this.el),o=this.axis[t].scrollbar,s="y"===t?n.pageY:n.pageX;this.axis[t].dragOffset=s-((null===(f=o.rect)||void 0===f?void 0:f[this.axis[t].offsetAttr])||0);this.draggedAxis=t;r(this.el,this.classNames.dragging);u.addEventListener("mousemove",this.drag,!0);u.addEventListener("mouseup",this.onEndDrag,!0);null===this.removePreventClickId?(u.addEventListener("click",this.preventClick,!0),u.addEventListener("dblclick",this.preventClick,!0)):(e.clearTimeout(this.removePreventClickId),this.removePreventClickId=null)},t.prototype.onTrackClick=function(n,t){var f,e,o,s,u=this;void 0===t&&(t="y");var c=this.axis[t];if(this.options.clickOnTrack&&c.scrollbar.el&&this.contentWrapperEl){n.preventDefault();var l=q(this.el);this.axis[t].scrollbar.rect=c.scrollbar.el.getBoundingClientRect();var a=null!==(e=null===(f=this.axis[t].scrollbar.rect)||void 0===f?void 0:f[this.axis[t].offsetAttr])&&void 0!==e?e:0,v=parseInt(null!==(s=null===(o=this.elStyles)||void 0===o?void 0:o[this.axis[t].sizeAttr])&&void 0!==s?s:"0px",10),r=this.contentWrapperEl[this.axis[t].scrollOffsetAttr],y=("y"===t?this.mouseY-a:this.mouseX-a)<0?-1:1,p=-1===y?r-v:r+v,h=function(){u.contentWrapperEl&&(-1===y?r>p&&(r-=40,u.contentWrapperEl[u.axis[t].scrollOffsetAttr]=r,l.requestAnimationFrame(h)):r<p&&(r+=40,u.contentWrapperEl[u.axis[t].scrollOffsetAttr]=r,l.requestAnimationFrame(h)))};h()}},t.prototype.getContentElement=function(){return this.contentEl},t.prototype.getScrollElement=function(){return this.contentWrapperEl},t.prototype.removeListeners=function(){var n=q(this.el);this.el.removeEventListener("mouseenter",this.onMouseEnter);this.el.removeEventListener("pointerdown",this.onPointerEvent,!0);this.el.removeEventListener("mousemove",this.onMouseMove);this.el.removeEventListener("mouseleave",this.onMouseLeave);this.contentWrapperEl&&this.contentWrapperEl.removeEventListener("scroll",this.onScroll);n.removeEventListener("resize",this.onWindowResize);this.mutationObserver&&this.mutationObserver.disconnect();this.resizeObserver&&this.resizeObserver.disconnect();this.onMouseMove.cancel();this.onWindowResize.cancel();this.onStopScrolling.cancel();this.onMouseEntered.cancel()},t.prototype.unMount=function(){this.removeListeners()},t.prototype.isWithinBounds=function(n){return this.mouseX>=n.left&&this.mouseX<=n.left+n.width&&this.mouseY>=n.top&&this.mouseY<=n.top+n.height},t.prototype.findChild=function(n,t){var q=n.matches||n.webkitMatchesSelector||n.mozMatchesSelector||n.msMatchesSelector;return Array.prototype.filter.call(n.children,function(n){return q.call(n,t)})[0]},t.rtlHelpers=null,t.defaultOptions={forceVisible:!1,clickOnTrack:!0,scrollbarMinSize:25,scrollbarMaxSize:0,ariaLabel:"scrollable content",classNames:{contentEl:"simplebar-content",contentWrapper:"simplebar-content-wrapper",offset:"simplebar-offset",mask:"simplebar-mask",wrapper:"simplebar-wrapper",placeholder:"simplebar-placeholder",scrollbar:"simplebar-scrollbar",track:"simplebar-track",heightAutoObserverWrapperEl:"simplebar-height-auto-observer-wrapper",heightAutoObserverEl:"simplebar-height-auto-observer",visible:"simplebar-visible",horizontal:"simplebar-horizontal",vertical:"simplebar-vertical",hover:"simplebar-hover",dragging:"simplebar-dragging",scrolling:"simplebar-scrolling",scrollable:"simplebar-scrollable",mouseEntered:"simplebar-mouse-entered"},scrollableNode:null,contentNode:null,autoHide:!0},t.getOptions=fq,t.helpers=uq,t}(),st=l.helpers,w=st.getOptions,t=st.addClasses,ht=function(n){function q(){for(var r=[],t=0;t<arguments.length;t++)r[t]=arguments[t];var u=n.apply(this,r)||this;return q.instances.set(r[0],u),u}return function(n,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function q(){this.constructor=n}a(n,t);n.prototype=null===t?Object.create(t):(q.prototype=t.prototype,new q)}(q,n),q.initDOMLoadedElements=function(){document.removeEventListener("DOMContentLoaded",this.initDOMLoadedElements);window.removeEventListener("load",this.initDOMLoadedElements);Array.prototype.forEach.call(document.querySelectorAll("[data-simplebar]"),function(n){"init"===n.getAttribute("data-simplebar")||q.instances.has(n)||new q(n,w(n.attributes))})},q.removeObserver=function(){var n;null===(n=q.globalObserver)||void 0===n||n.disconnect()},q.prototype.initDOM=function(){var q,r,u,e=this;if(!Array.prototype.filter.call(this.el.children,function(n){return n.classList.contains(e.classNames.wrapper)}).length){for(this.wrapperEl=document.createElement("div"),this.contentWrapperEl=document.createElement("div"),this.offsetEl=document.createElement("div"),this.maskEl=document.createElement("div"),this.contentEl=document.createElement("div"),this.placeholderEl=document.createElement("div"),this.heightAutoObserverWrapperEl=document.createElement("div"),this.heightAutoObserverEl=document.createElement("div"),t(this.wrapperEl,this.classNames.wrapper),t(this.contentWrapperEl,this.classNames.contentWrapper),t(this.offsetEl,this.classNames.offset),t(this.maskEl,this.classNames.mask),t(this.contentEl,this.classNames.contentEl),t(this.placeholderEl,this.classNames.placeholder),t(this.heightAutoObserverWrapperEl,this.classNames.heightAutoObserverWrapperEl),t(this.heightAutoObserverEl,this.classNames.heightAutoObserverEl);this.el.firstChild;)this.contentEl.appendChild(this.el.firstChild);this.contentWrapperEl.appendChild(this.contentEl);this.offsetEl.appendChild(this.contentWrapperEl);this.maskEl.appendChild(this.offsetEl);this.heightAutoObserverWrapperEl.appendChild(this.heightAutoObserverEl);this.wrapperEl.appendChild(this.heightAutoObserverWrapperEl);this.wrapperEl.appendChild(this.maskEl);this.wrapperEl.appendChild(this.placeholderEl);this.el.appendChild(this.wrapperEl);null===(q=this.contentWrapperEl)||void 0===q||q.setAttribute("tabindex","0");null===(r=this.contentWrapperEl)||void 0===r||r.setAttribute("role","region");null===(u=this.contentWrapperEl)||void 0===u||u.setAttribute("aria-label",this.options.ariaLabel)}if(!this.axis.x.track.el||!this.axis.y.track.el){var n=document.createElement("div"),f=document.createElement("div");t(n,this.classNames.track);t(f,this.classNames.scrollbar);n.appendChild(f);this.axis.x.track.el=n.cloneNode(!0);t(this.axis.x.track.el,this.classNames.horizontal);this.axis.y.track.el=n.cloneNode(!0);t(this.axis.y.track.el,this.classNames.vertical);this.el.appendChild(this.axis.x.track.el);this.el.appendChild(this.axis.y.track.el)}l.prototype.initDOM.call(this);this.el.setAttribute("data-simplebar","init")},q.prototype.unMount=function(){l.prototype.unMount.call(this);q.instances.delete(this.el)},q.initHtmlApi=function(){this.initDOMLoadedElements=this.initDOMLoadedElements.bind(this);"undefined"!=typeof MutationObserver&&(this.globalObserver=new MutationObserver(q.handleMutations),this.globalObserver.observe(document,{childList:!0,subtree:!0}));"complete"===document.readyState||"loading"!==document.readyState&&!document.documentElement.doScroll?window.setTimeout(this.initDOMLoadedElements):(document.addEventListener("DOMContentLoaded",this.initDOMLoadedElements),window.addEventListener("load",this.initDOMLoadedElements))},q.handleMutations=function(n){n.forEach(function(n){n.addedNodes.forEach(function(n){1===n.nodeType&&(n.hasAttribute("data-simplebar")?!q.instances.has(n)&&document.documentElement.contains(n)&&new q(n,w(n.attributes)):n.querySelectorAll("[data-simplebar]").forEach(function(n){"init"!==n.getAttribute("data-simplebar")&&!q.instances.has(n)&&document.documentElement.contains(n)&&new q(n,w(n.attributes))}))});n.removedNodes.forEach(function(n){1===n.nodeType&&("init"===n.getAttribute("data-simplebar")?q.instances.has(n)&&!document.documentElement.contains(n)&&q.instances.get(n).unMount():Array.prototype.forEach.call(n.querySelectorAll('[data-simplebar="init"]'),function(n){q.instances.has(n)&&!document.documentElement.contains(n)&&q.instances.get(n).unMount()}))})})},q.instances=new WeakMap,q}(l);return v&&ht.initHtmlApi(),ht}();
/*!
 SourceCode.Forms.Controls.Web.ManagementControlPack.Routing.Resources.Script.Routing.js (Embedded resource)
*/
(function(n){(typeof SourceCode=="undefined"||SourceCode===null)&&(SourceCode={});(typeof SourceCode.Forms=="undefined"||SourceCode.Forms===null)&&(SourceCode.Forms={});(typeof SourceCode.Forms.Controls=="undefined"||SourceCode.Forms.Controls===null)&&(SourceCode.Forms.Controls={});(typeof SourceCode.Forms.Controls.Web=="undefined"||SourceCode.Forms.Controls.Web===null)&&(SourceCode.Forms.Controls.Web={});n.widget("sfc.SFCRouting",n.sfc.baseWidget,{options:{associationSO:"",associationMethod:"",routeColumn:null,pathColumn:null,dataSourceId:null,route:null,methodName:null,routeDictionary:{}},_create:function(){this.options.designTime=this.element.hasClass("designtime");this.options.designTime!==!0||this._createDesignIconMappings();raiseEvent(this.element[0].getAttribute("id"),"Control","Initialized")},_createDesignIconMappings:function(){var u=this,t=SourceCode.Forms.Designers.View.viewDefinitionXML;if(checkExists(t)&&this.element.parent().length>0){var n=this.element.parent().parent()[0].id;if(n!==""){var q=t.selectSingleNode("SourceCode.Forms/Views/View/Controls/Control[@ID='{0}']".format(n));if(q!==null){var r=q.selectSingleNode("Properties/Property[Name='DataSourceId']/Value");r!==null&&SourceCode.Forms.Controls.Web.ManagementControlPack.RoutingSourceConfig.getIconMappings(r.text,n)}}}},setItems:function(n){for(var e=n.selectNodes('/collection/object[@parentid="'+this.options.associationSO+'"]'),q=0;q<e.length;q++){for(var r=e[q].selectNodes("fields/field"),u=null,f=null,t=0;t<r.length;t++){var o=r[t].getAttribute("name"),s=r[t].selectSingleNode("value").text;o==this.options.routeColumn?u=s:o==this.options.pathColumn&&(f=s)}checkExistsNotEmpty(u)&&checkExistsNotEmpty(f)&&(this.options.routeDictionary[u]=f)}raiseEvent(this.element[0].getAttribute("id"),"Control","OnSetItemsCompleted")},setRoute:function(n){this.options.route=decodeURI(n)},getRoute:function(){return this.options.route},getPath:function(){return this.options.routeDictionary.hasOwnProperty(this.options.route)?this.options.routeDictionary[this.options.route]:""}});n(document).ready(function(){var q=n(".SFC.SourceCode-Forms-Controls-Web-ManagementControlPack-Routing"),r=!!SourceCode.Forms.Designers,t=0,u=q.length;if(!r){window.location.previousHash="";n(window).on("hashchange",function(){window.location.routingHashChange||window.location.previousHash==window.location.hash||location.reload();window.location.routingHashChange=!1;window.location.previousHash=window.location.hash})}while(t<u)jQuery(q[t]).SFCRouting(),t++})})(jQuery);
/*!
 SourceCode.Forms.Controls.Web.ManagementControlPack.Routing.Resources.Script.RoutingType.js (Embedded resource)
*/
(function(n){(typeof SourceCode=="undefined"||SourceCode===null)&&(SourceCode={});(typeof SourceCode.Forms=="undefined"||SourceCode.Forms===null)&&(SourceCode.Forms={});(typeof SourceCode.Forms.Controls=="undefined"||SourceCode.Forms.Controls===null)&&(SourceCode.Forms.Controls={});(typeof SourceCode.Forms.Controls.Web=="undefined"||SourceCode.Forms.Controls.Web===null)&&(SourceCode.Forms.Controls.Web={});(typeof SourceCode.Forms.Controls.Web.ManagementControlPack=="undefined"||SourceCode.Forms.Controls.Web.ManagementControlPack===null)&&(SourceCode.Forms.Controls.Web.ManagementControlPack={});var t;SourceCode.Forms.Controls.Web.ManagementControlPack.Routing=t={execute:function(n){var t=n.methodName,r=q(n.CurrentControlID);if(t==="SetRouteFromWindowPath"){var u=window.location.hash;return u=u.replace(/^#/,""),r.SFCRouting("setRoute",u)}if(t==="UpdateWindowPath"){var f=r.SFCRouting("getRoute");window.location.routingHashChange=!0;window.location.hash="#"+f}else if(t==="GetPath")return r.SFCRouting("getPath")},setItems:function(t){var q=n("#"+t.CurrentControlId);q.SFCRouting("setItems",t.XmlDocument)},getRouteColumnMappingProperties:function(n){return t._getMappingDataItemsForProperty(n,"RouteColumn",!1)},getPathColumnMappingProperties:function(n){return t._getMappingDataItemsForProperty(n,"PathColumn",!1)},getAssociationMethodMappings:function(n){return t._getMappingDataItemsForProperty(n,"AssociationMethod",!0)},_getMappingDataItemsForProperty:function(n,q,r){var u={values:[],displays:[],iconClasses:[]};if(checkExists(n)&&checkExists(n.grid)){var s=n.grid.controlid,o=jQuery("#{0}".format(s)).data("mappingData");if(checkExists(o)){for(var h=r?o.methods:o.properties,f=0;f<h.length;f++){var e=h[f];f===0&&(n.defaultValue=e.name);u.values.push(e.name);u.displays.push(e.display);u.iconClasses.push(e.subType)}t._ensureControlProperty(s,q,n.defaultValue)}}return u},_ensureControlProperty:function(n,t,q){var u=SourceCode.Forms.Designers.View.viewDefinitionXML,r=u.selectSingleNode("SourceCode.Forms/Views/View/Controls/Control[@ID='{0}']".format(n));if(r!==null){var f=r.selectSingleNode("Properties/Property[Name='"+t+"']/Value");f===null&&SourceCode.Forms.Controls.Web.ManagementControlPack.RoutingSourceConfig.updateProperty(u,r,t,q)}},setProperty:function(n){var t=n.property.toLowerCase(),r=q(n.CurrentControlId);t==="route"&&r.SFCRouting("setRoute",n.Value)},getProperty:function(n){var t=n.property.toLowerCase(),r=q(n.CurrentControlId);if(t==="route")return r.SFCRouting("getRoute",n.Value)},setHeight:function(n){jQuery(n.find(".SFC.SourceCode-Forms-Controls-Web-ManagementControlPack-Routing-Routing")[0]).SFCRouting()}};function q(t){return n("#"+t)}})(jQuery);
/*!
 SourceCode.Forms.Controls.Web.ManagementControlPack.SerializationGrid.Resources.JS.SerializationGridConfig.js (Embedded resource)
*/
(function(n){(typeof SourceCode=="undefined"||SourceCode===null)&&(SourceCode={});(typeof SourceCode.Forms=="undefined"||SourceCode.Forms===null)&&(SourceCode.Forms={});(typeof SourceCode.Forms.Controls=="undefined"||SourceCode.Forms.Controls===null)&&(SourceCode.Forms.Controls={});(typeof SourceCode.Forms.Controls.Web=="undefined"||SourceCode.Forms.Controls.Web===null)&&(SourceCode.Forms.Controls.Web={});(typeof SourceCode.Forms.Controls.Web.ManagementControlPack=="undefined"||SourceCode.Forms.Controls.Web.ManagementControlPack===null)&&(SourceCode.Forms.Controls.Web.ManagementControlPack={});var t;SourceCode.Forms.Controls.Web.ManagementControlPack.SerializationGridConfig=t={initialize:function(n,t,q,r,u){arguments[0]&&(this.CurrentControlId=parseXML(arguments[0]).selectSingleNode("Controls/Control/@ID").text);SourceCode.Forms.Controls.Web.ManagementControlPack.SerializationGridConfig.ColumnSettings=null;var f=parseXML(arguments[0]).selectSingleNode("Controls/Control[@ID='"+this.CurrentControlId+"']");if(f){var e=f.selectSingleNode('Properties/Property[Name="SmartObjectColumnsConfig"]');e&&(SourceCode.Forms.Controls.Web.ManagementControlPack.SerializationGridConfig.ColumnSettings=JSON.parse(e.selectSingleNode("Value").text))}SourceCode.Forms.Controls.Web.ManagementControlPack.SerializationGridConfig.fullXml=null;this.dropDownSoCatTreePopup=null;this.dropDownIconSoCatTreePopup=null;SourceCode.Forms.Controls.Web.ManagementControlPack.SerializationGridConfig.fullXml=parseXML(t||"<controls><\/controls>");SourceCode.Forms.Controls.Web.ManagementControlPack.SerializationGridConfig.callback=u;SourceCode.Forms.Controls.Web.ManagementControlPack.SerializationGridConfig.create(n);this.soContextXml="";this.ControlDefinitionXml=q;this.loading=!1;this.propertyName;this.propertyDisplayName},fullXml:null,callback:null,smartObjectMethod:null,columnSettings:null,create:function(t){loading=!0;this.smartObjectMethod=null;n("#propertyConfig_propertiesXml").val(t||(t="<Controls><Control/><\/Controls>"));var u=n("#SerializationGridPropertyConfig_secondPageInternal"),f=u.find(".input-control");f.filter(".lookup-box").lookupbox();f.filter(".text-input").textbox();u.find("select").dropdown();n("#SerializationGridPropertyConfig_SOButton").on("click",this,this.changeSerializationGridSmartObject);if(n("#SerializationGridPropertyConfig_SOTextBox").prop("readonly",!0),t!=="<Controls><Control/><\/Controls>"){var c=parseXML(t),q=c.documentElement,r=q.selectSingleNode('Control/Properties/Property[Name="AssociationSO"]'),e=null;!r||(e=r.selectSingleNode("Value").firstChild.data);var l=q.selectSingleNode('Control/Properties/Property[Name="AssociationMethod"]');!r||(this.smartObjectMethod=l.selectSingleNode("Value").firstChild.data);var o=q.selectSingleNode('Control/Properties/Property[Name="SerializationSO"]'),s=null;!o||(s=o);this.refreshPanel(e,s)}else this.refreshPanel();var h=n("#SerializationGridPropertyConfig_Grid").children(".grid");h.grid2();n("#SerializationGrid_ColumnConfigGrid").find("div.scroll-wrapper").css("overflow-y","auto").height("155px");h.grid2("synccolumns")},addRows:function(t){var e=n("#SerializationGridPropertyConfig_Grid").children(".grid");if(t){var r;switch(typeof t){case"string":var u=t.split(";");r=[];for(var q=0;q<u.length;q++){var f=u[q].split(":");r.push({Name:f[0],Type:f[1]})}break;case"object":r=[];for(var q=0;q<t.length;q++)r.push({Name:t[q].Name,Type:t[q].Type})}for(q=0;q<r.length;q++)if(r[q].Name.length>0){var o=[{cellclass:"rowradiobox",value:r[q].Name==="ID"?"true":"false",html:SCCheckbox.html({checked:r[q].Name==="ID"?!0:!1})},{value:r[q].Name},{value:"true",html:SCCheckbox.html({checked:!1})},{value:"true",html:SCCheckbox.html({checked:!0})},{value:"true",html:SCCheckbox.html({checked:!1})},{value:"",html:SCTextbox.html()},{value:"",html:SCTextbox.html()},{value:r[q].Type,html:r[q].Type},{value:"",counter:q,html:"<a class='serialization-data-item-format-config' href='javascript:void()'>Config<\/a>"},{value:"",counter:q,html:"<a class='serialization-data-item-icon-config' href='javascript:void()'>Config<\/a>"},{value:"",counter:q,html:"<select class='listDropTextAlign'><\/select>"},{value:"",counter:q,html:"<select class='listDropHeaderTextAlign'><\/select>"},{value:"",counter:q,html:"<a class='serialization-data-item-source-config' href='javascript:void()'>Config<\/a>"}];e.grid2("add","row2",o)}this.initializeDropdowns()}},initializeDropdowns:function(){var f=["Left","Middle","Right"],o=["left","center","right"],r=0,e=0,u=[];n(f).each(function(){var n={text:f[r],value:o[r],className:"test",index:r};u.push(n);r++});for(var q=n(".listDropTextAlign"),t=0;t<q.length;t++)n(q[t]).dropdown({items:u}),n(q[t]).dropdown("refresh"),n(q[t]).dropdown("SelectedIndex",e);q=n(".listDropHeaderTextAlign");for(var t=0;t<q.length;t++)n(q[t]).dropdown({items:u}),n(q[t]).dropdown("refresh"),n(q[t]).dropdown("SelectedIndex",e)},initializeDropdownAlignment:function(t,q){var u=["Left","Middle","Right"],e=["left","center","right"],r=0,f=[];n(u).each(function(){var n={text:u[r],value:e[r],className:"test",selected:t===r?!0:!1,index:r};f.push(n);r++});q.dropdown({items:f});q.dropdown("refresh");q.dropdown("SelectedIndex",t)},initializeColumnConfigGridRows:function(){console.log("initializecolconfig");var u,q;arguments[0]&&(u=arguments[0]);arguments[1]&&(q=arguments[1]);var h=n("#SerializationGridPropertyConfig_Grid").children(".grid");if(h.grid2("clear"),!!u){if(SourceCode.Forms.Controls.Web.ManagementControlPack.SerializationGridConfig.ColumnSettings){var f=[];n(SourceCode.Forms.Controls.Web.ManagementControlPack.SerializationGridConfig.ColumnSettings).each(function(){f.push(this.ColumnName+":"+this.Type)});this.addRows(f.join(";"))}else q&&this.addRows(q);for(var r=this,e=n(".serialization-data-item-format-config"),o=n(".serialization-data-item-icon-config"),s=n(".serialization-data-item-source-config"),t=0;t<e.length;t++)n(e[t]).on("click",function(){r.initializeFormatConfigScreen(n(this).parent().parent().parent())});for(var t=0;t<o.length;t++)n(o[t]).on("click",function(){r.initializeIconConfigScreen(n(this).parent().parent().parent())});for(var t=0;t<s.length;t++)n(s[t]).on("click",function(){r.initializeSourceConfigScreen(n(this).parent().parent().parent())})}this.configureColumnReorderingHandlers()},FormatClickOK:function(t){var q=n("#ListDropFormat").dropdown("SelectedValue");t.metadata().value=q==="<Format Type='Date' Culture='en-US'>C<\/Format>"?"<Format Type='Date' Culture='{0}' CustomValue='{2}'>{1}<\/Format>".format(SourceCode.Forms.Settings.Culture,"C",n("#customBox").val()):n("#ListDropFormat").dropdown("SelectedValue");popupManager.closeLast({cancelOnClose:!0})},IconClickOK:function(t){for(var e=n("#iconsTable"),u=e.find(".iconRow"),o=n("#columnDropdown").dropdown("SelectedValue"),f=[],q=0;q<u.length;q++){var r={};r.ConditionalValue=n(u[q]).find("input[type=text]").eq(0).val();r.iconValue=n(u[q]).find("select").eq(0).dropdown("SelectedValue");r.columnValue=o;f.push(r)}t.metadata().value=JSON.stringify(f);popupManager.closeLast({cancelOnClose:!0})},sourceClickOK:function(t){var q=n("#staticSourceList");t.metadata().value=q.val();popupManager.closeLast({cancelOnClose:!0})},initializeSourceConfigScreen:function(t){var r=this;popupManager.showPopup({id:"sourceConfig",buttons:[{type:"help",click:function(){HelpHelper.runHelp(7064)}},{text:"OK",click:this.sourceClickOK.bind(this,t)},{id:"SerializationGridPopertyConfig_Cancel",text:"Cancel",click:this.SerializationGridConfigCancelClick.bind(this)}],headerText:"Static Source",content:"<div class='panel full scroll-contents without-header without-toolbar without-footer'><div class='panel-body''><textarea cols rows='10' id='staticSourceList' contenteditable='true' style='height:250px; width:200px;'><\/textarea><\/div><\/div>",draggable:!0,width:300,height:350});var q=n("#staticSourceList");t.metadata().value!==""&&typeof t.metadata().value!="undefined"&&q.val(t.metadata().value)},initializeIconConfigScreen:function(t){var h=this;popupManager.showPopup({id:"iconsConfig",buttons:[{type:"help",click:function(){HelpHelper.runHelp(7064)}},{text:"OK",click:this.IconClickOK.bind(this,t)},{id:"SerializationGridPopertyConfig_Cancel",text:"Cancel",click:this.SerializationGridConfigCancelClick.bind(this)}],headerText:"Conditional Icons",content:"<span style='cursor:pointer;' id='addIconButton'>Add<\/span><span style='margin-left:10px; cursor:pointer;' id='removeIconButton'>Remove<\/span><br/><div><\/div><select id='columnDropdown'><\/select><div id='iconsTable'><\/div>",draggable:!0,width:300,height:350});var q=0,e=[],s=0;n("#addIconButton").on("click",function(){h.addIconRow("","none")});n("#removeIconButton").on("click",function(){n("#iconsTable").find(".iconRow.selected").remove()});var r=[];if(t.metadata().value!==""&&typeof t.metadata().value!="undefined")try{r=JSON.parse(t.metadata().value)}catch(c){r=[]}if(r.length==0){n("#iconsTable").html("Add Icon Rule");var u=this.getColumnConfigGridValues();n(u).each(function(){var n={text:u[q].ColumnName,value:u[q].ColumnName,className:"",selected:!1,index:q};e.push(n);q++});var f=n("#columnDropdown");f.dropdown({items:e});f.dropdown("refresh");f.dropdown("SelectedIndex",s)}else{var r=[];try{r=JSON.parse(t.metadata().value)}catch(c){r=[]}for(var o=0;o<r.length;o++)h.addIconRow(r[o].ConditionalValue,r[o].iconValue);var u=this.getColumnConfigGridValues();n(u).each(function(){var n={text:u[q].ColumnName,value:u[q].ColumnName,className:"",selected:r[0].columnValue===u[q].ColumnName,index:q};r[0].columnValue===u[q].ColumnName&&(s=q);e.push(n);q++});var f=n("#columnDropdown");f.dropdown({items:e});f.dropdown("refresh");f.dropdown("SelectedIndex",s)}n("#iconsTable").on("click",".iconRow",function(){for(var q=n("#iconsTable").find(".iconRow"),t=0;t<q.length;t++)n(q[t]).removeClass("selected");n(this).addClass("selected")})},addIconRow:function(t,q){var s=n("#iconsTable");s[0].text==="Add Icon Rule"&&(s[0].innerHTML="");var r=document.createElement("div");n(r).addClass("iconRow");var e=document.createElement("div");n(e).css("width","50%");n(e).css("display","inline-block");e.innerHTML=SCTextbox.html();r.appendChild(e);r.innerHTML=r.innerHTML+"<div style='width:49%; display:inline-block;'><select class='iconRowSelect'><\/select><\/div>";s.append(r);n(r).find("input[type=text]").eq(0).textbox();t!==""&&n(r).find("input[type=text]").eq(0).val(t);var f=["document-pdf","document-mp3","document-wav","document-wma","document-csv","document-chm","document-xls","document-generic","group","document-html","document-bmp","document-xsn","document-one","document-ppt","role","user","document-avi","document-mov","document-wmv","document-doc","view-flow","smartobject","k2workflow","oauthresourcetype","oauthresourceparameter","oauthissuers","securitylabels","realms","audiences","serviceinstance","servicetype","processversion","processinstance","processxmlfield","processdatafield","workinghourzone","dayoftheweek","exceptiondate","processschedule","errorprofile","processerror","oofexceptionrule","none"],l=["Acrobat Document","Audio file (.mp3)","Audio file (.wav)","Audio file (.wma)","Comma Seperated Values file","Compiled HTML Help file","Excel Worksheet","Generic","Group","HTML Document","Image file (.bmp)","Infopath Form Template","OneNote Document","Power Point Presentation","Role","User","Video file (.avi)","Video file (.mov)","Video file (.wmv)","Word Document","View Flow","SmartObject","Workflow","OAuth Resource Type","OAuth Resource Parameter","OAuth Issuers","Security Labels ","Realms","Audiences","Service Instance","Service Type","Process Version","Process Instance","Process XML Field","Process Data Field","Working Hour Zone","Day Of The Week","Exception Date","Process Schedule","Error Profile","Process Error","Exception Rule","None"],u=0,h=[],c=21;n(f).each(function(){var n={text:l[u],value:f[u],className:f[u],selected:q===f[u],index:u};q===f[u]&&(c=u);h.push(n);u++});var o=n(r).find("select").eq(0);o.addClass("icon-control");o.dropdown({items:h});o.dropdown("refresh");o.dropdown("SelectedIndex",c)},initializeFormatConfigScreen:function(t){popupManager.showPopup({id:"configScreenFormat",buttons:[{type:"help",click:function(){HelpHelper.runHelp(7064)}},{text:"OK",click:this.FormatClickOK.bind(this,t)},{id:"SerializationGridPopertyConfig_Cancel",text:"Cancel",click:this.SerializationGridConfigCancelClick.bind(this)}],content:"Date Formats: <br/> <select id='ListDropFormat'><\/select><br/><br/><input id='customBox' class='custombox hide' type='text'/>",draggable:!0,width:200,height:350});var u=["d","D","t","T","F","C"],o=["Short Date","Long Date","Short Time","Long Time","Full Date/Time","Custom"],q=0,f=[],e=0,s=n(document.getElementById("customBox"));try{s.val(parseXML(t.metadata().value).selectSingleNode("/Format/@CustomValue").text)}catch(h){}n(u).each(function(){var r="<Format Type='Date' Culture='{0}'>{1}<\/Format>".format(SourceCode.Forms.Settings.Culture,u[q]);if(q===5)try{var c=parseXML(t.metadata().value).selectSingleNode("/Format/@CustomValue").text,s=n(document.getElementById("customBox"));s.removeClass("hide");s.addClass("show");r=t.metadata().value}catch(l){}var h={text:o[q],value:"<Format Type='Date' Culture='{0}'>{1}<\/Format>".format(SourceCode.Forms.Settings.Culture,u[q]),className:"test",selected:t.metadata().value===r,index:q};t.metadata().value===r&&(e=q);f.push(h);q++});var r=n(document.getElementById("ListDropFormat"));r.addClass("icon-control");r.dropdown({items:f});r.dropdown("refresh");n("#ListDropFormat").dropdown("SelectedIndex",e);r.on("change",function(){for(var f=!1,u=r.dropdown("option","items"),t=0;t<u.length;t++)if(u[t].index===5&&u[t].selected===!0){f=!0;break}if(f){var q=n(document.getElementById("customBox"));q.removeClass("hide");q.addClass("show")}else{var q=n(document.getElementById("customBox"));q.addClass("hide");q.removeClass("show")}})},configureColumnReorderingHandlers:function(){n("#SerializationGrid_ColumnConfigGrid .grid-body-content-wrapper").css("overflow-y","none");n("#SerializationGrid_ColumnConfigGrid").find("tr").draggable({helper:function(t){return n('<div class="drag-cart-item"><table class="grid-content-table"><thead><th width="30%"><\/th><th width="10%"><\/th><th width="10%"><\/th><th width="10%"><\/th><th width="25%"><\/th><th width="15%"><\/th><\/thead><tbody><\/tbody><\/table><\/div>').find("tbody").append(n(t.target).closest("tr").addClass("selected").clone()).end()},start:function(){this.remove()},stop:function(t){var u=arguments[1].offset.left,r=arguments[1].offset.top+1;n(document.elementFromPoint(u,r)).closest("tr").remove();var q=n(document.elementFromPoint(u,r)).closest("tr");r<=n(q).offset().top+15?q.closest("tbody").find("tr").index(q)==q.closest("tbody").find("tr").length-2?q.before(n(t.target).removeClass("selected")[0]):q.before(n(t.target).removeClass("selected")[0]):q.after(n(t.target).removeClass("selected")[0]);n("#SerializationGridPropertyConfig_Grid").children(".grid").grid2("zebra")},axis:"y",containment:"#SerializationGrid_ColumnConfigGrid .grid-body-content-wrapper"}).attr("title","Drag rows to reorder columns.")},getColumnsFromSMOProperties:function(n,t,q,r){var u=this,f=this;jQuery.ajax({url:"Utilities/AJAXCall.ashx",async:!1,data:{method:"getItems",resultTypes:"ObjectProperties|ObjectMethods",targetType:"Object",targetId:n},dataType:"text",global:!1,success:function(){Array.prototype.unshift.call(arguments,t,q);r(f.getSMOProperties.apply(u,arguments))}})},getSMOProperties:function(n,t,q){if(!SourceCode.Forms.ExceptionHandler.handleException(q)){var f=parseXML(q).documentElement.selectSingleNode("Item"),e=f.selectSingleNode("Items"),u=e.selectNodes('Item[@ItemType="ObjectProperty"]');smartObjectColumns="";for(var r=0,o=u.length;r<o;r++){var s=u[r],h=s.selectSingleNode("Name").text;smartObjectColumns+=h+";";popupManager.getLastModal().hideBusy()}return smartObjectColumns}},refreshPanel:function(){console.log("refresh panel");var r=this;loading=!0;var q=null,u=null;arguments[0]&&(q=arguments[0]);arguments[1]&&(u=arguments[1]);n("#SerializationGridPropertyConfig_TreeCont").empty();this.dropDownSoCatTreePopup=n('<ul class="tree"><li class="root children open"><a href="javascript:;">Loading...<\/a><\/li><\/ul>').appendTo("#SerializationGridPropertyConfig_TreeCont").categorytree({objecttypes:"smartobject"});popupManager.popUps&&popupManager.popUps.length!=0||popupManager.showPopup({id:"SerializationGridPropertyConfig_secondPageOutside",buttons:[{type:"help",click:function(){HelpHelper.runHelp(7064)}},{text:"OK",click:this.SerializationGridConfigOkClick.bind(this)},{id:"SerializationGridPopertyConfig_Cancel",text:"Cancel",click:this.SerializationGridConfigCancelClick.bind(this)}],closeWith:"PropertyConfig_Cancel",headerText:n("#SerializationGridPropertyConfig_secondPage").attr("locSerializationGridSecondPageConfigHeader"),draggable:!0,content:n("#SerializationGridPropertyConfig_Main"),width:910,height:385,onClose:function(){this.SerializationGridConfigClose(this.callback)}.bind(this)});q?(popupManager.getLastModal().showBusy(),t.getSerializationGridSmartObjectData.call(this,q,!1,!0),popupManager.getLastModal().hideBusy()):(r._cleanDropdown(n("#SerializationGridPropertyConfig_ddListAssociationMethod")),n("#SerializationGridPropertyConfig_SOTextBox").val(""));this.loading=!1},configureSerializationObject:function(){if(console.log("get object type and properties"),arguments[1])n("#SerializationGridPropertyConfig_tboxServiceObjectName").val(this.serializationObject);else if(arguments[0]){var q;arguments[2]&&(q=arguments[2]);var r=arguments[0],t=this,u={url:"ObjectTypeHandler1.sdk",data:{AssociationSO:arguments[0],AssociationMethod:arguments[3]?arguments[3]:"List"},type:"POST",async:!1,success:function(q){if(q){var u=JSON.parse(q);if(u){n("#SerializationGridPropertyConfig_tboxServiceObjectName").val(u.ObjectTypeName);var f=parseXML(document.getElementById("propertyConfig_propertiesXml").value);t.saveXmlValues("SerializationSO",f);t.initializeColumnConfigGridRows(r,u.ObjectTypeProperties)}}}};n.ajax(u)}},_cleanDropdown:function(n){return n.empty().dropdown("refresh").parent().find(".input-control").removeClass("number text list-method image hyperlink memo yesno multi-value file guid decimal date-time auto-guid autonumber auto-number field message")},changeSerializationGridSmartObject:function(q){console.log("changeSerializationGridSmartObject");var r=q.data;popupManager.showPopup({id:"SerializationGridPropertyConfig_firstPageOutside",buttons:[{type:"help",click:function(){HelpHelper.runHelp(7064)}},{text:"Ok",click:function(){r.tempDisplayTemplateObjects=[];t.SerializationGridConfigTreeOkClick.call(r)}},{id:"propertyConfig_firstPageCancelBtn",text:"Cancel"}],headerText:n("#SerializationGridPropertyConfig_TreeCont").attr("locSelectSmartObjectHeader"),draggable:!0,maximizable:!0,content:n("#SerializationGridPropertyConfig_firstPage"),width:360,height:350,closeWith:"propertyConfig_firstPageCancelBtn"});r.dropDownSoCatTreePopup.tree("expand",r.dropDownSoCatTreePopup.children("li").eq(0))},SerializationGridConfigTreeOkClick:function(){SourceCode.Forms.Controls.Web.ManagementControlPack.SerializationGridConfig.ColumnSettings=null;var r=this.dropDownSoCatTreePopup.tree("find","selected");popupManager.getLastModal().showBusy();var q=r.metadata().guid;if(q){var u=this.validateAssociationMethod(q);if(u==!1){popupManager.getLastModal().hideBusy();var f=n("#SerializationGridPropertyConfig_TreeCont").attr("locSelectSoErrorNoListMethod");popupManager.showWarning(f)}else t.getSerializationGridSmartObjectData.call(this,q,!1,!1,"METHOD"),popupManager.getLastModal().hideBusy(),popupManager.closeLast()}},validateAssociationMethod:function(n){var h=this,q=jQuery.ajax({url:"Utilities/AJAXCall.ashx",data:{method:"getItems",resultTypes:"ObjectProperties|ObjectMethods",targetType:"Object",targetId:n},dataType:"text",global:!1,async:!1,error:this.error}).responseText;if(q!=null){for(var f=parseXML(q).documentElement.selectSingleNode("Item"),e=f.selectSingleNode("Items"),r=!1,u=e.selectNodes('Item[@ItemType="Method"]'),t=0,o=u.length;t<o;t++){var s=u[t];if(s.getAttribute("SubType")==="list"){r=!0;break}}return r}return!0},getSerializationGridSmartObjectData:function(n,q,r){var u=this;jQuery.ajax({url:"Utilities/AJAXCall.ashx",data:{method:"getItems",resultTypes:"ObjectProperties|ObjectMethods",targetType:"Object",targetId:n},dataType:"text",global:!1,success:function(){Array.prototype.unshift.call(arguments,q,r);t.getItemsSuccessSerializationGridDropdown.apply(u,arguments)},error:this.error})},getSerializationGridIconSmartObjectData:function(n,q,r){var u=this;jQuery.ajax({url:"Utilities/AJAXCall.ashx",data:{method:"getItems",resultTypes:"ObjectProperties|ObjectMethods",targetType:"Object",targetId:n},dataType:"text",global:!1,success:function(){Array.prototype.unshift.call(arguments,q,r);t.getItemsSuccessIconSerializationGridDropdown.apply(u,arguments)},error:this.error})},saveXmlValues:function(t,q){if(t!="ControlName"){var r=q.selectSingleNode('/Controls/Control/Properties/Property[Name = "'+t+'"]'),o=q.selectSingleNode("/Controls/Control/Properties");if(o||(o=q.createElement("Properties"),q.selectSingleNode("/Controls/Control").appendChild(o)),r)for(var s=r.childNodes.length-1;s>=0;s--)r.childNodes[s].nodeName!="Name"&&r.removeChild(r.childNodes[s]);if(!r){r=q.createElement("Property");var c=q.createElement("Name");c.appendChild(q.createCDATASection(t));r.appendChild(c);o.appendChild(r)}var f=null,u=null;if(t=="AssociationSO")f=jQuery("#SerializationGridPropertyConfig_TreeCont").attr("selectedSODisp"),u=jQuery("#SerializationGridPropertyConfig_TreeCont").attr("selectedSO");else if(t=="AssociationMethod"){var e=document.getElementById("SerializationGridPropertyConfig_ddListAssociationMethod");e.selectedIndex!==-1&&(f=e.options[e.selectedIndex].innerHTML,u=e.options[e.selectedIndex].value)}else if(t=="ValueProperty")f=this.propertyDisplayName,u=this.propertyName;else if(t=="SmartObjectColumnsConfig"){var y=n("#SerializationGridPropertyConfig_Grid"),h=JSON.stringify(this.getColumnConfigGridValues());f=h;u=h;console.log("CurrentControlId: "+this.CurrentControlId);this._getInstance(this.CurrentControlId).SFCSerializationGrid("option","SmartObjectColumnsConfig",h)}else if(t=="SerializationSO"){var y=n("#SerializationGridPropertyConfig_Grid"),l=n("#SerializationGridPropertyConfig_tboxServiceObjectName").text();f=l;u=l;this._getInstance(this.CurrentControlId).SFCSerializationGrid("option","SerializationSO",h)}if(u){var a=q.createElement("DisplayValue");a.appendChild(q.createCDATASection(f));r.appendChild(a);var v=q.createElement("Value");v.appendChild(q.createCDATASection(u));r.appendChild(v)}else q.selectSingleNode("/Controls/Control/Properties").removeChild(r)}},getColumnConfigGridValues:function(){var t=n("#SerializationGridPropertyConfig_Grid").children(".grid"),q=[];return t.find("div.grid-body-content").find("tr").each(function(){var u=n(this),r={};t.find(".grid-column-header-text").each(function(){var t=n(this).html().trim();switch(t){case"Primary Key":r.PrimaryKey=u.find(".rowradiobox").find("input[type=checkbox]").eq(0).is(":checked");break;case"Column":r.ColumnName=u.find("div.grid-content-cell-wrapper").eq(1).html();break;case"Visible":r.Visible=u.find("input[type=checkbox]").eq(1).is(":checked");break;case"ReadOnly":r.ReadOnly=u.find("input[type=checkbox]").eq(2).is(":checked");break;case"Sortable":r.Sortable=u.find("input[type=checkbox]").eq(3).is(":checked");break;case"Header":r.DisplayName=u.find("input[type=text]").eq(0).val();break;case"Width":r.Width=u.find("input[type=text]").eq(1).val();break;case"Type":r.Type=u.find("div.grid-content-cell-wrapper").eq(7).html();break;case"Icon":r.Icon=u.find(".serialization-data-item-icon-config").parent().parent().parent().metadata().value;break;case"Format":r.Format=u.find(".serialization-data-item-format-config").parent().parent().parent().metadata().value;break;case"Text-Align":r.TextAlign=u.find(".listDropTextAlign").dropdown("SelectedIndex");break;case"Header-Text Align":r.HeaderTextAlign=u.find(".listDropHeaderTextAlign").dropdown("SelectedIndex");break;case"Source":r.Source=u.find(".serialization-data-item-source-config").parent().parent().parent().metadata().value}});q.push(r)}),q},setColumnConfigGridValues:function(t){var q=this;console.log("set config grid values");var r=n("#SerializationGridPropertyConfig_Grid").children(".grid");r.find("div.grid-body-content").find("tr").each(function(u){var f=n(this),e=t[u];r.find(".grid-column-header-text").each(function(){var r=n(this).html().trim();switch(r){case"Primary Key":e.PrimaryKey?f.find(".rowradiobox").find("input[type=checkbox]").checkbox("check"):f.find(".rowradiobox").find("input[type=checkbox]").checkbox("uncheck");break;case"Column":f.find("div.grid-content-cell-wrapper").eq(1).html(e.ColumnName);break;case"Visible":e.Visible?f.find("input[type=checkbox]").eq(1).checkbox("check"):f.find("input[type=checkbox]").eq(1).checkbox("uncheck");break;case"ReadOnly":e.ReadOnly?f.find("input[type=checkbox]").eq(2).checkbox("check"):f.find("input[type=checkbox]").eq(2).checkbox("uncheck");break;case"Sortable":e.Sortable?f.find("input[type=checkbox]").eq(3).checkbox("check"):f.find("input[type=checkbox]").eq(3).checkbox("uncheck");break;case"Header":f.find("input[type=text]").eq(0).val(e.DisplayName);break;case"Width":f.find("input[type=text]").eq(1).val(e.Width);break;case"Icon":f.find(".serialization-data-item-icon-config").parent().parent().parent().metadata().value=e.Icon;break;case"Format":f.find(".serialization-data-item-format-config").parent().parent().parent().metadata().value=e.Format;break;case"Text-Align":var t=0;checkExists(e.TextAlign)?(f.find(".listDropTextAlign").dropdown("refresh"),f.find(".listDropTextAlign").dropdown("SelectedIndex",e.TextAlign),t=e.TextAlign):(f.find(".listDropTextAlign").dropdown("refresh"),f.find(".listDropTextAlign").dropdown("SelectedIndex",0));q.initializeDropdownAlignment(t,f.find(".listDropTextAlign"));break;case"Header-Text Align":var t=0;checkExists(e.HeaderTextAlign)?(f.find(".listDropHeaderTextAlign").dropdown("refresh"),f.find(".listDropHeaderTextAlign").dropdown("SelectedIndex",e.HeaderTextAlign),t=e.HeaderTextAlign):(f.find(".listDropHeaderTextAlign").dropdown("refresh"),f.find(".listDropHeaderTextAlign").dropdown("SelectedIndex",0));q.initializeDropdownAlignment(t,f.find(".listDropHeaderTextAlign"));break;case"Source":f.find(".serialization-data-item-source-config").parent().parent().parent().metadata().value=e.Source}})})},getItemsSuccessSerializationGridDropdown:function(t,q,r){console.log("getItemsSuccessSerializationGridDropdown");var qt=this;if(!SourceCode.Forms.ExceptionHandler.handleException(r)){var f=parseXML(r).documentElement.selectSingleNode("Item"),e=f.selectSingleNode("Items"),a=!1,v=n("#SerializationGridPropertyConfig_ddListAssociationMethod").empty(),y=e.selectNodes('Item[@ItemType="Method"]'),p=e.selectSingleNode('Item[@ItemType="ObjectProperty"]');this.propertyName=p.selectSingleNode("Name").text;this.propertyDisplayName=p.selectSingleNode("DisplayName").text;for(var o=0,w=y.length;o<w;o++){var s=y[o];if(s.getAttribute("SubType")==="list"){var u=document.createElement("option");u.className="list-method";u.value=s.selectSingleNode("Name").text;u.innerHTML=s.selectSingleNode("DisplayName").text;this.smartObjectMethod==u.value&&n(u).attr("selected","selected");v.append(u);a=!0}}if(a){v.dropdown("refresh");var h=f.selectSingleNode("DisplayName").text,k=f.selectSingleNode("Name").text,rt=e.selectNodes('Item[@ItemType="ObjectProperty"]'),d=SourceCode.Forms.Controls.Web.ManagementControlPack.SerializationGridConfig.fullXml.documentElement,ut=d.selectNodes('Prop[@serverControlType="property"]'),c=parseXML("<nodes/>"),l=c.documentElement.appendChild(c.createElement("node"));l.setAttribute("text",h);l.setAttribute("icon","smartobject");l.setAttribute("open","true");var g=f.getAttribute("Guid");n("#SerializationGridPropertyConfig_SOTextBox").val(h).closest(".lookup-box").removeClass("none").addClass("smartobject");n("#SerializationGridPropertyConfig_TreeCont").attr({selectedSO:g,selectedSODisp:h,selectedSOName:k});this.soContextXml=c.xml;var nt=jQuery("#SerializationGridPropertyConfig_TreeCont").attr("selectedSO"),tt=n("#SerializationGridPropertyConfig_ddListAssociationMethod").val();this.configureSerializationObject(nt,null,!0,tt);this.changeUseDisplaySO&&this.changeUseDisplaySO({data:this});SourceCode.Forms.Controls.Web.ManagementControlPack.SerializationGridConfig.ColumnSettings&&this.setColumnConfigGridValues(SourceCode.Forms.Controls.Web.ManagementControlPack.SerializationGridConfig.ColumnSettings);popupManager.getLastModal().hideBusy();this.getItemsSuccessDropdownDone=!0}else{var b=n("#SerializationGridPropertyConfig_TreeCont").attr("SelectMethodError");popupManager.showWarning(b)}}},_getInstance:function(t){return n("#"+t).find(".SFC.SourceCode-Forms-Controls-Web-ControlPack-SerializationGrid-SerializationGrid")},SerializationGridConfigCancelClick:function(){popupManager.closeLast({cancelOnClose:!0})},SerializationGridConfigClose:function(t){t();n("#SerializationGridPropertyConfig_firstPage, #SerializationGridPropertyConfig_secondPage, #SerializationGridPropertyConfig_DisplayTemplatePanel, #SerializationGridPropertyConfig_Main, #SerializationGridPropertyConfig_LevelPanel").remove()},SerializationGridConfigOkClick:function(){if(1){var t=parseXML(document.getElementById("propertyConfig_propertiesXml").value);this.saveXmlValues("AssociationSO",t);this.saveXmlValues("AssociationMethod",t);this.saveXmlValues("SmartObjectColumnsConfig",t);this.saveXmlValues("ValueProperty",t);popupManager.closeLast({cancelOnClose:!0});popupManager.closeLast({cancelOnClose:!0});n("#SerializationGridPropertyConfig_firstPage").remove();n("#SerializationGridPropertyConfig_secondPage").remove();n("#SerializationGridPropertyConfig_LevelPanel").remove();n("#SerializationGridPropertyConfig_Main").remove();this.callback(1,t.xml)}},dialogOkClick:function(){n(document.getElementById("imagePropertyConfig_dialogPanel")).add(".complex-property-config-wrapper").remove()},preventBack:function(n){n.keyCode==8&&(n.preventDefault(),n.stopPropagation())}}})(jQuery);
/*!
 SourceCode.Forms.Controls.Web.ManagementControlPack.SerializationGrid.Resources.JS.SerializationGrid.js (Embedded resource)
*/
(function(n){(typeof SourceCode=="undefined"||SourceCode===null)&&(SourceCode={});(typeof SourceCode.Forms=="undefined"||SourceCode.Forms===null)&&(SourceCode.Forms={});(typeof SourceCode.Forms.Controls=="undefined"||SourceCode.Forms.Controls===null)&&(SourceCode.Forms.Controls={});(typeof SourceCode.Forms.Controls.Web=="undefined"||SourceCode.Forms.Controls.Web===null)&&(SourceCode.Forms.Controls.Web={});(typeof SourceCode.Forms.Controls.Web.ManagementControlPack=="undefined"||SourceCode.Forms.Controls.Web.ManagementControlPack===null)&&(SourceCode.Forms.Controls.Web.ManagementControlPack={});var t;SourceCode.Forms.Controls.Web.ManagementControlPack.SerializationGrid=t=n.extend({},SourceCode.Forms.Controls.Web.ControlPack.ControlPackBase,{convertBool:function(n){return n=="true"||n==!0},applyColumnSettings:function(t,q,r,u){var f=n(t).find(".SFC");f.SFCSerializationGrid("applyColumnSettings",u)},setRowSelection:function(q,r){var u=n(q).find(".SFC");t._setProperty(u,"EnableSelectRows",r)},setPaging:function(t,q){var r=n(t).find(".SFC");r.SFCSerializationGrid("option","usePaging",q)},setPageRows:function(t,q){var r=n(t).find(".SFC");r.SFCSerializationGrid("option","PageRows",q)},setSorting:function(t,q){var r=n(t).find(".SFC");r.SFCSerializationGrid("option","setSorting",q)},setWidth:function(t,q){var r=n(t).find(".SFC");SourceCode.Forms.Controls.Base.ControlType.setWidth(t,r,q,0);r.SFCSerializationGrid("option","width",q)},setHeight:function(q,r,u){var f=n(q).find(".SFC");typeof r=="undefined"&&(r="auto");r=r.trim();var e=q.data().type;if(checkExists(e)||(e=q.attr("controltype")),!checkExists(e))return null;e=e.toLowerCase();var a=q.find(".resizewrapper :not(.controloverlay):not(.ui-resizable-handle)").first(),o=q.find(".resizewrapper"),s="auto";if(u){var c=parseXML(u);s=c.selectSingleNode('//Properties/Property[Name/text()="Height"]/Value')}if(r){r=parseFloat(r)+"px";q.length>0&&(q[0].style.height=r);o.each(function(){this.style.height="100%"});f[0].style.height=r;var l=f.outerHeight(!0);if(t._resizeWrappersToHeight(q,o,f,l),(!checkExists(s)||s.text=="")&&q.is(":visible")&&(q.hasClass("form-control"),isFormControl)){var h=q.data("panel");checkExists(h)&&(h.equalizeWidths(),h.equalizeHeights())}n(f).find(".SerializationGrid").grid2().grid2("setHeight",r)}else t._resizeWrappersToHeight(q,o,f,"auto");return t._getWidgetName(f),t._setProperty(f,"height",r),f.outerHeight(!0)},settingItems:function(t){var q=n(ControlPackBase._getInstance(t.CurrentControlId)),f=ControlPackBase._getProperty(q,"PageRows"),r=n.extend([],t.brokerPackageXML);if(r.length>0){var u=r[0].metadata;ControlPackBase._getProperty(q,"usePaging")&&(u.pagenumber="1",u.pagesize=f.toString())}ControlPackBase._setProperty(q,"settingItems",!0);ControlPackBase._setProperty(q,"FromRule",!0);ControlPackBase._setProperty(q,"brokerPackage",r)},validate:function(){}});n.widget("sfc.SFCSerializationGrid",n.sfc.baseWidget,{options:{populateData:!1,SetItemsCounter:0,getallpagescalled:!1,FullProcName:"(All)",goToCurPage:-1,curPageIndex:0,newPageIndex:10,usePaging:!0,defaultValue:"SFCNULL",brokerPackage:null,PageRows:10,curPage:1,FromRule:!1,indexPage:0,useSorting:!0,preview:!1,IsEnabledGrid:!0,Width:"100%",Height:"auto",EnableSelectRows:!0,text:"",designtime:!1,GridRows:[],SmartObjectColumnsConfig:"",SerializationSO:"",style:SourceCode.Forms.Controls.Base.emptyStylesNode,settingItems:!1,jsonData:{},previous:{},value:"",Pages:{},pendingOnchange:!1,isStyleBuilder:!1,serializedValue:"",isDynamic:!1,pagingCallback:null,isVisible:!0,timeout:null},_create:function(){(n(this.element).hasClass("designtime")||n(this.element).hasClass("preview"))&&this.option("designtime",!0);this._createGrid();t.convertBool(this.options.IsEnabledGrid)!==!0&&this.element.addClass("disabled");var q=this,r=n(window).width(),u=n(window).height();this.base._create.apply(this,arguments);this.options.previous=n.extend({},this.options);this.element.hasClass("designtime")||(this.setGridHeaderAlignment(),this.setRowSelection(this.options.EnableSelectRows));this.options.Width.indexOf("px")===-1&&this.element.find(".grid-column-header-table").width("100%");this.element[0].addEventListener("keyup",function(n){q.handleKeys.call(q,n)})},handleKeys:function(n){n.ctrlKey&&n.keyCode===67&&this.copyRowToClipboard()},copyRowToClipboard:function(){var e=this.getSerializedRow();if(checkExistsNotEmpty(e)){for(var o=JSON.parse(this.options.SmartObjectColumnsConfig),n="",s=JSON.parse(e),c=s.length,t=0;t<c;t++){var q=s[t];for(var r in q)if(q.hasOwnProperty(r)){for(var h=!1,u=0,l=o.length;u<l;u++){var f=o[u];if(f.ColumnName===r&&checkExists(f.Visible)&&f.Visible===!1){h=!0;break}}if(h)continue;n+="{0} ".format(q[r])}}n.length>0&&(n=n.slice(0,-1));ControlPackUtils.SetClipboard(n)}},removeSFPopulateBindings:function(){for(var t=formBindingXml.selectNodes("Events/Event/Handlers/Handler/Actions/Action[@ControlID='"+this.element.attr("id")+"' and @Method='GetList']"),n=0;n<t.length;n++)t[n].setAttribute("ControlID","000"),t[n].setAttribute("ObjectID","000")},CheckNextPage:function(t){var q=this,r=this.element.find(".paging-right");if(checkExists(this.options.Pages["Page"+t])){if(this.options.Pages["Page"+t].Empty){var s=this.element.find(".SerializationGrid");s.grid2().grid2("option","totalpages",t-1);r.addClass("disabled")}else t>this.options.curPage&&r.removeClass("disabled");checkExists(q.options.pagingCallback)&&q.options.pagingCallback()}else{var h=function(n){if(!checkExists(q.options.Pages["Page"+t])){var u=n.c[0].collection,h=JSON.parse(q.options.SmartObjectColumnsConfig),f={};f.rows=[];f.jsonData=$extend({},n);for(var e=0;e<u.length;e++){if(checkExists(u[e].pagenumber)&&parseInt(u[e].pagenumber)!==t){u=[];break}var o={};o.selected=!1;o.columnValues={};var c=u[e].fields,l="",s=0;for(var a in c){var v=!1;checkExists(h[s].PrimaryKey)&&(v=h[s].PrimaryKey);var y=c[a].value;v&&(l+=typeof y=="object"?JSON.stringify(c[h[s].ColumnName.trim()].value):c[h[s].ColumnName.trim()].value);var p={};p.Value=SourceCode.Forms.Controls.Web.ControlPack.ControlPackBase.escapeSpecialChar(y);o.columnValues[a]=p;s++}var w=-1;l!==""&&(w=q.checkforDuplicates(l));w<=-1&&(o.key=l,f.rows.push(o))}if(u.length>0){q.options.Pages["Page"+t]=f;r.removeClass("disabled");var b=q.element.find(".SerializationGrid");b.grid2().grid2("option","totalpages",t)}else{f.Empty=!0;q.options.Pages["Page"+t]=f;var b=q.element.find(".SerializationGrid");b.grid2().grid2("option","totalpages",t-1);r.addClass("disabled")}checkExists(q.options.pagingCallback)&&q.options.pagingCallback()}},f=this.options.brokerPackage[0].metadata,e=this.options.jsonData.HasMorePages,o=this.options.jsonData.NumberOfPages,u=!1;if(checkExists(o)){var c=parseInt(o,10);c>=t&&(f.pagenumber=t.toString(),u=!0)}else checkExists(e)&&this.base._booleanConverter(e)?(f.pagenumber=t.toString(),u=!0):checkExists(e)||(f.pagenumber=t.toString(),u=!0);if(u){var l=sendPacket(n.extend([],this.options.brokerPackage),null);l.then(h,null)}}},CheckPrevPage:function(t){var q=this,r=this.element.find(".paging-first"),u=this.element.find(".paging-left");if(!(t<=0))if(t===1?(r.addClass("disabled"),u.addClass("disabled")):(r.removeClass("disabled"),u.removeClass("disabled")),checkExists(this.options.Pages["Page"+t]))checkExists(q.options.pagingCallback)&&q.options.pagingCallback();else{var f=function(n){var s=n.c[0].collection,u={};u.rows=[];u.jsonData=$extend({},n);for(var e=0;e<s.length;e++){var f={};f.selected=!1;f.columnValues={};var y="",h=s[e].fields,c=JSON.parse(q.options.SmartObjectColumnsConfig),o=0;for(var l in h){var a=!1;checkExists(c[o].PrimaryKey)&&(a=c[o].PrimaryKey);var r=h[l];r=checkExists(r)?r.value:"";a&&(y+=typeof r=="object"?JSON.stringify(r):r);var v={};v.Value=SourceCode.Forms.Controls.Web.ControlPack.ControlPackBase.escapeSpecialChar(r);f.columnValues[l]=v;o++}u.rows.push(f)}q.options.Pages["Page"+t]=u;q.loadGridPages(t);checkExists(q.options.pagingCallback)&&q.options.pagingCallback()},e=this.options.brokerPackage[0].metadata;e.pagenumber=t.toString();var o=sendPacket(n.extend([],this.options.brokerPackage),null);o.then(f,null)}},resize:function(){this.element.find(".SerializationGrid").grid2().grid2("synccolumns");this.element.find(".SerializationGrid").grid2().grid2("setColumnWidth")},rowSelect:function(){n(this).find(".checkbox").checkbox("check")},changePage:function(){var n=arguments[2].closest(".SFC").SFCSerializationGrid("option","isDynamic");if(arguments[2]&&(n||arguments[2].closest(".SFC").SFCSerializationGrid("updateDictionary")),arguments[0])switch(arguments[0]){case"start":this.page=1;n||arguments[2].closest(".SFC").SFCSerializationGrid("CheckPrevPage",1);break;case"previous":this.page--;n||arguments[2].closest(".SFC").SFCSerializationGrid("CheckPrevPage",this.page);break;case"next":this.page++;break;case"end":this.page=this.totalpages;break;default:var t=parseInt(arguments[0]);t>this.totalpages?arguments[2].closest(".SFC").SFCSerializationGrid("goToPageWithCallBack",t,loadGridPages):this.page=parseInt(arguments[0])}if(arguments[2]){var n=arguments[2].closest(".SFC").SFCSerializationGrid("option","isDynamic");arguments[2].grid2().grid2("option","page",this.page);arguments[2].closest(".SFC").SFCSerializationGrid("loadGridPages",this.page+1)}},goToCurrentPage:function(){this.options.curPage===-1&&(this.options.curPage=1);this.goToPageWithCallBack(this.options.curPage,this.loadGridPages)},goToPageWithCallBack:function(t,q){var r=this,u=this.element.find(".paging-right");this.element.showControlBusyModal(!0,{innerPositions:[{"background-position":"center"}]});var f=function(n){r.options.Pages={};var a=n.c[0].collection,s=JSON.parse(r.options.SmartObjectColumnsConfig),f={};f.rows=[];f.jsonData=$extend({},n);for(var v=0;v<a.length;v++){var e={};e.selected=!1;e.columnValues={};var h=a[v].fields,c="",o=0;for(var y in h){var p=!1;checkExists(s[o].PrimaryKey)&&(p=s[o].PrimaryKey);var w=h[y].value;p&&(c+=typeof w=="object"?JSON.stringify(h[s[o].ColumnName.trim()].value):h[s[o].ColumnName.trim()].value);var b={};b.Value=SourceCode.Forms.Controls.Web.ControlPack.ControlPackBase.escapeSpecialChar(w);e.columnValues[y]=b;o++}if(c!=="")var k=r.checkforDuplicates(c);else k=-1;k<=-1&&(e.key=c,f.rows.push(e))}if(a.length>0){r.options.Pages["Page"+t]=f;u.removeClass("disabled");var l=r.element.find(".SerializationGrid");l.grid2().grid2("option","page",t);l.grid2().grid2("option","totalpages",t);q.call(r,t);r.CheckNextPage(t+1);r.CheckPrevPage(t)}else{f.Empty=!0;r.options.Pages["Page"+t]=f;var l=r.element.find(".SerializationGrid");l.grid2().grid2("option","page",l.grid2().grid2("option","totalpages"));u.addClass("disabled");t!=1?r.goToPageWithCallBack(t-1,r.loadGridPages):r.loadGridPages(1)}r.element.showControlBusyModal(!1,{innerPositions:[{"background-position":"center"}]});checkExists(r.options.pagingCallback)&&r.options.pagingCallback()},e=this.options.brokerPackage[0].metadata;e.pagenumber=t.toString();var o=sendPacket(n.extend([],this.options.brokerPackage),null);o.then(f,null)},updateDictionary:function(){for(var r=this.element.find(".SerializationGrid"),e=r.grid2().grid2("option","page"),u=r.grid2().grid2("fetch","rows","objects"),f=this.options.Pages["Page"+e],q=JSON.parse(this.options.SmartObjectColumnsConfig),t=0;t<u.length;t++)for(var o=u[t],n=0;n<q.length;n++)checkExists(f.rows[t].columnValues[q[n].ColumnName])&&(f.rows[t].columnValues[q[n].ColumnName].Value=this.setRowColumnOld(o[n+1],q[n]))},reshufflePages:function(n){for(var u=n.length-1;u>=0;u--){var s=this.options.Pages["Page"+n[u].page].rows;s.splice(n[u].row,1)}for(var t in this.options.Pages)if(this.options.Pages[t].rows.length<this.options.PageRows){var e=this.options.Pages[t],o=parseInt(t.replace("Page",""));if(checkExists(this.options.Pages["Page"+(o+1)]))for(var f=o+1,q=this.options.Pages["Page"+f];e.rows.length<this.options.PageRows;){if(typeof q=="undefined")break;q.rows.length>0?e.rows.push(q.rows.shift()):(delete q,this.options.Pages["Page"+f]=q,f++,q=this.options.Pages["Page"+f])}}lastPageCounter=0;var r=1;for(var t in this.options.Pages)lastPageCounter>0?delete this.options.Pages[t]:this.options.Pages[t].rows.length==0?(r=parseInt(t.replace("Page",""))-1,this.options.Pages[t].Empty=!0,lastPageCounter++):r=parseInt(t.replace("Page",""));r==0&&(r=1,this.options.Pages={});var h=this.element.find(".SerializationGrid");h.grid2().grid2("option","totalpages",r)},loadGridPages:function(t){var f=this;f.options.GridRows=[];var s=this.element.find(".SerializationGrid"),e=s.grid2().grid2("option","page");this.options.curPage=e;var q=JSON.parse(f.options.SmartObjectColumnsConfig),r=this.options.Pages["Page"+e],c=this,o=[],l=this.options.PageRows,u=0;if(!checkExists(r)){r={};r.rows=[];var h=this.element.find(".paging-right");h.addClass("disabled")}n(r.rows).each(function(){for(var s=this,t=[],e="",n=0;n<q.length;n++){var f=!1;checkExists(q[n].PrimaryKey)&&(f=q[n].PrimaryKey);checkExists(r.rows[u].columnValues[q[n].ColumnName])&&typeof r.rows[u].columnValues[q[n].ColumnName].Value=="object"?(f&&(e+=checkExists(JSON.stringify(r.rows[u].columnValues[q[n].ColumnName]))?JSON.stringify(r.rows[u].columnValues[q[n].ColumnName].Value):""),t.push({value:checkExists(JSON.stringify(r.rows[u].columnValues[q[n].ColumnName]))?JSON.stringify(r.rows[u].columnValues[q[n].ColumnName].Value):"",readOnly:q[n].ReadOnly,dataType:q[n].Type})):(f&&(e+=checkExists(r.rows[u].columnValues[q[n].ColumnName])?r.rows[u].columnValues[q[n].ColumnName].Value:""),t.push({value:checkExists(r.rows[u].columnValues[q[n].ColumnName])?r.rows[u].columnValues[q[n].ColumnName].Value:"",readOnly:q[n].ReadOnly,dataType:q[n].Type}))}o.push(t);u++});f.options.GridRows=o;f.loadGridRows();this.element.find(".grid-column-header-text").first().find("input[type=checkbox]").checkbox().checkbox("uncheck");!this.options.getallpagescalled&&this.options.populateData&&this.CheckNextPage(t)},getSerializedValueFromPages:function(n,t){this.updateDictionary();var r=JSON.parse(this.options.SmartObjectColumnsConfig),s=[];for(var e in this.options.Pages)for(var f=0;f<this.options.Pages[e].rows.length;f++){var h=!1;for(var o in this.options.Pages[e].rows[f].columnValues){var u=this.options.Pages[e].rows[f].columnValues;if(typeof u[o].Value=="string"&&u[o].Value.indexOf("[]")>-1&&u.hasOwnProperty(o)){h=!0;break}}if(this.options.Pages[e].rows[f].selected||n){for(var u={},q=0;q<r.length;q++)if(checkExists(this.options.Pages[e].rows[f].columnValues[r[q].ColumnName]))try{Array.isArray(this.options.Pages[e].rows[f].columnValues[r[q].ColumnName].Value)&&!r[q].ReadOnly||typeof this.options.Pages[e].rows[f].columnValues[r[q].ColumnName].Value=="object"&&t?u[r[q].ColumnName]=JSON.stringify(this.options.Pages[e].rows[f].columnValues[r[q].ColumnName].Value):(u[r[q].ColumnName]=SourceCode.Forms.Controls.Web.ControlPack.ControlPackBase.formatSpecialChar(this.setRowColumn(this.options.Pages[e].rows[f].columnValues[r[q].ColumnName])),u[r[q].ColumnName]=u[r[q].ColumnName].match(/[_\.!~*'()-]/)&&u[r[q].ColumnName].match(/%[0-9a-f]{2}/)?encodeURI(u[r[q].ColumnName]):u[r[q].ColumnName])}catch(c){u[r[q].ColumnName]=this.setRowColumn(this.options.Pages[e].rows[f].columnValues[r[q].ColumnName])}else u[r[q].ColumnName]="";s.push(u)}}return JSON.stringify(s)},_createGrid:function(){var q=this,r=this.element.find(".SerializationGrid");r.grid2({dragcolumns:!0,customcolumns:!0,multiline:!1,height:this.options.Height,sorting:!0,resources:{emptygrid:"No items to display",page:"Page ",pagecount:" of {0}"},paging:!0,page:1,pagerows:parseInt(this.options.PageRows),autopopulate:!1,rowclick:function(){n(this).parent().find("tr").removeClass("selected");n(this).addClass("selected");q.options.timeout=setTimeout(function(){raiseEvent(q.element.attr("id"),"Control","OnRowSelected");clearTimeout(q.options.timeout);q.options.timeout=null},300)},rowdblclick:function(){clearTimeout(q.options.timeout);q.options.timeout=null;raiseEvent(q.element.attr("id"),"Control","OnRowDblClick")}});r.grid2("setPaging",t.convertBool(this.options.usePaging));r.grid2("option","custompaging",this.changePage);var q=this;q.element.find(".grid-column-header-text").first().html(SCCheckbox.html({checked:!1})).find(".checkbox").eq(0).checkbox().on("click",function(){var u=q.element.find(".SerializationGrid"),f=u.grid2("option","page"),r=q.options.Pages["Page"+f],t=q.element.find(".rowselectcheckbox").find("input[type=checkbox]");n(this).checkbox("isChecked")?(t.checkbox("check"),t.each(function(){var t=n(this).closest("tr").index();r.rows[t].selected=!0;n(this).closest("td").metadata().value="true"})):(t.checkbox().checkbox("uncheck"),t.each(function(){var t=n(this).closest("tr").index();r.rows[t].selected=!1;n(this).closest("td").metadata().value="false"}));raiseEvent(q.element.attr("id"),"Control","OnRowChecked")});this.options.EnableSelectRows!==!0&&this.element.find(".SerializationGrid").grid2("hide","column",0);r.on("change",".rowselectcheckbox",function(){var t=n(this),o=t.parent().parent().index(),r=q.element.find(".SerializationGrid"),u=r.grid2("option","page"),f=q.options.Pages["Page"+u];t.closest("td").metadata().value=t.find(".checkbox").hasClass("checked")?"false":"true";var e=t.parent().parent().index();f.rows[e].selected=t.find(".checkbox").find("input[type=checkbox]").prop("checked")?!0:!1;raiseEvent(q.element.attr("id"),"Control","OnRowChecked")});this.options.designtime&&this.loadGridRows();n(document).on("click",".SourceCode-Forms-Controls-Web-Button",function(){setTimeout(function(){var n=q.element.find(".SerializationGrid");n.grid2("synccolumns");n.grid2("setColumnWidth")},0)});n(document).on("click","ul.tab-box-tabs .tab",function(){setTimeout(function(){var n=q.element.find(".SerializationGrid");n.grid2();n.grid2("synccolumns");n.grid2("setColumnWidth")},0)});this.disableLastPageButton();return},disableLastPageButton:function(){this.element.find(".total").remove();this.element.find(".paging-last").remove()},getIndexOfDuplicate:function(n,t){var r=n.split(","),o=JSON.parse(t),u={},f={};if(o.length>0){u=o[0];for(var s=JSON.parse(this.getSerializedArray(!1)),e=0;e<s.length;e++){for(var h=!0,q=0;q<r.length;q++)if(s[e][r[q]]!==u[r[q]]){h=!1;f={};break}if(h){f=u;break}}}return JSON.stringify(f)},dopaging:function(t,q,r){var f=n(r[0]).closest(".SFC").data().SFCSerializationGrid.options,u=q,o=n(r[0]).closest(".panel")[0],h=o.getAttribute("ID"),e=f.PageRows;switch(t){case"start":case"first":u=1;break;case"previous":u--;break;case"next":u++;break;case"end":case"last":u=e;break;default:u=t}var s={SMOGuid:f.AssociationSO,SMOMethod:f.associationmethod,Page:u,PageSize:e};n.ajax({url:"SerializationGridHandler",data:s,dataType:"json",type:"POST",success:function(){alert("hello")},error:function(){}})},setItems:function(){if(this.options.populateData=!0,this.options.SetItemsCounter=this.options.SetItemsCounter+1,!(this.options.SetItemsCounter>1)||this.options.FromRule){var f=this;f.options.GridRows=[];f.options.Pages={};this.options.curPage=1;f.element.find("#"+this.element.attr("id")+"_SerializationGrid").grid2("option","page",1);this.options.usePaging&&this.CheckNextPage(2);for(var n=JSON.parse(f.options.SmartObjectColumnsConfig),a=this,v=[],nt=this.options.PageRows,d=0,y=this.options.jsonData.collection,l=0;l<y.length;l++){for(var g=y[l],r=[],u="",t=0;t<n.length;t++){var o=!1;checkExists(n[t].PrimaryKey)&&(o=n[t].PrimaryKey);var q=g.fields[n[t].ColumnName.trim()];checkExists(q)?(q=q.value,typeof q=="object"&&(q=JSON.stringify(q))):q="";o&&(u+=q);n[t].ReadOnly?r.push({value:SourceCode.Forms.Controls.Web.ControlPack.ControlPackBase.escapeSpecialChar(q),readOnly:n[t].ReadOnly,dataType:n[t].Type}):r.push({value:q,readOnly:n[t].ReadOnly,dataType:n[t].Type})}if(u!=="")var s=a.checkforDuplicates(u);else s=-1;if(s>-1)return;r.key=u;v.push(r);d++}var p=this.options.jsonData.collection,h={};h.jsonData=$extend({},this.options.jsonData);h.rows=[];for(var t=0;t<p.length;t++){var r={};r.selected=!1;r.columnValues={};var c=p[t].fields,u="",e=0;for(var w in c){var o=!1;checkExists(n[e].PrimaryKey)&&(o=n[e].PrimaryKey);var b=c[w].value;o&&(u+=typeof b=="object"?JSON.stringify(c[n[e].ColumnName.trim()].value):c[n[e].ColumnName.trim()].value);var k={};k.Value=SourceCode.Forms.Controls.Web.ControlPack.ControlPackBase.escapeSpecialChar(b);r.columnValues[w]=k;e++}var s=-1;u!==""&&(s=a.checkforDuplicates(u));s<=-1&&(r.key=u,h.rows.push(r))}this.options.Pages.Page1=h;f.options.GridRows=v;f.loadGridRows();this.options.settingItems=!1;this.options.FromRule=!1;raiseEvent(this.element.attr("id"),"Control","OnSetItemsCompleted")}},GenerateGrid:function(n){for(var t=JSON.parse(n),q=0;q<t.length;q++)t[q].width="auto",t[q].Title=t[q].DisplayName,t[q].DisplayName=SourceCode.Forms.Controls.Web.ControlPack.ControlPackBase.escapeSpecialChar(t[q].DisplayName);var r=this.element.find(".SerializationGrid");r.grid2("GenerateDynamicGrid",t)},setValue:function(){var r=this,q=1;if(this.options.designtime!==!0&&this.updateTable(),this.options.value){r.options.GridRows=[];var w=this.options.value,b=this.options.SmartObjectColumnsConfig?JSON.parse(this.options.SmartObjectColumnsConfig):[];if(w){var t=JSON.parse(w),o=[];if(t.length===0)return;if(this.options.isDynamic){var u="";for(var k in t[0]){u=t[0][k];break}this.GenerateGrid(JSON.stringify(u));this.options.SmartObjectColumnsConfig=[];for(var f=0;f<u.length;f++){var e={};e.Type=u[f].PropertyType;e.dataType=u[f].PropertyType;e.ReadOnly=!1;e.Source=u[f].Source;e.ColumnName=u[f].DisplayName;this.options.SmartObjectColumnsConfig.push(e)}this.options.SmartObjectColumnsConfig=JSON.stringify(this.options.SmartObjectColumnsConfig);b=JSON.parse(this.options.SmartObjectColumnsConfig);for(var a=0;a<t.length;a++){var d={},h="";for(var k in t[0]){h=t[a][k];break}for(var c=0;c<h.length;c++)d[h[c].DisplayName]=h[c].Value;o.push(d)}t=o;t.length===1&&(o=o[0],t=o);this.element.addClass("dynamic")}else this.element.removeClass("dynamic");if(t){t.$values&&(t=t.$values);var g=!1,l=[];this.options.Pages={};var nt=0,s={};n(t).each(function(t,u){q=Math.ceil((nt+1)/parseInt(r.options.PageRows));var f={};if(f.selected=!1,f.columnValues={},r.options.usePaging||(q=1),checkExists(r.options.Pages["Page"+q]))s=r.options.Pages["Page"+q];else{var o={};o.Empty=!1;o.rows=[];r.options.Pages["Page"+q]=o;s=r.options.Pages["Page"+q];l=[]}var e="",h={};n(b).each(function(){if(this.ColumnName!="$type"){var n=this.ColumnName,t=!1;this.ReadOnly===!0&&(t=!0);typeof this.dataType!="undefined"&&this.Type==="YesNo"&&(t=!1);var r=this.Type,q=!1;checkExists(this.PrimaryKey)&&(q=this.PrimaryKey);typeof u[n]=="object"?(q&&(e+=u[n]),h[n]={Value:checkExists(u[n])?JSON.stringify(u[n]):"",readOnly:t,dataType:r}):(q&&(e+=u[n]),h[n]={Value:checkExists(u[n])?u[n]:"",Name:n,readOnly:t,dataType:r})}});var c=-1;if(e!==""&&(c=r.checkforDuplicates(e)),c>-1){g=!0;return}f.key=e;f.columnValues=h;l.push(f);nt++;s.rows=l;r.options.Pages["Page"+q]=s});s.rows=l;g&&raiseEvent(this.element.attr("id"),"Control","Duplicate Key Detected")}}q=q+1;var v={};v.Empty=!0;v.rows=[];this.options.Pages["Page"+q]=v;this.options.isDynamic||this.loadGridPages(2);var y=this.element.find(".SerializationGrid");if(y.grid2("option","totalpages",q-1),setTimeout(function(){var n=r.element.find(".SerializationGrid");n.grid2("synccolumns");n.grid2("setColumnWidth")},0),typeof this.options.Pages["Page"+this.options.curPage]!="undefined"){var p=this.options.curPage;this.options.Pages["Page"+this.options.curPage].Empty&&(p=this.options.curPage-1);y.grid2("option","page",p);this.loadGridPages(p)}else y.grid2("option","page",1),this.loadGridPages(1)}},loadGridRows:function(){var s=this,e=s.element.find(".SerializationGrid");e.grid2("clear");e.grid2("clearsort");var h=[],r=s.options.SmartObjectColumnsConfig?JSON.parse(s.options.SmartObjectColumnsConfig):null;if(this.options.designtime===!0)for(var s=this,u=0;u<parseInt(s.options.PageRows);u++){for(var c=[],d=r?r.length:3,q=0;q<d;q++){var l=!0;(r&&r[q].ReadOnly===!1||!r)&&(l=!1);c.push({value:"data",readOnly:l})}h.push(c)}else for(var f=this.options.GridRows,a=!0,u=0;u<f.length;u++){for(var c=[],q=0;q<f[u].length;q++){try{if(checkExistsNotEmpty(r[q].Format)){var g=parseXML(r[q].Format).selectSingleNode("/Format/@CustomValue").text;r[q].Format=r[q].Format.replace(/>C</g,">"+g+"<")}}catch(et){}var nt={formatXmlString:r[q].Format,elementToStyle:null,value:f[u][q].value},o=SCCultureHelper.current.applyFormatToControlValue(nt);typeof o=="undefined"&&(o="");o=o.toString();f[u][q].value=o;f[u][q].display=o;var l=r[q].ReadOnly;typeof r[q].Type!="undefined"&&r[q].Type==="YesNo"&&(l=!1,f[u][q].display=r[q].DisplayName);f[u][q].readOnly=l;c[q]=f[u][q];checkExistsNotEmpty(o)&&(a=!1)}a||h.push(c);a=!0}var v=0;for(var tt in this.options.Pages){var qt=this.options.Pages[tt];v+=qt.rows.length}var rt={cellclass:"rowselectcheckbox",readOnly:!1};if(h.length>0&&(n(h).each(function(n,t){t.length>0&&(t=t.splice(0,0,rt))}),e.grid2("add","rows",h)),s.options.usePaging){var ot=s.options.PageRows;e.grid2("option","totalpages",Math.ceil(v/parseInt(this.options.PageRows))==0?1:Math.ceil(v/parseInt(this.options.PageRows)));e.grid2("updatePagingControls")}if(t.convertBool(this.options.designtime)!==!0&&(this.options.text=this.options.EnableSelectRows?this.getSerializedArray(!0):this.getSerializedArray(!1),this.options.serializedValue=this.getSerializedArray(!1),this.options.designtime||raiseEvent(this.element.attr("id"),"Control","OnChange")),e.grid2("synccolumns"),this.options.designtime!==!0&&this.setGridValues(),this.options.isDynamic){for(var ut=this.element.find(".grid-body-content tr"),w=this.element.find(".grid-body-content colgroup"),b=w.children(),y=1;y<b.length;y++)n(b[y]).remove();for(var ft=n(ut[0]).find("td"),k=1;k<ft.length;k++){var p=document.createElement("col");n(p).data().width="40px";n(p).data().sortable=!0;w.append(p)}var e=this.element.find(".SerializationGrid");e.grid2("setColumnWidths","150px")}},toggleGridVisible:function(){},setGridHeaderAlignment:function(){try{for(var q=JSON.parse(this.options.SmartObjectColumnsConfig),u=this.element.find(".grid-column-header-text "),t=0;t<u.length;t++){if(t>q.length)break;if(checkExists(q[t])&&checkExists(q[t].HeaderTextAlign)){var r="left";switch(q[t].HeaderTextAlign){case 0:r="left";break;case 1:r="center";break;case 2:r="right"}n(u[t+1]).css("text-align",r)}}}catch(f){}},setGridValues:function(){for(var b=this.element.find(".SerializationGrid"),qt=b.grid2("option","page"),rt=this.options.Pages["Page"+qt],f=b.grid2("fetch","rows"),q=JSON.parse(this.options.SmartObjectColumnsConfig),r=0;r<f.length;r++)for(var h=this.options.GridRows[r],t=0;t<h.length;t++){if(checkExists(q[t].TextAlign)){var c="left";switch(q[t].TextAlign){case 0:c="left";break;case 1:c="center";break;case 2:c="right"}}var u=n(f[r]).find("td").eq(t+1);if(u.css("text-align",c),h[t].dataType==="YesNo"){var k=this.base._booleanConverter(h[t].value),ut=q[t].ReadOnly;if(k){var u=n(f[r]).find("td").eq(t+1);u.length>0&&u.find("input[type=checkbox]").checkbox("check")}else{var u=n(f[r]).find("td").eq(t+1);u.length>0&&u.find("input[type=checkbox]").checkbox().checkbox("uncheck")}if(ut){var u=n(f[r]).find("td").eq(t+1);u.length>0&&u.find("input[type=checkbox]").checkbox("disable")}var u=n(f[r]).find("td").eq(t+1);u.find("input[type=checkbox]").off("change").on("change",function(){u=n(this).closest("td");u.metadata().value=this.checked?"true":"false"})}if(typeof q[t].Icon!="undefined"&&q[t].Icon&&q[t].Icon!=="none"&&q[t].Icon!==""){var d=0,l={},g=!1,e=q[t].Icon?JSON.parse(q[t].Icon):null;if(checkExists(e)&&e.length>0){for(var o=0;o<e.length;o++)e[o].ConditionalValue==="[*]"&&(g=!0),l[e[o].ConditionalValue]=e[o].iconValue;for(var a=0;a<q.length;a++)q[a].ColumnName===e[0].columnValue&&(d=a);var p=n(f[r]).find("td").eq(t+1).find(".grid-content-cell"),nt=n(f[r]).find("td").eq(d+1).metadata().value,v="none";g&&(v=l["[*]"]);typeof l[nt]!="undefined"&&(v=l[nt]);v!=="none"&&p.addClass("icon "+v)}}if(typeof q[t].Source!="undefined"&&q[t].Source&&q[t].Source!=="none"&&q[t].Source!==""){var k=h[t].value,p=n(f[r]).find("td").eq(t+1).find(".grid-content-cell"),ft=q[t].Source.split("\n"),w=0,tt=[];n(ft).each(function(){var n={text:this.toString(),value:this.toString(),className:"",selected:w==0?!0:!1,index:w};tt.push(n);w++});p.html("<div class='grid-content-cell-wrapper'><select class='drpSource'><\/select><\/div>");var s=p.find(".drpSource");s.dropdown({items:tt});s.dropdown("refresh");s.dropdown("SelectedValue",k);var u=n(f[r]).find("td").eq(t+1);u.metadata().value=n(s).dropdown("SelectedValue").toString();s.off("change").on("change",function(){u=n(this).closest("td");u.metadata().value=n(this).dropdown("SelectedValue").toString()})}var y=n(f[r]).find("td").eq(0);if(y.length>0&&(delete y.data().options.value,y.find(".grid-content-cell").addClass("edit-mode"),y.find("input[type=checkbox]").checkbox().checkbox("uncheck")),rt.rows[r].selected){var et=n(f[r]).find("td").eq(0);et.find("input[type=checkbox]").checkbox().checkbox("check")}}},applyColumnSettings:function(n){if(n){var u=n.selectSingleNode('Property[Name="SmartObjectColumnsConfig"]/Value'),e=n.selectSingleNode('Property[Name="EnableRowSelect"]/Value'),o=!1;if(e&&(o=this.convertBool(e.text)),u){var f=[],r=JSON.parse(u.text),s={name:"RowSelectCheckbox",width:"30",hidden:o===!0?null:!0,control:"checkbox",sortable:!1,resizable:!1};f.push(s);for(var q=0;q<r.length;q++){var h={name:r[q].ColumnName,display:!r[q].DisplayName||r[q].DisplayName===""?r[q].ColumnName:r[q].DisplayName,width:r[q].Width,hidden:r[q].Visible!==!0&&r[q].Visible!=="true"?!0:null,control:typeof r[q].dataType!="undefined"?r[q].dataType==="YesNo"?"checkbox":"":"",sortable:t.convertBool(r[q].Sortable)};f.push(h)}var c=this.element.find(".SerializationGrid");c.grid2("setColumns",f);this.options.SmartObjectColumnsConfig=u.text;this.loadGridRows()}}},setRowSelection:function(n){n&&(this.options.EnableSelectRows=n);t.convertBool(this.options.EnableSelectRows)?(this.element.find(".SerializationGrid").grid2("unhide","column",0),this.element.addClass("multiselect"),this.element.removeClass("singleselect")):(this.element.find(".SerializationGrid").grid2("hide","column",0),this.element.addClass("singleselect"),this.element.removeClass("multiselect"))},setEnabled:function(){},setVisible:function(){if(this.element.toggleClass("hidden",!this.options.isVisible),this.options.isVisible){var n=this.element.find(".SerializationGrid");n.grid2("synccolumns");n.grid2("setColumnWidth")}},validateAssociationMethod:function(n){var h=this,q=jQuery.ajax({url:"Utilities/AJAXCall.ashx",data:{method:"getItems",resultTypes:"ObjectProperties|ObjectMethods",targetType:"Object",targetId:n},dataType:"text",global:!1,async:!1,error:this.error}).responseText;if(q!=null){for(var f=parseXML(q).documentElement.selectSingleNode("Item"),e=f.selectSingleNode("Items"),r=!1,u=e.selectNodes('Item[@ItemType="Method"]'),t=0,o=u.length;t<o;t++){var s=u[t];if(s.getAttribute("SubType")==="list"){r=!0;break}}return r}return!0},addSerializedRowNewHelper:function(n){var l=this.element.find(".SerializationGrid"),p=this.element.find(".paging-right"),f=[];for(var a in this.options.Pages)for(var t=0;t<this.options.Pages[a].rows.length;t++)f.push(this.options.Pages[a].rows[t]);var e=Math.ceil(f.length/parseInt(this.options.PageRows))===0?1:Math.ceil(f.length/parseInt(this.options.PageRows)),w=Math.floor(f.length/parseInt(this.options.PageRows))===0?1:Math.floor(f.length/parseInt(this.options.PageRows)),h=this.options.Pages["Page"+e];if(!checkExists(this.options.Pages["Page"+e])){var u={};u.rows=[];this.options.Pages.Page1=u;h=this.options.Pages.Page1}try{for(var r=JSON.parse(n),q=JSON.parse(this.options.SmartObjectColumnsConfig),o="",n={},t=0;t<q.length;t++){var c=!1;checkExists(q[t].PrimaryKey)&&(c=q[t].PrimaryKey);typeof r[q[t].ColumnName.trim()]=="object"?(c&&(o+=r[q[t].ColumnName.trim()]),n[q[t].ColumnName.trim()]={Value:checkExists(r[q[t].ColumnName.trim()])?JSON.stringify(r[q[t].ColumnName.trim()]):"",readOnly:q[t].ReadOnly,dataType:q[t].Type}):(c&&(o+=r[q[t].ColumnName.trim()]),n[q[t].ColumnName.trim()]={Value:checkExists(r[q[t].ColumnName.trim()])?SourceCode.Forms.Controls.Web.ControlPack.ControlPackBase.escapeSpecialChar(r[q[t].ColumnName.trim()]):"",readOnly:q[t].ReadOnly,dataType:q[t].Type})}var s={};if(s.selected=!1,s.columnValues=n,o!=="")var v=this.checkforDuplicates(o);else v=-1;if(v>-1){raiseEvent(this.element.attr("id"),"Control","Duplicate Key Detected");return}if(s.key=o,h.rows.length>=this.options.PageRows){var u={};u.rows=[];u.rows.push(s);u.Empty=!1;this.options.Pages["Page"+(e+1)]=u;l.grid2("option","page",e+1)}else l.grid2("option","page",e),h.rows.push(s),h.Empty=!1;this.loadGridPages(w);p.addClass("disabled");var b=this;setTimeout(function(){var n=b.element.find(".SerializationGrid");n.grid2("synccolumns");n.grid2("setColumnWidth")},0);raiseEvent(this.element.attr("id"),"Control","OnChange")}catch(k){popupManager.showError("Unable to Serialize Row<br><br>"+k.message)}var y=this.element.find(".grid-column-headers").find("input[type=checkbox]").parent();y.checkbox();y.checkbox("uncheck")},addSerializedRowNew:function(n){this.getAllPages(1,this.addSerializedRowNewHelper,n)},addSerializedRow:function(n){this.options.GridRows.length>this.options.PageRows;this.updateTable();try{for(var r=JSON.parse(n),q=JSON.parse(this.options.SmartObjectColumnsConfig),u="",n=[],t=0;t<q.length;t++){var e=!1;checkExists(q[t].PrimaryKey)&&(e=q[t].PrimaryKey);typeof r[q[t].ColumnName.trim()]=="object"?(e&&(u+=r[q[t].ColumnName.trim()]),n.push({value:JSON.stringify(r[q[t].ColumnName.trim()]),readOnly:q[t].ReadOnly,dataType:q[t].Type})):(e&&(u+=r[q[t].ColumnName.trim()]),n.push({value:r[q[t].ColumnName.trim()],readOnly:q[t].ReadOnly,dataType:q[t].Type}))}if(u!=="")var o=this.checkforDuplicates(u);else o=-1;if(o>-1){raiseEvent(this.element.attr("id"),"Control","Duplicate Key Detected");return}if(n.key=u,this.options.GridRows.push(n),this.options.GridRows.length>this.options.PageRows){var f=this.options.GridRows.length/this.options.PageRows;this.options.GridRows.length%this.options.PageRows!=0&&(f=f+1);var h=this.element.find(".SerializationGrid");h.grid2("option","page",f);this.options.curPage=f}this.loadGridRows();var c=this;setTimeout(function(){var n=c.element.find(".SerializationGrid");n.grid2("synccolumns");n.grid2("setColumnWidth")},0)}catch(l){popupManager.showError("Unable to Serialize Row<br><br>"+l.message)}var s=this.element.find(".grid-column-headers").find("input[type=checkbox]").parent();s.checkbox();s.checkbox("uncheck")},checkforDuplicates:function(n){var q=[];for(var f in this.options.Pages)for(var u=this.options.Pages[f],r=0;r<u.rows.length;r++)q.push(u.rows[r]);for(var t=0;t<q.length;t++)if(n===q[t].key)return t;return-1},getAllPages:function(t,q,r){var u=this;if(this.options.getallpagescalled||!this.options.populateData){q.call(u,r,f-1);return}var f=t,e=function(n){var l=n.c[0].collection,s=JSON.parse(u.options.SmartObjectColumnsConfig),t={};if(t.rows=[],t.jsonData=$extend({},n),!checkExists(u.options.Pages["Page"+f]))for(var a=0;a<l.length;a++){var e={};e.selected=!1;e.columnValues={};var h=l[a].fields,c="",o=0;for(var v in h){var y=!1;checkExists(s[o].PrimaryKey)&&(y=s[o].PrimaryKey);var p=h[v].value;y&&(c+=typeof p=="object"?JSON.stringify(h[s[o].ColumnName.trim()].value):h[s[o].ColumnName.trim()].value);var w={};w.Value=SourceCode.Forms.Controls.Web.ControlPack.ControlPackBase.escapeSpecialChar(p);e.columnValues[v]=w;o++}var b=-1;if(c!=="")var b=u.checkforDuplicates(c);b<=-1&&(e.key=c,t.rows.push(e))}if(l.length>0)checkExists(u.options.Pages["Page"+f])||(u.options.Pages["Page"+f]=t),u.getAllPages(f+1,q,r);else{if(!checkExists(u.options.Pages["Page"+f])){t.Empty=!0;u.options.Pages["Page"+f]=t;var k=u.element.find(".SerializationGrid");k.grid2("option","totalpages",f-1)}u.options.getallpagescalled=!0;q.call(u,r,f-1)}},o=this.options.brokerPackage[0].metadata;o.pagenumber=f.toString();var s=sendPacket(n.extend([],this.options.brokerPackage),null);s.then(e,null)},removeCheckRowsHelper:function(){var e=[];for(var q in this.options.Pages)for(var n=0;n<this.options.Pages[q].rows.length;n++)if(this.options.Pages[q].rows[n].selected){var r={};r.page=parseInt(q.replace("Page",""));r.row=n;e.push(r)}var t=this.element.find(".SerializationGrid");this.reshufflePages(e);var u=t.grid2("option","page"),f=t.grid2("option","totalpages");u>f&&(t.grid2("option","page",f),u=f);this.loadGridPages(u+1);var o=this.element.find(".grid-column-headers").find("input[type=checkbox]").parent();o.checkbox().checkbox("uncheck");t.grid2("synccolumns")},removeCheckedRows:function(){this.getAllPages(3,this.removeCheckRowsHelper)},removeSelectedRowsHelper:function(){var n=this.element.find(".SerializationGrid"),u=[],f=n.grid2("fetch","selected-rows").index();if(f!==-1){var e=n.grid2("option","page"),t={};t.page=e;t.row=f;u.push(t);this.reshufflePages(u);var q=n.grid2("option","page"),r=n.grid2("option","totalpages");q>r&&(n.grid2("option","page",r),q=r);this.loadGridPages(q+1);var o=this.element.find(".grid-column-headers").find("input[type=checkbox]").parent();o.checkbox().checkbox("uncheck");n.grid2("synccolumns")}},removeSelectedRows:function(){this.getAllPages(3,this.removeSelectedRowsHelper)},updateTable:function(){for(var q=this.options.SmartObjectColumnsConfig?JSON.parse(this.options.SmartObjectColumnsConfig):[],c=n(this.element).find(".SerializationGrid").grid2("fetch","rows","objects"),e=[],r=this.options.curPage*this.options.PageRows,o=r;o<r+this.options.PageRows;o++){var u=c[o];if(typeof u=="undefined")break;for(var s=[],t=0;t<q.length;t++){var f={};f.value=typeof u[t+1].value!="undefined"?u[t+1].value:u[t+1].display;f.readOnly=typeof q[t].dataType!="undefined"?q[t].dataType==="YesNo"?!1:q[t].ReadOnly:q[t].ReadOnly;f.dataType=q[t].Type;s.push(f)}e.push(s)}var h=0;if(e.length>0)for(var t=r;t<r+this.options.PageRows;t++)this.options.GridRows[t]=e[h],h++},replaceSelectedRow:function(t){this.updateTable();try{for(var f=n(this.element).find(".SerializationGrid"),s=f.grid2("fetch","rows").index(),e=f.grid2("option","page"),u=JSON.parse(t),r=JSON.parse(this.options.SmartObjectColumnsConfig),t={},q=0;q<r.length;q++)t=typeof u[r[q].ColumnName.trim()]=="object"?{Value:JSON.stringify(u[r[q].ColumnName.trim()]),readOnly:r[q].ReadOnly,dataType:r[q].Type}:{Value:u[r[q].ColumnName.trim()],readOnly:r[q].ReadOnly,dataType:r[q].Type};this.options.Pages["Page"+e].rows[s].columnValues=t;this.loadGridPages(e+1)}catch(o){popupManager.showError(o.message+"<br><br>"+o.stack)}},countCheckedRows:function(){var t=0;for(var q in this.options.Pages)for(var n=0;n<this.options.Pages[q].rows.length;n++)this.options.Pages[q].rows[n].selected&&t++;return t},countRows:function(){var n=0;for(var q in this.options.Pages)for(var t=0;t<this.options.Pages[q].rows.length;t++)n++;return n},clearEditableColumns:function(){var t=JSON.parse(this.options.SmartObjectColumnsConfig),s=this.options.GridRows;for(var u in this.options.Pages)for(var r=this.options.Pages[u],q=0;q<r.rows.length;q++)for(var n=0;n<t.length;n++)t[n].ReadOnly===!1&&(r.rows[q].columnValues[t[n].ColumnName].Value="");var f=this.element.find(".SerializationGrid"),e=f.grid2("option","page");this.loadGridPages(e+1);var o=this.element.find(".grid-column-headers").find("input[type=checkbox]").parent();o.checkbox().checkbox("uncheck")},getSerializedRow:function(t){var e=n(this.element).find(".SerializationGrid").grid2("fetch","selected-rows","objects");if(this.options.SmartObjectColumnsConfig&&this.options.designtime!=!0){var r=JSON.parse(this.options.SmartObjectColumnsConfig),f=[];if(!this.options.EnableSelectRows&&e.length==1){for(var o=e[0],u={},q=0;q<r.length;q++)try{u[r[q].ColumnName]=SourceCode.Forms.Controls.Web.ControlPack.ControlPackBase.formatSpecialChar(this.setRowColumnOld(o[q+1],r[q]))}catch(l){u[r[q].ColumnName]=this.setRowColumnOld(o[q+1],r[q]);t&&(u[r[q].ColumnName]=JSON.stringify(u[r[q].ColumnName]))}f.push(u);var s={};try{s=decodeURI(JSON.stringify(f))}catch(l){s=JSON.stringify(f)}return s}for(var h=0;h<e.length;h++){for(var o=e[h],u={},q=0;q<r.length;q++)try{u[r[q].ColumnName]=SourceCode.Forms.Controls.Web.ControlPack.ControlPackBase.formatSpecialChar(this.setRowColumnOld(o[q+1],r[q]))}catch(l){u[r[q].ColumnName]=this.setRowColumnOld(o[q+1],r[q]);t&&(u[r[q].ColumnName]=JSON.stringify(u[r[q].ColumnName]))}f.push(u)}var c=[];try{c=decodeURI(JSON.stringify(f))}catch(l){c=JSON.stringify(f)}return c}},getSerializedArray:function(n,t){var q=[];if(n){try{q=decodeURI(this.getSerializedValueFromPages(!1,t))}catch(r){q=this.getSerializedValueFromPages(!1,t)}return q}try{q=decodeURI(this.getSerializedValueFromPages(!0,t))}catch(r){q=this.getSerializedValueFromPages(!0,t)}return q},getSerializedValue:function(q){var a=this.options.indexPage;curIndex=a*this.options.PageRows;endIndex=curIndex+this.options.PageRows;var u=n(this.element).find(".SerializationGrid").grid2("fetch","rows","objects");if(q&&(u=n(u).filter(function(n,q){return t.convertBool(q[0].value)})),this.options.SmartObjectColumnsConfig&&this.options.designtime!=!0){var f=JSON.parse(this.options.SmartObjectColumnsConfig),e=[];if(!this.options.EnableSelectRows&&u.length==1){for(var l=u[0],o={},r=0;r<f.length;r++)o[f[r].ColumnName]=this.setRowColumn(l[r+1]);e.push(o);var s={};try{s=decodeURI(JSON.stringify(e))}catch(v){s=JSON.stringify(e)}return s}for(var h=0;h<u.length;h++){for(var l=u[h],o={},r=0;r<f.length;r++)o[f[r].ColumnName]=this.setRowColumn(l[r+1]);e.push(o)}var c=[];try{c=decodeURI(this.getSerializedValueFromPages())}catch(v){c=this.getSerializedValueFromPages()}return c}},setRowColumn:function(n){try{return isNaN(n.Value)?JSON.parse(SourceCode.Forms.Controls.Web.ControlPack.ControlPackBase.formatSpecialChar(n.Value)):n.Value}catch(t){return n.Value}},setRowColumnOld:function(n,t){try{if(n.length>0&&n[0]==="{"){var q=JSON.parse(SourceCode.Forms.Controls.Web.ControlPack.ControlPackBase.formatSpecialChar(n.value));if(t.Type=="Text"&&typeof n.value=="object")return JSON.stringify(n.value)}}catch(r){}try{return isNaN(n.value)?JSON.parse(SourceCode.Forms.Controls.Web.ControlPack.ControlPackBase.formatSpecialChar(n.value)):n.value}catch(r){return n.value}},clear:function(){this.element.find(".SerializationGrid").grid2("clear");this.element.find(".SerializationGrid").grid2("clearsort");this.options.Pages={};this.options.pages={}},execute:function(t){t.CurrentControlId=t.CurrentControlID;var r=!1;checkExists(t.methodParameters.stringifyobjects)&&(r=t.methodParameters.stringifyobjects);var u=t.methodName,f=t.methodParameters.serializedrow,e=t.methodParameters.properties,o=t.methodParameters.value,s=t.methodParameters.replaceserializedrow,h=n("#"+t.CurrentControlId),q;switch(u){case"RefreshSerializationGrid":return this.pageLoad();case"ClearSerializationGrid":return this.clear();case"SerializationGridGetSerializedSelectedRow":q=this.getSerializedRow(r);break;case"SerializationGridGetSerializedSelectedRows":q=this.getSerializedArray(!0,r);break;case"RemoveSelectedRows":q=this.removeCheckedRows();break;case"RemoveSelectedRow":q=this.removeSelectedRows();break;case"SerializationGridGetSerializedAllRows":q=this.getSerializedArray(!1,r);break;case"AddSerializedRow":this.addSerializedRowNew(f);break;case"ReplaceSelectedRow":this.replaceSelectedRow(s);break;case"CountCheckedRows":q=this.countCheckedRows();break;case"CountRows":q=this.countRows();break;case"ClearEditableColumns":this.clearEditableColumns();break;case"GetDuplicateRow":q=this.getIndexOfDuplicate(e,o);break;case"GoToCurrentPage":this.goToCurrentPage()}return q},applyChanges:function(){var n=!1;this.options.Height!==this.options.previous.Height&&(this._createGrid(),this.element.find(".SerializationGrid").css("height",this.options.Height).grid2("setHeight",this.options.Height));this.options.usePaging!==this.options.previous.usePaging&&(this._createGrid(),this.element.find(".SerializationGrid").grid2("setPaging",this.options.usePaging),n=!0);this.options.EnableSelectRows!==this.options.previous.EnableSelectRows&&(this.setRowSelection(t.convertBool(this.options.EnableSelectRows)),n=!0);this.options.Width!==this.options.previous.Width&&(this.element.find(".SerializationGrid").css("width",this.options.Width),this.element.find(".SerializationGrid").grid2("synccolumns"));this.options.IsEnabledGrid!==this.options.previous.IsEnabledGrid&&(t.convertBool(this.options.IsEnabledGrid)==!0?(this.element.removeClass("disabled"),this.element.addClass("enabled")):(this.element.removeClass("enabled"),this.element.addClass("disabled")));this.options.PageRows!==this.options.previous.PageRows&&(n=!0);this.options.SmartObjectColumnsConfig!=this.options.previous.SmartObjectColumnsConfig;this.options.value!=this.options.previous.value&&(this.setValue(),n=!0);this.options.jsonData&&this.options.jsonData!==this.options.previous.jsonData&&this.options.FromRule&&(this.setItems(),n=!1);this.options.isVisible!=this.options.previous.isVisible&&this.setVisible();this.base.applyChanges.apply(this,arguments);n!==!0||this.options.isDynamic||this.loadGridRows()},_optionNameTransformer:function(n){n=n.toLowerCase();switch(n){case"associationso":n="AssociationSO";break;case"serializationso":n="SerializationSO";break;case"brokerpackage":n="brokerPackage";break;case"serializedvalue":n="serializedValue";break;case"gridrows":n="GridRows";break;case"usepaging":n="usePaging";break;case"pagerows":n="PageRows";break;case"isenabledgrid":n="IsEnabledGrid";break;case"width":n="Width";break;case"height":n="Height";break;case"datasourcetype":n="dataSourceType";break;case"isdynamic":n="isDynamic";break;case"jsondata":n="jsonData";break;case"settingitems":n="settingItems";break;case"enableselectrows":n="EnableSelectRows";break;case"smartobjectcolumnsconfig":n="SmartObjectColumnsConfig";break;case"enableselectrows":n="EnableSelectRows";break;case"fromrule":n="FromRule";break;case"pagingcallback":n="pagingCallback";break;default:n=this.base._optionNameTransformer(n)}return n},_optionValueConverter:function(n,t){n=n.toLowerCase();switch(n){case"usepaging":t=t=="true"||t==!0;case"width":default:t=this.base._optionValueConverter(n,t)}return t},destroy:function(){n(this.element).off(".SerializationGrid");n.Widget.prototype.destroy.call(this)}});n.sfc.SFCSerializationGrid.prototype.base=n.sfc.baseWidget.prototype;n(function(){n(".SFC.SourceCode-Forms-Controls-Web-ControlPack-SerializationGrid-SerializationGrid").each(function(t,q){var r=n(q).attr("data-options"),u=JSON.parse(r);n(this).SFCSerializationGrid(u)})})})(jQuery);
/*!
 SourceCode.Forms.Controls.Web.ManagementControlPack.SerializationGrid.Resources.JS.jquery.forms.controls.grid2.js (Embedded resource)
*/
Grid2Resources={emptygrid:Resources.CommonPhrases.EmptyGridMessageText,page:Resources.CommonLabels.PagingPageText,pagecount:Resources.CommonLabels.PagingTotalPagesText,gofirst:Resources.CommonLabels.PagingFirstPageText,golast:Resources.CommonLabels.PagingLastPageText,goprevious:Resources.CommonLabels.PagingPreviousPageText,gonext:Resources.CommonLabels.PagingNextPageText,actionrow:Resources.CommonActions.AddText},function(n){(typeof SourceCode=="undefined"||SourceCode===null)&&(SourceCode={});(typeof SourceCode.Forms=="undefined"||SourceCode.Forms===null)&&(SourceCode.Forms={});(typeof SourceCode.Forms.Controls=="undefined"||SourceCode.Forms.Controls===null)&&(SourceCode.Forms.Controls={});SourceCode.Forms.Controls.Grid2={_create:function(){var t=this.options;this.resources=n.extend(t.resources,Grid2Resources);this.multiline=t.multiline;this.dragcolumns=t.dragcolumns;this.multiselect=t.multiselect;this.rowclick=t.rowclick;this.rowdblclick=t.rowdblclick;this.disablemodulus=t.disablemodulus;this.zebraStripes=t.zebraStripes;this.header=null;this.toolbars=null;this.columntable=null;this.contenttable=null;this.footer=null;this.summary=null;this.sortColumn=null;this.reverseSort=null;this.actionrow=t.actionrow;this.page=1;this.totalpages=1;this.autopopulate=t.autopopulate;this.columns=[];var s=this.element,q=s.children();q.filter(".grid-header").length>0&&(this.header=q.filter(".grid-header").find(".grid-header-text").eq(0));q.filter(".grid-toolbars").length>0&&(this.toolbars=q.filter(".grid-toolbars").children(".toolbars").toolbargroup());q.filter(".grid-footer").length>0&&(this.footer=q.filter(".grid-footer").children(".toolbars").toolbargroup());q.filter(".grid-summary").length>0&&(this.summary=q.filter(".grid-summary"));this.rownumbering=s.is(".with-rownumbering");var e=q.filter(".grid-aggregation");if(e.length!==0&&(this.aggregationContentTableBody=e.find("tbody"),this._applyAggregationHeaderClickHandler(e)),this.summary!=null&&this.summary.length>0&&this.element.is(".full.with-summary")&&q.filter(".grid-body").css("bottom",this.summary.outerHeight()),this.columnsheadertable=q.filter(".grid-body").children(".grid-column-headers").find("table.grid-column-header-table"),this.contentscrollwrapper=q.filter(".grid-body").find(".grid-body-content .grid-body-content-wrapper > .scroll-wrapper"),this.contenttable=this.contentscrollwrapper.children("table.grid-content-table"),this.contenttabletbody=this.contenttable.children("tbody").filter(function(){return n(this).closest("table").not(".control-table")}),!checkExists(t.columns)||!t.columns.length||t.columns.length==0)for(var o=this.contenttable.children("colgroup").children("col"),u=0,v=o.length;u<v;u++){for(var h={},f=["name","display","sortable","align","datatype","hidden","modulus","width","resizable"],r=0,y=f.length;r<y;r++){var c=o.eq(u)!=null?o.eq(u).metadata():{};checkExists(c[f[r]])&&(h[f[r]]=c[f[r]])}this.columns.push(h)}if(this.multiselect)if(SourceCode.Forms.Browser.mozilla)this.contenttabletbody.css("MozUserSelect","none");else if(SourceCode.Forms.Browser.msie)this.contenttabletbody.on("selectstart",function(){return!1});else this.contenttabletbody.on("mousedown",function(){return!1});this.contenttabletbody.children("tr.action-row").length>0&&(this.actionrow=!0);this.actionrow&&this._applyActionRow();var l=this,a=this.element.children(".grid-header");if(a.length>0)a.on("click","a",function(){n(this).is(".collapse-vertical")?l.collapse():n(this).is(".expand-vertical")&&l.expand()});if(t.height.length>0&&this.setHeight(),t.rowdblclick)this.contenttabletbody.on("dblclick","tr.edit-row",t.rowdblclick);if(t.rowclick)this.contenttabletbody.on("click","tr.edit-row",t.rowclick);this._syncWidths();this._applyScrollEventHandlers();this._applyColumnHeaderClickHandlers();this._applyColumnHeaderResizeHandlers();this._applyWindowResizeHandler();t.autopopulate&&t.url!=undefined&&t.url!=""&&this.populate();t.paging&&this._buildPagingControls();this._applyEditableColumnHandlers();this.runtimeSyncColumns()},_applyEditableColumnHandlers:function(){var t=this;this.contenttabletbody.on("focusout",".valuebox input[type=text]",function(){var t=this.value;n(this).closest("td").removeClass().addClass("{ value: '"+t+"' }").metadata().value=this.value})},collapse:function(){this.element.addClass("collapsed");this.element.children(".grid-header").find(".collapse-vertical").removeClass("collapse-vertical").addClass("expand-vertical");this._trigger("collapse")},destroy:function(){n.Widget.prototype.destroy.apply(this,arguments)},expand:function(){this.element.removeClass("collapsed");this.element.children(".grid-header").find(".expand-vertical").removeClass("expand-vertical").addClass("collapse-vertical");this._syncWidths(!1);this._trigger("expand")},setHeight:function(){},html:function(t){checkExists(t)||(t={resources:{}});n.extend(t.resources,Grid2Resources);var q="<div";checkExists(t.id)&&t.id!=""&&(q+=' id="'+t.id+'"');q+=' class="grid';q+=checkExists(t.header)&&t.header!=""?" with-header":" without-header";q+=checkExists(t.footer)&&t.footer?" with-footer":" without-footer";q+=" without-aggregation with";t.rownumbering!==!0&&(q+="out");q+="-rownumbering";checkExists(t.toolbars)||(t.toolbars=0);switch(t.toolbars){case 3:q+=" with-triple-toolbar";break;case 2:q+=" with-double-toolbar";break;case 1:q+=" with-toolbar";break;default:q+=" without-toolbar"}return q+=checkExists(t.fullsize)&&t.fullsize?" full":"",q+='">',checkExists(t.header)&&t.header!=""&&(q+=this._generateHeaderHTML(t.header)),t.toolbars>0&&(q+='<div class="grid-toolbars">',q+=SourceCode.Forms.Controls.ToolbarGroup.html({toolbars:t.toolbars}),q+="<\/div>"),q+='<div class="grid-body">',q+=this.generateColumnsHeaderHTML(t),q+='<div class="grid-body-content"><div class="grid-body-content-wrapper"><div class="scroll-wrapper">',q+='<table class="grid-content-table">',q+=this._generateColGroupHTML(t),q+="<tbody>",q+=t.actionrow?this._generateActionRowHTML(t):this._generateEmptyGridHTML(t),q+="<\/tbody><\/table>",q+="<\/div><\/div><\/div>",q+='<div class="grid-drag-elements"><\/div>',q+="<\/div>",checkExists(t.footer)&&t.footer&&(q+=this._generateFooterHTML()),checkExists(t.templates)&&checkExists(t.templates.edit)&&t.templates.edit&&(q+=this._generateEditTemplateHTML()),checkExists(t.templates)&&checkExists(t.templates.display)&&t.templates.display&&(q+=this._generateDisplayTemplateHTML()),q+"<\/div>"},_generateColGroupHTML:function(n){var r="";if(checkExists(n.columns)&&n.columns.length&&n.columns.length>0){r+="<colgroup>";for(var t=0,e=n.columns.length;t<e;t++){var q=[],u=[],f=[];checkExists(n.columns[t].name)&&n.columns[t].name!=""&&q.push("name:'"+n.columns[t].name+"'");checkExists(n.columns[t].modulus)&&Boolean(n.columns[t].modulus)&&q.push("modulus:"+Boolean(n.columns[t].modulus).toString());checkExists(n.columns[t].datatype)&&n.columns[t].datatype!=""&&q.push("datatype:'"+n.columns[t].datatype+"'");checkExists(n.columns[t].control)&&n.columns[t].control!=""&&q.push("control:'"+n.columns[t].control+"'");checkExists(n.columns[t].hidden)&&Boolean(n.columns[t].hidden)?(q.push("hidden:"+Boolean(n.columns[t].hidden).toString()),f.push("hidden")):checkExists(n.columns[t].width)&&n.columns[t].width!=""&&(q.push("width:'"+n.columns[t].width+"'"),checkExists(n.columns[t].modulus)&&Boolean(n.columns[t].modulus)?u.push("min-width:"+n.columns[t].width):u.push("width:"+n.columns[t].width));checkExists(n.columns[t].align)&&n.columns[t].align!=""&&(q.push("align:'"+n.columns[t].align+"'"),u.push("text-align:"+n.columns[t].align));checkExists(n.columns[t].sortable)&&Boolean(n.columns[t].sortable)?q.push("sortable:"+Boolean(n.columns[t].sortable).toString()):q.push("sortable:true");q.length>0&&f.push("{ "+q.join(", ")+" }");r+='<col class="'+f.join(" ")+'" style="'+u.join("; ")+'" />'}r+="<\/colgroup>"}return r},_generateHeaderHTML:function(n){return'<div class="grid-header"><div class="grid-header-wrapper"><div class="wrapper"><div class="grid-header-text">'+n+"<\/div><\/div><\/div><\/div>"},generateColumnsHeaderHTML:function(n){n.rownumbering===!0&&n.columns.unshift({display:"#",width:66});var t='<div class="grid-column-headers"><div class="grid-column-headers-wrapper">';return t+='<table class="grid-column-header-table" cellpadding="0" cellspacing="0" border="0">',t+="<tbody>",t+=this._generateColumnsHeaderCellsHTML(n),t+="<\/tbody><\/table>",t+"<\/div><\/div>"},runtimeSyncColumns:function(){var t=this.element.find("table.grid-column-header-table, table.grid-edit-templates-table, table.grid-display-templates-table, table.grid-summary-content-table"),q=this.contenttable.children("colgroup");t.each(function(){n(this).children("colgroup").remove();n(this).prepend(q.clone(!0))});t.each(function(){this.style.width=""})},_generateColumnsHeaderCellsHTML:function(n){var q="";if(checkExists(n.columns)&&n.columns.length&&n.columns.length>0){q+="<tr>";for(var t=0,f=n.columns.length;t<f;t++){var u=[],r=[];checkExists(n.columns[t].name)&&n.columns[t].name!=""&&r.push("name:'"+n.columns[t].name+"'");checkExists(n.columns[t].hidden)&&Boolean(n.columns[t].hidden)&&r.push("hidden:"+Boolean(n.columns[t].hidden).toString());checkExists(n.columns[t].modulus)&&Boolean(n.columns[t].modulus)&&r.push("modulus:"+Boolean(n.columns[t].modulus).toString());checkExists(n.columns[t].align)&&n.columns[t].align!=""&&r.push("align:'"+n.columns[t].align+"'");checkExists(n.columns[t].datatype)&&n.columns[t].datatype!=""&&r.push("datatype:'"+n.columns[t].datatype+"'");checkExists(n.columns[t].width)&&n.columns[t].width!=""&&r.push("width:'"+n.columns[t].width+"'");checkExists(n.columns[t].control)&&n.columns[t].control!=""&&r.push("control:'"+n.columns[t].control+"'");checkExists(n.columns[t].sortable)?(r.push("sortable:"+Boolean(n.columns[t].sortable).toString()),n.columns[t].sortable===!1&&u.push("not-sortable")):r.push("sortable:true");checkExists(n.columns[t].resizable)?(r.push("resizable:"+Boolean(n.columns[t].resizable).toString()),n.columns[t].resizable===!1&&u.push("not-resizable")):r.push("resizable:true");checkExists(n.columns[t].hidden)&&n.columns[t].hidden&&u.push("hidden");q+='<td class="';q+=u.join(" ");q+=" { "+r.join(", ")+" }";q+='" style="';checkExists(n.columns[t].hidden)&&n.columns[t].hidden||checkExists(n.columns[t].width)&&n.columns[t].width!="auto"&&parseInt(n.columns[t].width)>0&&(q+="width: "+n.columns[t].width);q+='"><div class="grid-column-header-cell"><div class="grid-column-header-cell-wrapper"><div class="grid-column-header-text" title="'+n.columns[t].display+'">';q+=checkExists(n.columns[t].display)?n.columns[t].display:"";q+="<\/div>";checkExists(n.customcolumns)&&n.customcolumns&&(q+='<a href="javascript:;" class="grid-column-header-button" title="Hide/Show Columns"><span><\/span><\/a>');q+='<div class="grid-column-header-divider"><\/div><\/div><\/div><\/td>'}q+="<\/tr>"}return q},_generateActionRowHTML:function(n){return'<tr class="action-row"><td class="action-row"'+(checkExists(n.columns)&&n.columns.length>0?' colspan="'+n.columns.length+'"':"")+'><div class="grid-content-cell"><div class="grid-content-cell-wrapper"><a href="javascript:;" class="action-row">'+(checkExists(n.resources)&&checkExists(n.resources.actionrow)?n.resources.actionrow:SCGrid2Defaults.options.resources.actionrow)+"<\/a><\/div><\/div><\/td><\/tr>"},_generateEmptyGridHTML:function(n){return'<tr class="empty-grid"><td class="empty-grid"'+(checkExists(n.columns)&&n.columns.length>0?' colspan="'+n.columns.length+'"':"")+'><div class="grid-content-cell"><div class="grid-content-cell-wrapper">'+(checkExists(n.resources)&&checkExists(n.resources.emptygrid)?n.resources.emptygrid:SCGrid2Defaults.options.resources.emptygrid)+"<\/div><\/div><\/td><\/tr>"},_generateFooterHTML:function(){return'<div class="grid-footer">'+SourceCode.Forms.Controls.ToolbarGroup.html({toolbars:1})+"<\/div>"},_generateDisplayTemplateHTML:function(){return'<div class="grid-display-templates"><table class="grid-display-templates-table" cellpadding="0" cellspacing="0" border="0"><tbody><\/tbody><\/table><\/div>'},_generateEditTemplateHTML:function(){return'<div class="grid-edit-templates"><table class="grid-edit-templates-table" cellpadding="0" cellspacing="0" border="0"><tbody><\/tbody><\/table><\/div>'},_getColumnIndex:function(n){for(var q=-1,t=0,r=this.columns.length;t<r;t++)if(checkExists(this.columns[t].name)&&this.columns[t].name==n){q=t;break}return q},_applyAggregationHeaderClickHandler:function(n){var t=this.options;n.find(".grid-aggregation-header-link").on("click",function(){if(n.is(".collapsed")){var q=t.canexpand;q===undefined?q=!0:typeof q=="function"&&(q=q());q===!0&&n.removeClass("collapsed").addClass("expanded")}else n.removeClass("expanded").addClass("collapsed")})},_applyScrollEventHandlers:function(){var t=this;this.contentscrollwrapper.on("scroll",function(q){t.columnsheadertable.css("left","-"+n(q.target).scrollLeft()+"px")})},_applyColumnHeaderClickHandlers:function(){var t=this;if(t.options.sorting)t.columnsheadertable.on("click","td",function(){if(!n(this).is(".not-sortable")){var q=n(this).parent().children().index(this);t.columns[q].sortable&&t.sort(q,!1)}})},_applyColumnHeaderResizeHandlers:function(){var t=this;t.columnsheadertable.on("mousedown.grid","td:not(.not-resizable) .grid-column-header-divider",function(q){var s=t.columns.filter(t._visibleColumn.bind(t)),a=s.every(t._explicitWidth.bind(t)),h=s.every(t._percentageWidth.bind(t)),r=n(this).closest("td"),p=r.parent().children("td").index(r),e=r.offset(),o=t.columnsheadertable.offset(),c=t.columnsheadertable.width(),u,l=e.top,f,v=l+r.height();n("html").attr("dir")=="rtl"?(u=o.left,f=o.left+c-50,h?(u=r.nextAll("td:visible").first().offset().left+50,f=e.left+r.width()-50):u-=10):(u=e.left+50,f=o.left+c,h?f=u+r.width()+r.nextAll("td:visible").first().width()-100:a&&(f+=10));var y=[u,l,f,v];return n(this).draggable({appendTo:t.columnsheadertable.parent()[0],axis:"x",containment:y,helper:"clone",start:function(){n(this).closest(".grid-column-header-table").overlay()},stop:function(q,r){n(this).closest(".grid-column-header-table").removeOverlay();var s=n("html").attr("dir")=="rtl"?r.originalPosition.left-r.position.left:r.position.left-r.originalPosition.left,e=n(this).closest("td"),u=e.parent().children("td").index(e);if(s!=0){if(t._explicitWidth(t.columns[u])){var f=parseInt(checkExists(t.columns[u].modulus)&&t.columns[u].modulus?e.width():t.columns[u].width)+s;t.columns[u].width=(f>0?f:0)+"px";t._setColumnWidth(u)}else if(t._percentageWidth(t.columns[u])&&checkExists(t.columns[u+1])&&t._percentageWidth(t.columns[u+1])){var h=e.width(),o=parseInt(t.columns[u].width),c=parseInt(t.columns[u+1].width),f=Math.floor(o*((h+s)/h));t.columns[u].width=f+"%";t.columns[u+1].width=(o>f?c+(o-f):c-(f-o))+"%";t._setColumnWidth(u);t._setColumnWidth(u+1)}t._trigger("colresize",q,{grid:t.element,columns:t.columns});t._syncWidths(null,!0);t._resizeColumnHeaderCells()}},zIndex:1e3}).trigger(q),q.stopPropagation(),!1})},_resizeColumnHeaderCells:function(){for(var q=this.columnsheadertable,t=q.find("tr:first-child td"),n=0;n<t.length;n++)t[n].style.height=null;if(this.element.is(":visible"))for(var r=q.outerHeight()+"px",n=0;n<t.length;n++)t[n].style.height=r},_applyContentClickHandlers:function(){var t=this;t.contenttabletbody.on("click",function(q){var r=n(q.target).closest("tr"),o=t.fetch("rows"),s=o.index(r);if(s!=-1){if(q.button==0&&!r.hasClass("empty-grid")&&!r.hasClass("action-row"))if(r.hasClass("selected")){if(t.multiselect&&q.ctrlKey)t.deselect([s],q);else if(t.multiselect){for(var f=t.fetch("selected-rows"),e=[],u=0,h=f.length;u<h;u++)r.get(0)!=f.get(u)&&e.push(o.index(f.eq(u)));t.deselect(e,q)}}else{if(!(t.multiselect&&q.ctrlKey)){for(var f=t.fetch("selected-rows"),e=[],u=0,h=f.length;u<h;u++)e.push(o.index(f.eq(u)));t.deselect(e,q)}t.select([s],q)}r.hasClass("edit-template-row")||t._trigger("rowclick",q,r)}});if(this.options.showcustomcontextmenu==null||this.options.showcustomcontextmenu=="undefined")t.contenttabletbody.on("contextmenu",function(q){var u=n(q.target).closest("tr"),o=t.fetch("rows"),s=o.index(u);if(s!=-1){if(!t.multiselect||t.multiselect&&!q.ctrlKey&&q.button!=2){for(var f=t.fetch("selected-rows"),e=[],r=0,h=f.length;r<h;r++)f[r]!=u[0]&&e.push(o.index(f.eq(r)));t.deselect(e,q)}if(u.is(".selected")||t.multiselect&&(!t.multiselect||q.ctrlKey||q.button==2)){if(!u.is(".selected")&&(!t.multiselect||t.multiselect&&!q.ctrlKey&&q.button==2)){for(var f=t.fetch("selected-rows"),e=[],r=0,h=f.length;r<h;r++)f[r]!=u[0]&&e.push(o.index(f.eq(r)));t.deselect(e,q);t.select([s],q)}}else t.select([s],q);t._trigger("rowcontextmenu",q,u);q.preventDefault()}});t.contenttabletbody.on("dblclick",function(q){if(q.target.tagName!=undefined){var r=n(q.target).closest("tr"),u=t.fetch("rows"),f=u.index(r);f!=-1&&t._trigger("rowdblclick",q,r)}})},_applyWindowResizeHandler:function(){var t=this;n(window).on("resize",function(){t.runtimeSyncColumns();t._syncWidths()})},clearsort:function(){this.reverseSort=null;this.sortColumn=null;this.columnsheadertable.children("tbody").children("tr").children("td").children(".grid-column-header-cell").removeClass("asc").removeClass("desc")},sort:function(n,t){if(this.reverseSort==null&&(this.reverseSort=[]),this.reverseSort[n]==null&&(this.reverseSort[n]=t),n==this.sortColumn&&(this.reverseSort[n]=!this.reverseSort[n]),this.sortColumn=n,checkExists(this.options.customsort)&&typeof this.options.customsort=="function")this.options.customsort(n,this.reverseSort[n],this.element);else{for(var u=this.fetch("rows"),o,q,r,s,f=0,h=u.length;f<h-1;f++){o=f;q=u.eq(f).children("td").eq(n).metadata().value;(q==undefined||q==null||q=="")&&(q=u.eq(f).children("td").eq(n).text());q=this._normalizeString(q);for(var e=f+1;e<h;e++)r=u.eq(e).children("td").eq(n).metadata().value,(r==undefined||r==null||r=="")&&(r=u.eq(e).children("td").eq(n).text()),r=this._normalizeString(r),s=this._compareValues(q,r,this.columns[n].datatype),this.reverseSort[n]&&(s=-s),s>0&&(o=e,q=r);o>f&&u.eq(o).insertBefore(u.eq(f));u=this.fetch("rows")}this._applyZebraStripes()}this.columnsheadertable.children("tbody").children("tr").children("td").children(".grid-column-header-cell").removeClass("asc").removeClass("desc");this.columnsheadertable.children("tbody").children("tr").children("td").eq(n).children(".grid-column-header-cell").addClass(this.reverseSort[n]?"desc":"asc")},_compareValues:function(n,t,q){var r,u;return(q=="number"?(r=parseFloat(n),u=parseFloat(t),isNaN(r)||isNaN(u)||(n=r,t=u)):(typeof n=="string"&&(n=n.toLowerCase()),typeof t=="string"&&(t=t.toLowerCase())),n==t)?0:n>t?1:-1},_normalizeString:function(n){return n=n.replace(new RegExp("\\s\\s+","g")," "),n.replace(new RegExp("^\\s*|\\s*$","g"),"")},_escapeMetadataString:function(n){return encodeURI(n)},escapeSpecialChar:function(n){if(checkExistsNotEmpty(n))try{return n.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}catch(t){return n}return n},synccolumns:function(){this._syncWidths();this._trigger("synccolumns",null,this.columns)},syncWidths:function(n){this._syncWidths(n)},_regex:{repx:/^(\d{1,})(px)?(%{0})$/,repw:/^100(\.0{0,2})? *%$|^\d{1,2}(\.\d{1,2})? *%$/},_explicitWidth:function(n){return checkExists(n.width)&&n.width.toString().match(SCGrid2._regex.repx)!=null},_modulusColumn:function(n){return checkExists(n.modulus)&&n.modulus===!0?!0:!1},_percentageWidth:function(n){return checkExists(n.width)&&n.width.toString().match(SCGrid2._regex.repw)!=null},_resizableColumn:function(n){return checkExists(n.resizable)&&n.resizable===!0?!0:!1},_visibleColumn:function(n){return checkExists(n.hidden)&&n.hidden===!0?!1:!0},_getGridMinWidth:function(){var n=this.columns.filter(this._visibleColumn.bind(this)),r=n.every(this._explicitWidth.bind(this));if(r){for(var q=0,t=0,u=n.length;t<u;t++)q+=parseInt(n[t].width);return q}return-1},setColumnWidth:function(n,t){checkExists(n)||(n=0);this._setColumnWidth(n,t)},_setColumnWidth:function(n,t){var s=this.element.find("table.grid-column-header-table, table.grid-content-table, table.grid-edit-templates-table, table.grid-display-templates-table, table.grid-summary-content-table"),h=this.contenttable.children("colgroup");t!=undefined&&(this.columns[n].width=t);var c=h.find("> col:nth-child("+(n+1)+")"),o=s.find("> tbody > tr > td:nth-child("+(n+1)+")");o.length>0&&o.each(function(){this.style.width=""});var q={},u=[],e=[],r=0;checkExists(this.columns[n].name)&&this.columns[n].name!=""&&(q.name=this.columns[n].name,r++);checkExists(this.columns[n].modulus)&&Boolean(this.columns[n].modulus)&&(q.modulus=Boolean(this.columns[n].modulus),r++);checkExists(this.columns[n].datatype)&&this.columns[n].datatype!=""&&(q.datatype=this.columns[n].datatype,r++);checkExists(this.columns[n].control)&&this.columns[n].control!=""&&(q.control=this.columns[n].control,r++);checkExists(this.columns[n].hidden)&&Boolean(this.columns[n].hidden)?(q.hidden=Boolean(this.columns[n].hidden),r++,e.push("hidden")):checkExists(this.columns[n].width)&&this.columns[n].width!=""&&(q.width=this.columns[n].width,r++,checkExists(this.columns[n].modulus)&&Boolean(this.columns[n].modulus)?u.push("min-width:"+this.columns[n].width):u.push("width:"+this.columns[n].width));checkExists(this.columns[n].align)&&this.columns[n].align!=""&&(q.align=this.columns[n].align,r++,u.push("text-align:"+this.columns[n].align));checkExists(this.columns[n].sortable)&&Boolean(this.columns[n].sortable)?(q.sortable=Boolean(this.columns[n].sortable),r++):(q.sortable=!0,r++);var f="<col";e.length>0&&(f+=' class="'+e.join(" ")+'"');r>0&&(f+=' data-options="'+jQuery.toJSON(q).htmlEncode()+'"');f+=' style="'+u.join("; ")+'" />';c.replaceWith(f)},_setGridWidth:function(){var n=this.columns.filter(this._visibleColumn.bind(this)),t=n.every(this._explicitWidth.bind(this));t&&this.element.find("table.grid-content-table").css("min-width",this._getGridMinWidth()+"px")},_syncWidths:function(t,q){if(q||this.options.disableInternalWidthSync!==!0){var s=this.element.find("table.grid-column-header-table, table.grid-content-table, table.grid-edit-templates-table, table.grid-display-templates-table, table.grid-summary-content-table"),c=this.contenttable.children("colgroup"),l=this.columns.filter(this._visibleColumn.bind(this)),a=l.every(this._explicitWidth.bind(this)),h=-1,e,f;if(a&&l.length>0){for(var r=0,v=this.columns.length;r<v;r++)if(checkExists(this.columns[r].modulus)&&this.columns[r].modulus)break;r==v&&r--;var o=c.find("> col:nth-child("+(r+1)+")"),u=s.find("> tbody > tr > td:nth-child("+(r+1)+")");h=r;s.length>0&&s.each(function(){this.style.width=""});o.length>0&&(o[0].style.width="");u.length>0&&u.each(function(){this.style.width=""});var y=this.contenttable.width(),p=this._getGridMinWidth();y>p?(f=parseInt(this.columns[r].width)+(y-p),e=parseInt(this.columns[r].width)):f=e=parseInt(this.columns[r].width);o.length>0&&(o[0].style.width=f+"px");u.length>0&&u.each(function(){this.style.minWidth=e+"px";this.style.width=f+"px"})}this.element.find("table.grid-column-header-table, table.grid-edit-templates-table, table.grid-display-templates-table, table.grid-summary-content-table").each(function(){if(n(this).children("colgroup").remove(),n(this).prepend(c.clone(!0)),a&&h>-1){var t=n(this).find("> tbody > tr > td:nth-child("+(h+1)+")");t.length>0&&t.each(function(){this.style.minWidth=e+"px";this.style.width=f+"px"})}});var b=this.contenttable.width();this.element.find("table.grid-column-header-table, table.grid-edit-templates-table, table.grid-display-templates-table, table.grid-summary-content-table").each(function(){this.style.width=b+"px"});var w=this.element.find("table.grid-column-header-table"),k=w.find("> colgroup > col"),u=w.find("> tbody > tr > td");u.find(".grid-column-header-cell").each(function(){this.style.width=""});k.each(function(n){var f=u.eq(n),q=f.children().first(),r=q.width(),t=q.find(".grid-column-header-text.LabelWrap");t.length>0&&(t[0].style.maxWidth="");r>0&&(q[0].style.width=r+"px",t.length>0&&(t[0].style.maxWidth=r+"px"))})}t!==!1&&this._applyZebraStripes();this.options.triggersynccolumns===!0&&(this.options.triggersynccolumns=!1,this._trigger("synccolumns",null,this.columns))},setColumnWidths:function(n){for(var t=0;t<this.columns.length;t++)this.columns[t].width=n},fetch:function(){switch(arguments[0]){case"header":return this.header;case"toolbars":return this.toolbars;case"columns":return this.columns;case"footer":if(this.footer!=null)return this.footer;break;case"rows":var t=this.contenttabletbody.children("tr:not(.action-row):not(.empty-grid):not(.edit-template-row, .display-template-row)");switch(arguments[1]){case"objects":return this._getSelectedValueObjects(t);case"objectsrows":return this._getSelectedValueObjectsRows(t);case"text":return this._getSelectedText(t);case"values":return this._getSelectedValues(t);default:return t}break;case"selected-rows":switch(arguments[1]){case"objects":return this._getSelectedValueObjects(this.contenttabletbody.children("tr.selected"));case"text":return this._getSelectedText(this.contenttabletbody.children("tr.selected"));case"values":return this._getSelectedValues(this.contenttabletbody.children("tr.selected"));default:return this.contenttabletbody.children("tr.selected")}break;case"first-row":case"last-row":var t=this.fetch("rows"),q=arguments[0]=="first-row"?t.first():t.last();switch(arguments[1]){case"objects":return this._getSelectedValueObjects(q);case"text":return this._getSelectedText(q);case"values":return this._getSelectedValues(q);default:return q}break;case"edit-template-row":return this.element.children(".grid-edit-templates").eq(0).find("table:not(.control-table) tbody tr:not(.control-table-row)");case"display-template-row":return this.element.children(".grid-display-templates").eq(0).find("table tbody tr");case"edit-template-field":return n(this.element.children(".grid-edit-templates").eq(0).find("table:not(.control-table) tbody tr:not(.control-table-row)")[0].children[arguments[1]]).find(".grid-content-cell-wrapper").html()}},add:function(){switch(arguments[0]){case"header":this._addHeader(arguments[1]);break;case"toolbar":this._addToolbar();break;case"footer":this._buildFooter();break;case"row":this._addRow(arguments[1],arguments[2],arguments[3],arguments[4]);break;case"rows":this._addRows(arguments[1],arguments[2],arguments[3],arguments[4]);break;case"row2":this._addRow2(arguments[1],arguments[2],arguments[3],arguments[4]);break;case"edit-template":this._addRowTemplate("edit",arguments[1],arguments[2],arguments[3]);break;case"display-template":this._addRowTemplate("display",arguments[1],arguments[2],arguments[3]);break;case"paging-controls":this._buildPagingControls()}},_getSelectedValueObjects:function(n){for(var o=[],u=0,c=n.length;u<c;u++){for(var s=[],h=n.eq(u).children("td"),f=0,l=h.length;f<l;f++){var q={},r=h.eq(f),t=r.metadata();if(checkExists(t.icon)&&(q.icon=t.icon),checkExists(t.value))try{q.value=t.value.match(/[_\.!~*'()-]/)&&t.value.match(/%[0-9a-f]{2}/)?t.value:decodeURI(t.value)}catch(a){q.value=t.value}if(checkExists(t.control)&&(q.control=t.control),q.display=this._normalizeString(r.text()),!checkExists(t.value)&&r.children(".grid-content-cell").is(".edit-mode")){var e=r.children(".grid-content-cell").children(".grid-content-cell-wrapper");e.children().length==1&&e.children().is("label.checkbox, label.radio")&&(q.value=e.find("input[type=checkbox], input[type=radio]").is(":checked"))}s.push(q)}o.push(s)}return o},_getSelectedValueObjectsRows:function(n){for(var s=[],r=0,l=n.length;r<l;r++){for(var f=[],h=n.eq(r).children("td"),e=0,a=h.length;e<a;e++){var q={},u=h.eq(e),t=u.metadata();if(checkExists(t.icon)&&(q.icon=t.icon),checkExists(t.value))try{q.value=decodeURI(t.value)}catch(v){q.value=t.value}if(checkExists(t.control)&&(q.control=t.control),q.display=this._normalizeString(u.text()),!checkExists(t.value)&&u.children(".grid-content-cell").is(".edit-mode")){var o=u.children(".grid-content-cell").children(".grid-content-cell-wrapper");o.children().length==1&&o.children().is("label.checkbox, label.radio")&&(q.value=o.find("input[type=checkbox], input[type=radio]").is(":checked"))}f.push(q)}var c={};c.htmlObject=n[r];f.push(c);s.push(f)}return s},_getSelectedText:function(n){for(var r=[],t=0,e=n.length;t<e;t++){for(var u=[],f=n.eq(t).children("td"),q=0,o=f.length;q<o;q++)u.push(this._normalizeString(f.eq(q).text()));r.push(u)}return r},getString:function(n){var t="";try{t=decodeURI(n)}catch(q){t=n}return t},_getSelectedValues:function(n){for(var u=[],q=0,c=n.length;q<c;q++){for(var f=[],e=n.eq(q).children("td"),r=0,l=e.length;r<l;r++){var o,t,s=e.eq(r),h=s.data().options();t=checkExists(h.value)?this.getString(h.value):this._normalizeString(s.text());o=/^[-+]?\d*\.?\d*$/.test(t)?parseFloat(t):/^[-+]?\d*$/.test(t)?parseInt(t):/^([Ff]+(alse)?|[Tt]+(rue)?)$/.test(t)?Boolean(t):t;f.push(o)}u.push(f)}return u},setRowsClass:function(){for(var n=0,t=arguments[0].length;n<t;n++){var q=arguments[0][n];q.addClass(arguments[1])}},removeRowsClass:function(){for(var n=0,t=arguments[0].length;n<t;n++){var q=arguments[0][n];q.removeClass(arguments[1])}},_addRowTemplate:function(){var f=arguments[0]=="edit"?this.fetch("edit-template-row"):this.fetch("display-template-row");f.find(".edit-mode").removeClass("edit-mode");var r=f.clone(!0);this.contenttabletbody.children("tr.empty-grid").remove();var t=null;checkExists(this.rows)&&this.rows.length>0&&checkExists(arguments[3])&&parseInt(arguments[3])!=NaN&&parseInt(arguments[3])<=this.rows.length&&(t=n(r).insertBefore(this.contenttabletbody.children("tr").eq(parseInt(arguments[3]))));t==null&&(t=this.actionrow?n(r).insertBefore(this.contenttabletbody.children("tr.action-row").eq(0)):n(r).appendTo(this.contenttabletbody));var s=this;r.find(".token-input").tokenbox({accept:".ui-draggable"});for(var u=r.find(".grid-content-cell-wrapper"),t=null,q=0;arguments[1]!=null&&q<u.length&&q<arguments[1].length;q++){n(u[q]).find("select").val(arguments[1][q]);var e=n(u[q]).find(".token-input");e.length>0?e.tokenbox("value",arguments[1][q]):n(u[q]).find("input").val(arguments[1][q])}r.find("select").dropdown();this.rows=this.contenttabletbody.children("tr:not(.empty-grid):not(.action-row):not(.edit-template-row, .display-template-row)");t!=null&&t.length>0&&(t.find("input.input-control[type=checkbox]").checkbox(),t.find("input.input-control[type=radio]").radiobutton(),t.find(".input-control.text-input").textbox(),t.find("select.input-control").dropdown());var o=arguments[2];o===undefined||o===!0?this._syncWidths():this._applyZebraStripes()},_addRow:function(){var r="<tr class=";this.multiline===!1&&(r+="nowrap");checkExists(arguments[3])&&arguments[3]!=""&&(r+=" {0}".format(arguments[3]));r+=">";for(var q=0,s=this.columns.length;q<s;q++){var t={},f=[];checkExists(arguments[0][q])&&(typeof arguments[0][q]=="string"&&(t.value=arguments[0][q]),checkExists(arguments[0][q].icon)&&(t.icon=arguments[0][q].icon),checkExists(arguments[0][q].value)&&(t.value=arguments[0][q].value.htmlDecode().htmlEncode()),checkExists(arguments[0][q].display)&&(t.display=arguments[0][q].display.htmlDecode().htmlEncode()),checkExists(arguments[0][q].control)&&(t.control=arguments[0][q].control),checkExists(arguments[0][q].html)&&(t.html=arguments[0][q].html),checkExists(arguments[0][q].cellclass)&&(t.cellclass=arguments[0][q].cellclass),checkExists(arguments[0][q].counter)&&(t.counter=arguments[0][q].counter),checkExists(arguments[0][q].align)&&(t.align=arguments[0][q].align));r+="<td";var e=[];if(checkExists(t.icon)&&e.push("icon: '"+t.icon+"'"),checkExists(t.value)&&e.push("value: "+(this.columns[q].datatype=="boolean"?t.value:"'"+t.value+"'")),checkExists(t.control)&&e.push("control: '"+t.control+"'"),checkExists(t.counter)&&e.push("counter: "+t.counter),checkExists(this.columns[q].hidden)&&this.columns[q].hidden&&f.push("hidden"),checkExists(t.align)&&t.align!="none"?f.push(t.align.toLowerCase()+"-align"):checkExists(this.columns[q].align)&&this.columns[q].align!="none"&&f.push(this.columns[q].align.toLowerCase()+"-align"),e.length>0&&f.push("{ "+e.join(", ")+" }"),f.length>0&&(r+=' class="'+f.join(" ")+'"'),r+='><div class="grid-content-cell',checkExists(t.icon)&&t.icon!=""&&(r+=" icon "+t.icon),checkExists(t.cellclass)&&t.cellclass!=""&&(r+=" "+t.cellclass),checkExists(t.align)||checkExists(this.columns[q].datatype)&&this.columns[q].datatype=="number"&&(r+=" numeric"),checkExists(this.columns[q].control)&&this.columns[q].control!=""&&(r+=" checkradio-cell"),r+=checkExists(t.display)&&t.display!=""?'"><div class="grid-content-cell-wrapper" title="'+t.display+'">':'"><div class="grid-content-cell-wrapper">',checkExists(t.html)&&t.html!="")r+=t.html;else if(checkExists(this.columns[q].control)&&(this.columns[q].control=="checkbox"||this.columns[q].control=="radiobutton"))switch(this.columns[q].control){case"checkbox":r+=SCCheckbox.html({checked:this.columns[q].datatype=="boolean"&&t.value});break;case"radiobutton":r+=SCRadiobutton.html({})}else r+=checkExists(t.display)?t.display:t.value;r+="<\/div><\/div><\/td>"}r+="<\/tr>";this.contenttabletbody.children("tr.empty-grid").remove();var u=null;this.rows=this.fetch("rows");checkExists(this.rows)&&this.rows.length>0&&checkExists(arguments[2])&&parseInt(arguments[2])!=NaN&&parseInt(arguments[2])<=this.rows.length&&(u=n(r).insertBefore(this.contenttabletbody.children("tr").eq(parseInt(arguments[2]))));u==null&&(u=this.actionrow?n(r).insertBefore(this.contenttabletbody.children("tr.action-row").eq(0)):n(r).appendTo(this.contenttabletbody));u!=null&&u.length>0&&(u.find("input.input-control[type=checkbox]").checkbox(),u.find("input.input-control[type=radio]").radiobutton(),u.find(".input-control.text-input").textbox(),u.find("select.input-control").dropdown());var o=arguments[1];return(o===undefined||o===!0)&&this._syncWidths(),u},_addRows:function(){for(var u="",r=0;r<arguments[0].length;r++){u+="<tr class= edit-row ";this.multiline===!1&&(u+="nowrap");u+=">";for(var q=0,c=this.columns.length;q<c;q++){var t={},o=[];checkExists(arguments[0][r][q])&&(typeof arguments[0][r][q]=="string"&&(t.value=arguments[0][r][q]),checkExists(arguments[0][r][q].icon)&&(t.icon=arguments[0][r][q].icon),checkExists(arguments[0][r][q].value)&&(t.value=arguments[0][r][q].value.htmlDecode().htmlEncode()),checkExists(arguments[0][r][q].display)&&(t.display=arguments[0][r][q].display.htmlDecode().htmlEncode()),checkExists(arguments[0][r][q].control)&&(t.control=arguments[0][r][q].control),checkExists(arguments[0][r][q].html)&&(t.html=arguments[0][r][q].html),checkExists(arguments[0][r][q].cellclass)&&(t.cellclass=arguments[0][r][q].cellclass),checkExists(arguments[0][r][q].counter)&&(t.counter=arguments[0][r][q].counter),checkExists(arguments[0][r][q].align)&&(t.align=arguments[0][r][q].align),checkExists(arguments[0][r][q].readOnly)&&(t.readOnly=arguments[0][r][q].readOnly),checkExists(arguments[0][r][q].type)&&(t.type=arguments[0][r][q].type));u+="<td";var s=[];if(checkExists(t.icon)&&s.push("icon: '"+t.icon+"'"),checkExists(t.value)&&s.push("value: "+(this.columns[q].datatype=="boolean"?t.value:"'"+t.value+"'")),checkExists(t.control)&&s.push("control: '"+t.control+"'"),checkExists(t.counter)&&s.push("counter: "+t.counter),checkExists(this.columns[q].hidden)&&this.columns[q].hidden&&o.push("hidden"),checkExists(t.align)&&t.align!="none"?o.push(t.align.toLowerCase()+"-align"):checkExists(this.columns[q].align)&&this.columns[q].align!="none"&&o.push(this.columns[q].align.toLowerCase()+"-align"),s.length>0&&o.push("{ "+s.join(", ")+" }"),o.length>0&&(u+=' class="serializationGridColumn '+o.join(" ")+'"'),u+=' data-options="'+jQuery.toJSON(t).htmlEncode()+'"',u+='><div class="grid-content-cell',checkExists(t.icon)&&t.icon!=""&&(u+=" icon "+t.icon),checkExists(t.cellclass)&&t.cellclass!=""&&(u+=" "+t.cellclass),checkExists(t.align)||checkExists(this.columns[q].datatype)&&this.columns[q].datatype=="number"&&(u+=" numeric"),checkExists(this.columns[q].control)&&this.columns[q].control!=""&&(u+=" checkradio-cell"),u+=checkExists(t.display)&&t.display!=""?'"><div class="grid-content-cell-wrapper" title="'+t.display+'">':'"><div class="grid-content-cell-wrapper">',checkExists(t.html)&&t.html!="")u+=t.html;else if(t.readOnly!==!1)if(checkExists(this.columns[q].control)&&(this.columns[q].control=="checkbox"||this.columns[q].control=="radiobutton"))switch(this.columns[q].control){case"checkbox":u+=SCCheckbox.html({checked:this.columns[q].datatype=="boolean"&&t.value});break;case"radiobutton":u+=SCRadiobutton.html({})}else u+=checkExists(t.display)?t.display:t.value;else{var e=this.fetch("edit-template-field",q);e==null&&(e="{value}");e.indexOf("{value}")==-1&&q>0&&e.indexOf("checkbox")==-1&&(e="{value}");e=e.replace("{value}",t.type=="Date"?t.display:t.value);u+=e}u+="<\/div><\/div><\/td>"}u+="<\/tr>"}checkExists(SourceCode.Forms.Controls.Textbox)&&n(u).find(".input-control.text-input").textbox();this.contenttabletbody.children("tr.empty-grid").remove();var f=null;checkExists(this.rows)&&this.rows.length>0&&checkExists(arguments[2])&&parseInt(arguments[2])!=NaN&&parseInt(arguments[2])<=this.rows.length&&(f=n(u).insertBefore(this.contenttabletbody.children("tr").eq(parseInt(arguments[2]))));f==null&&(f=this.actionrow?n(u).insertBefore(this.contenttabletbody.children("tr.action-row").eq(0)):n(u).appendTo(this.contenttabletbody));f!=null&&f.length>0&&(f.find("input.input-control[type=checkbox]").checkbox(),f.find("input.input-control[type=radio]").radiobutton(),f.find(".input-control.text-input").textbox(),f.find("select.input-control").dropdown());var h=arguments[1];return(h===undefined||h===!0)&&this._syncWidths(),f},_addRow2:function(){var r="<tr class= edit-row ";this.multiline===!1&&(r+="nowrap");checkExists(arguments[3])&&arguments[3]!=""&&(r+=" {0}".format(arguments[3]));r+=">";for(var q=0,h=this.columns.length;q<h;q++){var t={},e=[];checkExists(arguments[0][q])&&(typeof arguments[0][q]=="string"&&(t.value=arguments[0][q]),checkExists(arguments[0][q].icon)&&(t.icon=arguments[0][q].icon),checkExists(arguments[0][q].value)&&(t.value=arguments[0][q].value.htmlDecode().htmlEncode()),checkExists(arguments[0][q].display)&&(t.display=arguments[0][q].display.htmlDecode().htmlEncode()),checkExists(arguments[0][q].control)&&(t.control=arguments[0][q].control),checkExists(arguments[0][q].html)&&(t.html=arguments[0][q].html),checkExists(arguments[0][q].cellclass)&&(t.cellclass=arguments[0][q].cellclass),checkExists(arguments[0][q].counter)&&(t.counter=arguments[0][q].counter),checkExists(arguments[0][q].align)&&(t.align=arguments[0][q].align),checkExists(arguments[0][q].readOnly)&&(t.readOnly=arguments[0][q].readOnly));r+="<td";var o=[];if(checkExists(t.icon)&&o.push("icon: '"+t.icon+"'"),checkExists(t.value)&&o.push("value: "+(this.columns[q].datatype=="boolean"?t.value:"'"+t.value+"'")),checkExists(t.control)&&o.push("control: '"+t.control+"'"),checkExists(t.counter)&&o.push("counter: "+t.counter),checkExists(this.columns[q].hidden)&&this.columns[q].hidden&&e.push("hidden"),checkExists(t.align)&&t.align!="none"?e.push(t.align.toLowerCase()+"-align"):checkExists(this.columns[q].align)&&this.columns[q].align!="none"&&e.push(this.columns[q].align.toLowerCase()+"-align"),o.length>0&&e.push("{ "+o.join(", ")+" }"),e.length>0&&(r+=' class="serializationGridColumn '+e.join(" ")+'"'),r+=' data-options="'+jQuery.toJSON(t).htmlEncode()+'"',r+='><div class="grid-content-cell',checkExists(t.icon)&&t.icon!=""&&(r+=" icon "+t.icon),checkExists(t.cellclass)&&t.cellclass!=""&&(r+=" "+t.cellclass),checkExists(t.align)||checkExists(this.columns[q].datatype)&&this.columns[q].datatype=="number"&&(r+=" numeric"),checkExists(this.columns[q].control)&&this.columns[q].control!=""&&(r+=" checkradio-cell"),r+=checkExists(t.display)&&t.display!=""?'"><div class="grid-content-cell-wrapper" title="'+t.display+'">':'"><div class="grid-content-cell-wrapper" style="min-height: 16px">',checkExists(t.html)&&t.html!="")r+=t.html;else if(t.readOnly!==!1)if(checkExists(this.columns[q].control)&&(this.columns[q].control=="checkbox"||this.columns[q].control=="radiobutton"))switch(this.columns[q].control){case"checkbox":r+=SCCheckbox.html({checked:this.columns[q].datatype=="boolean"&&t.value});break;case"radiobutton":r+=SCRadiobutton.html({})}else r+=checkExists(t.display)?t.display:t.value;else{var f=this.fetch("edit-template-field",q);f==null&&(f="{value}");f.indexOf("{value}")==-1&&q>0&&f.indexOf("checkbox")==-1&&(f="{value}");f=f.replace("{value}",t.value);r+=f}r+="<\/div><\/div><\/td>"}r+="<\/tr>";checkExists(SourceCode.Forms.Controls.Textbox)&&n(r).find(".input-control.text-input").textbox();this.contenttabletbody.children("tr.empty-grid").remove();var u=null;this.rows=this.fetch("rows");checkExists(this.rows)&&this.rows.length>0&&checkExists(arguments[2])&&parseInt(arguments[2])!=NaN&&parseInt(arguments[2])<=this.rows.length&&(u=n(r).insertBefore(this.contenttabletbody.children("tr").eq(parseInt(arguments[2]))));u==null&&(u=this.actionrow?n(r).insertBefore(this.contenttabletbody.children("tr.action-row").eq(0)):n(r).appendTo(this.contenttabletbody));u!=null&&u.length>0&&(u.find("input.input-control[type=checkbox]").checkbox(),u.find("input.input-control[type=radio]").radiobutton(),u.find(".input-control.text-input").textbox(),u.find("select.input-control").dropdown());var s=arguments[1];return(s===undefined||s===!0)&&this._syncWidths(),u},_buildPagingControls:function(){this.element.children(".grid-footer").length==0&&this.element.append('<div class="grid-footer"><\/div>');this.element.removeClass("without-footer").addClass("with-footer");this.element.children(".grid-footer").children(".toolbars").length==0&&this.element.children(".grid-footer").append(SourceCode.Forms.Controls.ToolbarGroup.html({toolbars:1}));this.footer=this.element.children(".grid-footer").children(".toolbars").toolbargroup();var t=this.footer.toolbargroup("fetch","toolbars").eq(0);if(t.find(".toolbar-button.paging-first").length==0){t.toolbar("add","button",{icon:"paging-first",description:Resources.CommonLabels.PagingFirstPageText});t.toolbar("add","button",{icon:"paging-left",description:Resources.CommonLabels.PagingPreviousPageText});t.toolbar("add","button",{icon:"paging-right",description:Resources.CommonLabels.PagingNextPageText});t.toolbar("add","button",{icon:"paging-last",description:Resources.CommonLabels.PagingLastPageText});var q='<div class="toolbar-divider"><\/div>'+('<div class="grid-paging-control"><div class="grid-paging-control-text current">'+Resources.CommonLabels.PagingPageText+"<\/div>"+SCTextbox.html({id:this.element.attr("id")+"_pagingtxtbox",value:"1"})+'<div class="grid-paging-control-text total">'+Resources.CommonLabels.PagingTotalPagesText.replace("{0}","1")+"<\/div><\/div>");var r=t.find(".toolbar-button.paging-left").eq(0);jQuery(q).insertAfter(r);t.find(".input-control.text-input").addClass("small").textbox();this.unhide("footer");var n=this;t.find(".toolbar-button.paging-first, .toolbar-button.paging-left, .toolbar-button.paging-right, .toolbar-button.paging-last").on("click",function(){jQuery(this).hasClass("disabled")||(jQuery(this).hasClass("paging-first")?n.gotopage("start",n.page,n.element):jQuery(this).hasClass("paging-left")?n.gotopage("previous",n.page,n.element):jQuery(this).hasClass("paging-right")?n.gotopage("next",n.page,n.element):jQuery(this).hasClass("paging-last")&&n.gotopage("end",n.page,n.element))});t.find(".input-control.text-input input[type=text]").on("blur",function(){var q=n.options.page||1,r=n.options.totalpages||1,t=parseInt(jQuery(this).val());!isNaN(t)&&n.page!=t&&t>0&&t<=r?n.gotopage(t,q,n.element):jQuery(this).val(q.toString())}).on("keyup",function(n){n.keyCode==13&&jQuery(this).get(0).blur()}).on("keypress",function(t){var q=t.which!=0?t.which:t.keyCode,f=n.options.page,u=n.options.totalpages,r=parseInt(jQuery(this).val());if(isNaN(r)&&(r=0),q>45&&q<58||q>32&&q<41||q==8){if(q!=8&&r!=0&&r.toString().length>=u.toString().length)return t.preventDefault(),t.stopPropagation(),!1}else return t.preventDefault(),t.stopPropagation(),!1})}SourceCode.Forms.Browser.msie&&this.footer.find(".toolbar-button").attr("onclick","return false");checkExists(n)&&n._updatePagingControls()},GetCurPage:function(){return this.Page},_addHeader:function(){this.header==null&&(this.header=n('<div class="grid-header"><div class="grid-header-l"><\/div><div class="grid-header-c"><div class="grid-header-wrapper"><div class="wrapper"><div class="grid-header-text"><\/div><\/div><\/div><\/div><div class="grid-header-r"><\/div><\/div>').insertBefore(this.element.children(":first-child")).find(".wrapper"),this.element.removeClass("without-header").addClass("with-header"));this.header.text(arguments[0])},_addToolbar:function(){this.toolbars==null&&(this.toolbars=n('<div class="grid-toolbars"><div class="toolbars"><\/div><\/div>').insertBefore(this.element.children(".grid-body")).find(".toolbars"),this.toolbars.toolbargroup(),this.element.removeClass("without-toolbar"));this.toolbars.toolbargroup("addtoolbar");switch(this.toolbars.toolbargroup("fetch","toolbars").length){case 1:this.element.addClass("with-toolbar").removeClass("with-double-toolbar").removeClass("with-triple-toolbar");break;case 2:this.element.addClass("with-double-toolbar").removeClass("with-toolbar").removeClass("with-triple-toolbar");break;case 3:this.element.addClass("with-triple-toolbar").removeClass("with-double-toolbar").removeClass("with-toolbar")}},_buildColumns:function(){var n=this._generateColumnsHeaderCellsHTML({columns:this.columns,customcolumns:this.customcolumns});this.columnsheadertable.children("tbody").html(n);this.columnsheadertable.find("input.input-control[type=checkbox]").checkbox();this.actionrow&&this.contenttabletbody.children("tr.action-row").attr("colspan",this.columns.length)},_buildFooter:function(){if(this.footer==null){var n=this._generateFooterHTML();this.element.append(n);this.element.removeClass("without-footer").addClass("with-footer")}this.footer=this.element.children(".grid-footer").children(".toolbars").toolbargroup()},zebra:function(){this._applyZebraStripes()},GenerateDynamicGrid:function(t){var y=this.columns.shift();this.columns=[];this.columns.push(y);var c=this.element.find(".grid-column-header-table");c.find("colgroup").html("");for(var l=c.find("tr"),a=l.find("td"),e=1;e<a.length;e++)n(a[e]).remove();for(var q=0;q<t.length;q++){var r={};r.datatype="text";r.width=t[q].width;r.sortable=checkExists(t[q].sortable)?t[q].sortable:!1;this.columns.push(r);var o=document.createElement("td");n(o).height("20px");var u=document.createElement("div");n(u).addClass("grid-column-header-cell");var s=document.createElement("div");n(s).addClass("grid-column-header-cell-wrapper");var h=document.createElement("div");n(h).addClass("grid-column-header-cell-content");var f=document.createElement("div");n(f).addClass("grid-column-header-text");n(f).attr("title",checkExists(t[q].Title)?t[q].Title:t[q].DisplayName);n(f).html(t[q].DisplayName);var v=document.createElement("div");n(v).addClass("grid-column-header-divider");h.appendChild(f);s.appendChild(h);u.appendChild(s);u.appendChild(v);o.appendChild(u);l.append(o)}},_applyZebraStripes:function(){if(this.zebraStripes){n(this.contenttable[0]).addClass("zebra-stripes");for(var t=!1,u=this.contenttabletbody[0].getElementsByTagName("tr"),q=0,f=u.length;q<f;q++){var r=n(u[q]);r.removeClass("even");r.css("display")!="none"&&(t==!1?(r.addClass("even"),t=!0):t=!1)}}},clear:function(){this.contenttabletbody.children("tr.edit-template-row").length>0&&this.commit();checkExists(this.options.customsort)||this.clearsort();this.contenttabletbody.children("tr:not(.action-row)").remove();this.actionrow||this.contenttabletbody.html('<tr class="empty-grid"><td class="empty-grid"'+(this.columns.length>0?' colspan="'+this.columns.length+'"':"")+'><div class="grid-content-cell"><div class="grid-content-cell-wrapper">'+this.resources.emptygrid+"<\/div><\/div><\/td><\/tr>");this.rows=this.contenttabletbody.children("tr:not(.empty-grid):not(.action-row)")},populate:function(){var t=this;n.ajax({type:t.options.method,url:t.options.url,dataType:t.options.datatype,data:checkExists(t.options.urldata)?t.options.urldata:{},success:function(q){n(q).find("header").length>0&&t._addHeader(n(q).find("header").text());n(q).find("columns").length>0&&t._importColumns(n(q).find("columns"));n(q).find("rows").length>0&&t._importData(n(q).find("rows"))},error:function(){}})},_importColumns:function(){var q=n(arguments[0]).children("column");this.columns=[];for(var t=0,e=q.length;t<e;t++){for(var f={},u=["name","sortable","align","datatype","hidden","control","modulus"],r=0,o=u.length;r<o;r++)checkExists(q.eq(t).attr(u[r]))&&(f[u[r]]=q.eq(t).attr(u[r])==="true"||q.eq(t).attr(u[r])==="false"?q.eq(t).attr(u[r])==="true"?!0:!1:q.eq(t).attr(u[r]));checkExists(q.eq(t).attr("width"))&&(f.width=q.eq(t).attr("width"));checkExists(f.display)||(f.display=q.eq(t).text());this.columns.push(f)}this._buildColumns()},setColumns:function(n){if(n){this.columns=[];for(var t=0;t<n.length;t++)this.columns.push(n[t])}this._buildColumns();this.contenttable.children("colgroup").replaceWith(this._generateColGroupHTML({columns:this.columns}));this.synccolumns()},_importData:function(){this.clear();for(var f=n(arguments[0]).children("row"),r=0,s=f.length;r<s;r++){for(var e=[],u=0,h=this.columns.length;u<h;u++){var q={},t=f.eq(r).children("cell[column='"+this.columns[u].name+"']");q.display=t.text();q.value=t.attr("value")!=undefined&&t.attr("value")!=""?t.attr("value"):t.text();t.attr("icon")!=""&&(q.icon=t.attr("icon"));e.push(q)}this._addRow(e,!1)}if(this.options.paging){n(arguments[0]).attr("page")!=""&&(this.page=parseInt(n(arguments[0]).attr("page"))+1);var c=n(arguments[0]).attr("total")!=""?parseInt(n(arguments[0]).attr("total")):0,o=n(arguments[0]).attr("rows")!=""?parseInt(n(arguments[0]).attr("rows")):0;this.page=n(arguments[0]).attr("page")!=""?parseInt(n(arguments[0]).attr("page"))+1:1;this.totalpages=o>0?Math.ceil(c/o):1;this._updatePagingControls()}this._syncWidths()},_importSettings:function(){},remove:function(){switch(arguments[0]){case"header":this.header!=null&&this.header.closest(".grid-header").remove();this.header=null;this.element.removeClass("with-header").addClass("without-header");break;case"footer":this.footer!=null&&this.footer.closest(".grid-footer").remove();this.footer=null;this.panel.removeClass("with-footer").addClass("without-footer");break;case"toolbars":(this.toolbars!=null||this.toolbars.length>0)&&this.element.children(".grid-toolbars").remove();this.toolbars=null;this.element.removeClass("with-toolbar").removeClass("with-double-toolbar").removeClass("with-triple-toolbar").addClass("without-toolbar");break;case"row":this.contenttabletbody.children("tr:not(.action-row)").eq(parseInt(arguments[1])).remove();this.rows=this.contenttabletbody.children("tr:not(.empty-grid):not(.action-row):not(.edit-template-row, .display-template-row)");this.rows.length<1&&this.clear();var n=arguments[2];n===undefined||n===!0?this._syncWidths():this._applyZebraStripes();break;case"selected-row":case"selected-rows":this.fetch("selected-rows").remove();this.rows=this.contenttabletbody.children("tr:not(.empty-grid):not(.action-row):not(.edit-template-row, .display-template-row)");this.rows.length<1&&this.clear();this._syncWidths()}},_applyActionRow:function(){function q(n){return checkExists(n.hidden)&&n.hidden===!0?!1:!0}var r=this,t=this.contenttabletbody.find("a.action-row");if(t.length==0){var u='<tr class="action-row"><td class="action-row"'+(checkExists(this.columns)&&this.columns.length>0?' colspan="'+this.columns.filter(q).length+'"':"")+'><div class="grid-content-cell"><div class="grid-content-cell-wrapper"><a href="javascript:;" class="action-row">'+this.resources.actionrow+"<\/a><\/div><\/div><\/td><\/tr>";this.contenttabletbody.append(u);t=this.contenttabletbody.find("a.action-row")}t.on("click",function(t){r._trigger("actionrowclick",t,n(this))})},select:function(){var t=this.contenttabletbody.children("tr:not(.empty-grid):not(.action-row):not(.edit-template-row, .display-template-row)");if(checkExists(arguments[0]))for(var q=arguments[0]||[],r=checkExists(arguments[1])?arguments[1]:null,n=0,u=q.length;n<u;n++)t.eq(q[n]).hasClass("selected")||(t.eq(q[n]).addClass("selected"),this._trigger("rowselect",r,t.eq(q[n])));else for(var n=0,u=t.length;n<u;n++)t.eq(n).hasClass("selected")||(t.eq(n).addClass("selected"),this._trigger("rowselect",r,t.eq(n)))},deselect:function(){var t=this.contenttabletbody.children("tr:not(.empty-grid):not(.action-row):not(.edit-template-row, .display-template-row)");if(checkExists(arguments[0]))for(var q=arguments[0]||[],r=checkExists(arguments[1])?arguments[1]:null,n=0,u=q.length;n<u;n++)t.eq(q[n]).hasClass("selected")&&(t.eq(q[n]).removeClass("selected"),this._trigger("rowunselect",r,t.eq(q[n])));else for(var n=0,u=t.length;n<u;n++)t.eq(n).hasClass("selected")&&(t.eq(n).removeClass("selected"),this._trigger("rowunselect",r,t.eq(n)))},unselect:function(){this.deselect(arguments)},_trigger:function(t,q,r){var f=this.options[t],o=t==this.widgetEventPrefix?t:this.widgetEventPrefix+t;if(q=n.Event(q),q.type=o,q.originalEvent)for(var e=n.event.props.length,u;e;)u=n.event.props[--e],q[u]=q.originalEvent[u];return this.element.trigger(q,r),!(typeof f=="function"&&f.call(this.element[0],r,q)===!1||q.isDefaultPrevented())},moverowup:function(n){n>0&&this.moverow(n,n-1)},moverowdown:function(n){n<this.rows.length-1&&this.moverow(n,n+1)},moverow:function(n,t){n!==t&&(this.rows=this.contenttabletbody.children("tr:not(.empty-grid):not(.action-row):not(.edit-template-row, .display-template-row)"),t==this.rows.length-1?this.rows.eq(n).insertAfter(this.rows.eq(t)):n<t?this.rows.eq(n).insertAfter(this.rows.eq(t)):this.rows.eq(n).insertBefore(this.rows.eq(t)),this.rows=this.contenttabletbody.children("tr:not(.empty-grid):not(.action-row):not(.edit-template-row, .display-template-row)"),this._applyZebraStripes())},moverowtotop:function(n){this.moverow(n,0)},moverowtobottom:function(n){this.moverow(n,this.rows.length-1)},hide:function(){var t=arguments.length==3?arguments[2]:typeof arguments[1]=="boolean"?arguments[1]:!0;switch(arguments[0]){case"column":case"column-header":var n=typeof arguments[1]=="string"?this._getColumnIndex(arguments[1]):arguments[1];n>-1?arguments[0]=="column"?(this.columns[n].hidden=!0,this.contenttable.children("colgroup").children("col:nth-child("+(n+1)+")").addClass("hidden"),this.element.find("table.grid-content-table td:nth-child("+(n+1)+")").addClass("hidden"),this.element.find("table.grid-column-header-table td:nth-child("+(n+1)+")").addClass("hidden"),this.element.find("table.grid-edit-templates-table td:nth-child("+(n+1)+")").addClass("hidden"),this.element.find("table.grid-display-templates-table td:nth-child("+(n+1)+")").addClass("hidden")):this.element.find("table.grid-column-header-table td:nth-child("+(n+1)+")").children().first().hide():t=!1;break;case"column-headers":this.element.addClass("hide-column-headers");t=!1;break;case"header":this.element.removeClass("with-header").addClass("without-header");t=!1;break;case"toolbar":this.toolbars.toolbargroup("hide",arguments[1]);this.toolbars.hasClass("none")?this.element.addClass("without-toolbar").removeClass("with-toolbar").removeClass("with-double-toolbar").removeClass("with-triple-toolbar"):this.toolbars.hasClass("single")?this.element.addClass("with-toolbar").removeClass("without-toolbar").removeClass("with-double-toolbar").removeClass("with-triple-toolbar"):this.toolbars.hasClass("double")?this.element.addClass("with-double-toolbar").removeClass("without-toolbar").removeClass("with-toolbar").removeClass("with-triple-toolbar"):this.toolbars.hasClass("triple")&&this.element.addClass("with-triple-toolbar").removeClass("without-toolbar").removeClass("with-toolbar").removeClass("with-double-toolbar");t=!1;break;case"footer":this.footer&&(this.footer.toolbargroup("hide",0),this.footer.hasClass("none")?this.element.addClass("without-footer").removeClass("with-footer"):this.footer.hasClass("single")&&this.element.addClass("with-footer").removeClass("without-footer"));t=!1;break;case"row":this.rows.eq(arguments[1]).hide();t||this._applyZebraStripes()}t&&this._syncWidths()},unhide:function(){var t=arguments.length==3?arguments[2]:typeof arguments[1]=="boolean"?arguments[1]:!0;switch(arguments[0]){case"column":case"column-header":var n=typeof arguments[1]=="string"?this._getColumnIndex(arguments[1]):arguments[1];if(n>-1)if(arguments[0]=="column"){this.columns[n].hidden=!1;var q=this.contenttable.children("colgroup").children("col:nth-child("+(n+1)+")").removeClass("hidden");checkExists(this.columns[n].width)&&this.columns[n].width!=""&&(this.columns[n].modulus?q[0].style.minWidth=this.columns[n].width:q[0].style.width=this.columns[n].width);this.element.find("table.grid-content-table td:nth-child("+(n+1)+")").removeClass("hidden");this.element.find("table.grid-column-header-table td:nth-child("+(n+1)+")").removeClass("hidden");this.element.find("table.grid-edit-templates-table td:nth-child("+(n+1)+")").removeClass("hidden");this.element.find("table.grid-display-templates-table td:nth-child("+(n+1)+")").removeClass("hidden")}else this.element.find("table.grid-column-header-table td:nth-child("+(n+1)+")").children().first().show();else t=!1;break;case"column-headers":this.element.removeClass("hide-column-headers");t=!1;break;case"header":this.element.removeClass("without-header").addClass("with-header");t=!1;break;case"toolbar":this.toolbars.toolbargroup("unhide",arguments[1]);this.toolbars.hasClass("none")?this.element.addClass("without-toolbar").removeClass("with-toolbar").removeClass("with-double-toolbar").removeClass("with-triple-toolbar"):this.toolbars.hasClass("single")?this.element.addClass("with-toolbar").removeClass("without-toolbar").removeClass("with-double-toolbar").removeClass("with-triple-toolbar"):this.toolbars.hasClass("double")?this.element.addClass("with-double-toolbar").removeClass("without-toolbar").removeClass("with-toolbar").removeClass("with-triple-toolbar"):this.toolbars.hasClass("triple")&&this.element.addClass("with-triple-toolbar").removeClass("without-toolbar").removeClass("with-toolbar").removeClass("with-double-toolbar");t=!1;break;case"footer":this.footer.toolbargroup("unhide",0);this.footer.hasClass("none")?this.element.addClass("without-footer").removeClass("with-footer"):this.footer.hasClass("single")&&this.element.addClass("with-footer").removeClass("without-footer");t=!1;break;case"row":this.rows.eq(arguments[1]).show();t||this._applyZebraStripes()}t&&this._syncWidths()},_setOption:function(t,q){switch(t){case"page":this.page=parseInt(q);this.footer.find(".input-control.text-input input[type=text]").val(this.page.toString());this._updatePagingControls();break;case"totalpages":this.totalpages=parseInt(q);this.footer.find(".grid-paging-control-text.total").text(Resources.CommonLabels.PagingTotalPagesText.replace("{0}",this.totalpages.toString()));this._updatePagingControls();break;case"paging":q==="false"&&(q=!1);q==="true"&&(q=!0);q===!1?(this.hide("footer"),this.options.paging=q):this.options.paging===!1&&q===!0&&(this.options.paging=q,this.unhide("footer"),this.footer.find(".input-control.text-input input[type=text]")?this._updatePagingControls():this._buildPagingControls());break;case"sorting":q===!1?this.columnsheadertable.addClass("not-sortable"):this.columnsheadertable.removeClass("not-sortable")}n.Widget.prototype._setOption.apply(this,arguments)},updatePagingControls:function(){this._updatePagingControls()},_updatePagingControls:function(){var n=this.footer.toolbargroup("fetch","toolbars").eq(0),q=n.find(".toolbar-button.paging-first"),r=n.find(".toolbar-button.paging-left"),u=n.find(".toolbar-button.paging-right"),f=n.find(".toolbar-button.paging-last"),t=n.find(".input-control.text-input input[type=text]"),e=n.find(".grid-paging-control-text.total");t.val(this.page.toString());e.text(Resources.CommonLabels.PagingTotalPagesText.replace("{0}",this.totalpages.toString()));this.totalpages==1?(q.addClass("disabled"),r.addClass("disabled"),u.addClass("disabled"),f.addClass("disabled"),t.prop("disabled",!0)):this.page==1?(q.addClass("disabled"),r.addClass("disabled"),u.removeClass("disabled"),f.removeClass("disabled"),t.prop("disabled",!1)):this.page==this.totalpages?(q.removeClass("disabled"),r.removeClass("disabled"),u.addClass("disabled"),f.addClass("disabled"),t.prop("disabled",!1)):(q.removeClass("disabled"),r.removeClass("disabled"),u.removeClass("disabled"),f.removeClass("disabled"),t.prop("disabled",!1))},gotopage:function(n){checkExists(this.options.custompaging)&&typeof this.options.custompaging=="function"&&this.options.custompaging(n,this.page,this.element)},setPaging:function(n){this._setOption("paging",n);this.setHeight()},_updateAggregation:function(n,t,q){if(q>0)switch(n){case"count":this.aggregationContentTableBody.children(".aggregation-count").children().eq(q).text(t);break;case"avg":this.aggregationContentTableBody.children(".aggregation-average").children().eq(q).text(t);break;case"sum":this.aggregationContentTableBody.children(".aggregation-summary").children().eq(q).text(t);break;case"min":this.aggregationContentTableBody.children(".aggregation-minimum").children().eq(q).text(t);break;case"max":this.aggregationContentTableBody.children(".aggregation-maximum").children().eq(q).text(t)}},_updateRow:function(){for(var e=this.contenttabletbody.children("tr:not(.empty-grid):not(.action-row):not(.edit-template-row, .display-template-row)"),r=e.eq(arguments[2]),q="",t=0,o=this.columns.length;t<o;t++){var n={};checkExists(arguments[0][t])&&(typeof arguments[0][t]=="string"&&(n.value=arguments[0][t]),checkExists(arguments[0][t].icon)&&(n.icon=arguments[0][t].icon),checkExists(arguments[0][t].value)&&(n.value=arguments[0][t].value),checkExists(arguments[0][t].display)&&(n.display=arguments[0][t].display),checkExists(arguments[0][t].control)&&(n.control=arguments[0][t].control),checkExists(arguments[0][t].html)&&(n.html=arguments[0][t].html),checkExists(arguments[0][t].cellclass)&&(n.cellclass=arguments[0][t].cellclass),checkExists(arguments[0][t].counter)&&(n.counter=arguments[0][t].counter));q+='<td style="';checkExists(this.columns[t].hidden)&&this.columns[t].hidden&&(q+="display: none;");checkExists(this.columns[t].align)&&this.columns[t].align!="none"&&(q+="text-align:"+this.columns[t].align+";");q+='"';var u=[];if(checkExists(n.icon)&&u.push("icon: '"+n.icon+"'"),checkExists(n.value)&&u.push("value: "+(this.columns[t].datatype=="boolean"?n.value:"'"+(typeof n.value=="string"?this._escapeMetadataString(n.value):n.value)+"'")),checkExists(n.control)&&u.push("control: '"+n.control+"'"),checkExists(n.counter)&&u.push("counter: "+n.counter),q+=' class="{ '+u.join(", ")+' }"',q+='><div class="grid-content-cell',checkExists(n.icon)&&n.icon!=""&&(q+=" icon "+n.icon),checkExists(n.cellclass)&&n.cellclass!=""&&(q+=" "+n.cellclass),checkExists(this.columns[t].datatype)&&this.columns[t].datatype=="number"&&(q+=" numeric"),checkExists(this.columns[t].control)&&this.columns[t].control!=""&&(q+=" checkradio-cell"),checkExists(n.display)&&n.display!="")if(typeof n.display=="string"){var s=this.escapeSpecialChar(n.display);q+='"><div class="grid-content-cell-wrapper" title="'+s+'">'}else q+='"><div class="grid-content-cell-wrapper" title="'+n.display+'">';else q+='"><div class="grid-content-cell-wrapper">';if(checkExists(n.html)&&n.html!="")q+=n.html;else if(checkExists(this.columns[t].control)&&(this.columns[t].control=="checkbox"||this.columns[t].control=="radiobutton"))switch(this.columns[t].control){case"checkbox":q+=SCCheckbox.html({checked:this.columns[t].datatype=="boolean"&&n.value});break;case"radiobutton":q+=SCRadiobutton.html({})}else q+=checkExists(n.display)&&n.display!=""?n.display:n.value;q+="<\/div><\/div><\/td>"}r.html(q);r.find("input.input-control[type=checkbox]").checkbox();r.find("input.input-control[type=radio]").radiobutton();r.find(".input-control.text-input").textbox();r.find("select.input-control").dropdown();var f=arguments[1];(f===undefined||f===!0)&&this._syncWidths(!1)},_editorTemplateExists:function(t){return n(this.element.children(".grid-edit-templates").eq(0).find("table:not(.control-table) tbody tr:not(.control-table-row)")[0].children[t]).find(".grid-content-cell-wrapper").html().trim().length>0},edit:function(n){var t=this.fetch("edit-template-row");if(t.hasClass("edit-template-row")||t.addClass("edit-template-row"),t.length>0){this.rows=this.contenttabletbody.children("tr:not(.empty-grid):not(.action-row)");for(var r=isNaN(parseInt(n))?null:this.rows.eq(n),f=t.children("td"),u=0,e=this.columns.length;u<e;u++)this.columns[u].hidden&&f.eq(u).css("display","none");r!=null&&r.length>0?(r.addClass("edit-row"),r.after(t),this.hide("row",n)):this.contenttabletbody.children("tr.empty-grid").length>0?this.contenttabletbody.empty().append(t):this.contenttabletbody.children("tr.action-row").length>0?t.insertBefore(this.contenttabletbody.children("tr.action-row")):this.contenttabletbody.append(t);checkExists(SourceCode.Forms.Controls.Textbox)&&t.find(".input-control.text-input").textbox();checkExists(SourceCode.Forms.Controls.Checkbox)&&t.find("input[type=checkbox]").checkbox();checkExists(SourceCode.Forms.Controls.Radiobutton)&&t.find("input[type=radio]").radiobutton();checkExists(SourceCode.Forms.Controls.DropDown)&&t.find("select").each(function(n,t){var q=jQuery(t);q.is(".list-display")||q.dropdown()});var q=t.find("a,input,textarea").first();q!=null&&q.length==1&&!q.prop("disabled")&&q.is(":visible")&&q[0].focus();this._syncWidths();this.contenttabletbody.children("tr.empty-grid").length>0&&this.contenttabletbody.children("tr.empty-grid").remove();this._trigger("rowedit",null,{row:n,template:t})}},commit:function(){var n=this.contenttabletbody.children("tr.edit-template-row"),t;n.prev().hasClass("edit-row")&&(t=n.prev().css("display","").removeClass("edit-row"));this.element.children(".grid-edit-templates").eq(0).find("table tbody").append(n);this.contenttabletbody.children("tr").length!=0||this.actionrow||this.contenttabletbody.html('<tr class="empty-grid"><td class="empty-grid"'+(this.columns.length>0?' colspan="'+this.columns.length+'"':"")+'><div class="grid-content-cell"><div class="grid-content-cell-wrapper">'+this.resources.emptygrid+"<\/div><\/div><\/td><\/tr>");this._syncWidths();this._trigger("rowcommit",null,{row:t,template:n})},update:function(){var q=arguments[0];switch(q){case"row":this._updateRow(arguments[1],arguments[2],arguments[3]);break;case"aggregation":this._updateAggregation(arguments[1],arguments[2],arguments[3]);break;case"column":if(arguments.length==3){var t=typeof arguments[1]=="string"?this._getColumnIndex(arguments[1]):arguments[1];if(t>-1){this.columns[t]=n.extend({},this.columns[t],arguments[2]);var r=this.contenttable.children("colgroup").replaceWith(this._generateColGroupHTML({columns:this.columns}));this._syncWidths()}}}}};(typeof SCGrid2=="undefined"||SCGrid2===null)&&(SCGrid2=SourceCode.Forms.Controls.Grid2);n.widget("ui.grid2",SourceCode.Forms.Controls.Grid2);SCGrid2Defaults={getter:"fetch",options:{dragcolumns:!1,multiline:!0,multiselect:!1,disablemodulus:!1,paging:!1,method:"POST",datatype:"xml",autopopulate:!0,actionrow:!1,sorting:!0,zebraStripes:!0,height:"",resources:{}}};n.extend(n.ui.grid2.prototype,SCGrid2Defaults)}(jQuery);
