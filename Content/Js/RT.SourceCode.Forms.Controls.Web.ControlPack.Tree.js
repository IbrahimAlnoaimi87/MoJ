/*!
 SourceCode.Forms.Controls.Web.ControlPack.Common.ControlPackUtils.js (Embedded resource)
*/
(typeof SourceCode=="undefined"||SourceCode===null)&&(SourceCode={});(typeof SourceCode.Forms=="undefined"||SourceCode.Forms===null)&&(SourceCode.Forms={});(typeof SourceCode.Forms.Controls=="undefined"||SourceCode.Forms.Controls===null)&&(SourceCode.Forms.Controls={});(typeof SourceCode.Forms.Controls.Web=="undefined"||SourceCode.Forms.Controls.Web===null)&&(SourceCode.Forms.Controls.Web={});(typeof SourceCode.Forms.Controls.Web.ControlPack=="undefined"||SourceCode.Forms.Controls.Web.ControlPack===null)&&(SourceCode.Forms.Controls.Web.ControlPack={});(typeof SourceCode.ControlPack=="undefined"||SourceCode.ControlPack===null)&&(SourceCode.ControlPack={});SourceCode.Forms.Controls.Web.ControlPack.NamespaceValue=function(n,t){this.namespace=n;this.value=t};SourceCode.Forms.Controls.Web.ControlPack.NamespaceValue.prototype={namespace:null,value:null,equals:function(n){return this.fullname()===n},fullname:function(){return"{0}.{1}".format(this.namespace,this.value)}};var ControlPackUtils;SourceCode.Forms.Controls.Web.ControlPack.Utils=ControlPackUtils={MSAjaxReady:function(n){$(document).ready(function(){typeof addRuntimePendingCalls!="undefined"&&addRuntimePendingCalls(n)})},EvaluateClauses:function(n,t){var u={};if(checkExists(t)&&t.length>0){u=$.extend(!0,{},t[0]);for(var q=u,r=0;r<t.length;r++)q.LeftOperator=t[r].LeftOperator,typeof q.LeftOperator=="object"&&(q.LeftOperator=n[q.LeftOperator.PropertyName]),q.RightOperator=t[r].RightOperator,typeof q.RightOperator=="object"&&(q.RightOperator=n[q.RightOperator.PropertyName]),q.Operand=t[r].Operand,q.LogicalOperator=t[r].LogicalOperator,q.Index=r,r<t.length-1&&(q.nextClause=$.extend(!0,[],t[r+1])),q=q.nextClause}return this.EvaluateClausesHelper(u)},EvaluateClausesHelper:function(n){if(!checkExists(n))return!0;var t=!0;try{switch(n.Operand.toUpperCase()){case"EQUALS":t=n.LeftOperator===n.RightOperator;break;case"NOTEQUALS":t=n.LeftOperator!==n.RightOperator;break;case"GREATERTHAN":t=n.LeftOperator>n.RightOperator;break;case"LESSTHAN":t=n.LeftOperator<n.RightOperator;break;case"GREATERTHANOREQUALS":t=n.LeftOperator>=n.RightOperator;break;case"LESSTHANOREQUALS":t=n.LeftOperator<=n.RightOperator;break;default:t=n.LeftOperator===n.RightOperator}}catch(q){popupManager.showError("Operand not recognized - "+n.Operand+", clause position "+(n.Index+1))}try{switch(n.LogicalOperator.toUpperCase()){case"AND":t=t&&this.EvaluateClausesHelper(n.nextClause);break;case"OR":t=t||this.EvaluateClausesHelper(n.nextClause);break;case"GROUPED":t=this.EvaluateClausesHelper(n.nextClause);break;case"NONE":t=t;break;default:t=t}}catch(q){popupManager.showError("Logical Operator not recognized - "+n.LogicalOperator+", clause position "+(n.Index+1))}return t},GetStylePreviewControl:function(){return SourceCode.Forms.Designers[SourceCode.Forms.Designers.Common.getDefinitionNode().tagName].Styles._getSelectedControl()},SetRulesMethodForOnSet:function(n){EventUtil.manageControlEvent(n);var t=n.designerDefinition.documentElement.selectSingleNode("Views/View"),r=t.selectSingleNode("//Controls/Control[@ID='"+n.controlId+"']/Properties/Property[Name = 'DisplayField']/Value"),q;r&&(q=r.text);var o=n.designer._GetViewName(),s=n.designer._GetViewID(),u=n.designer._GetViewDisplayName(),h=n.designer.getControlDisplayName({viewDefinition:n.designerDefinition,controlId:n.controlId}),f={Events:[{SourceType:"Control",SourceID:n.controlId,SourceDisplayName:{_ignoreChanges:!0,_valueToSet:u},SourceName:{_ignoreChanges:!0,_valueToSet:o},Type:"System",Name:"OnSet",Handlers:[{Actions:[{ExecutionType:"Asynchronous",Type:"Transfer",ControlID:{value:n.controlId,displayValue:h},ViewID:{_alwaysReplace:!0,_valueToSet:{value:s,displayValue:u}},Parameters:[{SourceType:"ViewField",SourceID:q,TargetType:"ControlProperty",TargetID:"InitialDisplayValue"}]}]}]}]},e=!1;switch(n.eventType.toLowerCase()){case"remove":case"changecontrol":e=!0}checkExists(q)&&!e?EventUtil.ensureEventingPattern(t,f,{replaceExisting:!0}):EventUtil.removeEventingPattern(t,f,{removeMatched:!0})},UnitHelper:function(n,t,q,r){return t=typeof t!="undefined"?t:"100%",q=typeof q!="undefined"?q:!0,r=typeof r!="undefined"?r:"3276[0-7]|327[0-5][0-9]|32[0-6][0-9]{2}|3[0-1][0-9]{3}|[1-2][0-9]{4}|[1-9][0-9]{0,3}|[0-9]",typeof n=="undefined"||!1||n.Length===0?t:/(100|[0-9]{1,2})+%$/.test(n)?q?n:t:new RegExp("^({0})px$".format(r),"i").test(n)?n:new RegExp("^({0})$".format(r)).test(n)?n+"px":t},Utf8:{encode:function(n){n=n.replace(/\r\n/g,"\n");for(var q="",r=0;r<n.length;r++){var t=n.charCodeAt(r);t<128?q+=String.fromCharCode(t):t>127&&t<2048?(q+=String.fromCharCode(t>>6|192),q+=String.fromCharCode(t&63|128)):(q+=String.fromCharCode(t>>12|224),q+=String.fromCharCode(t>>6&63|128),q+=String.fromCharCode(t&63|128))}return q},decode:function(n){for(var r="",t=0,q=0,u=0;t<n.length;)q=n.charCodeAt(t),q<128?(r+=String.fromCharCode(q),t++):q>191&&q<224?(u=n.charCodeAt(t+1),r+=String.fromCharCode((q&31)<<6|u&63),t+=2):(u=n.charCodeAt(t+1),c3=n.charCodeAt(t+2),r+=String.fromCharCode((q&15)<<12|(u&63)<<6|c3&63),t+=3);return r}},Base64:{_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(n){var f="",e,t,q,s,h,o,r,u=0;for(n=ControlPackUtils.Utf8.encode(n);u<n.length;)e=n.charCodeAt(u++),t=n.charCodeAt(u++),q=n.charCodeAt(u++),s=e>>2,h=(e&3)<<4|t>>4,o=(t&15)<<2|q>>6,r=q&63,isNaN(t)===!0?o=r=64:isNaN(q)===!0&&(r=64),f=f+ControlPackUtils.Base64._keyStr.charAt(s)+ControlPackUtils.Base64._keyStr.charAt(h)+ControlPackUtils.Base64._keyStr.charAt(o)+ControlPackUtils.Base64._keyStr.charAt(r);return f},decode:function(n){var t="",e,o,s,h,u,r,f,q=0;for(n=n.replace(/[^A-Za-z0-9\+\/\=]/g,"");q<n.length;)h=ControlPackUtils.Base64._keyStr.indexOf(n.charAt(q++)),u=ControlPackUtils.Base64._keyStr.indexOf(n.charAt(q++)),r=ControlPackUtils.Base64._keyStr.indexOf(n.charAt(q++)),f=ControlPackUtils.Base64._keyStr.indexOf(n.charAt(q++)),e=h<<2|u>>4,o=(u&15)<<4|r>>2,s=(r&3)<<6|f,t=t+String.fromCharCode(e),r!=64&&(t=t+String.fromCharCode(o)),f!=64&&(t=t+String.fromCharCode(s));return ControlPackUtils.Utf8.decode(t)}},ConvertDisplayTemplateObjectsToXml:function(n){for(var r=parseXML("<Template/>"),u=0;u<n.length;++u){var t=r.createElement("Item"),q=n[u];q.type==="value"?q.text!==""&&(t.setAttribute("SourceType","Value"),t.appendChild(r.createElement("SourceValue")).appendChild(r.createTextNode(q.data))):(t.setAttribute("SourceType",q.data.SourceType),t.setAttribute("SourceID",q.data.SourceID),t.setAttribute("DataType",q.data.DataType));r.documentElement.appendChild(t)}return r.xml},LoadDisplayTemplateIntoTokenboxArray:function(n,t){var q;try{q=parseXML(t)}catch(e){}if(!!q&&!!q.documentElement&&!q.getElementsByTagName("parsererror").length){var r=q.selectNodes("Template/Item");if(r!==null)for(var u=0;u<r.length;u++){var f=n.selectSingleNode("Items/Item[@ItemType='ObjectProperty'][Name[text()='{0}']]/DisplayName".format(r[u].getAttribute("SourceID")));f!==null&&r[u].setAttribute("DisplayValue",f.text)}return transformXmlToTokenboxArray(q)}},SaveXmlValueToControlProperties:function(n,t,q,r){var u=q(n,r);if(u)var f=u.valueText,e=u.displayText},GetXmlValue:function(n,t){var q=n.selectSingleNode(t);return checkExists(q)?q.text:null},TransformXmlToTokenboxArray:function(n){for(var r=[],e=n.documentElement.selectNodes("Item"),u=0;u<e.length;++u){var t=e[u];if(t.getAttribute("SourceType")==="Value"){var q=t.selectSingleNode("SourceValue").text;q==="&nbsp;"&&(q=" ");r.push({type:"value",data:q,text:q})}else{var c=t.getAttribute("SourceType"),f=t.getAttribute("SourceID"),o=t.getAttribute("DataType"),s=t.getAttribute("DisplayValue"),h=f;checkExistsNotEmpty(s)&&(h=s);var l={SourceType:c,SourceID:f,DataType:o,icon:o.toLowerCase()},a=jQuery(jQuery("#propertyConfig_IsCompositeCheckBox").is(":checked")?"#propertyConfig_CompositeSOTextBox":jQuery("#propertyConfig_WithoutDisplaySORadioButton").is(":checked")?"#propertyConfig_AssociationSOTextBox":"#propertyConfig_DisplaySOTextBox").val(),v={type:"context",data:l,text:h,tooltip:a+" - "+f};r.push(v)}}return r},ResolveDisplayTemplate:function(n,t,q){for(var f={text:"",html:""},e=0,h=n.length;e<h;){var r=n[e],u=SFCTemplateManager.getTemplate("DataField",SFCTemplateBehaviour.Generic,q);if(r.type==="context"){var o=t.selectSingleNode("fields/field[@name='{0}']".format(r.data.SourceID));o!==null&&(u.setToken("DataFieldName",ControlPackBase.escapeSpecialChar(r.data.SourceID)),u.setToken("DisplayText",ControlPackBase.escapeSpecialChar(o.text)),f.text+=ControlPackBase.escapeSpecialChar(o.text))}else if(r.type==="value"){var s=ControlPackBase.escapeSpecialChar(r.data);f.text+=s;u.setToken("DataFieldName","");u.setToken("DisplayText",ControlPackBase.escapeSpecialChar(s))}f.html+=u.content;e++}return f},TreeNodeFilterHelper:{xsltFile:null,treeXml:null,rulesWizardTree:null,treeContainerElement:null,setXSLTFile:function(n){this.xsltFile=n.data().ref},setTreeContainerElement:function(n){this.treeContainerElement=n},loadWorkflowTree:function(n){var o=$('                     <div class="processTree" class="scroll-wrapper">                         <ul class="tree collapsed-root">                             <li class="root">                                 <a href="javascript:void(0);">Root<\/a>                             <\/li>                         <\/ul>                     <\/div>                     <div id="formProcessDiv"><\/div>'),r=new XslTransform;r.importStylesheet(this.xsltFile);r.addParameter("WorkflowsResourceName","Workflows");for(var t=parseXML(r.transformToText(n)),u=[],f=t.selectNodes("/nodes/node/node"),q=0,e=f.length;q<e;q++)u.push(f[q]);var s=t.getElementsByTagName("node")[0];t.childNodes[0].removeChild(s);for(var q=0,e=u.length;q<e;q++)t.childNodes[0].appendChild(u[q]);this.rulesWizardTree=o.find(".tree").tree();var h=this.rulesWizardTree.tree("find","root");this.rulesWizardTree.tree("loadXML",t,h);this.treeContainerElement.empty().append(this.rulesWizardTree);var c=this.treeContainerElement.find(".root");c.removeClass("closed").addClass("open");this.treeXml=t;this.treeContainerElement.on("mouseup",function(n){var q=$(n.target);q.removeClass("hidden");for(var r=q.find(".hidden"),t=0,u=r.length;t<u;t++)$(r[t]).removeClass("hidden")})},filteredXML:function(n,t){for(var u=0,h=n.length;u<h;u++){var q=n[u].getAttribute("text"),s=q.length;if(q.toUpperCase().indexOf(t.toUpperCase())>-1){var f="",e=0;if(t!=null&&t!="")while(e<n[u].getAttribute("text").length){var r=q.toUpperCase().indexOf(t.toUpperCase());if(r>-1){var o=t.length,c=q.substring(r,r+o);r>0&&(f+=q.substring(0,r));f+="<div class='highlight'>"+c+"<\/div>";q=q.substring(r+o,s);e=r+o}else f+=q,e=s}else t!=null&&(f=q);n[u].setAttribute("text",decodeURI(f))}var l=n[u].selectNodes("node");this.filteredXML(l,t)}},filterOut:function(n){var s=$(n).val(),g=this.rulesWizardTree.tree().tree("find","root"),f=[],nt=$('                     <div class="processTree" class="scroll-wrapper">                         <ul class="tree collapsed-root">                             <li class="root">                                 <a href="javascript:;">Root<\/a>                             <\/li>                         <\/ul>                     <\/div>                     <div id="formProcessDiv"><\/div>');this.treeContainerElement.html("");var c=parseXML(this.treeXml.xml);this.rulesWizardTree=nt.find(".tree").tree();var g=this.rulesWizardTree.tree("find","root");if(this.filteredXML(c.selectNodes("/nodes/node"),s),this.rulesWizardTree.tree("loadXML",c,g),s.length===0){this.treeContainerElement.append(this.temp);this.rulesWizardTree=this.treeContainerElement.find(".tree").tree();var l=this.treeContainerElement.find(".root");l.removeClass("closed").addClass("open")}else{this.treeContainerElement.html("");this.treeContainerElement.append(this.rulesWizardTree);var l=this.treeContainerElement.find(".root");l.removeClass("closed").addClass("open");for(var a=this.rulesWizardTree.find("li"),t=0,o=a.length;t<o;t++){var u=$(a[t]);u.hasClass("root")||u.removeClass("selected open").addClass("closed")}for(var v=this.rulesWizardTree.find("a"),tt=s.toUpperCase(),t=0,o=v.length;t<o;t++){var u=$(v[t]);u.removeClass("selected open").addClass("closed");u.text().toUpperCase().indexOf(tt)!==-1?(f.push(u),u.addClass("match")):u.removeClass("match")}if(f.length>0){for(var t=0,o=f.length;t<o;t++){var y=$(f[t]);f.length===1&&y.parent().addClass("selected");var q=y;for(q=q.parent(),q.addClass("closed").removeClass("open");!q.hasClass("root");)q=q.parent(),q.addClass("open"),q.removeClass("closed")}for(var p=this.rulesWizardTree.find("li.workflows.closed, li.workflow.closed"),t=0,o=p.length;t<o;t++){var w=$(p[t]);w.find(".match").length===0&&w.addClass("hidden")}}else this.treeContainerElement.html(""),this.treeContainerElement.append("<span>{0}<\/span>".format(ControlResources.SourceCode.Forms.Controls.Web.ControlPack.Common.Properties.Resources.searchNoResult))}for(var b=this.treeContainerElement.find(".workflow, .workflows"),h=0,qt=b.length;h<qt;h++){$workflow=$(b[h]);for(var k=[],e=$workflow.find("li"),r=0,d=e.length;r<d;r++)k[r]=$(e[r]).data();$workflow.html($workflow.html().replace(/&lt;/g,"<").replace(/&gt;/g,">"));e=$workflow.find("li");for(var r=0,d=e.length;r<d;r++)$(e[r]).data(k[r])}}},cssTransitionsSupported:function(){for(var q=document.createElement("div"),t=["ms","O","Webkit","Moz"],n=0;n<t.length;n++)if(checkExists(q.style[t[n]+"Transition"]))return!0;return!1},MeasureControlHeight:function(n){var q=[],f=null,e=n.is(":visible");if(!e)for(var r=n.parents().addBack().filter(":hidden"),t=0;t<r.length;t++){var u=r[t];q.push({element:u,position:r[t].style.position,visibility:r[t].style.visibility,display:r[t].style.display});u.style.position="absolute";u.style.visibility="hidden";u.style.display="block"}if(f=n[0].offsetHeight,!e)for(var t=0;t<q.length;t++){var n=q[t].element;n.style.position=q[t].position;n.style.visibility=q[t].visibility;n.style.display=q[t].display}return f},MeasureControlWidth:function(n){var q=[],f=null,e=n.is(":visible");if(!e)for(var r=n.parents().addBack().filter(":hidden"),t=0;t<r.length;t++){var u=r[t];q.push({element:u,position:r[t].style.position,visibility:r[t].style.visibility,display:r[t].style.display});u.style.position="absolute";u.style.visibility="hidden";u.style.display="block"}if(f=n[0].offsetWidth,!e)for(var t=0;t<q.length;t++){var n=q[t].element;n.style.position=q[t].position;n.style.visibility=q[t].visibility;n.style.display=q[t].display}return f},SetClipboard:function(n){var r="sourcecode-k2-forms-custom-clipboard",q=document.getElementById(r);if(!checkExists(q)){var t=document.createElement("textarea");t.id=r;t.style.position="fixed";t.style.top=0;t.style.left=5e3;t.style.width="1px";t.style.height="1px";t.style.padding=0;t.style.border="none";t.style.outline="none";t.style.boxShadow="none";t.style.background="transparent";document.querySelector("body").appendChild(t);q=t}q.value=n;q.select();try{var u=document.execCommand("copy");!u}catch(f){}},SetSimpleScrollbar:function(n){if(n===null){console.info("Failed to instantiate custom scrollbar, element does not exist");return}let q=new SimpleBar(n,{scrollbarMinSize:42,autoHide:!1}),t=n.querySelector(".simplebar-vertical .simplebar-scrollbar");return t.classList.remove("simplebar-visible"),n.addEventListener("mouseover",function(){t.classList.add("simplebar-visible")}),n.addEventListener("mouseleave",function(){n.classList.contains("simplebar-dragging")||t.classList.remove("simplebar-visible")}),q}};
/*!
 SourceCode.Forms.Controls.Web.ControlPack.Scripts.TreeUtil.js (Embedded resource)
*/
ExceptionHelper={InvalidArgument:function(n,t){checkExistsNotEmpty(t)||(t="Cannot be undefined or null");throw Error("Invalid Argument {0}, {1}".format(n,t));},ValidateArgumentsExist:function(n,t){if(n.length!=t.length)throw Error("Arguments 'arguments' and 'argumentNames' must be same length");for(var q=0,r=n.length;q<r;q++)checkExists(n[q])||this.InvalidArgument(t[q])}};TreeUtil={startsWith:function(n,t){if(!checkExistsNotEmpty(n)||!checkExistsNotEmpty(t)||t.length>n.length)return!1;for(var q=0,r=t.length;q<r;q++)if(n[q]!=t[q])return!1;return!0},endsWith:function(n,t){if(!checkExistsNotEmpty(n)||!checkExistsNotEmpty(t)||t.length>n.length)return!1;if(n=n.toUpperCase(),t=t.toUpperCase(),t.length===1)return n[n.length-1]!=t?!1:!0;if(t.length>n.length)return!1;for(var u=n.length-t.length,q=0,r=u,f=t.length;q<f;r++,q++)if(n[r]!==t[q])return!1;return!0},encodeCSVPart:function(n){if(typeof n=="string"&&n.indexOf(",")>-1)for(var t=0,q=0;t>-1;){if(t=n.indexOf(",",q),t<0)break;n=n.insert(t,"|");q=t+2}return n},decodeCSVPart:function(n){for(var q="",t=0;t<n.length;t++)n[t]!=="|"&&(q+=n[t]);return q},removeNode:function(n){n!==null&&n.parentNode!==null&&n.parentNode.removeChild(n)},detectFormat:function(n,t){return n.indexOf(",")>0?"path":n.indexOf(t)>-1?"valuePath":"value"},createEvent:function(n,t,q,r,u){r.toLowerCase()=="view"?u=n.selectSingleNode("SourceCode.Forms/Views/View").getAttribute("ID"):r.toLowerCase()=="form"&&(u=n.selectSingleNode("SourceCode.Forms/Forms/Form").getAttribute("ID"));var f=n.createElement("Event");f.setAttribute("ID",(new String).generateGuid());f.setAttribute("DefinitionID",(new String).generateGuid());f.setAttribute("Type",q);f.setAttribute("SourceID",u);f.setAttribute("SourceType",r);var e=n.createElement("Name");return e.appendChild(n.createTextNode(t)),f.appendChild(e),f},addHandler:function(n,t,q){var u=t.selectSingleNode("Handlers");u==null&&(u=n.createElement("Handlers"),t.appendChild(u));var r=n.createElement("Handler");return r.setAttribute("ID",(new String).generateGuid()),r.setAttribute("DefinitionID",(new String).generateGuid()),checkExistsNotEmpty(q)&&r.setAttribute("Type",q),u.appendChild(r),r},addAction:function(n,t,q,r,u){var e=t.selectSingleNode("Actions");e==null&&(e=n.createElement("Actions"),t.appendChild(e));var f=n.createElement("Action"),o=null;return o=checkExistsNotEmpty(u)?u:(new String).generateGuid(),f.setAttribute("ID",o),f.setAttribute("DefinitionID",(new String).generateGuid()),f.setAttribute("Type",q),f.setAttribute("ExecutionType",r),e.appendChild(f),f},addParameter:function(n,t,q,r,u,f,e,o){var h=t.selectSingleNode("Parameters");h==null&&(h=n.createElement("Parameters"),t.appendChild(h));var s=n.createElement("Parameter");return s.setAttribute("SourceID",q),s.setAttribute("SourceType",r),s.setAttribute("SourcePath",u),s.setAttribute("TargetID",f),s.setAttribute("TargetType",e),o===undefined?s.setAttribute("IsRequired","False"):s.setAttribute("IsRequired",o?"True":"False"),h.appendChild(s),s},addResult:function(n,t,q,r,u,f,e,o){var h=t.selectSingleNode("Results");h==null&&(h=n.createElement("Results"),t.appendChild(h));var s=n.createElement("Result");if(s.setAttribute("SourceID",q),s.setAttribute("SourceType",r),s.setAttribute("TargetID",u),s.setAttribute("TargetType",f),e===undefined?s.setAttribute("IsRequired","False"):s.setAttribute("IsRequired",e?"True":"False"),checkExists(o)){var c=n.createElement("SourceValue");c.appendChild(n.createTextNode(o));s.appendChild(c)}return h.appendChild(s),s},addProperty:function(n,t,q,r){var u=t.selectSingleNode("Properties");u==null&&(u=n.createElement("Properties"),t.appendChild(u));var f=n.createElement("Property"),e=n.createElement("Name");e.appendChild(n.createTextNode(q));var o=n.createElement("Value");return o.appendChild(n.createTextNode(r)),f.appendChild(e),f.appendChild(o),u.appendChild(f),f},getProperty:function(n,t){return ExceptionHelper.ValidateArgumentsExist([n,t],["controlNode","name"]),n.selectSingleNode("Properties/Property[Name='{0}']".format(t))},updateProperty:function(n,t,q,r){var s=t.selectSingleNode("Properties");s==null&&(s=n.createElement("Properties"),t.appendChild(s));var u=t.selectSingleNode("Properties/Property[Name[text()='{0}']]".format(q)),o=null,f=null;if(u===null){u=n.createElement("Property");s.appendChild(u);var o=n.createElement("Name");o.appendChild(n.createTextNode(q));var f=n.createElement("Value");f.appendChild(n.createTextNode(r));var e=n.createElement("DisplayValue");e.appendChild(n.createTextNode(r));u.appendChild(o);u.appendChild(f);u.appendChild(e)}else o=u.selectSingleNode("Name"),o===null?(o=n.createElement("Name"),o.appendChild(n.createTextNode(q)),u.appendChild(o)):o.childNodes.length===1&&(o.removeChild(o.childNodes[0]),o.appendChild(n.createTextNode(q))),f=u.selectSingleNode("Value"),f===null?(f=n.createElement("Value"),f.appendChild(n.createTextNode(r)),u.appendChild(f)):f.childNodes.length===1?(f.removeChild(f.childNodes[0]),f.appendChild(n.createTextNode(r))):f.appendChild(n.createTextNode(r)),e=u.selectSingleNode("DisplayValue"),e===null?(e=n.createElement("DisplayValue"),e.appendChild(n.createTextNode(r)),u.appendChild(e)):e.childNodes.length===1?(e.removeChild(e.childNodes[0]),e.appendChild(n.createTextNode(r))):e.appendChild(n.createTextNode(r));return u},refreshPropertyGrid:function(n){var t=SourceCode.Forms.Designers.View.PropertyGrid,u=n.getAttribute("ID"),q=SourceCode.Forms.Designers.View.viewDefinitionXML;if(q!==null){var r=q.selectSingleNode("SourceCode.Forms/Views/View/Controls/Control[@ID='{0}']".format(u));r!==null&&(t.valuexml="<Controls>"+r.xml+"<\/Controls>",t.refresh())}}};
/*! @source http://purl.eligrey.com/github/classList.js/blob/master/classList.js */
"document"in self&&("classList"in document.createElement("_")&&(!document.createElementNS||"classList"in document.createElementNS("http://www.w3.org/2000/svg","g"))?function(){"use strict";var n=document.createElement("_");if(n.classList.add("c1","c2"),!n.classList.contains("c2")){var t=function(n){var t=DOMTokenList.prototype[n];DOMTokenList.prototype[n]=function(n){for(var r=arguments.length,q=0;q<r;q++)n=arguments[q],t.call(this,n)}};t("add");t("remove")}if(n.classList.toggle("c3",!1),n.classList.contains("c3")){var q=DOMTokenList.prototype.toggle;DOMTokenList.prototype.toggle=function(n,t){return 1 in arguments&&!this.contains(n)==!t?t:q.call(this,n)}}n=null}():function(n){"use strict";if("Element"in n){var f="classList",t="prototype",e=n.Element[t],r=Object,l=String[t].trim||function(){return this.replace(/^\s+|\s+$/g,"")},a=Array[t].indexOf||function(n){for(var t=0,q=this.length;t<q;t++)if(t in this&&this[t]===n)return t;return-1},o=function(n,t){this.name=n;this.code=DOMException[n];this.message=t},u=function(n,t){if(t==="")throw new o("SYNTAX_ERR","An invalid or illegal string was specified");if(/\s/.test(t))throw new o("INVALID_CHARACTER_ERR","String contains an invalid character");return a.call(n,t)},h=function(n){for(var q=l.call(n.getAttribute("class")||""),r=q?q.split(/\s+/):[],t=0,u=r.length;t<u;t++)this.push(r[t]);this._updateClassName=function(){n.setAttribute("class",this.toString())}},q=h[t]=[],c=function(){return new h(this)};if(o[t]=Error[t],q.item=function(n){return this[n]||null},q.contains=function(n){return n+="",u(this,n)!==-1},q.add=function(){var t=arguments,q=0,f=t.length,n,r=!1;do n=t[q]+"",u(this,n)===-1&&(this.push(n),r=!0);while(++q<f);r&&this._updateClassName()},q.remove=function(){var q=arguments,r=0,e=q.length,t,f=!1,n;do for(t=q[r]+"",n=u(this,t);n!==-1;)this.splice(n,1),f=!0,n=u(this,t);while(++r<e);f&&this._updateClassName()},q.toggle=function(n,t){n+="";var q=this.contains(n),r=q?t!==!0&&"remove":t!==!1&&"add";return r&&this[r](n),t===!0||t===!1?t:!q},q.toString=function(){return this.join(" ")},r.defineProperty){var s={get:c,enumerable:!0,configurable:!0};try{r.defineProperty(e,f,s)}catch(v){v.number===-2146823252&&(s.enumerable=!1,r.defineProperty(e,f,s))}}else r[t].__defineGetter__&&e.__defineGetter__(f,c)}}(self));
/*!
 SourceCode.Forms.Controls.Web.ControlPack.Scripts.Dependency.js (Embedded resource)
*/
(typeof SourceCode=="undefined"||SourceCode===null)&&(SourceCode={});(typeof SourceCode.ControlPack=="undefined"||SourceCode.ControlPack===null)&&(SourceCode.ControlPack={});var NamespaceValue=SourceCode.Forms.Controls.Web.ControlPack.NamespaceValue,REFTYPE_NAMESPACE="SourceCode.Forms.Controls.Web.ControlPack.Properties.ReferenceTypes";SourceCode.ControlPack.RefType={TreeSourceIdProperty:new NamespaceValue(REFTYPE_NAMESPACE,"TreeSourceIdProperty"),TreeSourceValueProperty:new NamespaceValue(REFTYPE_NAMESPACE,"TreeSourceValueProperty"),TreeSourceParentProperty:new NamespaceValue(REFTYPE_NAMESPACE,"TreeSourceIconProperty"),TreeSourceMethod:new NamespaceValue(REFTYPE_NAMESPACE,"TreeSourcetMethod")};var REFAS_NAMESPACE="SourceCode.Forms.Controls.Web.ControlPack.Properties.ReferenceAs";SourceCode.ControlPack.RefAs={TreeSource:new NamespaceValue(REFAS_NAMESPACE,"TreeSource"),TreeSourceParent:new NamespaceValue(REFAS_NAMESPACE,"TreeSourceParent"),TreeSourceIdProperty:new NamespaceValue(REFAS_NAMESPACE,"TreeSourceIdProperty"),TreeSourceValueProperty:new NamespaceValue(REFAS_NAMESPACE,"TreeSourceValueProperty"),TreeSourceParentProperty:new NamespaceValue(REFAS_NAMESPACE,"TreeSourceParentProperty"),TreeSourceMethod:new NamespaceValue(REFAS_NAMESPACE,"TreeSourceMethod"),TreeSourceIconProperty:new NamespaceValue(REFAS_NAMESPACE,"TreeSourceIconProperty"),TreeSourceDisplayTemplate:new NamespaceValue(REFAS_NAMESPACE,"TreeSourceDisplayTemplate"),TreeSourceDisplayTemplateItem:new NamespaceValue(REFAS_NAMESPACE,"TreeSourceDisplayTemplateItem"),TreeIconSourceId:new NamespaceValue(REFAS_NAMESPACE,"TreeIconSourceId"),TreeIconSource:new NamespaceValue(REFAS_NAMESPACE,"TreeIconSource"),TreeIconId:new NamespaceValue(REFAS_NAMESPACE,"TreeIconId"),TreeIconImage:new NamespaceValue(REFAS_NAMESPACE,"TreeIconImage"),TreeIconName:new NamespaceValue(REFAS_NAMESPACE,"TreeIconName"),TreeIconMethod:new NamespaceValue(REFAS_NAMESPACE,"TreeIconMethod")};var TreeDependencyHelper={hasValidationMessage:function(n){return ExceptionHelper.ValidateArgumentsExist(arguments,["obj"]),checkExists(n.validationMessages)&&n.validationMessages.length>0},checkStatus:function(n,t,q){ExceptionHelper.ValidateArgumentsExist(arguments,["validationMessages","referenceType","status"]);for(var e=new SourceCode.Forms.Services.AnalyzerResourcesService,u=e.parseValidationMessage(n.join(";")),r=0,o=u.length;r<o;r++){var f=u[r];if(f.type===t&&f.status===q)return!0}return!1},parseValidationMessagesFromStringArray:function(n){if(checkExists(n)&&n.length===0)return[];var t=new SourceCode.Forms.Services.AnalyzerResourcesService;return t.parseValidationMessage(n.join(";"))},setErrorOnField:function(n){var r=n.element,u=n.className,f=n.largeIcon,t=$(r).closest(".form-field");if(checkExists(t)){var q=t.find(".input-control.select-box");q.addClass("error-state {0}".format(u));f&&(t.addClass("error"),q.addClass("error"))}},clearErrorOnField:function(n){var t=$(n).closest(".form-field");if(checkExists(t)){var q=t.find(".input-control.select-box");t.removeClass("error type-unknown");q.removeClass("error error-state")}},checkIconBadge:function(n,t){for(var u=$.parseXML(n).documentElement,r=u.selectNodes("Control/Properties/Property[contains(@ValidationStatus,'Error') or contains(@ValidationStatus,'Missing') or contains(@ValidationStatus,'Warning')]"),f=r.length,q=0;q<f;q++){var e=r[q].selectSingleNode("Name").text,o=r[q].selectSingleNode("Value").text;if(e==="IconSource"&&o===t)return!0}return!1},convertDataTypeName:function(n){var t;switch(n.toUpperCase()){case"AUTONUMBER":t="auto-number";break;case"AUTOGUID":t="auto-guid";break;case"MULTIVALUE":t="multi-value";break;case"YESNO":t="yes-no";break;default:t=n.toLowerCase()}return t},validateSmartObject:function(n,t){if(checkExists(n)&&checkExists(t))for(var f=new SourceCode.Forms.Services.AnalyzerResourcesService,r=f.parseValidationMessage(t.join(";")),e=r.length,q=0;q<e;q++){var u=r[q];if(u.guid===n&&u.status==="Missing")return!1}return!0},validateSmartObjectMethod:function(n){if(checkExists(n)){var f=new SourceCode.Forms.Services.AnalyzerResourcesService,t=[];t=t.concat(n);for(var u=f.parseValidationMessage(t.join(";")),q=0;q<u.length;q++){var r=u[q];if(r.type===SourceCode.Forms.DependencyHelper.ReferenceType.ObjectMethod&&r.status===SourceCode.Forms.DependencyHelper.ReferenceStatus.Missing&&r.referenceAs===SourceCode.ControlPack.RefAs.TreeSourceMethod.fullname())return!1}}return!0},getSmartObjectDisplayName:function(n,t){if(checkExists(n)&&checkExists(t))for(var f=new SourceCode.Forms.Services.AnalyzerResourcesService,u=f.parseValidationMessage(t.join(";")),e=u.length,r=0;r<e;r++){var q=u[r];if(q.guid===n&&q.status==="Missing")return checkExistsNotEmpty(q.displayName)?q.displayName:SourceCode.Forms.DependencyHelper.getUnresolvedResourceText("object")}},getDataType:function(n,t){var e="SourceCode.Forms/Views/View/Sources/Source[@SourceID='{0}']/Fields".format(n),f=SourceCode.Forms.Designers.View.viewDefinitionXML.selectSingleNode(e),q;if(checkExists(f)){for(var u=f.childNodes,r=0,o=u.length;r<o;r++){var s=u[r].selectSingleNode("FieldName").text;if(s===t){q=this.convertDataTypeName(u[r].getAttribute("DataType"));break}}checkExists(q)||(q="type-unknown")}return q},getMappedSmartObjectId:function(n,t){for(var e=$.parseXML(n).documentElement,f=e.selectNodes("Control/Properties/Property[contains(@ValidationStatus,'Error') or contains(@ValidationStatus,'Missing') or contains(@ValidationStatus,'Warning')]"),r=0,o=f.length;r<o;r++)for(var u=JSON.parse(f[r].selectSingleNode("Value").text),q=0;q<u.length;q++)if(u[q].uid===t.parentSmartObject)return u[q].id;return null}};
/*!
 SourceCode.Forms.Controls.Web.ControlPack.Scripts.TreeRuleHelper.js (Embedded resource)
*/
(typeof SourceCode=="undefined"||SourceCode===null)&&(SourceCode={});(typeof SourceCode.Forms=="undefined"||SourceCode.Forms===null)&&(SourceCode.Forms={});(typeof SourceCode.Forms.Controls=="undefined"||SourceCode.Forms.Controls===null)&&(SourceCode.Forms.Controls={});(typeof SourceCode.Forms.Controls.Web=="undefined"||SourceCode.Forms.Controls.Web===null)&&(SourceCode.Forms.Controls.Web={});var SFCTreeRuleHelper;SourceCode.Forms.Controls.Web.TreeRuleHelper=SFCTreeRuleHelper={NONE:"(NONE)",NO_METHOD_INPUTS:"NO-METHOD-INPUTS",cleanValidateActions:function(n){for(var t=n.selectNodes("Handlers/Handler/Actions/Action[@Type='Validate']"),q=t.length;q--;){var r=t[q];r.parentNode.removeChild(r)}},getViewNode:function(){var n=SourceCode.Forms.Designers.View;return checkExists(n)&&checkExists(n.viewDefinitionXML)?n.viewDefinitionXML.documentElement.selectSingleNode("Views/View"):null},removeAnnotationsFromControl:function(n,t){if(t.referenceAs!=="")for(var s=SourceCode.Forms.Designers.View.viewDefinitionXML,f=s.documentElement.selectNodes("Views/View/Controls/Control[@ID='"+n+"']/Properties/Property[@ValidationMessages]"),e="",u=0;u<f.length;u++){e="";for(var o=new SourceCode.Forms.Services.AnalyzerResourcesService,r=o.parseValidationMessage(f[u].getAttribute("ValidationMessages")),q=0;q<r.length;q++)r[q].referenceAs===t.referenceAs&&r[q].name===t.name&&r[q].status===t.status?r.splice(q,1):(q!==0&&(e+=";"),e+=o.generateValidationMessage(r[q],r[q].referenceAs,r[q].status));r.length>0?f[u].setAttribute("ValidationMessages",e):(f[u].removeAttribute("ValidationMessages"),f[u].removeAttribute("ValidationStatus"))}},removeAllAnnotationsFromControl:function(n,t){for(var r=t.documentElement.selectNodes("/Controls/Control[@ID='"+n+"']/Properties/Property[@ValidationMessages][Name[not(text()='IconImage') and not(text()='IconId') and not(text()='IconSource') and not(text()='IconSourceId') and not(text()='IconMethod') and not(text()='IconName')]]"),u=t.documentElement.selectSingleNode("/Controls/Control[@ID='"+n+"']"),q=0;q<r.length;q++)r[q].removeAttribute("ValidationMessages"),r[q].removeAttribute("ValidationStatus");u.removeAttribute("ValidationMessages");u.removeAttribute("ValidationStatus")},ensureInitializeEvent:function(n,t){var q=this.getViewNode();if(q!==null){for(var r=q.ownerDocument,e=q.getAttribute("ID"),a=q.selectNodes("Events/Event[(@Type='User') and (@SourceID='{1}')][Name[text()='Init']]/Handlers/Handler/Actions/Action[@Type='Execute'][Properties/Property[Name[text()='ControlID'] and Value[text()='{0}']]]".format(n,e)),u=null,s=0,p=a.length;s<p;s++){var o=a[s];u===null&&(u=o.parentNode.parentNode);o.parentNode.removeChild(o)}u!==null&&u.selectNodes("Actions/Action").length===0&&u.parentNode.removeChild(u);var h=q.selectSingleNode("Controls/Control[@ID='{0}']".format(n)),w=h.selectSingleNode("Properties/Property[Name = 'Definition']/Value");if(w!==null){var r=q.ownerDocument,c=q.selectSingleNode("Events/Event[(@SourceType='View') and (@SourceID='{0}') and (@Type='User') and (Name/text()='Init')]".format(e));if(c!==null){var b="Property[Name[text()='ControlID'] and Value[text()='{0}']]".format(n),k="Handlers/Handler/Actions/Action/Properties/{0}/../{1}".format("Property[Name[text() = 'Method'] and Value[text() = 'Populate']]",b);if(o=c.selectSingleNode(k),o===null){var d=this.createAction(r,n,e),v=r.createElement("Actions");v.appendChild(d);var f=r.createElement("Handler");f.setAttribute("ID",(new String).generateGuid());f.setAttribute("DefinitionID",(new String).generateGuid());f.setAttribute("Type","If");TreeUtil.updateProperty(r,f,"Location","view");f.appendChild(v);var g=c.selectSingleNode("Handlers");g.appendChild(f);TreeUtil.updateProperty(r,h,"InitEventCreated","True")}}else{var y=t._GetViewName(),e=t._GetViewID(),l=t._GetViewDisplayName(),nt=t.getControlDisplayName({viewDefinition:SourceCode.Forms.Designers.View.viewDefinitionXML,controlId:n}),tt={Events:[{SourceType:"View",SourceID:q.getAttribute("ID"),SourceDisplayName:{_ignoreChanges:!0,_valueToSet:l},SourceName:{_ignoreChanges:!0,_valueToSet:y},Type:"User",Name:"Init",Properties:{ViewID:{_alwaysReplace:!0,_valueToSet:{value:e,displayValue:l}},RuleName:"When the View executed Initialize",Location:{_alwaysReplace:!0,_valueToSet:y}},Handlers:[{Properties:{Location:"View"},Actions:[{Type:"ExecuteControl",ExecutionType:"Synchronous",Properties:{Location:"View",ControlID:{value:n,displayValue:nt},Method:"Populate",ViewID:{_alwaysReplace:!0,_valueToSet:{value:e,displayValue:l}}}}]}]}]};EventUtil.ensureEventingPattern(q,tt,{replaceExisting:!0});TreeUtil.updateProperty(r,h,"InitEventCreated","True")}}}},ensureLevelLoadingEvent:function(n,t){var r=this.getViewNode();if(r!==null&&t.length>0){var u=r.ownerDocument,v=r.selectSingleNode("Name").text,y=r.selectSingleNode("Controls/Control[@ID='{0}']".format(n)),p=y.selectSingleNode("Name").text,w="Events/Event[Name='Populating' and @Type='System'][Handlers/Handler/Actions/Action[Properties/Property[Name='ControlID' and Value='{0}']]]".format(n),q=r.selectSingleNode(w);if(q===null)q=TreeUtil.createEvent(u,"Populating","System","Control",n),TreeUtil.addProperty(u,q,"ViewID",r.getAttribute("ID")),TreeUtil.addProperty(u,q,"RuleName","When {0} is Populating".format(p)),TreeUtil.addProperty(u,q,"Location",v),r.selectSingleNode("Events").appendChild(q);else{var s=q.selectSingleNode("Handlers");s!==null&&s.parentNode.removeChild(s)}for(var f=0;f<t.length;f++){var o=t[f];if(checkExists(o.actionNodeXml)){var b=this.createActionHandler(u,q,n,f),l=u.createElement("Actions");b.appendChild(l);for(var h=parseXML(o.actionNodeXml).documentElement,c=h.selectNodes("DesignProperties"),e=0,a=c.length;e<a;e++)c[e].parentNode.removeChild(c[e]),e--,a--;TreeUtil.updateProperty(u,h,"ObjectID",o.id);l.appendChild(h)}else this.createLoadLevelActionPattern(n,u,r,q,o,f)}return q}return null},setParentFilter:function(n,t,q,r){if(!checkExistsNotEmpty(n)||!checkExists(t))throw new Error("Invalid arguments");if(checkExists(t.actionNodeXml)){for(var u=parseXML(t.actionNodeXml).childNodes[0],e=u.selectNodes("Parameters/Parameter"),f=0;f<e.length;f++){var o=e[f];o.parentNode.removeChild(o)}checkExists(r)&&r!==!1||TreeUtil.addParameter(u.ownerDocument,u,"ParentValue","ControlProperty",n,q,"ObjectProperty");t.actionNodeXml=u.xml}},removeParentFilter:function(n,t){if(!checkExistsNotEmpty(n)||!checkExists(t))throw new Error("Invalid arguments");if(checkExists(t.actionNodeXml)){for(var r=parseXML(t.actionNodeXml).childNodes[0],u=r.selectNodes("Parameters/Parameter"),q=0;q<u.length;q++){var f=u[q];f.parentNode.removeChild(f)}t.actionNodeXml=r.xml}},createAction:function(n,t,q){return actionNode=n.createElement("Action"),actionNode.setAttribute("ID","".generateGuid()),actionNode.setAttribute("DefinitionID","".generateGuid()),actionNode.setAttribute("Type","ExecuteControl"),actionNode.setAttribute("ExecutionType","Asynchronous"),TreeUtil.updateProperty(n,actionNode,"Location","View"),TreeUtil.updateProperty(n,actionNode,"ControlID",t),TreeUtil.updateProperty(n,actionNode,"Method","Populate"),TreeUtil.updateProperty(n,actionNode,"ViewID",q),actionNode},createActionHandler:function(n,t,q,r){var u=TreeUtil.addHandler(n,t,"If");TreeUtil.addProperty(n,u,"Location","View");var f=n.createElement("Conditions");return f.appendChild(this.createCondition(n,q,r,!1)),u.appendChild(f),u},createLoadLevelActionPattern:function(n,t,q,r,u,f){if(checkExists(u.method)){var s=this.createActionHandler(t,r,n,f),e=TreeUtil.addAction(t,s,"Execute","Asynchronous","".generateGuid());TreeUtil.addProperty(t,e,"Location","View");TreeUtil.addProperty(t,e,"ControlID",n);TreeUtil.addProperty(t,e,"Method",u.method);TreeUtil.addProperty(t,e,"ViewID",q.getAttribute("ID"));TreeUtil.addProperty(t,e,"ObjectID",u.id);TreeUtil.addResult(t,e,u.id,"Result",n,"Control");var o=u.parentProperty;(u.recursive||checkExistsNotEmpty(o)&&u.parentSmartObject!==SFCTreeRuleHelper.NONE&&u.parentSmartObject!==SFCTreeRuleHelper.NO_METHOD_INPUTS)&&TreeUtil.addParameter(t,e,"ParentValue","ControlProperty",n,o,"ObjectProperty")}},createCondition:function(n,t,q,r){var u=n.createElement("Condition");u.setAttribute("ID","".generateGuid());u.setAttribute("DefinitionID","".generateGuid());TreeUtil.addProperty(n,u,"Location","View");TreeUtil.addProperty(n,u,"Name","AdvancedCondition");var h=n.createElement("Expressions"),o=n.createElement("Equals");if(r===!0){var c=n.createElement("And");c.appendChild(o);var a=n.createElement("IsBlank"),f=n.createElement("Item");f.setAttribute("SourceType","ControlProperty");f.setAttribute("SourceID","ParentId");f.setAttribute("SourcePath",t);f.setAttribute("DataType","text");a.appendChild(f);c.appendChild(a);h.appendChild(c)}else h.appendChild(o);var e=n.createElement("Item");e.setAttribute("SourceType","ControlProperty");e.setAttribute("SourceID","LoadLevel");e.setAttribute("SourcePath",t);e.setAttribute("DataType","text");var s=n.createElement("Item");s.setAttribute("SourceType","Value");s.setAttribute("DataType","text");var l=n.createElement("SourceValue");return l.setAttribute("xml:space","preserve"),l.appendChild(n.createTextNode(q)),s.appendChild(l),o.appendChild(e),o.appendChild(s),u.appendChild(h),u},setSourceActionXml:function(n,t){var q=SourceCode.Forms.Designers.View;if(checkExists(q)&&checkExists(q.viewDefinitionXML)){var c=q.viewDefinitionXML.documentElement.selectSingleNode("Views/View"),r=SFTreeRulePopup.getLoadEvent(c,t);if(r!==null){SFCTreeRuleHelper.cleanValidateActions(r);for(var f=r.selectNodes("Handlers/Handler"),u=0,l=f.length;u<l;u++){var e=f[u],o=e.selectNodes("Conditions/Condition");if(o.length===1){var s=e.selectNodes("Actions/Action");if(s.length===1){var h=o[0].selectSingleNode("Expressions/Equals/Item[@SourceType='Value']/SourceValue");if(h!==null)var a=parseInt(h.text),v=n[a].actionNodeXml=s[0].xml}}}}}}};
/*!
 SourceCode.Forms.Controls.Web.ControlPack.Scripts.TreeNodes.js (Embedded resource)
*/
(typeof SourceCode=="undefined"||SourceCode===null)&&(SourceCode={});(typeof SourceCode.Forms=="undefined"||SourceCode.Forms===null)&&(SourceCode.Forms={});(typeof SourceCode.Forms.Controls=="undefined"||SourceCode.Forms.Controls===null)&&(SourceCode.Forms.Controls={});(typeof SourceCode.Forms.Controls.Web=="undefined"||SourceCode.Forms.Controls.Web===null)&&(SourceCode.Forms.Controls.Web={});SourceCode.Forms.Controls.Web.TreeViewPart_Nodes=function(){};SourceCode.Forms.Controls.Web.TreeViewPart_Nodes.prototype={tree:null,firstNode:!0,checkingNode:!1,selectingNode:!1,rootNodeContainer:null,checkboxSvgTemplate:null,initialize:function(n){if(this.tree=n,this.firstNode=!0,this.Population=this.tree.Population,this.Methods=this.tree.Methods,this.rootNodeContainer=this.tree.element[0].querySelector(".node-container.first.root"),this.tree.options.selectionType!==TreeSelectionType.Single){const n=$(".style-aware-checkbox-svg > svg, .input-control.checkbox > svg");this.checkboxSvgTemplate=n.length>0?n[0].outerHTML:"<!-- Missing Template -->"}},inContentClickableArea:function(n){if(!checkExists(n)||jQuery.prototype.isPrototypeOf(n))throw new Error("Must be an HTMLElement");for(var t=n;checkExists(t)&&t.nodeType!==t.DOCUMENT_NODE;){if(t.classList.contains("PART-header-clickable-area"))return!0;if(t.classList.contains("content")||t.classList.contains("node")||t.classList.contains("tree-body"))return!1;t=t.parentNode}return!1},isCheckBox:function(n){return(n[0].tagName==="SPAN"||n[0].tagName==="INPUT")&&n.parent()[0].tagName==="LABEL"},getTextPath:function(n){if(!checkExists(n)||n.length===0)return"";var q=[];q.push(this.getText(n));for(var t=this.getParentNode(n);t!==null;)q.splice(0,0,this.getText(t)),t=this.getParentNode(t);return q.join("/")},createHighlighText:function(n,t){var h=n.toUpperCase();t=t.toUpperCase();for(var r=[],c=0,q=0,l=h.length;q<l;q++){var s=h.indexOf(t,c);if(s>-1)r.push(s),c=s+1;else break}if(r.length==0)return null;for(var u=[],q=0,l=r.length;q<l;q++){var o=r[q],f=o+t.length-1;q==0&&o>0&&u.push(n.substring(0,o).htmlEncode());for(var e=r[q+1];f===e;)f=e+t.length-1,q++,e=e[q+1];var a=n.substring(o,f+1),v="<span class='highlight'>{0}<\/span>".format(a.htmlEncode());if(u.push(v),q===r.length-1)u.push(n.substring(f+1).htmlEncode());else{var e=r[q+1];u.push(n.substring(f+1,e).htmlEncode())}}return u.join("")},createSearchNode:function(n,t,q){var f="",e="hidden",c=this.getData(n),l=n.querySelector(".image"),o=$(l).css("background-image").replace(/"/g,"'"),s=this._getImageBackgroundPosition(n,c.source.icon);f="background-image:{0}; background-position:{1}".format(o,s);e="";var a=this.getTextPath(n),r=this.tree.getTemplate("SearchItem");r.setToken("alternate",q===!0?"alternate":"");r.setToken("iconClass",e);r.setToken("iconStyle",f);r.setToken("text",t);r.setToken("nodePath",a);var u=jQuery(r.content);if(SourceCode.Forms.Browser.msie){var h=u.find(".search-item-icon")[0].style;h.backgroundImage=o;h.backgroundPosition=s}return jQuery.data(u[0],"tag",n),u[0]},matchText:function(n,t,q){var r=!1;return q===SearchBarOptions.Contains&&n.indexOf(t)>-1?r=!0:q===SearchBarOptions.BeginsWith?TreeUtil.startsWith(n,t)&&(r=!0):q===SearchBarOptions.EndsWith?TreeUtil.endsWith(n,t)&&(r=!0):q===SearchBarOptions.Equals?n===t&&(r=!0):q===SearchBarOptions.NotEquals&&n!==t&&(r=!0),r},filterNodes:function(n){n=n.toUpperCase();this.tree.element.find(".search-results .inner-body").empty();for(var e=this.tree.element.find("ul.node-container.root.first"),u=e.find("li"),o=this.tree.searchBar.getSearchOption(),t=document.createDocumentFragment(),f=!1,q=0,s=u.length;q<s;q++){var h=u[q];f=this.populateFilteredNodes(h,n,o,f,t)}var r=this.tree.element.find(".search-results .inner-body");if(t.childNodes.length>0)r[0].appendChild(t);else{var c="<div class='watermark'><span class='watermark'>{0}<\/span><\/div>".format(ControlResources.SourceCode.Forms.Controls.Web.ControlPack.Properties.Tree.Watermark);jQuery(r).append(c)}setTimeout(function(){r[0].classList.add("slide-in")},50)},populateFilteredNodes:function(n,t,q,r,u){var f=this.getText(n,!1).toUpperCase();if(this.matchText(f,t,q)){var e=q!==SearchBarOptions.NotEquals?this.createHighlighText(this.getText(n,!1),t):this.getText(n,!1);var o=this.createSearchNode(n,e,r);u.appendChild(o);r=!r}return r},createBatchNode:function(n){var f=this.tree.options.selectionType!==TreeSelectionType.Single,e=n.source.icon!=="none",t=null,q=SFCTemplateManager.getTemplate("TreeNode",SFCTemplateBehaviour.Default,this.tree);if(q.hasToken("header-text")){if(q.setToken("header-text",n.display),f){var o='<span class="checkbox-parent"><label class="input-control checkbox style-aware"><input class="input-control propertyGridPropertyEditCheckBox" type="checkbox" value="on" tabindex="-1" /><span class="input-control-img"><\/span>'+this.checkboxSvgTemplate+'<span class="input-control-text"><\/span><\/label><\/span>';q.setToken("PART-SF-CheckBox",o)}else q.setToken("PART-SF-CheckBox","");q.hasToken("if-icon-shown")&&(e?q.setToken("if-icon-shown","with-image"):q.setToken("if-icon-shown",""));q.hasToken("node-container")&&q.setToken("node-container","<div class='sfctreeview-node-container'><\/div>");var u=jQuery(q.content);t=u[0];var r=u.find("label").first();if(r.checkbox(),checkExists(SourceCode.Forms.Browser.mozilla)){var s=this;r.find("input").first().on("click",function(n){s.tree.isReadOnly()&&(!t.classList.contains("checked")&&r.hasClass("checked")&&r.removeClass("checked"),n.preventDefault())})}this.tree.showNodeDebug&&(t.querySelector("span.debug").innerHTML=n.path);t.setAttribute("data-level",n.level);t.setAttribute("data-source",n.source.name);this.isSelectable(n.source)&&t.classList.add("selectable");jQuery.data(t,"data",n);n.source.icon!=="none"&&this.applyImage(t,n.source.icon)}return t===null&&(t=jQuery(q.content)[0]),t},findHighestCheckedLevel:function(){for(var t=0,q=this.tree.element[0].querySelectorAll(".node.checked"),n=0;n<q.length;n++){var r=this.getData(q[n]);r.level>t&&(t=r.level)}},addNodes:function(n,t){var e=!1,q=null;if(n===null)q=this.rootNodeContainer;else{var q=n.querySelector("ul.node-container");if(q===null){var s=SFCTemplateManager.getTemplate("TreeNodeContainer",SFCTemplateBehaviour.Default,this.tree);q=jQuery(s.content)[0];n.appendChild(q);e=!0}}if(q!==null){for(var r=document.createDocumentFragment(),h=t.length,u=0;u<h;u++){var o=t[u];n!==null&&this.isChecked(n)&&this.setCheckState(o,!0);r.appendChild(o)}if(e)if(n===null){this.tree.element[0].querySelector(".tree-body").appendChild(q);this.tree.updateContainerHeights();var f=q.querySelector(".nodes");f.appendChild(r)}else{var f=q.querySelector(".nodes");f.appendChild(r)}else{var f=q.querySelector(".nodes");f.appendChild(r)}}},addNode:function(n,t){list.push(this.createBatchNode(t));this.addNodes(n,[])},createNode:function(n,t,q,r,u,f,e){var o=document.createElement("li");checkExists(e)||(e=!0);o.className=this.tree.options.expandOnLoad?"node":"node collapsed";q||(o.className+=" empty");f&&(o.className+=" selectable");e||(o.className+=" disabled");var s=document.createElement("div");s.className="content";var l=document.createElement("span");l.className="expander-container";s.appendChild(l);var y=document.createElement("span");if(l.appendChild(y),y.className="expander",r===!0){s.appendChild(this._createCheckBox());var w=jQuery(s).find("label.input-control.checkbox").checkbox();e||w.checkbox("disable")}var c=document.createElement("div");e&&(c.className="header");var h=document.createElement("span");h.setAttribute("title",n);h.innerHTML=n;h.className="text";u&&(h.className+=" read-only");t&&(h.className+=" with-image");var a=document.createElement("span");a.className="image-container";c.appendChild(a);var v=document.createElement("span");if(v.className="image",q||(v.className+=" empty"),a.appendChild(v),c.appendChild(h),this.tree.showNodeDebug){var p=document.createElement("span");p.className="debug";c.appendChild(p)}return s.appendChild(c),o.appendChild(s),o},_createCheckBox:function(){var r=document.createElement("span");r.setAttribute("class","checkbox-parent");var n=document.createElement("label");n.setAttribute("class","input-control checkbox style-aware");r.appendChild(n);var q=document.createElement("input");q.setAttribute("class","input-control propertyGridPropertyEditCheckBox");q.setAttribute("type","checkbox");q.setAttribute("value","on");n.appendChild(q);var u=document.createElement("span");if(u.setAttribute("class","input-control-img"),n.appendChild(u),!!this.checkboxSvgTemplate){var t=document.createElement("div");t.innerHTML=this.checkboxSvgTemplate;n.appendChild(t.firstChild.cloneNode(!0));!t.parentNode||t.parentNode.removeChild(t)}var f=document.createElement("span");return f.setAttribute("class","input-control-text"),n.appendChild(f),r},checkNode:function(n,t){if(checkExists(t)||(t={}),checkExists(t.expandNode)||(t.expandNode=!0),checkExists(t.setValue)||(t.setValue=!0),checkExists(t.checkChildren)||(t.checkChildren=!0),checkExists(t.updateParents)||(t.updateParents=!0),n=this.getNode(n),this.setCheckState(n,!0),n.classList.contains("populated")){for(var f=[],u=this.getChildNodes(n),q=0,s=u.length;q<s;q++)f.push(u[q]);for(var o=f.length;o>0;){var h=f.shift();o--;this.setCheckState(h,!0);u=this.getChildNodes(h);for(var q=0,s=u.length;q<s;q++)f.push(u[q]),o++}}if(checkExists(t.fromClick)&&t.fromClick&&!n.classList.contains("expanded")&&!this.getChildNodes(n).length>0){for(var a=this.getData(n),v=this,c=this.tree.options.definition,q=0;q<c.length;q++){var l=c[q];if(l.parentSmartObject===a.source.uid){var r=this.tree.Population.createRequest();r.node=n;r.context=this;r.preLoadNodes=!1;r.source=l;r.startLevel=checkExists(this.tree.options.startLevel)?this.tree.options.startLevel:-1;r.cancelled=!0;this.tree.Population.pushRequest(r)}}this.tree.Population.doPopulation()}for(var e=this.getParentNode(n);e!==null;)this.updateCheckBoxState(e),e=this.getParentNode(e);this.tree.options.lastFocusedNode=n;this.tree.options.selectionType===TreeSelectionType.Single?this.updateOptionsValuePath(n):this.updateOptionsValuePath()},uncheckNode:function(n,t){if(!this.tree.isReadOnly()){this.setCheckState(n,!1);for(var o=this.getHeader(n),u=n.querySelectorAll(".node"),r=0,e=u.length;r<e;r++)this.setCheckState(u[r],!1);for(var q=this.getParentNode(n);q!==null;)this.updateCheckBoxState(q),q=this.getParentNode(q);this.tree.options.lastFocusedNode=n;var f=!1;f=checkExists(t)&&t?!0:!1;f||this.updateOptionsValuePath()}},updateCheckBoxState:function(n){var t=this.getChildNodes(n);if(t.length>0){for(var q=0,r=0,u=0,e=t.length;u<e;){var f=this.getNode(t[u]),o=!1;f.querySelector("label.input-control.checkbox.indeterminate")!==null&&(o=!0,r++);this.isChecked(f)&&q++;u++}q===0&&r===0?this.setCheckState(n,!1):q===t.length?this.setCheckState(n,!0):(q!==t.length||r>0)&&this.setCheckState(n,null)}},ensureNodesArePreLoaded:function(n){for(var s=this.tree.options.preloadLevel,h=this.getData(n),c=h.level,e=this.getChildNodes(n),u=0,l=e.length,t=[];u<l;u++){var f=e[u];f.classList.contains("populated")||t.push(f);for(var o=0;o<s;o++)for(var q=this.getChildNodes(f),r=0,a=q.length;r<a;r++)q.length>0&&(q[r].classList.contains("populated")||t.push(q[r]))}t.length>0&&this.Population.populateNodes(t,{startLevel:c})},setSelectedNode:function(n){this.setCheckState(n,!0);n.classList.add("selectedVisible")},expandNode:function(n,t){var r=!1;if(!checkExists(t))throw new Error("argument 'fireEvent' must be either 'true' or 'false'");if((n.classList.contains("selectedVisible")||!this.Population.pathsPartialEquals(this.tree.options.path,this.getPath(n,"id")))&&(r=!0),this.tree.options.lastFocusedNode=n,n.classList.contains("populated")){if(this.changeExpandState(n,!1,t),this.tree.options.preloadLevel>0&&this.ensureNodesArePreLoaded(n),n.classList.contains("selectedVisible")){var q=this.getChildNodes(n);if(checkExists(q)&&q.length>0)for(var u=0;u<q.length;u++)this.setSelectedNode(q[u])}}else{var f=this.getData(n),e={context:this,startLevel:f.level,cancelSetPath:checkExists(r)&&r?!0:!1,callback:function(n){this.changeExpandState(n.node,!1,t)}};this.Population.populateNode(n,e)}},collapseNode:function(n,t){var q=!0;checkExists(t)&&t&&(q=!1);this.tree.options.lastFocusedNode=n;this.changeExpandState(n,!0,q)},changeExpandState:function(n,t,q){var r=this.getExpander(n),u=this.getImage(n),f=this.getNodeContainer(n);t===!0?(n.classList.add("collapsed"),n.classList.remove("expanded"),q&&raiseEvent(this.tree.element.attr("id"),"Control","Collapsed (node)")):(n.classList.remove("collapsed"),n.classList.add("expanded"),q&&raiseEvent(this.tree.element[0].getAttribute("ID"),"Control","Expanded (node)"))},expandFromNode:function(n){for(var t=this.getParentNode(n);t!==null;)this.changeExpandState(t,!1,!0),t=this.getParentNode(t)},clearSelection:function(){var t=this.tree;if(t.options.selectionType===TreeSelectionType.Single){var q=this.getSelectedNode();q!==null&&this.unselectNode(this.getNode(q))}else{for(var r=!1,u=t.element.find("li.node>div>span>label.checkbox.checked"),n=0,e=u.length;n<e;n++){r=!0;var f=this.getNode(u[n]);this.isChecked(f)&&this.uncheckNode(f,!0)}r&&this.clearOptionsValuePath()}this.tree.options.lastFocusedNode=null},selectNode:function(n,t){this.selectingNode=!0;var r=this.tree.options;if(n=this.getNode(n),q=this.getData(n),this.tree._shiftFocus(n),!n.classList.contains("selected")){var q=this.getData(n);this.isSelectable(q.source)&&(r.selectionType===TreeSelectionType.Single?(this.clearSelection(),(q.source.icon==="static"||q.source.icon==="dynamic"||q.source.icon==="conditional")&&this.applyIconState(n,TreeIconState.Selected),n.classList.add("selected"),t&&this.tree._setSelectedNodeToTop(n),r.lastFocusedNode=n,this.updateOptionsValuePath(n)):r.selectionType!==TreeSelectionType.Multiple||this.checkingNode||(this.isChecked(n)?this.uncheckNode(n):this.checkNode(n)));this.selectingNode=!1}},applyIconState:function(n,t){var q=this.getData(n);if(checkExists(q.imageData))for(var f=this.tree.iconData.ItemDetails,r=0,e=f.length;r<e;){var u=f[r];u.Name===q.imageData.Name&&(t===TreeIconState.Selected&&checkExists(q.imageData.Selected)&&this._applyImageToNode(n,u,TreeIconState.Selected),t===TreeIconState.Hover&&checkExists(q.imageData.Hover)&&this._applyImageToNode(n,u,TreeIconState.Hover));r++}},unselectNode:function(n,t){if((n=this.getNode(n),n.classList.contains("selected"))&&(nodeData=this.getData(n),this.isSelectable(nodeData.source))){n.classList.remove("selected");(nodeData.source.icon==="static"||nodeData.source.icon==="dynamic"||nodeData.source.icon==="conditional")&&this.applyImage(n,nodeData.source.icon);var q=!1;checkExists(t)&&t&&(q=!0);this.tree.options.selectionType!==TreeSelectionType.Single||q?this.isChecked(n)&&this.uncheckNode(n):this.clearOptionsValuePath()}},applyImage:function(n,t){var q=this._getImageDetailResult(n,t);checkExists(q)&&this._applyImageToNode(n,q)},_getImageDetailResult:function(n,t){if(checkExists(this.tree.iconData)&&!$.isEmptyObject(this.tree.iconData)&&this.tree.iconData.ItemDetails.length!=0){var r=this.getData(n),u=this.tree.iconData.ItemDetails,q=null;switch(t){case"static":var f=r.source.staticValue;q=this._matchImageDetailToValue(u,function(n){return n.Value==f});break;case"dynamic":var f=r.iconPropertyValue;q=this._matchImageDetailToValue(u,function(n){return n.ID==f});break;case"conditional":var e=this._evaluateIconCondition(n,r.source.conditionalIcon);q=this._matchImageDetailToValue(u,function(n){return n.Value==e})}return q}},_matchImageDetailToValue:function(n,t){for(var q=0;q<n.length;q++){var r=n[q];if(t(r))return r}},_applyImageToNode:function(n,t,q){var r=n.querySelector("span.image");if(r!==null){r.style.backgroundImage="url('{0}')".format(this.tree.iconData.FilePath);var u=t.X,f=t.Y;this.tree.isReadOnly()||(q===TreeIconState.Selected?(u=t.Selected.X,f=t.Selected.Y):q===TreeIconState.Hover&&(u=t.Hover.X,f=t.Hover.Y));r.style.backgroundPosition="{0}px -{1}px".format(u,f);r.parentNode.classList.add("show");var e=this.getData(n);e.imageData===undefined&&(e.imageData=t)}},_getImageBackgroundPosition:function(n,t){var q=this._getImageDetailResult(n,t);if(checkExists(q))return"{0}px -{1}px".format(q.X,q.Y)},_evaluateIconCondition:function(n,t){for(var f=this.getData(n),u=null,r=JSON.parse(t),q=0;q<r.length;q++)if(SourceCode.Forms.Controls.Web.ControlPack.Utils.EvaluateClauses(f.smartObjectRow,r[q].conditions)){u=r[q].staticValue;break}return u},getPathValue:function(n,t){var u=this.getParentNode(n),q=t.idValue,r=t.source.name;return"{0},{1}".format(q,r)},getPath:function(n,t){for(var q=n,r=[];q!==null;)r.push(q),q=this.getParentNode(q);var u="";r.reverse();for(var e=r.length,f=0;f<e;f++){var o=this.getData(r[f]);t==="value"?u+=o.value:t==="id"&&(u+=this.getPathValue(n,o));f<e-1&&(u+=this.tree.options.pathSeparator)}return u},clearOptionsValuePath:function(){var n=this.tree.options;n.previous.parentValue="";n.parentValue="";n.previous.loadLevel="";n.loadLevel="";n.previous.value=n.value;n.value="";n.previous.valuePath=n.valuePath;n.valuePath="";n.previous.path=n.path;n.path="";raiseEvent(this.tree.element.attr("id"),"Control","OnChange")},updateOptionsValuePath:function(n){var t=this.tree.options;if(checkExists(n)){var q=this.getData(n);t.previous.value=t.value;t.value=q.value;t.previous.path=t.path;t.path=q.path;t.previous.valuePath=t.valuePath;t.valuePath=q.valuePath;t.smartObject="{0}{1}".format(q.source.name,q.source.version);t.previous.id=t.id;t.id=q.idValue;t.previous.displayValue=t.displayValue;t.displayValue=q.display;raiseEvent(this.tree.element.attr("id"),"Control","OnChange")}else{var u=this.tree.element.find("li").find("label.checked");if(t.smartObject="",u.length===0){t.previous.value=t.value;t.value="";t.previous.path=t.path;t.path="";t.previous.valuePath=t.valuePath;t.valuePath="";t.previous.selectedItemID=t.selectedItemID;t.selectedItemID="";t.previous.id=t.id;t.id="";t.previous.displayValue=t.displayValue;t.displayValue="";raiseEvent(this.tree.element.attr("id"),"Control","OnChange");return}for(var f="",e="",o="",r=0,s=u.length;r<s;){var h=this.getNode(u[r]);if(h){var q=this.getData(h);this.isSelectable(q.source)&&(f+=q.value,e+=q.path,o+=q.valuePath,r<s-1&&(f+=t.delimiter,e+=t.delimiter,o+=t.delimiter))}r++}t.previous.value=t.value;t.value=f;t.previous.path=t.path;t.path=e;t.previous.valuePath=t.valuePath;t.valuePath=o;raiseEvent(this.tree.element.attr("id"),"Control","OnChange")}},getNode:function(n){if(n=$(n)[0],n.classList.contains("node"))return n;for(var t=n;t!=null;){if(t=t.parentNode,!checkExists(t.classList))return null;if(t.classList.contains("node"))return t;if(t.classList.contains("ul"))return null}return null},hasChildNodes:function(n){if(n===undefined)throw Error("argument 'node' cannot be null");if(n!==null){this.validateIsNode(n);var t=n.querySelector(".node-container>.nodes>.node");return t!==null?!0:!1}return this.tree.element[0].querySelector(".node-container>.nodes>.node")!==null},getParentNode:function(n){this.validateIsNode(n);for(var t=n.parentNode;t!==null;){if(DocumentFragment.prototype.isPrototypeOf(t))break;if(t.classList.contains("node"))return t;if(t.classList.contains(this.tree.CONTROL_CLASS))break;t=t.parentNode}return null},validateIsNode:function(n){if(n instanceof jQuery)throw Error("expected DOM element, received jQuery object");if(n.tagName!=="LI"&&!n.classList.contains("node"))throw Error("expected a node element");},getExpander:function(n){return this.validateIsNode(n),n.querySelector(".expander")},getImage:function(n){return this.validateIsNode(n),n.querySelector(".image")},getText:function(n,t){t==null&&(t=!0);this.validateIsNode(n);var q=n.querySelector(".text");return(q===null&&(q=n.querySelector(".textwith-image")),q!==null)?t===!1?q.text:q.innerHTML:""},getCheckBox:function(n){return this.validateIsNode(n),jQuery(n).find(".input-control.checkbox").first()},getChildNodes:function(n){return(n!==null&&this.validateIsNode(n,!0),n===null)?this.tree.element.find(".node-container.root.first>.nodes>.node"):jQuery(n).find(">.node-container>.nodes>.node")},clearChildren:function(n){if(n===null)this.element.querySelector(".tree-body");else{this.validateIsNode(n,!0);for(var t=0,r=n.childNodes.length;t<r;t++){var q=n.childNodes[t];if(q.tagName==="UL"){n.removeChild(q);break}}}},nodeIndex:function(){},getData:function(n){this.validateIsNode(n);n=jQuery(n);var t=jQuery.data(n[0],"data");return checkExists(t)?t:null},getNodeContainer:function(n){return this.validateIsNode(n),n.querySelector("ul.node-container")},getHeader:function(n){this.validateIsNode(n);var t=n.parentNode;return(t.tagName="DIV"&&t.classList.contains("node")&&n.classList.contains("header"))?n:n.querySelector(".header")},isSelected:function(n){this.validateIsNode(n);var t=this.getHeader(n);return t.classList.contains("selected")},getSelectedNode:function(){var n=this.tree.element[0].querySelector("li.node.selected");return n!=null?n:null},isCollapsed:function(n){return this.validateIsNode(n),n.offsetHeight<1},isNodeInView:function(n){this.validateIsNode(n);var t=this.tree.element[0].querySelector(".node-container.root"),q=t.scrollTop,r=t.offsetHeight;return n.offsetTop<=r-q},isNodeVisible:function(n){var n=this.getNode(n),t=this.getParentNode(n);if(t===null)return!0;while(t!==null){if(t.classList.contains("collapsed"))return!1;t=this.getParentNode(t)}return!0},isExpanded:function(n){return this.validateIsNode(n),!n.classList.contains("collapsed")},isLeaf:function(n){this.validateIsNode(n);var t=this.getData(n);return t.isLeaf},isChecked:function(n){return this.validateIsNode(n),n.classList.contains("checked")},setCheckState:function(n,t){var q=this.getCheckBox(n);t===null?(n.classList.remove("checked"),n.classList.remove("uncheck"),n.classList.add("indeterminate"),q.checkbox("indeterminate")):t?(n.classList.add("checked"),q.checkbox("check")):(n.classList.remove("checked"),q.checkbox("uncheck"))},isSelectable:function(n){return checkExists(n.selectable)?n.selectable:!0}};
/*!
 SourceCode.Forms.Controls.Web.ControlPack.Scripts.TreeViewMethods.js (Embedded resource)
*/
(typeof SourceCode=="undefined"||SourceCode===null)&&(SourceCode={});(typeof SourceCode.Forms=="undefined"||SourceCode.Forms===null)&&(SourceCode.Forms={});(typeof SourceCode.Forms.Controls=="undefined"||SourceCode.Forms.Controls===null)&&(SourceCode.Forms.Controls={});(typeof SourceCode.Forms.Controls.Web=="undefined"||SourceCode.Forms.Controls.Web===null)&&(SourceCode.Forms.Controls.Web={});SourceCode.Forms.Controls.Web.TreeViewPart_Methods=function(){};SourceCode.Forms.Controls.Web.TreeViewPart_Methods.prototype={tree:null,expandedNodes:null,initialize:function(n){this.tree=n;this.Nodes=this.tree.Nodes;this.Population=this.tree.Population},handleMethod:function(n){var t=n.methodName.toUpperCase();switch(t){case"POPULATE":this.Population.populateTree();break;case"EXPANDALL":this.expandAll();break;case"COLLAPSEALL":this.collapseAll();break;case"EXPANDNODE":this.expandNode(n);break;case"COLLAPSENODE":this.collapseNode(n);break;case"CLEARSELECTION":this.tree.Nodes.clearSelection();break;case"FINDNODE":this.find(n.methodParameters.text);break;case"REFRESHNODE":this.refreshNode(n.methodParameters.nodepath,n.methodParameters.expand);break;case"FOCUS":this.tree.element.trigger("focus");break;case"SELECTALLNODE":this.selectAllNode(n)}},selectAllNode:function(){if(this.tree.options.selectionType.toUpperCase()==="MULTIPLE"){var n=this.tree.element[0].querySelectorAll(".node");this.visitNodes(n)}},visitNodes:function(n){for(var q=0;q<n.length;q++){var t=n[q],r=this.Nodes.hasChildNodes(t);if(r){var u=this.Nodes.getChildNodes(t);this.visitNodes(u)}else{var f=this.Nodes.getNode(t);$(t).hasClass("checked")||this.Nodes.checkNode(f)}}},refreshNode:function(n,t){t=this.tree._ensureBoolean(t);var o=TreeUtil.detectFormat(n,this.tree.options.pathSeparator);if(o==="path"){for(var e=0,s=n.split(this.tree.options.pathSeparator),u=this.Nodes.getChildNodes(null),f=[],r=0,h=u.length;r<h;r++)f.push(u[r]);while(f.length>0){var q=f.shift(),c=this.Nodes.getData(q),l=this.tree._getValueToMatch(c,o);if(l===s[e]){if(e===s.length-1){q.classList.remove("populated");q.classList.add("collapsed");this.Nodes.clearChildren(q);var a={context:this.tree,makePriority:!0,startLevel:c.level,callback:function(){t?this.Nodes.expandNode(q,!1):this.Nodes.collapseNode(q,!0)}};this.Population.populateNode(q,a);break}e++;u=this.Nodes.getChildNodes(q);for(var r=0,h=u.length;r<h;r++)f.push(u[r])}}}},find:function(n){var t=this;n=n.toUpperCase();this.tree.Population.traverseTree({onFinished:function(){t.findNodeFromDOMTree(n)}})},findNodeFromDOMTree:function(n){for(var q=this.tree.element[0].querySelectorAll("li"),r=q.length,t=0;t<r;t++){var u=this.Nodes.getText(q[t]).toUpperCase();if(this.Nodes.matchText(u,n,SearchBarOptions.Contains))if(this.tree.options.selectionType===TreeSelectionType.Single){this.Nodes.selectNode(q[t],!0);break}else{this.tree._shiftFocus(q[t]);break}}},findFromSelected:function(n){n=n.toUpperCase();for(var q=this.tree.element[0].querySelectorAll("li"),r=q.length,t=0;t<r;t++){var u=this.Nodes.getText(q[t]).toUpperCase();this.Nodes.matchText(u,n,SearchBarOptions.Contains)&&(this.tree.options.selectionType===TreeSelectionType.Single?this.Nodes.selectNode(q[t]):this.tree._shiftFocus(q[t]))}},populateNode:function(n){var g=n.methodParameters.nodepath,k=checkExists(n.methodParameters.recursive)?this.tree._ensureBoolean(n.methodParameters.recursive):!1,nt=checkExists(n.methodParameters.forcerefresh)?this.tree._ensureBoolean(n.methodParameters.forcerefresh):!1,f=this,e=!1,c=this.tree.element[0].querySelectorAll(".node:not(.populated)"),t=g.split(this.tree.options.delimiter),d=function(n){o=[];for(var c=this.Nodes.getChildNodes(n.node),h=0;h<c.length;h++){var y=this.Nodes.getData(c[h]);if(y.path==t[t.length-1]||y.value==t[t.length-1]||y.valuePath==t[t.length-1]){var u=c[h],l=this.Nodes.getData(u);e=!1;var a=this.Nodes.getParentNode(u);checkExists(a)&&a.classList.contains("checked")&&this.Nodes.setSelectedNode(u);for(var l=this.Nodes.getData(u),v=this.tree.options.definition,r=0;r<v.length;r++){var s=v[r];if(s.parentSmartObject===l.source.uid||s.uid===l.source.uid&&s.recursive){var q=this.tree.Population.createRequest();q.node=u;q.context=f;q.preLoadNodes=!1;q.source=s;q.startLevel=checkExists(this.tree.options.startLevel)?this.tree.options.startLevel:-1;q.cancelled=!1;q.cancelSetPath=!0;q.callback=w;this.Population.pushRequest(q,0);e=!0;this.Population.doPopulation()}}e||checkExists(a)&&a.classList.contains("checked")&&this.Nodes.checkNode(u,{fromClick:!0})}else for(var u=c[h],l=this.Nodes.getData(u),v=this.tree.options.definition,r=0;r<v.length;r++){var s=v[r];if(s.parentSmartObject===l.source.uid||s.uid===l.source.uid&&s.recursive){var q=this.Population.createRequest();q.node=u;q.context=f;q.preLoadNodes=!1;q.source=s;q.startLevel=checkExists(this.tree.options.startLevel)?this.tree.options.startLevel:-1;q.cancelled=!1;q.cancelSetPath=!0;q.callback=d;o.push(q);e=!0}}if(e){if(o.length>0)for(var r=0;r<o.length;r++)this.Population.pushRequest(o[r],0);this.isPopulating=!0;this.Population.doPopulation()}else this.Population.populationRequests=[],raiseEvent(this.tree.element.attr("id"),"Control","Nodes-Populated")}},w=function(n){if(k){for(var q=this.Nodes.getChildNodes(n.node),r=0;r<q.length;r++){for(var e=this.tree.Nodes.getData(q[r]),o=this.tree.options.definition,f=0;f<o.length;f++){var u=o[f];if(u.parentSmartObject===e.source.uid||u.uid===e.source.uid&&u.recursive){var t=this.tree.Population.createRequest();t.node=q[r];t.context=this;t.preLoadNodes=!1;t.source=u;t.startLevel=checkExists(this.tree.options.startLevel)?this.tree.options.startLevel:-1;t.cancelled=!1;t.cancelSetPath=!0;t.callback=w;this.tree.Population.pushRequest(t)}}this.tree.Population.doPopulation()}q.length===0&&(this.Population.populationRequests=[],raiseEvent(this.tree.element.attr("id"),"Control","Nodes-Populated"))}},f=this;if(c.length>0){for(var o=[],l=0;l<c.length;l++){var v=f.tree.Nodes.getChildNodes(c[l]),a=f.tree.Nodes.getData(c[l]);if(checkExists(v)&&(a.path==t[t.length-1]||a.value==t[t.length-1]||a.valuePath==t[t.length-1])&&v.length>0&&!nt){var r=c[l],y=this.tree.Nodes.getData(r);this.tree.Nodes.setSelectedNode(r);var u=f.tree.Nodes.getParentNode(r);for(checkExists(u)&&u.classList.contains("checked")&&(this.tree.Nodes.setSelectedNode(r),this.tree.Nodes.checkNode(r,{fromClick:!0}));checkExists(u);)f.tree.Nodes.updateCheckBoxState(u),u=f.tree.Nodes.getParentNode(u);if(k)for(var v=this.tree.Nodes.getChildNodes(r),b=0;b<v.length;b++)r.classList.contains("checked")&&this.tree.Nodes.checkNode(v[b],{fromClick:!0});e=!1;break}else if(a.path==t[t.length-1]||a.value==t[t.length-1]||a.valuePath==t[t.length-1]){var r=c[l],y=this.tree.Nodes.getData(r);e=!1;var u=f.tree.Nodes.getParentNode(r);for(checkExists(u)&&u.classList.contains("checked")&&this.tree.Nodes.setSelectedNode(r);checkExists(u);)f.tree.Nodes.updateCheckBoxState(u),u=f.tree.Nodes.getParentNode(u);for(var y=this.tree.Nodes.getData(r),p=this.tree.options.definition,s=0;s<p.length;s++){var h=p[s];if(h.parentSmartObject===y.source.uid||h.uid===y.source.uid&&h.recursive){var q=this.tree.Population.createRequest();q.node=r;q.context=this;q.preLoadNodes=!1;q.source=h;q.startLevel=checkExists(this.tree.options.startLevel)?this.tree.options.startLevel:-1;q.cancelled=!1;q.cancelSetPath=!1;q.callback=w;this.tree.Population.pushRequest(q);e=!0}}e?this.tree.Population.doPopulation():checkExists(u)&&u.classList.contains("checked")&&this.tree.Nodes.checkNode(r,{fromClick:!0});break}else for(var r=c[l],y=this.tree.Nodes.getData(r),p=this.tree.options.definition,s=0;s<p.length;s++){var h=p[s];if(h.parentSmartObject===y.source.uid||h.uid===y.source.uid&&h.recursive){var q=this.tree.Population.createRequest();q.node=r;q.context=this;q.preLoadNodes=!1;q.source=h;q.startLevel=checkExists(this.tree.options.startLevel)?this.tree.options.startLevel:-1;q.cancelled=!1;q.cancelSetPath=!1;q.callback=d;o.push(q);e=!0}}}if(e){if(o.length>0)for(var s=0;s<o.length;s++)this.tree.Population.pushRequest(o[s]);this.tree.Population.finishedPopulatingListeners.push(function(n,t){raiseEvent(f.tree.element.attr("id"),"Control","Nodes-Populated");f.tree.Population.finishedPopulatingListeners.splice(t,1)});this.tree.Population.doPopulation()}else raiseEvent(this.tree.element.attr("id"),"Control","Nodes-Populated")}},selectNode:function(n){var k=n.methodParameters.nodepath,w=!0,d=!1,r=this,e=!1,o=this.tree.element[0].querySelectorAll(".node:not(.populated)"),t=k.split(this.tree.options.delimiter),g=function(n){h=[];for(var c=this.Nodes.getChildNodes(n.node),s=0;s<c.length;s++){var v=this.Nodes.getData(c[s]);if(v.path==t[t.length-1]||v.value==t[t.length-1]||v.valuePath==t[t.length-1]){var f=c[s],y=this.Nodes.getData(f);e=!1;this.Nodes.setCheckState(f,!0);for(var o=this.Nodes.getParentNode(f);checkExists(o);)this.Nodes.updateCheckBoxState(o),this.Nodes.expandNode(o,!1),o=this.Nodes.getParentNode(o);for(var y=this.Nodes.getData(f),l=this.tree.options.definition,u=0;u<l.length;u++){var a=l[u];if(a.parentSmartObject===y.source.uid){var q=this.tree.Population.createRequest();q.node=f;q.context=r;q.preLoadNodes=!1;q.source=a;q.startLevel=checkExists(this.tree.options.startLevel)?this.tree.options.startLevel:-1;q.cancelled=!1;q.cancelSetPath=!0;q.callback=b;this.Population.pushRequest(q,0);e=!0;this.Population.doPopulation()}}e||checkExists(o)&&o.classList.contains("checked")&&this.Nodes.checkNode(f,{fromClick:!0})}else for(var f=c[s],y=this.Nodes.getData(f),l=this.tree.options.definition,u=0;u<l.length;u++){var a=l[u];if(a.parentSmartObject===y.source.uid){var q=this.Population.createRequest();q.node=f;q.context=r;q.preLoadNodes=!1;q.source=a;q.startLevel=checkExists(this.tree.options.startLevel)?this.tree.options.startLevel:-1;q.cancelled=!1;q.cancelSetPath=!0;q.callback=g;h.push(q);e=!0}}if(e){if(h.length>0)for(var u=0;u<h.length;u++)this.Population.pushRequest(h[u],0);this.isPopulating=!0;this.Population.doPopulation()}else this.Population.populationRequests=[],raiseEvent(this.tree.element.attr("id"),"Control","Nodes-Populated")}},b=function(n){if(w){for(var q=this.Nodes.getChildNodes(n.node),r=0;r<q.length;r++){for(var o=this.tree.Nodes.getData(q[r]),f=this.tree.options.definition,u=0;u<f.length;u++){var e=f[u];if(e.parentSmartObject===o.source.uid){var t=this.tree.Population.createRequest();t.node=q[r];t.context=this;t.preLoadNodes=!1;t.source=e;t.startLevel=checkExists(this.tree.options.startLevel)?this.tree.options.startLevel:-1;t.cancelled=!1;t.cancelSetPath=!1;t.callback=b;this.tree.Population.pushRequest(t)}}this.tree.Population.doPopulation()}q.length===0&&(this.Population.populationRequests=[],raiseEvent(this.tree.element.attr("id"),"Control","Nodes-Populated"))}},r=this;if(this.tree.options.path=k,o.length>0){for(var h=[],s=0;s<o.length;s++){var a=r.tree.Nodes.getChildNodes(o[s]),c=r.tree.Nodes.getData(o[s]);if(checkExists(a)&&(c.path==t[t.length-1]||c.value==t[t.length-1]||c.valuePath==t[t.length-1])&&a.length>0&&!d){var q=o[s],nt=this.tree.Nodes.getData(q);this.tree.Nodes.setSelectedNode(q);for(var f=r.tree.Nodes.getParentNode(q);checkExists(f);)r.tree.Nodes.updateCheckBoxState(f),r.tree.Nodes.expandNode(f,!1),f=r.tree.Nodes.getParentNode(f);if(this.tree.Nodes.checkNode(q,{}),w)for(var a=this.tree.Nodes.getChildNodes(q),v=0;v<a.length;v++)this.tree.Nodes.checkNode(a[v],{});e=!1;break}else if(c.path==t[t.length-1]||c.value==t[t.length-1]||c.valuePath==t[t.length-1]){var q=o[s],nt=this.tree.Nodes.getData(q);this.tree.Nodes.setSelectedNode(q);e=!1;for(var f=r.tree.Nodes.getParentNode(q);checkExists(f);)r.tree.Nodes.updateCheckBoxState(f),r.tree.Nodes.expandNode(f,!1),f=r.tree.Nodes.getParentNode(f);this.tree.Nodes.updateOptionsValuePath(q);for(var nt=this.tree.Nodes.getData(q),y=this.tree.options.definition,l=0;l<y.length;l++){var p=y[l];if(p.parentSmartObject===nt.source.uid){var u=this.tree.Population.createRequest();u.node=q;u.context=this;u.preLoadNodes=!1;u.source=p;u.startLevel=checkExists(this.tree.options.startLevel)?this.tree.options.startLevel:-1;u.cancelled=!1;u.cancelSetPath=!1;u.callback=b;this.tree.Population.pushRequest(u);e=!0}}e?this.tree.Population.doPopulation():this.tree.Nodes.checkNode(q,{});break}else for(var q=o[s],nt=this.tree.Nodes.getData(q),y=this.tree.options.definition,l=0;l<y.length;l++){var p=y[l];if(p.parentSmartObject===nt.source.uid){var u=this.tree.Population.createRequest();u.node=q;u.context=this;u.preLoadNodes=!1;u.source=p;u.startLevel=checkExists(this.tree.options.startLevel)?this.tree.options.startLevel:-1;u.cancelled=!1;u.cancelSetPath=!1;u.callback=g;h.push(u);e=!0}}}if(e){if(h.length>0)for(var l=0;l<h.length;l++)this.tree.Population.pushRequest(h[l]);this.tree.Population.doPopulation()}else{o=this.tree.element[0].querySelectorAll(".node.populated");for(var s=0;s<o.length;s++){var a=r.tree.Nodes.getChildNodes(o[s]),c=r.tree.Nodes.getData(o[s]);if(checkExists(a)&&(c.path==t[t.length-1]||c.value==t[t.length-1]||c.valuePath==t[t.length-1])&&a.length>0&&!d){var q=o[s],nt=this.tree.Nodes.getData(q);this.tree.Nodes.setSelectedNode(q);for(var f=r.tree.Nodes.getParentNode(q);checkExists(f);)r.tree.Nodes.updateCheckBoxState(f),r.tree.Nodes.expandNode(f,!1),f=r.tree.Nodes.getParentNode(f);if(this.tree.Nodes.checkNode(q,{}),w)for(var a=this.tree.Nodes.getChildNodes(q),v=0;v<a.length;v++)this.tree.Nodes.checkNode(a[v],{});e=!1;break}}}}},populateSelectedNodes:function(n){var b=checkExists(n.methodParameters.recursive)?this.tree._ensureBoolean(n.methodParameters.recursive):!1,c=checkExists(n.methodParameters.forcerefresh)?this.tree._ensureBoolean(n.methodParameters.forcerefresh):!1,r=this,u=!1,t=this.tree.element[0].querySelectorAll(".node.checked"),k=this.tree.Nodes.findHighestCheckedLevel(),l=function(n,t){if(r.tree.Population.finishedPopulatingListeners.splice(t,1),this.tree.isPopulating=!1,u=!1,b){for(var h=this.tree.element[0].querySelectorAll(".node.checked:not(.populated)"),e=0;e<h.length;e++){var c=h[e],o=this.tree.Nodes.getData(c);if(!o.isLeaf)for(var a=this.tree.options.definition,s=0;s<a.length;s++){var f=a[s];if(f.parentSmartObject===o.source.uid||f.uid===o.source.uid&&f.recursive){var q=this.tree.Population.createRequest();q.node=c;q.context=this;q.preLoadNodes=!1;q.source=f;q.startLevel=checkExists(this.tree.options.startLevel)?this.tree.options.startLevel:-1;q.cancelled=!0;this.tree.Population.pushRequest(q);u=!0}}}u?(this.tree.Population.finishedPopulatingListeners.push(l),this.tree.isPopulating=!0,this.tree.Population.doPopulation()):raiseEvent(r.tree.element.attr("id"),"Control","Nodes-Populated")}else raiseEvent(r.tree.element.attr("id"),"Control","Nodes-Populated")},r=this;if(t.length>0){if(c){var a=this.tree.element[0].querySelectorAll(".node.populated:not(.selectedVisible)[data-level="+(k+1)+"]");a.length>0&&($(a).remove(),t=this.tree.element[0].querySelectorAll(".node.checked"));for(var o=this.tree.element[0].querySelectorAll(".node.checked.expanded"),f=0;f<o.length;f++)$(o[f]).find(".node-container").remove(),$(o[f]).removeClass("expanded"),$(o[f]).addClass("collapsed")}t=this.tree.element[0].querySelectorAll(".node.checked");for(var e=0;e<t.length;e++){var v=r.tree.Nodes.getChildNodes(t[e]);if(checkExists(v)&&v.length>0&&!c)this.tree.Nodes.checkNode(t[e],{fromClick:!0});else for(var y=t[e],p=this.tree.Nodes.getData(y),w=this.tree.options.definition,h=0;h<w.length;h++){var s=w[h];if(s.parentSmartObject===p.source.uid||s.uid===p.source.uid&&s.recursive){var q=this.tree.Population.createRequest();q.node=y;q.context=this;q.preLoadNodes=!1;q.source=s;q.startLevel=checkExists(this.tree.options.startLevel)?this.tree.options.startLevel:-1;q.cancelled=!0;this.tree.Population.pushRequest(q);u=!0}}}u?(this.tree.Population.finishedPopulatingListeners.push(l),this.tree.Population.doPopulation()):raiseEvent(r.tree.element.attr("id"),"Control","Nodes-Populated")}},selectNodes:function(n){var f=checkExistsNotEmpty(n.methodParameters.level)?n.methodParameters.level:null,a=checkExists(n.methodParameters.populatechildren)?this.tree._ensureBoolean(n.methodParameters.populatechildren):!0,t=this,s=function(n,q){for(var u=t.tree.element[0].querySelectorAll(".node"),y=!0,p=!0,c=[],l=0,r=0;r<u.length;r++){var e=t.tree.Nodes.getData(u[r]),o=f-1;if(e.isLeaf||(y=!1),e.level>=l&&!e.isLeaf&&(c.push(u[r]),e.level>l&&(l=e.level)),e.level===parseInt(f)){t.tree.Nodes.setSelectedNode(u[r]);p=!1;for(var h=null;o>-1;)h=$(u[r]).closest("li[data-level='"+o+"']"),h[0].classList.remove("collapsed"),h[0].classList.add("expanded"),t.tree.Nodes.setSelectedNode(h[0]),o=o-1;if(a&&t.tree.Nodes.getChildNodes(u[r]).length==0&&!e.isLeaf){var w=u[r],b=this.tree.Nodes.getData(w);t.tree.Population.populateNode(w,{cancelSetPath:!0})}}}if(t.tree.Population.finishedPopulatingListeners.splice(q,1),p&&!y){t.tree.isPopulating=!0;t.tree.Population.finishedPopulatingListeners.push(s);for(var v=0;v<c.length;v++)t.tree.Population.populateNode(c[v],{cancelSetPath:!0})}};if(this.tree.options.path="",this.tree.options.Path="",this.tree.options.value="",this.tree.options.valuePath="",f!==null)if(this.tree.isPopulating)this.tree.Population.finishedPopulatingListeners.push(s);else{for(var r=this.tree.element[0].querySelectorAll(".node"),v=!0,y=!0,h=[],c=0,q=0;q<r.length;q++){var u=t.tree.Nodes.getData(r[q]),e=f-1;if(u.isLeaf||(v=!1),u.level>=c&&!u.isLeaf&&(h.push(r[q]),u.level>c&&(c=u.level)),u.level===parseInt(f)){this.tree.Nodes.setSelectedNode(r[q]);y=!1;for(var o=null;e>-1;)o=$(r[q]).closest("li[data-level='"+e+"']"),o[0].classList.remove("collapsed"),o[0].classList.add("expanded"),t.tree.Nodes.setSelectedNode(o[0]),e=e-1;var p=t.tree.Nodes.getChildNodes(r[q]);if(a&&checkExists(p)&&p.length===0&&!u.isLeaf){var w=r[q],b=this.tree.Nodes.getData(w);t.tree.Population.populateNode(w,{cancelSetPath:!0})}}}if(y&&!v){t.tree.isPopulating=!0;t.tree.Population.finishedPopulatingListeners.push(s);for(var l=0;l<h.length;l++)t.tree.Population.populateNode(h[l],{cancelSetPath:!0})}}},expandNode:function(n){var q=n.methodParameters.nodevalue;if(checkExistsNotEmpty(q)){var t=this,r=function(n){n!==null&&(t.Nodes.isNodeVisible(n)||t.Nodes.expandFromNode(n,!1),n.classList.contains("populated")?t.Nodes.expandNode(n,!1):t.Population.populateNode(n,{context:t,callback:function(n){t.Nodes.expandNode(n.node,!1)}}))},u=TreeUtil.detectFormat(q,this.tree.options.pathSeparator).toUpperCase();this.Population.findNode({value:q,searchType:u,callback:r,searchAll:!0,context:this})}},collapseNode:function(n){var r=n.methodParameters.nodevalue,q=TreeUtil.detectFormat(r,this.tree.options.pathSeparator);if(q==="value")for(var h=this.tree.element.find(".node.expanded"),t=0,c=h.length;t<c;t++){var u=this.Nodes.getNode(h[t]);if(!u.classList.contains("item")){var a=this.Nodes.getData(u);if(a.value===r){this.Nodes.collapseNode(u);break}}}else{for(var l=r.split(this.tree.options.pathSeparator),v=l.shift(),f=null,e=this.Nodes.getChildNodes(null),c=e.length,t=0;t<c;t++){var o=this.Nodes.getData(e[t]),s=null;if(q==="valuePath"?s=o.value:q==="path"&&(s="{0},{1}".format(o.idValue,o.source.name)),s===v){f=e[t];break}}f!==null&&this.collapseByPath(f,l,q)}},collapseByPath:function(n,t,q){var r=this.Nodes.getChildNodes(n);if(t.length>0)for(var o=t.shift();r.length>0;){var u=r[0];r.splice(0,1);var f=this.Nodes.getData(u),e=null;if(q==="valuePath"?e=f.value:q==="path"&&(e="{0},{1}".format(f.idValue,f.source.name)),e===o)if(t.length>1)this.collapseByPath(u);else{this.Nodes.collapseNode(u);break}}else this.Nodes.collapseNode(n)},expandAll:function(){var u=this.tree;this.expandedNodes=[];var n=this.Nodes.getChildNodes(null);if(n.length!==0){for(var t=0,r=n.length;t<r;t++)this.expandedNodes.push(n[t]);var q=this;this.Population.traverseTree({depthFirst:!1,onFinished:function(){for(var t=q.tree.element.find("li"),n=0;n<t.length;n++)q.Nodes.changeExpandState(t[n],!1,!1)}})}},collapseAll:function(){for(var u=this.tree,t=u.element.find(".node.expanded"),n=0,q=t.length;n<q;n++){var r=t[n];n!==q-1?this.Nodes.collapseNode(r,!0):this.Nodes.collapseNode(r)}}};
/*!
 SourceCode.Forms.Controls.Web.ControlPack.Scripts.TreeViewPopulation.js (Embedded resource)
*/
(typeof SourceCode=="undefined"||SourceCode===null)&&(SourceCode={});(typeof SourceCode.Forms=="undefined"||SourceCode.Forms===null)&&(SourceCode.Forms={});(typeof SourceCode.Forms.Controls=="undefined"||SourceCode.Forms.Controls===null)&&(SourceCode.Forms.Controls={});(typeof SourceCode.Forms.Controls.Web=="undefined"||SourceCode.Forms.Controls.Web===null)&&(SourceCode.Forms.Controls.Web={});SourceCode.Forms.Controls.Web.TreeViewPart_Population=function(){};SourceCode.Forms.Controls.Web.TreeViewPart_Population.prototype={populationRequests:null,currentRequest:null,recursiveParentValues:null,tree:null,xhrGetParentValues:null,xhrGetImages:null,nodePopulatedListeners:null,finishedPopulatingListeners:null,sourcesPopulated:null,fullyPopulated:!1,initialize:function(n){this.tree=n;this.recursiveParentValues=null;this.populationRequests=[];this.Methods=this.tree.Methods;this.Nodes=this.tree.Nodes;this.nodePopulatedListeners=[];this.finishedPopulatingListeners=[]},reset:function(){this.currentRequest=null;this.populationRequests=[];this.nodePopulatedListeners=[];this.finishedPopulatingListeners=[];this.tree.options.parentValue=0;this.sourcesPopulated=[];this.fullyPopulated=!1},cancel:function(){this.populationRequests=[];this.nodePopulatedListeners=[];this.finishedPopulatingListeners=[];this.tree.options.parentValue=0;this.sourcesPopulated=[];this.fullyPopulated=!1},updateNode:function(){var n=this.createRequest();n.update=!0;this.populationRequests.push(n);this.doPopulation()},populateTree:function(n){if(this.tree.isPopulating!==!0&&(this.tree.isPopulating=!0,this.Nodes.firstNode=!0,this.tree.options.definition!==null)){this.tree.clear(!1);this.reset();for(var f=!1,r=[],u=0;u<this.tree.options.definition.length;u++){var t=this.tree.options.definition[u];if(t.parentSmartObject.toUpperCase()===SFCTreeRuleHelper.NONE){var q=this.createRequest();q.source=t;q.startLevel=0;q.callback=checkExists(n)?n:null;this.pushRequest(q)}t.recursive&&t.parentSmartObject.toUpperCase()===SFCTreeRuleHelper.NONE&&t.parentProperty!==SourceCode.Forms.Controls.Web.TreeView.CustomValue&&r.push(t);t.icon!=="none"&&(f=!0)}f&&this.getIcons();this.tree.element.showBusyModal(!0);r.length>0?this.getRecursiveParentValues(r):this.doPopulation()}},populateNode:function(n,t){if(n!==null&&!n.classList.contains("populated")&&!n.classList.contains("populating")){for(var a=this.Nodes.getData(n),f=a.source,r=0,v=this.populationRequests.length;r<v;r++){var y=jQuery(this.populationRequests[r].node);if(y[0]===n[0])return}this.toggleNodePopulateState(n,!0);var e=!1,o=checkExists(t.context)?t.context:this,s=checkExists(t.callback)?t.callback:null,h=checkExists(t.makePriority)?t.makePriority:!1,u=0;if(f.recursive){var q=this.createRequest();q.node=n;q.source=f;q.context=o;q.callback=s;checkExists(t.startLevel)&&(q.startLevel=t.startLevel);h?(this.pushRequest(q,u),u++):this.pushRequest(q);e=!0}for(var c=this.tree.options.definition,r=0;r<c.length;r++){var l=c[r];if(l.parentSmartObject===f.uid){var q=this.createRequest();q.node=n;q.source=l;q.context=o;q.callback=s;q.cancelSetPath=checkExists(t.cancelSetPath)&&t.cancelSetPath?!0:!1;checkExists(t.startLevel)&&(q.startLevel=t.startLevel);h?(this.pushRequest(q,u),u++):this.pushRequest(q);e=!0}}(e||(this.toggleNodePopulateState(n,!1),n.classList.add("populated"),n.classList.add("empty")),checkExists(t.dontPopulate))||this.doPopulation()}},populateNodes:function(n,t){checkExists(t)||(t={});t.dontPopulate=!0;for(var r=n.length,q=0;q<r;q++)this.populateNode(n[q],t);this.doPopulation()},toggleNodePopulateState:function(n,t){var q=this.Nodes.getExpander(n);t?n.classList.add("populating"):n.classList.remove("populating")},hasChildSource:function(n,t){for(var q=0,r=n.length;q<r;q++)if(n[q].parentSmartObject===t.uid)return!0;return!1},requestReceived:function(n){var t=this.currentRequest;if(checkExists(t)){var f=!1,e=this.tree.options.definition,q=t.node;if(q===null)t.source.recursive!==!1||this.hasChildSource(e,t.source)||(f=!0);else if(!t.source.recursive){for(var o=!1,r=0;r<e.length;r++)if(e[r].parentSmartObject===t.source.uid){o=!0;break}o||(f=!0)}var h=this.addNodes(q,t.source,n,f);if(h&&this.tree.element.showBusyModal(!1),q!==null){this.tree.options.populatedNodePath=this.Nodes.getPath(q,"id");raiseEvent(this.tree.element[0].getAttribute("id"),"Control","Node Populated");var y=this.Nodes.getData(q);this.toggleNodePopulateState(q,!1);q.classList.add("populated");this.Nodes.hasChildNodes(q)?(q.classList.remove("empty"),q.classList.add("collapsed")):(q.classList.add("empty"),q.classList.remove("collapsed"))}try{for(var r=0,u=this.nodePopulatedListeners.length;r<u;r++)this.nodePopulatedListeners[r].call(this,q)}catch(c){SFLog({type:5,source:"Tree",category:"Controls",message:"Error ocurred executing node populated listener: {0}",parameters:[c.message]})}var l=checkExists(t.cancelSetPath)?t.cancelSetPath:!1,s=checkExists(t.cancelled)?t.cancelled:!1;if(!s&&t.callback!==null){var a={node:t.node};t.callback.call(t.context,a)}this.tree.options.preloadLevel>0&&t.startLevel>-1&&this.preLoadNodes(t);this.currentRequest=null;var v=this;if(this.populationRequests.length>0)v.doPopulation();else{if(this.Nodes.hasChildNodes(null)||(this.tree.element.showBusyModal(!1),this.tree.clear(!0)),this.setNodeLoadingSpinnerState(!1),this.tree.isPopulating=!1,checkExists(this.finishedPopulatingListeners)){for(var u=this.finishedPopulatingListeners.length;u>0&&!this.tree.isPopulating;)this.finishedPopulatingListeners[0].call(this,this.tree,0),u=this.finishedPopulatingListeners.length;u===0&&raiseEvent(this.tree.element.attr("id"),"Control","Nodes-Populated")}s||l||(checkExistsNotEmpty(this.tree.options.path)?this.tree.set(this.tree.options.path,"path"):checkExistsNotEmpty(this.tree.options.Path)?this.tree.set(this.tree.options.Path,"path"):checkExistsNotEmpty(this.tree.options.valuePath)?this.tree.set(this.tree.options.valuePath,"valuePath"):checkExistsNotEmpty(this.tree.options.value)&&this.tree.set(this.tree.options.value,"value"));this.tree.ensureStyle();raiseEvent(this.tree.element[0].getAttribute("id"),"Control","Populated")}}},preLoadNodes:function(n){var r=n.node;if(r!==null){var t=this.Nodes.getChildNodes(r);if(t.length>0){var u=this.Nodes.getData(t[0]);if(u.level<this.tree.options.preloadLevel+n.startLevel)for(var q=0;q<t.length;q++){var e=t[q];u=this.Nodes.getData(e);var f={context:n.context,startLevel:n.startLevel};this.populateNode(t[q],f)}}}else for(var t=this.Nodes.getChildNodes(null),q=0,o=t.length;q<o;q++){var f={context:n.context,startLevel:n.startLevel};this.populateNode(t[q],f)}},doPopulation:function(){if(this.populationRequests.length>0&&this.currentRequest===null){var n=this.populationRequests.shift();if(n.node!==null){var t=$(this.tree.element[0].querySelector(".sfc-treeview.populating-indicator"));this.tree.options.showSearch&&($(this.tree.element.find(".bottom-row")[0]).hasClass("hidden")?(t.hasClass("showSearchExpanded")&&t.removeClass("showSearchExpanded"),t.addClass("showSearch")):t.addClass("showSearchExpanded"));$(this.tree.element[0].querySelector(".node-container")).height()>$(this.tree.element[0].querySelector(".tree-body")).height()&&t.addClass("scrollbar");this.setNodeLoadingSpinnerState(!0);var q=this.Nodes.getData(n.node);checkExists(q)?this.tree.options.parentValue=q.idValue:this.doPopulation()}this.tree.options.loadLevel=n.source.index;n.executing=!0;this.currentRequest=n;this.sourcesPopulated.indexOf(n.source)<0&&this.sourcesPopulated.push(n.source);raiseEvent(this.tree.element[0].getAttribute("ID"),"Control","Populating")}},createRequest:function(){return{node:null,source:null,context:null,callback:null,preLoadNodes:!0,startLevel:-1,executing:!1}},pushRequest:function(n,t){var q="Invalid operation. request object must have the property '{0}'";if(n.node===undefined)throw new Error(q.format("node"));if(n.source===undefined)throw new Error(q.format("source"));if(n.callback===undefined)throw new Error(q.format("callback"));if(n.startLevel===undefined)throw new Error(q.format("startLevel"));if(n.preLoadNodes===undefined)throw new Error(q.format("preLoadNodes"));if(n.executing===undefined)throw new Error(q.format("executing"));checkExists(t)&&typeof t=="number"?this.populationRequests.splice(t,0,n):this.populationRequests.push(n)},escapeSpecialChar:function(n){return n.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},addNodes:function(n,t,q,r){var c=!1;if(checkExists(q.JsonData)){var l=q.JsonData.collection,s=l.length;if(s>0){for(var f=0,a=[];f<s;f++){var e=l[f],ut=checkExists(t.idProperty)?t.idProperty:t.valueProperty;var v=e.fields[t.valueProperty];if(v!==null){var nt=v.value,y=e.fields[t.idProperty];if(y!==null){var tt=y.value,qt=this.escapeSpecialChar(this.resolveDisplayTemplateObject(t.displayTemplate,e)),u={};if(checkExistsNotEmpty(t.iconProperty)&&e.fields[t.iconProperty]!==null){var rt=$.extend({},e.fields[t.iconProperty]),p=rt.value;checkExistsNotEmpty(p)&&(u.iconPropertyValue=p)}u.idValue=tt;u.value=nt;u.display=qt;u.source=t;u.isLeaf=r;u.smartObjectRow={};var w=e.fields;for(var b in w){var k=w[b].value;checkExists(k)&&(u.smartObjectRow[b]=k)}if(n===null)u.level=0,u.path="{0},{1}".format(u.idValue,u.source.name),u.valuePath=u.value;else{var h=this.Nodes.getData(n),d=this.tree.options.pathSeparator;u.level=h.level+1;u.path=h.path+d+"{0},{1}".format(u.idValue,u.source.name);u.valuePath=h.valuePath+d+u.value}var o=this.Nodes.createBatchNode(u);r?o.classList.add("empty"):o.classList.add("collapsed");a.push(o);this.tree.options.expandOnLoad&&this.Nodes.expandNode(o,!1)}}}if(this.Nodes.addNodes(n,a),this.tree.options.expandOnLoad&&n===null)for(var g=this.Nodes.getChildNodes(null),f=0,s=g.length;f<s;f++)this.Nodes.expandNode(g[f],!1);n!==null&&this.Nodes.isChecked(n)&&this.Nodes.updateOptionsValuePath();c=!0}}return c},findNode:function(n){checkExists(n.searchType)||(n.searchType=TreeFindType.Path);for(var u=function(n,t,q){return t===TreeFindType.Display&&n.display.indexOf(q)>=0?!0:t===TreeFindType.Value&&n.value===q||t===TreeFindType.Path&&n.path===q||t===TreeFindType.ValuePath&&n.valuePath===q?!0:!1},q=this.Nodes.getChildNodes(null),r=0,o=q.length;r<o;r++){var t=q[r],s=this.Nodes.getData(t);if(u(s,n.searchType,n.value)){checkExists(n.callback)?checkExists(n.context)?n.callback.call(n.context,t):n.callback(t):this.tree._shiftFocus(t);break}}if(n.searchAll){var f=this,e=n.callback,h=n.searchType,c=n.value,n={nodes:q,onNode:function(n){var t=f.Nodes.getData(n.node);u(t,h,c)&&(checkExists(e)?e(n.node):f.tree._shiftFocus(n.node),n.cancel=!0)}};this.traverseTree(n)}},pathsPartialEquals:function(n,t){if(!checkExists(n))return!1;for(var f=this.tree.options.pathSeparator,r=n.split(f),u=t.split(f),e=r.length>u.length?u.length:r.length,q=0;q<e;q++)if(r[q]!==u[q])return!1;return!0},findNodeByPath:function(n){checkExists(n.valueDepth)||(n.valueDepth=n.value.split(this.tree.options.pathSeparator).length-1);var t=null;if(n.valueType==="path"||n.valueType==="valuePath"){if(checkExists(n.nodes))t=n.nodes;else if(checkExists(n.fromNode))if(n.fromNode.classList.contains("populated"))t=this.Nodes.getChildNodes(n.fromNode);else{this.populateNode(n.fromNode,{context:this,callback:function(t){if(n.singlePath){n.nodes=this.Nodes.getChildNodes(t.node);var e=this.Nodes.getData(t.node),r=e.path.split(n.pathSeparator),o="";r.length>0&&(o=r[r.length-1]);for(var q=0;q<n.nodes.length;q++){var u=this.Nodes.getData(n.nodes[q]),f=n.internalTree._findNode(u[n.valueType],u.level);if(checkExists(f)&&f.selected)n.onResult({node:n.nodes[q],status:TreeFindResult.Found})}}else n.nodes=this.Nodes.getChildNodes(t.node),this.findNodeByPath(n)}});return}else t=this.Nodes.getChildNodes(null);if(t.length>0)for(var u=0,o=t.length;u<o;u++)if(n.singlePath){var q=t[u],r=this.Nodes.getData(q),f=n.valueType=="path"?r.path:r.valuePath;if(this.pathsPartialEquals(n.value,f)){if(n.valueDepth==r.level&&f===n.value)n.onResult({node:q,status:TreeFindResult.Found});n.fromNode=q;n.nodes=null;this.findNodeByPath(n);break}}else{var q=t[u];n.fromNode=q;var r=this.Nodes.getData(q),f=n.valueType=="path"?r.path:r.valuePath;this.pathsPartialEquals(n.value,f)&&(n.nodes=null,this.findNodeByPath(n))}else if(!this.Nodes.hasChildNodes(null)){var e=this;this.populateTree(function(t){n.nodes=e.Nodes.getChildNodes(t.node);e.findNodeByPath(n)})}}},getRecursiveParentValues:function(n){if(this.recursiveParentValues=[],n.length===0){this.doPopulation(0,null,this.tree.element[0].getAttribute("id"));return}for(var f="",u=[],r=0;r<n.length;r++){var t=n[r];u.push(t);var e="{0},{1},{2},{3}".format(t.name,t.idProperty,t.parentProperty,t.method);f+=r!=0?";"+e:e}var o={method:"GetRootValues",sourceValues:f},q=this;jQuery.ajax({url:applicationRoot+"SFCTreeViewHandler.handler",data:o,dataType:"text",type:"post",global:!1,success:function(n){if(checkExistsNotEmpty(n)){var e=JSON.parse(n);if(checkExists(e))for(var t=0;t<u.length;t++){var r=u[t].id;if(q.recursiveParentValues[r]===undefined){q.recursiveParentValues[r]=[];for(var o=e[t],f=0;f<o.ParentValues.length;f++)q.recursiveParentValues[r].push(o.ParentValues[f])}}}q.doPopulation()},error:function(){q.doPopulation()}})},traverseTree:function(n){checkExists(n.depthFirst)||(n.depthFirst=!0);for(var q=this.tree.element[0].querySelectorAll(".node"),r=[],t=0,u=q.length;t<u;t++)r.push(q[t]);this.walkFromNodes(r,n)},walkFromNodes:function(n,t){if(t.nodePopulated===undefined){var o=this;t.nodePopulated=function(q){for(var u=o.Nodes.getChildNodes(q),r=0,f=u.length;r<f;r++)n.push(u[r]);o.walkFromNodes(n,t)};this.nodePopulatedListeners.push(t.nodePopulated)}if(n.length===0){var u=this.nodePopulatedListeners.indexOf(t.nodePopulated);u>-1&&this.nodePopulatedListeners.splice(u,1);checkExists(t.onFinished)&&t.onFinished();return}for(var f=[],e=0,c=n.length;e<c;e++){var r=n[e];if(r.classList.contains("populated")||r.classList.contains("empty")){if(checkExists(t.skipNodeList)&&t.skipNodeList.indexOf(r)>=0)continue;var s={node:r,cancel:!1};if(checkExists(t.onNode))t.onNode(s);if(s.cancel){n=[];checkExists(this.currentRequest)&&(this.currentRequest.cancelled=!0);this.cancel();var u=this.nodePopulatedListeners.indexOf(t.nodePopulated);u>-1&&this.nodePopulatedListeners.splice(u,1);checkExists(t.onFinished)&&t.onFinished();return}}else f.push(r)}if(f.length===0)checkExists(t.onFinished)&&t.onFinished();else{var h=f.shift(),q=this.createRequest();q.node=h;q.context=this;q.preLoadNodes=!1;q.startLevel=-1;q.callback=function(q){for(var u=this.Nodes.getChildNodes(q.node),r=0,e=u.length;r<e;r++)n.push(u[r]);this.walkFromNodes(f,t)};this.populateNode(h,q)}},getIcons:function(){var t=this,n=this.tree.options,q={smartObjectId:n.iconSourceId,smartObjectMethod:n.iconMethod,idProperty:n.iconId,nameProperty:n.iconName,imageProperty:n.iconImage,methodName:"getSpriteImage",desiredWidth:16,desiredHeight:16,extended:!0,returnValueForProperty:n.iconName};this.xhrGetImages=$.ajax({url:applicationRoot+"SmartObjectImageStore.handler",dataType:"json",method:"POST",contentType:"application/json; charset=utf-8",data:JSON.stringify(q),complete:function(n){t.tree.iconData=checkExists(n.responseJSON)?n.responseJSON:{};t.applyImages()}})},applyImages:function(){var n=this.tree.element.find("li");if(checkExists(n)&&n.length!==0)for(var t=0,u=n.length;t<u;){var q=this.Nodes.getNode(n[t]),r=this.Nodes.getData(q);r.source.icon!=="none"&&this.tree.Nodes.applyImage(q,r.source.icon);t++}},setNodeLoadingSpinnerState:function(n){this.tree.element[0].querySelector(".sfc-treeview.populating-indicator").style.visibility=n?"visible":"collapse"},isPopulating:function(){return this.populationRequests.length>0||this.currentRequest!==null},isFullyPopulated:function(){if(this.fullyPopulated)return!0;if(this.isPopulating())return!1;if(this.sourcesPopulated.length===this.tree.options.definition.length){var n=this.tree.element[0].querySelectorAll(".node"),t=this.tree.element[0].querySelectorAll(".node.populated");this.fullyPopulated=n.length===t.length}return this.fullyPopulated},sourceIndex:function(n){for(var q=this.tree.options.definition,t=0;t<q.length;t++)if(q[t]===n)return t;return-1},resolveDisplayTemplate:function(n,t){for(var r="",u=0,e=n.length;u<e;){var q=n[u];if(q.type==="context"){var f=t.selectSingleNode("fields/field[@name='{0}']".format(q.data.SourceID));r+=f!==null?f.text:"[No value found for '{0}']".format(q.data.SourceID)}else q.type==="value"&&(r+=q.data);u++}return r},resolveDisplayTemplateObject:function(n,t){for(var r="",u=0,e=n.length;u<e;){var q=n[u];if(q.type==="context"){var f=t.fields[q.data.SourceID];r+=f!==null?f.value:"[No value found for '{0}']".format(q.data.SourceID)}else q.type==="value"&&(r+=q.data);u++}return r}};
/*!
 SourceCode.Forms.Controls.Web.ControlPack.Scripts.TreeViewType.js (Embedded resource)
*/
(function(n){(typeof SourceCode=="undefined"||SourceCode===null)&&(SourceCode={});(typeof SourceCode.Forms=="undefined"||SourceCode.Forms===null)&&(SourceCode.Forms={});(typeof SourceCode.Forms.Controls=="undefined"||SourceCode.Forms.Controls===null)&&(SourceCode.Forms.Controls={});(typeof SourceCode.Forms.Controls.Web=="undefined"||SourceCode.Forms.Controls.Web===null)&&(SourceCode.Forms.Controls.Web={});var t;SourceCode.Forms.Controls.Web.TreeView=t=n.extend({},SourceCode.Forms.Controls.Base.ControlType,{CustomValue:"[CUSTOM]",EVENT_CHANGED:"Changed",EVENT_DOUBLE_CLICKED:"Double-Clicked",_getInstance:function(n){var t=jQuery("#{0}".format(n));if(t.length===0)throw ControlResources.SourceCode.Forms.Controls.Web.Properties.TextBox.ControlNotFound.format(n);return t},getProperty:function(q){var u=t._getInstance(q.CurrentControlId),r=q.property.toUpperCase();if(r==="LOADLEVEL")r="loadLevel";else if(r==="PARENTVALUE")r="parentValue";else if(r==="VALUE")r="value";else if(r==="MULTISELECT")r="multiSelect";else if(r==="DELIMITER")r="delimiter";else if(r==="SAVEASXML")r="saveAsXml";else if(r==="VALUE")r="value";else if(r==="EXPANDONLOAD")r="expandOnLoad";else if(r==="HEIGHT")r="height";else if(r==="WATERMARKTEXT")r="watermarktext";else if(r==="ICONSOURCEID")r="iconSourceId";else if(r==="ICONNAME")r="iconName";else if(r==="ICONID")r="iconId";else if(r==="ICONIMAGE")r="iconImage";else if(r==="ICONMETHOD")r="iconMethod";else if(r==="TABINDEX")r="tabIndex";else if(r==="ITEMVALUE")r="itemValue";else if(r==="ITEMPARENT")r="itemParent";else if(r==="ITEMSOURCE")r="itemSource";else if(r==="PATH")r="path";else if(r==="VALUEPATH")r="valuePath";else if(r==="PATHSEPARATOR")r="pathSeparator";else{if(r==="ASSOCIATIONSO"){var f=u.SFCTreeView("option","lastFocusedNode");return checkExists(f)?n(f).data().source:""}r==="SELECTEDITEMID"?r="selectedItemID":r==="POPULATEDNODEPATH"?r="populatedNodePath":r==="ID"?r="id":r==="DISPLAYVALUE"?r="displayValue":r==="ISENABLED"&&(r="isEnabled")}var e=u.SFCTreeView("option",r);if(e!==u)return e},setProperty:function(n){var r=t._getInstance(n.CurrentControlId),q=n.property.toUpperCase(),u=n.Value;q==="LOADLEVEL"?q="loadLevel":q==="VALUE"?(q="value",r.SFCTreeView("set",u,"value")):q==="PARENTVALUE"?q="parentValue":q==="MULTISELECT"?q="multiSelect":q==="ISENABLED"?(q="isEnabled",r.SFCTreeView("setEnabled",u)):q==="ISPARENTENABLED"?(q="isParentEnabled",r.SFCTreeView("setParentEnabled",u)):q==="ISREADONLY"?(q="isReadOnly",r.SFCTreeView("setReadOnly",u)):q==="ISPARENTREADONLY"?(q="isParentReadOnly",r.SFCTreeView("setParentReadOnly",u)):q==="ISVISIBLE"?(q="isVisible",r.SFCTreeView("setVisibility",u)):q==="ISPARENTVISIBLE"?(q="isParentVisible",r.SFCTreeView("setParentVisibility",u)):q==="HEIGHT"?r.SFCTreeView("setHeight",u):q==="WIDTH"?r.SFCTreeView("setWidth",u):q==="STYLE"?r.SFCTreeView("setStyle",u):q==="WATERMARKTEXT"?r.SFCTreeView("setWatermark",u):q==="SAVEASXML"?q="saveAsXml":q==="TABINDEX"?(q="TabIndex",r.SFCTreeView("setTabIndex",u)):q==="PATH"?(q="path",r.SFCTreeView("set",u,"path")):q==="VALUEPATH"?(q="valuePath",r.SFCTreeView("set",u,"valuePath")):q==="PATHSEPARATOR"?q="pathSeparator":q==="POPULATEDNODEPATH"?q="PopulatedNodePath":q=="DELIMITER"?q="delimiter":q==="ID"&&(q="id");r.SFCTreeView("option",q,u)},execute:function(n){var q=t._getInstance(n.CurrentControlId);q.SFCTreeView("onExecute",n)},designtimeEvent:function(n){switch(n.eventType){case"changecontrol":var t=n.designerDefinition.documentElement.selectSingleNode("Views/View/Controls/Control[@ID='"+n.controlId+"']/Properties/Property[Name='DataSourceType']"),u=n.designerDefinition.documentElement.selectSingleNode("Views/View/Controls/Control[@ID='"+n.controlId+"']/Properties/Property[Name='DataSourceType']/Value"),f=n.designerDefinition.documentElement.selectSingleNode("Views/View/Controls/Control[@ID='"+n.controlId+"']/Properties/Property[Name='DataSourceType']/DisplayValue");t.removeChild(u);t.removeChild(f);var q=n.designerDefinition.createElement("Value"),r=n.designerDefinition.createElement("DisplayValue"),e=n.designerDefinition.createTextNode("SmartObject"),o=n.designerDefinition.createTextNode("SmartObject");q.appendChild(e);r.appendChild(o);t.appendChild(q);t.appendChild(r)}EventUtil.manageControlEvent(n)},setControlName:function(n,t){n.find(".SFC").text(t)},setWidth:function(n,t){t||(t="150px");var r=jQuery(n).find(".SFC").SFCTreeView();r.SFCTreeView("option","width",t);var u=n.find(".SFC.SourceCode-Forms-Controls-Web-ControlPack-TreeView"),f=n.find(".stylewrapper");if(checkExistsNotEmpty(t)){var q=t;t.indexOf("%")<0&&t.indexOf("px")<0&&(q=t+"px");n[0].style.width=q}else n[0].style.width="";return u[0].style.width="",f[0].style.width="",t},getWidth:function(n){var t=n.find(".SFC.SourceCode-Forms-Controls-Web-ControlPack-TreeView");return t[0].clientWidth},setHeight:function(n,t){var r=jQuery(n).find(".SFC").SFCTreeView();r.SFCTreeView("option","height",t);var q=n.find(".SFC.SourceCode-Forms-Controls-Web-ControlPack-TreeView");return checkExistsNotEmpty(t)?(t.indexOf("px")<0&&(t=t+"px"),q[0].style.height=t,n[0].style.height=t,n[0].querySelector(".resizewrapper").style.height=t,q[0].querySelector(".stylewrapper").style.height=t,t):(q[0].style.height="50px",n[0].style.height="50px",n[0].querySelector(".resizewrapper").style.height="50px",q[0].querySelector(".stylewrapper").style.height="50px",t)},getHeight:function(n){var t=n.find(".SFC.SourceCode-Forms-Controls-Web-ControlPack-TreeView");return t[0].clientHeight},setReadOnly:function(n,t){var q=n.find(".SFC.SourceCode-Forms-Controls-Web-ControlPack-TreeView"),r=t==="true";r?q.addClass("readonly"):q.removeClass("readonly")},setVisible:function(n,t){var q=n.find(".SFC.SourceCode-Forms-Controls-Web-ControlPack-TreeView"),r=t==="true";r?q.removeClass("invisible"):q.addClass("invisible")},setEnabled:function(n,t){var q=n.find(".SFC.SourceCode-Forms-Controls-Web-ControlPack-TreeView"),r=t==="true";r?q.removeClass("disabled"):q.addClass("disabled")},setWatermarkText:function(n,t){var r=n.find(".SFC.SourceCode-Forms-Controls-Web-ControlPack-TreeView"),q=r.find("span.watermark");q.length>0&&(q[0].innerHTML=t)},getSelectionTypeItems:function(){var n=[];n.push(TreeSelectionType.Single);n.push(TreeSelectionType.Multiple);var t=[];t.push("Single");t.push("Multiple");var q={};return q.values=n,q.displays=t,q},setSelectionType:function(n,q){var r=t._getInstance(n.attr("id"));q===TreeSelectionType.Single?r.SFCTreeView("collapseParents"):r.SFCTreeView("expandParents")},populateMappingPropertiesFor:function(n,t,q,r){var u={values:[],displays:[],iconClasses:[]},c=!1,l=null;if(checkExists(t)&&checkExists(t.grid)){var v=t.grid.controlid,y=SourceCode.Forms.Designers.View.viewDefinitionXML,a=y.selectSingleNode("SourceCode.Forms/Views/View/Controls/Control[@ID='{0}']".format(v)),o=a.selectSingleNode("Properties/Property[Name='{0}']".format(n));if(o!==null&&checkExists(r)&&checkExistsNotEmpty(o.getAttribute("ValidationMessages")))for(var b=new SourceCode.Forms.Services.AnalyzerResourcesService,p=b.parseValidationMessage(o.getAttribute("ValidationMessages")),e=0;e<p.length;e++){var w=p[e];if(w.referenceAs===r.value&&w.status===SourceCode.Forms.DependencyHelper.ReferenceStatus.Missing){var h=o.selectSingleNode("Value").text;return u.values.push(h),u.displays.push(h),u.iconClasses.push("error"),u}}var s=jQuery("#{0}".format(v)).data("mappingData");if(checkExists(s)){for(var e=0;e<s.properties.length;e++){var f=s.properties[e];e===0?l=f.name:checkExistsNotEmpty(q)&&f.subType.toUpperCase()===q.toUpperCase()&&(t.defaultValue=f.name,c=!0);u.values.push(f.name);u.displays.push(f.display);u.iconClasses.push(f.subType)}for(var e=0;e<s.imageProperties.length;e++){var f=s.imageProperties[e];e===0?l=f.name:checkExistsNotEmpty(q)&&f.subType.toUpperCase()===q.toUpperCase()&&(t.defaultValue=f.name,c=!0);u.values.push(f.name);u.displays.push(f.display);u.iconClasses.push(f.subType)}c||(t.defaultValue=l);a!==null&&o===null&&TreeUtil.updateProperty(y,a,n,t.defaultValue)}if(o!==null&&checkExistsNotEmpty(o.getAttribute("ValidationStatus"))){var k=o.selectSingleNode("Name").text,h=o.selectSingleNode("Value").text;u.values.push(h);u.displays.push(h);u.iconClasses.push("error")}}return u},getIconMappingProperties:function(n){var q={values:[],displays:[],iconClasses:[]},h=SourceCode.ControlPack.RefAs.TreeIconId;if(checkExists(n)&&checkExists(n.grid)){var o=n.grid.controlid,f=jQuery("#{0}".format(o)).data("mappingData");if(checkExists(f)){for(var r=0;r<f.properties.length;r++){var u=f.properties[r];r===0&&(n.defaultValue=u.name);q.values.push(u.name);q.displays.push(u.display);q.iconClasses.push(u.subType)}q=t.populateDropDownWithMissingProperties(n,h,q);var s=SourceCode.Forms.Designers.View.viewDefinitionXML,e=s.selectSingleNode("SourceCode.Forms/Views/View/Controls/Control[@ID='{0}']".format(o));if(e!==null){var c=e.selectSingleNode("Properties/Property[Name='IconId']/Value");c===null&&TreeUtil.updateProperty(s,e,"IconId",n.defaultValue)}}}return q},getIconImageProperties:function(n){var q={values:[],displays:[],iconClasses:[]},h=SourceCode.ControlPack.RefAs.TreeIconImage;if(checkExists(n)&&checkExists(n.grid)){var o=n.grid.controlid,r=jQuery("#{0}".format(o)).data("mappingData");if(checkExists(r)){if(r.imageProperties.length>0){for(var u=0;u<r.imageProperties.length;u++){var f=r.imageProperties[u];u===0&&(n.defaultValue=f.name);q.values.push(f.name);q.displays.push(f.display);q.iconClasses.push(f.subType)}var s=SourceCode.Forms.Designers.View.viewDefinitionXML,e=s.selectSingleNode("SourceCode.Forms/Views/View/Controls/Control[@ID='{0}']".format(o));if(e!==null){var c=e.selectSingleNode("Properties/Property[Name='IconImage']/Value");c===null&&TreeUtil.updateProperty(s,e,"IconImage",n.defaultValue)}}q=t.populateDropDownWithMissingProperties(n,h,q)}}return q},getIconNameMappingProperties:function(q){var r={values:[],displays:[],iconClasses:[]},h=!1,c=null,a=SourceCode.ControlPack.RefAs.TreeIconName;if(checkExists(q)&&checkExists(q.grid)){var f=q.grid.controlid,o=jQuery("#{0}".format(f)).data("mappingData");if(checkExists(o)){if(o.properties.length>0){for(var s=0;s<o.properties.length;s++){var u=o.properties[s];u.subType.toUpperCase()==="TEXT"?(q.defaultValue=u.name,h=!0):s===0&&(c=u.name);r.values.push(u.name);r.displays.push(u.display);r.iconClasses.push(u.subType)}h||(q.defaultValue=c);var l=SourceCode.Forms.Designers.View.viewDefinitionXML,e=l.selectSingleNode("SourceCode.Forms/Views/View/Controls/Control[@ID='{0}']".format(f));if(e!==null){var v=e.selectSingleNode("Properties/Property[Name='IconName']/Value");v===null&&TreeUtil.updateProperty(l,e,"IconName",q.defaultValue)}}r=t.populateDropDownWithMissingProperties(q,a,r)}var q=n("#"+f).find(".SourceCode-Forms-Controls-Web-ControlPack-TreeView").SFCTreeView().SFCTreeView("option");q.skipSetting||setTimeout(function(){checkExists(SourceCode.Forms.Designers.View.propertyGrid)&&(checkExists(e.xml)&&(SourceCode.Forms.Designers.View.propertyGrid.valuexml="<Controls>"+e.xml+"<\/Controls>"),n("#"+f).trigger("click"),n("#"+f).find(".SourceCode-Forms-Controls-Web-ControlPack-TreeView").SFCTreeView().SFCTreeView("option","skipSetting",!0))},0)}return r},populateDropDownWithMissingProperties:function(n,t,q){var o=n.grid.controlid,s=SourceCode.Forms.Designers.View.viewDefinitionXML,h=s.selectSingleNode("SourceCode.Forms/Views/View/Controls/Control[@ID='{0}']".format(o)),r=h.selectSingleNode("Properties/Property[Name='{0}']".format(n.id));if(r!==null&&checkExists(t)&&checkExistsNotEmpty(r.getAttribute("ValidationMessages")))for(var c=new SourceCode.Forms.Services.AnalyzerResourcesService,f=c.parseValidationMessage(r.getAttribute("ValidationMessages")),u=0;u<f.length;u++){var e=f[u];if(e.referenceAs===t.namespace+"."+t.value&&e.status===SourceCode.Forms.DependencyHelper.ReferenceStatus.Missing){var l=r.selectSingleNode("Value").text,a=r.selectSingleNode("DisplayValue").text;q.values.push(l);q.displays.push(a);q.iconClasses.push("error")}}return q},setValue:function(n){var q=t._getInstance(n.CurrentControlId),r=TreeUtil.detectFormat(n.Value,q.SFCTreeView("option","pathSeparator"));q.SFCTreeView("set",n.Value,r)},getValue:function(n){return t._getInstance(n.CurrentControlId).SFCTreeView("getValue",n)},getDefaultValue:function(n){return t._getInstance(n.CurrentControlId).SFCTreeView("getValue")},setStyles:function(n,t){var r=n.find(".SFC.SourceCode-Forms-Controls-Web-ControlPack-TreeView");if(n[0].getAttribute("id")==="StyleBuilderPreviewPanelContent"){r.SFCTreeView().SFCTreeView("generatePreviewTree");var q=r.find(".stylewrapper");q.addClass("tree-view-style-builder");var u={};jQuery.extend(u,{border:q,background:q,margin:q,padding:q,font:q});StyleHelper.setStyles(u,t);r.SFCTreeView().SFCTreeView("ensureFontStyle")}else if(n.hasClass("condtional-format-preview")){r.SFCTreeView().SFCTreeView("generatePreviewTree");var q=r.find(".stylewrapper");r.addClass("tree-view-conditional-style-builder");var u={};jQuery.extend(u,{border:q,background:q,margin:q,padding:q,font:q});StyleHelper.setStyles(u,t);r.SFCTreeView().SFCTreeView("ensureFontStyle")}else{var f=r.find(".stylewrapper"),u={};jQuery.extend(u,{border:f,background:f,margin:f,padding:f,font:f});StyleHelper.setStyles(u,t)}if(n.find(".SFC").SFCTreeView().SFCTreeView("option","style",t.xml),r.SFCTreeView().SFCTreeView("ensureFontStyle"),r.hasClass("designtime")){var e=n.find(".resizewrapper");e.length>0&&(e[0].style.width="100%")}},settingItems:function(n){return t._getInstance(n.CurrentControlId).SFCTreeView("onSettingItems",n)},setItems:function(n){t._getInstance(n.CurrentControlId).SFCTreeView("onSetItems",n)},preLoadLevelEventHandler:function(t,q,r){var u=t,f=q.closest(".spinner");f.on("change blur keyup keydown",function(e){var s=e.target.value.toString(),o=e.keyCode||e.charCode;if(o===110||o===190)return!1;if(o===8||o===46,(s==="-1"||s==="0")&&(o>48&&o<=57||o>=96&&o<=105))return n(q).val(""),!0;u!==s&&(t!=="scp"&&SetControlTabIndex([s],r),u=s,f.spinner("value",[s]))})},getPreloadLevelOptions:function(){return{inputs:[{range:{min:0,max:10,step:1},displays:{0:"(None)",10:"(All Levels)"},defaultValue:3}],eventsHandler:"SourceCode.Forms.Controls.Web.TreeView.preLoadLevelEventHandler"}},setPreloadLevelOptions:function(){},preLoadLevelEventHandler:function(t,q,r){var u=t,f=q.closest(".spinner");f.on("change blur keyup keydown",function(e){var s=e.target.value.toString(),o=e.keyCode||e.charCode;if(o===110||o===190)return!1;if(o===8||o===46,(s==="-1"||s==="0")&&(o>48&&o<=57||o>=96&&o<=105))return n(q).val(""),!0;u!==s&&(t!=="scp"&&SetControlTabIndex([s],r),u=s,f.spinner("value",[s]))})},preLoadLevelEventHandler:function(t,q,r){var u=t,f=q.closest(".spinner");f.on("change blur keyup keydown",function(e){var s=e.target.value.toString(),o=e.keyCode||e.charCode;if(o===110||o===190)return!1;if(o===8||o===46,(s==="-1"||s==="0")&&(o>48&&o<=57||o>=96&&o<=105))return n(q).val(""),!0;u!==s&&(t!=="scp"&&SetControlTabIndex([s],r),u=s,f.spinner("value",[s]))})},getPreloadLevelOptions:function(){return{inputs:[{range:{min:0,max:10,step:1},displays:{0:"(None)",10:"(All Levels)"},defaultValue:3}],eventsHandler:"SourceCode.Forms.Controls.Web.TreeView.preLoadLevelEventHandler"}},setPreloadLevelOptions:function(){},validateDelimiterAndPathSeparator:function(n){return checkExists(n)&&n.val().length===0?ControlResources.SourceCode.Forms.Controls.Web.ControlPack.Properties.Tree.MustContainAtLeastOne.format(n[0].getAttribute("title")):null},validate:function(n){t._getInstance(n.CurrentControlId).SFCTreeView("validate",n)},getDisplay:function(n,t){var q={display:t,icon:"DataSourceType"};switch(n){case"DataSourceType":t===""?(q.display="(None)",q.icon=""):(q.display="SmartObject",q.icon="smartobject")}return q},shouldRenderProperty:function(n){if(n.propertyId==="LoadLevel"||n.propertyId==="AssociationSO"||n.propertyId==="AssociationMethod")return!1;return n.propertyId==="IconMethod"?!1:n.subDesignerType==="propertygrid"&&["Value","ParentValue","Path","ValuePath","SelectedItemID","ID","DisplayValue"].indexOf(n.propertyId)>-1?!1:!0}})})(jQuery);
/*!
 SourceCode.Forms.Controls.Web.ControlPack.Scripts.TreeView.js (Embedded resource)
*/
(function(n){(typeof SourceCode=="undefined"||SourceCode===null)&&(SourceCode={});(typeof SourceCode.Forms=="undefined"||SourceCode.Forms===null)&&(SourceCode.Forms={});(typeof SourceCode.Forms.Controls=="undefined"||SourceCode.Forms.Controls===null)&&(SourceCode.Forms.Controls={});(typeof SourceCode.Forms.Controls.Web=="undefined"||SourceCode.Forms.Controls.Web===null)&&(SourceCode.Forms.Controls.Web={});TreeSelectionType={Single:"single",Multiple:"multiple"};TreeFindType={Display:"DISPLAY",Value:"VALUE",ValuePath:"VALUEPATH",Path:"PATH"};TreeFindResult={Found:"FOUND",NotFound:"NOT_FOUND"};TreeIconState={Selected:"SELECTED",Hover:"HOVER"};InternalNode=function(){this.children=[];this.selected=!1};InternalNode.prototype={path:null,children:null,selected:null};InternalTree=function(){};InternalTree.prototype={RootNode:null,NodeDictionary:null,delimiter:"|",create:function(n,t){if(this.NodeDictionary={},this.delimiter=t,n.length!==0)for(var q=0;q<n.length;){var r=n[q];this.populateTree(r);q++}},populateTree:function(n){if(this.RootNode===null){var t=new InternalNode;t.path=null;t.children=[];this.RootNode=t}if(checkExistsNotEmpty(n)){if(!checkExistsNotEmpty(n))return this;var q=n;this._insert(this.RootNode,q,n,0)}else return;return this},_insert:function(n,t,q,r){var s=this._findNode(q,r),f=q.indexOf(this.delimiter),e=q.substring(0,f);if(f===-1&&(e=q),s===null){var u=new InternalNode;u.path=e;u.parent=n.fullPath;u.level=r;u.fullPath=checkExists(u.parent)?u.parent+this.delimiter+e:e;u.fullPath===t&&(u.selected=!0);n.children.push(u);this.NodeDictionary[u.fullPath+"_"+u.level]=u}if(f>-1)for(var o=0;o<n.children.length;o++){var h=q.substring(f+1);this._insert(n.children[o],t,h,r+1)}},_findNode:function(n,t){return checkExists(this.NodeDictionary[n+"_"+t])?this.NodeDictionary[n+"_"+t]:null},_traverse:function(n,t,q){var r=null;if(n.fullPath===t&&n.level===q)return n;for(var u=0;u<n.children.length;u++)if(r=this._traverse(n.children[u],t,q),r!=null)return r;return r}};n.widget("sfc.SFCTreeView",n.sfc.baseWidget,{CONTROL_CLASS:"SourceCode-Forms-Controls-Web-ControlPack-TreeView",DBNULL:"[System.DBNull]",systemIconSmartObject:"SourceCode_Forms_SFTreeIcons",KEY_LEFT_ARROW:37,KEY_UP_ARROW:38,KEY_RIGHT_ARROW:39,KEY_DOWN_ARROW:40,KEY_HOME:36,KEY_END:35,KEY_SPACEBAR:32,Population:null,Methods:null,Nodes:null,iconData:null,focusedElement:null,setValueItem:null,nodesToCheck:null,events:null,searchBar:null,searching:null,receivedFocus:!1,showNodeDebug:!1,isPopulating:!1,internalTree:null,lastFocusedNode:null,options:{width:"100%",height:"200px",tabIndex:0,delimiter:";",enabled:!1,waterMarkText:"",toolTip:null,expandOnLoad:!1,preloadLevel:1,selectionType:"single",loadLevel:0,parentValue:0,value:null,path:null,valuePath:null,id:null,displayValue:null,selectedItemID:null,populatedNodePath:null,pathSeparator:"|",saveAsXml:!1,showSearch:!1,previous:{},definition:null,iconSourceName:null,iconName:null,iconId:null,iconImage:null,iconMethod:null,designTime:!1,style:SourceCode.Forms.Controls.Base.emptyStylesNode,controlWrapper:!1,controlWrapperClassName:"treeview-dimensions-wrapper",skipSetting:!0,lastFocusedNode:null},_create:function(){if(this._applyControlWrapper(),this.options.designTime=this.element.hasClass("designtime"),this.base._create.apply(this,arguments),this._fixDelimiterProperty(),this.options.designTime!==!0){var u=this.element.find(".node-container").first().addClass("root first");if(this.firstPopulate=!0,this.options.definition=JSON.parse(this.options.definition),checkExists(this.options.definition)){this._fixDefinition();for(var t=0;t<this.options.definition.length;t++)this.options.definition[t].index=t}this.isEnabled()?this._bindEvents():this.setEnabled(!1);this.options.isVisible||this.setVisibility(!1);this.Population=new SourceCode.Forms.Controls.Web.TreeViewPart_Population;this.Methods=new SourceCode.Forms.Controls.Web.TreeViewPart_Methods;this.Nodes=new SourceCode.Forms.Controls.Web.TreeViewPart_Nodes;this.Population.initialize(this);this.Methods.initialize(this);this.Nodes.initialize(this);this.options.previous=n.extend({},this.options);this.options.showSearch&&n(this.element[0].querySelector(".sfc-treeview.populating-indicator")).addClass("showSearch")}else this._createDesignIconMappings();if(this.options.designTime){if(this.options.showSearch){var r=this.element.find(".SourceCode-Forms-Controls-Web-ControlPack-Common-SearchBar");r.find("table").first()[0].setAttribute("style","")}}else{this.setTabIndex(this.options.tabIndex);this._handleValidation();this.options.showSearch&&this.initializeSearch();this.updateContainerHeights();raiseEvent(this.element[0].getAttribute("id"),"Control","Init");var q=n(".runtime-content > .panel > .panel-toolbars");this.element.closest(".toolbar",q).length>0&&this.element.addClass("inside-toolbar-cell")}return this},_fixDelimiterProperty:function(){if(this.options.designTime){var n=SourceCode.Forms.Designers.View.viewDefinitionXML;if(checkExists(n)){var r=this.element[0].getAttribute("id"),t=n.selectSingleNode("SourceCode.Forms/Views/View/Controls/Control[@ID='{0}']".format(r));if(t!==null){var q=t.selectSingleNode("Properties/Property[Name='{0}']/Value".format("Delemiter"));q!==null&&TreeUtil.updateProperty(n,t,"Delimiter",q.text)}}}},initializeSearch:function(){this.searching=!1;var q=this.element.find(".SourceCode-Forms-Controls-Web-ControlPack-Common-SearchBar");this.searchBar=new SourceCode.Forms.Controls.Web.ControlPack.SearchBar(q[0]);this.options.designTime&&this.searchBar.setDesignTime();var n=this,t;this.searchBar.bind(SearchBarEvents.TextChanged,function(q){clearTimeout(t);q.text.length===0?n.toggleSearchResults(!1):t=setTimeout(function(){n.search.call(n,q.text)},300)});this.searchBar.bind(SearchBarEvents.Search,function(){n.selectSearchResultItem.call(n)});this.searchBar.bind(SearchBarEvents.Clear,function(){n.search.call(n,"")});this.searchBar.bind(SearchBarEvents.SearchOptionsExpanded,function(){n.updateContainerHeights.call(n)});this.searchBar.bind(SearchBarEvents.SearchOptionsCollapsed,function(){n.updateContainerHeights.call(n)});this.searchBar.bind(SearchBarEvents.SearchOptionChanged,function(t){n.search.call(n,t.text)});this.searchBar.bind(SearchBarEvents.LostFocus,function(){})},toggleSearchResults:function(n){var t=this.element[0].querySelector(".tree-body"),q=this.element[0].querySelector(".search-results .inner-body"),r=this.element[0].querySelector(".search-results");n?r.classList.contains("hidden")&&(r.classList.remove("hidden"),t.classList.add("hidden"),q.classList.add("slide-in_start"),t.childNodes[0].classList.remove("slide-in_start"),t.childNodes[0].classList.remove("slide-in")):(this.searchBar.clearSearchText(),t.classList.contains("hidden")&&(r.classList.add("hidden"),t.classList.remove("hidden"),q.classList.remove("slide-in"),q.classList.remove("slide-in_start"),t.childNodes[0].classList.add("slide-in_start"),setTimeout(function(){t.childNodes[0].classList.add("slide-in")},50)))},search:function(n){var t=this;if(checkExistsNotEmpty(n)){var q=this.element.find(".populating-indicator");q.addClass("hidden");var r=this.element.find(".cp-tree-node-search-indicator");r.fadeIn({duration:400,queue:!1});this.toggleSearchResults(!0);this.element.find(".search-results .inner-body").empty();var u=this.element.find("ul.node-container.root.first"),f=u.find("li");this.Nodes.filterNodes(n);var e={skipNodesList:f,onNode:function(n){t.stopSearch&&(n.cancel=!0)},onFinished:function(){r.fadeOut({duration:400});t.Nodes.filterNodes(n);q.removeClass("hidden");t.stopSearch=!1;t.updateContainerHeights();t.setupSearchResultKeyboardBehavior()}};this.Population.traverseTree(e)}else this.cancelSearch(),this.toggleSearchResults(!1)},setupSearchResultKeyboardBehavior:function(){var t=this,q=this.element.find(".search-item-container");q.length>0&&q.attr("tabindex",0);q.on("keydown",function(q){switch(q.keyCode){case n.ui.keyCode.UP:var r=n(this).prev();r.length>0?r.trigger("focus"):n(this).siblings().last().trigger("focus");break;case n.ui.keyCode.DOWN:var u=n(this).next();u.length>0?u.trigger("focus"):n(this).siblings().first().trigger("focus");break;case n.ui.keyCode.TAB:if(q.shiftKey){if(n(this).is(":first-child"))return n(this).siblings().last().trigger("focus"),!1}else if(n(this).is(":last-child"))return n(this).siblings().first().trigger("focus"),!1;break;case n.ui.keyCode.ENTER:t.cancelSearch();var f=n(q.target).closest(".search-item-container");t._selectSearchResultNode(n(this))}});this.searchBar.element.on("keyup",function(q){switch(q.keyCode){case n.ui.keyCode.TAB:var r=t.element.find(".search-item-container");if(r.length>0)r.first().trigger("focus");else return t.searchBar.element.find(".SourceCode-Forms-Controls-Web-TextBox").trigger("focus"),!1}return!1})},cancelSearch:function(){this.stopSearch=!0},selectSearchResultItem:function(){this.cancelSearch();var n=this.element.find(".search-item-container");if(n.length===1){var t=n.eq(0);this._selectSearchResultNode(n)}},hoveredNode:null,_mouseOver:function(n){var t=document.elementFromPoint(n.clientX,n.clientY);if(t!==null)if(t.classList.contains("header")||t.classList.contains("text")||t.classList.contains("content")||t.classList.contains("image")||t.classList.contains("expander")||t.classList.contains("image-container")){var q=this.Nodes.getNode(t);if(q!==null){if(checkExists(this.hoveredNode)&&this.hoveredNode!==q&&!this.hoveredNode.classList.contains("selected")){var r=this.Nodes.getData(this.hoveredNode);this.Nodes.applyImage(this.hoveredNode,r.source.icon);this.hoveredNode=null}q.classList.contains("selected")||(this.Nodes.applyIconState(q,TreeIconState.Hover),this.hoveredNode=q)}}else if(checkExists(this.hoveredNode)&&this.hoveredNode!==q&&!this.hoveredNode.classList.contains("selected")){var r=this.Nodes.getData(this.hoveredNode);this.Nodes.applyImage(this.hoveredNode,r.source.icon);this.hoveredNode=null}},_bindEvents:function(){this.element[0].addEventListener("mouseover",this._mouseOver.bind(this));this.element.on("click",this.onClick.bind(this));this.element.on("focus",function(n){this._focusTree(n)}.bind(this));this.element.on("blur",function(){this.element[0].classList.remove("focus");for(var t=this.element[0].querySelectorAll(".focus"),n=0,q=t.length;n<q;n++)t[n].classList.remove("focus");this.focusedElement=null;this.receivedFocus=!1}.bind(this));this.element.on("keydown",this._handleKeyDown.bind(this));this.element.on("dblclick",this.onDoubleClick.bind(this));if(this.options.showSearch)this.element.find(".search-bar").on("keydown",this._handleKeyDownSearchBar.bind(this))},_handleKeyDownSearchBar:function(n){n.stopPropagation()},_focusTree:function(){if(this.options.selectionType===TreeSelectionType.Single){var t=this.Nodes.getSelectedNode();if(t!==null){this._shiftFocus(t);return}}if(this.Nodes.hasChildNodes(null)){var t=this.Nodes.getSelectedNode();if(t!==null)t.classList.add("focus"),this.focusedElement=t;else if(this.focusedElement===null){var q=this.Nodes.getChildNodes(null)[0];q!==null?(n(q).addClass("focus"),this.focusedElement=q):this.focusedElement=null}}},_handleKeyDown:function(t){switch(t.which){case n.ui.keyCode.TAB:if(this.options.showSearch&&!t.shiftKey){var s=this.element.find(".tree-body");if(!s.hasClass("hidden"))return this.element.find(".cp-searchbar").find(".SourceCode-Forms-Controls-Web-TextBox").trigger("focus").trigger("select"),!1}return!0;case this.KEY_DOWN_ARROW:if(this.focusedElement!==null){for(var q=this.element[0].querySelectorAll("li"),r=-1,u=0,e=q.length;u<e;u++)if(q[u]===this.focusedElement){r=u;break}if(r!==-1)while(r<q.length-1){var f=q[r+1];if(!this.Nodes.isCollapsed(f)){this._shiftFocus(f);this._setSelectedNodeToTop(f);break}r++}}break;case this.KEY_UP_ARROW:if(this.focusedElement!==null){for(var q=this.element[0].querySelectorAll("li"),r=-1,u=0,e=q.length;u<e;u++)if(q[u]===this.focusedElement){r=u;break}if(r!==-1)while(r>0){var f=q[r-1];if(!this.Nodes.isCollapsed(f)){this._shiftFocus(f);this._setSelectedNodeToTop(f);break}r--}}break;case this.KEY_LEFT_ARROW:if(this.focusedElement!==null)if(this.Nodes.isExpanded(this.focusedElement))this.Nodes.collapseNode(this.focusedElement);else{var o=this.Nodes.getParentNode(this.focusedElement);o!==null&&this._shiftFocus(o)}break;case this.KEY_RIGHT_ARROW:if(this.focusedElement!==null&&!this.Nodes.isLeaf(this.focusedElement))if(this.Nodes.isExpanded(this.focusedElement)){if(this.Nodes.hasChildNodes(this.focusedElement)){var q=this.Nodes.getChildNodes(this.focusedElement);this._shiftFocus(q[0])}}else this.Nodes.expandNode(this.focusedElement,!0);break;case this.KEY_HOME:var q=this.Nodes.getChildNodes(null);q.length>0&&this._shiftFocus(q[0]);break;case this.KEY_END:var q=this.Nodes.getChildNodes(null);q.length>0&&this._shiftFocus(q[q.length-1]);break;case this.KEY_SPACEBAR:this.focusedElement!==null&&(this.options.selectionType===TreeSelectionType.Single?this.Nodes.selectNode(this.focusedElement,!1):this.Nodes.isChecked(this.focusedElement)?this.Nodes.uncheckNode(this.focusedElement):this.Nodes.checkNode(this.focusedElement));break;default:return!0}return!1},_shiftFocus:function(n){if(!checkExists(n))throw Error("Argument 'newNode' must exist");checkExists(this.focusedElement)&&this.focusedElement.classList.remove("focus");n.classList.add("focus");this.focusedElement=n;this.Nodes.isCollapsed(n)&&this.Nodes.expandFromNode(n);this.Nodes.isNodeInView(n)||this._setSelectedNodeToTop(n)},_setSelectedNodeToTop:function(n){var t=this.element.find(".tree-body");t.scrollTop(n.offsetTop-t[0].offsetTop-5)},_unbindEvents:function(){this.element.off("click");this.element.off("focus");this.element.off("dblclick")},_placeDisableOverlay:function(){var n=this.element.find(".disable-overlay");n.hasClass("hidden")&&(n.removeClass("hidden"),n[0].style.height="{0}px".format(this.element.find(".stylewrapper")[0].clientHeight),n[0].style.width="100%")},setWidth:function(n){var q=n;n.indexOf("%")<0&&n.indexOf("px")<0&&(q=n+"px");var t=null;t=this.options.designTime?this.element.find(".stylewrapper"):this.element;t!==null&&(t[0].style.width=q)},setHeight:function(n){var q=n;n.indexOf("%")<0&&n.indexOf("px")<0&&(q=n+"px");var t=null;t=this.options.designTime?this.element.find(".stylewrapper"):this.element;t!==null&&(t[0].style.height=q,this.updateContainerHeights())},updateContainerHeights:function(){var n=this.element.outerHeight(),q=this.element.find(".stylewrapper")[0].style,t=parseInt(q.borderTopWidth)+parseInt(q.borderBottomWidth);if(isNaN(t)&&(t=0),this.options.showSearch){var f=SourceCode.Forms.Controls.Web.ControlPack.Utils.MeasureControlHeight(this.element.find(".search-bar"));n=n-f;var r=this.element[0].querySelector(".search-results");r!==null&&(n=n-t,r.style.height=n+"px")}var u=this.element[0].querySelector(".tree-body");u!==null&&(n=this.options.showSearch?n-t:n-2,u.style.height=n+"px")},setParentEnabled:function(n){n?this.options.isEnabled?this.setEnabled(!0):this.setEnabled(!1):this.setEnabled(!1)},setEnabled:function(n){n=this._ensureBoolean(n);var q=this.element.find(".disable-overlay"),t=this.element.find(".tree-body label.input-control.checkbox");if(t.data("ui-checkbox")||t.checkbox(),n)this.element.removeClass("disabled"),q.addClass("hidden"),this._bindEvents(),t.checkbox("enable"),this.element.off(),this._bindEvents(),this.element.find(".stylewrapper")[0].classList.remove("disabled");else{this.element.addClass("disabled");this._placeDisableOverlay();this._unbindEvents();t.checkbox("disable");var r=this;this.element.on("keydown keyup mousedown mouseup click dblclick",function(){return!1});this.element.find(".stylewrapper")[0].classList.add("disabled")}},setParentReadOnly:function(n){n?this.options.isReadOnly?this.setReadOnly(!0):this.setReadOnly(!1):this.setReadOnly(!1)},setReadOnly:function(n){n=this._ensureBoolean(n);n?this.element.find("li > div > span.header").addClass("read-only"):this.element.find("li > div > span.header").removeClass("read-only")},setParentVisibility:function(n){n?this.options.isVisible?this.setVisibility(!0):this.setVisibility(!1):this.setVisibility(!1)},setVisibility:function(n){n=this._ensureBoolean(n);this.element[0].style.display=n?"":"none"},setToolTip:function(n){this.element[0].setAttribute("title",n)},setWatermark:function(n){var t=this.element.find("span.watermark");t.length>0&&(n===undefined&&(n="No items to display"),t[0].innerHTML=n)},setTabIndex:function(n){if(this.isReadOnly()||!this.isEnabled()){this.element[0].setAttribute("tabIndex",-1);return}var t=parseInt(n,10);(t>=-1||t<=32767)&&this.element[0].setAttribute("tabIndex",t)},setStyle:function(t){var r=n(n.parseXML(t)),g=r.find("Border").find("Default").text(),nt,tt,qt,rt,ut,ft,et,ot,st,ht,ct,lt,at,vt,yt;if(g.length===0){var p=r.find("Border").find("Top");rt=p.find("Width").text();ut=p.find("Color").text();ft=p.find("Style").text();var w=r.find("Border").find("Bottom");et=w.find("Width").text();ot=w.find("Color").text();st=w.find("Style").text();var b=r.find("Border").find("Left");ht=b.find("Width").text();ct=b.find("Color").text();lt=b.find("Style").text();var k=r.find("Border").find("Right");at=k.find("Width").text();vt=k.find("Color").text();yt=k.find("Style").text()}else{var d=r.find("Border").find("Default");nt=d.find("Width").text();tt=d.find("Color").text();qt=d.find("Style").text()}var u=r.find("Margin").find("Default").text(),f,e,o,s;f=r.find("Margin").find("Top").text();f=f.length>0?f:u;e=r.find("Margin").find("Bottom").text();e=e.length>0?e:u;o=r.find("Margin").find("Left").text();o=o.length>0?o:u;s=r.find("Margin").find("Right").text();s=s.length>0?s:u;var h=r.find("Padding").find("Default").text(),c,l,a,v;c=r.find("Padding").find("Top").text();c=c.length>0?c:h;l=r.find("Padding").find("Bottom").text();l=l.length>0?l:h;a=r.find("Padding").find("Left").text();a=a.length>0?a:h;v=r.find("Padding").find("Right").text();v=v.length>0?v:h;var y=r.find("Font"),pt=y.find("Family").text(),wt=y.find("Size").text(),bt=y.find("Color").text(),kt=y.find("Style").text(),dt=y.find("Weight").text(),gt=r.find("BackgroundColor").text(),q=this.element[0].querySelector(".stylewrapper").style;g.length!==0?(q.borderWidth=nt,q.borderColor=tt,q.borderStyle=qt):(q.borderTopWidth=rt,q.borderTopColor=ut,q.borderTopStyle=ft,q.borderBottomWidth=et,q.borderBottomColor=ot,q.borderBottomStyle=st,q.borderLeftWidth=ht,q.borderLeftColor=ct,q.borderLeftStyle=lt,q.borderRightWidth=at,q.borderRightColor=vt,q.borderRightStyle=yt);q.margin=u;q.marginTop=f;q.marginBottom=e;q.marginLeft=o;q.marginRight=s;q.padding=h;q.paddingTop=c;q.paddingBottom=l;q.paddingLeft=a;q.paddingRight=v;q.fontFamily=pt;q.fontSize=wt;q.color=bt;q.fontStyle=kt;q.fontWeight=dt;q.backgroundColor=gt;var nq=this.element.find(".disable-overlay");nq[0].style.width="100%";this.ensureStyle()},ensureStyle:function(){this.ensureFontStyle()},ensureFontStyle:function(){for(var q=this.element.find(".stylewrapper")[0].style,t=this.element.find(".text"),n=0,r=t.length;n<r;n++)t[n].style.fontFamily=q.fontFamily,t[n].style.fontSize=q.fontSize,t[n].style.color=q.color,t[n].style.fontStyle=q.fontStyle,t[n].style.fontWeight=q.fontWeight},generatePreviewTree:function(){var n=this.element.find(".tree-body");n.find(".watermark").hide();var r=this.getTemplate("TreeNodeContainer");n.append(r.content);var t=this.getTemplate("TreeNode");t.setToken("header-text","Parent");t.setToken("PART-SF-CheckBox","");t.setToken("node-container","");t.setToken("if-icon-shown","");var q=n.find(".nodes");q.append(t.content);q.append(t.content);n.find(".image-container").remove();n.find(".node-container").eq(0).addClass("root, first");n.find(".node").addClass("collapsed")},onClick:function(n){if(checkExists(n.target)){var t=jQuery(n.target);if(t[0].tagName!=="SPAN"||!t.parent().hasClass("watermark")){if(!this.element.find(".search-results").hasClass("hidden")){this.cancelSearch();var r=jQuery(n.target).closest(".search-item-container");this._selectSearchResultNode(r)}if(t[0].tagName==="SPAN"&&t.hasClass("expander")){var q=this.Nodes.getNode(t);if(q.classList.contains("empty"))return;var u=this.Nodes.getData(q);if(u===null)return null;this.Nodes.isExpanded(q)?this.Nodes.collapseNode(q):this.Nodes.expandNode(q,!0)}else if(this.Nodes.isCheckBox(t)){if(n.preventDefault(),!this.isReadOnly()){var q=this.Nodes.getNode(t);this.Nodes.isChecked(q)?this.Nodes.uncheckNode(q):this.Nodes.checkNode(q,{fromClick:!0})}}else if(this.Nodes.inContentClickableArea(t[0])&&!this.isReadOnly()){var q=this.Nodes.getNode(t);if(!checkExists(q))return;raiseEvent(this.element[0].getAttribute("id"),"Control","Changing");var u=this.Nodes.getData(q);this.Nodes.selectNode(t)}}}},onDoubleClick:function(n){var t=n.target;if(t.tagName==="SPAN"&&t.parentNode.tagName==="LABEL")n.preventDefault();else if(this.Nodes.inContentClickableArea(t)){raiseEvent(this.element[0].getAttribute("id"),"Control","Double-Clicked");var q=this.Nodes.getNode(t);if(q.classList.contains("empty"))return;this.Nodes.isExpanded(q)?this.Nodes.collapseNode(q):this.Nodes.expandNode(q,!0)}},onExecute:function(n){var t=n.methodName.toUpperCase();switch(t){case"POPULATE":this.Population.populateTree();break;case"EXPANDALL":this.Methods.expandAll();break;case"COLLAPSEALL":this.Methods.collapseAll();break;case"EXPANDNODE":this.Methods.expandNode(n);break;case"COLLAPSENODE":this.Methods.collapseNode(n);break;case"CLEARSELECTION":this.Methods.handleMethod(n);break;case"FINDNODE":this.Methods.handleMethod(n);break;case"REFRESHNODE":this.Methods.handleMethod(n);break;case"FOCUS":this.element.trigger("focus");break;case"SELECTALLNODE":this.Methods.selectAllNode(n);break;case"SELECTNODES":this.Methods.selectNodes(n);break;case"POPULATESELECTEDNODES":this.Methods.populateSelectedNodes(n);break;case"SELECTNODE":this.Methods.selectNode(n);break;case"POPULATENODE":this.Methods.populateNode(n)}},onSetItems:function(n){this.Population.requestReceived(n)},onSettingItems:function(n){n.modalizeView=!1;var h=this.Population.currentRequest;if(h!==null){var t=h.source;if(t.parentProperty!==SourceCode.Forms.Controls.Web.TreeView.CustomValue&&h.node===null&&h.source.recursive===!0){var qt=viewControllerDefinition,v=qt.selectSingleNode("Controllers/Controller/Fields/Field[@ObjectID='{0}' and PropertyName='{1}']".format(t.id,t.parentProperty)),y=null,e=null;if(v!==null)y=v.getAttribute("ID"),e=v.selectSingleNode("PropertyType").text.toLowerCase();else return;var p=this.element[0].getAttribute("ID"),w=p.substring(p.lastIndexOf("_")+1,p.length),b=!0,s,q,k=null,c=n.brokerPackageXML;if(c!==null&&c.length>0&&(q=c[0].smartobject,q!==null&&q.method!==null&&(k=q.method.filter)),!checkExists(k)){var r=parseXML("<Filter><\/Filter>");s=r.documentElement;var u=this.Population.recursiveParentValues[t.id];if(checkExists(u)&&u.length>0){if(u.length==1)if(u[0]===this.DBNULL)b=!1,q.properties[t.parentProperty].value="",q.properties[t.parentProperty].cleared="true";else{var d=!0,g=q,nt="External";checkExists(g)&&(d=g.resultName.indexOf("Association")==-1,d||(nt="Association"));s=parseXML('<Filters><Filter isSimple="True"><Equals><Item SourceType="ObjectProperty" SourceID="{5}_{0}_{1}.{2}" DataType="{3}" Name="{1}_{2}">{2}<\/Item><Item SourceType="Value"><PreviousValue>{4}<\/PreviousValue><OriginalValue><SourceValue><Item SourceType="Value">{4}<\/Item><\/SourceValue><\/OriginalValue><SourceValue>{4}<\/SourceValue><\/Item><\/Equals><\/Filter><\/Filters>'.format(w,t.id,t.parentProperty,e,u[0],nt)).documentElement}else{s=r.createElement("Filters");var tt=r.createElement("Filter");s.appendChild(tt);for(var l=null,o=0;o<u.length;o++){var a=r.createElement("Or");l!==null&&a.appendChild(l);var f=r.createElement("Equals");a.appendChild(f);f.appendChild(this._createObjectPropertyItem(r,t.id,w,y,t.parentProperty,e));f.appendChild(this._createValueItem(r,u[o],e));o==0&&(f=r.createElement("Equals"),a.appendChild(f),f.appendChild(this._createObjectPropertyItem(r,t.id,w,y,t.parentProperty,e)),f.appendChild(this._createValueItem(r,u[o+1],e)),o++);l=a}tt.appendChild(l)}if(q.method.filter=s.xml,b){var rt=q.properties;rt!==null&&delete q.properties}}return c}}}},getValue:function(n){if(this.options.saveAsXml){var t=parseXML("<collection/>"),q=null,u=null,r=null;if(this.options.selectionType===TreeSelectionType.Single){var h=this.Nodes.getSelectedNode();if(h!==null){var f=this.Nodes.getData(h).source;q=t.createElement("object");q.setAttribute("parentid",f.id);q.setAttribute("parenttype","Object");var u=t.createElement("fields"),r=t.createElement("field");r.setAttribute("name",f.idProperty);var e=t.createElement("value");e.appendChild(t.createTextNode(this.options.path));r.appendChild(e);u.appendChild(r)}else return null}else{var o=this.element.find("li label.checkbox.checked");if(o.length>0){u=t.createElement("fields");for(var s=0,l=o.length,s=0;s<l;s++){var c=this.Nodes.getNode(o[s]),a=this.Nodes.getData(c),f=a.source;q=t.createElement("object");q.setAttribute("parentid",f.id);q.setAttribute("parenttype","Object");var r=t.createElement("field");r.setAttribute("name",f.idProperty);var e=t.createElement("value");e.appendChild(t.createTextNode(this.Nodes.getPath(c,"id")));r.appendChild(e);u.appendChild(r)}}else return null}return t.documentElement.appendChild(q),q.appendChild(u),t.documentElement.xml}return n.ForValidation===!0?this.options.selectionType===TreeSelectionType.Multiple?this.options.value.split(this.options.delimiter)[0]:this.options.value:this.options.path!==null?this.options.path:""},_handleValidation:function(){var r=this,t=this.element,q="invalid";n(document).on("mouseenter","#"+t.prop("id")+" .stylewrapper."+q,function(){var q=jQuery("#"+t[0].id+"_Tooltip");UtilitiesHelper.setToolTipPosition(q,n(this));q.show()});n(document).on("mouseleave","#"+t.prop("id")+" .stylewrapper."+q,function(){var n=jQuery("#"+t[0].id+"_Tooltip");n.hide()})},validate:function(n){var t=this.element.find(".stylewrapper");n.DataType?(n.Error=!1,n.DataType=null):checkExists(n.ValidationSettings)&&n.ValidationSettings.isRequired===!0&&(!checkExists(n.ignoreReadOnlyControls)||n.ignoreReadOnlyControls.toLowerCase()!="true"||this.options.isReadonly&&this.options.isParentReadonly)&&(!checkExists(n.ignoreInvisibleControls)||n.ignoreInvisibleControls.toLowerCase()!="true"||this.options.isVisble&&this.options.isParentVisble)&&(!checkExists(n.ignoreDisabledControls)||n.ignoreDisabledControls.toLowerCase()!="true"||this.options.isEnabled&&this.options.isParentEnabled)&&(checkExistsNotEmpty(this.options.value)||(n.IsRequired=!0,n.RequiredError=n.ValidationSettings.requiredMessage,n.Error=!0));UtilitiesHelper.showValidationMessage(t,n)},clear:function(n){var t=this.element.find(".node-container > .nodes").first();if(t.length>0)t.empty();else return;var q=this.element.find("div.watermark");n?q.removeClass("hidden"):q.addClass("hidden")},set:function(n,t){if(this.options[t]=n,n!==undefined&&checkExists(this.options.definition)&&this.options.definition.length!==0&&this.isPopulating!==!0){if(this.Nodes.clearSelection(),n===null||n===""){this.Nodes.clearOptionsValuePath();raiseEvent(this.element[0].getAttribute("ID"),"Control","OnChange");return}var q=[],f,e,r;if(this.options.saveAsXml){var s=tryParseXML(n);if(s.xml!=="")for(var o=s.selectNodes("collection/object/fields/field"),u=0,h=o.length;u<h;u++){var l=o[u].text;u===0&&(t=TreeUtil.detectFormat(l,this.options.pathSeparator));q.push(o[u].text)}else try{if(this.options.selectionType===TreeSelectionType.Multiple)for(f=n.split(this.options.delimiter),r=0;r<f.length;r++)q.push(f[r]);else e=n.split(this.options.delimiter),e.length>0&&q.push(e[0])}catch(v){return}}else try{if(this.options.selectionType===TreeSelectionType.Multiple)for(f=n.split(this.options.delimiter),r=0;r<f.length;r++)q.push(f[r]);else e=n.split(this.options.delimiter),e.length>0&&q.push(e[0])}catch(v){return}if(q.length!==0)if((t==="path"||t==="valuePath")&&this.options.selectionType!==TreeSelectionType.Single&&this._trimPaths(q),this.Nodes.clearSelection(),this.nodesToCheck=[],raiseEvent(this.element[0].getAttribute("id"),"Control","Changing"),t==="value")this._selectValue(q);else if(t==="path"||t==="valuePath"){var c=new InternalTree;if(c.create(q,this.options.pathSeparator),this.internalTree=c,this.options.selectionType!==TreeSelectionType.Single){this._trimPaths(q);for(var u=0,h=q.length;u<h;u++){var a=q[u].split(this.options.delimiter);this._selectPaths(a,t,!1)}this._selectInternalNodes(t,null)}else this._selectPaths(q,t,!0)}}},_selectValue:function(n){var t=this;if(!this.Nodes.hasChildNodes(null)){this.Population.populateTree();return}if(n.length>0){var q=n.shift();this.Population.traverseTree({onNode:function(n){var r=n.node,u=t.Nodes.getData(r);u.value.toUpperCase()===q.toUpperCase()&&(n.cancel=!0,t.options.selectionType!==TreeSelectionType.Single?(t.Nodes.checkNode(r),t.Nodes.expandFromNode(r)):t.Nodes.selectNode(r,!0))},onFinished:function(){t.options.selectionType===TreeSelectionType.Multiple&&t._selectValue(n)}})}},_selectInternalNodes:function(n,t){for(var q=this,e=this.Nodes.getChildNodes(t),s=e.length,u=0;u<s;u++){var r=e[u],h=this.Nodes.getChildNodes(r);h.length>0&&this._selectInternalNodes(n,r);var f=this.Nodes.getData(r),c=n=="path"?f.path:f.valuePath,o=this.internalTree._findNode(c,f.level);checkExists(o)&&o.selected&&(q.options.selectionType===TreeSelectionType.Single?q.Nodes.selectNode(r,!0):q.nodesToCheck.push(r))}this._checkNodes(q.nodesToCheck);this._expandNodes(q.nodesToCheck)},_selectPaths:function(n,t,q){var r=this;if(n.length>0){var u=n.shift();if(this.isPopulating){n.splice(0,0,u);var r=this,f=function(u,f){r._selectPaths(n,t,q);r.Population.finishedPopulatingListeners.splice(f,1)};this.Population.finishedPopulatingListeners.push(f);return}this.Population.findNodeByPath({value:u,valueType:t,internalTree:r.internalTree,singlePath:q,pathSeparator:r.options.pathSeparator,onResult:function(u){u.status==TreeFindResult.Found&&(r.options.selectionType===TreeSelectionType.Single?(r.Nodes.selectNode(u.node,!0),u.cancel=!0):(r.nodesToCheck.push(u.node),r._selectPaths.call(r,n,t,q)))}})}else this._checkNodes(r.nodesToCheck),this._expandNodes(r.nodesToCheck)},_getValueToMatch:function(n,t){return t==="path"?"{0},{1}".format(n.idValue,n.source.name):n.value},_expandNodes:function(n){if(n.length>0)for(var q=0,r=n.length;q<r;q++)for(var t=this.Nodes.getParentNode(n[q]);t!==null;)this.Nodes.expandNode(t,!1),t=this.Nodes.getParentNode(t)},_checkNodes:function(n){if(n.length>0)for(var q=n.length,t=0;t<q;t++)t===q-1?this.Nodes.checkNode(n[t],{skipSetValue:!1,checkChildren:!0}):this.Nodes.checkNode(n[t],{skipSetValue:!0,checkChildren:!0})},_containsWatermark:function(){return this.element.find("div.watermark").length>0},expandParents:function(){for(var t=this.Nodes.getChildNodes(null),n,q=t.length;n<q;n++)this.Nodes.expandNode(t[n])},collapseParents:function(){for(var t=this.Nodes.getChildNodes(null),n,q=t.length;n<q;n++)this.Nodes.collapseNode(t[n])},getResource:function(n){return this.element[0].getAttribute(n)},_createDesignIconMappings:function(){var f=this,q=SourceCode.Forms.Designers.View.viewDefinitionXML;if(checkExists(q)&&this.element.parent().length>0){var t=this.element.parent().parent()[0].id;if(t!==""){var n=q.selectSingleNode("SourceCode.Forms/Views/View/Controls/Control[@ID='{0}']".format(t));if(n!==null){var r=n.selectSingleNode("Properties/Property[Name='IconSourceId']/Value");if(r!==null)SFIconConfig.getIconMappings("ID",r.text,t);else{var u=n.selectSingleNode("Properties/Property[Name[text()='InitEventCreated']]/Value");if(u!==null&&u.text.toUpperCase()==="TRUE")return;if(checkExists(SourceCode.Forms.Designers.View.DragDrop._newControlIds)&&SourceCode.Forms.Designers.View.DragDrop._newControlIds.indexOf(t)>-1){var e=this.systemIconSmartObject;SFIconConfig.getIconMappings("NAME",e,t,function(r){if(r.dataRetrieved){TreeUtil.updateProperty(q,n,"IconSource",r.displayName);TreeUtil.updateProperty(q,n,"IconSourceId",r.id);var u=jQuery("#{0}".format(t)).data("mappingData");checkExists(u.method)&&(SourceCode.Forms.Settings.ObfuscateMethodNames&&(f.options.iconMethod=r.obfuscatedMethodName),TreeUtil.updateProperty(q,n,"IconMethod",u.method));checkExists(SourceCode.Forms.Designers.View.propertyGrid)&&(SourceCode.Forms.Designers.View.propertyGrid.valuexml="<Controls>"+n.xml+"<\/Controls>",SourceCode.Forms.Designers.View.DesignerTable.View.PropertyGrid.refresh())}})}}}}}},isEnabled:function(){return this.options.isParentEnabled&&this.options.isEnabled},isReadOnly:function(){return this.options.isParentReadOnly||this.options.isReadOnly},_ensureBoolean:function(n){var t=n;if(typeof n=="string"){var q=n.toUpperCase();t=q==="TRUE"||q==="YES"?!0:!1}else typeof n=="number"?t=t>0?!0:!1:typeof n=="boolean"||(t=!1);return t},_createValueItem:function(n,t,q){var r=n.createElement("Item");r.setAttribute("SourceType","Value");var e=n.createElement("PreviousValue");e.appendChild(n.createTextNode(t));r.appendChild(e);originalValueNode=n.createElement("OriginalValue");r.appendChild(originalValueNode);var u=n.createElement("SourceValue");originalValueNode.appendChild(u);var f=n.createElement("Item");return f.setAttribute("DataType",q),f.setAttribute("SourceType","Value"),f.appendChild(n.createTextNode(t)),u.appendChild(f),u=n.createElement("SourceValue"),u.appendChild(n.createTextNode(t)),r.appendChild(u),r},_createObjectPropertyItem:function(n,t,q,r,u,f){var e=n.createElement("Item");return e.setAttribute("id",t),e.setAttribute("Name","{0}_{1}".format(t,u)),e.setAttribute("ItemType","ViewField"),e.setAttribute("SubType",f),e.setAttribute("Guid",r),e.setAttribute("DisplayName",u),e.setAttribute("Data",u),e.setAttribute("ObjectGuid",t),e.setAttribute("PropertyName",u),e.setAttribute("icon",f),e.setAttribute("SourceType","ObjectProperty"),e.setAttribute("SourceID","External_{0}_{1}.{2}".format(q,t,u)),e.setAttribute("DataType",f),e.appendChild(n.createTextNode(u)),e},_fixDefinition:function(){var t=this.options.definition;if(checkExists(t)&&t.length>0)for(var q=0;q<t.length;q++){var n=t[q];checkExists(n.recursive)||(n.recursive=!1);n.parentSmartObject===n.uid&&(n.recursive=!0,n.parentSmartObject="(NONE)");checkExists(n.value)&&(n.valueProperty=n.value,delete n.value);checkExists(n.idProperty)||(n.idProperty=n.valueProperty)}},_selectSearchResultNode:function(n){if(n.length>0){var t=n.data("tag");this.toggleSearchResults(!1);this.Nodes.expandFromNode(t);this.options.isReadOnly||(this.options.selectionType===TreeSelectionType.Single?(raiseEvent(this.element[0].getAttribute("id"),"Control","Changing"),this.Nodes.selectNode(t),this.element.trigger("focus")):(this.Nodes.selectNode(t),this.element.trigger("focus"),this.Nodes.checkNode(t)))}},_trimPaths:function(n){for(var q=[],e=n.length,t=0;t<e;t++)if(!(q.indexOf(n[t])>-1))for(var u=n[t].split(this.options.pathSeparator),r=0;r<e;r++)if(t!=r){var f=n[r].split(this.options.pathSeparator);if(u.length===f.length)continue;else if(u.length<f.length&&this._isPartial(f,u)){if(q.indexOf(n[t])<0){q.push(n[t]);break}}else if(u.length>f.length&&this._isPartial(u,f)&&q.indexOf(n[r])<0){q.push(n[r]);break}}e=q.length;for(var t=0;t<e;t++){var o=q[t];n.splice(n.indexOf(o),1)}},_isPartial:function(n,t){for(var q=0;q<t.length;q++)if(n[q].toUpperCase()!==t[q].toUpperCase())return!1;return!0},bind:function(n,t,q){for(var r=0,u=this.events.length;r<u;r++){var f=events[r];if(f.callback===t)return}this.events.push({name:n,callback:t,data:q})},unbind:function(n,t){if(checkExists(t)){for(var q=0,r=this.events.length;q<r;q++)if(this.events[q].callback===t){this.events.splice(q,1);break}}else for(var q=0,r=this.events.length;q<r;q++)this.events[q].name===n&&(this.events.splice(q,1),q--,r--)},trigger:function(n,t){for(var q=0,u=this.events.length;q<u;q++){var r=this.events[q];r.name===n&&r.callback.call(this,t)}},destroy:function(){n.sfc.baseWidget.prototype.destroy.call(this)}});n.sfc.SFCTreeView.prototype.base=n.sfc.baseWidget.prototype;n(document).ready(function(){for(var t=jQuery(".SFC.SourceCode-Forms-Controls-Web-ControlPack-TreeView"),n=0,q=t.length;n<q;)jQuery(t[n]).SFCTreeView(),n++})})(jQuery);
/*!
 SourceCode.Forms.Controls.Web.ControlPack.Scripts.Config.TabHelper.js (Embedded resource)
*/
var SFTreeTabHelper;SourceCode.Forms.Controls.Web.TreeTabHelper=SFTreeTabHelper={tab:null,configTab:null,iconTab:null,selectedTab:null,callback:null,configBody:null,iconBody:null,initialize:function(n,t,q,r,u){this.configTab=jQuery(n);this.iconTab=jQuery(t);this.configBody=jQuery(q);this.iconBody=jQuery(r);this.iconBody.hide();this.callback=u;this.tab=jQuery("#SFTreeViewConfig_TabBox");this.selectedTab=0;this.configTab.on("click",this.selectTab);this.iconTab.on("click",this.selectTab)},selectTab:function(n){var t=SFTreeTabHelper,q=jQuery(n.target).closest("a.tab"),r=t.tab.find(".selected");r[0]!==q[0]&&(r.removeClass("selected"),q.addClass("selected"),q[0]==t.configTab[0]?(t.iconBody.hide(),t.configBody.show(),checkExists(t.callback)&&t.callback("source")):(t.iconBody.show(),t.configBody.hide(),checkExists(t.callback)&&t.callback("icon")))},activate:function(){var n=SFTreeTabHelper,t=n.tab.find(".selected");t[0]===n.iconTab[0]?(n.iconBody.show(),n.configBody.hide()):(n.iconBody.hide(),n.configBody.show())}};
/*!
 SourceCode.Forms.Controls.Web.ControlPack.Scripts.Config.SFTreeIconTab.js (Embedded resource)
*/
var SFTreeIconTab={treeConfig:null,listBox:null,callback:null,images:null,initialize:function(n,t){SFTreeIconTab.treeConfig=n;SFTreeIconTab.callback=t},activate:function(){if(checkExists(this.treeConfig.selectedNode)&&(this.updateControlStates(),!this.treeConfig.loading)){var n=this.treeConfig.getSelectedSource();n===null||n.icon==="none"?(this.treeConfig.radIconNone.radiobutton("check"),TreeDependencyHelper.clearErrorOnField(this.treeConfig.iconProperty[0])):n!==null&&(n.icon==="static"?(SFTreeIconTab.selectStatic(),TreeDependencyHelper.clearErrorOnField(this.treeConfig.iconProperty[0])):n.icon==="dynamic"&&SFTreeIconTab.selectDynamic())}},updateControlStates:function(){var n=this;if(this.treeConfig.radIconNone.radiobutton("disable"),this.treeConfig.radIconSingle.radiobutton("disable"),this.treeConfig.radIconSmartObject.radiobutton("disable"),this.treeConfig.radIconConditional.radiobutton("disable"),this.treeConfig.iconProperty.dropdown("disable"),this.treeConfig.staticIcon.closest(".input-control.select-box.lookup-box.icon").addClass("disabled"),checkExistsNotEmpty(this.treeConfig.iconSource)){this.treeConfig.radIconNone.radiobutton("enable");this.treeConfig.radIconSingle.radiobutton("enable");this.treeConfig.radIconSmartObject.radiobutton("enable");this.treeConfig.staticIconButton.off();this.treeConfig.staticIconButton.on("click",SFTreeIconTab.showImages)}else jQuery("#SFTreeViewConfig_IconTabBody").addClass("disabled"),this.treeConfig.staticIconButton.off();var t=TreeDependencyHelper.checkIconBadge(this.treeConfig.propertiesXml,this.treeConfig.iconSource);if(t){var q=this.treeConfig.selectedNode.data("source");switch(q.icon.toUpperCase()){case"STATIC":TreeDependencyHelper.setErrorOnField({element:$(n.treeConfig.idStaticIcon)[0],className:"",largeIcon:!0})}}},setFromSource:function(n){var t=SFTreeIconTab.treeConfig;t.radIconSingle.radiobutton("uncheck");t.radIconSmartObject.radiobutton("uncheck");t.radIconNone.radiobutton("uncheck");t.iconProperty.dropdown("disable");t.staticIcon.closest(".input-control.select-box.lookup-box.icon").addClass("disabled");n.icon==="static"?(t.radIconSingle.radiobutton("check"),t.staticIcon.closest(".input-control.select-box.lookup-box.icon").removeClass("disabled"),t.staticIcon.val(n.staticValue)):n.icon==="dynamic"?(t.radIconSmartObject.radiobutton("check"),t.iconProperty.dropdown("enable"),t.iconProperty.dropdown("SelectedValue",n.iconProperty)):t.radIconNone.radiobutton("check")},showImages:function(n){if(!$(n.target).closest(".lookup-box").hasClass("disabled")){var t=SFTreeIconTab;popupManager.showPopup({id:"SFTreeConfig_IconSelector",buttons:[{text:Resources.WizardButtons.OKButtonText,click:SFTreeIconTab.popupOkClick.bind(SFTreeIconTab)},{id:"iconPopupConfig_Cancel",text:Resources.WizardButtons.CancelButtonText}],closeWith:"iconPopupConfig_Cancel",headerText:ControlResources.SourceCode.Forms.Controls.Web.ControlPack.Properties.Tree.SelectImageForTreeIcon,draggable:!0,content:jQuery('<div id="SFTreeViewConfig_List" class="sfc-config-listbox-main"><ul class="sfc-config-listbox-container"><\/ul><span>Loading...<\/span><\/div><\/div>'),width:280,height:420,onClose:function(){},onShow:function(){jQuery("#SFTreeConfig_IconSelector").showBusyModal(!0);t.listBox=jQuery("#SFTreeViewConfig_List");t.listBox.on("click",function(n){var q=jQuery(n.target);(q.hasClass("sfc-config-listbox-item")||q.hasClass("sfc-config-listbox-icon")||q.hasClass("sfc-config-listbox-text"))&&(t.listBox.find("li.selected").removeClass("selected"),q[0].tagName!=="LI"&&(q=q.parent()),jQuery(q).addClass("selected"))});t.getIcons(function(n){if(jQuery("#SFTreeConfig_IconSelector").showBusyModal(!1),n.status==="success"){if(!checkExists(t.images)||t.images.length===0){popupManager.closeLast();popupManager.showWarning("[No images found]");return}var u=t.treeConfig.selectedNode.data("source");t.listBox.find("span").remove();for(var f=!1,e=t.images,o=e.ItemDetails,q=0;q<o.length;q++){var r=o[q],s=t.addItem(r.ID,e.FilePath,r);checkExists(u)&&u.staticValue===r.ID&&(s.addClass("selected"),f=!0)}f||t.listBox.find("li").first().addClass("selected")}else popupManager.closeLast(),popupManager.showWarning(SFTreeConfig.getResource("locInfoCouldNotLoadImages"))})}})}},popupOkClick:function(){var n=SFTreeIconTab,t=SFTreeIconTab.listBox.find(".selected");t.length>0&&checkExists(n.callback)&&n.callback(t.data("info"));popupManager.closeLast()},getIcons:function(n){var r=SFTreeIconTab,q={iconIdProperty:null,iconNameProperty:null,iconImageProperty:null,iconMethod:null,iconSource:null,iconSourceId:null},f=SourceCode.Forms.Designers.View.viewDefinitionXML,u=f.selectSingleNode("//Controls/Control[@ID='{0}']".format(this.treeConfig.controlId)),t=r.treeConfig.propertyXml.selectSingleNode("Controls/Control/Properties/Property[Name='IconSourceId']/Value");t!==null&&(q.iconSourceId=t.text);t=r.treeConfig.propertyXml.selectSingleNode("Controls/Control/Properties/Property[Name='IconSource']/Value");t!==null&&(q.iconSource=t.text);SourceCode.Forms.Settings.ObfuscateMethodNames?q.iconMethod=$("#{0}".format(r.treeConfig.controlId)).find(".SourceCode-Forms-Controls-Web-ControlPack-TreeView").SFCTreeView("option").iconMethod:(t=r.treeConfig.propertyXml.selectSingleNode("Controls/Control/Properties/Property[Name='IconMethod']/Value"),t!==null&&(q.iconMethod=t.text));t=r.treeConfig.propertyXml.selectSingleNode("Controls/Control/Properties/Property[Name='IconId']/Value");t!==null?q.iconIdProperty=t.text:u.selectSingleNode("Properties/Property[Name='IconId']/Value")!==null&&(q.iconIdProperty=u.selectSingleNode("Properties/Property[Name='IconId']/Value").text);t=r.treeConfig.propertyXml.selectSingleNode("Controls/Control/Properties/Property[Name='IconName']/Value");t!==null?q.iconNameProperty=t.text:u.selectSingleNode("Properties/Property[Name='IconName']/Value")!==null&&(q.iconNameProperty=u.selectSingleNode("Properties/Property[Name='IconName']/Value").text);t=r.treeConfig.propertyXml.selectSingleNode("Controls/Control/Properties/Property[Name='IconImage']/Value");t!==null?q.iconImageProperty=t.text:u.selectSingleNode("Properties/Property[Name='IconImage']/Value")!==null&&(q.iconImageProperty=u.selectSingleNode("Properties/Property[Name='IconImage']/Value").text);var e={smartObjectId:q.iconSourceId,smartObjectMethod:q.iconMethod,smartObjectName:"",idProperty:"",nameProperty:q.iconNameProperty,imageProperty:q.iconImageProperty,methodName:"getSpriteImage",desiredWidth:16,desiredHeight:16,returnValueForProperty:q.iconIdProperty,methodEncrypted:!1};$.ajax({url:applicationRoot+"SmartObjectImageStore.handler",dataType:"json",method:"POST",contentType:"application/json; charset=utf-8",data:JSON.stringify(e),success:function(t){r.images=[];checkExists(t)&&t.length!==0?(r.images=t,checkExists(n)&&n({status:"success"})):n({status:"failed"})},error:function(){n({status:"error"})}})},getStaticIconPath:function(n){if(!checkExistsNotEmpty(n))return"";var t=SFTreeIconTab;if(!checkExists(t.images))return"";for(var r=t.images.ItemDetails.length,q=0;q<r;q++)if(t.images.ItemDetails[q].ID.toUpperCase()===n.toUpperCase())return t.images.FilePath;return""},radIconNone_Click:function(n){if(n.ctrlKey&&n.altKey){$(".conditional-field").css("display","block");var t=$(SFTreeIconTab.treeConfig.idRadIconConditional);t.prop("disabled","");t.parent().closest(".input-control").removeClass("disabled");var q=$(SFTreeIconTab.treeConfig.idIconConditionTextArea);q.prop("disabled","");q.parent().closest(".input-control").removeClass("disabled")}SFTreeIconTab.selectNone()},radIconSingle_Click:function(){var t=SFTreeConfig,n=t.getSelectedSource();TreeDependencyHelper.checkIconBadge(SFTreeIconTab.treeConfig.propertiesXml,SFTreeIconTab.treeConfig.iconSource)?(n.icon==="dynamic"||n.icon==="none")&&(popupManager.showWarning(ControlResources.SourceCode.Forms.Controls.Web.ControlPack.Properties.Tree.MissingIconSource),SFTreeIconTab.treeConfig.radIconSingle.radiobutton("uncheck")):SFTreeIconTab.selectStatic()},radIconSmartObject_Click:function(){var t=SFTreeConfig,n=t.getSelectedSource();TreeDependencyHelper.validateSmartObject(n.id,n.validationMessages)?SFTreeIconTab.selectDynamic():(n.icon==="static"||n.icon==="none")&&(popupManager.showWarning(Resources.MessageBox.ListControlPropertyConfigSmartObjectInvalidWarning),SFTreeIconTab.treeConfig.radIconSmartObject.radiobutton("uncheck"))},radIconConditional_Click:function(){SFTreeIconTab.selectConditional()},iconProperty_Changed:function(){var n=SFTreeConfig,t=n.getSelectedSource();n.loading||t===null||n.clearDependency(t,SourceCode.ControlPack.RefAs.TreeSourceIconProperty,$(this),{type:"dropdown",oldValue:t.iconProperty});n.setSourceProperty("iconProperty",n.iconProperty.dropdown("SelectedValue"))},selectNone:function(){var n=SFTreeConfig;n.radIconSingle.radiobutton("uncheck");n.radIconSmartObject.radiobutton("uncheck");n.radIconConditional.radiobutton("uncheck");n.staticIcon.closest(".input-control.select-box.lookup-box.icon").addClass("disabled");n.iconProperty.dropdown("disable");n.selectedNode.data().source.icon="none";n.previewTree.setNodeIcon(n.selectedNode,"");var t=n.selectedNode.data("source");n.setSourceProperty("icon","none");delete t.staticIcon;delete t.staticValue;delete t.conditionalIcon},selectStatic:function(){var n=SFTreeConfig;n.radIconNone.radiobutton("uncheck");n.radIconSmartObject.radiobutton("uncheck");n.radIconConditional.radiobutton("uncheck");n.iconProperty.dropdown("disable");n.staticIcon.closest(".input-control.select-box.lookup-box.icon").removeClass("disabled");var t=n.selectedNode.data("source");n.setSourceProperty("icon","static");delete t.iconProperty;delete t.conditionalIcon},selectDynamic:function(){var n=SFTreeConfig;n.radIconNone.radiobutton("uncheck");n.radIconSingle.radiobutton("uncheck");n.radIconConditional.radiobutton("uncheck");n.iconProperty.dropdown("enable");n.staticIcon.closest(".input-control.select-box.lookup-box.icon").addClass("disabled");var t=n.selectedNode.data("source");n.setSourceProperty("icon","dynamic");n.setSourceProperty("iconProperty",n.iconProperty.dropdown("SelectedValue"));n.previewTree.setNodeIcon(n.selectedNode,"");delete t.staticValue;delete t.conditionalIcon},selectConditional:function(){var n=SFTreeConfig;n.radIconNone.radiobutton("uncheck");n.radIconSingle.radiobutton("uncheck");n.radIconSmartObject.radiobutton("uncheck");n.staticIcon.closest(".input-control.select-box.lookup-box.icon").addClass("disabled");SFTreeConfig.staticIcon.val("");var t=n.selectedNode.data("source");n.iconProperty.dropdown("SelectedValue");n.setSourceProperty("icon","conditional");var q=$(n.idIconConditionTextArea).val();n.setSourceProperty("conditionalIcon",q);delete t.staticValue;delete t.iconProperty},setConditional:function(){var n=SFTreeConfig;if(n.radIconConditional.parent().hasClass("checked")){var t=$(n.idIconConditionTextArea).val();n.setSourceProperty("conditionalIcon",t)}},addItem:function(n,t,q,r){(n===null||n==="")&&(n="[No name]");var f="background-image:url('{0}')".format(t),e='<span class="sfc-config-listbox-icon" style="{0};background-position:{1}px -{2}px"><\/span>'.format(f,q.X,q.Y),o='<li class="sfc-config-listbox-item">{0}<span class="sfc-config-listbox-text">{1}<\/span><\/li>'.format(e,n),u=jQuery(o);u.data("info",{value:n,iconPath:t,x:q.X,y:q.Y});checkExists(r)&&r&&u.addClass("selected");var s=SFTreeIconTab.listBox.find("ul.sfc-config-listbox-container").append(u);return u}};
/*!
 SourceCode.Forms.Controls.Web.ControlPack.Scripts.Config.TreeIconConfig.js (Embedded resource)
*/
(typeof SourceCode=="undefined"||SourceCode===null)&&(SourceCode={});(typeof SourceCode.Forms=="undefined"||SourceCode.Forms===null)&&(SourceCode.Forms={});(typeof SourceCode.Forms.Controls=="undefined"||SourceCode.Forms.Controls===null)&&(SourceCode.Forms.Controls={});(typeof SourceCode.Forms.Controls.Web=="undefined"||SourceCode.Forms.Controls.Web===null)&&(SourceCode.Forms.Controls.Web={});var SFIconConfig;SourceCode.Forms.Controls.Web.TreeIconConfig=SFIconConfig={iconSmartObjectTree:null,propertyXml:null,fullXml:null,callback:null,initialize:function(n,t,q,r,u){var f=SFIconConfig;f.propertyXml=n;f.fullXml=t;f.callback=u;f.iconSmartObjectTree=jQuery('<ul class="tree" style="background:#FFF"><li class="root children open"><a href="javascript:;">Loading...<\/a><\/li><\/ul>').categorytree({objecttypes:"smartobject"});var e=jQuery("<div style='background-color:#FFF;overflow:auto' class='wrapper'><\/div>");e.append(f.iconSmartObjectTree[0]);var o=popupManager.showPopup({id:"SCTreeViewIconConfig_SmartObject",buttons:[{type:"help",click:function(){HelpHelper.runHelp(5007)}},{text:Resources.WizardButtons.OKButtonText,click:f.popupOk_Click},{id:"propertyConfig_DataSourceCancelBtn",text:Resources.WizardButtons.CancelButtonText}],headerText:$("#SFTreeIconConfig").attr("locSelectSmartObjectHeader"),draggable:!0,maximizable:!0,content:e,width:360,height:350,closeWith:"propertyConfig_DataSourceCancelBtn"})},popupOk_Click:function(n){var u=SFIconConfig,t=u.iconSmartObjectTree.tree("find","selected");if(!n.altKey||!n.shiftKey||!n.ctrlKey||t.length!==0){if(checkExists(t)&&t.length>0){if(checkExists(t.metadata())){var q=t.metadata().guid;if(q!==null){var r=!1;if(r=SFTreeConfig.validateAssociation(q,"icon"),!r){var f=jQuery("#SFTreeIconConfig")[0].getAttribute("locWarningSOHasNoImageProperties");popupManager.showWarning(f);return}if(r=SFTreeConfig.validateAssociation(q,"method"),!r){var f=jQuery("#SFTreeIconConfig")[0].getAttribute("locErrorNoListMethod");popupManager.showWarning(f);return}}}}else return;jQuery("#SCTreeViewIconConfig_SmartObject").showBusyModal(!0);var e={id:q,name:t.metadata().name,display:t.find("a").first()[0].innerHTML,useId:!0};u.configureSmartObject(e)}},configureSmartObject:function(n){var q=SFIconConfig,r=parseXML(q.propertyXml),t=r.selectSingleNode("/Controls/Control");TreeUtil.updateProperty(r,t,"IconSource",n.name);TreeUtil.updateProperty(r,t,"IconSourceId",n.id);var u="NAME",f=n.name;checkExists(n.useId)&&n.useId&&(u="ID",f=n.id);q.getIconMappings(u,f,t.getAttribute("ID"),function(n){if(jQuery("#SCTreeViewIconConfig_SmartObject").showBusyModal(!1),q.removeProperty(t,"IconId"),q.removeProperty(t,"IconName"),q.removeProperty(t,"IconImage"),n.dataRetrieved){var s=t.getAttribute("ID"),h=$("#{0}".format(s)).data("mappingData");checkExists(h.method)&&(TreeUtil.updateProperty(t.ownerDocument,t,"IconMethod",h.method),SourceCode.Forms.Settings.ObfuscateMethodNames&&$("#{0}".format(s)).find(".SourceCode-Forms-Controls-Web-ControlPack-TreeView").SFCTreeView("option","iconMethod",n.obfuscatedMethodName))}var c=t.selectSingleNode("Properties/Property[Name = 'Definition']/Value");if(c!==null){for(var f=JSON.parse(c.text),e=0,y=f.length;e<y;e++){var l=f[e];l.icon==="static"&&(l.icon="none")}TreeUtil.updateProperty(t.ownerDocument,t,"Definition",JSON.stringify(f))}var u=TreeUtil.getProperty(t,"IconSource");if(u!==null){var o={type:"Object",name:u.selectSingleNode("Value").text,all:!0};SourceCode.Forms.DependencyHelper.removeAnnotation(u,o)}var a=TreeUtil.getProperty(t,"IconSourceId");if(a!==null){var o={type:"Object",name:u.selectSingleNode("Value").text,all:!0};SourceCode.Forms.DependencyHelper.removeAnnotation(a,o)}var v=TreeUtil.getProperty(t,"IconMethod");if(v!==null){var o={type:"ObjectMethod",name:u.selectSingleNode("Value").text,all:!0};SourceCode.Forms.DependencyHelper.removeAnnotation(v,o)}q.callback(1,r);$(document).on("ajaxComplete.sfcTreeIconSmoSelected",function(){setTimeout(function(){TreeUtil.refreshPropertyGrid(t);$(document).off("ajaxComplete.sfcTreeIconSmoSelected")},0)});popupManager.closeLast()});var e=t.getAttribute("ID");$("#"+e).find(".SourceCode-Forms-Controls-Web-ControlPack-TreeView").SFCTreeView().SFCTreeView("option","skipSetting",!1)},removeProperty:function(n,t){var q=n.selectSingleNode("Properties/Property[Name = '{0}']".format(t));q!==null&&q.parentNode.removeChild(q)},getIconMappings:function(n,t,q,r){jQuery.ajax({url:applicationRoot+"SFCTreeViewHandler.handler",data:{method:"GetSmartObjectData",resultTypes:"ObjectProperties|ObjectMethods",targetType:"Object",targetValueType:n,targetValue:t},type:"post",dataType:"text",global:!1,success:function(n){SFIconConfig.createIconMappingSource.call(SFIconConfig,q,n,r)},error:function(){popupManager.closeLast()}})},createIconMappingSource:function(n,t,q){var r=parseXML(t),w=r.selectSingleNode("Items").getAttribute("SmartObjectId"),b=r.selectSingleNode("Items").getAttribute("ObfuscatedMethodName"),k=jQuery("#{0}".format(n));mappingData={properties:[],imageProperties:[],method:"GetList"};k.data("mappingData",mappingData);var v=r.selectSingleNode("Items/Item[@ItemType='Object']/Items/Item[@ItemType='Method' and @SubType='list']");if(v!==null){var y=v.selectSingleNode("Value");y!==null&&(mappingData.method=y.text)}for(var e=r.selectNodes("Items/Item[@ItemType='Object']/Items/Item[@ItemType='ObjectProperty']"),o=0;o<e.length;o++){var u=e[o],s=u.selectSingleNode("Name").text,h=u.selectSingleNode("DisplayName").text,c=u.getAttribute("SubType");if(u.getAttribute("SubType")==="Image")mappingData.imageProperties.push({display:h,name:s,subType:c});else if(!["File","DateTime","HyperLink","MultiValue","YesNo"].contains(u.getAttribute("SubType"))){var l=document.createElement("option");l.className=c.toLowerCase();l.value=s;l.innerHTML=h;mappingData.properties.push({display:h,name:s,subType:c})}}if(q!=null){var a=null,f=r.selectSingleNode("Items/Item/Name");f!==null&&(a=f.text);var p=a;f=r.selectSingleNode("Items/Item/DisplayName");f!==null&&(p=f.text);q({dataRetrieved:e.length>0,id:w,name:a,displayName:p,obfuscatedMethodName:b})}SourceCode.Forms.Designers.View.ViewDesigner._showControlProperties(!0)},clearProperty:function(n,t,q,r){var u=parseXML(n),h=u.documentElement.selectSingleNode("Control");if(checkExists(h)){var a=h.getAttribute("ID");delete $("#"+a).data().mappingData}for(var c=u.documentElement.selectSingleNode("Control/Properties"),s=u.documentElement.selectNodes("//Property[Name='IconSource' or Name='IconId' or Name='IconImage' or Name='IconName' or Name='IconSourceId' or Name='IconMethod']"),o=0;o<s.length;o++)s[o]!==null&&c.removeChild(s[o]);var l=u.documentElement.selectSingleNode("//Property[Name='Definition']/Value");if(checkExists(l)){for(var f=JSON.parse(l.text),e=0;e<f.length;e++)f[e].icon="none",checkExists(f[e].staticValue)&&(f[e].staticValue="");var v=u.documentElement.selectSingleNode("//Property[Name='Definition']");c.removeChild(v);var y=u.documentElement.selectSingleNode("Control");TreeUtil.addProperty(u,y,"Definition",JSON.stringify(f))}r(1,u)}};
/*!
 SourceCode.Forms.Controls.Web.ControlPack.Scripts.Config.DisplayTemplatePopup.js (Embedded resource)
*/
(typeof SourceCode=="undefined"||SourceCode===null)&&(SourceCode={});(typeof SourceCode.Forms=="undefined"||SourceCode.Forms===null)&&(SourceCode.Forms={});(typeof SourceCode.Forms.Controls=="undefined"||SourceCode.Forms.Controls===null)&&(SourceCode.Forms.Controls={});(typeof SourceCode.Forms.Controls.Web=="undefined"||SourceCode.Forms.Controls.Web===null)&&(SourceCode.Forms.Controls.Web={});var SFTreeDisplayTemplate;SourceCode.Forms.Controls.Web.TreeViewDisplayTemplate=SFTreeDisplayTemplate={treeConfig:null,source:null,hasError:null,initialize:function(n,t){this.treeConfig=n;this.source=t;this.hasError=!1},getSourceTemplate:function(n){for(var q=this.source.displayTemplate,t=0;t<q.length;t++)if(q[t].text===n)return q[t]},show:function(){var s=this.source.contextXml;checkExists(this.treeConfig.genericMapping)&&this.treeConfig.genericMapping.remove();this.treeConfig.genericMapping=new SourceCode.Forms.Widget.GenericMappings({container:"propertyConfig_DisplayTemplatePanel",isTreeRightAligned:!0,contentTitle:"Configure the display value for the tree node",contentId:"propertyConfig_DisplayTemplatePanel_Container",contextXml:s});jQuery("#propertyConfig_DisplayTemplatePanel_Container").addClass("wrapper");var u=jQuery('<table width="100%" height="100%"><tr><td style="vertical-align: top; padding: 0px; width: 1px;"><\/td><td><\/td><\/tr><\/table>'),h=jQuery("#propertyConfig_DisplayTemplatePanel_Container").parent().parent();h.append(u);u.find("td").eq(0).append('<div class="form-field required" style="width: 1px;"><label class="form-field-label" style="width: 1px; padding: 1px;">&nbsp;<\/label><\/div>');u.find("td").eq(1).append(jQuery("#propertyConfig_DisplayTemplatePanel_Container").parent());var f=jQuery("<div class='wrapper'><\/div>");jQuery("#propertyConfig_DisplayTemplatePanel_Container").append(f);var t=jQuery("<input class='input-control token-input' />");f.append(t);t.tokenbox({accept:".ui-draggable",wysiwyg:{enabled:!1},multiline:!1,watermak:"Required",drop:function(n,t){for(var q=t.draggable,r="";q.length==1;){var u=q.text();u!==""&&q.is(":visible")&&(r=u+(r===""?"":" - "+r));q=q.closest("ul").parent().closest("li").find("a").first()}jQuery(n.originalEvent.target).children("span").last().find("span").attr("title",r)}});f.children(".input-control.token-input").addClass("full-size");var v=this;popupManager.showPopup({id:"propertyConfig_DisplayTemplatePanelOutside",buttons:[{type:"help",click:function(){HelpHelper.runHelp(7044)}},{text:Resources.WizardButtons.OKButtonText,click:function(){for(var r=t.tokenbox("value"),n=0;n<r.length;n++){var q=r[n],u=this.getSourceTemplate(q.text);if(checkExists(u)&&checkExists(u.data)&&checkExists(u.data.validationMessages)&&checkExists(q.data)&&(q.data.validationMessages=u.data.validationMessages,q.data.validationMessages.length>0&&(this.hasError=!0)),q.text===""){r.splice(n,1);n--;continue}}SFTreeDisplayTemplate.okClick(r)}.bind(SFTreeDisplayTemplate)},{id:"treeViewPropertyConfig_DisplateTemplateCancelBtn",text:Resources.WizardButtons.CancelButtonText,click:function(){}}],headerText:"Configure Display Template",draggable:!0,content:jQuery("#propertyConfig_DisplayTemplatePanel"),width:700,height:300,closeWith:"treeViewPropertyConfig_DisplateTemplateCancelBtn",onClose:function(){},onShow:function(){}});var q=this.source.displayTemplate;if(checkExists(q)){for(var e=0,c=q.length;e<c;){var n=q[e];if(n.type==="context"){var l=this.treeConfig.smartObject.val();if(n.tooltip="{0} - {1}".format(l,n.text),checkExists(n.data)&&checkExists(n.data.validationMessages)&&n.data.validationMessages.length>0)for(var a=new SourceCode.Forms.Services.AnalyzerResourcesService,o=a.parseValidationMessage(n.data.validationMessages.join(";")),r=0;r<o.length;r++)(o[r].status.toLowerCase()==="missing"||o[r].status.toLowerCase()==="error")&&(n.status="error missing")}e++}t.tokenbox("value",q)}},okClick:function(n){n&&n.length!=0&&(n.length!=1||n[0]&&(n[0].type!="value"||n[0].text.replace(/^\s+|\s+$/,"")!=""))?(this.treeConfig.setDisplayTemplateValue(n),this.source.displayTemplate=n,this.hasError||(this.treeConfig.clearErrorOnDisplayTemplate(),this.treeConfig.ClearErrorOnSettingsTab(this.source)),popupManager.closeLast()):popupManager.showWarning(Resources.CommonPhrases.DisplayTemplateEmptyValidateText)}};
/*!
 SourceCode.Forms.Controls.Web.ControlPack.Scripts.Config.TreeConfigSmartObject.js (Embedded resource)
*/
var TreeConfigSmartObject={smartObjectTree:null,treeConfig:null,type:null,userSelected:null,initialize:function(n){this.treeConfig=n;this.userSelected=!1;this.smartObjectTree=jQuery('<ul class="tree" style="background:#FFF"><li class="root children open"><a href="javascript:;">Loading...<\/a><\/li><\/ul>').categorytree({objecttypes:"smartobject"})},expandToNode:function(n,t){var e=TreeConfigSmartObject;if(t.length>0)if(checkExists(t.data().options)){var o=t.data().options.guid;if(n.toUpperCase()===o.toUpperCase())return}else return;t.removeClass("selected");var r=e.smartObjectTree.find("li.smartobject");if(r.length>0)for(var u=0,s=r.length;u<s;u++){var f=r[u],h=jQuery(f).data().options;if(h.guid.toUpperCase()===n.toUpperCase()){found=!0;f.classList.add("selected");for(var q=f.parentNode;q!==null;)checkExistsNotEmpty(q.tagName)&&q.tagName.toUpperCase()==="LI"&&q.classList.contains("smartobject")&&(q.classList.remove("closed"),q.classList.add("open")),q=q.parentNode;break}}},selectSmartObject:function(){var n=TreeConfigSmartObject,t=jQuery("<div style='background-color:#FFF;overflow:auto' class='wrapper'><\/div>");t.append(n.smartObjectTree[0]);var q=n.smartObjectTree.find(".selected"),r=n.treeConfig.selectedNode.data("source");r.id!==null?n.expandToNode(r.id,q):q.removeClass("selected");popupManager.showPopup({id:"SCTreeViewPropertyConfig_SmartObject",buttons:[{type:"help",click:function(){HelpHelper.runHelp(7064)}},{text:Resources.WizardButtons.OKButtonText,click:function(){var t=n.treeConfig.selectedNode.data("source");checkExists(t)&&checkExists(t.contextXml)&&(delete t.displayTemplate,delete t.actionNodeXml,delete t.contextXml);n.smartObjectSelected.call(n)}},{id:"propertyConfig_DataSourceCancelBtn",text:Resources.WizardButtons.CancelButtonText}],headerText:$("#SFTreeViewConfig").attr("locSelectSmartObjectHeader"),draggable:!0,maximizable:!0,content:t,width:360,height:350,closeWith:"propertyConfig_DataSourceCancelBtn"})},smartObjectSelected:function(){var r=this.treeConfig,t=this.smartObjectTree.tree("find","selected");if(t.length===0){var q=$("#SFTreeViewConfig").attr("locErrorSelectSmartObject");popupManager.showWarning(q);return}var n=t.metadata().guid;if(n!==null){var u=r.validateAssociation(n,"method");if(u)this.getSmartObjectDataWithConsistencyCheck.call(this,n,this.type),popupManager.getLastOpenPopup().hideBusy(),popupManager.closeLast();else{popupManager.getLastOpenPopup().hideBusy();var q=this.treeConfig.getResource("locErrorNoListMethod");popupManager.showWarning(q)}}},getAllSmartObjectData:function(n,t){if(checkExists(n)||!(n.length<1)){var u=this,r=n,q=function(){if(r.length>0){var n=r.shift();checkExists(n.status)&&n.status===SourceCode.Forms.DependencyHelper.ReferenceStatus.Missing?q():jQuery.ajax({url:applicationRoot+"Utilities/AJAXCall.ashx",data:{method:"getItems",resultTypes:"ObjectProperties|ObjectMethods|MethodRequiredProperties|MethodRequiredParameters|MethodInputs",targetType:"Object",targetId:n},dataType:"text",global:!1,success:function(){for(var t=popupManager.popUps.length,n=0;n<t;n++)popupManager.popUps[n].id==="propertyConfig_SFTreeViewConfig"&&q()},error:SFTreeConfig.error})}else checkExists(t)&&t()};q()}},getSmartObjectData:function(n,t,q){if(checkExistsNotEmpty(n)){checkExists(t)||(t=null);var u=SFTreeConfig,r=this;jQuery.ajax({url:applicationRoot+"Utilities/AJAXCall.ashx",data:{method:"getItems",resultTypes:"ObjectProperties|ObjectMethods|MethodRequiredProperties|MethodRequiredParameters|MethodInputs",targetType:"Object",targetId:n},dataType:"text",global:!1,success:function(n){for(var f=popupManager.popUps.length,u=0;u<f;u++)popupManager.popUps[u].id==="propertyConfig_SFTreeViewConfig"&&r.populateSourceSection.call(r,n,t,q)},error:SFTreeConfig.error})}},getSmartObjectDataWithConsistencyCheck:function(n,t,q){if(checkExistsNotEmpty(n)){checkExists(t)||(t=null);var u=SFTreeConfig,r=this;jQuery.ajax({url:applicationRoot+"Utilities/AJAXCall.ashx",data:{method:"getItems",resultTypes:"Objects|ObjectAssociations|ObjectAssociationProperties",targetType:"Object",targetId:n},dataType:"text",global:!1,success:function(u){var o=SourceCode.Forms.ExceptionHandler.isException(u),e;if(o){var f=parseXML(u),s=f.selectSingleNode("//Message").text,h="<li>Type: <pre>{0}<\/pre><\/li><li>Source: <pre>{1}<\/pre><\/li><li>Stack Trace: <pre>{2}<\/pre><\/li>".format(f.selectSingleNode("//Type").text,f.selectSingleNode("//Source").text,f.selectSingleNode("//StackTrace").text),c={draggable:!0,headerText:"Error",height:168,width:640,message:s,messageDetail:h,onClose:function(){},resizable:!0,showHeaderButtons:!1,type:"error"};popupManager.showExtendedMessage(c);return}e="ObjectProperties|ObjectMethods|MethodRequiredProperties|MethodRequiredParameters|MethodInputs";r.getSmartObjectDataByResultType(n,e,t,q)},error:SFTreeConfig.error})}},getSmartObjectDataByResultType:function(n,t,q,r){var u=this;jQuery.ajax({url:applicationRoot+"Utilities/AJAXCall.ashx",data:{method:"getItems",resultTypes:t,targetType:"Object",targetId:n},dataType:"text",global:!1,success:function(n){u.populateSourceSection.call(u,n,q,r)}})},loadSource:function(n,t){this.getSmartObjectData(n.id,t,n,!0)},clearFieldErrorBadges:function(){var n=this.treeConfig;TreeDependencyHelper.clearErrorOnField(n.smartObject[0]);TreeDependencyHelper.clearErrorOnField(n.smartObjectMethod[0]);TreeDependencyHelper.clearErrorOnField(n.idProperty[0]);TreeDependencyHelper.clearErrorOnField(n.valueProperty[0]);TreeDependencyHelper.clearErrorOnField(n.iconProperty[0]);TreeDependencyHelper.clearErrorOnField(n.parentProperty[0]);TreeDependencyHelper.clearErrorOnField(n.parentSmartObject[0]);TreeDependencyHelper.clearErrorOnField(n.displayTemplate[0])},clearDisplayTemplateBadge:function(){var n=this.treeConfig;TreeDependencyHelper.clearErrorOnField(n.displayTemplate[0])},getPropertyDisplayText:function(n){for(var u=n.length,q={},r=0;r<u;r++){var t=n[r];switch(t.referenceAs){case SourceCode.ControlPack.RefAs.TreeSourceIdProperty.fullname():q.idPropertyDisplayText=typeof t.displayName!="undefined"?t.displayName:t.name;break;case SourceCode.ControlPack.RefAs.TreeSourceValueProperty.fullname():q.valuePropertyDisplayText=typeof t.displayName!="undefined"?t.displayName:t.name;break;case SourceCode.ControlPack.RefAs.TreeSourceParentProperty.fullname():q.parentPropertyDisplayText=typeof t.displayName!="undefined"?t.displayName:t.name;break;case SourceCode.ControlPack.RefAs.TreeSourceIconProperty.fullname():q.iconPropertyDisplayText=typeof t.displayName!="undefined"?t.displayName:t.name}}return q},setFieldsFromSource:function(n){var t=this.treeConfig;t.smartObject.val(n.display);t.smartObject.parent().find(".input-control-watermark").empty();TreeDependencyHelper.setErrorOnField({element:t.smartObject[0],className:"smartobject",largeIcon:!0});var u=new SourceCode.Forms.Services.AnalyzerResourcesService,f=u.parseValidationMessage(n.validationMessages.join(";")),r=this.getPropertyDisplayText(f);t.addOption(t.smartObjectMethod,n.method,checkExists(n.methodDisplayText)?n.methodDisplayText:n.method,!0,"error-state list-method");var q=TreeDependencyHelper.getDataType(n.id,n.idProperty);t.addOption(t.idProperty,n.idProperty,r.idPropertyDisplayText,!0,"error-state {0}".format(q));q=TreeDependencyHelper.getDataType(n.id,n.valueProperty);t.addOption(t.valueProperty,n.valueProperty,r.valuePropertyDisplayText,!0,"error-state {0}".format(q));q=TreeDependencyHelper.getDataType(n.id,n.iconProperty);checkExists(r.iconPropertyDisplayText)||(q="",r.iconPropertyDisplayText="");t.addOption(t.iconProperty,n.iconProperty,r.iconPropertyDisplayText,!0,"error-state {0}".format(q));TreeDependencyHelper.validateSmartObject(n.id,n.validationMessages)||(q=TreeDependencyHelper.getDataType(n.id,n.parentProperty),t.addOption(t.parentProperty,n.parentProperty,r.parentPropertyDisplayText,!0,"error-state {0}".format(q)));checkExists(n.displayTemplate)&&n.displayTemplate.length>0&&(t.setDisplayTemplateValue(n.displayTemplate),$(t.idDisplayTemplate).closest(".input-control.select-box").removeClass("disabled"),TreeDependencyHelper.setErrorOnField({element:t.displayTemplate[0],className:"",largeIcon:!0}));n.invalid=!0},populateMethodDropdowns:function(n,t){var o=this;t.methods=[];for(var r=null,e=n.selectNodes('Items/Item[@ItemType="Method"]'),f=0,s=e.length;f<s;f++){var u=e[f];if(u.getAttribute("SubType")==="list"){var q=document.createElement("option");q.className="list-method";q.value=u.selectSingleNode("Name").text;q.innerHTML=u.selectSingleNode("DisplayName").text;t.methods[q.value]={};var h=t.methods[q.value];r===null&&(r=q.value);var c=u.selectNodes("Items/Item");h.hasInputs=c.length===0?!1:!0;t!==null&&t.method===q.value&&(r=t.method,q.setAttribute("selected","selected"));this.treeConfig.smartObjectMethod.append(q)}}var l=!1;return checkExists(t.methods[r])&&(l=t.methods[r].hasInputs),r!==t.method&&t.methods[t.method]===null&&(this.treeConfig.addOption(this.treeConfig.smartObjectMethod,t.method,t.method,!0,""),this.treeConfig.smartObjectMethod("refresh"),TreeDependencyHelper.setErrorOnField({element:o.treeConfig.smartObjectMethod[0],className:"",largeIcon:!1})),this.treeConfig.smartObjectMethod.dropdown("refresh"),r},populatePropertyDropdowns:function(n,t,q,r){var h=null,b=null,k=null,d=null,p=!1;checkExists(t.methods[q])&&(p=t.methods[q].hasInputs);var g=n.selectNodes('Items/Item[@ItemType="ObjectProperty"]'),tt=this.treeConfig.fullXml.documentElement,rt=tt.selectNodes("Prop[@serverControlType='property']"),f=parseXML("<nodes/>"),e=f.documentElement.appendChild(f.createElement("node"));e.setAttribute("text",r);e.setAttribute("icon","smartobject");e.setAttribute("open","true");f.documentElement.appendChild(e);for(var w=0,qt=g.length;w<qt;w++){var c=g[w],o=c.selectSingleNode("Name").text,l=c.selectSingleNode("DisplayName").text,a=c.getAttribute("SubType"),u=f.createElement("node");u.setAttribute("id",o);u.setAttribute("text",l);u.setAttribute("icon",a.toLowerCase());u.setAttribute("SourceID",o);u.setAttribute("SourceType","ObjectProperty");u.setAttribute("DataType",a);if(!["File","Image","DateTime","HyperLink","MultiValue","YesNo"].contains(c.getAttribute("SubType"))){var v=document.createElement("option");v.className=a.toLowerCase();v.value=o;v.innerHTML=l;e.appendChild(u);k===null&&(fallbacktName=o,d=l);h===null&&a.toLowerCase()==="text"&&(h=o,b=l);var y=jQuery(v);this.treeConfig.valueProperty.append(y);this.treeConfig.idProperty.append(y.clone());this.treeConfig.iconProperty.append(y.clone());p&&this.treeConfig.parentProperty.append(y.clone())}}if(p||this.treeConfig.setParentProperty_NoMethodInputs(),t.contextXml=f,this.treeConfig.idProperty.dropdown("refresh"),this.treeConfig.valueProperty.dropdown("refresh"),this.treeConfig.parentProperty.dropdown("refresh"),this.treeConfig.iconProperty.dropdown("refresh"),checkExistsNotEmpty(t.idProperty)&&this.treeConfig.idProperty.dropdown("SelectedValue",t.idProperty),checkExistsNotEmpty(t.valueProperty)&&this.treeConfig.valueProperty.dropdown("SelectedValue",t.valueProperty),checkExistsNotEmpty(t.parentProperty)){var nt=SourceCode.Forms.Controls.Web.TreeView.CustomValue;t.parentProperty===nt?(this.treeConfig.addOption(this.treeConfig.parentProperty,nt,this.treeConfig.CustomText,!0,"customFilter"),this.treeConfig.parentProperty.dropdown("refresh")):this.treeConfig.parentProperty.dropdown("SelectedValue",t.parentProperty)}checkExistsNotEmpty(t.iconProperty)&&this.treeConfig.iconProperty.dropdown("SelectedValue",t.iconProperty);var s={};return checkExistsNotEmpty(h)?(s.name=h,s.display=b):(s.name=k,s.display=d),s},IsDisplayTemplateMessagesInError:function(n){for(var q=n.length,t=0;t<q;t++)if(typeof n[t].data!="undefined"&&checkExists(n[t].data)&&typeof n[t].data.validationMessages!="undefined"&&checkExists(n[t].data.validationMessages)&&n[t].data.validationMessages.length>0)return!0;return!1},determineErrorTab:function(n){var f=$("#SFTreeViewConfig_SourceTabs"),e=f.find(".tab-icon.treeconfig-settings"),r=f.find(".tab-icon.treeconfig-iconsource");if(typeof n!="undefined"&&checkExists(n)){var u=!1,o=SFTreeConfig.previewTree.parentNode(SFTreeConfig.selectedNode);if(o!==null){var s=o.data("source");TreeDependencyHelper.validateSmartObject(s.id,s.validationMessages)||(u=!0)}if(checkExists(n.validationMessages)&&n.validationMessages.length>0){for(var c=new SourceCode.Forms.Services.AnalyzerResourcesService,q=c.parseValidationMessage(n.validationMessages.join(";")),h=q.length,t=0;t<h;t++)if(q[t].referenceAs!=="SourceCode.Forms.Controls.Web.ControlPack.Properties.ReferenceAs.TreeSourceIconProperty"&&q[t].status.toUpperCase()==="MISSING"){u=!0;break}typeof n.displayTemplate!="undefined"&&this.IsDisplayTemplateMessagesInError(n.displayTemplate)&&(u=!0)}u?e.addClass("error"):e.removeClass("error");switch(n.icon){case"dynamic":if(checkExists(n.validationMessages)&&n.validationMessages.length>0)for(var t=0;t<h;t++)if(q[t].referenceAs==="SourceCode.Forms.Controls.Web.ControlPack.Properties.ReferenceAs.TreeSourceIconProperty"&&q[t].status.toUpperCase()==="MISSING"){r.addClass("error");return}break;case"static":var l=$.parseXML(this.treeConfig.propertiesXml).documentElement,a=l.selectNodes("Control/Properties/Property[(Name[text()='IconId'] or Name[text()='IconMethod'] or Name[text()='IconSource'] or Name[text()='IconSourceId'] or Name[text()='IconName'] or Name[text()='IconImage']) and (contains(@ValidationStatus,'Error') or contains(@ValidationStatus,'Missing') or contains(@ValidationStatus,'Warning'))]");a.length>0?r.addClass("error"):r.removeClass("error");break;default:r.removeClass("error")}}},populateSourceSection:function(n,t,q){var g=this.treeConfig.smartObject[0].getAttribute("guid"),nt=this.treeConfig.smartObject[0].getAttribute("uid");this.treeConfig.removeHashEntry(this.treeConfig.selectedNode);this.determineErrorTab(q);var y=SourceCode.Forms.ExceptionHandler.isException(n);if(y){this.setFieldsFromSource(q);this.userSelected=!1;t!==null&&t.call(this);return}var f=parseXML(n).documentElement.selectSingleNode("Item");if(f===null){this.setFieldsFromSource(q);this.userSelected=!1;t!==null&&t.call(this);return}if(this.clearFieldErrorBadges(),checkExists(q)&&checkExists(q.validationMessages))for(var p=new SourceCode.Forms.Services.AnalyzerResourcesService,o=p.parseValidationMessage(q.validationMessages.join(";")),u=0;u<o.length;u++)var w=o[u];var r=this.treeConfig.selectedNode.data("source");this.userSelected&&(r.id=null,r.name=null,r.display=null,r.method=null,r.idProperty=null,r.valueProperty=null,r.parentProperty=null,r.actionNodeXml=null,r.selectable=!0);this.treeConfig.smartObjectMethod.empty();this.treeConfig.idProperty.empty();this.treeConfig.valueProperty.empty();this.treeConfig.parentProperty.empty();this.treeConfig.iconProperty.empty();var h=f.selectSingleNode("DisplayName").text,tt=f.selectSingleNode("Name").text;checkExists(t)||(r.uid=String.generateGuid());this.treeConfig.smartObject.val(h);this.treeConfig.smartObject[0].setAttribute("guid",f.getAttribute("Guid"));this.treeConfig.smartObject[0].setAttribute("uid",r.uid);this.treeConfig.smartObject[0].setAttribute("systemName",f.selectSingleNode("Name").text);this.treeConfig.smartObject.parent().find(".input-control-watermark").empty();var b=this.populateMethodDropdowns(f,r),c=this.populatePropertyDropdowns(f,r,b,h),l=new SourceCode.Forms.Services.AnalyzerResourcesService;if(checkExists(q)&&checkExists(q.validationMessages)&&q.validationMessages.length>0)for(var o=l.parseValidationMessage(q.validationMessages.join(";")),a={},u=0,v=o.length;u<v;u++){var e=o[u];checkExists(a[e.referenceAs])||(this.badgeControl(e,SourceCode.ControlPack.RefAs.TreeSourceIdProperty,this.treeConfig.idProperty,"dropdown",q.idProperty,{source:r,type:"property"}),this.badgeControl(e,SourceCode.ControlPack.RefAs.TreeSourceValueProperty,this.treeConfig.valueProperty,"dropdown",q.valueProperty,{source:r,type:"property"}),this.badgeControl(e,SourceCode.ControlPack.RefAs.TreeSourceIconProperty,this.treeConfig.iconProperty,"dropdown",q.iconProperty,{source:r,type:"property"}),this.badgeControl(e,SourceCode.ControlPack.RefAs.TreeSourceMethod,this.treeConfig.smartObjectMethod,"dropdown",q.method,{source:r,type:"method"}),this.badgeControl(e,SourceCode.ControlPack.RefAs.TreeSourceParentProperty,this.treeConfig.parentProperty,"dropdown",q.parentProperty,{source:r,type:"property"}),a[e.referenceAs]=!0)}if(checkExists(q)&&checkExists(q.displayTemplate)&&q.displayTemplate.length>0)for(var s=0;s<q.displayTemplate.length;s++)if(typeof q.displayTemplate[s].data=="object"&&checkExists(q.displayTemplate[s].data.validationMessages))for(var o=l.parseValidationMessage(q.displayTemplate[s].data.validationMessages.join(";")),u=0,v=o.length;u<v;u++){var w=o[u];if(w.status===SourceCode.Forms.DependencyHelper.ReferenceStatus.Missing){TreeDependencyHelper.setErrorOnField({element:this.treeConfig.displayTemplate[0],className:"",largeIcon:!0});break}}if(checkExists(r.displayTemplate)&&checkExists(q)?(this.treeConfig.setDisplayTemplateValue(r.displayTemplate),this.updateSource(r)):(this.updateSource(r),r.displayTemplate=this.treeConfig.initDefaultDisplayTemplate.call(this.treeConfig,c.name,c.display,f)),checkExists(t))checkExists(SFTreeConfig.smoList[r.id])?(SFTreeConfig.smoList[r.id][r.uid]={},SFTreeConfig.smoList[r.id][r.uid].version=r.version):(SFTreeConfig.smoList[r.id]={},SFTreeConfig.smoList[r.id][r.uid]={},SFTreeConfig.smoList[r.id][r.uid].version=0);else if(checkExists(SFTreeConfig.smoList[r.id])){var k=Object.keys(SFTreeConfig.smoList[r.id]).length-0;SFTreeConfig.smoList[r.id][r.uid]={};SFTreeConfig.smoList[r.id][r.uid].version=k;r.version="("+SFTreeConfig.smoList[r.id][r.uid].version+")"}else SFTreeConfig.smoList[r.id]={},SFTreeConfig.smoList[r.id][r.uid]={},SFTreeConfig.smoList[r.id][r.uid].version=0,r.version="";if(this.treeConfig.updateParentDropDown(),!checkExists(q)){this.clearAllDropDownDependencies();var d=this.treeConfig.idSmartObject,r=SFTreeConfig.getSelectedSource();SFTreeConfig.clearDependency(r,SourceCode.ControlPack.RefAs.TreeSource,d,{type:"lookup"})}this.treeConfig.toggleSourceSection(!0);this.userSelected&&SFTreeIconTab.selectNone();this.userSelected=!1;t!==null&&t.call(this)},clearAllDropDownDependencies:function(){var t=this.treeConfig.idProperty,n=SFTreeConfig.getSelectedSource();SFTreeConfig.clearDependency(n,SourceCode.ControlPack.RefAs.TreeSourceIdProperty,t,{type:"dropdown",oldValue:n.idProperty});t=this.treeConfig.valueProperty;SFTreeConfig.clearDependency(n,SourceCode.ControlPack.RefAs.TreeSourceValueProperty,t,{type:"dropdown",oldValue:n.valueProperty});t=this.treeConfig.iconProperty;SFTreeConfig.clearDependency(n,SourceCode.ControlPack.RefAs.TreeIconId,t,{type:"dropdown",oldValue:n.iconProperty});t=this.treeConfig.smartObjectMethod;SFTreeConfig.clearDependency(n,SourceCode.ControlPack.RefAs.TreeSourceMethod,t,{type:"dropdown",oldValue:n.method});t=this.treeConfig.parentProperty;SFTreeConfig.clearDependency(n,SourceCode.ControlPack.RefAs.TreeSourceParentProperty,t,{type:"dropdown",oldValue:n.parentProperty});t=this.treeConfig.parentSmartObject;SFTreeConfig.clearDependency(n,SourceCode.ControlPack.RefAs.TreeSourceParent,t,{type:"dropdown",oldValue:n.parentSmartObject})},badgeControl:function(n,t,q,r,u,f){var e=r.toUpperCase();if(t.fullname()===n.referenceAs&&n.status===SourceCode.Forms.DependencyHelper.ReferenceStatus.Missing)if(e==="DROPDOWN")switch(f.type.toUpperCase()){case"METHOD":this.treeConfig.addOption(q,u,typeof n.displayName!="undefined"?n.displayName:n.name,!0,"error-state list-method");break;case"PROPERTY":var o=TreeDependencyHelper.getDataType(f.source.id,u);this.treeConfig.addOption(q,u,typeof n.displayName!="undefined"?n.displayName:n.name,!0,"error-state {0}".format(o))}else e==="LOOKUP"&&q.val(u)},updateSource:function(n){var t=this.treeConfig;n.id=t.smartObject[0].getAttribute("guid");n.name=t.smartObject[0].getAttribute("systemName");n.display=t.smartObject.val();n.method=t.smartObjectMethod.dropdown("SelectedValue");n.methodDisplayText=t.smartObjectMethod.dropdown("SelectedDisplay");n.idProperty=t.idProperty.dropdown("SelectedValue");n.valueProperty=t.valueProperty.dropdown("SelectedValue");n.parentSmartObject=t.parentSmartObject.dropdown("SelectedValue");t.systemChangingParentProperty=!0;n.parentProperty=t.parentProperty.dropdown("SelectedValue");setTimeout(function(){t.systemChangingParentProperty=!1},100);n.iconProperty=t.iconProperty.dropdown("SelectedValue");n.selectable=t.chkSelectable.is(":checked")},cleanUp:function(){checkExists(this.smartObjectTree)&&this.smartObjectTree.empty()}};
/*!
 SourceCode.Forms.Controls.Web.ControlPack.Scripts.Config.RuleConfigurePopup.js (Embedded resource)
*/
(typeof SourceCode=="undefined"||SourceCode===null)&&(SourceCode={});(typeof SourceCode.Forms=="undefined"||SourceCode.Forms===null)&&(SourceCode.Forms={});(typeof SourceCode.Forms.Controls=="undefined"||SourceCode.Forms.Controls===null)&&(SourceCode.Forms.Controls={});(typeof SourceCode.Forms.Controls.Web=="undefined"||SourceCode.Forms.Controls.Web===null)&&(SourceCode.Forms.Controls.Web={});var SFTreeRulePopup;SourceCode.Forms.Controls.Web.TreeViewRuleConfigurePopup=SFTreeRulePopup={propertyConfig:null,source:null,index:null,ruleWizardCloseCallback:null,modifiedEventNodeId:null,initialize:function(n,t,q){this.propertyConfig=n;this.source=t;this.index=q},changePrimarySource:function(n,t,q){if(!checkExists(q))if(checkExists(SourceCode.Forms.Designers.View)){var f=SourceCode.Forms.Designers.View;q=f.viewDefinitionXML.documentElement.selectSingleNode("Views/View")}else return;var r=q.selectSingleNode("Controls/Control[@ID='{0}']".format(n)),u=q.ownerDocument;TreeUtil.updateProperty(u,r,"AssociationSO",t.id);TreeUtil.updateProperty(u,r,"AssociationMethod",t.method)},show:function(){if(checkExists(this.source)&&this.index!==null&&!(this.index<0)){var r=SourceCode.Forms.Designers.View.viewDefinitionXML.documentElement,t=parseXML(this.propertyConfig.propertiesXml);this.propertyConfig.save(t);this.propertyConfig.callback(1,t.xml,!0);this.propertyConfig.createSourcesOnDefinition(this.propertyConfig.definition[0]);SourceCode.Forms.Designers.View.ViewDesigner._BuildViewXML();var n=SFCTreeRuleHelper.ensureLevelLoadingEvent(this.propertyConfig.controlId,this.propertyConfig.definition);if(n!==null){SFTreeRulePopup.modifiedEventNodeId=n.getAttribute("ID");var u=r.selectSingleNode("Views/View"),f=n.cloneNode(!0);if(n!==null){this.propertyConfig.clonedEventNode=n.cloneNode(!0);this.propertyConfig.changeEventType(!0,n);SFCTreeRuleHelper.cleanValidateActions(n);var e=n.getAttribute("ID"),o=n.selectNodes("Handlers/Handler/Actions/Action"),s=o[this.index],q=s.getAttribute("ID");this.changePrimarySource(this.propertyConfig.controlId,this.source,u);$(SourceCode.Forms.Designers.Common.Rules.Current).on("RuleDesignerClosed.SFTree",function(){SFTreeRulePopup.ruleWizardCloseCallback(q,f)});SourceCode.Forms.Designers.View.isControlEvent=!0;SourceCode.Forms.WizardContainer.show("Control","SourceCode.Forms.Designers.View.viewDefinitionXML",{ruleID:e,actionID:q})}else popupManager.showWarning(document.getElementById("SFTreeViewConfig").getAttribute("locErrorCouldNotLoadRuleFilter"))}}},getLoadEvent:function(n,t){return n.selectSingleNode("Events/Event[Name='Populating' and @Type='System'][Handlers/Handler/Actions/Action/Properties/Property[Name='ControlID'][Value='{0}']]".format(t))}};
/*!
 SourceCode.Forms.Controls.Web.ControlPack.Scripts.Config.TreeViewConfig.js (Embedded resource)
*/
(typeof SourceCode=="undefined"||SourceCode===null)&&(SourceCode={});(typeof SourceCode.Forms=="undefined"||SourceCode.Forms===null)&&(SourceCode.Forms={});(typeof SourceCode.Forms.Controls=="undefined"||SourceCode.Forms.Controls===null)&&(SourceCode.Forms.Controls={});(typeof SourceCode.Forms.Controls.Web=="undefined"||SourceCode.Forms.Controls.Web===null)&&(SourceCode.Forms.Controls.Web={});var SFTreeConfig;SourceCode.Forms.Controls.Web.TreeViewConfig=SFTreeConfig={id:"#SFTreeViewConfig",idSmartObject:"#SFTreeViewConfig_SmartObject",idSmartObjectButton:"#SFTreeViewConfig_SmartObjectButton",idSmartObjectMethod:"#SFTreeViewConfig_SmartObjectMethod",idRuleButton:"#SFTreeViewConfig_RuleButton",idDisplayTemplate:"#SFTreeViewConfig_Display",idDisplayTemplateButton:"#SFTreeViewConfig_DisplayButton",idIDProperty:"#SFTreeViewConfig_ID",idValue:"#SFTreeViewConfig_Value",idLink:"#SFTreeViewConfig_Link",idSelectable:"#SFTreeViewConfig_Selectable",idRecursive:"#SFTreeViewConfig_Recursive",idRecursiveProperty:"#SFTreeViewConfig_RecursiveProperty",idParentSmartObject:"#SFTreeViewConfig_ParentSmartObject",idParentProperty:"#SFTreeViewConfig_ParentProperty",idRadIconNone:"#SFTreeViewConfig_RadIconNone",idRadIconSingle:"#SFTreeViewConfig_RadIconSingle",idRadIconSmartObject:"#SFTreeViewConfig_RadIconSmartObject",idRadIconConditional:"#SFTreeViewConfig_RadIconConditional",idStaticIcon:"#SFTreeViewConfig_StaticIcon",idStaticIconButton:"#SFTreeViewConfig_StaticIconButton",idIconProperty:"#SFTreeViewConfig_IconProperty",idIconConditionTextArea:"#SFTreeViewConfig_ConditionTextBox",idAddButton:"#SFTreeViewConfig_AddButton",idRemoveButton:"#SFTreeViewConfig_RemoveButton",idMoveUpButton:"#SFTreeViewConfig_MoveUpButton",idMoveDownButton:"#SFTreeViewConfig_MoveDownButton",idBlind:"#SFTreeConfig_Blind",CustomText:null,smartObject:null,smartObjectButton:null,smartObjectMethod:null,methodRuleButton:null,displayTemplate:null,displayTemplateButton:null,idProperty:null,valueProperty:null,linkProperty:null,chkSelectable:null,chkRecursive:null,recursiveProperty:null,parentSmartObject:null,parentProperty:null,radIconNone:null,radIconSingle:null,radIconProperty:null,radIconConditional:null,staticIcon:null,staticIconButton:null,iconProperty:null,iconConditions:null,mainContent:null,bodyTemplate:null,tabControl:null,controlId:null,fullXml:null,propertyXml:null,propertiesXml:null,callback:null,definition:null,previewTree:null,smartObjectConfig:null,loading:null,selectedNode:null,iconSource:null,iconIdProperty:null,iconName:null,iconImage:null,smoList:{},originalPropertyXml:null,clonedEventNode:null,systemChangingParentProperty:!1,helpId:"5007",initialize:function(n,t,q,r,u){if(SFTreeConfig.smoList={},!popupManager.popUps||popupManager.popUps.length===0){var f=jQuery(SFTreeConfig.id);SFTreeConfig.fullXml=parseXML(t);SFTreeConfig.originalPropertyXml=n;SFTreeConfig.propertyXml=parseXML(n);SFTreeConfig.callback=u;SFTreeConfig.definition=[];SFTreeConfig.propertiesXml=n||"<Controls><Control/><\/Controls>";SFTreeConfig.loading=!1;SFTreeIconTab.initialize(SFTreeConfig,function(n){checkExists(n)&&(SFTreeConfig.staticIcon.val(n.value),SFTreeConfig.staticIcon.data("path",n.iconPath),SFTreeConfig.setSourceProperty("staticValue",n.value),SFTreeConfig.previewTree.setNodeIcon(SFTreeConfig.selectedNode,n.iconPath,n.value))});var e=SFTreeConfig.propertyXml.selectSingleNode("Controls/Control/Properties/Property[Name='IconSource']/Value");e!==null&&(SFTreeConfig.iconSource=e.text);var o=SFTreeConfig.propertyXml.selectSingleNode("Controls/Control/Properties/Property[Name='IconName']/Value");o!==null&&(SFTreeConfig.iconName=o.text);var s=SFTreeConfig.propertyXml.selectSingleNode("Controls/Control/Properties/Property[Name='IconImage']/Value");s!==null&&(SFTreeConfig.iconImage=s.text);var h=SFTreeConfig.propertyXml.selectSingleNode("Controls/Control/Properties/Property[Name='IconId']/Value");h!==null&&(SFTreeConfig.iconIdProperty=h.text);var c=SFTreeConfig.propertyXml.selectSingleNode("Controls/Control/Properties/Property[Name='IconMethod']/Value");SFTreeConfig.iconMethod=c!==null?c.text:"GetList";var a=parseXML(n);SFTreeConfig.controlId=a.documentElement.selectSingleNode("//Controls/Control").getAttribute("ID");jQuery(SFTreeConfig.idRemoveButton).addClass("disabled");SFTreeConfig.previewTree=new SourceCode.Forms.Controls.Web.TreePreview("treeView",SFTreeConfig.treeEventHandler,321);var l=jQuery("#SFTreeViewConfig_BodyTemplate");SFTreeConfig.bodyTemplate=l[0].childNodes[0];l.empty();SFTreeConfig.loadDefinition(n);TreeConfigSmartObject.initialize(SFTreeConfig);SFTreeConfig.CustomText=SFTreeConfig.getResource("locTextCustom");popupManager.showPopup({id:"propertyConfig_SFTreeViewConfig",buttons:[{type:"help",click:function(){window.open("{0}Help.aspx?ID={1}".format(applicationRoot,SFTreeConfig.helpId))}},{text:Resources.WizardButtons.OKButtonText,click:SFTreeConfig.popupOkClick.bind(SFTreeConfig)},{id:"dropdownPropertyConfig_Cancel",text:Resources.WizardButtons.CancelButtonText,click:this.onClose}],closeWith:"dropdownPropertyConfig_Cancel",headerText:f.attr("locPopupHeader"),draggable:!0,content:f,width:660,height:452,onClose:function(){SFTreeConfig.hideLoadingOverlay();SFTreeConfig.popupClose();SFTreeConfig.cleanUp()}.bind(SFTreeConfig),onShow:function(){if(SFTreeConfig.initializeBodyControls(),checkExists(SFTreeConfig.definition)&&SFTreeConfig.definition.length>0){var n=jQuery('<div id="SFTreeConfig_Blind" style="top:0px;left:0px;background-color:white;width:100%;height:100%;position:absolute"><\/div>'),t=jQuery("#SFTreeViewConfig").after(n);SFTreeConfig.showLoadingOverlay();SFTreeConfig.load()}}.bind(SFTreeConfig)});jQuery(SFTreeConfig.idAddButton).on("click",function(){if(!jQuery(SFTreeConfig.idAddButton).hasClass("disabled")){var t=SFTreeConfig.previewTree,n=SFTreeConfig.previewTree.addNode.call(t,SFTreeConfig.getResource("locConfigureSmartObjectNode"),jQuery(SFTreeConfig.bodyTemplate).clone());if(checkExists(n))n.data("source",{id:null,uid:null,parentSmartObject:null,staticValue:"",icon:"none"}),SFTreeConfig.previewTree.setNodeIcon(n,null),SFTreeConfig.previewTree.selectNode.call(t,n)}});jQuery(SFTreeConfig.idMoveUpButton).on("click",function(){SFTreeConfig.previewTree.moveNodeUp()});jQuery(SFTreeConfig.idMoveDownButton).on("click",function(){SFTreeConfig.previewTree.moveNodeDown()});jQuery(SFTreeConfig.idRemoveButton).on("click",function(){jQuery(SFTreeConfig.idRemoveButton).hasClass("disabled")||(SFTreeConfig.previewTree.removeNode(),$(SFTreeConfig.idAddButton).removeClass("disabled"))})}},popupClose:function(){var n=SFTreeConfig;if(n.handleRuleWizardCancellation(),n.clonedEventNode!==null&&checkExists(SourceCode.Forms.Designers.View)){var r=SourceCode.Forms.Designers.View.viewDefinitionXML.documentElement.selectSingleNode("Views/View"),t=SFTreeRulePopup.getLoadEvent(r,n.controlId);if(t!==null){var q=t.parentNode;q.removeChild(t);q.appendChild(n.clonedEventNode)}n.callback(1,n.originalPropertyXml)}else n.callback();$("#SFTreeViewConfig").remove()},error:function(){},treeEventHandler:function(n,t){var q=SFTreeConfig;switch(n){case"selected":if(!q.previewTree.hasNodes())return;q.mainContent.empty();q.mainContent.append(t.node.data("content"));q.selectedNode=t.node;q.initializeBodyControls();SFTreeTabHelper.activate();SFTreeIconTab.activate();var r=q.getSelectedSource();r.recursive?q.chkRecursive.checkbox("check"):q.chkRecursive.checkbox("uncheck");q.updateParentDropDown();var o=q.getSelectedSource(),f=o.validationMessages;if(checkExists(f)&&f.length>0){var s=q.displayTemplate.closest(".input-control.select-box.lookup-box.icon");s.removeClass("disabled");$(SFTreeConfig.idAddButton).addClass("disabled")}else $(SFTreeConfig.idAddButton).removeClass("disabled");jQuery(SFTreeConfig.idRemoveButton).removeClass("disabled");break;case"unselected":if(!q.previewTree.hasNodes())return;q.mainContent.empty();q.mainContent.append($(q.bodyTemplate).clone());q.initializeBodyControls();q.disableBodyControls();q.selectedNode=null;$(SFTreeConfig.idAddButton).removeClass("disabled");$(SFTreeConfig.idRemoveButton).addClass("disabled");break;case"adding":q.updateDefinition(!1);break;case"added":q.selectedNode=t.node;q.enableArrows();break;case"removing":if(q.removeHashEntry(t.node),q.updateHashEntries(t.node),q.updateDefinition(!1),t.node.parent("ul").length===1&&t.node.parent("ul")[0].id==="treeView"&&checkExists(t.node[0].childNodes[1])&&t.node[0].childNodes[1].childNodes.length>0)for(var e=t.node[0].childNodes[1],u=0;u<e.childNodes.length;u++){var r=jQuery(e.childNodes[u]).data().source;r.parentProperty!==SourceCode.Forms.Controls.Web.TreeView.CustomValue&&SFCTreeRuleHelper.setParentFilter(q.controlId,r,null,!0);r.parentSmartObject="(NONE)"}break;case"removed":q.mainContent.empty();q.mainContent.append($(q.bodyTemplate).clone());q.selectedNode=null;q.initializeBodyControls();q.disableBodyControls();jQuery(SFTreeConfig.idRemoveButton).addClass("disabled");break;case"validated":q.showMessage(t.valid)}},removeHashEntry:function(n){if(checkExists(n)){var t=$(n).data().source;checkExists(this.smoList[t.id])&&(checkExists(this.smoList[t.id][t.uid])&&delete this.smoList[t.id][t.uid],Object.keys(this.smoList[t.id]).length===0&&delete this.smoList[t.id])}},updateHashEntries:function(n){var q=$(n).data().source;if(checkExists(this.smoList[q.id])){var r=0;for(var t in this.smoList[q.id])r!==0?(this.smoList[q.id][t].version="("+r+")",$("#Node_"+t).data().source.version="("+r+")",$("#Node_"+t).find(">div>.k-in")[0].innerHTML=$("#Node_"+t).find(".k-sprite")[0].outerHTML+"{0}".format(q.display+"("+r+")")):(this.smoList[q.id][t].version="",$("#Node_"+t).data().source.version="",$("#Node_"+t).find(">div>.k-in")[0].innerHTML=$("#Node_"+t).find(".k-sprite")[0].outerHTML+"{0}".format(q.display+"")),r++}},showMessage:function(n){n||popupManager.showWarning("Please select an SMO that has not been added")},enableArrows:function(){this.selectedNode!==null&&(this.selectedNode.parent().children().length>1?(jQuery("#SFTreeViewConfig_MoveUpButton").removeClass("disabled"),jQuery("#SFTreeViewConfig_MoveDownButton").removeClass("disabled")):(jQuery("#SFTreeViewConfig_MoveUpButton").addClass("disabled"),jQuery("#SFTreeViewConfig_MoveDownButton").addClass("disabled")))},tabChanged:function(n){n==="icon"&&SFTreeIconTab.activate()},initializeBodyControls:function(){SFTreeTabHelper.initialize("#SFTreeViewConfig_ConfigTab","#SFTreeViewConfig_IconTab","#SFTreeViewConfig_ConfigTabBody","#SFTreeViewConfig_IconTabBody",this.tabChanged);this.smartObject=jQuery(this.idSmartObject).lookupbox();jQuery(this.idSmartObject).prop("disabled",!0);this.smartObjectButton=jQuery(this.idSmartObjectButton);this.smartObjectMethod=jQuery(this.idSmartObjectMethod).dropdown();this.methodRuleButton=jQuery(this.idRuleButton).button();this.displayTemplate=jQuery(this.idDisplayTemplate).lookupbox();jQuery(this.idDisplayTemplate).prop("disabled",!0);this.displayTemplateButton=jQuery(this.idDisplayTemplateButton);this.idProperty=jQuery(this.idIDProperty).dropdown();this.valueProperty=jQuery(this.idValue).dropdown();this.linkProperty=jQuery(this.idLink).dropdown();this.chkSelectable=jQuery(this.idSelectable).checkbox();this.chkSelectable.checkbox("check");this.chkRecursive=jQuery(this.idRecursive).checkbox();var n=this.getSelectedSource();checkExists(n)&&checkExists(n.selectable)&&!n.selectable&&this.chkSelectable.checkbox("uncheck");this.parentSmartObject=jQuery(this.idParentSmartObject).dropdown();this.parentProperty=jQuery(this.idParentProperty).dropdown();this.radIconNone=jQuery(this.idRadIconNone).radiobutton();this.radIconSingle=jQuery(this.idRadIconSingle).radiobutton();this.radIconSmartObject=jQuery(this.idRadIconSmartObject).radiobutton();this.radIconConditional=jQuery(this.idRadIconConditional).radiobutton();this.staticIcon=jQuery(this.idStaticIcon).lookupbox();jQuery(this.idStaticIcon).prop("disabled",!0);this.staticIconButton=jQuery(this.idStaticIconButton);this.iconProperty=jQuery(this.idIconProperty).dropdown();this.staticIcon.closest(".input-control.select-box.lookup-box.icon").addClass("disabled");this.iconProperty.dropdown("disable");this.radIconNone.on("click",SFTreeIconTab.radIconNone_Click);this.radIconSingle.on("click",SFTreeIconTab.radIconSingle_Click);this.radIconSmartObject.on("click",SFTreeIconTab.radIconSmartObject_Click);this.radIconConditional.on("click",SFTreeIconTab.radIconConditional_Click);this.iconProperty.on("change",SFTreeIconTab.iconProperty_Changed);this.mainContent=jQuery(this.id).find(".mainContent");this.smartObjectButton.on("click",function(n){TreeConfigSmartObject.userSelected=!0;TreeConfigSmartObject.selectSmartObject(n)});this.smartObjectMethod.on("change",this.method_Changed);this.methodRuleButton.on("click",this.methodRule_Click);this.displayTemplateButton.on("click",this.showDisplayTemplate_Click);this.valueProperty.on("change",this.valueProperty_Changed);this.idProperty.on("change",this.idProperty_Changed);this.chkSelectable.on("click",this.chkSelectable_Click);this.chkRecursive.on("click",this.chkRecursive_Click);this.parentSmartObject.on("change",this.parentSmartObject_Changed);this.parentProperty.on("change",this.parentProperty_Changed);checkExistsNotEmpty(this.smartObject.val())||this.toggleSourceSection.call(this,!1);this.selectedNode!==null&&this.selectedNode.parent().children().length>1&&(jQuery("#SFTreeViewConfig_MoveUpButton").removeClass("disabled"),jQuery("#SFTreeViewConfig_MoveDownButton").removeClass("disabled"))},disableBodyControls:function(){jQuery(this.idSmartObject).lookupbox("disable");jQuery(this.idSmartObject).prop("disabled",!0);this.smartObjectButton.off("click");this.smartObjectButton.closest(".lookup-box").addClass("disabled");jQuery(this.idSmartObjectMethod).dropdown("disable");jQuery(this.idRuleButton).button("disable");jQuery(this.idDisplayTemplate).lookupbox("disable");jQuery(this.idDisplayTemplate).prop("disabled",!0);jQuery(this.idValue).dropdown("disable");this.idProperty.dropdown("disable");jQuery(this.idLink).dropdown("disable");this.chkSelectable.checkbox("disable");this.chkRecursive.checkbox("disable");jQuery(this.idParentSmartObject).dropdown("disable");jQuery(this.idParentProperty).dropdown("disable");jQuery(this.idRadIconNone).radiobutton("disable");jQuery(this.idRadIconSingle).radiobutton("disable");jQuery(this.idRadIconSmartObject).radiobutton("disable");jQuery(this.idStaticIcon).lookupbox("disable");jQuery(this.idStaticIcon).prop("disabled",!0);jQuery(this.idIconProperty).dropdown("disable");jQuery("#SFTreeViewConfig_MoveUpButton").addClass("disabled");jQuery("#SFTreeViewConfig_MoveDownButton").addClass("disabled")},setParentProperty_NoMethodInputs:function(){var n=SFTreeConfig;n.parentProperty.dropdown("clearOptions");n.addOption(n.parentProperty,SFCTreeRuleHelper.NO_METHOD_INPUTS,ControlResources.SourceCode.Forms.Controls.Web.ControlPack.Properties.Tree.NoSmartObjectMethodInputs,!0,"customFilter");n.parentProperty.dropdown("refresh")},clearErrorOnDisplayTemplate:function(){TreeConfigSmartObject.clearDisplayTemplateBadge()},ClearErrorOnSettingsTab:function(n){TreeConfigSmartObject.determineErrorTab(n)},clearDependency:function(n,t,q,r){var a=SFTreeConfig;if(checkExists(n.validationMessages)){for(var s=TreeDependencyHelper.parseValidationMessagesFromStringArray(n.validationMessages),h=[],c=s.length,f=0;f<c;f++){var o=s[f];if(o.referenceAs===t.fullname()){if(TreeDependencyHelper.clearErrorOnField(q[0]),r.type==="dropdown"){for(var u=q.dropdown("Items"),e=0,l=u.length;e<l;e++)if(u[e].value===r.oldValue){u.splice(e,1);break}u.length>0&&(u[0].selected=!0);u.length===0&&(u=null);q.dropdown("option","items",u);q.dropdown("refresh");SourceCode.Forms.Designers.Common.removeItemFromDependencyReporterModel(o)}r.type==="lookup"&&SourceCode.Forms.Designers.Common.removeItemFromDependencyReporterModel(o)}else h.push(n.validationMessages[f])}n.validationMessages=h;TreeConfigSmartObject.determineErrorTab(n)}},method_Changed:function(n){var t=SFTreeConfig,f=jQuery(n.target),r=f.dropdown("SelectedValue"),q=t.getSelectedSource();if(t.loading||q===null||t.clearDependency(q,SourceCode.ControlPack.RefAs.TreeSourceMethod,f,{type:"dropdown",oldValue:q.method}),q.methods[r].hasInputs){t.parentProperty.dropdown("clearOptions");for(var e=t.idProperty.find("option"),u=0;u<e.length;u++)t.parentProperty.append(jQuery(e[u]).clone()[0]);t.parentProperty.dropdown("refresh")}else t.setParentProperty_NoMethodInputs();if(checkExistsNotEmpty(r)){t.setSourceProperty("method",r);var q=t.getSelectedSource();q.actionNodeXml=null}},valueProperty_Changed:function(n){var t=SFTreeConfig,r=jQuery(n.target);if(!t.loading){var q=t.getSelectedSource();q!==null&&t.clearDependency(q,SourceCode.ControlPack.RefAs.TreeSourceValueProperty,r,{type:"dropdown",oldValue:q.valueProperty})}var u=r.dropdown("SelectedValue");checkExistsNotEmpty(u)&&t.setSourceProperty("valueProperty",u)},idProperty_Changed:function(n){var t=SFTreeConfig,q=jQuery(n.target);if(!t.loading){var r=t.getSelectedSource();r!==null&&t.clearDependency(r,SourceCode.ControlPack.RefAs.TreeSourceIdProperty,q,{type:"dropdown",oldValue:r.idProperty})}if(checkExists(q.data("validationMessage")))var f=q.data("validationMessage");var u=q.dropdown("SelectedValue");checkExistsNotEmpty(u)&&t.setSourceProperty("idProperty",u)},chkSelectable_Click:function(){var n=SFTreeConfig;n.updateDefinition(!1);for(var t=0,r=n.chkSelectable.is(":checked"),q=0;q<n.definition.length;q++)n.definition[q].selectable&&t++;r||t--;t===0?(popupManager.showWarning(n.getResource("locErrorAtLeastOneSelectableSource")),n.chkSelectable.checkbox("check"),n.setSourceProperty("selectable",!0)):n.setSourceProperty("selectable",n.chkSelectable.is(":checked"))},chkRecursive_Click:function(){var n=SFTreeConfig,t=n.getSelectedSource();n.chkRecursive.is(":checked")?(n.setSourceProperty("recursive",!0),t.parentSmartObject===SFCTreeRuleHelper.NONE&&n.parentProperty.dropdown("enable"),SFCTreeRuleHelper.setParentFilter(SFTreeConfig.controlId,t,n.parentProperty.dropdown("SelectedValue"))):(n.setSourceProperty("recursive",!1),t.parentSmartObject===SFCTreeRuleHelper.NONE&&n.parentProperty.dropdown("disable"),SFCTreeRuleHelper.removeParentFilter(SFTreeConfig.controlId,t))},detachBodyControlEvents:function(){this.smartObjectButton.off();this.iconSmartObjectButton.off();this.parentSmartObject.off();this.icon.off()},addOption:function(n,t,q,r,u){var f=document.createElement("option");f.className=checkExists(u)?u:"image";f.value=t;f.innerHTML=q;checkExists(r)&&r&&f.setAttribute("selected","selected");n.append(f)},createOption:function(n,t,q){var r=document.createElement("option");r.className="image";r.value=n;r.innerHTML=t;q&&r.setAttribute("selected","selected")},toggleSourceSection:function(n){var t=this.displayTemplate.closest(".input-control.select-box.lookup-box");n?(t.removeClass("disabled"),this.smartObjectMethod.dropdown("enable"),this.idProperty.dropdown("enable"),this.valueProperty.dropdown("enable"),this.chkSelectable.checkbox("enable"),this.chkRecursive.checkbox("enable"),this.methodRuleButton.removeClass("disabled"),this.parentProperty.dropdown("enable")):(t.addClass("disabled"),this.smartObjectMethod.dropdown("disable"),this.idProperty.dropdown("disable"),this.valueProperty.dropdown("disable"),this.chkSelectable.checkbox("disable"),this.chkRecursive.checkbox("disable"),this.parentProperty.dropdown("disable"),this.methodRuleButton.addClass("disabled"))},toggleIconSection:function(n){var t=this.iconSmartObject.closest(".input-control.select-box.lookup-box.icon");n?(t.removeClass("disabled"),this.iconSmartObjectButton.removeClass("disabled"),this.iconSmartObjectMethod.dropdown("enable"),this.defaultIcon.dropdown("enable"),this.expandedIcon.dropdown("enable"),this.iconLink.dropdown("enable"),this.smartObjectLink.dropdown("enable")):(t.addClass("disabled"),this.iconSmartObjectButton.addClass("disabled"),this.iconSmartObjectMethod.dropdown("disable"),this.defaultIcon.dropdown("disable"),this.expandedIcon.dropdown("disable"),this.iconLink.dropdown("disable"),this.smartObjectLink.dropdown("disable"))},showDisplayTemplate_Click:function(){var q=SFTreeConfig,n=q.selectedNode.data("source");if(n!==null){if(TreeDependencyHelper.hasValidationMessage(n)){var r=n.validationMessages;if(TreeDependencyHelper.checkStatus(r,"Object","Missing")){popupManager.showWarning(Resources.MessageBox.ListControlPropertyConfigSmartObjectInvalidWarning);return}}var t=SourceCode.Forms.Controls.Web.TreeViewDisplayTemplate;t.initialize(SFTreeConfig,n);t.show()}},parentSmartObject_Changed:function(n){var t=SFTreeConfig,e=jQuery(n.target),q=t.getSelectedSource(),u=t.previewTree.parentNode(t.selectedNode);if(u!==null){var f=u.data("source");TreeDependencyHelper.validateSmartObject(f.id,f.validationMessages)&&TreeDependencyHelper.clearErrorOnField(t.parentSmartObject[0])}var r=t.parentSmartObject.dropdown("SelectedValue");t.loading||q===null||t.clearDependency(q,SourceCode.ControlPack.RefAs.TreeSourceParent,e,{type:"dropdown",oldValue:q.parentSmartObject});checkExistsNotEmpty(r)&&t.setSourceProperty("parentSmartObject",r);t.previewTree.updateNode(t.smartObject.attr("uid"),r,null);r===SFCTreeRuleHelper.NONE?t.chkRecursive.is(":checked")||t.parentProperty.dropdown("disable"):(t.parentProperty.dropdown("enable"),q.parentProperty!==SourceCode.Forms.Controls.Web.TreeView.CustomValue&&SFCTreeRuleHelper.setParentFilter(t.controlId,q,q.parentProperty));t.enableArrows()},parentProperty_Changed:function(n){var u=SFTreeConfig,f=jQuery(n.target),t=f.dropdown("SelectedValue"),q=u.getSelectedSource();u.loading||q===null||u.clearDependency(q,SourceCode.ControlPack.RefAs.TreeSourceParentProperty,f,{type:"dropdown",oldValue:q.parentProperty});for(var e=f.find("option"),o=e.length,r=0;r<o;r++){var s=e[r].getAttribute("value");if(s===SourceCode.Forms.Controls.Web.TreeView.CustomValue&&t!==SourceCode.Forms.Controls.Web.TreeView.CustomValue){jQuery(e[r]).remove();SFTreeConfig.parentProperty.dropdown("refresh");SFTreeConfig.parentProperty.dropdown("SelectedValue",t);break}}if(checkExistsNotEmpty(t)){if(!SFTreeConfig.systemChangingParentProperty){var q=SFTreeConfig.getSelectedSource();SFCTreeRuleHelper.setParentFilter(SFTreeConfig.controlId,q,t)}SFTreeConfig.setSourceProperty("parentProperty",t)}else SFTreeConfig.setSourceProperty("parentProperty",null)},handleRuleWizardCancellation:function(){var t=SFTreeConfig,n=SourceCode.Forms.Designers.View.viewDefinitionXML.documentElement.selectSingleNode("Views/View/Events/Event[@ID='{0}']".format(SFTreeRulePopup.modifiedEventNodeId));n!==null&&n.getAttribute("Type")==="User"&&n.setAttribute("Type","System")},methodRule_Click:function(n){if($(n.target).closest(".ui-button.disabled").length>0){n.preventDefault();return}var t=SFTreeConfig,q=t.getSelectedSource();if(!TreeDependencyHelper.validateSmartObject(q.id,q.validationMessages)){popupManager.showWarning(Resources.MessageBox.ListControlPropertyConfigSmartObjectInvalidWarning);return}if(!TreeDependencyHelper.validateSmartObjectMethod(q.validationMessages)){popupManager.showWarning(Resources.RuleDesigner.DataSourceMissingError);return}t.handleRuleWizardCancellation();t.updateDefinition(!1);var r=SourceCode.Forms.Controls.Web.TreeViewRuleConfigurePopup;r.ruleWizardCloseCallback=function(n,q){t.monitorRuleWizardDefinitionUpdate(n,q)};r.initialize(t,t.selectedNode.data("source"),t.getSourceIndex());r.show()},updateViewDefinitionWithActionConfiguration:function(n,t){var q=SourceCode.Forms.Designers.View.viewDefinitionXML.documentElement.selectSingleNode("Views/View/Events/Event[@ID='{0}']".format(SFTreeRulePopup.modifiedEventNodeId)),r="Handlers/Handler/Actions/Action[@ID='{0}']".format(n),u=q.selectSingleNode(r).cloneNode(!0),f=t.selectSingleNode(r);return f.parentNode.replaceChild(u,f),q.parentNode.replaceChild(t,q),u},monitorRuleWizardDefinitionUpdate:function(n,t){$(SourceCode.Forms.Designers.Common.Rules.Current).off(".SFTree");var q=SFTreeConfig,h=this.updateViewDefinitionWithActionConfiguration(n,t),o=q.selectedNode.data("source");if(o.parentSmartObject===SFCTreeRuleHelper.NONE&&!o.recursive){q.updateDefinition(!1);SFCTreeRuleHelper.setSourceActionXml(q.definition,q.controlId);q.parentProperty.find("option.customFilter").remove();q.parentProperty.dropdown("refresh");return}var u=!1,f=null,s=h.selectNodes("Parameters/Parameter"),y=h.selectSingleNode("Properties/Property[Name='Filter']");if(s.length===0||s.length>1||checkExists(y))u=!0;else{var e=s[0];if(e.childNodes.length>0)u=!0;else if(e.getAttribute("SourceType")==="ControlProperty"&&e.getAttribute("SourceID")==="ParentValue"){for(var p=e.getAttribute("TargetID"),c=q.parentProperty.find("option"),r=0;r<c.length;r++){var l=c[r].getAttribute("value");if(l===p){f=l;break}}f===null&&(u=!0)}else u=!0}if(u){for(var a=q.parentProperty.children("option"),w=a.length,v=!1,r=0;r<w;r++){var b=a[r].getAttribute("value");if(b===SourceCode.Forms.Controls.Web.TreeView.CustomValue){v=!0;break}}o.parentProperty=SourceCode.Forms.Controls.Web.TreeView.CustomValue;v?(q.parentProperty.dropdown("SelectedValue",q.CustomText),q.parentProperty.dropdown("refresh")):(q.addOption(q.parentProperty,SourceCode.Forms.Controls.Web.TreeView.CustomValue,q.CustomText,!0,"customFilter"),q.parentProperty.dropdown("refresh"))}else{var k=q.parentProperty.dropdown("SelectedValue");f!==k&&(q.parentProperty.dropdown("SelectedValue",f),q.parentProperty.dropdown("refresh"),q.setSourceProperty("parentProperty",f))}q.updateDefinition(!1);SFCTreeRuleHelper.setSourceActionXml(q.definition,q.controlId)},clearProperty:function(n,t,q,r){for(var u=parseXML(n),l=u.documentElement.selectSingleNode("Control/Properties"),s="//Property[Name='Definition' or Name='AssociationSO' or Name='AssociationMethod' or Name='DataSourceType' or Name='ValueProperty']",e=u.documentElement.selectNodes(s),f=0;f<e.length;f++){var a=e[f].selectSingleNode("./Name").text;if(e[f]!==null&&l.removeChild(e[f]),a==="DataSourceType"){var o=u.createElement("Property"),v=u.createElement("Name"),b=u.createElement("Value"),k=u.createElement("DisplayValue"),d=u.createTextNode(a),nt=u.createTextNode("(None)"),tt=u.createTextNode("(None)");v.appendChild(d);o.appendChild(v);o.appendChild(b);o.appendChild(k);l.appendChild(o)}}var y=u.documentElement.selectSingleNode("Control").getAttribute("ID"),p=SourceCode.Forms.Designers.View.viewDefinitionXML;s="//Events/Event[Name='Populating'][Handlers/Handler/Actions/Action[Properties/Property[Name='ControlID' and Value='{0}']]]".format(y);var h=p.selectSingleNode(s);h!==null&&h.parentNode.removeChild(h);for(var w=p.selectNodes("//Events/Event/Handlers/Handler/Actions/Action[Properties/Property[Name='ControlID' and Value='{0}']/../Property[Name='Method' and Value='Populate']]".format(y)),f=0,g=w.length;f<g;f++){var c=w[f];c!==null&&c.parentNode.removeChild(c)}r(1,u);SFTreeConfig.cleanUp()},validateAssociation:function(n,t){var s=SFTreeConfig,r=jQuery.ajax({url:applicationRoot+"Utilities/AJAXCall.ashx",data:{method:"getItems",resultTypes:"ObjectProperties|ObjectMethods",targetType:"Object",targetId:n},dataType:"text",global:!1,async:!1,error:s.error}).responseText;if(r!==null){var u=parseXML(r).documentElement.selectSingleNode("Item");if(u===null)return!1;var f=u.selectSingleNode("Items");if(t==="method")for(var e=f.selectNodes('Item[@ItemType="Method"]'),q=0,h=e.length;q<h;q++){var c=e[q];if(c.getAttribute("SubType")==="list")return!0}else if(t==="icon")for(var o=f.selectNodes('Item[@ItemType="ObjectProperty"]'),q=0,l=o.length;q<l;){if(o[q].getAttribute("SubType")==="Image")return!0;q++}}return!1},validate:function(){var n=SFTreeConfig;n.definition=n.previewTree.getFlatStructureJSON();for(var t=0;t<n.definition.length;t++){var q=n.definition[t].source;if(q.id===null)return popupManager.showWarning(n.getResource("locErrorSelectSmartObject")),!1;if(q.staticValue===""&&q.icon==="static")return popupManager.showWarning("Select an Image"),!1}return!0},getSelectedSource:function(){var n=null;return checkExists(this.selectedNode)&&(n=this.selectedNode.data("source")),checkExists(n)?n:null},getSourceIndex:function(){for(var t=SFTreeConfig,r=this.selectedNode.data("source"),q=0,n=0;n<t.definition.length;n++){if(r===t.definition[n])return n-q;checkExists(t.definition[n].method)||q++}return-1},setSourceProperty:function(n,t){var r=SFTreeConfig,q=r.selectedNode.data("source");checkExists(q)&&(q[n]=t)},initDefaultDisplayTemplate:function(n,t,q){checkExistsNotEmpty(n)||(n=t);for(var e=SFTreeConfig,r={},f=q.selectNodes("Items/Item"),u=0,l=f.length;u<l;u++){var s=f[u].getAttribute("ItemType"),h=f[u].getAttribute("SubType"),c=f[u].selectSingleNode("IsUnique");if(s.toUpperCase()==="OBJECTPROPERTY"&&h.toUpperCase()==="AUTONUMBER"&&checkExists(c)&&c.text.toUpperCase()==="TRUE")r.name=f[u].selectSingleNode("Name").text,r.displayName=f[u].selectSingleNode("DisplayName").text,r.dataType=f[u].getAttribute("SubType"),r.convertedDataType=TreeDependencyHelper.convertDataTypeName(r.dataType);else if(s.toUpperCase()==="OBJECTPROPERTY"&&h.toUpperCase()!=="AUTONUMBER"){r.name=f[u].selectSingleNode("Name").text;r.displayName=f[u].selectSingleNode("DisplayName").text;r.dataType=f[u].getAttribute("SubType");r.convertedDataType=TreeDependencyHelper.convertDataTypeName(r.dataType);break}}var a=e.smartObject.val();displayTemplateObjects=[{type:"context",data:{SourceType:"ObjectProperty",SourceID:r.name,DataType:r.dataType,icon:r.convertedDataType},text:r.displayName,tooltip:a+" - "+r.displayName}];e.setDisplayTemplateValue(displayTemplateObjects);var o=this.displayTemplate;return o.val(""),o.val(e.transformDisplayTemplateObjectsToString(displayTemplateObjects)),o.attr({firstTextProp:n,firstTextDisplay:t}),displayTemplateObjects},setDisplayTemplateValue:function(n){SFTreeConfig.displayTemplate.val(SFTreeConfig.transformDisplayTemplateObjectsToString(n))},transformDisplayTemplateObjectsToString:function(n){var r="";if(n)for(var q=0;q<n.length;++q){var t=n[q];t&&(q!==0||t.type!=="value"||t.text!=="&nbsp;"&&t.text!==" ")&&(r=r.concat(t.type==="value"?t.text==="&nbsp;"?" ":t.text:"["+t.text+"]"))}return r},updateParentDropDown:function(){var n=SFTreeConfig,s=n.parentSmartObject.dropdown("SelectedValue");n.parentSmartObject.empty();n.addOption(n.parentSmartObject,SFCTreeRuleHelper.NONE,SFCTreeRuleHelper.NONE,!0);for(var e=n.getSelectedSource(),u=n.previewTree.getFlatStructure(),r=0;r<u.length;r++)if(!$.contains(n.selectedNode[0],u[r][0])){var t=jQuery(u[r]).data("source");if(e===t)continue;t.uid!==null&&n.addOption(n.parentSmartObject,t.uid,t.display+t.version,!1)}n.parentSmartObject.dropdown("refresh");var f=n.previewTree.parentNode(n.selectedNode);if(f===null){var t=n.selectedNode.data("source");t.parentSmartObject!==SFCTreeRuleHelper.NONE?n.parentSmartObject.dropdown("SelectedValue",t.uid):n.parentSmartObject.dropdown("SelectedValue",SFCTreeRuleHelper.NONE)}else{var q=f.data("source");if(q.uid===null){n.parentSmartObject.dropdown("SelectedValue",f.data().uid);n.selectedNode.data().source.display&&n.parentSmartObject.trigger("change");return}n.parentSmartObject.dropdown("SelectedValue",q.uid);var t=n.selectedNode.data("source");if(!TreeDependencyHelper.validateSmartObject(q.id,q.validationMessages)){n.parentSmartObject.empty();var o=TreeDependencyHelper.getSmartObjectDisplayName(q.id,q.validationMessages);this.addOption(n.parentSmartObject,q.uid,o,!0,"error-state smartobject icon-control");n.parentSmartObject.dropdown("refresh")}}},updateDefinition:function(n){var q=SFTreeConfig;q.definition=[];for(var u=q.previewTree.getFlatStructure(),r=0;r<u.length;r++){var t=jQuery(u[r]).data("source");checkExists(t)&&(checkExists(t.contextXml)&&(t.contextXml=typeof t.contextXml=="string"?t.contextXml:t.contextXml.xml),n&&(delete t.properties,delete t.actionNodeXml,delete t.contextXml,delete t.methods),q.definition.push(t))}},createSourcesOnDefinition:function(n){var u=SFTreeConfig,f=SourceCode.Forms.Designers.View,e=[];if(e.push(n.id),u.definition.length>1)for(var t=0;t<u.definition.length;t++){var q=u.definition[t];if(!(e.indexOf(q.id)>-1)){e.push(q.id);f.AJAXCall._getAssociationSODetails(q.id);var y=f.hiddenAssociationXml,c=y.selectSingleNode("//smartobjectroot[@guid='{0}']".format(q.id));if(c===null)return;for(var l=c.selectNodes("properties/property"),r=0,p=l.length;r<p;){var o=l[r],w=o.getAttribute("name"),b=o.getAttribute("type"),k=o.selectSingleNode("metadata/display/displayname").text,d={soid:q.id,propertyid:w,propertytype:b,friendlyname:k,soname:q.name,sofriendlyname:q.display,contexttype:"External",contextid:u.controlId,sourcetype:"Object",fieldtype:"ObjectProperty"};f.ViewDesigner._createField(f.viewDefinitionXML,d);r++}}}for(var s=f.viewDefinitionXML.documentElement.selectNodes("Views/View/Sources/Source[@ContextID='{0}']".format(u.controlId)),g=s.length,h=[],r=0;r<g;r++){for(var t=0;t<e.length;t++){var a=!1;if(e[t]===s[r].getAttribute("SourceID")){a=!0;break}}a||h.push(s[r])}for(var t=0;t<h.length;t++){var v=h[t];v.parentNode.removeChild(v)}},clear:function(n){var q=SFTreeConfig,t=n.selectSingleNode("/Controls/Control/Properties/Property[Name = 'AssociationSO']");TreeUtil.removeNode(t);t=n.selectSingleNode("/Controls/Control/Properties/Property[Name = 'AssociationMethod']");TreeUtil.removeNode(t);t=n.selectSingleNode("/Controls/Control/Properties/Property[Name = 'Definition']");TreeUtil.removeNode(t);t=n.selectSingleNode("/Controls/Control/Properties/Property[Name = 'ValueProperty']");TreeUtil.removeNode(t);t=n.selectSingleNode("/Controls/Control/Properties/Property[Name = 'DataSourceType']");TreeUtil.removeNode(t)},save:function(n){var e=SFTreeConfig,t=n.selectSingleNode("/Controls/Control"),c=n.selectSingleNode("/Controls/Control/Properties/Property[Name = 'AssociationSO']"),l=n.selectSingleNode("/Controls/Control/Properties/Property[Name = 'AssociationMethod']"),q=n.selectSingleNode("Controls/Control/Properties/Property[Name[text()='Definition']]");q===null&&(q=TreeUtil.addProperty(n,t,"Definition",""));var h=JSON.stringify(e.definition),r=q.selectSingleNode("Value");r.removeChild(r.childNodes[0]);r.appendChild(n.createTextNode(h));var u=null,o=null,f=e.definition[0];if(u=f.id,o=f.method,u!==null){TreeUtil.updateProperty(n,t,"AssociationSO",u);TreeUtil.updateProperty(n,t,"AssociationMethod",o);TreeUtil.updateProperty(n,t,"ValueProperty",f.valueProperty);TreeUtil.updateProperty(n,t,"DataSourceType","SmartObject");var s=SourceCode.Forms.Designers.View;if(!checkExists(s)&&!checkExists(s.viewDefinitionXML))return;var a=t.getAttribute("ID")}},loadDefinition:function(n){var q=SFTreeConfig,r=parseXML(n),t=r.selectSingleNode("Controls/Control/Properties/Property[Name[text()='Definition']]");t!==null&&(q.definition=JSON.parse(t.selectSingleNode("Value").text))},load:function(){this.smoList={};var n=SFTreeConfig;if(checkExists(n.definition)&&n.definition.length!==0){n.loading=!0;for(var q=[],f=!1,r=0;r<n.definition.length;r++){var t=n.definition[r];t.icon==="static"&&(f=!0);var u=SourceCode.Forms.DependencyHelper;TreeDependencyHelper.hasValidationMessage(t)&&TreeDependencyHelper.checkStatus(t.validationMessages,u.ReferenceType.Object,u.ReferenceStatus.Missing)?q.push({id:t.id,status:u.ReferenceStatus.Missing}):q.push(t.id)}f?SFTreeIconTab.getIcons(function(){this.loadAll(q)}.bind(this)):this.loadAll(q)}},loadAll:function(n){TreeConfigSmartObject.getAllSmartObjectData(n,function(){SFTreeConfig.doLoad()})},doLoad:function(){var n=SFTreeConfig,q=0,t=n.definition[q],r=function(){if(checkExists(t.selectable)||(t.selectable=!0),t.selectable?n.chkSelectable.checkbox("check"):n.chkSelectable.checkbox("uncheck"),t.recursive?n.chkRecursive.checkbox("check"):n.chkRecursive.checkbox("uncheck"),q++,q>=n.definition.length){n.hideLoadingOverlay();var u=jQuery("#treeView").find("li").first();u.length>0&&SFTreeConfig.previewTree.selectNode(u);$(SFTreeConfig.idBlind).remove();n.loading=!1;SFCTreeRuleHelper.setSourceActionXml(n.definition,SFTreeConfig.controlId);return}t=n.definition[q];u=n.previewTree.loadNode(jQuery(n.bodyTemplate).clone(),t);SFTreeIconTab.setFromSource(t);var f=SFTreeIconTab.getStaticIconPath(t.staticValue);n.previewTree.setNodeIcon(u,f,t.staticValue);TreeConfigSmartObject.loadSource(n.clone(t),r)};node=n.previewTree.loadNode(jQuery(n.bodyTemplate).clone(),t);SFTreeIconTab.setFromSource(t);var u=SFTreeIconTab.getStaticIconPath(t.staticValue);n.previewTree.setNodeIcon(node,u,t.staticValue);TreeConfigSmartObject.loadSource(n.clone(t),r)},showLoadingOverlay:function(){$(SFTreeConfig.idBlind).overlay({modal:!0,icon:"loading"})},hideLoadingOverlay:function(){$(SFTreeConfig.idBlind).removeOverlay()},clone:function(n){var t=JSON.stringify(n);return JSON.parse(t)},popupOkClick:function(){var n=SFTreeConfig;if(!n.loading&&(n.handleRuleWizardCancellation(),n.validate())){SFTreeIconTab.setConditional();n.updateDefinition(!1);var o=this.clone(n.definition);n.updateDefinition(!0);var f=this.definition[0],t=parseXML(n.propertiesXml);if(!checkExists(f)){n.clear(t);n.callback(1,t,!0);popupManager.closeLast({cancelOnClose:!0});return}SFTreeRulePopup.changePrimarySource(this.controlId,f);n.save(t);for(var e=!0,q=0;q<this.definition.length;q++){for(var u=this.definition[q].displayTemplate,r=0;r<u.length;r++)typeof u[r].data=="object"&&checkExists(u[r].data.validationMessages)&&u[r].data.validationMessages.length>0&&(e=!1);checkExists(this.definition[q].validationMessages)&&this.definition[q].validationMessages.length>0&&(e=!1)}e&&SFCTreeRuleHelper.removeAllAnnotationsFromControl(this.controlId,t);n.callback(1,t,!0,null,!0);n.createSourcesOnDefinition(f);SFCTreeRuleHelper.ensureInitializeEvent(n.controlId,SourceCode.Forms.Designers.View.ViewDesigner);SFCTreeRuleHelper.ensureLevelLoadingEvent(n.controlId,o);popupManager.closeLast({cancelOnClose:!0})}},clearDropDownValue:function(){var n=SFTreeConfig;n.parentProperty.siblings("div.input-control.select-box.dropdown-box.icon-control").first().removeClass("autonumber autoguid number guid text decimal")},getResource:function(n){return jQuery("#SFTreeViewConfig")[0].getAttribute(n)},changeEventType:function(n,t){if(!checkExists(t)){var q="SourceCode.Forms/Views/View/Events/Event[Name='Populating'][Handlers/Handler/Actions/Action[Properties/Property[Name='ControlID' and Value='{0}']]]".format(SFTreeConfig.controlId),r=SourceCode.Forms.Designers.View.viewDefinitionXML;if(t=r.selectSingleNode(q),t===null)return}n?t.setAttribute("Type","User"):t.setAttribute("Type","System")},cleanUp:function(){var n=SFTreeConfig;jQuery("#propertyConfig_SFTreeViewConfig").off();TreeConfigSmartObject.cleanUp();n.bodyTemplate=null;n.callback=null;n.controlId=null;n.fullXml=null;n.propertiesXml=null;n.propertyXml=null;n.definition=null;n.iconSource=null;n.iconName=null;n.iconImage=null}};
/*!
 SourceCode.Forms.Controls.Web.ControlPack.Scripts.Config.TreePreviewConfig.js (Embedded resource)
*/
SourceCode.Forms.Controls.Web.TreePreview=function(n,t,q){this.element=jQuery("#"+n);this.callback=t;this.initialize(q)};SourceCode.Forms.Controls.Web.TreePreview.prototype={treeView:null,curNode:null,initialize:function(n){var t=this;this.element[0].style.height=n+"px";var q=document.documentElement.getAttribute("dir");q==="rtl"&&this.element[0].parentNode.classList.add("k-rtl");this.element.kendoTreeView({select:function(n){var q=n.node;if(t.callback!==null){var r={node:$(t.curNode),content:$(q).data().content,cancel:!1};if(t.callback.call(t,"selecting",r),r.cancel){t.curNode=q;n.preventDefault();return}}if(t.curNode=q,t.callback!==null){var r={node:$(q),content:$(q).data().content};t.callback.call(t,"selected",r)}}});this.treeView=this.element.data("kendoTreeView");$("#btnMoveDown").attr("title","Move Node Down");$("#btnMoveUp").attr("title","Move Node Up");this.element.on("click",function(n){if(n.target.tagName!=="SPAN"){if(t.callback!==null){var q=t.treeView.select(),r={node:q,content:q.data("content"),cancel:!1};if(t.callback.call(t,"unselecting",r),r.cancel){n.stopPropagation();return}}if(t.treeView.select($()),t.callback!==null){var r={node:null,content:q.data("content")};t.callback.call(t,"unselected",r)}}})},selectNode:function(n){if(this.callback!==null){var t={node:$(n),content:$(n).data().content,selectNode:!0,cancel:!1};if(this.callback.call(this,"selecting",t),t.cancel)return}if(this.treeView.select(n),this.callback!==null){var t={node:$(n),content:$(n).data().content};this.callback.call(this,"selected",t)}},loadNode:function(n,t){var q=null;if(checkExists(t.version)||(t.version=""),t.uid===t.parentSmartObject||t.parentSmartObject.toUpperCase()===SFCTreeRuleHelper.NONE){q=this.treeView.append({text:t.display+t.version,expanded:!0,spriteCssClass:"smo ico icon-smartobject"});q.data("uid",t.uid);q.data("parentID",t.parentSmartObject);q.data("content",n);q.data("source",t);q.attr("id","Node_"+t.uid);var u={node:q};this.callback!==null&&this.callback.call(this,"loadnode",u)}else{var r=$("#Node_"+t.parentSmartObject),f={text:t.display+t.version,expanded:!0,spriteCssClass:"smo ico icon-smartobject"};q=this.treeView.append(f,r);q.data("uid",t.uid);q.data("parentID",t.parentSmartObject);q.data("content",n);q.data("source",t);q.attr("id","Node_"+t.uid);this.treeView.expand(r)}return q.find(".k-in").first().trigger("click"),q},addNode:function(n,t){if(checkExists(this.treeView)){var e=this.element.find(".k-selected"),q=null;if(this.callback!==null){var u={node:this.treeView.select(),parentNode:this.treeView.select(),content:t,contentSet:!1,cancel:!1};if(this.callback.call(this,"adding",u),u.cancel)return}if(e.length>0){var f=this.treeView.select(),r=String.generateGuid();q=this.treeView.append({text:n,expanded:!0,spriteCssClass:"smo ico icon-smartobject"},f);q.data("uid",r);q.data("parentID",f.data().uid);q.data("content",t);q.attr("id","Node_"+r);this.treeView.expand(f)}else{var r=String.generateGuid();q=this.treeView.append({text:n,expanded:!0,spriteCssClass:"smo ico icon-smartobject"});q.data("uid",r);q.data("parentID",r);q.data("content",t);q.attr("id","Node_"+r)}if(this.callback!==null){var u={node:q,parentNode:this.treeView.select(),content:t};this.callback.call(this,"added",u)}return q}return null},removeNode:function(){var n=this.treeView.select();if(checkExists(n)){var t=n.children("ul").children(),q=n.parent().closest(".k-item").find("ul").first(),u=n.parent(),f=n.parent().closest(".k-item").find(".k-icon").first();if(this.callback!==null){var r={node:this.treeView.select(),cancel:!1};if(this.callback.call(this,"removing",r),r.cancel)return}if(q.length===0?(q=n.parent(),t.length>0&&(t.data().parentID=null,t.data().source.parentSmartObject="(NONE)")):t.length>0&&(t.data().parentID=n.parent().parent().data().uid,t.data().source.parentSmartObject=this.treeView.parent(n).data().uid),q.append(t),n.remove(),u.children().length===0&&(this.hasNodes()&&u.remove(),f.remove()),this.callback!==null){var r={cancel:!1};this.callback.call(this,"removed",r)}}},updateNode:function(n,t){var r=this.treeView.select();if(r.length!==0){var h=r.parent(),v=r.parent().closest(".k-item").find(".k-icon").first(),c=!1,l=!1,q=r.data();if(this.callback!==null){var e={node:r,passednodeid:n,content:q.content,cancel:!1};if(this.callback.call(this,"updating",e),e.cancel)return}if(checkExists(n)&&q.uid!==n){q.uid=n;r.attr("id","Node_"+q.uid);c=!0;for(var o=r.children("ul").children(),f=0;f<o.length;f++)$(o[f]).data().parentID=q.uid,$(o[f]).data().source.parentSmartObject=q.uid}if(checkExists(t)&&q.parentID!==t&&(q.parentID=t,l=!0),checkExists(q.source.display)&&(r.find(">div>.k-in")[0].innerHTML=r.find(".k-sprite")[0].outerHTML+"{0} {1}".format(q.source.display,q.source.version)),!c&&l){if(q.parentID===q.uid||q.parentID==="(NONE)"){var y=this.element;y.append(r)}else{var s=$("#Node_"+q.parentID),u=s.children("ul");if(u.length>0)u.append(r);else{u=document.createElement("ul");$(u).addClass("k-group");$(u).attr("style","-webkit-transition: none; transition: none; overflow: visible; display: block; height: auto;");$(u).append(r);s.append(u);var a=document.createElement("span");$(a).addClass("k-icon k-minus");var p=$(s).find("div").eq(0);p.prepend(a)}}h.children().length===0&&(h.remove(),v.remove())}if(this.callback!==null){var e={node:r,cancel:!1};this.callback.call(this,"updated",e)}}},isValidSMO:function(n,t){if(!t)return!0;for(var u=this.getFlatStructure(),q=!0,r=0;r<u.length;r++)if(u[r].data().source.id===n){q=!1;break}var f={valid:q,cancel:!1};return this.callback.call(this,"validated",f),q},getFlatStructure:function(){for(var t=[],q=this.element.children(),n=0;n<q.length;n++)this._getFlatStructureHelper($(q[n]),t);return t},_getFlatStructureHelper:function(n,t){var r=n.children("ul").children();t.push(n);for(var q=0;q<r.length;q++)this._getFlatStructureHelper($(r[q]),t)},getFlatStructureJSON:function(){for(var t=[],q=this.element.children(),n=0;n<q.length;n++)this._getFlatStructureJSONHelper($(q[n]),t);return t},_getFlatStructureJSONHelper:function(n,t){var f=n.children("ul").children(),q={},r=n.data();q.uid=r.uid;q.parentID=r.parentID;q.source=r.source;q.content=encodeURI(r.content);t.push(q);for(var u=0;u<f.length;u++)this._getFlatStructureJSONHelper($(f[u]),t)},setNodeIcon:function(n,t,q){if(SFTreeIconTab.images!==null){var r=$(n).find(".k-sprite").first();r.removeClass("hidden");var o=$(n).data().source.icon;switch(o.toUpperCase()){case"DYNAMIC":r[0].style.backgroundImage="";r[0].style.backgroundPosition="0% 0%";break;case"STATIC":for(var f=0,e=0,u=0,s=SFTreeIconTab.images.ItemDetails.length;u<s;u++)checkExists(q)&&SFTreeIconTab.images.ItemDetails[u].ID.toUpperCase()===q.toUpperCase()&&(f=SFTreeIconTab.images.ItemDetails[u].X,e=SFTreeIconTab.images.ItemDetails[u].Y);r[0].style.backgroundImage="url('{0}')".format(t);r[0].style.backgroundPosition="{0}px -{1}px".format(f,e)}}},moveNodeUp:function(){var n=this.treeView.select(),t=n.parent();if(this.callback!==null){var q={node:n,parentNode:t,cancel:!1};if(this.callback.call(this,"movingNodeUp",q),q.cancel)return}var r=n.index();if(r>0&&t.children().eq(r-1).before(n),this.callback!==null){var q={node:n,parentNode:t,cancel:!1};this.callback.call(this,"movedNodeUp",q)}},moveNodeDown:function(){var n=this.treeView.select(),t=n.parent();if(this.callback!==null){var q={node:n,parentNode:t,cancel:!1};if(this.callback.call(this,"movingNodeDown",q),q.cancel)return}var r=n.index();if(r<t.children().length&&t.children().eq(r+1).after(n),this.callback!==null){var q={node:n,parentNode:t,cancel:!1};this.callback.call(this,"movedNodeDown",q)}},bindTree:function(n){$("#treeView").empty();for(var u=0;u<n.length;u++){var t=n[u];if(t.id===t.parentSmartObject||t.parentSmartObject==="(NONE)"){var r=t.id,q=this.treeView.append({text:t.display,expanded:!0,spriteCssClass:"smo ico icon-smartobject"});q.data("uid",r);q.data("parentID",r);q.data("source",t);q.attr("id","Node_"+r)}else{var f=$("#Node_"+t.parentSmartObject),r=t.id,q=this.treeView.append({text:t.display,expanded:!0,spriteCssClass:"smo ico icon-smartobject"},f);q.data("uid",r);q.data("parentID",t.parentSmartObject);q.data("source",t);q.attr("id","Node_"+r)}}},selectedNode:function(){var n=this.treeView.select();return checkExists(n)?n:null},parentNode:function(n){var t=n.parent().parent();return t[0].tagName!=="LI"?null:t},hasNodes:function(){return this.treeView.element.find("li").length>0},refresh:function(){if(this.callback!==null){var n={element:this.element,cancel:!1};if(this.callback.call(this,"refreshing",n),n.cancel)return}if(this.bindTree(this.getFlatStructure()),this.callback!==null){var n={element:this.element,cancel:!1};this.callback.call(this,"refreshed",n)}}};
